"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[92222],{573520:(e,t,o)=>{o.d(t,{h:()=>i});o(242343);var r=o(163643);const i=(0,o(680369).wt)("eye",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},725460:(e,t,o)=>{o.d(t,{A:()=>s});var r=o(242343),i=o(163643);function n(e,t){return(0,i.jsx)(o(932322).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const s=(0,r.forwardRef)(n)},902496:(e,t,o)=>{o.d(t,{default:()=>w});o(725707),o(491955),o(500234),o(403517);var r=o(242343),i=()=>o(237385),n=()=>o(803290),s=()=>o(174114),l=()=>o(916963),p=()=>o(573520),a=()=>o(791976),d=()=>o(653998),c=()=>o(975392),y=()=>o(31448),u=()=>o(137476);var h=()=>o(626911),m=()=>o(927999),g=()=>o(84543),x=()=>o(640979),b=()=>o(755786),f=()=>o(907721),v=()=>o(725460),j=()=>o(535906),S=()=>o(97787),A=()=>o(356813),C=()=>o(935091),T=()=>o(858023),k=()=>o(88271),_=o(163643);const w=function(e){let{collectionStore:t,targetCollectionStore:l,property:p,disabled:a,rowType:c}=e;const y=(0,s().DP)(),h=(0,i().v3)(),m=(0,n().uB)(void 0,o(210466).A),{format:g}=(0,r.useContext)(o(108507).t),x=(0,n().K8)((()=>{const e=b().B7({collectionStore:t,property:p}),o=Object.keys(l.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),r=e.map((e=>e.property)),i=e=>{const t=r.indexOf(e);return-1!==t?t:1/0};return o.sort(((e,t)=>i(e.property)-i(t.property))),o}),[t,l,p]),v=(0,r.useCallback)((e=>(0,_.jsx)(z,{parent:e,collectionStore:t,property:p,disabled:a,targetCollectionStore:l,menuListStore:m,allRelatedTargetProperties:x})),[t,p,a,l,m,x]),j=(0,s().IS)((e=>({tooltipBody:{color:e.text.secondary},tooltipContainer:{display:"flex",flexDirection:"column"}})),[]);return(0,i().WS)()&&"section"!==c||"form_editor"===g||"form_viewer"===g?null:(0,_.jsx)(o(103151).A,{renderTooltip:()=>(0,_.jsxs)("div",{style:j.tooltipContainer,children:[(0,_.jsx)("div",{children:(0,_.jsx)(d().sA,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"})}),a&&(0,_.jsx)("div",{style:j.tooltipBody,children:(0,_.jsx)(d().sA,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message.no_access",defaultMessage:"You do not have permission to edit"})})]}),placement:"section"===c?f().W.Top:f().W.Right,render:e=>(0,_.jsx)(o(273520).Ay,{popupType:o(443252).nl.Popup,alignmentToOrigin:f().C.Start,...e,renderOrigin:t=>(0,_.jsx)(A().A,{icon:o(711361)._,iconStyle:{width:16,color:y.mediumIconColor,fill:y.mediumIconColor},disabled:a,...t,...e}),onClick:()=>{!function(e,t){u().vd(e,"relation_customize_displayed_properties",t)}(h,{from:"section"===c?"relation_section":"configure_relation_modal"})},originGap:16,render:v})})};function P(e){const{props:t,children:o}=e;return(0,_.jsx)(k().A,{...t,noTextOverflow:!0,title:(0,_.jsx)(d().sA,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:o,disableDesktopPadding:!0})}function B(e,t,o,r,i,n,s){const{properties:d,visibility:u}=e;return c().oE(d.map((e=>function(e,t,o,r,i,n,s){const{propertyFormat:d,visibility:c}=e,u=!c,m=i.getSchema();if(!m)return;const g=m[d.property];return g?{key:d.property,render:e=>(0,_.jsx)(j().A,{...e,showDragHandle:!s,title:(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,_.jsx)(l().zB,{icon:g.icon,type:g.type,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,_.jsx)("span",{style:{marginLeft:8,...y().RC},children:g.name})]}),right:(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,_.jsx)(A().A,{icon:u?a().T:p().h,iconStyle:{width:16,height:16},isDarkIconColor:!u,onClick:()=>{h().xI({propertyFormat:d,visibility:c,collectionStore:r,property:n,environment:t})},disabled:s||"title"===d.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:u},t,o,r,i,n,s))))}function M(e){const t=(0,i().v3)(),{collectionStore:o,property:r,menuListStore:n,disabled:s,visibleProperties:l,hiddenProperties:p,children:a}=e,d=c().oE([...l.map((e=>e.property)),l.length>0&&p.length>0&&{key:"group-header-hidden-property",draggable:!1},...p.map((e=>e.property))]);return(0,_.jsx)(S().Ay,{direction:"vertical",keys:d,renderKey:(e,t)=>a[t],onDrop:e=>{!function(e,t,o,r,i){const{newPropertyKeys:n}=e,s=b().B7({collectionStore:o,property:r}),l=n.indexOf("group-header-hidden-property"),p=c().oE(n.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=s.find((t=>t.property===e));return o?l>0?"title"===e&&t>=l?o:{...o,visible:Boolean(t<l)}:o:{property:e,visible:!(l>0)||Boolean(t<l)}}))),a=s.filter((e=>!n.includes(e.property))),d={...b().TA(o)};d[r]||(d[r]={}),d[r].related_properties=[...p,...a],g().createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{m().zA({stores:[o],update:{collection_relation_options:d},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,o,r,n)},disabled:s})}function z(e){let{parent:t,collectionStore:o,property:r,disabled:l,targetCollectionStore:p,menuListStore:a,allRelatedTargetProperties:y}=e;const u=(0,s().DP)(),h=(0,i().v3)(),m=y.filter((e=>e.visible)),g=y.filter((e=>!e.visible)),b=(0,n().K8)((()=>B({properties:m,visibility:!0},h,u,o,p,r,l)),[m,h,u,o,p,r,l]),f=(0,n().K8)((()=>B({properties:g,visibility:!1},h,u,o,p,r,l)),[g,h,u,o,p,r,l]);return y?(0,_.jsxs)(C().A,{menuType:x().gu.Popup,maxWidth:240,maxHeight:500,children:[0===y.length&&(0,_.jsx)(k().A,{children:(0,_.jsx)(v().A,{caption:(0,_.jsx)(d().sA,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),y.length>0&&(0,_.jsx)(T().Ay,{type:T().Oh.Vertical,store:a,initialFocus:void 0,sections:c().oE([m.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,_.jsx)(k().A,{...e,noTextOverflow:!0,title:(0,_.jsx)(d().sA,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,_.jsx)(M,{collectionStore:o,property:r,disabled:l,menuListStore:a,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:c().oE([...b,g.length>0&&{key:"group-header-hidden-property",render:e=>(0,_.jsx)(P,{props:e,children:(0,_.jsx)(_.Fragment,{})}),action:()=>{}},...f])},0===m.length&&g.length>0&&{key:"hidden_properties",render:e=>(0,_.jsx)(P,{props:e,children:(0,_.jsx)(M,{collectionStore:o,property:r,disabled:l,menuListStore:a,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:f}])})]}):null}}}]);