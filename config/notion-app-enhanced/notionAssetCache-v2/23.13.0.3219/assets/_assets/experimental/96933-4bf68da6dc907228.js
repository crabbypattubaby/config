"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[96933],{18434:(e,t,o)=>{o.d(t,{X:()=>i});const i=(0,o(242343).createContext)(0);i.displayName="PageViewHorizontalOffsetContext"},38095:(e,t,o)=>{o.d(t,{A:()=>oe});o(362833),o(725707),o(491955),o(403517);var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(716605),a=o(163643);const l=(0,o(680369).wt)("addPageDiscussion",{viewBox:"0 0 16 16",svg:(0,a.jsx)("path",{d:"M4.095 15.465c.287 0 .499-.137.84-.444l2.523-2.277 4.47.007c2.058 0 3.214-1.19 3.214-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.213h.273v1.983c0 .45.24.738.657.738zM3.958 5.156a.454.454 0 01-.444-.45c0-.24.198-.438.444-.438h7.157c.246 0 .445.198.445.437a.45.45 0 01-.445.451H3.958zm0 2.256a.454.454 0 01-.444-.451c0-.24.198-.444.444-.444h7.157a.448.448 0 010 .895H3.958zm0 2.256a.448.448 0 010-.896h4.669c.246 0 .437.206.437.452a.438.438 0 01-.437.444H3.958z"})});var c=()=>o(150936),d=()=>o(946854),u=()=>o(653998),p=()=>o(31448),m=()=>o(743456),g=()=>o(319638),h=()=>o(880195),v=()=>o(388615),S=()=>o(209684),f=()=>o(273520),y=()=>o(517198),b=()=>o(129978);const C=new(b().O2)("floatingTableOfContents",(async()=>await o.e(52614).then(o.bind(o,505367)))),k=(0,b()._h)(C,(e=>e.FloatingTableOfContents));var _=()=>o(983050),x=()=>o(712048),w=()=>o(640979),P=()=>o(400885);o(610931);var M=()=>o(360482),I=()=>o(159275),A=()=>o(48913),T=()=>o(836331),B=()=>o(797470),j=()=>o(141122),L=()=>o(290557),V=()=>o(906513),R=()=>o(971052),D=()=>o(702011),E=()=>o(581101),K=()=>o(521869),O=()=>o(587912),F=()=>o(991649),z=()=>o(92627),W=()=>o(394094),H=(o(500234),()=>o(259897)),N=()=>o(64713),G=()=>o(413871),U=()=>o(782422),Y=()=>o(724903),q=()=>o(755648),Q=()=>o(589004);function X(e){let{pageStore:t,disabled:o,viewsModule:r,wrapper:l,templatePickerMenuListStore:c,editorContentContainerRef:d}=e;const u=(0,n().v3)(),[p,m]=(0,i.useState)(void 0),{collectionViewBlockStore:g,viewsModuleContext:h,isViewsMainModule:v}=(0,s().K8)((()=>{if(!r)return{collectionViewBlockStore:void 0,collectionViewId:void 0,viewsModuleContext:void 0,isViewsMainModule:!1};const e=G().Bv.createChildStore(t,r.collection_view_block_pointer);return{collectionViewBlockStore:e,viewsModuleContext:{location:"page",viewsModule:r,currentPageStore:t,collectionViewBlockStore:e},isViewsMainModule:"viewsMain"===r.type}}),[t,r]);!function(e){let{isViewsMainModule:t,collectionViewBlockStore:o,environment:n,collectionContextStore:r}=e;const a=(0,s().K8)((()=>{if(!t||!o)return;const e=n.RouterStore.state.route;if("page"===e.name&&e.scrollToBlockId){const e=o.getCollectionViewStores().find((e=>"page"===e.getType()));return null==e?void 0:e.id}}),[n,o,t]);(0,i.useEffect)((()=>{r&&a&&(0,H().t)({environment:n,collectionContextStore:r,collectionViewId:a,isFullScreen:r.isFullScreenStore.state,isRootChild:r.isRootChildStore.state,isInPeekRenderer:r.isInPeekRendererStore.state})}),[n,a,o,t,r])}({isViewsMainModule:v,collectionViewBlockStore:g,environment:u,collectionContextStore:p});const S=function(e){const t=(0,n().v3)();return(0,s().K8)((()=>{if(!e)return 0;const{device:o}=t,i=t.WindowSizeStore.state.width,n=Boolean(e&&(0,Y().cq)(e));if(n){const e=(0,Q().eO)({environment:t,isInPeek:!0});return j().default.getPeekModeWidth(i)-q().A.state-e}const s=(0,A().zo)(t,n)-(0,A().Ql)(t);let r=i-q().A.state-s;if(!(0,A().tv)(t))return r;const{shouldShowSidebar:a}=(0,U().X4)(t);return o.isMobile&&!o.isTablet||!a||(r-=(0,A().kf)(t)),r}),[t,e])}(g),f=function(e){let{isViewsMainModule:t,collectionViewBlockStore:o,collectionContextStore:i}=e;return(0,s().K8)((()=>{if(!t||!i)return!1;const e=null==i?void 0:i.collectionViewStore();return 1===(null==o?void 0:o.getCollectionViewStores().length)&&"page"===(null==e?void 0:e.getType())&&!(null!=e&&e.getFormat().page_pointer)}),[t,i,o])}({isViewsMainModule:v,collectionViewBlockStore:g,collectionContextStore:p});return g&&h?l((0,a.jsx)("div",{style:v?{minHeight:"60vh"}:void 0,children:(0,a.jsx)(N().dN,{store:g,isFullScreen:!1,productUseCase:"page_views_module",hideViewTabBar:f,headerActionsBehavior:f?"hidden":"always_show",headerAllowedActions:$,disabled:o,disableHoverMenu:!0,fullWidth:S,showOnlyCurrentView:!v,isUnlistedView:!1,viewsModuleContext:h,setCollectionContextStore:m,templatePickerMenuListStore:c,editorContentContainerRef:d})})):null}const $=["filter","sort","search","addItem","noDate"];var J=()=>o(851861),Z=()=>o(144451);const ee=new(b().O2)("PageLayoutModuleErrorFallback",(()=>o.e(98396).then(o.bind(o,613113)))),te=(0,b()._h)(ee,(e=>e.PageLayoutModuleErrorFallback));const oe=function(e){const{store:t,context:d,postContext:m,disabled:y,templatePickerMenuListStore:C,styleOverrides:I,onHeaderMouseEnter:T,onHeaderMouseLeave:j,pageCoverHeight:R,isEditable:D,getControlHoverStyle:E,pageViewBlockStores:K,pageViewBlockAccessor:O,onDetailMouseEnter:F,onDetailMouseLeave:z,modules:W,editorContentContainerRef:H,layoutRef:N}=e,G=(0,n().v3)(),U=(0,s().K8)((()=>t.getAssociatedCollectionStore()),[t],{debugName:"PageLayoutModules(collectionStore).useComputedStore"}),Y=(0,s().K8)((()=>t.getSchema()),[t],{debugName:"PageLayoutModules(schema).useComputedStore"}),q=(0,s().K8)((()=>(0,o(506181).A)({environment:G,store:t,pageViewBlockStore:K.pageViewBlockStore})),[G,t,K.pageViewBlockStore]),Q=(0,s().K8)((()=>{const e=(0,P().gV)(t);if(!e)return;return(e.collection_page_sections||[]).filter((e=>{const o=Y[e.section];if(!o||"relation"!==o.type)return;const i=t.getPropertyValue(e.section),n=(0,r().bG)({relationValue:(0,r().n)(i),propertySchema:o,getRecordModel:t.getRecordModel,includeNoAccess:!0}).length;return"inline"===e.visibility&&Y[e.section]&&0!==n})).map((e=>e.section))}),[Y,t],{debugName:"PageLayoutModules(inlinePropertyIDs).useComputedStore"}),X=(0,o(174114).IS)((e=>({bottomControls:{display:"flex",alignItems:"baseline",justifyContent:"flex-start",flexWrap:"wrap",color:e.text.tertiary,fontFamily:p().vc(o(16791).locale).sans},detailsButton:{fontWeight:p().Wy.medium,color:e.text.secondary}})),[]),$=(0,s().K8)((()=>(null==I?void 0:I.paddingX)??(0,P().OU)(d,G)),[d,G,null==I?void 0:I.paddingX],{debugName:"PageLayoutModules(horizontalPadding).useComputedStore"}),J=(0,i.useCallback)((()=>(0,M().oC)(t,{recursivelyLoadAllDiscussions:!1})),[t]),Z=(0,i.useCallback)((()=>J()>0),[J]),ee=(0,s().K8)((()=>{const e=(0,P().gV)(t);if(!e)return;return(e.collection_page_sections||[]).filter((e=>{const o=Y[e.section];if(!o||"relation"!==o.type)return;const i=t.getPropertyValue(e.section),n=(0,r().bG)({relationValue:(0,r().n)(i),propertySchema:o,getRecordModel:t.getRecordModel,includeNoAccess:!0}).length;return"minimal"===e.visibility&&Y[e.section]||"inline"===e.visibility&&Y[e.section]&&0===n})).map((e=>e.section))}),[Y,t],{debugName:"PageLayoutModules(minimalPropertyIDs).useComputedStore"}),{value:oe}=(0,b().fJ)(g().commentsDependency),{value:ne}=(0,b().fJ)(o(193302).assistantDependency),se=(0,s().K8)((()=>{var e;if(!ne)return!1;const i=ne.clientSkillHelpers.createClientGlobalSkill("fill_title");return 1===ne.assistantSurfaceValidators.filterAssistantSurfaceActionsForContext(ne.assistantSurfaceValidators.clientSkillToAssistantSurfaceAction([i]),{type:"entrypoint",entrypoint:"pageStart",pageStore:t,isMobile:G.device.isMobile,userSettings:null===(e=o(485966).default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()}).length}),[ne,G,t]),re=(0,s().K8)((()=>(0,o(842492).J)(t,G).backlinksCount),[G,t],{debugName:"PageLayoutModules.useComputedStore:numberOfBacklinks"}),ae=(0,L().Lx)({pageStore:t,numBacklinks:re}),le=(0,L().RR)({pageStore:t,numBacklinks:re}),ce=(0,P().L5)(d),de=(0,s().K8)((()=>(0,o(481148).LX)({device:G.device})),[G.device]),ue=(0,s().K8)((()=>{if(e.context===B().Rr.DraftPostInInlineComposer)return{bottomControls:[]};const n=async()=>{await(0,o(772785).O)({blockStore:t,pageViewBlockStore:K.pageViewBlockStore,environment:G})},s=async()=>{const{assistantDependency:e}=await Promise.resolve().then(o.bind(o,193302)),i=t.getTitleStore();if(!i)return;const n=await e.load();o(384221).setSelectionAtEnd({store:i}),n.executeAssistantSkillAction({environment:G,clientSkillWithParameterValues:n.clientSkillHelpers.dangerouslyCreateClientSkillWithParameterValues(n.clientSkillHelpers.createClientGlobalSkill("fill_title")),from:"block_action_menu",assistantSurfaceType:G.device.isMobile?"mobileWriter":"writer"})};try{let d=[];const p=[...e.topControls],m=()=>{if("section_hide"!==(0,x().Rn)()&&Z()){const e=J();return(0,a.jsx)(S().p,{isGray:!0,onClick:()=>{"PageDetailsStore"in G&&G.PageDetailsStore.setToggleState({environment:G,type:"discussion",id:t.id},!0)},icon:l,style:X.detailsButton,children:(0,a.jsx)(u().sA,{id:"pageViewBlock.show.pageComments",defaultMessage:"{numberOfComments, plural, one {{numberOfComments} comment} other {{numberOfComments} comments}}",values:{numberOfComments:e}})},"showcomments")}},h=()=>{if(!U)return;const e=(0,P().gV)(t),i=t.isNonEditableState();if(!e)return;const n=ee;return n&&n.length?(0,a.jsx)(o(615136).A,{propertyIds:n,store:t,collectionStore:U,disabled:y,locked:i,blockPropertyValueOverlayStore:ce?o(790245).A:o(779921).A,format:e,type:"minimal"}):void 0},v=()=>{const e=(0,M().hq)(t,{recursivelyLoadAllDiscussions:!1});if(0===e.length)return;const i=(0,a.jsx)(u().sA,{id:"pageViewBlock.showResolvedComments.button",defaultMessage:"{numberOfResolvedComments, plural, one {{numberOfResolvedComments} resolved comment} other {{numberOfResolvedComments} resolved comments}}",values:{numberOfResolvedComments:e.length}});return(0,A().Nk)(G)?(0,a.jsx)(S().p,{icon:c().b,isGray:!0,style:X.detailsButton,onClick:()=>{o(90290).B4({environment:G,blockStore:t,analyticsFrom:"page_comments",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1,discussionIds:e.map((e=>e.id))})},children:i}):(0,a.jsx)(f().Ay,{buttonPopupStore:K.resolvedDiscussionButtonPopupStore,popupType:G.device.isMobile?f().z7.SlideUp:f().z7.Popup,renderOrigin:e=>(0,a.jsx)(S().p,{icon:c().b,isGray:!0,style:X.detailsButton,...e,children:i}),render:i=>{let n;return n=G.device.isMobile?{menuType:w().gu.Modal,title:(0,a.jsx)(u().sA,{defaultMessage:"Resolved comments",id:"pageViewBlock.resolvedComments.menuTabTitle"}),right:(0,a.jsx)(o(743668).DoneMenuText,{}),onClickRight:i.close,whiteBackground:!0}:{menuType:w().gu.Popup,width:500},(0,a.jsx)(o(935091).A,{...n,children:e.map(((e,n,s)=>(0,a.jsx)(o(365060).A,{store:e,droppable:!0,render:()=>oe?(0,a.jsx)(g().PW,{store:e,format:oe.discussionHelpers.DiscussionFormat.Menu,isFirst:0===n,isOnly:1===s.length,discussionLocation:"page_discussion",showResolveButtonByDefaultIfPossible:!0,blockStore:t,onDismiss:i.close},e.id):null},e.id)))})}},"resolve-discussions")},b=e=>{const o=[];ae&&o.push((0,a.jsx)(i.Fragment,{children:(0,a.jsx)(V().y,{pageStore:t,backlinksButtonPopupStore:K.backlinksButtonPopupStore,numBacklinks:re,customization:{buttonStyles:X.detailsButton,buttonIsGray:!0}})},"backlinks"));const n="hidden"===e.type,s=n&&m();s&&o.push((0,a.jsx)(i.Fragment,{children:s},"discussions"));const r=v();r&&!n&&o.unshift((0,a.jsx)(i.Fragment,{children:r},"resolveddiscussions"));const l=h();return l&&o.push((0,a.jsx)(i.Fragment,{children:l},"minimalpagesections")),o};if(d=b(q),("always"===le||"onHover"===le)&&!de){const e={isBottomControl:!1,..."always"===le?{forceVisible:!0}:{}};p.unshift((0,a.jsx)(i.Fragment,{children:(0,a.jsx)(V().y,{pageStore:t,backlinksButtonPopupStore:K.backlinksButtonPopupStore,numBacklinks:re,customization:{buttonStyles:E(e),buttonIsLightGray:!0}})},"backlinks"))}"section_hide"===(0,x().Rn)()||t.isCollectionView()||t.isInsideCollection()||Z()||!t.canComment()||!G.currentUser.isLoggedIn()||K.pageViewBlockStore.state.forceDiscussionOpen||t.pathIsDead()||t.isTeamPost()||y||de||p.push((r={isBottomControl:!1},(0,a.jsx)(S().p,{style:E({isBottomControl:r.isBottomControl}),isLightGray:!0,onClick:n,icon:l,children:G.device.isSmallPhone?(0,a.jsx)(u().sA,{id:"pageViewBlock.add.pageCommentMobile",defaultMessage:"Comment"}):(0,a.jsx)(u().sA,{id:"pageViewBlock.add.pageComment",defaultMessage:"Add comment"})},"addcomment"))),se&&p.push((0,a.jsx)(S().p,{style:E({isBottomControl:!1}),isBlue:!0,onClick:s,icon:o(836352).D,children:(0,a.jsx)(u().sA,{id:"pageViewBlock.add.fillTitle",defaultMessage:"Fill page title"})},"fill-title"));return{headerControls:(0,a.jsx)("div",{className:ce?_().S6D:void 0,children:(0,a.jsx)(o(381959).A,{store:t,context:e.context,children:p})}),bottomControls:d}}catch(d){return{bottomControls:[]}}var r}),[e.context,e.topControls,K.pageViewBlockStore,K.resolvedDiscussionButtonPopupStore,K.backlinksButtonPopupStore,G,t,E,Z,y,q,le,se,ce,J,X.detailsButton,U,ee,oe,ae,re,de],{debugName:"PageLayoutModules(headerAndBottomControlsStore).useComputedStore"});return(0,a.jsxs)(h().A,{name:"PageLayoutModules",children:[(0,a.jsx)(v().s,{style:{display:"contents"},allowSelectionWithin:!1,children:(0,a.jsx)(k,{store:t})}),W.map((i=>(0,a.jsx)(o(976540).S,{from:`PageLayout.${i.type}`,fallback:e=>{let{error:t,errorId:o}=e;return(0,a.jsx)(te,{error:t,errorId:o,type:i.type})},getParentEl:()=>N.current,children:(0,a.jsx)(ie,{editorContentContainerRef:H,module:i,context:d,postContext:m,pageViewBlockStore:K.pageViewBlockStore,disabled:y,environment:G,bottomControls:ue.bottomControls,headerControls:ue.headerControls,horizontalPadding:$,inlinePropertyIDs:Q,isEditable:D,isInPeek:ce,onDetailMouseEnter:F,onDetailMouseLeave:z,onHeaderMouseEnter:T,onHeaderMouseLeave:j,pageCoverHeight:R,pageViewBlockAccessor:O,headerFocusStore:K.headerFocusStore,store:t,collectionStore:U,collectionSchema:Y,bottomControlsStyle:X.bottomControls,templatePickerMenuListStore:C,pageTitleWithIconProps:e,modules:W,pageDiscussionsRenderState:q})},i.id)))]})};function ie(e){const{module:t,modules:o,context:i,postContext:r,disabled:l,environment:c,bottomControls:u,headerControls:p,horizontalPadding:g,inlinePropertyIDs:S,isEditable:f,isInPeek:b,onDetailMouseEnter:C,onDetailMouseLeave:k,onHeaderMouseEnter:x,onHeaderMouseLeave:w,pageCoverHeight:P,pageViewBlockAccessor:M,headerFocusStore:A,store:L,collectionStore:V,collectionSchema:H,bottomControlsStyle:N,templatePickerMenuListStore:G,pageTitleWithIconProps:U,pageDiscussionsRenderState:Y,editorContentContainerRef:q}=e,{isMobile:Q}=(0,n().Y0)(),{pageVisitStore:$,presenceStore:ee}=(0,I().S)({store:L,environment:c,postContext:r}),te=(0,s().K8)((()=>!!V&&(0,R().v)({collectionStore:V,module:t,isMobile:Q})),[V,Q,t]),oe="page_main",ie=(0,Z().Jh)({layoutModule:t,area:oe,collectionSchema:H,collectionStore:V,showDetailsPanelToggleButtonBelowTitle:te,modules:o,context:i,postContext:r}),ne=(0,Z().Br)({layoutModule:t,area:oe,collectionSchema:H,collectionStore:V,pageMainModules:o,showDetailsPanelToggleButtonBelowTitle:te}),se=(0,s().K8)((()=>T().default.checkGate({gateName:"side_peek_transition_improvements"})&&i===B().Rr.PeekView&&j().default.state.open&&"side_peek"===j().default.state.mode&&(j().default.state.isOpening||j().default.state.isClosing)&&("editor"===t.type||"views"===t.type||"viewsMain"===t.type)),[i,t.type]);return(0,a.jsx)(h().A,{name:"PageLayoutModule",children:(()=>{if(se)return(0,a.jsx)("div",{className:_().GSK,children:(0,a.jsx)(y().A,{style:{width:"100%",height:"30px",display:"block",marginTop:32,borderRadius:8}})});if((0,d().gx)(t))return(0,a.jsx)(z().v,{context:i,disabled:l,propertyId:t.propertyId,store:L,pageModule:t,wrapper:ie,stackPropertyLabelAndValue:!0});switch(t.type){case"cover":return(0,a.jsx)(E().f,{store:L,isEditable:f,paddingX:g,pageCoverHeight:P,onMouseEnter:x,onMouseLeave:w,isInPeek:b});case"normalizedTitleWithIcon":return ie((0,a.jsx)(W().H,{handleHeaderMouseEnter:x,handleHeaderMouseLeave:w,headerControls:p,headerFocusStore:A,layoutModule:t,...U}));case"properties":return(0,a.jsx)(F().h,{context:i,disabled:l,store:L,layoutModule:t,customization:{neverShowPropertiesElsewhereInLayout:!0,disableContainerPadding:!0},wrapper:ie,showDefaultTitle:ne});case"inlinePageSections":return(0,a.jsx)(D().LG,{context:i,disabled:l,inlinePropertyIDs:S,store:L,wrapper:ie});case"expandedBacklinks":case"transcript":case"formTitle":case"formQuestion":case"formSubmit":case"placeholder":case"deleted_property":case"recentActivity":case"collaborators":case"teamspaces":return null;case"discussions":return r===B().Rr.DraftPostInInlineComposer||r===B().Rr.DraftPostInFullPageComposer?null:r===B().Rr.PostInFullPageOrPeek?(0,a.jsx)(K().d,{store:L,wrapper:ie,showDefaultTitle:!1,discussionLocation:"post_top_level_discussion",pageDiscussionsRenderState:Y,presenceStore:ee,pageVisitStore:$}):(0,a.jsx)(K().d,{store:L,wrapper:ie,showDefaultTitle:ne,discussionLocation:"page_discussion",pageDiscussionsRenderState:Y});case"bottomControls":return 0===u.length?null:ie((0,a.jsx)(v().s,{allowSelectionWithin:!0,children:(0,a.jsx)("div",{style:N,className:"notion-page-details-controls",onMouseEnter:C,onMouseLeave:k,children:u})}));case"editor":return(0,a.jsx)(O().p,{context:i,disabled:l,handlePlaceholderWrapClick:e=>m().YB(e,L,c),pageBlockStore:L,pathToBlockId:t.pathToBlockId,templatePickerMenuListStore:G,pageViewBlockAccessor:M,ref:q,editorWrapper:i===B().Rr.DraftPostInInlineComposer?void 0:ie});case"viewsMain":case"views":return(0,a.jsx)(X,{pageStore:L,disabled:l,viewsModule:t,wrapper:ie,templatePickerMenuListStore:G,editorContentContainerRef:q});case"relationsGroup":return(0,a.jsx)(J().z,{pageStore:L,wrapper:ie,disabled:l,context:i,showDefaultTitle:ne})}})()})}},56255:(e,t,o)=>{o.d(t,{A:()=>d});var i=o(242343),n=()=>o(237385),s=()=>o(738677),r=()=>o(927999),a=()=>o(84543),l=()=>o(209684),c=o(163643);function d(e){const{store:t,afterOnClick:o,style:d,label:u}=e,p=(0,n().v3)(),m=(0,i.useCallback)((()=>{a().createAndCommit({userAction:"PageAddIconButton.handleAddRandomIconClick",environment:p,canUndo:!0,perform:e=>{r().vc({store:t,transaction:e})}}),o()}),[p,o,t]);return(0,c.jsx)(l().p,{style:d,isLightGray:!0,onClick:m,icon:s().A,children:u},"add-icon")}},86979:(e,t,o)=>{o.d(t,{Bs:()=>d,L:()=>c,Ob:()=>l});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(771702);var i=o(242343),n=()=>o(269280),s=()=>o(551919),r=()=>o(885237),a=()=>o(211923);const l=new class{constructor(){this.currentPageId=void 0,this._localStorage=void 0}startCachingViewIds(e){this.currentPageId=e;this.entryForPage(e).v=[]}stopCachingViewIds(){const e=this.currentPageId;if(this.currentPageId=void 0,e){0===this.entryForPage(e).v.length&&delete this.localStorage[e]}}registerView(e,t){if(this.currentPageId!==e)return;const o=this.entryForPage(e);o.v=[...new Set([...o.v,t])],o.t=Date.now(),this.writeToLocalStorage()}unregisterView(e,t){const o=this.localStorage[e];o&&(o.v=o.v.filter((e=>e!==t)),0===o.v.length&&delete this.localStorage[e],this.writeToLocalStorage())}lookupViewIds(e){const t=this.localStorage[e];return(null==t?void 0:t.v)??[]}clear(){this.currentPageId=void 0,this._localStorage=void 0}get localStorage(){return this._localStorage??(this._localStorage=r().A.get(a().O)||Object.create(null))}entryForPage(e){let t=this.localStorage[e];return t||(t={v:[],t:0},this.localStorage[e]=t),t}writeToLocalStorage(){this.limitLocalStorageSize(),r().A.set(a().O,this.localStorage)}limitLocalStorageSize(){const e=Object.keys(this.localStorage);if(e.length>=100){const t={timestamp:Number.MAX_SAFE_INTEGER,key:void 0};e.forEach((e=>{e!==this.currentPageId&&this.localStorage[e].t<t.timestamp&&(t.timestamp=this.localStorage[e].t,t.key=e)})),t.key&&delete this.localStorage[t.key]}}};function c(e){let{collectionContextStore:t,isFullScreen:o,wasCreatedThisSessionStore:n,didDelayOffscreenRenderRef:s,environment:r}=e;const a=(0,i.useCallback)((()=>{var e;const o=null===(e=t.collectionViewStore())||void 0===e?void 0:e.id,i=r.RouterStore.state.route;if("page"!==i.name)return;const n=i.blockId;n&&o&&(s.current?(l.unregisterView(n,o),t.shouldDelayRenderStore.removeListener(a)):l.registerView(n,o))}),[t,s,r]);(0,i.useEffect)((()=>{var e;if(o||n.state)return;const i=null===(e=t.collectionViewStore())||void 0===e?void 0:e.id,s=r.RouterStore.state.route;if("page"!==s.name)return;return s.blockId&&i?(t.shouldDelayRenderStore.addListener(a),a(),()=>{t.shouldDelayRenderStore.removeListener(a)}):void 0}),[t,o,n,r,a])}function d(e){let{pageId:t,isFrameContext:o}=e;(0,n().l)((()=>{o&&l.startCachingViewIds(t)})),(0,s().X)((()=>{o&&l.stopCachingViewIds()}))}},92627:(e,t,o)=>{o.d(t,{v:()=>w});var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(946854),a=()=>o(520852),l=()=>o(319638),c=()=>o(943540),d=()=>o(388615),u=()=>o(610271),p=()=>o(743661),m=()=>o(367859),g=()=>o(838517),h=()=>o(667653),v=()=>o(779921),S=()=>o(474473),f=()=>o(797470),y=()=>o(790245),b=()=>o(446464),C=()=>o(639659),k=()=>o(696088),_=()=>o(604284),x=o(163643);function w(e){const{store:t,context:o,propertyId:w,disabled:P,wrapper:M,pageModule:I,stackPropertyLabelAndValue:A}=e,T=(0,g().bx)(t,P),B=(0,s().K8)((()=>t.getAssociatedCollectionStore()),[t]),j=(0,s().K8)((()=>null==B?void 0:B.getParentStore()),[B]),L=(0,s().K8)((()=>{if(t.isCollectionViewPageWithContent())return{type:"hidden"};const e=t.getAssociatedCollectionStore();return e?{type:"visible",store:t,collectionStore:e,propertyId:w}:{type:"hidden"}}),[w,t]),V=(0,s().K8)((()=>null==B?void 0:B.getSchema()),[B]),R=(0,s().K8)((()=>null==B?void 0:B.getFormat()),[B]),D=(0,s().K8)((()=>{var e;return null===(e=L.collectionStore)||void 0===e?void 0:e.getSchema()[w]}),[L.collectionStore,w]),E=(0,s().K8)((()=>t.isNonEditableState()),[t]),K=(0,i.useMemo)((()=>new(S().YB)),[]),O=i.useRef(null),F=(0,s().K8)((()=>!(!B||!j||"block"!==j.table)&&(0,a().v)({collectionStore:B,collectionViewBlockStore:j,checkNavigableAncestorLocked:!1})),[B,j]),z=o===f().Rr.PeekView,W=(0,r().gx)(I)?I:void 0,{isPropertyInPageDetails:H}=(0,_()._1)({store:t,propertyId:w}),{isMobile:N}=(0,n().v3)().device,G=(0,h().s)(O,50),U=(0,k().l)(t),Y=(0,s().K8)((()=>{var e;return"hide"===(null==U||null===(e=U.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[U]),q=(0,C().a)();if(!D)return null;if("hidden"===L.type)return null;if(!B||!V||!R)return null;const Q=!q&&"relation"!==D.type,X=!q,$=(0,b().Ge)({isMobile:N,stackPropertyLabelAndValue:A,isPropertyInPageDetails:H}),J=(0,x.jsx)(l().L_,{store:t,propertyId:w,style:H||N?{flexShrink:0}:{position:"absolute",left:null!=G&&G.width?G.width+4:void 0,top:0}}),Z=(0,x.jsxs)(x.Fragment,{children:[Q&&(0,x.jsxs)(u().Ye,{alignItems:"center",justifyContent:H?void 0:"space-between",style:$?{width:$,flexShrink:0}:void 0,children:[(0,x.jsx)(p().I,{schema:V,format:R,hideIcon:Y,hideDragHandle:!0,property:w,blockStore:t,collectionStore:B,pagePropertiesStore:K,disabled:P,locked:E,canConfigureCollection:F,isInPeekRenderer:z,styleVariants:{width:(0,b().aG)({stackPropertyLabelAndValue:A}),height:A?{variant:"small"}:{variant:"medium"},size:"small",fontWeight:"medium"},layoutModule:W,hideDuplicatePropertyOption:!0}),X?J:null]}),(0,x.jsx)(m().A,{store:t,analyticsName:"page_property",children:(0,x.jsx)(c().qm,{store:t,property:w,disabled:!T,locked:E,format:"property_module",tableWrap:!0,blockPropertyValueOverlayStore:z?y().A:v().A,collectionStore:L.collectionStore,isInPeekRenderer:z,propertyModule:W},w)})]});return M((0,x.jsx)(d().s,{allowSelectionWithin:!0,style:{position:"relative",width:"100%"},children:A?(0,x.jsx)(u().wt,{ref:O,children:Z}):(0,x.jsx)(u().Ye,{ref:O,style:{alignItems:"flex-start"},children:Z})}))}},133872:(e,t,o)=>{o.d(t,{F:()=>a});o(242343);var i=()=>o(174114),n=()=>o(653998),s=()=>o(966789),r=o(163643);function a(){const e=(0,i().IS)((e=>({wrapper:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,marginTop:"12vh"},message:{fontSize:14,marginTop:8,color:e.text.secondary}})),[]);return(0,r.jsxs)("div",{style:e.wrapper,children:[(0,r.jsx)(s().A,{}),(0,r.jsx)("div",{style:e.message,children:(0,r.jsx)(n().sA,{defaultMessage:"Importing…",id:"frame.importingMessage"})})]})}},144451:(e,t,o)=>{o.d(t,{Br:()=>w,Jh:()=>x,Lb:()=>f,YE:()=>y,cu:()=>P});o(610931),o(725707),o(500234);var i=o.n(o(309102)),n=o(242343),s=()=>o(237385),r=()=>o(803290),a=()=>o(946854),l=()=>o(76394),c=()=>o(896433),d=()=>o(518471),u=()=>o(481148),p=()=>o(797470),m=()=>o(604284),g=()=>o(926537),h=()=>o(998182),v=()=>o(116485),S=o(163643);const f=12,y=12,b=10,C=10,k=8;function _(e){let{collectionSchema:t,module:o}=e;return!(!t||"normalizedTitleWithIcon"!==o.type)&&(0,m().LD)({collectionSchema:t,module:o}).length>0}function x(e){let{layoutModule:t,area:o,context:u,collectionSchema:m,collectionStore:x,showDetailsPanelToggleButtonBelowTitle:w,modules:P,postContext:M}=e;const{isMobile:I}=(0,s().Y0)(),A=P.findIndex((e=>e.id===t.id)),T=null!=P&&P.length&&-1!==A?P[A+1]:void 0,B=(0,h().p)({collectionStore:x,layoutModule:T}),j=(0,c().aN)(x),L=(0,r().K8)((()=>Boolean(null==x?void 0:x.isPageTreeCollection())),[x]),[V,R]=(0,n.useMemo)((()=>{const e=_({collectionSchema:m,module:t});let i=!1;const n={};if("page_details"===o||"person_profile_page_details"===o)n.marginBottom=b,n.paddingBottom=C;else if("page_main"===o||"person_profile_page_main"===o)n.marginBottom=y,n.paddingBottom=f;else if("views_main_tab_modules"===o)n.marginBottom=y,n.paddingBottom=f;else{if("form_layout_schema"===o||"form_conditional_modules"===o)throw new Error("Not implemented for forms");(0,l().HB)(o)}const s="editor"===(null==T?void 0:T.type);(0,d().Mi)(M)?"editor"===t.type&&M!==p().Rr.DraftPostInFullPageComposer?i=!0:"normalizedTitleWithIcon"===t.type&&(n.marginBottom=void 0,n.paddingBottom=k):s&&(i=!0,"normalizedTitleWithIcon"!==t.type||e||(i=!1,n.marginBottom=void 0,n.paddingBottom=void 0),"views_main_tab_modules"===o&&(i=!1,n.marginBottom=void 0,n.paddingBottom=void 0)),B&&n.marginBottom&&(n.marginBottom=Math.max(n.marginBottom-4,0)),"page_main"!==o&&"page_details"!==o&&"views_main_tab_modules"!==o||("discussions"===t.type?n.marginLeft=0:"normalizedTitleWithIcon"===t.type?n.marginLeft=-4:(0,a().gx)(t)||"properties"===t.type||"relationsGroup"===t.type?n.marginLeft=-6:"editor"===t.type&&(n.marginLeft=-2));const r="views"===(null==T?void 0:T.type)||"editor"===(null==T?void 0:T.type);return"page_main"!==o&&"page_details"!==o||!n.paddingBottom||r||("property_text"===t.type||"property_relation"===t.type&&j?n.paddingBottom=Math.max(n.paddingBottom-4,0):"properties"===t.type&&(L&&!I||(n.paddingBottom=Math.max(n.paddingBottom-4,0))),"viewsMain"===(null==T?void 0:T.type)&&(n.paddingBottom=Math.max(n.paddingBottom-12,0))),"normalizedTitleWithIcon"===t.type&&(e?I&&"properties"===(null==T?void 0:T.type)&&!B&&(n.paddingBottom=void 0,n.marginBottom=4):(w?"discussions"===(null==T?void 0:T.type)&&(n.marginBottom=void 0):"properties"===(null==T?void 0:T.type)?(n.paddingBottom=void 0,n.marginBottom=8):"discussions"===(null==T?void 0:T.type)&&(n.paddingBottom=f),I&&"discussions"===(null==T?void 0:T.type)&&(n.marginBottom=void 0))),"bottomControls"===t.type&&(n.paddingBottom=void 0,n.marginBottom=void 0),"discussions"===t.type&&s&&(n.paddingBottom=void 0),"inlinePageSections"!==(null==T?void 0:T.type)&&"expandedBacklinks"!==(null==T?void 0:T.type)&&"bottomControls"!==(null==T?void 0:T.type)||(n.marginBottom=8),"editor"!==t.type||(0,d().Mi)(M)||u===p().Rr.Presentation||(n.marginTop=8),("views"===t.type||"editor"===t.type&&!(0,d().Mi)(M))&&(n.paddingBottom=void 0,n.marginBottom=void 0),"viewsMain"===t.type&&(n.paddingBottom=void 0),u===p().Rr.DraftPostInInlineComposer&&(n.marginBottom=4,n.paddingBottom=0),[i,n]}),[m,t,o,null==T?void 0:T.type,B,L,u,j,I,w,M]);return(0,n.useMemo)((()=>function(e){return(0,S.jsx)(v().vV,{className:i()({"layout-content-with-divider":V}),style:R,testId:(0,g().H)(t),children:e})}),[t,V,R])}function w(e){let{layoutModule:t,area:o,collectionSchema:i,collectionStore:n,showDetailsPanelToggleButtonBelowTitle:a,pageMainModules:l}=e;const c=(0,s().Y0)(),d=(0,r().K8)((()=>{if(!n)return!1;return!!l.find((e=>"normalizedTitleWithIcon"===e.type))&&a}),[n,l,a]),p=(0,u().Dw)({device:c});if(!n)return!1;if("properties"!==t.type&&"discussions"!==t.type&&"relationsGroup"!==t.type)return!1;if("page_main"!==o)return!0;const m=l.findIndex((e=>e.id===t.id));if(0===m||l.length<=1)return!1;if("discussions"===t.type&&p)return!1;const g=l[m-1];if("normalizedTitleWithIcon"!==(null==g?void 0:g.type))return!0;if("relationsGroup"===t.type&&d)return!0;if("properties"===t.type&&d&&!c.isMobile)return!0;const h=_({collectionSchema:i,module:g});return("properties"!==t.type||!c.isMobile||!h)&&h}function P(e){let{collectionStore:t,modulesByArea:o}=e;return!((t.getNormalizedPropertyGroups({publicPageDataFallbackEnabled:!0})||[]).length>0)&&0===(0,m().Ul)({collectionStore:t,modulesByArea:o}).length}},159275:(e,t,o)=>{o.d(t,{S:()=>c});var i=o(242343),n=()=>o(803290),s=()=>o(280810),r=()=>o(797470),a=()=>o(79492);const l=new(o(283812).Y)((e=>new(o(350525).A)));function c(e){let{store:t,environment:o,postContext:c}=e;const{pageVisitStore:d,presenceStore:u}=(0,n().K8)((()=>({pageVisitStore:l.get(t),presenceStore:new(a().A)})),[t]);return(0,i.useEffect)((()=>{!c||c!==r().Rr.PostInFullPageOrPeek&&c!==r().Rr.PostInFeed||(t.id!==d.state.pageId&&d.setState({...d.getInitialState(),pageId:t.id}),s().Ds(o,{blockStore:t,pageVisitStore:d,incremental:!1,includeTotalCount:!0}))}),[t,d,o,u,c]),{pageVisitStore:d,presenceStore:u}}},169280:(e,t,o)=>{o.d(t,{A:()=>p});var i=o(242343),n=()=>o(237385),s=o(163643);const r=(0,o(680369).wt)("addPageCover",{viewBox:"0 0 14 14",svg:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 0a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm0 12h10L8.5 5.5l-2 4-2-1.5L2 12z"})});var a=()=>o(653998),l=()=>o(743456),c=()=>o(84543),d=()=>o(403328),u=()=>o(209684);function p(e){const{store:t,style:o,label:p}=e,m=(0,n().v3)(),[g,h]=(0,i.useState)(!1),v=(0,n().Y0)(),S=(0,i.useCallback)((async()=>{const e=t.getCoverStore();if(!e)return;if(e.getValue())return;h(!0);const o=await d().f.load();c().createAndCommit({userAction:"PageViewBlock.handleAddRandomCoverClick",environment:m,canUndo:!0,perform:i=>{l().Oj({transaction:i,store:t,coverStore:e,pageCovers:o})}}),h(!1)}),[m,t]);return!0===g?(0,s.jsx)(u().p,{style:o,isLightGray:!0,disabled:!0,icon:r,children:v.isSmallPhone?(0,s.jsx)(a().sA,{id:"pageAddCoverButton.add.pageCoverMobileLoading",defaultMessage:"Loading"}):(0,s.jsx)(a().sA,{id:"pageAddCoverButton.add.pageCoverLoading",defaultMessage:"Loading cover"})},"add-cover-loading"):(0,s.jsx)(u().p,{style:o,isLightGray:!0,onClick:S,icon:r,children:p},"add-cover")}},279923:(e,t,o)=>{o.d(t,{l:()=>s});var i=()=>o(129978);const n=new(i().O2)("GenerateSocialMediaPreviewImageWrapper",(async()=>Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,82276)))),s=(0,i()._h)(n,(e=>e.GenerateSocialMediaPreviewImageWrapper))},290557:(e,t,o)=>{o.d(t,{Ap:()=>d,Lx:()=>p,RR:()=>u,X1:()=>c});var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(76394),a=()=>o(817150),l=()=>o(712048);function c(e){const{format:t}=e;return{backlinksConfiguredToShowAboveTitle:(0,s().K8)((()=>{const e=(0,l().nl)(t.page_section_visibility);return"section_collapsed"===e||"always_show"===e}),[t.page_section_visibility])}}function d(e){const{store:t,format:o}=e,s=(0,n().v3)();return{backlinksVisibility:(0,l().nl)(o.page_section_visibility),updateBacklinksVisibility:(0,i.useCallback)((e=>{const i=(0,l().SB)(e);a().OD({environment:s,pageSection:"backlinks",visibility:i,store:t,format:o})}),[s,t,o])}}function u(e){const{pageStore:t,numBacklinks:o}=e,{store:i,format:n}=(0,s().K8)((()=>{const e=t.getAssociatedCollectionStore()??t,o=e.getFormat();return{store:e,format:o}}),[t]),{backlinksVisibility:a}=d({store:i,format:n});return 0===o?"never":"always_show"===a?"always":"section_collapsed"===a?"onHover":"section_hide"===a?"never":void(0,r().HB)(a)}function p(e){return!1}},356527:(e,t,o)=>{o.d(t,{u:()=>n});class i extends(()=>o(129044))().default{getInitialState(){return{discussionsHeight:0}}setDiscussionsHeight(e){this.setState({...this.state,discussionsHeight:e})}resetHeights(){this.setState({discussionsHeight:0})}getTotalHeight(){return this.state.discussionsHeight}}const n=new i},366691:(e,t,o)=>{o.d(t,{F:()=>n});class i extends(()=>o(129044))().default{getInitialState(){return{isOpen:!1}}}const n=new i},371854:(e,t,o)=>{o.d(t,{v:()=>y});o(725707),o(324989);var i=()=>o(237385),n=()=>o(803290),s=()=>o(162901),r=()=>o(446588),a=()=>o(409211),l=()=>o(975392),c=()=>o(23371),d=()=>o(782422),u=()=>o(352723),p=()=>o(485966),m=()=>o(985532),g=()=>o(836331),h=()=>o(261804),v=()=>o(14679),S=()=>o(472951);const f=100;function y(){const e=(0,i().v3)(),t=(0,n().O$)(p().AppStoreCurrentSpaceStore),o=(0,n().K8)((()=>(0,d()._m)(e)),[e]),y=(0,n().K8)((()=>{const{spaceId:e,userId:i}=h().A.state.emptyQueryUserRequestStore.state.request??{};return(null==t?void 0:t.id)!==e||(null==o?void 0:o.id)!==i}),[t,o]),b=(0,n().K8)((()=>{const e=m().A.state.shouldUseEdgeCache,t=g().default.checkGate({gateName:"edge_cache_mentions"});return e&&t}),[]);(0,s().Yb)((async()=>{if(!b||!t||!y)return;h().A.state.emptyQueryUserRequestStore.setState({...h().A.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0}),await S().k.waitUntilLoaded();const e=S().k.getSortedUserIds(),i=p().default.state.mainEditorCurrentBlockStore,n=i?(0,u().i0)(i).flatMap((e=>{let{permissionItem:t}=e;return(0,r().B2)(t)?[t.user_id]:[]})):[],s=(0,l().sb)([...(0,l().oE)([null==o?void 0:o.id]),...e,...n]),d=(0,c().lX)(s.slice(0,f),f,(async e=>{if(e===(null==o?void 0:o.id))return null==o?void 0:o.getValue();const i=v().L.createChildStore(t,{table:a().oo,id:e});return await i.load(),i.getValue()})),m=await d;h().A.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:(0,l().oE)(m),request:{spaceId:t.id,userId:(null==o?void 0:o.id)??""}})}),[t,o,y,b])}},385045:(e,t,o)=>{function i(){return{textIndent:"27px",marginLeft:"-27px"}}o.d(t,{i:()=>i})},394094:(e,t,o)=>{o.d(t,{H:()=>D});var i=o(242343),n=()=>o(237385),s=()=>o(152058),r=()=>o(803290),a=()=>o(545250),l=()=>o(34662),c=()=>o(193302),d=()=>o(880195),u=()=>o(388615),p=()=>o(385045),m=()=>o(546057),g=()=>o(229419),h=()=>o(983050),v=()=>o(502852),S=()=>o(400885),f=()=>o(724903),y=()=>o(392608),b=()=>o(515347),C=()=>o(799220),k=()=>o(797470),_=()=>o(141122),x=()=>o(604284),w=()=>o(248584),P=()=>o(902628),M=()=>o(971052),I=()=>o(144451),A=()=>o(116485),T=o(163643);function B(e){let{onMouseEnter:t,onMouseLeave:o,headerControls:i}=e;return(0,T.jsx)("div",{onMouseEnter:t,onMouseLeave:o,children:i})}var j=()=>o(692347),L=()=>o(991649),V=()=>o(216030);const R=0;function D(e){const{store:t,hasCover:o,headerFocusStore:D,headerControls:E,isEditable:K,openMenuOnMount:O,openMenuOnMountCallback:F,pageViewBlockStore:z,discussionInputStore:W,handleHeaderMouseEnter:H,handleHeaderMouseLeave:N,hideTitleIfEmpty:G,isInPageLayoutModuleEditor:U=!1,layoutModule:Y,disabled:q,...Q}=e,X=(0,n().v3)(),{WindowSizeStore:$}=X,{isMobile:J,isAndroid:Z}=(0,n().Y0)(),[ee,te]=(0,i.useState)((()=>!!Z));(0,i.useEffect)((()=>{(async()=>{if((0,y().w6)(X)){const e=X.RouterStore.getState();if((0,a().bh)(e.route)){await t.load();const e=(0,b().GN)(t),o=null==e?void 0:e.getSiteStore();await(null==o?void 0:o.load());const i=null==o?void 0:o.getSettings(),n=null==i?void 0:i.embedSettings;return void te(Boolean(!(null!=n&&n.hideTitle)))}}te(!0)})()}),[X,t]);const oe=(0,r().K8)((()=>(0,f().cq)(t)),[t]),ie=(0,r().K8)((()=>oe&&(_().default.isSidePeekOpen()||_().default.isSidePeekClosingStore.state)),[oe]),{context:ne}=Q,se=k().m8.has(ne),re=(0,p().i)(),ae=J&&!o,le=!J&&Q.isInSidePeek||se,ce=(0,r().K8)((()=>t.isExternalObjectInstancePageBlockStore()&&t.hasError()?t:null),[t]),de=(0,r().K8)((()=>t.canEdit()),[t]),ue=(0,r().K8)((()=>$.getSafePaddingLeftCSS(R)),[$]),pe=(0,r().K8)((()=>$.getSafePaddingRightCSS(R)),[$]),me=(0,r().K8)((()=>(0,S().NR)(t,X)),[t,X]),ge=(0,w().Sm)(t),he=(0,i.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,s().p)(t)&&D.setState(!0)}),[D]),ve=(0,i.useCallback)((()=>{D.setState(!1)}),[D]),Se=(0,T.jsx)("div",{className:oe?h().S6D:void 0,style:{display:"flow-root",pointerEvents:"auto"},children:(0,T.jsx)(j().A,{store:t,isEditable:K,hasCover:o,isInSidePeek:Q.isInSidePeek,openMenuOnMount:O,openMenuOnMountCallback:F,isInPageLayoutModuleEditor:U,isInlinePostTitle:se})}),fe=se?(0,T.jsx)(u().s,{allowSelectionWithin:!1,children:Se}):Se,ye=(0,r().K8)((()=>{var e;return(0,l().w9s)(null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue())}),[t]),be=(0,T.jsx)(V().s,{store:t,disabled:q,hideText:G&&ye||!ee,...Q}),Ce=(0,r().K8)((()=>t.getAssociatedCollectionStore()),[t]),ke=(0,r().K8)((()=>!(!Ce||!Y)&&(0,M().v)({collectionStore:Ce,module:Y,isMobile:J})),[Ce,J,Y]),_e=(0,r().K8)((()=>null==Ce?void 0:Ce.getSchema()),[Ce]),xe=_e&&Y?(0,x().LD)({collectionSchema:_e,module:Y}):void 0,we=(0,i.useMemo)((()=>{const e={...Boolean(null==xe?void 0:xe.length)&&(J?{paddingBottom:20}:{paddingBottom:I().Lb})};return(0,T.jsxs)(T.Fragment,{children:[Ce&&ke&&(0,T.jsx)("div",{style:e,children:(0,T.jsx)(P().L,{collectionStore:Ce,pageViewBlockContext:ne})}),Boolean(null==xe?void 0:xe.length)&&(0,T.jsx)("div",{style:{paddingTop:J&&!ke?I().Lb:void 0,marginLeft:-2},children:(0,T.jsx)(L().h,{context:ne,disabled:q,store:t,variant:"pinned",layoutModule:Y,propertyIds:xe,wrapper:e=>(0,T.jsx)(A().vV,{children:e}),customization:{disableContainerPadding:!0,disableLastRowBottomPadding:!0}})})]})}),[Ce,J,Y,ne,xe,q,ke,t]),Pe=(0,r().K8)((()=>(0,C().Fm)(t)),[t]);return ie?(0,T.jsxs)(d().A,{name:"PageTitleWithIcon",children:[(0,T.jsxs)(u().s,{allowSelectionWithin:!0,children:[(0,T.jsx)(B,{onMouseEnter:H,onMouseLeave:N,headerControls:E}),ee&&fe,be,ge&&(0,T.jsx)(g().GL,{store:t})]}),we]}):(0,T.jsxs)(d().A,{name:"PageTitleWithIcon",children:[(0,T.jsx)("div",{style:me,onMouseEnter:H,onMouseLeave:N,children:(0,T.jsxs)("div",{style:{maxWidth:"100%",paddingLeft:ue,width:"100%"},onClick:async e=>{if(Pe){const e=await c().assistantDependency.load();await e.assistantEditActions.saveAssistantCreatedPage(X)}(0,v().SQ)({event:e,context:v().y$.PageTitleClick})},children:[(0,T.jsxs)(u().s,{onFocus:he,onBlur:ve,allowSelectionWithin:!1,style:{pointerEvents:"none"},children:[ae&&E,ee&&!le&&fe,!ae&&E]}),(0,T.jsx)("div",{style:{paddingRight:pe},children:le?(0,T.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[ee&&(0,T.jsx)("span",{style:se?{zIndex:1,position:"relative"}:void 0,children:fe}),(0,T.jsx)("span",{style:se?re:void 0,children:be}),ge&&(0,T.jsx)(g().GL,{store:t})]}):be}),ge&&(0,T.jsx)(g().GL,{store:t}),ce?(0,T.jsx)(m().A,{store:ce,canEdit:de}):null]})}),we]})}},438858:(e,t,o)=>{o.d(t,{A:()=>g,R:()=>m});o(242343);var i=()=>o(237385),n=()=>o(803290),s=()=>o(174114),r=()=>o(86211),a=()=>o(129808),l=()=>o(653998),c=()=>o(517198),d=()=>o(518471),u=()=>o(162339),p=o(163643);function m(e){let{store:t,peekMode:o,forceShowIcon:a}=e;const l=(0,i().v3)(),{isMobile:u}=l.device,m=(0,n().K8)((()=>Boolean(t.getCover())),[t]),g=(0,n().K8)((()=>Boolean(t.getIcon())),[t])||a,h=(0,n().K8)((()=>t.isCollectionView()),[t]),v=(0,n().K8)((()=>t.isFullWidth()),[t]),S=(0,n().K8)((()=>o===r().O?"20vh":(0,d().Qs)(l)),[l,o]),f=(0,s().IS)((()=>{const e=u?24:o===r().A?48:96,t=(()=>{switch(!0){case u:return 32;case g:return 96;case o===r().O&&!g:return 54;case!g:return 102}})(),i=(()=>{switch(!0){case u&&m&&g:return 22;case u&&m&&!g:return 54;case u&&!m&&g:return 56;case u&&!m&&!g:return 4;case!u&&m&&g:return 50;case!u&&m&&!g:return 58;case!u&&!m&&g:return 92;case!u&&!m&&!g:return 20}})();return{collectionCoverPhoto:{width:"100%",height:"20vh"},collectionTitleContainer:{display:"flex",alignItems:"center",paddingLeft:e,paddingRight:e,width:"100%",paddingTop:(()=>{switch(!0){case u&&m:return 50;case u&&!m:return 78;case!u&&m:return 48;case!u&&!m:return 36}})()},collectionIcon:{flexGrow:0,flexShrink:0,width:36,height:36,borderRadius:6,marginRight:10,marginLeft:3},collectionTitle:{height:u?24:30,width:600,marginTop:u?6:3,borderRadius:15},pageCoverPhoto:{width:"100%",height:S},pageCoverPadding:{width:"100%",height:t},pageIconContainer:{maxWidth:"100%",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:v?"100%":900,height:36},pageIcon:{position:"relative",top:m?-42:0,width:78,height:78,marginLeft:2,borderRadius:16},pageTitleContainer:{display:"flex",boxSizing:"border-box",paddingLeft:e,paddingRight:e,width:v?"100%":900,maxWidth:"100%",paddingTop:i},pageTitle:{marginTop:u?3:0,height:u?24:30,width:600,borderRadius:15}}}),[v,m,g,S,u,o]);return h||o===r().A?(0,p.jsxs)(p.Fragment,{children:[m&&(0,p.jsx)(c().A,{style:f.collectionCoverPhoto}),(0,p.jsxs)("div",{style:f.collectionTitleContainer,children:[g&&(0,p.jsx)(c().A,{emphasized:!0,style:f.collectionIcon}),(0,p.jsx)(c().A,{style:f.collectionTitle})]})]}):(0,p.jsxs)(p.Fragment,{children:[m?(0,p.jsx)(c().A,{style:f.pageCoverPhoto}):(0,p.jsx)("div",{style:f.pageCoverPadding}),g&&(0,p.jsx)("div",{style:f.pageIconContainer,children:(0,p.jsx)(c().A,{emphasized:!0,style:f.pageIcon})}),(0,p.jsx)("div",{style:f.pageTitleContainer,children:(0,p.jsx)(c().A,{style:f.pageTitle})})]})}function g(e){let{isVisible:t,peekMode:o,store:c}=e;const{WindowSizeStore:d}=(0,i().v3)(),g=(0,i().Y0)(),h=(0,l().tz)(),v=g.isPhone,S=g.isMobileNative,f=a().ek(g.isElectronMac),y=(0,n().K8)((()=>{const e=o===r().O||o===r().A||v?f:0;return{top:d.getSafePaddingTopCSS(e),bottom:d.getSafePaddingBottomCSS(0),left:d.getSafePaddingLeftCSS(0),right:d.getSafePaddingRightCSS(0)}}),[d,o,v,f]),b=(0,s().IS)((()=>({root:{position:"absolute",...y,display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:"none"}})),[y]);return(0,u().A)(t,S?0:10,0)?(0,p.jsx)("div",{role:"progressbar","aria-valuetext":h.formatMessage({id:"frameLoadingState.loading",defaultMessage:"Loading..."}),style:b.root,children:(0,p.jsx)(m,{store:c,peekMode:o})},"shimmer"):null}},462156:(e,t,o)=>{o.d(t,{p:()=>f,t:()=>y});o(403517),o(242343);var i=()=>o(237385),n=()=>o(803290),s=()=>o(712437),r=()=>o(653998),a=()=>o(191756),l=()=>o(686985),c=()=>o(858023),d=()=>o(701513),u=()=>o(88271),p=()=>o(842492),m=()=>o(302376),g=()=>o(216143),h=()=>o(366691),v=()=>o(248584),S=o(163643);function f(e){let{store:t}=e;return(0,S.jsx)("div",{style:{width:"100%",maxWidth:"100%",margin:"0 auto 6px auto"},onMouseDown:v().NV,onClick:v().sx,children:(0,S.jsx)(l().A,{type:"page",store:t,headerText:(0,S.jsx)(r().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"}),disableCurrentPageToken:!0,disableInaccessiblePages:!0})})}function y(e){let{store:t}=e;const o=(0,i().v3)(),r=(0,n().K8)((()=>(0,p().c)(t,o)),[t,o]),l=(0,n().K8)((()=>r.backlinks.map((e=>e.backlinkStore))),[r]).map(((e,t)=>({key:e.id,render:t=>(0,S.jsx)(d().A,{...t,store:e,hidePath:!1}),action:t=>{let{event:i}=t;h().F.setState({isOpen:!1});const n=m().Vr(i);a().uK({environment:o,store:e,openInNew:n,visitType:g().ig.Link,pageVisitSource:s().y8.Backlinks})}})));return(0,S.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:[{key:"all",items:l,render:e=>(0,S.jsx)(u().A,{...e})}]})}},506181:(e,t,o)=>{o.d(t,{A:()=>r});o(725707),o(491955);var i=()=>o(712048),n=()=>o(400885),s=()=>o(360482);function r(e){var t;const{store:o,pageViewBlockStore:r,environment:a}=e,l=s().O3(o,{recursivelyLoadAllDiscussions:!1}).sort(((e,t)=>t.getReactions().length-e.getReactions().length)),c=l.length>0,d=0===l.length,u=0===l.filter((e=>e.getComments().length>0)).length,p="PageDetailsStore"in a&&a.PageDetailsStore.getToggleState({environment:a,type:"discussion",id:o.id}),m={type:"hidden"},g=o.getAssociatedCollectionStore()??o,h="section_hide"===(0,i().z5)(null===(t=g.getFormat())||void 0===t?void 0:t.page_section_visibility);if(!(null==r?void 0:r.state.forceDiscussionOpen)&&(!o.isInsideCollection()||!d)&&(d||c&&(!1===p||void 0===p&&h)))return m;if(h)return m;const v=o.pathIsDead(),S=a.currentUser.isLoggedIn();if(d&&v)return m;const f=S&&o.canComment()&&u&&!(0,n().sV)(o)&&(!(0,n().fc)(o)||(0,n().Cg)(o));return!f&&d?m:{type:"visible",showDiscussionInput:f,unresolvedDiscussionStores:l}}},521869:(e,t,o)=>{o.d(t,{d:()=>Z});o(358848),o(91270),o(725707),o(500234),o(403517);var i=()=>o(486826),n=o(242343),s=()=>o(16791),r=()=>o(237385),a=()=>o(803290),l=()=>o(174114),c=()=>o(846581),d=()=>o(16740),u=()=>o(745719),p=()=>o(850313),m=()=>o(518797),g=()=>o(409211),h=()=>o(653998),v=()=>o(76394),S=()=>o(319638),f=()=>o(105731),y=()=>o(798096),b=()=>o(990910),C=()=>o(880195),k=()=>o(388615),_=()=>o(126451),x=()=>o(356813),w=()=>o(951156),P=()=>o(482570),M=()=>o(610271),I=()=>o(907933),A=()=>o(686329),T=()=>o(73631),B=()=>o(983050),j=()=>o(129978),L=()=>o(369789),V=()=>o(797470),R=()=>o(356527),D=()=>o(248584),E=()=>o(16126),K=()=>o(66460),O=()=>o(227268),F=o(163643);function z(e){const{store:t,discussionStore:o,isFirst:i,isOnly:s,discussionLocation:a,collapsed:l}=e,c=(0,r().v3)(),d=(0,n.useMemo)((()=>new(O().A)(c,(0,K().e)(t.pointer.spaceId))),[c,t.pointer.spaceId]),{value:u}=(0,j().fJ)(S().commentsDependency);return u?(0,F.jsx)(S().PW,{store:o,format:u.discussionHelpers.DiscussionFormat.Page,isFirst:i,isOnly:s,collapsed:l,showResolveButtonByDefaultIfPossible:!1,blockStore:t,discussionInputStore:d,..."post_top_level_discussion"===a?{discussionLocation:"post_top_level_discussion",pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore}:{discussionLocation:"page_discussion"}},o.id):null}var W=()=>o(752597),H=()=>o(158247),N=()=>o(759260),G=()=>o(384221),U=()=>o(84543),Y=()=>o(964587),q=()=>o(156282),Q=()=>o(758261),X=()=>o(413871);function $(e){const{store:t,from:o}=e,i=(0,r().v3)(),s=(0,n.useMemo)((()=>new(O().A)(i,(0,K().e)(t.pointer.spaceId))),[i,t.pointer.spaceId]),l=(0,n.useRef)(null),c=(0,n.useCallback)((()=>{G().clear({environment:i})}),[i]),d=function(e){const{environment:t,discussionInputStore:o,store:i,from:s}=e,r=(0,a().uB)(void 0,V().Ay),l=(0,n.useCallback)((e=>{var o;const n=i.id;null===(o=t.PageDetailsStore)||void 0===o||o.setToggleState({environment:t,type:"discussion",id:n},e)}),[t,i.id]);return(0,n.useCallback)((async()=>{const e=o.state.textStore.getValue(),n=o.state.files;if((!e||0===e.length)&&0===n.length)return;const a=await T().T.formulas.load(),c=(0,K().e)(i.pointer.spaceId),d=t.idCreator.getSpaceIdCreatorSync(c).deterministicIdInSavedSpace(N().$Y,`${i.id}-discussion-0`),u=d?X().sk.createChildStore(i,{table:N().$Y,id:d,spaceId:c}):void 0;await(null==u?void 0:u.load());const p=Boolean(!(null!=u&&u.getResolved())),{performResult:m}=U().createAndCommit({userAction:"PageDiscussion.useSubmitNewDiscussion",environment:t,canUndo:!0,perform:o=>(0,Y().i)({discussionId:p?d:void 0,environment:t,type:"default",blockStore:i,commentTextValue:e||[],transaction:o,files:n,formulasModule:a,fromOverride:s}),skipUpdatingEditedMetadata:!0});if(o.reset(),r.setState({...r.state,forceDiscussionOpen:!1}),l(!0),m&&!t.device.isMobile){await W().default.afterNextFlush();const e=q().A.find((e=>e.getStore().id===m.id));e&&G().setSelectionAtEnd({store:e.getInputStore().state.textStore})}}),[o,t,r,l,i,s])}({environment:i,discussionInputStore:s,store:t,from:o});(0,H().b)(Q().j,(()=>({getNode:()=>l.current,getBlockStore:()=>t,getInputStore:()=>s})),[s]);const{value:u}=(0,j().fJ)(S().commentsDependency);return u?(0,F.jsx)("div",{ref:l,children:(0,F.jsx)(S().bd,{showAvatar:!0,parentStore:t,onSubmit:d,onCancel:c,discussionInputStore:s,discussionFormat:u.discussionHelpers.DiscussionFormat.Page,isMobileSlideUpMenu:!1,shouldSaveUnsentComments:!0,canDrop:!0,blockStore:t})}):null}function J(e){const{store:t,showDiscussionInput:o,unresolvedDiscussionStores:p,discussionLocation:m,collapsed:g}=e,v=(0,r().v3)(),C=(0,h().tz)(),{value:k}=(0,j().fJ)(T().T.formulas),{value:w}=(0,j().fJ)(S().commentsDependency),P=(0,a().K8)((()=>p.find((e=>e.getReactions().length>0))),[p]),M=(0,a().K8)((()=>p.find((e=>e.getCommentPointers().length>0))),[p]),A=(0,a().K8)((()=>Boolean(P)),[P]),R=(0,a().K8)((()=>(null==M?void 0:M.getCommentPointers().length)??0),[M]),{lastReplyTime:E,lastReplyByActorStore:K}=(0,a().K8)((()=>{const e=null==M?void 0:M.getCommentStores().at(-1),t=null==e?void 0:e.getCreatedTime(),o=null==e?void 0:e.getCreatedByStore();return{lastReplyTime:t?(0,c().eV)({value:i().c9.fromMillis(t),preset:"time",locale:s().locale}):void 0,lastReplyByActorStore:o}}),[M]),O=(0,n.useCallback)((e=>{const o=M;if(!o)return;const i=e.target;(0,y().IX)({environment:v,discussionStore:o,rect:i.getBoundingClientRect(),blockStore:t,discussionLocation:"post_top_level_discussion"})}),[v,t,M]),W=(0,r().Y0)(),H=(0,l().IS)((e=>{const t={paddingTop:p.length>0?12:-1*b().Ql/2,paddingBottom:12,paddingRight:4};return{pageViewDiscussion:{width:"100%",margin:"0 auto"},newPageDiscussionWrapper:{..."post_top_level_discussion"===m?{padding:0}:t},emptyPostDiscussion:{display:"flex",justifyContent:"space-between",paddingBottom:12},reactionButton:{...null==w?void 0:w.REACTION_PILL_STYLE,width:40,paddingLeft:10,paddingRight:10,borderRadius:13,borderWidth:1,borderColor:e.stroke.secondary,borderStyle:"solid",...W.isMobile?null==w?void 0:w.MOBILE_REACTION_PILL_STYLE_OVERRIDES:{}},reactionIcon:{width:22,height:22,fill:e.icon.secondary,marginTop:-.5,marginRight:1}}}),[p.length,m,w,W.isMobile]),N=(0,l().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:12},presenceReactionsContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",...W.isMobile?{justifyContent:"flex-start",gap:4}:{}},reactionsContainer:{display:"flex",gap:6,minHeight:27},repliesButton:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",padding:4,borderRadius:6},repliesButtonContent:{display:"flex",alignItems:"center",gap:8},repliesInfo:{display:"flex",alignItems:"baseline",gap:8},replyCount:{fontSize:14,color:e.text.primary},lastReplyTime:{fontSize:12,color:e.text.tertiary}})),[W.isMobile]);if("post_top_level_discussion"===m&&(null==e?void 0:e.pageViewBlockContext)===V().Rr.PostInFeed){const o=e.pageVisitStore&&e.presenceStore,i=o&&W.isMobile;return(0,F.jsxs)("div",{style:N.container,children:[(0,F.jsxs)("div",{style:N.presenceReactionsContainer,children:[(0,F.jsxs)("div",{style:N.reactionsContainer,children:[P&&(0,F.jsx)(S().PH,{focused:!0,disableShadow:!0,parentStore:P,discussionLocation:e.discussionLocation,showAddReactionButton:!0,additionalItems:i?(0,F.jsx)(L().s9,{pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,rootStore:t,enableFacepile:!1,isShowingInPostFeed:!0}):void 0}),!A&&(0,F.jsx)(x().A,{ariaLabel:C.formatMessage({defaultMessage:"Add reaction",id:"ReactionBar.newReaction.ariaLabel"}),hasBackground:!1,showShadow:!1,style:H.reactionButton,icon:()=>(0,d().r)(H.reactionIcon),onClick:e=>{(0,f().O)({environment:v,blockStore:t,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:k})}})]}),A&&i||!o?null:(0,F.jsx)(L().s9,{pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,rootStore:t,maxUsers:5,enableFacepile:!W.isMobile,isShowingInPostFeed:!0})]}),R>0?(0,F.jsx)(_().A,{style:N.repliesButton,onClick:O,children:(0,F.jsxs)("div",{style:N.repliesButtonContent,children:[K&&(0,F.jsx)(ee,{actorStore:K,size:24}),(0,F.jsxs)("div",{style:N.repliesInfo,children:[(0,F.jsx)("div",{style:N.replyCount,children:(0,F.jsx)(h().sA,{defaultMessage:"{replyCount, plural, one {{replyCount} reply} other {{replyCount} replies}}",id:"pageLayout.discussionsModule.replyCount",values:{replyCount:R}})}),E&&(0,F.jsx)("div",{style:N.lastReplyTime,children:E})]})]})}):(0,F.jsx)("div",{style:H.newPageDiscussionWrapper,children:(0,F.jsx)($,{from:m,store:t})})]})}return(0,F.jsxs)("div",{style:H.pageViewDiscussion,onMouseDown:D().NV,onClick:D().sx,className:B().Jv,children:["post_top_level_discussion"===m&&!A&&(0,F.jsxs)("div",{style:H.emptyPostDiscussion,children:[(0,F.jsx)(x().A,{ariaLabel:C.formatMessage({defaultMessage:"Add reaction",id:"ReactionBar.newReaction.ariaLabel"}),hasBackground:!1,showShadow:!1,style:H.reactionButton,icon:()=>(0,u().s)(H.reactionIcon),onClick:e=>{(0,f().O)({environment:v,blockStore:t,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:k})}}),e.pageVisitStore&&e.presenceStore&&(0,F.jsx)(I().hJ,{pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,rootStore:t,maxUsers:5,isShowingInPostFeed:!0})]}),p.map(((o,i,n)=>(0,F.jsx)(z,{store:t,discussionStore:o,isFirst:0===i,isOnly:1===n.length,collapsed:g,..."post_top_level_discussion"===m?{discussionLocation:"post_top_level_discussion",pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore}:{discussionLocation:m}},o.id))),o&&(0,F.jsx)("div",{style:H.newPageDiscussionWrapper,children:(0,F.jsx)($,{from:m,store:t})})]})}function Z(e){const{store:t,wrapper:o,discussionLocation:i,collapsed:s,showDefaultTitle:r,pageDiscussionsRenderState:a}=e,l=(0,n.useRef)(null),c=(0,n.useCallback)((e=>{R().u.setDiscussionsHeight(e.height)}),[]);return(0,A().tK)(l,c),(0,F.jsx)(C().A,{name:"PageDiscussionsWrapper",children:"hidden"!==a.type&&o((0,F.jsxs)(M().wt,{gap:2,ref:l,children:[r&&(0,F.jsx)(E().j,{store:t,children:(0,F.jsx)(h().sA,{id:"pageLayout.discussionsModule.title",defaultMessage:"Comments"})}),(0,F.jsx)(k().s,{allowSelectionWithin:!0,children:(0,F.jsx)(J,{...a,withLegacyInputPadding:!0,store:t,collapsed:s,..."post_top_level_discussion"===i?{discussionLocation:"post_top_level_discussion",pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,pageViewBlockContext:e.pageViewBlockContext}:{discussionLocation:"page_discussion"}})})]}))})}function ee(e){const{actorStore:t,size:o}=e;return t.table===m().GP?(0,F.jsx)(w().A,{botStore:t,size:o}):t.table===g().oo?(0,F.jsx)(P().A,{userStore:t,size:o}):t.table===p().yj?(0,F.jsx)(P().A,{userStore:void 0,size:o}):void(0,v().HB)(t)}},538515:(e,t,o)=>{o.d(t,{E:()=>c});o(242343);var i=()=>o(174114),n=o(163643);const s={viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M4.825 3.3c-.842 0-1.525.683-1.525 1.525v10.35c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525V4.825c0-.842-.683-1.525-1.525-1.525zm7.2 0c-.842 0-1.525.683-1.525 1.525v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525zm0 7.2c-.842 0-1.525.683-1.525 1.525v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525z"})},r=(0,o(680369).wt)("layoutFill",s);var a=()=>o(653998),l=()=>o(209684);function c(e){const{style:t,onClick:o}=e,s=(0,i().IS)((()=>({buttonIcon:{width:18,height:18}})),[]);return(0,n.jsx)(l().p,{style:t,iconStyle:s.buttonIcon,isLightGray:!0,onClick:o,icon:r,children:(0,n.jsx)(a().sA,{id:"pageViewBlock.customizeLayout",defaultMessage:"Customize layout"})},"customize-layout")}},581101:(e,t,o)=>{o.d(t,{E:()=>g,f:()=>m});o(242343);var i=()=>o(237385),n=()=>o(803290),s=()=>o(388615),r=()=>o(615917),a=()=>o(180365),l=()=>o(983050),c=()=>o(400885),d=()=>o(248584),u=()=>o(116485),p=o(163643);function m(e){const{store:t,isEditable:o,isInPeek:c,paddingX:m,pageCoverHeight:h,onMouseEnter:v,onMouseLeave:S}=e,f=(0,i().v3)(),y=(0,n().K8)((()=>t.isCollectionView()?"20vh":h),[h,t]),b=(0,n().K8)((()=>f.WindowSizeStore.getSafePaddingLeftCSS(m)),[f.WindowSizeStore,m]),C=(0,n().K8)((()=>f.WindowSizeStore.getSafePaddingRightCSS(m)),[f.WindowSizeStore,m]),k=(0,n().K8)((()=>f.WindowSizeStore.state.width),[f.WindowSizeStore]),_=(0,d().no)(t),x=(0,n().K8)((()=>g(t,f)),[f,t]);return(0,p.jsx)(u().Pb,{style:{isolation:"isolate"},children:(0,p.jsx)(r().A,{tag:s().s,animate:{translateX:_},allowSelectionWithin:!1,className:c?l().S6D:void 0,style:x,onMouseEnter:v,onMouseLeave:S,children:(0,p.jsx)(a().A,{height:y,store:t,disabled:!o,paddingLeft:b,paddingRight:C,proxyWidth:k})})})}function g(e,t){const o=(0,c().NR)(e,t);return o.zIndex=2,o}},587912:(e,t,o)=>{o.d(t,{p:()=>U});var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(174114),a=()=>o(388615),l=()=>o(400885),c=()=>o(377561),d=o(163643);function u(e){const{pageBlockStore:t,isVisible:i,context:r}=e,u=(0,n().v3)(),p=(0,s().K8)((()=>(0,l().Ck)(t,r,u)),[t,r,u]);return(0,d.jsx)(a().s,{allowSelectionWithin:!0,style:{width:p&&i?c().Qb:0},children:(0,d.jsx)(o(319638).UY,{...e})})}var p=()=>o(880195),m=()=>o(518471),g=()=>o(712437),h=()=>o(778417),v=()=>o(653998),S=()=>o(352211),f=()=>o(373122),y=()=>o(865226),b=()=>o(621214),C=()=>o(84543),k=()=>o(520852),_=()=>o(282131),x=()=>o(452981),w=()=>o(88442),P=()=>o(29869),M=()=>o(502852),I=()=>o(485966),A=()=>o(802955),T=()=>o(836331),B=()=>o(795756),j=()=>o(937968),L=()=>o(126451),V=(o(403517),()=>o(517198));function R(){const e=(0,r().IS)((()=>({menu:{display:"flex",alignItems:"center",marginBottom:5},icon:{marginLeft:5,width:26,height:26,marginRight:10,borderRadius:4},menuItem:{height:14,marginTop:8,marginBottom:8,width:"25%",borderRadius:8}})),[]);return(0,d.jsx)(d.Fragment,{children:[...Array(6)].map(((t,o)=>(0,d.jsxs)("div",{style:e.menu,children:[(0,d.jsx)(V().A,{style:e.icon}),(0,d.jsx)(V().A,{style:e.menuItem})]},o)))})}const D={width:"100%"};const E=function(e){let{menuListStore:t,store:l}=e;(0,o(269280).l)((()=>{t.reset()}));const c=(0,n().WS)(),u=(0,s().O$)(A().e),p=(0,s().K8)((()=>l.isTeamPost()),[l]),m=(0,r().IS)((e=>({wrapStyle:{width:"100%",display:"flex",flexDirection:"column",marginBottom:p?void 0:"14vh"}})),[p]),g=(0,i.useCallback)((()=>!c&&(0,d.jsx)(R,{})),[c]);return(0,d.jsx)(a().s,{style:D,allowSelectionWithin:!1,children:(0,d.jsx)(o(579275).A,{capture:!0,render:e=>(0,o(244563).A)((o=>(0,d.jsxs)("div",{...e,...o,style:m.wrapStyle,children:[(0,d.jsx)(O,{store:l}),u&&(0,d.jsx)(x().t,{menuListStore:t,store:l,renderLoading:g})]})))})})};function K(e,t,o){const{mainEditorCurrentBlockStore:i}=I().default.state;!function(e,t,o){o?o(e):y().oo({environment:t,url:e})}(i?(0,P().Ay)({store:i,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:g().y8.LinkInPage}):(0,P().Ay)({store:e,fullyQualified:!1,pageVisitSource:g().y8.LinkInPage}),t,o)}function O(e){let{store:t}=e;const o=(0,n().v3)(),a=(0,n().Y0)(),l=(0,i.useContext)(_().n),c=(0,s().K8)((()=>B().A.getMode(o,t)),[o,t]),u=(0,i.useCallback)((e=>function(e,t,o,i){const n=o.getAssociatedCollectionStore();if(n&&(0,j().EF)(t)){const{performResult:e}=C().createAndCommit({userAction:"TemplatePicker.newPage",environment:t,canUndo:!0,perform:e=>f().bI({environment:t,collectionStore:n,transaction:e})});e&&K(e,t,i),S().er(t,{collection_id:n.id})}}(0,o,t,l)),[o,t,l]),p=(0,s().K8)((()=>t.isTemplate()),[t]),m=(0,s().O$)(A().e),g=(0,s().K8)((()=>function(e){return Boolean(e.getAssociatedCollectionStore())}(t)),[t]),y=(0,s().K8)((()=>function(e){const t=e.getAssociatedCollectionStore(),o=t?t.getTemplatePageStores():void 0;return o&&o.length>0}(t)),[t]),x=g&&!y,P=g&&y,I=(0,s().K8)((()=>{const e=t.getAssociatedCollectionStore(),o=e&&e.getParentBlockStore();return!(0,k().v)({collectionStore:e,collectionViewBlockStore:o,checkNavigableAncestorLocked:!0})}),[t]),V=(0,s().K8)((()=>(0,w().ZE)(c)),[c]),R=(0,s().K8)((()=>t.isTeamPost()),[t]),E=(0,r().IS)((e=>({placeholder:{...h().nE,color:e.text.tertiary,paddingTop:R?3:5,paddingBottom:R?3:24,paddingLeft:R?2:void 0,paddingRight:R?2:void 0}})),[R]),O=(0,s().K8)((()=>a.isMobile&&!a.isTablet&&a.isIOS&&"on"===T().default.getEligibleGroup({experimentId:"mobile_lightweight_editor_prompt",defaultGroup:"control"})),[a.isMobile,a.isIOS,a.isTablet]);let F=null;return m?p?F=(0,d.jsx)(v().sA,{defaultMessage:"{isMobileDevice, select, true {Tap here to continue with an empty page.} other {Press Enter to continue with an empty page.}}",id:"templatePicker.isTemplate.emptyPagePrompt",values:{isMobileDevice:a.isMobile}}):a.isMobile?P?F=a.isTablet?(0,d.jsx)(v().sA,{defaultMessage:"Tap here to continue with an empty page, or pick a template",id:"templatePicker.mobileTabletEmptyPage.withTemplates.prompt"}):(0,d.jsx)(v().sA,{defaultMessage:"Tap here to continue...",id:"templatePicker.mobilePhoneEmptyPage.withTemplates.prompt"}):x?F=(0,d.jsx)(v().sA,{defaultMessage:"{isParentLocked, select, true {Tap here to continue with an empty page} other {Tap here to continue with an empty page, or <templatebutton>create a template</templatebutton>}}",id:"templatePicker.mobileCollectionEmptyPage.prompt",values:{isParentLocked:I,templatebutton:e=>(0,d.jsx)(L().A,{style:{display:"inline-block",textDecoration:"underline"},onClick:u,children:e})}}):O||(F=a.isTablet?(0,d.jsx)(v().sA,{defaultMessage:"Tap here to continue with an empty page, or pick a template",id:"templatePicker.mobileTabletEmptyPage.withTemplates.prompt"}):(0,d.jsx)(v().sA,{defaultMessage:"Tap here to continue...",id:"templatePicker.mobilePhoneEmptyPage.withTemplates.prompt"})):x?F=(0,d.jsx)(v().sA,{defaultMessage:"{isParentLocked, select, true {Press Enter to continue with an empty page} other {Press Enter to continue with an empty page, or <templatebutton>create a template</templatebutton>}}",id:"templatePicker.webCollectionEmptyPage.prompt",values:{isParentLocked:I,templatebutton:e=>(0,d.jsx)(L().A,{style:{display:"inline-block",textDecoration:"underline"},onClick:u,children:e})}}):V&&!g||(F=(0,d.jsx)(v().sA,{defaultMessage:"Press Enter to continue with an empty page, or pick a template (↑↓ to select)",id:"templatePicker.webEmptyPage.withTemplates.prompt"})):F=(0,d.jsx)(v().sA,{defaultMessage:"{isMobileDevice, select, true {Tap here to continue with an empty page. Please go online to use templates.} other {Press Enter to continue with an empty page. Please go online to use templates.}}",id:"templatePicker.deviceOffline.goOnlinePrompt",values:{isMobileDevice:a.isMobile}}),F?(0,d.jsx)("div",{style:D,children:(0,d.jsx)("div",{style:E.placeholder,onClick:e=>function(e,t,o){(0,M().SQ)({event:e,context:M().y$.EditorClick,callback:()=>{(0,j().EF)(o)&&(C().createAndCommit({userAction:"TemplatePicker.handleEmptyPageContinueClick",environment:o,canUndo:!0,perform:e=>{b().n({environment:o,store:t,transaction:e})}}),S().ki(o,{is_keyboard:!1,from:"template_picker",template_type:"empty_page"}))}})}(e,t,o),children:F})}):null}var F=()=>o(665446),z=()=>o(797470),W=()=>o(141122),H=()=>o(248584),N=()=>o(116485);const G=(0,i.forwardRef)((function(e,t){let{context:a,disabled:c,onClick:u,store:g,templatePickerMenuListStore:h,testPlaceholder:v}=e;const S=(0,n().v3)(),{device:f}=S,y=(0,H().Hy)(g),b=(0,o(48768).V)(),C=function(e,t){const o=(0,H().O9)(e,t),i=(0,H().Rg)(e,t);if(o)return"horizontal";if(i)return"legacy";return"none"}(g,a),k=(0,H().f7)(g),_=(0,H().Sm)(g),w=(0,s().K8)((()=>!!c||(!!g.isNonEditableState()||!!_)),[g,c,_]),P=(0,s().K8)((()=>g.getFormat()),[g]),M=(0,s().K8)((()=>(0,l().In)(g)),[g]),I=(0,l().L5)(a),A=(0,s().K8)((()=>g.isTeamPost()),[g]),T=(0,o(838517).bx)(g,c),B=(0,n().WS)(),j=(0,s().K8)((()=>g.isCollectionView()),[g]),L=(0,s().K8)((()=>Boolean(g.getCover())),[g]),V=(0,s().K8)((()=>{const e=(0,o(724903).cq)(g)&&!W().default.isSidePeekOpen()&&!W().default.isSidePeekClosingStore.state?`100vh - ${W().PeekModeOuterPadding}px*2`:"100vh",t=(0,o(129808).ek)(S.device.isElectronMac),i=o(356527).u.getTotalHeight();return`calc(${e} - ${t}px - 66px - 48px - 140px + ${i<250?0:i}px)`}),[S.device.isElectronMac,g]),R=(0,r().IS)((()=>{const e=P.page_font||m().zs,t=m().DX[e],i=m().JK[e]||1.5;let n;if(f.isMobile)n=f.isAndroid?m().By:m().y_;else if(a===z().Rr.DraftPostInInlineComposer)n=14;else{n=P.page_small_text?m().Y4[e]||m().dp:m().T1[e]||m().uD}let s={},r=a===z().Rr.Presentation?{}:{paddingTop:a===z().Rr.DraftPostInInlineComposer?0:8};const c=(0,l().L5)(a);if(!(M&&c&&"none"===C&&!y)){if(M){const e=29;r={...r,paddingBottom:a===z().Rr.DraftPostInInlineComposer?e:A?0:"15vh"}}else r={...r,paddingBottom:0};s={...r,paddingLeft:0,paddingRight:0}}let d={};c&&!A&&(d={minHeight:240,zIndex:1});let u={};a===z().Rr.InAppTemplatePreview&&(u={margin:"0 auto"});let p={};if(B&&!j&&T&&!L){const e=132,t=(0,m().nu)(a,S);p={minHeight:`calc(100vh - ${o(68677).s1+e-t}px)`}}return{content:{flexShrink:0,flexGrow:1,maxWidth:"100%",display:"flex",alignItems:"flex-start",flexDirection:"column",fontFamily:m().AP[e],fontSize:n,letterSpacing:t?`${t}em`:void 0,lineHeight:i,width:"100%",zIndex:4,...s,...d,...u,...p},emptyDroppableStyle:{width:"100%"},templatePicker:{position:"absolute",top:V,width:"100%",pointerEvents:"none"}}}),[L,j,B,M,T,a,f.isAndroid,f.isMobile,S,P.page_font,P.page_small_text,y,C,V,A]),[D,K]=function(e,t){const n=(0,i.useRef)(null),r=(0,o(381988).A)(n,e),a=(0,o(686329).wY)(n),l=(0,i.useCallback)((e=>{F().A.setWidth(e.width,t)}),[t]);(0,i.useEffect)((()=>{a&&l(a)}),[l,a]);const c=(0,s().K8)((()=>F().A.getWidth(t)),[t]);return[r,c]}(t,I);return(0,d.jsxs)(p().A,{name:"PageEditor",children:[(0,d.jsxs)("div",{className:o(983050).pXT,onClick:u,style:R.content,ref:D,children:[!k&&(0,d.jsx)(o(966638).A,{store:g.getContentStore(),emptyDroppableStyle:R.emptyDroppableStyle,disabled:w,placeholder:v}),y&&(0,d.jsx)(o(966789).A,{}),h&&"legacy"===C&&(0,d.jsx)(E,{store:g,menuListStore:h})]}),"horizontal"===C&&!b&&(0,d.jsx)("div",{style:R.templatePicker,children:(0,d.jsx)(x().Nv,{store:g,context:a,menuListStore:h,editorWidth:K})})]})}));const U=(0,i.forwardRef)((function(e,t){const{context:r,disabled:a,handlePlaceholderWrapClick:m,pageBlockStore:g,pathToBlockId:h,templatePickerMenuListStore:v,pageViewBlockAccessor:S,editorWrapper:f}=e,y=(0,n().v3)(),b=(0,s().K8)((()=>h?(0,o(610271).Dk)({environment:y,pageBlockStore:g,pathToBlockId:h}):g),[y,g,h]),C=(0,s().K8)((()=>(0,c().dC)(y,g)),[y,g]),k=(0,s().K8)((()=>(0,l().In)(g)),[g]),_=(0,s().K8)((()=>(0,o(799220).Fm)(g)),[g]),x=r===z().Rr.DraftPostInInlineComposer,w=y.device.isMobile||x?0:5,P=(0,s().K8)((()=>o(42539).A.state.isHovered),[]),M=f||(e=>(0,d.jsx)(N().vV,{style:{...x?{minHeight:void 0,pointerEvents:"auto"}:{minHeight:170},paddingTop:w},children:e})),I=(0,i.useMemo)((()=>_?async()=>{const e=await o(193302).assistantDependency.load();await e.assistantEditActions.saveAssistantCreatedPage(y)}:k?m:void 0),[m,k,_,y]);return(0,d.jsxs)(p().A,{name:"PageEditorModule",children:[M((0,d.jsx)(G,{store:b,disabled:a,context:r,templatePickerMenuListStore:v,onClick:I,ref:t})),C&&S?(0,d.jsx)(N().kZ,{children:(0,d.jsx)(u,{pageBlockStore:g,isVisible:!P,context:r,pageViewBlockAccessor:S,isCollapsedAnchor:!0})}):null]})}))},601661:(e,t,o)=>{o.r(t),o.d(t,{measurePageRenderMetrics:()=>x,setInitialRenderCompleted:()=>k,setSubMetric:()=>y,setSubMetricsAtRenderCallback:()=>f,updateMetricData:()=>b,updateMetricDataWithIsPushTag:()=>_,updateOPFSMetricData:()=>C});o(725707),o(403517),o(113085),o(875472),o(76509),o(863754);var i=()=>o(412989),n=()=>o(982177),s=()=>o(86979),r=()=>o(137476),a=()=>o(37312),l=()=>o(211923),c=()=>o(695398),d=()=>o(392608),u=()=>o(157230),p=()=>o(196387),m=()=>o(876359),g=()=>o(836331),h=()=>o(172470),v=()=>o(230557),S=()=>o(551455);function f(e){const{mainStartTime:t,prefetchInitiatedTime:o,statsigBootupBlockingStartTime:i,renderStartTime:s,renderEndTime:r}=e,a=n().getAppStartTime();if(!a)return;const l={app_start_to_main_start:{startTime:a,endTime:t},main_start_to_prefetch_initiated:{startTime:t,endTime:o},prefetch_initiated_to_statsig_bootup_blocking_start:{startTime:o,endTime:i},statsig_bootup_blocking:{startTime:i,endTime:s},render_start_to_render_end:{startTime:s,endTime:r}};for(const[n,c]of Object.entries(l)){const e=null==c?void 0:c.startTime,t=null==c?void 0:c.endTime;e&&t&&(0,m().f)({name:n,startTime:e,endTime:t})}h().A.state.subMetricsStore.update((e=>({...e,...l})))}function y(e){const{name:t,endTime:o}=e,i=e.startTime(h().A.state.subMetricsStore.state);i&&(h().A.state.subMetricsStore.update((e=>({...e,[t]:{startTime:i,endTime:o}}))),(0,m().f)({name:t,startTime:i,endTime:o}))}function b(e){h().A.state.metricDataStore.update((t=>({...t,...e})))}function C(e){h().A.state.OPFSMetricDataStore.update((t=>({...t,...e})))}function k(){h().A.update((e=>({...e,initialRenderCompleted:!0}))),u().N.markInitialPageRendered()}function _(e){const t=e.RouterStore.state;let o;var i;"page"===t.route.name&&(o=t.route.mobileData,b({is_push:null===(i=o)||void 0===i?void 0:i.isPush}))}function x(e){let{environment:t,isEditable:o,isHomePage:s,isWikiHome:l,isPageWithCustomLayout:c,idSchema:m}=e;const{initialRoute:{name:f},route:b}=t.RouterStore.state,{initialRenderCompleted:C,initialRenderAfterLoginCompleted:_}=h().A.state,x=a().isPrewarmedTabInitialRender(t),M=(0,d().w6)(t);C?_||"login"!==f?function(e,t){const o="page"===t.name?t.mobileData:void 0,i=S().A.popTimings();if(i){const{navigationStart:n,requestFirstChunkStart:s,requestFirstChunkEnd:a,requestFirstChunkSource:l,requestFirstChunkLocalSource:c,pageViewBlockRender:d}=i,m=performance.now(),g="page"===t.name?e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${t.blockId})`):void 0;p().default.measure({metricName:"navigation_page_render",startTime:n,endTime:m},{environment:e,data:{is_push:(null==o?void 0:o.isPush)??!1,wasm_sqlite_initialized:h().A.state.metricDataStore.state.wasm_sqlite_initialized,...g?{page_chunk_prefetch:g,page_chunk_prefetch_type:g.type}:{}}}),u().N.markNavigationRender(e),(0,r().LM)({eventName:"navigation_page_render_sub_metric",sampling:{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}}).then((t=>{if(!t)return;const o=o=>({environment:e,data:{type:o,chunk_source:l,local_source:c},sampleDecision:t});s&&p().default.measure({metricName:"navigation_page_render_sub_metric",startTime:n,endTime:s},o("navigation_start_to_request_first_chunk_start")),s&&a&&p().default.measure({metricName:"navigation_page_render_sub_metric",startTime:s,endTime:a},o("request_first_chunk_start_to_request_first_chunk_end")),a&&d&&p().default.measure({metricName:"navigation_page_render_sub_metric",startTime:a,endTime:d},o("request_first_chunk_end_to_pvb_render")),d&&p().default.measure({metricName:"navigation_page_render_sub_metric",startTime:d,endTime:m},o("pvb_render_to_handle_navigation_render"))}))}v().A.state.isMeasuring&&v().A.update((e=>({...e,isMeasuring:!1})))}(t,b):function(e){p().default.DO_NOT_USE_measureLegacy("initial_page_render_after_login",{environment:e}),h().A.update((e=>({...e,initialRenderAfterLoginCompleted:!0})))}(t):x?function(e){let{environment:t,initialRoute:o,isEditable:i,isHomePage:n,isWikiHome:s,isPageWithCustomLayout:r,isPublicDomain:a,idSchema:l}=e;k();const c=performance.now();y({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:c});const d=h().A.state.prewarmedTabAppStartTimeOverride;d&&p().default.measure({metricName:"initial_page_render",startTime:d,endTime:c},{environment:t,data:w({initialRoute:o,isEditable:i,isHomePage:n,isWikiHome:s,isPageWithCustomLayout:r,isPublicDomain:a,idSchema:l,isPrewarmedTab:!0,prewarmedTabNavigationStart:d}),shouldSendIfStatsigNotInitialized:!0});v().A.state.isMeasuring&&v().A.update((e=>({...e,isMeasuring:!1})))}({environment:t,initialRoute:f,isEditable:o,isHomePage:s,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:M,idSchema:m}):function(e){var t;let{environment:o,initialRoute:s,isEditable:a,isHomePage:l,isWikiHome:c,isPageWithCustomLayout:d,isPublicDomain:u,idSchema:m}=e;const{initialLoadCachedPageChunkCalledAt:v}=h().A.state;k();const S=Boolean(null===(t=performance)||void 0===t?void 0:t.mark)?performance.mark("initial_page_render").startTime:performance.now();i().S3.mark("initial_page_render"),y({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:S});const f=n().getAppStartTime(),b=n().getPageOriginTime();f&&b&&b>0&&f>b&&y({name:"page_origin_to_app_start",startTime:()=>b,endTime:f});p().default.measureFromPageOrigin({metricName:"initial_page_render",endTime:S},{environment:o,data:w({initialRoute:s,isEditable:a,isHomePage:l,isWikiHome:c,isPageWithCustomLayout:d,isPublicDomain:u,idSchema:m,prefetchedQueryCollection:P(o),isPrewarmedTab:!1}),shouldSendIfStatsigNotInitialized:!0});h().A.state.subMetricsStore.state;void 0!==v&&p().default.DO_NOT_USE_measureFromPageOriginLegacy({metricName:"load_cached_page_chunk_wait_time",endTime:v},{environment:o,data:{initial_route:s},shouldSendIfStatsigNotInitialized:!0,sendToStatsig:!0});g().default.checkGate({gateName:"beacon_pre_ipr_assets"})&&function(e,t){var o;if(null===(o=performance)||void 0===o||!o.getEntriesByType)return;const i=performance.getEntriesByType("resource"),n={eventName:"pre_ipr_assets",eventProperties:{ipr_end:t,assets:i.map((e=>{let t;try{t=new URL(e.name).pathname}catch{t=e.name}return{url:t,initiator_type:e.initiatorType,time:e.duration,perf_start:e.startTime,perf_end:e.startTime+e.duration,decoded_body_size:e.decodedBodySize,transfer_size:e.transferSize}}))}};(0,r().u4)({environment:e,event:n})}(o,S)}({environment:t,initialRoute:f,isEditable:o,isHomePage:s,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:M,idSchema:m})}function w(e){const{initialRoute:t,isEditable:o,isHomePage:i,isWikiHome:s,isPageWithCustomLayout:r,isPublicDomain:l,isPrewarmedTab:d,idSchema:u,prefetchedQueryCollection:p}=e;return{...a().getSubMetricsAndMetricDataForTracking(e.isPrewarmedTab?{isPrewarmedTab:!0,prewarmedTabNavigationStart:e.prewarmedTabNavigationStart}:{isPrewarmedTab:!1}),initial_route:t,is_editable:o,is_home_page:i,is_page_with_custom_layout:r,is_public_domain:l,profiling_tool:(0,c().getProfilingToolForSession)(),is_wiki_home:s,time_origin_to_app_start:n().getAppStartTime(),includes_page_origin_to_app_start:!0,id_schema:u,prefetched_cvb:p,is_prewarmed_tab:d,desktop_load_origin:a().getDesktopLoadOrigin(d),desktop_tab_count:h().A.state.desktopTabCount}}function P(e){const t=e.RouterStore.state.route;if("page"!==t.name||!t.blockId)return!1;return s().Ob.lookupViewIds(t.blockId).some((t=>{var o;const i=(0,l().A)(t),n=null===(o=e.prefetchCache)||void 0===o?void 0:o.getPrefetchAnalytic(i);return"hit-match"===(null==n?void 0:n.type)||"attempted"===(null==n?void 0:n.type)||"hit-mismatch"===(null==n?void 0:n.type)}))}},615136:(e,t,o)=>{o.d(t,{A:()=>m});o(725707),o(491955),o(500234),o(403517);var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(975392),a=()=>o(927999),l=()=>o(84543),c=()=>o(144451),d=()=>o(97787),u=o(163643);function p(e){const{store:t,collectionStore:i,disabled:c,locked:p,propertyIds:m,blockPropertyValueOverlayStore:h,format:v,type:S}=e,f=(0,n().v3)(),y=(0,o(749975).Ks)(),b=(0,s().K8)((()=>null==y?void 0:y.permissionScopesStore.state),[y]);return y?"minimal"===S?(0,u.jsx)(u.Fragment,{children:m.map(((e,o)=>(0,u.jsx)(g,{format:v,locked:p,collectionStore:i,store:t,disabled:c,blockPropertyValueOverlayStore:h,propertyId:e,visibility:S,isLast:o===m.length-1},e)))}):c||p||null==b||!b.canConfigureCollection?(0,u.jsx)("div",{style:d().Bb,children:m.map(((e,o)=>(0,u.jsx)(g,{format:v,locked:p,collectionStore:i,store:t,disabled:c,blockPropertyValueOverlayStore:h,propertyId:e,visibility:S,isLast:o===m.length-1},e)))}):(0,u.jsx)(d().Ay,{direction:"vertical",keys:m,renderKey:(e,o)=>(0,u.jsx)(g,{format:v,locked:p,collectionStore:i,store:t,disabled:c,blockPropertyValueOverlayStore:h,propertyId:e,visibility:S,isLast:o===m.length-1},e),onDrop:e=>function(e,t,o,i){const n=o.collection_page_sections||[],s=r().oE(e.map((e=>n.find((t=>t.section===e))))),c=n.filter((t=>!e.includes(t.section))),d=[...s,...c];l().createAndCommit({userAction:"RelationPropertyPageSections.handleReorder",environment:i,canUndo:!0,perform:e=>{a().zA({stores:[t],update:{collection_page_sections:d},transaction:e})}})}(e,i,v,f)}):null}const m=i.memo(p,o(21045).A),g=i.memo((function(e){let t,{propertyId:i,format:r,locked:a,collectionStore:l,store:d,disabled:p,blockPropertyValueOverlayStore:m,visibility:g,isLast:h}=e;if(g)t=g;else{const e=r.collection_page_sections??[];t=e.filter((e=>e.section===i)).map((e=>e.visibility))[0]}const v=(0,n().Y0)(),[S,f]=(0,o(830820).z)(),y=(0,o(639659).a)(),b="inline"===t,C=!h&&"minimal"!==t,k=(0,s().K8)((()=>d.canEdit()),[d]),_=(0,o(174114).IS)((()=>{const e={position:"absolute",visibility:f?"visible":"hidden",left:f?f+4:void 0,top:0};return{discussionIndicator:v.isMobile?{flexShrink:0}:b?e:{},wrapperDiv:{position:"relative",width:"minimal"!==t?"100%":void 0,...C?{marginBottom:c().YE+c().Lb+(k?-4:0)}:{}},selectable:b?{}:{display:"flex",alignItems:"center"}}}),[f,v.isMobile,C,b,t,k]),x=(0,u.jsx)(o(319638).L_,{store:d,propertyId:i,style:_.discussionIndicator});return(0,u.jsx)("div",{className:"minimal"!==t?"layout-content":void 0,style:_.wrapperDiv,ref:S,children:(0,u.jsxs)(o(367859).A,{store:d,analyticsName:"page_property",style:_.selectable,children:[(0,u.jsx)(o(943540).qm,{store:d,property:i,disabled:p,locked:a,format:"property_module",tableWrap:!1,blockPropertyValueOverlayStore:m,collectionStore:l,propertyVisibility:t},i),y?null:x]})})}))},621214:(e,t,o)=>{o.d(t,{T:()=>m,n:()=>p});var i=()=>o(752597),n=()=>o(836331),s=()=>o(134915),r=()=>o(197881),a=()=>o(927999),l=()=>o(551102),c=()=>o(759625),d=()=>o(360378),u=()=>o(384221);function p(e){const{environment:t,store:o,transaction:a,preventTextSelection:p,onTextSelection:m}=e;n().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&s().A.state.open&&s().A.setState({open:!1});const g=(()=>{const e=o.getContentStores();if(1===e.length&&e[0].isEmptyTextBlock())return e[0];const i=c().Wv({environment:t,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:a,spaceId:o.pointer.spaceId}),n=l().BC({parentStore:o.getContentStore(),appendStore:i,transaction:a}).childStore;return r().v(t,{from:"template_picker",type:"text",creating_block_id:i.id,parent_collection_id:i.getParentCollectionIdUpToTwoLevels()}),n})();return p||i().default.afterNextFlush((()=>{d().hc({environment:t,store:g}),u().setSelectionAtStart({store:g.getBlockTitleStore()}),null==m||m()})),g}function m(e){const{environment:t,store:o,transaction:i}=e;a().vc({store:o,transaction:i}),p({environment:t,store:o,transaction:i})}},664463:(e,t,o)=>{o.d(t,{A:()=>n});class i extends(()=>o(129044))().default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:o}=this.state;t?o[e]=t:delete o[e],this.emit()}}const n=new i},681981:(e,t,o)=>{o.d(t,{p:()=>l,A:()=>c});var i=o(242343),n=()=>o(643553);const s=24*n().pT;function r(e){return a(e).status}function a(e){if(null==e||!e.enabled)return{status:"disabled"};const t=e.start_ts?1e3*e.start_ts-Date.now():0;return t<=0?{status:"active"}:t<=s?{status:"warning",nextUpdateInMs:t}:{status:"scheduled",nextUpdateInMs:t-s}}function l(e){const[t,o]=(0,i.useState)((()=>r(e)));return(0,i.useEffect)((()=>{if(null==e||!e.enabled)return;let t;return function i(){t=void 0;const{status:n,nextUpdateInMs:s}=a(e);o(n),s&&(t=setTimeout(i,s))}(),()=>{t&&(clearTimeout(t),t=void 0)}}),[e]),t}function c(e){const[t,o]=(0,i.useState)((()=>Date.now())),s=(null==e?void 0:e.enabled)&&e.start_ts;return(0,i.useEffect)((()=>{if("number"!=typeof s)return;const e=s;let t;return function i(){const s=Date.now();o(s);const r=e*n().TD-s;if(r>0){const e=r%n().Xb,o=0===e?n().Xb:e;t=setTimeout(i,o)}else t=void 0}(),()=>{t&&(clearTimeout(t),t=void 0)}}),[s]),{freezeStatus:r(e),minUntilFreeze:s?Math.floor((s*n().TD-t)/n().Xb):void 0}}},702011:(e,t,o)=>{o.d(t,{LG:()=>g});var i=o(242343),n=()=>o(803290),s=()=>o(388615),r=()=>o(615136),a=()=>o(400885),l=()=>o(779921),c=()=>o(474473),d=()=>o(797470),u=()=>o(790245),p=o(163643);function m(e){const{state:t,store:o,disabled:i,blockPropertyValueOverlayStore:s}=e,a=(0,n().K8)((()=>o.isNonEditableState()),[o]);return(0,p.jsx)(r().A,{propertyIds:t.sectionPropertyIds,store:o,collectionStore:t.collectionStore,format:t.format,disabled:i,locked:a,blockPropertyValueOverlayStore:s})}function g(e){const{store:t,context:o,disabled:r,inlinePropertyIDs:g,wrapper:h}=e,v=(0,n().K8)((()=>t.getAssociatedCollectionStore()),[t]),S=(0,i.useMemo)((()=>new(c().YB)),[]),f=function(e){const{collectionStore:t,format:o,sectionPropertyIds:i}=e;if(!(t&&o&&i&&i.length))return{type:"hidden"};return{type:"visible",collectionStore:t,format:o,sectionPropertyIds:i}}({collectionStore:v,format:(0,n().K8)((()=>(0,a().gV)(t)),[t]),sectionPropertyIds:g});if("hidden"===f.type)return null;const y=o===d().Rr.PeekView;return h((0,p.jsx)(s().s,{allowSelectionWithin:!0,children:(0,p.jsx)(m,{topBorder:!0,state:f,store:t,disabled:r,blockPropertyValueOverlayStore:y?u().A:l().A,isInPeekRenderer:y,pagePropertiesStore:S})}))}},710548:(e,t,o)=>{o.d(t,{Qf:()=>S,sS:()=>h,ub:()=>v});o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(500234),o(113085);var i=o(242343),n=()=>o(237385),s=()=>o(803290),r=()=>o(763711),a=()=>o(655181),l=()=>o(996151),c=()=>o(946854),d=()=>o(520852),u=()=>o(506181),p=()=>o(518471),m=()=>o(797470),g=()=>o(144451);function h(e){const{pageStore:t,pageViewBlockStore:o,postContext:r,collectionStore:l,collectionSchema:p}=e,{collectionStore:m,collectionFormat:h,collectionSchema:S,canConfigureCollection:f}=(0,s().K8)((()=>{const e=l||(null==t?void 0:t.getAssociatedCollectionStore()),o=p||(null==e?void 0:e.getSchema()),i=null==e?void 0:e.getFormat(),n=e&&(0,d().v)({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1});return{collectionStore:e,collectionSchema:o,collectionFormat:i,canConfigureCollection:n}}),[t,l,p]),y=(0,n().v3)(),b=(0,s().K8)((()=>(0,u().A)({environment:y,store:t,pageViewBlockStore:o})),[y,t,o]),C=v({collectionFormat:h,collectionSchema:S,layoutStore:(0,s().K8)((()=>null==m?void 0:m.getLayoutStore()),[m]),postContext:r,pageStoreId:null==t?void 0:t.id,pageStore:t}),k=(0,s().K8)((()=>{const e=C.page_main.some((e=>(0,c().i_)(e)))||C.page_details.some((e=>(0,c().i_)(e)));return!(!m||!e)&&(0,g().cu)({modulesByArea:C,collectionStore:m})}),[C,m]),_=(0,i.useMemo)((()=>{const e=new Set;return(!Boolean(m)||!f&&k)&&e.add("properties"),"hidden"===(null==b?void 0:b.type)&&e.add("discussions"),e}),[f,m,null==b?void 0:b.type,k]);return(0,i.useMemo)((()=>0===_.size?C:(0,a().KO)(C,(e=>!_.has(e.type)))),[C,_])}function v(e){const{layoutStore:t,collectionSchema:o,collectionFormat:n,postContext:a,pageStoreId:c,pageStore:d}=e,u=(0,i.useRef)(c),g=(0,i.useRef)(null);return(0,s().K8)((()=>{var e;if(a===m().Rr.DraftPostInInlineComposer)return l().wC;if(null!=d&&d.isPersonProfile())return l().Vp;if((0,p().Mi)(a)){const e=(0,r().aG)(o,"created_time"),t=(0,r().aG)(o,"created_by"),i=[];t&&i.push(t),e&&i.push(e);return{...l()._u,page_main:[{...l()._u.page_main[0],propertyIds:i},...l()._u.page_main.slice(1)]}}let i=null==t?void 0:t.getModules();const s=c&&i&&c===u.current&&0===i.page_main.length&&(null===(e=g.current)||void 0===e?void 0:e.page_main.find((e=>"editor"===e.type)));return i&&!s||(i=(0,l().xN)({collectionSchema:o,collectionFormat:n})),u.current=c,g.current=i,i}),[t,c,o,n,a,d])}function S(e){const{personProfileStore:t}=e;return(0,s().K8)((()=>{const e=null==t?void 0:t.getAssociatedCollectionStore();if(!e)return l().Vp;const o=e.getLayoutStore();if(!o)return l().Vp;const i=o.getModules();return!i||0===i.person_profile_page_main.length&&0===i.person_profile_page_details.length?l().Vp:i}),[t])}},710602:(e,t,o)=>{o.d(t,{A:()=>n});class i extends(()=>o(129044))().default{constructor(){super()}getInitialState(){}}const n=new i},738677:(e,t,o)=>{o.d(t,{A:()=>n});o(242343);var i=o(163643);const n=(0,o(680369).wt)("addPage",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},745719:(e,t,o)=>{o.d(t,{s:()=>n});o(242343);var i=o(163643);const n=(0,o(680369).wt)("reactionAdd",{viewBox:"0 0 20 20",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M12 14.3516C12 14.1875 12.0573 14.0482 12.1719 13.9336C12.2891 13.8164 12.4297 13.7578 12.5938 13.7578H14.7617V11.5938C14.7617 11.4297 14.819 11.2904 14.9336 11.1758C15.0482 11.0586 15.1875 11 15.3516 11C15.5156 11 15.6549 11.0586 15.7695 11.1758C15.8867 11.2904 15.9453 11.4297 15.9453 11.5938V13.7578H18.1133C18.2747 13.7578 18.4128 13.8164 18.5273 13.9336C18.6445 14.0482 18.7031 14.1875 18.7031 14.3516C18.7031 14.5156 18.6445 14.6562 18.5273 14.7734C18.4128 14.888 18.2747 14.9453 18.1133 14.9453H15.9453V17.1133C15.9453 17.2747 15.8867 17.4128 15.7695 17.5273C15.6549 17.6445 15.5156 17.7031 15.3516 17.7031C15.1875 17.7031 15.0482 17.6445 14.9336 17.5273C14.819 17.4128 14.7617 17.2747 14.7617 17.1133V14.9453H12.5938C12.4297 14.9453 12.2891 14.888 12.1719 14.7734C12.0573 14.6562 12 14.5156 12 14.3516Z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0615 17.123C9.09538 17.123 8.1862 16.9385 7.33398 16.5693C6.48177 16.2048 5.72982 15.6966 5.07812 15.0449C4.43099 14.3932 3.92285 13.6413 3.55371 12.7891C3.18457 11.9368 3 11.0277 3 10.0615C3 9.09538 3.18457 8.1862 3.55371 7.33398C3.92285 6.48177 4.43099 5.7321 5.07812 5.08496C5.72982 4.43327 6.47949 3.92285 7.32715 3.55371C8.17936 3.18457 9.08854 3 10.0547 3C11.0254 3 11.9368 3.18457 12.7891 3.55371C13.6413 3.92285 14.3932 4.43327 15.0449 5.08496C15.6966 5.7321 16.207 6.48177 16.5762 7.33398C16.9453 8.1862 17.1299 9.09538 17.1299 10.0615C17.1299 10.6193 17.0684 11.1581 16.9453 11.678V11.5938C16.9453 11.1646 16.7813 10.7706 16.4767 10.4687C16.2657 10.2558 16.0099 10.1116 15.7285 10.0441C15.7263 9.26677 15.5805 8.53887 15.291 7.86035C14.9993 7.1722 14.5938 6.56836 14.0742 6.04883C13.5547 5.5293 12.9508 5.1237 12.2627 4.83203C11.5791 4.54036 10.8431 4.39453 10.0547 4.39453C9.27083 4.39453 8.53483 4.54036 7.84668 4.83203C7.16309 5.1237 6.5638 5.5293 6.04883 6.04883C5.53385 6.56836 5.13053 7.1722 4.83887 7.86035C4.5472 8.54395 4.40137 9.27767 4.40137 10.0615C4.40137 10.8499 4.5472 11.5859 4.83887 12.2695C5.13053 12.9531 5.53385 13.5547 6.04883 14.0742C6.56836 14.5938 7.16992 14.9993 7.85352 15.291C8.54167 15.5827 9.27767 15.7285 10.0615 15.7285C10.5739 15.7285 11.0641 15.6669 11.5321 15.5438C11.8272 15.8056 12.1958 15.9453 12.5938 15.9453H13.7617V16.0641C13.4535 16.2554 13.1293 16.4238 12.7891 16.5693C11.9368 16.9385 11.0277 17.123 10.0615 17.123ZM10.0547 13.4248C9.58073 13.4248 9.16146 13.3405 8.79688 13.1719C8.43685 12.9987 8.15658 12.8005 7.95605 12.5771C7.76009 12.3538 7.66211 12.167 7.66211 12.0166C7.66211 11.9346 7.69401 11.8776 7.75781 11.8457C7.82617 11.8092 7.89909 11.8092 7.97656 11.8457C8.22721 11.9779 8.51204 12.1055 8.83105 12.2285C9.15006 12.3516 9.55794 12.4131 10.0547 12.4131C10.5514 12.4131 10.9593 12.3516 11.2783 12.2285C11.6019 12.1055 11.8867 11.9779 12.1328 11.8457C12.2103 11.8092 12.2832 11.8092 12.3516 11.8457C12.4199 11.8776 12.4541 11.9346 12.4541 12.0166C12.4541 12.167 12.3538 12.3538 12.1533 12.5771C11.9528 12.8005 11.6725 12.9987 11.3125 13.1719C10.9525 13.3405 10.5332 13.4248 10.0547 13.4248ZM8.03809 9.44629C7.82389 9.44629 7.63704 9.3597 7.47754 9.18652C7.32259 9.01335 7.24512 8.79004 7.24512 8.5166C7.24512 8.24772 7.32259 8.02669 7.47754 7.85352C7.63704 7.67578 7.82389 7.58691 8.03809 7.58691C8.25228 7.58691 8.44141 7.67578 8.60547 7.85352C8.76953 8.02669 8.85156 8.24772 8.85156 8.5166C8.85156 8.79004 8.76953 9.01335 8.60547 9.18652C8.44141 9.3597 8.25228 9.44629 8.03809 9.44629ZM12.0713 9.44629C11.8571 9.44629 11.6702 9.3597 11.5107 9.18652C11.3558 9.01335 11.2783 8.79004 11.2783 8.5166C11.2783 8.24772 11.3558 8.02669 11.5107 7.85352C11.6702 7.67578 11.8571 7.58691 12.0713 7.58691C12.2855 7.58691 12.4746 7.67578 12.6387 7.85352C12.8027 8.02669 12.8848 8.24772 12.8848 8.5166C12.8848 8.79004 12.8027 9.01335 12.6387 9.18652C12.4746 9.3597 12.2855 9.44629 12.0713 9.44629Z"})]})})},851861:(e,t,o)=>{o.d(t,{z:()=>b});o(725707),o(491955),o(403517);var i=o(242343),n=()=>o(803290),s=()=>o(174114),r=()=>o(780866),a=()=>o(716605),l=()=>o(810111),c=()=>o(875089),d=()=>o(653998),u=()=>o(388615),p=()=>o(610271),m=()=>o(615136),g=()=>o(779921),h=()=>o(797470),v=()=>o(790245),S=()=>o(144451),f=()=>o(16126),y=o(163643);function b(e){const{pageStore:t,disabled:o,context:b,wrapper:C,showDefaultTitle:k}=e,_=b===h().Rr.PeekView,{isPageLocked:x}=(0,n().K8)((()=>({isPageLocked:t.isNonEditableState()})),[t]),{collectionStore:w,collectionSchema:P,normalizedCollectionFormat:M}=(0,n().K8)((()=>{const e=t.getAssociatedCollectionStore(),o=null==e?void 0:e.getSchema(),i=null==e?void 0:e.getFormat();return{collectionStore:e,collectionSchema:o,normalizedCollectionFormat:i&&o&&(0,c().L)(i,o,void 0,l().jf.Collection)}}),[t]),I=(0,i.useCallback)((e=>{const o=null==P?void 0:P[e];if("relation"!==(null==o?void 0:o.type))return!1;const i=t.getPropertyValue(e);return 0===(0,a().bG)({relationValue:(0,a().n)(i),propertySchema:o,getRecordModel:t.getRecordModel,includeNoAccess:!0}).length}),[P,t]),A=(0,n().K8)((()=>{if(!P||!M)return[];return(0,r().u)({format:M,schema:P,visibilityLevels:["inline"]}).filter((e=>!I(e)))}),[P,I,M]),T=(0,n().K8)((()=>{if(!P||!M)return[];return(0,r().T)({format:M,schema:P,visibilityLevels:["minimal","inline"]}).filter((e=>"minimal"===e.visibility||!("inline"!==e.visibility||!I(e.section)))).map((e=>e.section))}),[P,I,M]),B=(0,n().K8)((()=>t.canEdit()),[t]),j=(0,s().IS)((e=>({inlinePageSectionsContainer:{...T.length>0?{marginBottom:S().YE+S().Lb+(B?-4:0)}:{}},minimalPropertiesContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap"}})),[T.length,B]);return w&&P&&M&&(0!==A.length||0!==T.length)?C((0,y.jsx)(p().wt,{gap:4,children:(0,y.jsxs)(u().s,{allowSelectionWithin:!0,children:[A.length>0&&(0,y.jsx)("div",{style:j.inlinePageSectionsContainer,children:(0,y.jsx)(m().A,{propertyIds:A,store:t,collectionStore:w,disabled:o,locked:x,blockPropertyValueOverlayStore:_?v().A:g().A,format:M,type:"inline"})}),T.length>0&&(0,y.jsxs)(y.Fragment,{children:[k&&(0,y.jsx)(f().j,{store:t,style:{marginLeft:6},children:(0,y.jsx)(d().sA,{id:"pageLayout.relationsGroup.defaultTitle",defaultMessage:"Relations"})}),(0,y.jsx)("div",{style:j.minimalPropertiesContainer,children:(0,y.jsx)(m().A,{propertyIds:T,store:t,collectionStore:w,disabled:o,locked:x,blockPropertyValueOverlayStore:_?v().A:g().A,format:M,type:"minimal"})})]})]})})):null}},876359:(e,t,o)=>{o.d(t,{f:()=>n});var i=()=>o(812815);function n(e){const{name:t,startTime:o,endTime:n}=e;try{performance.measure(t,{start:o,end:n})}catch(s){i().Fg(s,{extra:{name:t,startTime:o,endTime:n}})}}},906513:(e,t,o)=>{o.d(t,{y:()=>S});o(242343);var i=()=>o(237385),n=()=>o(803290),s=()=>o(174114),r=()=>o(246169),a=()=>o(653998),l=()=>o(209684),c=()=>o(273520),d=()=>o(935091),u=()=>o(842492),p=()=>o(640979),m=()=>o(366691),g=()=>o(521972),h=()=>o(462156),v=o(163643);function S(e){const{pageStore:t,backlinksButtonPopupStore:o,numBacklinks:S,customization:f={}}=e,{buttonStyles:y,buttonIsGray:b,buttonIsLightGray:C}=f,k=(0,i().v3)(),{isPhone:_}=(0,i().Y0)(),x=(0,n().K8)((()=>void 0!==S?S:(0,u().J)(t,k).backlinksCount),[k,t,S],{debugName:"BacklinksControlButton.useComputedStore"}),w=(0,n().K8)((()=>g().g.getState().isOpen),[]),P=(0,s().IS)((e=>{const t=0===x&&w,o=e.text.quaternary;return{button:t?{color:o}:{},icon:t?{fill:o}:{}}}),[w,x]),M=e=>{let{buttonPopupEvents:t={}}=e;return(0,v.jsx)(l().p,{icon:e=>(0,r().y)({...e,transform:"rotate(180deg)",...P.icon}),style:{...y,...P.button},isGray:b,isLightGray:C,...t,children:(0,v.jsx)(a().sA,{id:"pageViewBlock.show.backlinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:x}})})};if(_){return M({buttonPopupEvents:{onClick:e=>{m().F.setState({isOpen:!0})}}})}return(0,v.jsx)(c().Ay,{buttonPopupStore:o,popupType:c().z7.Popup,renderOrigin:e=>M({buttonPopupEvents:e}),render:()=>{const e={menuType:p().gu.Popup,width:500};return(0,v.jsx)(d().A,{...e,children:x>0?(0,v.jsx)(h().p,{store:t}):null})}},"backlinkspopup")}},915634:(e,t,o)=>{o.d(t,{e:()=>s});var i=()=>o(129978);const n=new(i().O2)("FormBlock",(async()=>await Promise.all([o.e(96159),o.e(43380),o.e(96346),o.e(55373),o.e(44711),o.e(53321),o.e(36209),o.e(92845),o.e(71718),o.e(63077),o.e(90966),o.e(74562),o.e(28271),o.e(17254),o.e(28866),o.e(59794),o.e(22542),o.e(80759),o.e(72883),o.e(40186),o.e(42283),o.e(65688)]).then(o.bind(o,876257)))),s=(0,i()._h)(n,(e=>e.FormBlock))},926537:(e,t,o)=>{o.d(t,{H:()=>s});var i=()=>o(946854),n=()=>o(76394);function s(e){const t=e.type;return"properties"===t?"module__properties_"+("pinned"===e.variant?"minimal":"expanded"):"normalizedTitleWithIcon"===t||"titleWithIcon"===t?"module__title_with_icon":"cover"===t?"cover__module":"views"===t?"module__views":"editor"===t?"module__editor":"formTitle"===t?"module__formTitle":"viewsMain"===t?"module__views_main":"transcript"===t?"module__transcript":"formSubmit"===t?"module__form_submit":"discussions"===t?"module__discussion":"placeholder"===t?"module__placeholder":"formQuestion"===t?"module__formQuestion":"bottomControls"===t?"module__bottomControls":"relationsGroup"===t?"module__relationsGroup":"deleted_property"===t?"module__deleted_property":"expandedBacklinks"===t?"module__expandedBacklinks":"inlinePageSections"===t?"module__inlinePageSections":"property"===t?`module__property_${e.id}`:"collectionView"===t?"module__collectionView":"collectionViewV2"===t?"module__collectionViewV2":(0,i().CA)(t)?`module__property_${e.id}`:void(0,n().HB)(t)}},971052:(e,t,o)=>{o.d(t,{v:()=>n});o(725707),o(491955),o(500234),o(113085);var i=()=>o(604284);function n(e){const{collectionStore:t,module:o,isMobile:n}=e;if("normalizedTitleWithIcon"!==o.type)return!1;const s=t.getSchema(),r=!!s&&(0,i().LD)({collectionSchema:s,module:o}).length>0,a=(0,i().pm)({collectionStore:t}).count>0;return!(!n||!a)||!r&&a}}}]);