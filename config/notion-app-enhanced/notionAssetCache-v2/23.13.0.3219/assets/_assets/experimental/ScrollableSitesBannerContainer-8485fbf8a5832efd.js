"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7771],{40504:(e,t,i)=>{i.d(t,{EL:()=>k,KD:()=>w,Ss:()=>f,l2:()=>x,n0:()=>S,rw:()=>M});i(610931),i(362833),i(725707),i(491955),i(242343);var s=()=>i(220574),a=()=>i(145017),n=()=>i(653998),l=()=>i(23371),r=()=>i(818369),o=()=>i(145046),c=()=>i(509484),d=()=>i(480415),u=()=>i(422340),h=()=>i(802955),p=()=>i(413871),g=()=>i(189823),b=()=>i(213094),m=()=>i(913001),v=i(163643);const C=50;function f(e){m().A.resetSitesForSpace(e.id)}async function M(e,t){const{spaceStore:i,currentUserId:n,limit:o}=t;if(!i.id)return;const[c]=await Promise.all([r().callApi({eventName:"getPublishedPagesForUser",environment:e,data:{spaceId:i.id,limit:o||C,fetchPublishedMetadata:!0}}),(0,l().wR)(1500)]);if("failed"===c.type)throw new Error("Failed to fetch published pages.");if(c.data.recordMap){const e=[],t=s().RecordMapWithRole.create(c.data.recordMap),l=c.data.publishedEdits;for(const{model:s}of t)if(s&&s.table===a().ev){const t=p().Bv.createChildStore(i,{table:a().ev,id:s.id}),n=l[t.id],r=n&&n.authors?n.authors[0]:void 0,o={publishedTime:null==n?void 0:n.timestamp,publishedBy:r};e.push({store:t,publishedMetadata:o})}let r=e;return n&&(r=b().X(e,n)),m().A.initializeSiteResultsForSpace(i.id,r),r}}async function w(e,t){const{spaceStore:i}=t,s=e.currentUser.id,a=await M(e,{spaceStore:i,currentUserId:s});return a?a.filter((e=>{var t;return(null===(t=e.publishedMetadata.publishedBy)||void 0===t?void 0:t.id)===s})):[]}function S(e){d().Tk(e),u().Ay.setState({...u().Ay.state,display:u().pP.Publish,tab:u().QC.Publish})}async function k(e){return new Promise(((t,i)=>{o().ui({message:(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)(n().sA,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)(n().sA,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,v.jsx)(n().sA,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>t(!0)}],showCancel:!0})}))}async function x(e,t){if(!h().A.state.online)return[];const i=await c().T.searchActions.load();return await i.searchPublicPages({environment:t,query:e,source:"public_home_page_menu",limit:g().ZK})}},213094:(e,t,i)=>{i.d(t,{X:()=>n,c:()=>l});i(725707),i(500234);var s=()=>i(446588),a=()=>i(352723);function n(e,t){return e.sort(((e,i)=>{const s=e.store.canAdmin();if(s===i.store.canAdmin()){var a,n;const s=null===(a=e.publishedMetadata.publishedBy)||void 0===a?void 0:a.id,l=e.publishedMetadata.publishedTime,r=null===(n=i.publishedMetadata.publishedBy)||void 0===n?void 0:n.id,o=i.publishedMetadata.publishedTime;if(t){if(s===t&&r===t&&l&&o)return o-l;if(s===t)return-1;if(r===t)return 1}return l&&o?o-l:0}return s?-1:1}))}function l(e){const{environment:t,store:i}=e;if(!i.pathIsAccessibleAndAlive())return!1;if(!a().i0(i).find((e=>(0,s().W8)(e.permissionItem))))return!1;return!a().qb(t,i)}},260856:(e,t,i)=>{i.d(t,{N:()=>a});i(242343);var s=i(163643);const a=(0,i(680369).wt)("newSidebarTemplates",{viewBox:"0 0 20 20",svg:(0,s.jsx)("g",{children:(0,s.jsx)("g",{id:"Layer_1",children:(0,s.jsx)("path",{d:"M18.1572266,15.3720703l-2.3018188-3.9864502c.6661377-.2475586,1.1445923-.8843994,1.1445923-1.6356201V3.75c0-.9648438-.7851562-1.75-1.75-1.75h-6.25c-.9648438,0-1.75.7851562-1.75,1.75v1.5634766c-.2476807-.0355835-.4969482-.0634766-.75-.0634766-2.8950195,0-5.25,2.3549805-5.25,5.25,0,2.8945312,2.3549805,5.25,5.25,5.25.3484497,0,.6890869-.0457764,1.0245972-.1122437-.1846313.4870605-.1571655,1.022583.1101685,1.4862671.3168945.5488281.8842773.8759766,1.5175781.8759766h7.4873047c.6328125,0,1.2001953-.3271484,1.5166016-.875.3173828-.5488281.3173828-1.203125.0009766-1.7529297ZM9,3.5h6.25c.1376953,0,.25.1123047.25.25v6c0,.1376953-.1123047.25-.25.25h-.1946411l-.6422729-1.1123047c-.3164062-.5483398-.8837891-.8759766-1.5166016-.8759766-.6337891,0-1.2011719.3276367-1.5175781.8759766l-.6421509,1.1123047h-1.7421265c-.1347656,0-.2446289-.1098633-.2446289-.2446289v-3.5401611c-.000061-.0013428.0001221-.0026245,0-.0039673v-2.4612427c0-.1376953.1123047-.25.25-.25ZM2.75,10.5c0-2.0678711,1.6821289-3.75,3.75-3.75.2545166,0,.5040894.0332031.75.083252v2.9221191c0,.9619141.7827148,1.7446289,1.7446289,1.7446289h.8760986l-1.1859131,2.0540771c-.0067139.0043945-.0146484.0047607-.0212402.0093994-.6342773.4492188-1.3828125.6865234-2.1635742.6865234-2.0678711,0-3.75-1.6826172-3.75-3.75ZM16.8574219,16.3740234c-.0273438.046875-.0917969.1259766-.2177734.1259766h-7.4873047c-.1264648,0-.190918-.0791016-.2182617-.1259766s-.0634766-.1425781,0-.2519531l3.7436523-6.484375c.125-.2163086.3076172-.2202148.4365234,0l3.7441406,6.4833984c.0625.1103516.0263672.2060547-.0009766.2529297Z"})})})})},274957:(e,t,i)=>{i.d(t,{A:()=>w});i(362833);var s=i(242343),a=()=>i(237385),n=()=>i(803290),l=()=>i(174114),r=()=>i(712437),o=()=>i(279968),c=()=>i(921080),d=()=>i(653998),u=()=>i(385531),h=()=>i(772357),p=()=>i(653147),g=()=>i(935989),b=()=>i(760034),m=()=>i(515347),v=()=>i(141122),C=()=>i(40504),f=()=>i(112907),M=i(163643);function w(e){let{blockStore:t,legacyColor:i}=e;const w=(0,n().K8)((()=>t.isFormBlock()),[t]),S=(0,a().v3)(),k=S.device.isMobile,x=(0,n().K8)((()=>{const e=m().UP(t);return f().Ix({spaceStore:t.getSpaceStore(),domainId:e})}),[t]),y=(0,s.useCallback)((()=>{b().uY({environment:S,store:t,pageVisitSource:r().y8.SiteBanner})}),[S,t]),A=(0,s.useCallback)((()=>{var e;v().default.isSidePeekOpen()&&(null===(e=v().default.peekTargetStore.state)||void 0===e?void 0:e.id)!==t.id&&u().YH(),C().n0(S),(0,g().EN)(S,{source:"site_settings_banner"})}),[t.id,S]),B=(0,l().IS)((()=>({icon:{height:16,width:16,marginRight:4}})),[]);if(!x||w)return null;let j;const V=[];return k?(j=(0,M.jsx)(d().sA,{defaultMessage:"This page is live on the web.",id:"pageViewBlock.sitesBannerMobile.message"}),V.push({label:(0,M.jsx)(d().sA,{defaultMessage:"View",id:"pageViewBlock.sitesBanner.view"}),onClick:()=>y()})):(j=(0,M.jsx)(d().sA,{defaultMessage:"This page is live on {domain}",id:"pageViewBlock.sitesBanner.message",values:{domain:x}}),V.push({label:(0,M.jsxs)(M.Fragment,{children:[(0,o().h)(B.icon),(0,M.jsx)(d().sA,{defaultMessage:"View site",id:"pageViewBlock.sitesBanner.viewSite"})]}),onClick:()=>y()},{label:(0,M.jsxs)(M.Fragment,{children:[(0,c().B)(B.icon),(0,M.jsx)(d().sA,{defaultMessage:"Site settings",id:"pageViewBlock.sitesBanner.settings"})]}),onClick:()=>A()})),(0,M.jsx)(h().l,{label:j,display:"full-width",actions:V,tint:(0,p().V)(i)})}},279968:(e,t,i)=>{i.d(t,{h:()=>a});i(242343);var s=i(163643);const a=(0,i(680369).wt)("globe2",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM3.88477 3.76465C4.56836 3.11523 5.39551 2.61621 6.31836 2.34277C5.83301 2.82812 5.42285 3.51172 5.11523 4.3457C4.63672 4.19531 4.22656 3.99707 3.88477 3.76465ZM9.68848 2.34961C10.6045 2.62305 11.4316 3.11523 12.1084 3.76465C11.7734 4.00391 11.3633 4.19531 10.8848 4.35254C10.5771 3.51172 10.167 2.82812 9.68848 2.34961ZM8.47852 2.56836C9.0459 2.8418 9.56543 3.58008 9.93457 4.58496C9.4834 4.66699 8.99805 4.71484 8.47852 4.73535V2.56836ZM6.06543 4.58496C6.44141 3.58008 6.9541 2.8418 7.52148 2.56836V4.73535C7.00195 4.71484 6.5166 4.66699 6.06543 4.58496ZM2.05273 7.58594C2.14844 6.42383 2.58594 5.35059 3.25586 4.46875C3.67285 4.77637 4.21289 5.04297 4.8418 5.24121C4.66406 5.95215 4.54785 6.74512 4.51367 7.58594H2.05273ZM11.4863 7.58594C11.4521 6.74512 11.3359 5.95215 11.1582 5.24121C11.7871 5.04297 12.3271 4.7832 12.7373 4.46875C13.4141 5.35059 13.8516 6.42383 13.9473 7.58594H11.4863ZM5.49121 7.58594C5.52539 6.84082 5.62793 6.12988 5.78516 5.4873C6.33203 5.59668 6.91309 5.66504 7.52148 5.69238V7.58594H5.49121ZM8.47852 7.58594V5.69238C9.08691 5.66504 9.66797 5.59668 10.2148 5.4873C10.3721 6.12988 10.4746 6.84082 10.5088 7.58594H8.47852ZM2.05273 8.54297H4.51367C4.54785 9.39746 4.66406 10.1973 4.8418 10.915C4.21973 11.1133 3.68652 11.373 3.27637 11.6807C2.59277 10.792 2.14844 9.71191 2.05273 8.54297ZM5.49121 8.54297H7.52148V10.4707C6.91992 10.498 6.33203 10.5664 5.79199 10.6689C5.62793 10.0195 5.51855 9.29492 5.49121 8.54297ZM8.47852 10.4707V8.54297H10.5088C10.4814 9.29492 10.3721 10.0195 10.208 10.6689C9.66797 10.5664 9.08691 10.498 8.47852 10.4707ZM11.1582 10.915C11.3428 10.1973 11.4521 9.39746 11.4863 8.54297H13.9473C13.8516 9.71191 13.4072 10.792 12.7236 11.6807C12.3135 11.373 11.7803 11.1133 11.1582 10.915ZM8.47852 11.4277C8.99121 11.4482 9.47656 11.4961 9.9209 11.5781C9.55176 12.5625 9.03906 13.2939 8.47852 13.5605V11.4277ZM6.0791 11.5781C6.52344 11.4961 7.00879 11.4482 7.52148 11.4277V13.5605C6.96094 13.2939 6.44824 12.5625 6.0791 11.5781ZM3.90527 12.3848C4.24023 12.1523 4.65039 11.9609 5.12207 11.8105C5.42969 12.6309 5.83301 13.3008 6.30469 13.7793C5.40234 13.5059 4.58203 13.0205 3.90527 12.3848ZM10.8779 11.8105C11.3496 11.9609 11.7598 12.1523 12.0947 12.3848C11.418 13.0205 10.5977 13.5059 9.69531 13.7793C10.167 13.3008 10.5703 12.6309 10.8779 11.8105Z"})})},813246:(e,t,i)=>{i.r(t),i.d(t,{ScrollableSitesBannerContainer:()=>f});i(242343);var s=()=>i(237385),a=()=>i(803290),n=()=>i(653147),l=()=>i(174114),r=()=>i(260856),o=()=>i(921080),c=()=>i(758611),d=()=>i(653998),u=()=>i(110975),h=()=>i(865226),p=()=>i(772357),g=i(163643);function b(e){const{blockStore:t,template:i}=e,n=(0,s().v3)(),b=(0,a().K8)((()=>t.isFormBlock()),[t]),m=n.device.isMobile,v=(0,l().IS)((e=>({icon:{height:16,width:16,marginRight:4}})),[]);if(b)return null;const C=i.id,f=[{label:(0,g.jsxs)(g.Fragment,{children:[(0,r().N)(v.icon),(0,g.jsx)(d().sA,{defaultMessage:"View template listing",id:"pageViewBlock.marketplaceBanner.viewSite"})]}),onClick:()=>{h().oo({environment:n,url:`/marketplace/templates/${i.slug}`})}},{label:(0,g.jsxs)(g.Fragment,{children:[(0,o().B)(v.icon),(0,g.jsx)(d().sA,{defaultMessage:"Settings",id:"pageViewBlock.marketplaceBanner.settings"})]}),onClick:()=>{u().f({environment:n,url:`${c().JZ.creatorProfileTemplates}/form/published/${C}`})}}];return(0,g.jsx)(p().l,{label:(0,g.jsx)(d().sA,{defaultMessage:"This template is live on the Marketplace",id:"pageViewBlock.marketplaceBanner.message"}),display:m?"inline":"full-width",actions:f,tint:"blue"})}var m=()=>i(327321),v=()=>i(213094),C=()=>i(274957);function f(e){const{blockStore:t}=e,i=(0,s().v3)(),l=(0,a().K8)((()=>(0,v().c)({environment:i,store:t})),[i,t]),r=(0,m().J)(t,l);return l&&"pending"!==r.status?r.templateListingExists&&r.template?(0,g.jsx)("div",{style:{position:"sticky",left:0,right:"100%",width:"100%"},children:(0,g.jsx)(b,{blockStore:t,template:r.template})}):(0,g.jsx)("div",{style:{position:"sticky",left:0,right:"100%",width:"100%"},children:(0,g.jsx)(C().A,{blockStore:t,legacyColor:n().q.LightBlue})}):(0,g.jsx)(g.Fragment,{})}},913001:(e,t,i)=>{i.d(t,{A:()=>n});i(725707),i(491955);var s=()=>i(975392);class a extends(()=>i(129044))().default{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}getSortedSitesForSpace(e,t){const{sortAscending:a,sortColumn:n}=this.state,l=this.state.sites[e];if(l)switch(n){case"page":return s().My(l,(e=>i(34662).q4_(e.store.getTitleValue()).toLowerCase()),a?"asc":"desc");case"published-by":return s().My(l,(e=>{const s=e.publishedMetadata.publishedBy,a=s?i(413871).sk.createChildStore(e.store,s):void 0;return null==a?void 0:a.getDisplayName(t).toLowerCase()}),a?"asc":"desc");case"published-date":return s().My(l,(e=>e.publishedMetadata.publishedTime),a?"asc":"desc");default:return l}}removeSiteFromSpace(e,t){const i=this.state.sites[e];i&&(this.state.sites[e]=i.filter((e=>e.store.id!==t)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const n=new a}}]);