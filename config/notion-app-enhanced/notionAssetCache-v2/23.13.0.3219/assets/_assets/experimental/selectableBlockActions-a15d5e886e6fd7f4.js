"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[90871,99171],{44250:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function c(e){if(!e||!("askUserToPick"in e))return e}function i(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>c,K$:()=>o,j6:()=>i})},189170:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>F,duplicateBlocksWithMaybeConfirmation:()=>w,insertBlockAbove:()=>A,insertBlockAndEdit:()=>I,insertBlockBelow:()=>_,insertTextAbove:()=>L,insertTextBelow:()=>E});n(358848),n(362833),n(91270);var o=()=>n(752597),c=()=>n(214144),i=()=>n(66460),r=()=>n(975392),a=()=>n(303298),s=()=>n(577701),l=()=>n(983048),u=()=>n(415029),p=()=>n(145046),d=()=>n(111066),m=()=>n(164186),k=()=>n(84543),v=()=>n(732491),f=()=>n(190717),b=()=>n(486963),y=()=>n(590057),S=()=>n(981810),h=()=>n(459742),B=()=>n(816763),C=()=>n(112892),g=()=>n(615661),T=()=>n(182613),x=()=>n(937968);async function w(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:c,callback:i}=e;if(!(0,x().EF)(t))return;const r=await a().VI.duplicateActions.load();let s=n;if(1===n.length){const e=await f().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==i||i());s=e}const u=s.at(0);if(!u)return;const p=(0,b().U)(u);if(p&&(0,S().ls)(u,p))await l().un({blocks:s,environment:t,analyticsFrom:"subitem_duplication",callback:i,collectionContextStore:p});else{const{serverCommitResult:e}=k().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{F({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:c,duplicateActions:r})},transactionTooBigFallback:e=>{F({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:c,duplicateActions:r})}});e.then(i)}o().default.afterNextFlush((()=>{d().BM({environment:t})}))}function F(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:c,lastTopLevelBlockStore:a,preventSetSelection:l,duplicateOnlyCollectionSchema:u,duplicateActions:d}=e,k=r().$z(n,(e=>e.getFormat().app_id??e.id)),v=[];return r().jJ(k,(e=>{const n=e[0],r=!n.isTransclusionType(),{blockStores:a,onComplete:l}=d.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:(0,i().e)(n.pointer.spaceId),preferDuplicateLocation:c,options:{addCopyName:(0,B().A)(n),deepCopyTransclusionContainers:r,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),duplicateOnlyCollectionSchema:u}});v.push(...a),l.then((e=>{if("error"===e.status){const n=e.error;s().Rk(n)?s().UK(t,{product:n.clientData.metadata.product}):p().f1(e.errorMessage)}}))})),m().LE({blocksToInsert:v,target:a?[a]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:l}),v}function _(e){const{environment:t,createBlockItem:n,selection:o,transaction:c,analyticsFrom:i,preventSetSelection:r}=e,a=T().default.getCurrentRecordCache(),s=new(v().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let l;if((0,x().EF)(t)&&n&&a){const e=u().w({environment:t,createBlockItem:n,transaction:c,inMemoryRecordCache:a,from:i,selection:o});s.track(e.pointer,c),l=m().LE({environment:t,blocksToInsert:[e],target:o,transaction:c,replaceEmptyTextBlock:!1,preventSetSelection:r})[0]}else s.fail("invalid_state");return l}function A(e){const{environment:t,createBlockItem:n,selection:o,transaction:c,analyticsFrom:i,preventSetSelection:r}=e,a=T().default.getCurrentRecordCache();let s;if((0,x().EF)(t)&&n&&a){const e=u().w({environment:t,createBlockItem:n,transaction:c,inMemoryRecordCache:a,from:i,selection:o});s=m().t1({environment:t,blocks:[e],selection:o,transaction:c,preventSetSelection:r})[0]}return s}function I(e){const{environment:t,selection:n,transaction:o}=e,i=_({...e,preventSetSelection:!0});if(i){var r;m().x5({environment:t,insertedStores:[i],isCreated:!0});const e=g().Uv.getMode(i);if("suggest"===e){const e=y().RR(t,o,i);y().tM(o,i,{id:c().JW(),type:"insert",discussionId:e.id}),y().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[i.id]})}"suggest"===e&&null!==(r=i.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==r&&r.isCommentOnly()||m().um({transaction:o,blocks:n})}return i}function E(e){const{blocks:t,transaction:n,environment:c,skipAnalytics:i}=e,r=i?void 0:"text_insert_below",a=_({environment:c,selection:t,createBlockItem:h().ry.text,analyticsFrom:r,transaction:n});return a&&o().default.afterNextFlush((()=>{C().zz({environment:c,blockStore:a,insertedTextBlockLocation:"below"})})),a}function L(e){const{blocks:t,transaction:n,environment:c,skipAnalytics:i}=e,r=i?void 0:"text_insert_below",a=A({environment:c,selection:t,createBlockItem:h().ry.text,analyticsFrom:r,transaction:n});return a&&o().default.afterNextFlush((()=>{C().zz({environment:c,blockStore:a,insertedTextBlockLocation:"above"})})),a}},533639:(e,t,n)=>{n.d(t,{p:()=>o});class o extends(()=>n(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},994488:(e,t,n)=>{n.d(t,{o:()=>o});n(362833),n(403517);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];if(0===n.length)return e.map((e=>[e]));const i=[];for(const r of e)i.push(...o(n[0],...n.slice(1)).map((e=>[r,...e])));return i}}}]);