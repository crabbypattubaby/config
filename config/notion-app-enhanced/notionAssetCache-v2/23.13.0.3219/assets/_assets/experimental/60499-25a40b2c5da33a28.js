"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[60499],{29302:(e,t,i)=>{i.d(t,{A:()=>f});var o=i(242343),n=()=>i(803290),r=()=>i(712437),s=()=>i(145017),a=()=>i(218357),d=()=>i(7379),l=()=>i(709237),c=()=>i(644515),u=()=>i(751634),v=i(163643);function h(e){const{titledRecordStore:t,getRecordModel:h,activity:f,tabArgs:p,permissionRole:g,shouldRenderEmpty:m}=e,y=(0,n().K8)((()=>t.getModel()),[t]),b=(0,i(237385).v3)(),A=(0,i(653998).tz)(),x=(0,n().K8)((()=>null==y?void 0:y.getRenderIcon({getRecordModel:h})),[y,h]),S=(0,i(174114).IS)((()=>({container:g?{...u().vF,display:"flex",alignItems:"center"}:u().vF,icon:u().kI,recordTitle:(0,u().xC)(void 0!==x),role:{marginLeft:4,padding:0},titleAndRole:{display:"flex",flexFlow:"row",padding:1}})),[x,g]),I=(0,o.useCallback)((()=>{const e=t.table;switch(e){case s().ev:case i(21164).Vl:case i(528762).NX:(0,c().Qo)({environment:b,activity:f,...p});break;case a().yK:(0,c().uY)({environment:b,activity:f,...p}),i(628854).L0({environment:b,teamStore:t,shouldScroll:!0}),d().A.setState({...d().A.state,open:!1});break;default:(0,i(76394).HB)(e)}}),[f,b,p,t]),j=(0,n().K8)((()=>y&&y.table!==a().yK?y.getRenderUrl({getRecordModel:h,pageVisitSource:r().y8.Notification}):m&&t.table===s().ev?(0,i(220959).A)({pageId:t.id,pageVisitSource:r().y8.LinkInPage}):void 0),[y,h,m,t.table,t.id]);if(!y&&!m)return null;const k=g?(0,v.jsxs)("div",{style:S.titleAndRole,children:[(0,v.jsx)(l().A,{store:t,style:S.recordTitle}),(0,v.jsx)(i(35462).A,{style:S.role,isSecondaryColor:!0,children:`(${A.formatMessage((0,i(486540).an)(g,s().ev)).toLocaleLowerCase()})`})]}):(0,v.jsx)(l().A,{store:t,style:S.recordTitle});return(0,v.jsxs)(i(931085).A,{href:j,onClick:I,external:!1,innerStyle:S.container,inline:!0,children:[(x||m)&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i(28210).B,{disabled:!0,icon:x,isEmptyPage:!1,size:18,style:S.icon}),(0,v.jsx)("span",{children:" "})]}),k]})}const f=o.memo(h)},129885:(e,t,i)=>{i.d(t,{G7:()=>x,T9:()=>_,bD:()=>j,Jd:()=>k,Ln:()=>I,U6:()=>T,pN:()=>R,DU:()=>C,_S:()=>S,j1:()=>M});i(358848),i(91270),i(725707),i(324989),i(403517),i(113085),i(242343);var o=()=>i(950635),n=(i(491955),i(500234),()=>i(653998)),r=()=>i(31448),s=i(163643);var a=()=>i(590110),d=()=>i(145017),l=()=>i(518797),c=()=>i(21164),u=()=>i(759260),v=()=>i(409211),h=()=>i(34662),f=()=>i(496580),p=()=>i(975392),g=()=>i(76394),m=()=>i(477784),y=()=>i(352723),b=()=>i(485966),A=()=>i(413871);function x(e){let{actor:t,environment:i}=e;return t.isBot()?2:i.currentUser.id===t.id?1:0}function S(e){const{authorStores:t,currentUserId:i}=e;if(!i||0===t.length)return{frontActorStore:void 0,backActorStore:void 0};const o=t.some((e=>e.id===i)),n=t.sort(((e,t)=>(e.id===i?1:0)-(t.id===i?1:0)));return{frontActorStore:n.at(0)||void 0,backActorStore:n.at(Math.max(1,n.length-(o?2:1)))||void 0}}function I(e){const{edits:t,rootStore:i}=e,o=p().Mp(t.flatMap((e=>e.authors||[])),p().n4),n=p().oE(o.map((e=>_(e,i))));return n.sort(((e,t)=>x({actor:e,environment:i.environment})-x({actor:t,environment:i.environment}))),n}function j(e,t){const{currentUserStore:i}=b().default.state,a=null==i?void 0:i.id;return function(e,t,i,a){const d=t.find((e=>e.id===i)),l=t.map((t=>(0,o().lR)(e,t))),c={fontWeight:r().Wy.semibold,...a};if(1===t.length)return d?(0,s.jsx)("span",{children:(0,s.jsx)(n().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label",values:{b:e=>(0,s.jsx)("span",{style:c,children:e})}})}):(0,s.jsx)("span",{children:(0,s.jsx)(n().sA,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",values:{author:l[0],b:e=>(0,s.jsx)("span",{style:c,children:e})}})});if(2===t.length){if(d){const i=t.filter((e=>e!==d)).map((t=>(0,o().lR)(e,t)));return(0,s.jsx)("span",{children:(0,s.jsx)(n().sA,{defaultMessage:"<b>{firstAuthor}</b> and you",id:"activitySection.authorPhrase.forTwoAuthorsCurrentUser.label",values:{firstAuthor:i[0],b:e=>(0,s.jsx)("span",{style:c,children:e})}})})}return(0,s.jsx)("span",{children:(0,s.jsx)(n().sA,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",values:{firstAuthor:l[0],secondAuthor:l[1],b:e=>(0,s.jsx)("span",{style:c,children:e})}})})}if(l.length>2){if(d){const i=t.filter((e=>e!==d)).map((t=>(0,o().lR)(e,t))),r=(0,s.jsx)(n().sA,{defaultMessage:"{numberOfOtherAuthors, plural, =0 {<b>{firstAuthor}</b>, <b>{secondAuthor}</b> and you} one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthorsCurrentUser.label",values:{numberOfOtherAuthors:i.length-2,firstAuthor:i[0],secondAuthor:i[1],b:e=>(0,s.jsx)("span",{style:c,children:e})}});return(0,s.jsx)("span",{children:r})}{const e=(0,s.jsx)(n().sA,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",values:{numberOfOtherAuthors:l.length-2,firstAuthor:l[0],secondAuthor:l[1],b:e=>(0,s.jsx)("span",{style:c,children:e})}});return(0,s.jsx)("span",{children:e})}}return(0,s.jsx)("span",{style:c,children:(0,s.jsx)(n().sA,{defaultMessage:"Nobody",id:"activitySection.authorPhrase.forNoAuthors.label"})})}(m().A.getIntl(),e,a,t)}function k(e,t){return(0,s.jsx)("span",{children:(0,s.jsx)(n().sA,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.email",values:{author:e,b:e=>(0,s.jsx)("span",{style:t,children:e})}})})}function _(e,t){if(e.table===v().oo){const i=M(e.id,t);if(i)return(0,o().A7)(i)}else{const i=function(e,t){const i=(0,A().Oo)(t,{table:l().GP,id:e});return i.getValue()}(e.id,t);if(i)return(0,o().qt)(i)}}function M(e,t){return A().LU.createChildStore(t,{table:v().oo,id:e}).getValue()}function C(e){const{tab:t,recordId:i,recordType:o,rootStore:n,environment:r}=e;if("all"===t){if(!i)return!1;let e;return"block"===o?e=A().Bv.createChildStore(n,{table:d().ev,id:i}):"collection"===o?e=A().md.createChildStore(n,{table:c().Vl,id:i}):(0,g().HB)(o),(0,y().X9)(r,e)}return!1}function T(e){const{activity:t,rootStore:i}=e;if("commented"!==t.type)return;const o=i.getRecordModel({table:u().$Y,id:t.discussion_id,spaceId:t.space_id});if(!o)return;const n=R(o);return n?{id:o.id,context:n}:void 0}function R(e){const t=e.getPersistedContext(),i=t?(0,a().l8)({discussionContextData:t,discussionType:(0,f().o9)(e.getType()),discussionId:e.id,intl:m().A.getIntl()}):void 0;if(i)return(0,h().JJ$)(i,(t=>!(0,h().iQL)(t)||(0,h().Orm)(t)===e.id))}},142697:(e,t,i)=>{i.d(t,{Xc:()=>l,Yc:()=>u,rL:()=>c});i(610931);var o=()=>i(16456),n=()=>i(66460),r=()=>i(975392),s=()=>i(485966),a=()=>i(818369);const d=20;async function l(e,t){const{store:i,activityIds:o,spaceId:s,filterActivityTypes:l,filterDateRange:c,navigableBlockId:u,collectionId:h,authorId:f,source:p}=t,g=r().$1(o),m=await a().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:s,navigableBlock:u?{id:u,spaceId:(0,n().e)(void 0)}:void 0,collection:h?{id:h,spaceId:(0,n().e)(void 0)}:void 0,endingBeforeId:g,limit:d,activityTypes:l,...v(c),authorId:f,from:p}});if("failed"===m.type)throw m.error;const y=m.data.activityIds;i.update((e=>({...e,shouldLoadNewerActivities:!1,activityIds:y.concat(o)})))}async function c(e,t){const{store:i,activityIds:o,spaceId:s,filterActivityTypes:l,filterDateRange:c,navigableBlockId:u,collectionId:h,authorId:f,source:p}=t,g=r().HV(o),m=await a().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:s,navigableBlock:u?{id:u,spaceId:(0,n().e)(void 0)}:void 0,collection:h?{id:h,spaceId:(0,n().e)(void 0)}:void 0,startingAfterId:g,limit:d,activityTypes:l,...v(c),authorId:f,from:p}});if("failed"===m.type)throw m.error;const y=m.data.activityIds;i.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:o.concat(y),hasOlderActivities:y.length>0})))}async function u(e,t){var i;const{store:o,activityIds:n}=t,r=null===(i=s().default.state.currentSpaceViewStore)||void 0===i?void 0:i.id;if(!r)throw new Error("No space view id");const d=await a().callApi({eventName:"getActivityFeedForHomePrototypeDoNotUse",environment:e,data:{spaceViewId:r}});if("failed"===d.type)throw d.error;const l=d.data.activityIds;o.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:n.concat(l),hasOlderActivities:!1})))}function v(e){var t,i;const n=null!==(t=e.ending)&&void 0!==t&&t.start_date?o().C6.isoToUnixMs(e.ending.start_date):void 0;return{startingAfterTimeMs:null!==(i=e.starting)&&void 0!==i&&i.start_date?o().C6.isoToUnixMs(e.starting.start_date):void 0,endingBeforeTimeMs:n?o().K1({date:n,daysToAdd:1}):void 0}}},154170:(e,t,i)=>{i.d(t,{A:()=>u,I:()=>v});i(242343);var o=()=>i(174114),n=()=>i(653998),r=()=>i(764872),s=()=>i(557067),a=()=>i(84543),d=()=>i(209684),l=()=>i(751634),c=i(163643);function u(e){var t;const{isMobile:i,environment:n,rootStore:r,activity:s,tabArgs:a}=e,{source:d}=a,u=Boolean(null===(t=a.notification)||void 0===t?void 0:t.visited),h=(0,o().IS)((()=>({container:{paddingLeft:(0,l().F9)({source:d,isMobile:i})-8,paddingTop:4}})),[i,d]);return u?(0,c.jsx)("div",{style:h.container,children:(0,c.jsx)(v,{tabArgs:a,environment:n,rootStore:r,activity:s})}):null}function v(e){const{tabArgs:t,environment:i,rootStore:u,activity:v}=e,{notification:h,tab:f}=t,p=(0,o().IS)((e=>({secondaryButton:(0,l().AG)(e)})),[]);return Boolean(null==h?void 0:h.visited)?(0,c.jsx)(d().p,{isGray:!0,size:"xs",onClick:()=>{h&&(a().createAndCommit({userAction:"Activity.handleUnarchive",environment:i,canUndo:!0,perform:e=>{s().JV({notificationId:h.id,visited:!1,rootStore:u,transaction:e})}}),r().sL({environment:i,activity:v,tab:f,notificationId:h.id,alreadyRead:h.read}))},style:p.secondaryButton,children:(0,c.jsx)(n().sA,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"})}):null}},161742:(e,t,i)=>{i.d(t,{A:()=>a});var o=i(242343),n=()=>i(803290),r=i(163643);const s=i(129044).default.createClass(!1,{name:"OpenStore"});const a=function(e){let{items:t,visible:a}=e;const l=(0,i(174114).DP)(),c=(0,n().uB)(void 0,s),u=(0,n().O$)(c),v=(0,o.useCallback)((()=>function(e){e.setState(!0)}(c)),[c]);return u||t.length<=a?(0,r.jsx)("div",{children:t}):(0,r.jsxs)("div",{children:[t.slice(0,a),(0,r.jsx)(i(126451).A,{onClick:v,style:d(l),children:(0,r.jsx)(i(653998).sA,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:t.length-a}})})]})};function d(e){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:e.text.tertiary,padding:0,paddingLeft:52,paddingRight:16}}},184711:(e,t,i)=>{i.d(t,{A:()=>s});i(242343);var o=()=>i(174114),n=()=>i(220413),r=i(163643);function s(){const e=(0,o().IS)((e=>({blockContext:{flexShrink:0,display:"flex",width:3,borderRadius:4,marginLeft:2,marginRight:8,minHeight:20,background:(0,n().eb)(e.mode)}})),[]);return(0,r.jsx)("div",{style:e.blockContext})}},275338:(e,t,i)=>{function o(e){return Date.now()-parseInt(e.timestamp)}i.d(t,{S:()=>o})},546002:(e,t,i)=>{i.d(t,{J:()=>s});i(403517),i(242343);var o=()=>i(174114),n=()=>i(517198),r=i(163643);function s(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const i=(0,o().IS)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),s=[...Array(t)].map(((e,t)=>(0,r.jsxs)("div",{style:i.skeletonSection,children:[(0,r.jsx)(n().A,{style:i.skeletonCircle}),(0,r.jsxs)("div",{style:{width:"80%"},children:[(0,r.jsx)(n().A,{style:{width:"80%",...i.skeletonRect,marginTop:0}}),(0,r.jsx)(n().A,{style:{width:"50%",...i.skeletonRect}}),(0,r.jsx)(n().A,{style:{width:"60%",...i.skeletonRect}}),(0,r.jsx)(n().A,{style:{width:"50%",...i.skeletonRect}})]})]},t)));return(0,r.jsx)("div",{children:s})}},592896:(e,t,i)=>{i.d(t,{Ay:()=>B,H8:()=>w});var o=i(242343),n=()=>i(237385),r=()=>i(803290),s=()=>i(174114),a=()=>i(214263),d=()=>i(880324),l=()=>i(723361),c=()=>i(145017),u=()=>i(653998),v=()=>i(76394),h=()=>i(861917),f=()=>i(983050),p=()=>i(289113),g=()=>i(413871),m=()=>i(356813),y=()=>i(989372),b=()=>i(103151),A=()=>i(951156),x=()=>i(482570),S=()=>i(709356),I=()=>i(233387),j=()=>i(129885),k=i(163643);const _=16,M={paddingTop:12},C={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0},T=i(129044).default.createClass(!1,{name:"HoveredStore"});const R={marginTop:2,marginRight:8,flexShrink:0};function w(e){const{authors:t,size:i,style:o,iconStyle:r,showAvatarShadow:a,showWarningIcon:d}=e,c=(0,n().v3)(),u=(0,s().IS)((e=>({container:{position:"relative"},icon:{position:"absolute",right:5,bottom:-3,fill:e.icon.yellowPrimary,height:12,width:12}})),[]),h=t.sort(((e,t)=>(0,j().G7)({actor:e,environment:c})-(0,j().G7)({actor:t,environment:c})))[0],f=i,p={...R,...o},g={...u.icon,...r};return h?h.isBot()?(0,k.jsxs)("div",{style:u.container,children:[(0,k.jsx)(A().A,{botValue:h,style:p,size:f}),d&&(0,l().Q)(g)]}):h.isUser()?(0,k.jsxs)("div",{style:u.container,children:[(0,k.jsx)(x().A,{userValue:h,style:p,size:f,avatarShouldShowShadow:a??!0}),d&&(0,l().Q)(g)]}):h.isAgent()?null:void(0,v().HB)(h):null}const B=function(e){let{children:t,icon:i,timestamp:s,header:a,navigableBlockId:d,rootStore:l,onBacklinkClicked:c,showSnapshotButton:u,isPrivate:v,isLast:h}=e;const p=(0,n().v3)(),g=(0,r().uB)(void 0,T),m=(0,o.useCallback)((()=>function(e){e.setState(!1)}(g)),[g]),y=(0,o.useCallback)((()=>function(e){e.setState(!0)}(g)),[g]),b=(0,o.useId)(),A=(0,r().K8)((()=>p.WindowSizeStore.state.paddingLeftCSS),[p]),x=(0,r().K8)((()=>p.WindowSizeStore.state.paddingRightCSS),[p]),S=(0,k.jsxs)("div",{style:{...M,paddingBottom:t?12:8,paddingLeft:p.device.isMobile?A:0,paddingRight:p.device.isMobile?x:0},children:[(0,k.jsxs)("div",{style:{display:"flex",paddingLeft:_,paddingRight:_},children:[(0,k.jsxs)("div",{className:f().a9W,style:{display:"flex",alignItems:"flex-start",position:"relative"},children:[(0,k.jsx)("div",{style:{marginRight:4}}),i]}),(0,k.jsx)(F,{timestamp:s,header:a,children:t,navigableBlockId:d,rootStore:l,onBacklinkClicked:c,titleAriaId:b}),(0,k.jsx)(V,{showSnapshotButton:u,timestamp:s,navigableBlockId:d,rootStore:l}),(0,k.jsx)(L,{isPrivate:v})]}),t&&(0,k.jsx)(O,{children:t})]});return(0,k.jsxs)("article",{onMouseOver:y,onMouseLeave:m,"aria-labelledby":b,children:[S,(0,k.jsx)(N,{isLast:h})]})};function L(e){let{isPrivate:t}=e;return t?(0,k.jsx)(I().A,{style:{marginTop:1,marginBottom:4,marginLeft:8}}):null}function O(e){let{children:t}=e;return(0,k.jsx)("div",{className:f().CyB,children:t})}function D(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}function U(e){return{fontSize:12,color:e.text.tertiary}}function P(e){return{fontSize:12,color:e.text.tertiary,whiteSpace:"nowrap"}}function K(e){return{fontSize:12,color:e.text.tertiary,marginLeft:4,marginRight:4}}function N(e){let{isLast:t}=e;const i=(0,s().DP)();return t?null:(0,k.jsx)("div",{style:D(i)})}function V(e){let{showSnapshotButton:t,timestamp:i,navigableBlockId:o,rootStore:r}=e;const s=(0,n().v3)(),a=(0,u().tz)();if(!t)return null;if(i<new Date("2018-10-26").getTime())return null;const l=a.formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"});return o?(0,k.jsx)(b().A,{renderTooltip:()=>l,render:e=>(0,k.jsx)(m().A,{ariaLabel:l,onClick:()=>function(e,t,i,o){if(o){const n=g().Bv.createChildStore(e,{table:c().ev,id:o});h().WE({environment:i,blockStore:n,openSnapshotNearTimestamp:t.toString(),from:"activity"})}}(r,i,s,o),icon:d().L,...e})}):null}function F(e){let{titleAriaId:t,timestamp:i,header:n,children:r,navigableBlockId:d,rootStore:l,onBacklinkClicked:u}=e;const v=(0,s().DP)(),h=(0,p().nl)(i),m=(0,p().x$)(i),b=(0,o.useMemo)((()=>d?g().Bv.createChildStore(l,{table:c().ev,id:d}):void 0),[d,l]);return(0,k.jsxs)("div",{style:C,children:[(0,k.jsx)("div",{id:t,className:f().k2l,children:n}),(0,k.jsxs)("div",{style:{display:"flex",marginTop:4,marginBottom:r?8:4},children:[(0,k.jsx)("div",{style:P(v),className:f().Cxn,children:(0,k.jsx)(S().A,{text:h,tooltipText:m,icon:a().k})}),l&&b&&(0,k.jsx)(y().Ay,{isLink:!0,innerStyle:U(v),store:b,left:(0,k.jsx)("div",{style:K(v),children:"·"}),onClick:u})]})]})}},643165:(e,t,i)=>{i.d(t,{A:()=>k,E:()=>j});i(725707),i(491955),i(403517),i(242343);var o=()=>i(237385),n=()=>i(803290),r=()=>i(712437),s=()=>i(762847),a=()=>i(758611),d=()=>i(145017),l=()=>i(890449),c=()=>i(387218),u=()=>i(653998),v=()=>i(413871),h=()=>i(931085),f=()=>i(586121),p=()=>i(161742),g=()=>i(644515),m=()=>i(129885),y=()=>i(154170),b=()=>i(751634),A=()=>i(29302),x=()=>i(592896),S=()=>i(654794),I=i(163643);function j(e){return(0,c().W9)(e).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==l().SN}))}function k(e){const{activity:t,tabArgs:i,rootStore:r,isLast:s}=e,{notification:a,tab:l}=i,c=(0,o().v3)(),h=(0,n().K8)((()=>j(t.getEdits())),[t]),f=h[0],b=(0,n().K8)((()=>parseInt(t.end_time)),[t]),k=(0,n().K8)((()=>f&&v().Bv.createChildStore(r,{table:d().ev,id:f.navigable_block_id})),[f,r]),M=(0,n().K8)((()=>(0,m().Ln)({edits:h,rootStore:r})),[h,r]),C=(0,n().K8)((()=>(0,m().bD)(M)),[M]),T=(0,n().K8)((()=>k&&(0,m().DU)({recordId:k.id,recordType:"block",tab:l,rootStore:r,environment:c})),[k,l,r,c]);if(0===h.length||!k)return null;const R=(0,I.jsx)(A().A,{titledRecordStore:k,activity:t,tabArgs:i,getRecordModel:r.getRecordModel});return(0,I.jsxs)(x().Ay,{timestamp:b,header:(0,I.jsx)("span",{children:(0,I.jsx)(u().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",values:{numberOfAuthors:M.length,authorOrAuthors:C,pageTitle:R}})}),isLast:s,isPrivate:T,rootStore:r,navigableBlockId:k.id,icon:(0,I.jsx)(x().H8,{authors:M,size:24}),showSnapshotButton:(0,S().m)(i),...(0,g().em)({notification:a,activity:t,environment:c,tab:l}),children:[(0,I.jsx)(p().A,{visible:5,items:h.map(((e,o)=>(0,I.jsx)(_,{edit:e,index:o,activity:t,rootStore:r,tabArgs:i},o)))}),(0,I.jsx)(y().A,{tabArgs:i,activity:t,isMobile:c.device.isMobile,environment:c,rootStore:r})]})}function _(e){let{edit:t,index:i,activity:l,rootStore:c,tabArgs:u}=e;const v=(0,o().v3)(),{source:p}=u,m=(0,n().K8)((()=>{let e=c.getRecordModel({table:d().ev,id:t.block_id});return e&&e.type===s().xd.tableRow&&(e=c.getRecordModel({table:d().ev,id:e.parent_id})),e?e.getRenderUrl({getRecordModel:c.getRecordModel,pageVisitSource:r().y8.Activity}):a().JZ.root}),[t.block_id,c]),y=v.device.isMobile;return"block-deleted"===t.type?t.block_data.block_value.type===s().xd.page?(0,I.jsx)(h().A,{href:m,onClick:()=>(0,g().uY)({...u,environment:v,activity:l}),innerStyle:(0,b().aY)({source:p,isMobile:y}),children:(0,I.jsx)(f().A,{edit:t,rootStore:c})},i):(0,I.jsx)("div",{style:(0,b().aY)({source:p,isMobile:y}),children:(0,I.jsx)(f().A,{edit:t,rootStore:c})},i):(0,I.jsx)(h().A,{href:m,onClick:()=>(0,g().uY)({...u,environment:v,activity:l}),innerStyle:(0,b().aY)({source:p,isMobile:y}),children:(0,I.jsx)(f().A,{edit:t,rootStore:c})},i)}},644515:(e,t,i)=>{i.d(t,{$5:()=>g,P:()=>h,Qo:()=>l,em:()=>p,hx:()=>c,jU:()=>u,jv:()=>v,uY:()=>d});var o=()=>i(820510),n=()=>i(764872),r=()=>i(137476),s=()=>i(487893),a=()=>i(264109);function d(e){const t=e.mightCloseTab??!0;f({target:"body",...e,mightCloseTab:t})}function l(e){const t=e.mightCloseTab??!0;f({target:"title",...e,mightCloseTab:t})}function c(e){f({target:"approve_request_access",...e,mightCloseTab:!1})}function u(e){f({target:"deny_request_access",...e,mightCloseTab:!1})}function v(e){f({target:"remove_reaction",...e,mightCloseTab:!1})}function h(e){f({target:"add_reaction",...e,mightCloseTab:!1})}function f(e){const{target:t,environment:i,activity:s,notification:d,source:l,tab:c,mightCloseTab:u}=e,v="notifications_tab"===l?a().Ay.state.sessionId:void 0,h="notifications_tab"===l?a().Ay.isFilteredToUnreadOnly():void 0;n().nR(i,{target:t,activity_id:s.id,notification_id:null==d?void 0:d.id,notification_page_id:null==d?void 0:d.navigable_block_id,sessionId:v,is_filtered:h,tab:c}),u&&n().s$({environment:i,target:t}),d&&o().v((0,r().ik)(i),{alreadyRead:d.read,notificationId:d.id,activityId:d.activity_id,from:t,sessionId:v})}function p(e){const{notification:t,activity:i,environment:o,tab:r}=e,s={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r};return{onBacklinkClicked:e=>n().uK({...s,backlinkPageId:e}),onNotificationFrameClicked:()=>n().Hd(s),...g({notification:t,activity:i,environment:o,tab:r})}}function g(e){const{notification:t,activity:i,environment:o,tab:r}=e,a={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r},d=()=>{const e={notification_type:null==t?void 0:t.type,notification_page_id:null==t?void 0:t.navigable_block_id,tab:s().dl()};return"commented"===(null==t?void 0:t.type)&&(e.discussion_id=null==i?void 0:i.discussion_id),e};return{onArchiveClicked:()=>n().R0({...a,otherArgs:d()}),onUnarchiveClicked:()=>n().sL({...a,otherArgs:d()}),onMarkAsReadClicked:()=>n().oy({...a,otherArgs:d()}),onMarkAsUnreadClicked:()=>n().bl({...a,otherArgs:d()}),onNotificationBodyClicked:()=>n().e0({...a,otherArgs:d()})}}},654794:(e,t,i)=>{function o(e){return"pageUpdatesSidebar"===e.tab}i.d(t,{m:()=>o})},709356:(e,t,i)=>{i.d(t,{A:()=>d});i(242343);var o=()=>i(174114),n=()=>i(31448),r=()=>i(907721),s=()=>i(103151),a=i(163643);function d(e){let{text:t,tooltipText:i,icon:d}=e;const l=(0,o().IS)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.shadowSM},container:{display:"flex",alignItems:"center",fontWeight:n().Wy.regular,color:e.text.secondary,fontSize:n().J.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,a.jsx)(s().A,{style:l.tooltip,render:e=>(0,a.jsx)("div",{style:l.text,...e,children:t}),renderTooltip:()=>(0,a.jsxs)("div",{style:l.container,children:[d(l.icon),(0,a.jsx)("div",{children:i})]}),alignment:r().C.Start,placement:r().W.Bottom})}},727812:(e,t,i)=>{i.d(t,{L:()=>o});class o extends(()=>i(129044))().default{getInitialState(){return{activityIds:[],shouldLoadNewerActivities:!1,shouldLoadOlderActivities:!0,hasOlderActivities:!0,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0}}}}},731394:(e,t,i)=>{i.d(t,{Cn:()=>n,oV:()=>a,tK:()=>s});i(403517);var o=()=>i(76394);let n=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const r=new Map;function s(e,t){r.set(d(e),t)}function a(e){return r.get(d(e))??[]}function d(e){return(0,o().uv)(e).sort().map((t=>{const i=e[t];return JSON.stringify(i)})).join("-")}},751634:(e,t,i)=>{i.d(t,{AG:()=>l,Ei:()=>u,F9:()=>d,aY:()=>a,a_:()=>s,kI:()=>r,vF:()=>n,xC:()=>c});const o={userSelect:"text",WebkitUserSelect:"text"},n={padding:1,...o},r={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},s={fontWeight:i(31448).Wy.semibold};function a(e){return{padding:0,paddingLeft:d(e),paddingRight:16,paddingBottom:3,...o}}function d(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function l(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.text.secondary}}function c(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...s}}function u(e){return{boxShadow:e.shadow2XS,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.text.primary}}},840408:(e,t,i)=>{i.d(t,{A:()=>ae});i(403517);var o=i(242343),n=()=>i(237385),r=()=>i(803290),s=()=>i(174114),a=()=>i(162901),d=()=>i(214263),l=()=>i(651632),c=()=>i(201430),u=()=>i(644353),v=()=>i(653998),h=()=>i(975392),f=()=>i(141666),p=()=>i(142697),g=()=>i(764872),m=()=>i(129978);const y=new(m().O2)("activityUpdate",(async()=>await i.e(13319).then(i.bind(i,195125)))),b=(0,m()._h)(y,(e=>e.ActivityUpdate));var A=()=>i(360482),x=()=>i(904697),S=()=>i(731394),I=()=>i(622286),j=()=>i(698094),k=()=>i(546002),_=()=>i(819788),M=()=>i(727812),C=()=>i(485966),T=()=>i(962373),R=()=>i(802955);class w extends(()=>i(129044))().default{getInitialState(){return{selectedItems:[]}}}const B=w;var L=()=>i(264109),O=(i(362833),()=>i(470637)),D=(i(610931),i(725707),i(491955),()=>i(759260)),U=(i(107652),()=>i(129221)),P=()=>i(868419),K=()=>i(890449),N=()=>i(34662),V=()=>i(154131),F=()=>i(966789),z=()=>i(129885),H=i(163643);const E=["block-deleted","block-created","block-changed"];function $(e){return 0===e.length?["\n"]:e}const Y=function(e){let{batch:t,rootStore:r,pageTitleElem:a,activityTime:d,source:l,currentPageTitle:c}=e;const u=(0,n().v3)(),h=(0,v().tz)(),f=(0,i(863969).O)(),p=(0,o.useMemo)((()=>O().A.withListenerIgnored((()=>t.map((e=>{const t=e.edits;let i;i="comment-created"===e.type?function(e,t,i,o){var n,r;const s=t.getRecordStore(t,{table:D().$Y,id:i,spaceId:o});if(!s||0===e.length||!e[0].comment_id)return{beforeValue:"",afterValue:"",diffs:[],error:"invalid comment/discussion"};const a=e[0],d=t.getRecordModel({table:K().SN,id:a.comment_id,spaceId:a.space_id}),l=s.getModel();return l?{beforeValue:"",afterValue:`New comment on text: "${null===(n=(0,z().pN)(l))||void 0===n?void 0:n[0][0]}" in the document. The comment says: "${null==d||null===(r=d.getText())||void 0===r?void 0:r.toString()}"`,diffs:[],error:void 0}:{beforeValue:"",afterValue:"",diffs:[],error:"invalid comment/discussion"}}(e.edits,r,e.discussion_id,e.space_id):function(e,t){const i=[],o=[],n=[];if(e.every(U().Z1))return{beforeValue:"",afterValue:"",diffs:[],error:"unsupported"};for(const r of e){const e=(0,U().hd)(r,t).title,s=null==e?void 0:e.type,a="text"===s||"title"===s,d=E.includes(r.type);if(a||d){if("block-changed"===r.type&&a){const e=(0,V().De)(r.block_data.before.block_value,"title"),t=(0,V().De)(r.block_data.after.block_value,"title");i.push(e),o.push(t),n.push(P().yR({before:e,after:t,insertionAnnotation:[N().Ifu.Inserted],deletionAnnotation:[N().Ifu.Deleted]}))}else if("block-created"===r.type&&a){const e=(0,V().De)(r.block_data.block_value,"title");o.push(e),n.push(P().yR({before:[],after:e,insertionAnnotation:[N().Ifu.Inserted],deletionAnnotation:[N().Ifu.Deleted]}))}else if("block-deleted"===r.type&&a){const e=(0,V().De)(r.block_data.block_value,"title");i.push(e),n.push(P().yR({before:e,after:[],insertionAnnotation:[N().Ifu.Inserted],deletionAnnotation:[N().Ifu.Deleted]}))}}else{const e=`Invalid types '${r.type}', '${s}' for AI summary.`;i.push([e]),o.push([e])}}return{beforeValue:i.map((e=>JSON.stringify($(e)))).join(", "),afterValue:o.map((e=>JSON.stringify($(e)))).join(", "),diffs:n,error:void 0}}(e.edits,h);const o=function(e,t,i){return(0,z().Ln)({edits:e,rootStore:i}).map((e=>e.isUser()?e.getFullName(t):"A bot ")).join(", ")}(t,h,r);return{authors:o,before:i.beforeValue,after:i.afterValue,end_time:e.end_time}}))))),[t,h,r]),[g,m]=(0,o.useState)(""),y=(0,s().IS)((e=>({inner:{color:e.text.primary,fontSize:14,margin:13,marginBottom:-5},text:{margin:5,marginLeft:2}})),[]);return(0,o.useEffect)((()=>{(async()=>{const e=i(214144).JW(),t={type:"edit_history",edits:p,page_title:c};if(!f)return;const o=await i(818369).callStreamApi({eventName:"getCompletion",environment:u,data:{id:(0,i(3311).lZ)(),context:t,model:"openai-gpt-4o-mini",spaceId:f,isSpacePermission:!1,aiSessionId:e,inferenceReason:"home_tile_prototype",metadata:{}},headers:(0,i(519423).WS)({spaceId:f})});if("success"!==o.type)return;let n="";if(i(543736).hS.is(o.data))for await(const i of o.data)"success"===i.type&&(n+=i.completion);m(n)})()}),[u,f,c,d,p]),(0,H.jsxs)("div",{style:y.inner,children:["home_tile"===l&&(0,H.jsx)(v().sA,{id:"activityUpdate.aiSummary",defaultMessage:"{pageTitle} · {activityTime}",values:{pageTitle:a,activityTime:(0,i(289113).nl)(d)}}),void 0===g||""===g?(0,H.jsxs)("div",{style:y.text,children:[(0,H.jsx)(F().A,{style:{display:"inline"}}),(0,H.jsx)("span",{style:{marginLeft:"10px"},children:"Loading summary... "}),(0,H.jsx)("br",{})]}):(0,H.jsx)("div",{style:y.text,children:g})]})};var W=()=>i(930961);const J=function(e){const{batch:t,rootStore:a,tabArgs:d,isLast:l}=e,c=(0,n().v3)(),u=(0,v().tz)(),h=(0,s().IS)((e=>({details:{color:e.text.secondary,fontSize:12,marginLeft:15,marginTop:9,marginBottom:10},hr:{border:"none",height:1,backgroundColor:e.tableDividerColor}})),[]),f=(0,o.useMemo)((()=>O().A.withListenerIgnored((()=>t.activities.map((e=>{if("block-edited"===e.type)return{type:"block-edited",end_time:parseInt(e.end_time),edits:(0,i(643165).E)(e.getEdits())};if("commented"===e.type){const t=a.getRecordStore(a,{table:D().$Y,id:e.discussion_id,spaceId:e.space_id});if(!t.isDefined())return;const i=(0,W().s6)(e.getEdits(),d.source,t);if(!(0,W().Aj)(i)||0===i.length)return;return{type:"comment-created",end_time:parseInt(e.end_time),edits:i,discussion_id:e.discussion_id,space_id:e.space_id}}throw new Error("Unsupported activity type")})).filter(i(76394).O9)))),[t,a,d.source]),p=(0,r().K8)((()=>{if(0===f.length)return;const e=f[0].edits[0];return e&&i(413871).Bv.createChildStore(a,{table:i(145017).ev,id:e.navigable_block_id})}),[f,a]),g=(0,r().K8)((()=>p&&(0,i(92451).Qe)(p,u,c,!0)),[c,u,p]);return 0!==f.length&&p?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Y,{batch:f,rootStore:a,activityTime:f[0].end_time,source:d.source,pageTitleElem:(0,H.jsx)(i(29302).A,{titledRecordStore:p,activity:t.activities[0],tabArgs:d,getRecordModel:a.getRecordModel}),currentPageTitle:g??"No page title"}),(0,H.jsx)("details",{style:h.details,open:!1,children:t.activities.map((e=>(0,H.jsx)(b,{activity:e,rootStore:a,tabArgs:d,isLast:l},e.id)))}),(0,H.jsx)("hr",{style:h.hr})]}):null};const G=function(e){let{activities:t,rootStore:i}=e;const n=(0,o.useMemo)((()=>O().A.withListenerIgnored((()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const i=[],o={};for(const n of e){const e=n.navigable_block_id;if(!e)continue;if(!o[e]){o[e]=[n];continue}const r=o[e][o[e].length-1];Math.abs((Number(r.end_time)-parseInt(n.end_time))/36e5)<=t?o[e].push(n):(o[e].sort(((e,t)=>parseInt(t.end_time)-parseInt(e.end_time))),i.push({page:e,activities:o[e],latest_activity_end_time:parseInt(o[e][0].end_time)}),o[e]=[n])}for(const n in o)o[n].length>0&&(o[n].sort(((e,t)=>parseInt(t.end_time)-parseInt(e.end_time))),i.push({page:n,activities:o[n],latest_activity_end_time:parseInt(o[n][0].end_time)}));return i.sort(((e,t)=>t.latest_activity_end_time-e.latest_activity_end_time)),i}(t).slice(0,20)))),[t]);return(0,H.jsx)("section",{role:"feed","aria-label":"Recent updates",children:n.map(((e,t)=>(0,H.jsx)(J,{batch:e,rootStore:i,isLast:t===e.activities.length-1,tabArgs:{tab:"homeTile",source:"home_tile"}},t)))})};var X=()=>i(168980),Z=()=>i(35462),Q=()=>i(641828),q=()=>i(535906),ee=()=>i(489090),te=()=>i(634444);const ie=function(e){let{mode:t,title:i,onChange:n,disabled:s,focused:a,onMenuDismiss:d,items:l,addItemLabel:c,tokenInputPlaceholder:u,resultSectionTitle:v,componentDebugName:h,icon:f,getItemLabel:p,options:g,store:m}=e;const y=(0,r().uB)(m,B),b=(0,r().O$)(y);return(0,o.useEffect)((()=>{y.setState({selectedItems:l})}),[l,y]),(0,H.jsx)(te().A,{mode:t,hasItemsSelected:b.selectedItems.length>0,title:i,icon:f,items:l,onChange:e=>{n(e)},disabled:s,focused:a,renderFilter:(e,t)=>(0,H.jsx)(re,{getItemLabel:p,item:e,args:t}),renderToken:e=>(0,H.jsx)(ne,{item:e}),renderItemForSummary:e=>(0,H.jsx)(oe,{item:e}),addItemLabel:c,labelText:{title:i,tokenInputPlaceholder:u,resultSectionTitle:v,componentDebugName:h},performRequest:e=>function(e,t){let{query:i}=e;return Promise.resolve(t.filter((e=>e.includes(i))))}(e,g),renderResultMenuItem:(e,i)=>(0,H.jsx)(se,{getItemLabel:p,mode:t,store:y,item:e,props:i}),onMenuDismiss:d})};function oe(e){let{item:t}=e;return(0,H.jsx)(H.Fragment,{children:`hello${t}`})}function ne(e){let{item:t}=e;return(0,H.jsx)(H.Fragment,{children:t})}function re(e){let{item:t,args:i,getItemLabel:o}=e;const{disabled:r,onRemove:s,onClick:a}=i,d=function(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:4}}}((0,n().v3)()),l=(0,H.jsx)(ee().A,{disabled:r,onClick:s});return(0,H.jsx)(q().A,{title:(null==o?void 0:o(t))||t,disabled:r,focused:!1,right:l,style:d.menuItem,desktopTitleStyle:d.menuItemTitle,onClick:a})}function se(e){let{item:t,props:i,getItemLabel:n,mode:s,store:a}=e;const d=(0,r().uB)(a,B),l=(0,r().K8)((()=>d.state.selectedItems),[d]);return(0,o.createElement)(q().A,{...i,key:t,title:(null==n?void 0:n(t))||t,isChecked:s===te().C.Pill&&l.includes(t)})}function ae(e){var t;const{spaceId:i,navigableBlockStore:d,collectionId:l,authorId:u,source:g}=e,m=null==d?void 0:d.id,y=(0,n().v3)(),w=(0,r().uB)(void 0,M().L),B=(0,r().uB)(void 0,T().A),O=(0,s().IS)((e=>({placeholderContent:ue(y,e),banner:{padding:"12px 10px"}})),[y]),D=(0,o.useMemo)((()=>h().nF((e=>function(e,t){t.update((e=>({...e,shouldLoadNewerActivities:!0})))}(0,w)),1e3)),[w]),U=(0,o.useMemo)((()=>f().Hg(D)),[D]);(0,o.useEffect)((()=>{let e,t,i;if(m){const t=(0,c().O$)(m);e=j().Ay.addListener(t,void 0,U,void 0,y)}if(l){const e=(0,c().zB)(l);t=j().Ay.addListener(e,void 0,U,void 0,y)}if(u){const e=(0,c().Ii)(u);i=j().Ay.addListener(e,void 0,U,void 0,y)}return()=>{e&&j().Ay.removeListener(e,y),t&&j().Ay.removeListener(t,y),i&&j().Ay.removeListener(i,y)}}),[l,y,U,m,u]);const P=(0,r().O$)(R().e),K=(0,r().K8)((()=>{const e=w.state;return 0===e.filterActivityTypes.length&&void 0===e.filterDateRange.ending&&void 0===e.filterDateRange.starting}),[w]),N=(0,r().K8)(x().areUpdatesFiltersEnabled,[]),V=(0,I().X)("updates_ai"),{currentUserStore:F,currentSpaceStore:z}=(0,r().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=C().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),{shouldLoadOlderActivities:E,shouldLoadNewerActivities:$,filterActivityTypes:Y,filterDateRange:W,activityIds:J,hasOlderActivities:Q}=(0,r().K8)((()=>{const{shouldLoadOlderActivities:e,shouldLoadNewerActivities:t,filterActivityTypes:i,filterDateRange:o,activityIds:n,hasOlderActivities:r}=w.state;return{shouldLoadOlderActivities:e,shouldLoadNewerActivities:t,filterActivityTypes:i,filterDateRange:o,activityIds:n,hasOlderActivities:r}}),[w]),[q]=(0,a().Yb)((async()=>{if(!P||!F||!z)return;const e=L().Ay.startLoading();$?await p().Xc(y,{store:w,activityIds:J,spaceId:i,filterActivityTypes:Y,filterDateRange:W,navigableBlockId:m,collectionId:l,authorId:u,source:g}):E&&Q&&("home_tile"===g?await p().Yc(y,{store:w,activityIds:J,spaceId:i,filterActivityTypes:Y,filterDateRange:W,navigableBlockId:m,collectionId:l,source:g}):await p().rL(y,{store:w,activityIds:J,spaceId:i,filterActivityTypes:Y,filterDateRange:W,navigableBlockId:m,collectionId:l,authorId:u,source:g})),L().Ay.endLoading(e)}),[J,w,l,z,F,y,Y,W,Q,P,m,$,E,i,g,u]),ee=q.error,te="resolved"===q.status,ie=(0,r().K8)((()=>{if(!F)return[];const e=F.id,t=(0,_().T)("supportsNativeHome"),o={spaceId:i,userId:e,navigableBlockId:m,collectionId:l,filterDateRange:W,filterActivityTypes:Y,authorId:u},n=t&&0===J.length&&!te?S().oV(o):J;return t&&te&&S().tK(o,J),function(e){return h().oE(e.map((e=>function(e){const{currentUserStore:t,currentSpaceStore:i}=C().default.state;if(!t||!i)return;const o=(0,A().jA)(i,e,i.id),n=o.getModel();return n&&!n.invalid?n:null}(e))))}(n)}),[J,l,F,Y,W,u,m,te,i]);if(!P)return(0,H.jsx)(ve,{});if(!F||!z)return null;const oe=0===ie.length&&!Q&&te,ne=z;if(ee)return(0,H.jsx)("div",{style:O.placeholderContent,children:(0,H.jsx)(v().sA,{defaultMessage:"Something went wrong.",id:"activityUpdate.unknownErrorLoadingActivities.message"})});if(0===ie.length&&!te)return(0,H.jsxs)("div",{children:[N&&(0,H.jsx)(de,{collectionId:l,source:g,activityUpdatesStore:w,filterPopupStore:B}),(0,H.jsx)(k().J,{areaHeight:window.innerHeight})]});const re=(0,H.jsx)(Z().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,H.jsxs)("div",{style:{paddingTop:"15px",paddingRight:"10px",marginBottom:"-8px",paddingLeft:"10px"},children:["We're testing out AI summaries of updates on suggested pages. AI can make mistakes. Please leave feedback ",(0,H.jsx)("a",{href:"https://dev.notion.so/notion/Home-feed-with-AI-summary-feedback-doc-fffb35e6e67f8083b14ecc64c6ed465d",children:"here"}),"!"]})}),se=(0,H.jsxs)("div",{style:{...O.banner,marginTop:"-10px"},children:["Did you read to the end? Please let us know ",(0,H.jsx)("a",{href:"https://dev.notion.so/notion/Home-feed-with-AI-summary-feedback-doc-fffb35e6e67f8083b14ecc64c6ed465d",children:"here"}),", particularly if anything was helpful or unhelpful!"]});return(0,H.jsxs)("div",{children:[V&&"home_tile"===g&&re,N&&(0,H.jsx)(de,{collectionId:l,source:g,activityUpdatesStore:w,filterPopupStore:B}),(0,H.jsxs)("div",{style:oe?O.placeholderContent:ce(y,g),className:oe?"":"notranslate",children:[oe?null===(t=e.empty)||void 0===t?void 0:t.call(e,{hasFiltersOn:!K}):null,V&&"home_tile"===g?(0,H.jsx)(G,{activities:ie,rootStore:ne}):(0,H.jsx)("section",{role:"feed",children:ie.map(((e,t,i)=>{const o=i.length-1===t,n="notifications_tab"===g?{tab:"all",source:g}:"updates_sidebar"===g?{tab:"pageUpdatesSidebar",source:g}:"person_profile"===g?{tab:"personProfile",source:g}:{tab:"homeTile",source:g};return(0,H.jsx)(b,{activity:e,rootStore:ne,isLast:o,tabArgs:n},e.id)}))}),(0,H.jsx)(X().A,{onChange:e=>{e<200&&te&&!E&&Q&&(K||ie.length>0)&&w.update((e=>({...e,shouldLoadOlderActivities:!0})))},children:!te&&Q?(0,H.jsx)(he,{isPaginated:!0}):null})]}),V&&("home_tile"===g?(0,H.jsx)(Z().A,{isSecondaryColor:!0,isMultiline:!0,children:se}):null)]})}function de(e){const{collectionId:t,source:i,activityUpdatesStore:o,filterPopupStore:n}=e,{currentUserStore:s,currentSpaceStore:a}=(0,r().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=C().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),d=(0,r().K8)((()=>o.state.filterActivityTypes.length>0||o.state.filterDateRange.ending||o.state.filterDateRange.starting),[o]);return s&&a?(0,H.jsxs)("div",{style:{display:"flex",flexDirection:"row",padding:"12px 10px",width:"100%",gap:6},children:[(0,H.jsx)(le,{collectionId:t,source:i,filterPopupStore:n,activityUpdatesStore:o}),(0,H.jsx)(ye,{source:e.source,activityUpdatesStore:o,filterPopupStore:n}),d&&(0,H.jsx)(me,{source:e.source,activityUpdatesStore:o})]}):null}function le(e){const{collectionId:t,source:i,activityUpdatesStore:s,filterPopupStore:a}=e,d=(0,v().tz)(),c=(0,n().v3)(),h=t?u().Fv:u().IP,f=(0,r().uB)(void 0,B),p=(0,r().K8)((()=>s.state.filterActivityTypes),[s]),g=(0,o.useCallback)((()=>{pe(a)}),[a]);return(0,H.jsx)(ie,{store:f,focused:!1,icon:l().v,options:[...h].sort(),items:p,mode:te().C.Pill,title:(0,H.jsx)(v().sA,{id:"activityUpdates.filterMenu.byType.title",defaultMessage:"Activity type"}),tokenInputPlaceholder:d.formatMessage({id:"activityUpdates.filterMenu.byType.search",defaultMessage:"Search for a type"}),resultSectionTitle:d.formatMessage({id:"activityUpdates.filterMenu.byType.resultSectionTitle",defaultMessage:"Activity Types"}),addItemLabel:d.formatMessage({id:"activityUpdates.filterMenu.byType.addItemLabel",defaultMessage:"Add an activity type"}),componentDebugName:"ActivityUpdatesSearchEditTypesFilter",onChange:e=>ge((()=>s.update((t=>({...t,filterActivityTypes:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0,shouldLoadNewerActivities:!1})))),c,i,s),onMenuDismiss:g,getItemLabel:e=>e.split("-").map((e=>e.replace(/(^.)/,(e=>e.toUpperCase())))).join(" ")})}function ce(e,t){return{minHeight:e.device.isMobile?void 0:"75vh",padding:t&&"home_tile"===t?"10px":void 0}}function ue(e,t){const{device:i}=e;return{...ce(e),paddingTop:i.isMobile?32:void 0,paddingBottom:i.isMobile?32:void 0,minHeight:i.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:t.text.secondary,flexDirection:"column",flex:"1 1 0%"}}function ve(){const e=(0,n().v3)(),t=(0,s().IS)((t=>({offlineMessage:ue(e,t)})),[e]);return(0,H.jsx)("div",{style:t.offlineMessage,children:(0,H.jsx)(v().sA,{defaultMessage:"Please go online to view updates.",id:"activityUpdates.offlineMessage"})})}function he(e){let{isPaginated:t}=e;const i=(0,n().v3)(),o=(0,s().IS)((e=>({spinner:{...ue(i,e),minHeight:t?64:220}})),[i,t]);return(0,H.jsx)("div",{style:o.spinner,children:(0,H.jsx)(F().A,{})})}function fe(e){var t,i;const{filterActivityTypes:o,filterDateRange:n}=e.state;return{activityTypes:o,dateRange:{start:null===(t=n.starting)||void 0===t?void 0:t.start_date,end:null===(i=n.ending)||void 0===i?void 0:i.start_date}}}function pe(e){e.setState({...e.state,open:!1})}function ge(e,t,i,o){const n=fe(o);e();const r=fe(o);g().Xl({environment:t,activityUpdatesSource:i,filters:r,prevFilters:n})}function me(e){let{source:t,activityUpdatesStore:i}=e;const o=(0,n().v3)(),r=(0,s().IS)((e=>({clearButton:{flexGrow:1,textAlign:"right",cursor:"pointer",fontSize:14,color:e.text.secondary,marginRight:8}})),[]);return(0,H.jsx)("div",{style:r.clearButton,onClick:()=>ge((()=>i.reset()),o,t,i),children:(0,H.jsx)(v().sA,{defaultMessage:"Clear",id:"activityUpdates.clearFilters"})})}function ye(e){let{source:t,activityUpdatesStore:i,filterPopupStore:s}=e;const a=(0,n().v3)(),l=(0,o.useCallback)((()=>pe(s)),[s]),c=(0,r().K8)((()=>i.state.filterDateRange),[i]);return(0,H.jsx)(Q().A,{mode:te().C.Pill,focused:!1,showButtons:!0,title:(0,H.jsx)(v().sA,{id:"activityUpdates.filterMenu.byDate",defaultMessage:"Date Range"}),icon:d().k,value:c,onMenuDismiss:l,onChange:e=>ge((()=>i.update((t=>({...t,filterDateRange:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0})))),a,t,i)})}},861917:(e,t,i)=>{i.d(t,{j8:()=>p,un:()=>h,p2:()=>v,WE:()=>u,n5:()=>g,Xn:()=>f});var o=()=>i(66460);const n=(0,i(851552).Dv)("restoreSnapshot");var r=()=>i(900376),s=()=>i(137476);var a=()=>i(275338);var d=()=>i(839618),l=()=>i(70989);const c=(0,i(653998).YK)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function u(e){const{environment:t,from:i,...o}=e;!function(e,t){s().vd(e,"open_history",{from:t})}(t,i),r().A.setState({...o,open:!0,size:50})}function v(){const e=r().A.state;e.open&&r().A.setState({...e,size:e.size+20})}function h(){r().A.setState({open:!1})}function f(e){const{environment:t,snapshot:i,nextFutureSnapshot:o}=e;!function(e,t){s().vd(e,"select_snapshot",{ageMs:(0,a().S)(t)})}(t,i);const n=r().A.state;n.open&&r().A.setState({...n,snapshot:i,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function p(){const e=r().A.state;e.open&&r().A.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function g(e,t){if(!r().A.state.open||!r().A.state.snapshot)return;if(!r().A.state.snapshot)return;!function(e,t){s().vd(e,"restore_snapshot",{ageMs:(0,a().S)(t)})}(e,r().A.state.snapshot),l().m({message:c.restoringPreviousVersion});const i=await d().UT(e,n,{block:{id:r().A.state.blockStore.id,spaceId:(0,o().e)(r().A.state.blockStore.pointer.spaceId)},timestamp:r().A.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(l().V(),i.value.error)throw i.value.error}},880324:(e,t,i)=>{i.d(t,{L:()=>n});i(242343);var o=i(163643);const n=(0,i(680369).wt)("versionHistoryThick",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{d:"M0 7C0 3.136 3.129 0 6.993 0C10.864 0 14 3.136 14 7C14 10.864 10.864 14 6.993 14C3.129 14 0 10.864 0 7ZM1.4 7C1.4 10.094 3.906 12.6 7 12.6C10.094 12.6 12.6 10.094 12.6 7C12.6 3.906 10.094 1.4 7 1.4C3.906 1.4 1.4 3.906 1.4 7ZM6.3 3.5H7.35V7.175L10.5 9.044L9.975 9.905L6.3 7.7V3.5Z"})})},930961:(e,t,i)=>{i.d(t,{Aj:()=>w,mV:()=>N,s6:()=>B});i(725707),i(107652),i(491955),i(403517);var o=i(242343),n=()=>i(237385),r=()=>i(803290),s=()=>i(174114),a=()=>i(145017),d=()=>i(759260),l=()=>i(66460),c=()=>i(34662),u=()=>i(653998),v=()=>i(76394),h=()=>i(31448),f=()=>i(764872),p=()=>i(319638),g=()=>i(798096),m=()=>i(441165),y=()=>i(654548),b=()=>i(378219),A=()=>i(413871),x=()=>i(209684),S=()=>i(931085),I=()=>i(592896),j=()=>i(644515),k=()=>i(184711),_=()=>i(129885),M=()=>i(154170),C=()=>i(751634),T=i(163643);function R(e){return"comment-created"===e.type}function w(e){return e.length>0&&e.every(R)}function B(e,t,i){if(!i)return[];let o=e.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,v().HB)(e)}}));0===o.length&&0!==e.length&&"updates_sidebar"!==t&&(o=e);const n="suggestion"===(null==i?void 0:i.getType())&&(null==i?void 0:i.getCommentPointers()[0]),r=o[0];return r&&n&&r&&"comment-created"===r.type&&r.comment_id===n.id&&(o=o.slice(0)),o}function L(e){const{activity:t,rootStore:s,isLast:l,tabArgs:c}=e,{source:h,tab:f,notification:p}=c,m=(0,n().v3)(),y=(0,r().K8)((()=>{const e=s.getRecordStore(s,{table:d().$Y,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,s]),x=(0,r().K8)((()=>null==y?void 0:y.getType()),[y]),k=(0,r().K8)((()=>{const e=null==y?void 0:y.getModel();if(e)return(0,_().pN)(e)}),[y]),M=(0,r().K8)((()=>{const e=null==y?void 0:y.getParentPointer();if(e)return A().Bv.createChildStore(s,e)}),[y,s]),R=(0,r().K8)((()=>Boolean(M&&M.isDefined())),[M]),w=(0,r().K8)((()=>{const e=null==M?void 0:M.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,M]),L=A().Bv.createChildStore(s,{table:a().ev,id:w}),D=(0,r().K8)((()=>L.isDefined()),[L]),P=(0,r().K8)((()=>Boolean(M&&(0,b().yR)((0,b().g7)(M)))),[M]),N=(0,r().K8)((()=>{if(!P||!M)return;const e=M.getModel();return e?e.getRenderUrl({getRecordModel:s.getRecordModel,discussionId:t.discussion_id,pageVisitSource:i(712437).y8.Notification}):void 0}),[P,M,s,t]),V=(0,r().K8)((()=>B(t.getEdits(),h,y)),[t,y,h]),F=V.length>0,z=(0,r().K8)((()=>(0,_().Ln)({edits:V,rootStore:s})),[V,s]),H=(0,r().K8)((()=>(0,_().bD)(z)),[z]),E=P,$=(0,o.useCallback)((e=>{if((0,j().uY)({...c,environment:m,activity:t,mightCloseTab:E}),!P&&M&&y){var i;const o=e.target;g().IX({environment:m,discussionStore:y,rect:o.getBoundingClientRect(),blockStore:M,discussionLocation:K({forReplyMenu:!0,source:c.source}),activityId:t.id,notificationId:null===(i=c.notification)||void 0===i?void 0:i.id})}}),[t,P,M,y,m,c,E]),Y=(0,o.useCallback)((e=>{"Removed"===e?(0,j().jv)({...c,environment:m,activity:t,mightCloseTab:E}):"Added"===e?(0,j().P)({...c,environment:m,activity:t,mightCloseTab:E}):(0,v().HB)(e)}),[c,m,t,E]),W=(0,T.jsx)(i(29302).A,{titledRecordStore:L,getRecordModel:s.getRecordModel,activity:t,tabArgs:c}),J=(0,r().K8)((()=>(0,_().DU)({recordId:w,recordType:a().ev,tab:f,rootStore:s,environment:m})),[w,f,s,m]),G=m.device.isMobile,X=(0,r().K8)((()=>K({source:h,forReplyMenu:!1})),[h]),Z=(0,r().K8)((()=>parseInt(t.end_time)),[t]);return F&&D&&R&&y?(0,T.jsxs)(I().Ay,{timestamp:Z,header:"suggestion"===x?(0,T.jsx)("span",{children:(0,T.jsx)(u().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in {blockName}} other {{authorOrAuthors} suggested in {blockName}}}",values:{numberOfAuthors:z.length,authorOrAuthors:H,blockName:W},id:"activity.commentActivity.header.suggestion"})}):(0,T.jsx)("span",{children:(0,T.jsx)(u().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:z.length,authorOrAuthors:H,blockName:W},id:"activity.commentActivity.header"})}),isLast:l,isPrivate:J,rootStore:s,navigableBlockId:w,icon:(0,T.jsx)(I().H8,{authors:z,size:24}),showSnapshotButton:!1,...(0,j().em)({notification:p,environment:m,tab:f,activity:t}),children:[y&&k&&(0,T.jsx)(O,{rootStore:s,discussionStore:y,onClick:$,source:h,url:N}),(0,T.jsx)(i(161742).A,{visible:5,items:V.map(((e,t,o)=>(0,T.jsx)(S().A,{onClick:$,href:N,innerStyle:(0,C().aY)({source:h,isMobile:G}),children:(0,T.jsx)(i(586121).A,{edit:e,rootStore:s,type:"comment-edit",discussionLocation:X,onReactionToggle:Y,hideAuthorName:!1})},t)))}),(0,T.jsx)(U,{activity:t,rootStore:s,tabArgs:c})]}):null}function O(e){const{rootStore:t,discussionStore:i,onClick:o,source:a,url:d}=e,l=(0,r().K8)((()=>i.getType()),[i]),c=(0,n().v3)().device.isMobile,u=(0,s().IS)((e=>({linkbox:{...(0,C().aY)({source:a,isMobile:c}),display:"flex",alignItems:"center",fontSize:14,paddingTop:2,paddingBottom:6,marginBottom:0}})),[c,a]);return(0,T.jsx)(S().A,{href:d,onClick:o,innerStyle:u.linkbox,children:"suggestion"===l?(0,T.jsx)(p().c4,{discussionStore:i,collapsed:!1}):(0,T.jsx)(D,{rootStore:t,discussionStore:i})})}function D(e){const t=(0,n().v3)(),i=(0,s().DP)(),{rootStore:o,discussionStore:a}=e,d=(0,r().K8)((()=>{const e=a.getModel();if(e)return(0,_().pN)(e)}),[a]),l=0===(0,c().j2Y)(d).length,u=(0,s().IS)((e=>({text:{...h().RC,...l&&{color:e.text.secondary}}})),[l]),v=(0,r().K8)((()=>(0,y().S5)({environment:t,textValue:d?{value:d,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:l,disableInsertedDeletedAnnotations:l,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,highlightDiscussionId:a.id,theme:i,emojiType:(0,m().FN)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,d,o,l,a.id,i]);return(0,T.jsxs)(T.Fragment,{children:[l&&(0,T.jsx)(k().A,{}),(0,T.jsx)("div",{style:u.text,children:v})]})}function U(e){const{activity:t,rootStore:i,tabArgs:c}=e,{source:v,notification:h,tab:p}=c,m=(0,r().K8)((()=>{const e=i.getRecordStore(i,{table:d().$Y,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),y=(0,n().v3)(),b=y.device.isMobile,S=(0,r().K8)((()=>A().sk.createChildStore(i,{table:d().$Y,id:t.discussion_id,spaceId:(0,l().e)(i.pointer.spaceId)})),[t,i]),I=(0,r().K8)((()=>null==m?void 0:m.getParentId()),[m]),j=(0,o.useCallback)((e=>{if(!I)return;const o=A().Bv.createChildStore(i,{table:a().ev,id:I}),n=e.target,r=null==h?void 0:h.id;g().IX({environment:y,discussionStore:S,rect:n.getBoundingClientRect(),blockStore:o,discussionLocation:K({forReplyMenu:!0,source:v}),activityId:t.id,notificationId:r}),"notifications_tab"===v&&f().ZP({environment:y,notificationId:r,alreadyRead:Boolean(null==h?void 0:h.read),activity:t,tab:p})}),[t,S,y,h,I,i,v,p]),k=(0,s().IS)((e=>({container:{paddingLeft:(0,C().F9)({source:v,isMobile:b}),paddingTop:12,paddingBottom:4},actionButton:(0,C().Ei)(e)})),[b,v]),_=Boolean(null==h?void 0:h.visited);return m?(0,T.jsxs)("div",{style:k.container,children:[(0,T.jsx)(x().p,{isGray:!0,size:"xs",onClick:j,style:k.actionButton,children:(0,T.jsx)(u().sA,{defaultMessage:"Reply",id:"activityUpdate.replyButton.label"})}),_&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(P,{}),(0,T.jsx)(M().I,{tabArgs:c,environment:y,rootStore:i,activity:t})]})]}):null}function P(){return(0,T.jsx)("div",{style:{width:5,display:"inline-block"}})}function K(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${f().jD()}`}const N=o.memo(L)}}]);