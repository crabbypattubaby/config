"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[40186],{58264:(e,t,o)=>{o.d(t,{Ai:()=>l,EJ:()=>d,M8:()=>u,TX:()=>p,Yj:()=>s,cf:()=>c});o(403517);var r=()=>o(653998),i=()=>o(76394),n=()=>o(654548);const s=12,l=(0,r().YK)({anonymousSubmissionLabel:{id:"FormBlock.anonymousSubmissionLabel",defaultMessage:"Submitting response anonymously"}}),a=(0,r().YK)({inaccessibleTitle:{id:"FormBlock.inaccessible.title",defaultMessage:"This form is not publicly available."},inaccessibleSubtitle:{id:"FormBlock.inaccessible.subtitle",defaultMessage:"Login to submit or contact the form creator to publish."},closedOrDeletedTitle:{id:"FormBlock.closedOrDeleted.title",defaultMessage:"This form is closed or deleted."},closedOrDeletedSubtitle:{id:"FormBlock.closedOrDeleted.subtitle",defaultMessage:"Try contacting the form owner if you think it's a mistake."},submissionErrorTitle:{id:"FormBlock.submissionError.title",defaultMessage:"Something went wrong."},submissionErrorSubtitle:{id:"FormBlock.submissionError.subtitle",defaultMessage:"There was an issue submitting the form. Please try again or contact the form owner."}}),d={closedOrDeleted:a.closedOrDeletedTitle,inaccessible:a.inaccessibleTitle,submissionError:a.submissionErrorTitle},u={closedOrDeleted:a.closedOrDeletedSubtitle,inaccessible:a.inaccessibleSubtitle,submissionError:a.submissionErrorSubtitle};function c(e){let{questionType:t,filePropertyIdToFormFiles:o,draftSubmissionPageStore:r,propertyId:s}=e;switch(t){case"checkbox":return"Yes"===(0,n().r4)(r.getPropertyValue(s),r)?"true":"false";case"file":return((null==o?void 0:o[s])??[]).map((e=>e.fileName)).join(", ");case"text":case"title":case"select":case"multi_select":case"relation":case"date":case"person":case"number":case"email":case"url":case"phone_number":return(0,n().r4)(r.getPropertyValue(s),r);default:(0,i().HB)(t)}}function p(e){return e?500:600}},62522:(e,t,o)=>{o.d(t,{d:()=>i});var r=()=>o(174114);function i(){return(0,r().IS)((e=>({button:{background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200]},buttonHovered:{background:"light"===e.mode?e.accentColors.uiBlue[200]:e.accentColors.uiBlue[300]},buttonPressed:{background:"light"===e.mode?e.accentColors.uiBlue[300]:e.accentColors.uiBlue[400]}})),[])}},70107:(e,t,o)=>{o.d(t,{z:()=>n});var r=()=>o(96297),i=()=>o(838218);function n(e){let{layoutStore:t,moduleId:o,environment:n}=e;setTimeout((()=>{!function(e){let{layoutStore:t,moduleId:o,environment:n}=e;const s=i().A.findModuleContainer({layoutStore:t,moduleId:o}),l=null==s?void 0:s.getNode();l&&(0,r().$v)({element:l,environment:n,additionalPadding:{top:100,bottom:100}})}({layoutStore:t,moduleId:o,environment:n})}),100)}},79634:(e,t,o)=>{o.d(t,{j:()=>m});o(242343);var r=()=>o(803290),i=()=>o(174114),n=()=>o(716605),s=()=>o(755002),l=()=>o(653998),a=()=>o(31448),d=()=>o(213234),u=()=>o(571060),c=()=>o(367082),p=o(163643);function m(e){let{disabled:t,onChange:o,formQuestionStore:m,formMode:g}=e;const y=(0,l().tz)(),f=(0,d().H)(),{parentBlockStore:v,questionNameStore:h,isRequired:x}=(0,r().K8)((()=>({parentBlockStore:m.getParentStore(),questionNameStore:m.getNameStore(),isRequired:m.isRequired()})),[m]),S=(0,r().K8)((()=>{var e,t;const o=f.getFormState();if(!o)return;const r=o.collectionSchema,i=null===(e=m.getConfig())||void 0===e?void 0:e.propertyId;return r&&i?null===(t=(0,n()._g)({schema:r,property:i}))||void 0===t?void 0:t.type:void 0}),[m,f]),M=(0,r().K8)((()=>f.getQuestionError(m.id)),[f,m.id]),b=(0,i().IS)((e=>({questionTitleInput:{padding:"0px 10px",margin:"10px 0px",fontSize:24,lineHeight:"30px",borderRadius:6,fontWeight:a().Wy.bold,cursor:"text",textWrap:"wrap",width:"fit-content"},viewQuestionTitleOverrides:{display:"block",margin:0,padding:"6px 0px",whiteSpace:"pre-wrap",maxWidth:"100%",wordBreak:"break-word"},pseudoAfter:{content:"'*'",color:"required"===M?e.accentColors.red[500]:e.text.tertiary,fontWeight:"normal"}})),[M]),C=(0,u().x)({textStore:h,spaceId:m.pointer.spaceId,parentStore:v,disabled:!1});return"builder"===g?(0,p.jsx)("div",{className:"form-question-title",children:(0,p.jsx)(c().B,{store:h,onChange:o,disabled:t,placeholder:"builder"===g?y.formatMessage({id:"FormQuestionTitle.placeholder",defaultMessage:"Question name"}):void 0,...(0,s().AH)({...b.questionTitleInput,...x?{pseudoAfter:b.pseudoAfter}:{}})})}):"multi_select"===S?(0,p.jsx)("legend",{className:"form-question-title",...(0,s().AH)({...b.questionTitleInput,...b.viewQuestionTitleOverrides,...x?{pseudoAfter:b.pseudoAfter}:{}}),children:C}):"file"===S?(0,p.jsx)("div",{className:"form-question-title",...(0,s().AH)({...b.questionTitleInput,...b.viewQuestionTitleOverrides,...x?{pseudoAfter:b.pseudoAfter}:{}}),id:`form-question-${m.id}`,children:C}):(0,p.jsx)("h2",{id:`form-question-title-${m.id}`,className:"form-question-title",...(0,s().AH)({...b.questionTitleInput,...b.viewQuestionTitleOverrides,...x?{pseudoAfter:b.pseudoAfter}:{}}),children:C})}},201254:(e,t,o)=>{o.d(t,{P:()=>d});o(242343);var r=()=>o(803290),i=()=>o(174114),n=()=>o(34662),s=()=>o(653998),l=()=>o(367082),a=o(163643);function d(e){let{disabled:t,formQuestionStore:o,formMode:d}=e;const u=(0,s().tz)(),c=(0,i().IS)((e=>({questionDescriptionInput:{cursor:"text",fontSize:16,color:e.text.secondary,padding:"builder"===d?"4px 10px":"4px 0px",width:"fit-content"}})),[d]),{questionDescriptionStore:p,questionDescription:m,showDescription:g}=(0,r().K8)((()=>{var e;const t=o.getDescriptionStore().getValue();return{showDescription:Boolean(null===(e=o.getConfig())||void 0===e?void 0:e.showDescription),questionDescriptionStore:o.getDescriptionStore(),questionDescription:t?(0,n().q4_)(t):void 0}}),[o]);return g&&("viewer"!==d||m)?(0,a.jsx)(l().B,{store:p,style:c.questionDescriptionInput,disabled:t,placeholder:u.formatMessage({id:"FormQuestionDescription.placeholder",defaultMessage:"Add description"}),id:`form-description-${o.id}`}):null}},209242:(e,t,o)=>{o.d(t,{Y1:()=>H,zE:()=>F});o(358848),o(91270);var r=o(242343),i=()=>o(237385),n=()=>o(803290),s=()=>o(174114),l=()=>o(748267),a=()=>o(34662),d=()=>o(653998),u=()=>o(401548),c=()=>o(975392),p=()=>o(31448),m=()=>o(201562),g=()=>o(367082),y=()=>o(659030),f=()=>o(58264),v=()=>o(209684),h=()=>o(381959),x=()=>o(169280),S=()=>o(56255),M=()=>o(518471),b=()=>o(96297),C=()=>o(548694),_=()=>o(593745),w=()=>o(485966),I=()=>o(797470),j=()=>o(111826),A=()=>o(305043),k=()=>o(394094),T=o(163643);function B(e){let{onAfterAddIconClick:t,disabled:o,formBlockStore:r}=e;if((0,n().K8)((()=>Boolean(r.getIcon()&&r.getCover())),[r]))return null;const i=o?(0,T.jsx)(T.Fragment,{}):(0,T.jsx)(P,{onAfterAddIconClick:t});return(0,T.jsx)(h().A,{store:r,context:I().Rr.Form,children:i})}function P(e){let{onAfterAddIconClick:t}=e;const{formBlockStore:o,headerFocusStore:r,headerMouseStore:s}=(0,m().cJ)(),l=(0,i().Y0)(),a=(0,n().K8)((()=>{const e=s.state.mouseEntered||r.state;return(0,M().g1)(e)}),[r,s]),{hasIcon:u,hasCover:c}=(0,n().K8)((()=>({hasIcon:Boolean(o.getIcon()),hasCover:Boolean(o.getCover())})),[o]);return(0,T.jsxs)(T.Fragment,{children:[!u&&(0,T.jsx)(S().A,{store:o,afterOnClick:t,style:a,label:l.isSmallPhone?(0,T.jsx)(d().sA,{id:"FormHeaderControls.iconMobile",defaultMessage:"Icon"}):(0,T.jsx)(d().sA,{id:"FormHeaderControls.icon",defaultMessage:"Form icon"})}),!c&&(0,T.jsx)(x().A,{store:o,style:a,label:l.isSmallPhone?(0,T.jsx)(d().sA,{id:"FormHeaderControls.pageCoverMobile",defaultMessage:"Cover"}):(0,T.jsx)(d().sA,{id:"FormHeaderControls.pageCover",defaultMessage:"Form cover"})})]})}function F(e){let{formBlockStore:t,formMode:o,disabled:s,headerFocusStore:l,onHeaderMouseEnter:u,onHeaderMouseLeave:p,aliasStore:m,formBlockWidth:y}=e;const v=(0,d().tz)(),h=(0,i().Y0)(),[x,S]=(0,r.useState)(!1),M=(0,n().K8)((()=>null==t?void 0:t.getTitleStore()),[t]),{hasCoverImage:b,hasPageIcon:C,formDescriptionStore:_}=(0,n().K8)((()=>({hasCoverImage:Boolean(null==t?void 0:t.getCover()),hasPageIcon:Boolean(null==t?void 0:t.getIcon()),formDescriptionStore:t.getFormDescriptionStore()})),[t]),w=(0,n().K8)((()=>(0,a().w9s)(_.getValue())),[_]);if(!t||!M)return null;const j="viewer"===o&&h.isMobile&&C?12:0;let A=0;return"builder"===o?C&&b&&(A=12):m?(A=C||b?24:12,m&&"narrow"===y&&!h.isMobile&&(A-=f().Yj)):A=C||b?24:48,(0,T.jsxs)("div",{style:{marginTop:j,marginLeft:"builder"===o?3:0},children:[(0,T.jsx)(k().H,{store:t,context:I().Rr.Form,isEditable:!s,headerControls:(0,T.jsx)(B,{onAfterAddIconClick:()=>S(!0),disabled:s,formBlockStore:t}),hasCover:b,isInSidePeek:!1,hideTitleIfEmpty:"viewer"===o,headerFocusStore:l,openMenuOnMount:x,openMenuOnMountCallback:()=>S(!1),disabled:s,titlePlaceholder:v.formatMessage({id:"formTitle.titlePlaceholder",defaultMessage:"Form title"}),collectionContextStore:void 0,shouldShowTemplatePicker:!1,onTitleChange:c().lQ,onTitleEditText:c().lQ,onTitleEsc:c().lQ,onTitleUntab:c().lQ,onTitleTab:c().lQ,onMoveUp:c().lQ,onMoveDown:c().lQ,handleHeaderMouseEnter:u,handleHeaderMouseLeave:p,disableEnter:!0,extraStyles:{fontSize:40,fontWeight:"bold",cursor:"text",marginTop:A},layoutModule:L}),("builder"===o||!w)&&(0,T.jsx)("div",{style:{marginTop:16,marginLeft:3},children:(0,T.jsx)(g().B,{store:_,disabled:s,placeholder:v.formatMessage({id:"FormTitle.description.placeholder",defaultMessage:"Description (optional)"}),style:{cursor:"text"}})})]})}const L={id:"titleWithIcon",type:"normalizedTitleWithIcon",propertyIds:[]};function H(e){let{collectionContextStore:t,formBlockStore:o}=e;const r=(0,i().v3)(),{currentSpaceStore:a}=(0,n().O$)(w().default),c=(0,n().K8)((()=>a?(0,C().GK)(r,a):""),[r,a]),{isFormPublic:m,isFormClosed:g}=(0,n().K8)((()=>({isFormPublic:o.getIsFormPublic(),isFormClosed:o.getIsFormClosed()})),[o]),f=(0,n().K8)((()=>{const e=A().subscriptionDataStoreInstance.state;return Boolean(e&&a&&j().V$(r,e,a.id))}),[r,a]),h=(0,n().K8)((()=>f?"closed":(0,y().C0)(m,g)),[m,g,f]),x=(0,n().K8)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.canEditMembership()}),[t]),S=(0,s().IS)((e=>{const t=()=>{switch(h){case"shared_to_web":return{light:{color:e.text.uiYellowPrimary,background:e.tint.uiYellowHover},dark:{color:e.text.uiYellowPrimary,background:e.tint.uiYellowHover}};case"shared_to_space":return{light:{color:e.text.secondary,background:e.fill.lightGrayTertiary},dark:{color:e.text.secondary,background:e.fill.lightGrayTertiary}};case"closed":return{light:{color:e.accentColors.red[500],background:e.accentColors.red[50]},dark:{color:e.accentColors.red[600],background:e.accentColors.red[200]}}}};return{container:{color:t()[e.mode].color,background:t()[e.mode].background,borderRadius:6,width:"100%",padding:"10px 22px",marginTop:24,fontSize:14,display:"flex",alignItems:"center"},lockIconContainer:{display:"flex",alignItems:"center"},changePermissionButton:{marginRight:-4,color:t()[e.mode].color,fontWeight:p().Wy.medium},changePermissionButtonHovered:{backgroundColor:(0,u().X4)(t()[e.mode].color,.1)},changePermissionButtonPressed:{backgroundColor:(0,u().X4)(t()[e.mode].color,.2)}}}),[h]),M=(0,y().ls)({formSharingState:h,spaceName:c,isOverBlockLimit:f});return(0,T.jsxs)("div",{style:S.container,children:[(0,T.jsx)("div",{style:{width:f?"100%":"90%",marginRight:10},children:(0,T.jsxs)("div",{style:S.lockIconContainer,children:[!g&&!m&&!f&&(0,l().g)({width:14,height:14,marginRight:6,marginLeft:-2}),M]})}),!f&&x&&(0,T.jsx)(v().p,{style:S.changePermissionButton,hoveredStyle:S.changePermissionButtonHovered,pressedStyle:S.changePermissionButtonPressed,onClick:()=>{var e,o;const r=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id,i=(null===(o=_().K.getMembersByDOMOrder({filter:e=>e.getBlockStore().id===r}).at(0))||void 0===o?void 0:o.getNode())??null;if(i instanceof Element){const e=t.isFullScreenStore.state?i:i.parentElement;(0,b().vq)(e,{edgeDist:0,animate:!1})}t.formShareMenuButtonPopupStore.setState({...t.formShareMenuButtonPopupStore.state,open:!0})},children:(0,T.jsx)(d().sA,{id:"editorFormResponderWarning.changePermission",defaultMessage:"Change"})})]})}},213234:(e,t,o)=>{o.d(t,{H:()=>s,o:()=>n});var r=o(242343),i=()=>o(911421);const n=(0,r.createContext)(null);function s(){const e=(0,r.useContext)(n);return e||new(i().A)}n.displayName="FormBlockContext"},284002:(e,t,o)=>{o.d(t,{A:()=>a});o(242343);var r=()=>o(803290),i=()=>o(174114),n=()=>o(543396),s=()=>o(653998),l=o(163643);function a(e){let{propertySchema:t,formQuestionStore:o,formMode:a}=e;const d=(0,i().IS)((e=>({select:{color:e.text.tertiary,marginTop:4,marginBottom:12,..."viewer"===a?{marginLeft:0,marginRight:0}:{marginLeft:10,marginRight:10}}})),[a]),u=(0,r().K8)((()=>(0,n().hm)(t,o.getModel())),[o,t]),c=(0,r().K8)((()=>"builder"===a?void 0===u?(0,l.jsx)(s().sA,{id:"QuestionMaxSelection.builder.unlimited",defaultMessage:"(Respondents can select as many as they like)"}):(0,l.jsx)(s().sA,{id:"QuestionMaxSelection.builder.limited",defaultMessage:"(Respondents can select up to {count})",values:{count:u}}):void 0===u?(0,l.jsx)(s().sA,{id:"QuestionMaxSelection.viewer.unlimited",defaultMessage:"(Select as many as you like)"}):(0,l.jsx)(s().sA,{id:"QuestionMaxSelection.viewer.limited",defaultMessage:"(Select up to {count})",values:{count:u}})),[a,u]);return(0,l.jsx)("div",{style:d.select,children:c})}},330678:(e,t,o)=>{o.d(t,{z:()=>n});var r=()=>o(803290),i=()=>o(546820);function n(){const{layoutStore:e}=(0,i().LH)();return"form"===(0,r().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e])?24:12}},367082:(e,t,o)=>{o.d(t,{B:()=>l});o(242343);var r=()=>o(975392),i=()=>o(636045),n=()=>o(868199),s=o(163643);function l(e){let{store:t,disabled:o,style:l,placeholder:a,className:d,onChange:u,id:c}=e;return(0,s.jsx)(i().A,{store:t,style:l,className:d,disableSlashCommands:!0,onEnter:r().lQ,onEsc:r().lQ,onTab:r().lQ,onUntab:r().lQ,onMoveDown:r().lQ,onMoveUp:r().lQ,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{page:!1,user:!1,date:!1,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0},disabled:o,pasteBehavior:"inline",placeholder:a,inPageFind:n().Os.none,disableComment:!0,onBlur:r().lQ,onChange:u,id:c})}},400279:(e,t,o)=>{o.d(t,{W:()=>u});var r=o(242343),i=()=>o(371807),n=()=>o(237385),s=()=>o(269280),l=()=>o(803290),a=()=>o(680645),d=()=>o(213234);function u(e){const t=(0,n().v3)(),{inMemoryRecordCacheName:o,collectionSchema:u,collectionId:c,spaceId:p,formMode:m}=e,g=(0,d().H)(),y=(0,r.useMemo)((()=>new(i().A)({name:o,isTemporaryData:!0})),[o]),f=(0,l().K8)((()=>{var e;const o=null===(e=g.getFormState())||void 0===e?void 0:e.draftFormBlockStore;return o||a().createDummyFormPage({environment:t,spaceId:p,collectionSchema:u,temporaryRecordCache:y,collectionId:c,formMode:m})}),[c,u,t,g,m,p,y]);return(0,s().l)((()=>{y.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),g.updateFormState({draftFormBlockStore:f})})),f}},454356:(e,t,o)=>{o.d(t,{f:()=>i,l:()=>n});var r=()=>o(484777);async function i(e){return r().A.state.open?Promise.resolve(void 0):new Promise((t=>{!function(e){r().A.setState({...e,open:!0})}({...e,onConfirm:e=>(n(),t(e)),onDismiss:()=>(n(),t(void 0))})}))}function n(){r().A.reset()}},484777:(e,t,o)=>{o.d(t,{A:()=>i});class r extends(()=>o(129044))().default{getInitialState(){return{open:!1}}}const i=new r},503732:(e,t,o)=>{o.d(t,{h:()=>i});o(242343);var r=o(163643);const i=(0,o(680369).wt)("trashSmall",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M5.31055 14.3398C4.85742 14.3398 4.49414 14.2129 4.2207 13.959C3.95117 13.7051 3.80664 13.3516 3.78711 12.8984L3.38867 4.45508H2.74414C2.59961 4.45508 2.47656 4.4043 2.375 4.30273C2.27344 4.20117 2.22266 4.07812 2.22266 3.93359C2.22266 3.79297 2.27344 3.67383 2.375 3.57617C2.47656 3.47461 2.59961 3.42383 2.74414 3.42383H13.2617C13.4062 3.42383 13.5273 3.47266 13.625 3.57031C13.7266 3.66797 13.7773 3.78906 13.7773 3.93359C13.7773 4.07812 13.7266 4.20117 13.625 4.30273C13.5273 4.4043 13.4062 4.45508 13.2617 4.45508H12.6172L12.2188 12.8926C12.1992 13.3457 12.0527 13.6992 11.7793 13.9531C11.5059 14.2109 11.1445 14.3398 10.6953 14.3398H5.31055ZM5.42773 13.3027H10.5723C10.7363 13.3027 10.8711 13.248 10.9766 13.1387C11.082 13.0332 11.1387 12.8926 11.1465 12.7168L11.5273 4.45508H4.45508L4.85352 12.7168C4.86133 12.8887 4.91797 13.0293 5.02344 13.1387C5.12891 13.248 5.26367 13.3027 5.42773 13.3027ZM6.27734 12.3535C6.15625 12.3535 6.05859 12.3203 5.98438 12.2539C5.91016 12.1836 5.87109 12.0898 5.86719 11.9727L5.69141 5.83203C5.6875 5.71875 5.72266 5.62695 5.79688 5.55664C5.87109 5.48242 5.96875 5.44531 6.08984 5.44531C6.21094 5.44531 6.30859 5.48047 6.38281 5.55078C6.45703 5.62109 6.49414 5.71289 6.49414 5.82617L6.67578 11.9668C6.67578 12.084 6.63867 12.1777 6.56445 12.248C6.49414 12.3184 6.39844 12.3535 6.27734 12.3535ZM8 12.3535C7.87891 12.3535 7.7793 12.3184 7.70117 12.248C7.62695 12.1777 7.58984 12.0859 7.58984 11.9727V5.83203C7.58984 5.71875 7.62695 5.62695 7.70117 5.55664C7.7793 5.48242 7.87891 5.44531 8 5.44531C8.125 5.44531 8.22461 5.48242 8.29883 5.55664C8.37695 5.62695 8.41602 5.71875 8.41602 5.83203V11.9727C8.41602 12.0859 8.37695 12.1777 8.29883 12.248C8.22461 12.3184 8.125 12.3535 8 12.3535ZM9.72852 12.3535C9.60352 12.3535 9.50391 12.3184 9.42969 12.248C9.35938 12.1777 9.32617 12.084 9.33008 11.9668L9.50586 5.83203C9.50977 5.71484 9.54883 5.62109 9.62305 5.55078C9.69727 5.48047 9.79297 5.44531 9.91016 5.44531C10.0352 5.44531 10.1328 5.48242 10.2031 5.55664C10.2773 5.62695 10.3125 5.71875 10.3086 5.83203L10.1328 11.9727C10.1289 12.0898 10.0898 12.1836 10.0156 12.2539C9.94141 12.3203 9.8457 12.3535 9.72852 12.3535ZM5.33984 3.81055V2.54492C5.33984 2.0957 5.47461 1.74609 5.74414 1.49609C6.01758 1.24219 6.39648 1.11523 6.88086 1.11523H9.10742C9.5918 1.11523 9.9707 1.24219 10.2441 1.49609C10.5176 1.74609 10.6543 2.0957 10.6543 2.54492V3.81055H9.57031V2.59766C9.57031 2.44922 9.52148 2.33008 9.42383 2.24023C9.32617 2.14648 9.19531 2.09961 9.03125 2.09961H6.95703C6.79688 2.09961 6.66797 2.14648 6.57031 2.24023C6.47266 2.33008 6.42383 2.44922 6.42383 2.59766V3.81055H5.33984Z"})})},590585:(e,t,o)=>{o.d(t,{n:()=>so,B:()=>co});o(610931),o(725707),o(491955),o(403517);var r=()=>o(561074),i=o(242343),n=()=>o(237385),s=()=>o(803290),l=()=>o(174114),a=()=>o(716605),d=()=>o(33715),u=()=>o(220865),c=()=>o(984826),p=()=>o(339274),m=()=>o(653998),g=()=>o(220413),y=()=>o(975392),f=()=>o(76394),v=()=>o(31448),h=()=>o(201562),x=()=>o(695951),S=()=>o(610271),M=()=>o(749975),b=()=>o(400885),C=()=>o(797470),_=()=>o(230849),w=()=>o(290557),I=()=>o(64713),j=()=>o(138045),A=()=>o(413871),k=()=>o(603769),T=()=>o(546820),B=o(163643);function P(e){const{wrapper:t,viewsModule:o}=e,{pageStore:r,moduleStateByIdStore:n}=(0,T().bi)(),[l,a]=(0,i.useState)(void 0),{setModuleSelection:d}=(0,T().LH)(),u=(0,i.useMemo)((()=>new(k().E)),[]),c=(0,i.useCallback)((e=>{e&&u.observe(e)}),[u]),p=(0,s().K8)((()=>u.rect.state.width),[u]);(0,i.useEffect)((()=>{l&&n.set(o.id,{collectionContextStore:l})}),[l,n,o.id]);const{collectionViewBlockStore:m,viewsModuleContext:g,isViewsMainModule:y}=(0,s().K8)((()=>{if(!o)return{collectionViewBlockStore:void 0,viewsModuleContext:void 0,isViewsMainModule:!1};const e=A().Bv.createChildStore(r,o.collection_view_block_pointer);return{collectionViewBlockStore:e,viewsModuleContext:{location:"layoutBuilder",viewsModule:o,currentPageStore:r,collectionViewBlockStore:e,selectViewsModule:()=>{d&&d({type:"existing_module",moduleId:o.id,isDragging:!1})}},isViewsMainModule:"viewsMain"===o.type}}),[r,o,d]);return m&&g?t((0,B.jsx)("div",{ref:c,children:(0,B.jsx)(j().l,{children:(0,B.jsx)(I().dN,{store:m,isFullScreen:!1,productUseCase:"page_layout_editor",disabled:!1,disableHoverMenu:!0,headerActionsBehavior:"always_show",headerAllowedActions:F,fullWidth:p,overridePaddingLeft:0,overridePaddingRight:0,setCollectionContextStore:a,showOnlyCurrentView:!y,isUnlistedView:!1,viewsModuleContext:g})})})):null}const F=["filter","sort"];var L=()=>o(906513),H=()=>o(381988),O=()=>o(158247),D=()=>o(916809),R=()=>o(946854),E=()=>o(502852),Q=()=>o(724903),K=()=>o(622163),G=()=>o(951920),V=()=>o(838218),q=()=>o(800057),W=()=>o(926537),$=()=>o(330678),N=(o(362833),()=>o(780866)),z=()=>o(175532),U=()=>o(680369);const Y=(0,U().wt)("arrowLeftRounded",{viewBox:"0 0 16 13",svg:(0,B.jsx)("path",{d:"M0.617188 6.85156C0.617188 6.60677 0.710938 6.39323 0.898438 6.21094L6.03906 1.07812C6.13281 0.984375 6.23177 0.914062 6.33594 0.867188C6.4401 0.820312 6.54948 0.796875 6.66406 0.796875C6.90365 0.796875 7.10417 0.875 7.26562 1.03125C7.42708 1.1875 7.50781 1.38281 7.50781 1.61719C7.50781 1.74219 7.48438 1.85677 7.4375 1.96094C7.39062 2.0599 7.32812 2.14844 7.25 2.22656L5.5 4L2.59375 6.66406L2.3125 6.15625L5.02344 5.99219H14.5156C14.776 5.99219 14.9844 6.07292 15.1406 6.23438C15.3021 6.39062 15.3828 6.59635 15.3828 6.85156C15.3828 7.10156 15.3021 7.30729 15.1406 7.46875C14.9844 7.625 14.776 7.70312 14.5156 7.70312H5.02344L2.3125 7.54688L2.59375 7.04688L5.5 9.70312L7.25 11.4688C7.32812 11.5469 7.39062 11.638 7.4375 11.7422C7.48438 11.8464 7.50781 11.9583 7.50781 12.0781C7.50781 12.3125 7.42708 12.5078 7.26562 12.6641C7.10417 12.8203 6.90365 12.8984 6.66406 12.8984C6.4349 12.8984 6.22917 12.8099 6.04688 12.6328L0.898438 7.49219C0.710938 7.3099 0.617188 7.09635 0.617188 6.85156Z"})});var Z=()=>o(23735),J=()=>o(259849),X=()=>o(711361),ee=()=>o(52531),te=()=>o(186839),oe=()=>o(846287);var re=()=>o(611758),ie=()=>o(444701),ne=()=>o(201147),se=()=>o(154956),le=()=>o(84543),ae=()=>o(432945),de=()=>o(935889),ue=()=>o(535906),ce=()=>o(273520),pe=()=>o(356813),me=()=>o(935091),ge=()=>o(858023),ye=()=>o(88271),fe=()=>o(103151),ve=()=>o(640979),he=()=>o(907721),xe=()=>o(466321),Se=()=>o(863076),Me=()=>o(113805),be=()=>o(933871),Ce=()=>o(503732),_e=()=>o(454356);async function we(e){switch(e){case"property_number":case"property_title":case"property_person":case"property_file":case"property_text":case"property_checkbox":case"property_url":case"property_email":case"property_phone_number":case"property_created_by":case"property_last_edited_by":case"property_button":case"property_select":case"property_multi_select":case"property_status":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_relation":case"property_rollup":case"property_formula":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_geo_point":return await async function(){return await _e().f({icon:Ce().h,confirmTextStyle:"red",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove property from layout?",id:"deletePropertyActions.title"}),confirmText:(0,B.jsx)(m().sA,{defaultMessage:"Remove",id:"deletePropertyActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,B.jsx)(m().sA,{defaultMessage:"Remove and delete",id:"deletePropertyActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove from layout",id:"deletePropertyActions.titleForDeleteModuleOption"}),subtitle:(0,B.jsx)(m().sA,{defaultMessage:"The property will still be visible in database views and in the pageâ€™s property group",id:"deletePropertyActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove from layout and database",id:"deletePropertyActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,B.jsx)(m().sA,{defaultMessage:"The property will be removed from both the page layout and the database",id:"deletePropertyActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"relationsGroup":return await async function(){return await _e().f({icon:Ce().h,confirmTextStyle:"red",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove relations group from layout?",id:"deleteRelationsGroupModuleActions.title"}),confirmText:(0,B.jsx)(m().sA,{defaultMessage:"Remove",id:"deleteRelationsGroupModuleActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,B.jsx)(m().sA,{defaultMessage:"Remove and delete",id:"deleteRelationsGroupModuleActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove from layout",id:"deleteRelationsGroupModuleActions.titleForDeleteModuleOption"}),subtitle:(0,B.jsx)(m().sA,{defaultMessage:"The relations properties will still be visible in database views and in the page's property group",id:"deleteRelationsGroupModuleActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,B.jsx)(m().sA,{defaultMessage:"Remove from layout and database",id:"deleteRelationsGroupModuleActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,B.jsx)(m().sA,{defaultMessage:"The relations properties will be removed from both the page layout and the database",id:"deleteRelationsGroupModuleActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"formSubmit":case"formQuestion":case"formTitle":case"placeholder":case"views":case"transcript":return"delete_module";default:(0,f().HB)(e)}}var Ie=()=>o(760813),je=()=>o(272690),Ae=()=>o(70107),ke=()=>o(62522),Te=()=>o(921080),Be=()=>o(403768),Pe=()=>o(350208);function Fe(e){let{icon:t}=e;const o=(0,l().IS)((()=>({iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:16,height:16,overflow:"visible"}})),[]);return(0,B.jsx)("div",{style:o.iconWrapper,children:t})}const Le=i.memo(Fe);function He(e){let{parent:t,onSelect:o,...r}=e;const i=(0,n().v3)(),{layoutStore:a}=(0,T().LH)(),d=(0,s().K8)((()=>a.getModules()),[a]),u=(0,s().K8)((()=>Boolean((0,oe().JO)(d,(e=>"relationsGroup"===e.type)))),[d]),c=(0,l().IS)((e=>({icon:{width:16,height:16}})),[]),p=(0,B.jsx)(m().sA,{id:"AdvancedModuleMenuItem.originButtonTitle",defaultMessage:"Advanced"}),g=(0,B.jsx)(Le,{icon:(0,Te().B)(c.icon)}),y=u?(0,B.jsx)(m().sA,{id:"AdvancedModuleMenuItem.buttons.moveToRelationsGroupModule",defaultMessage:"Add to relations group"}):(0,B.jsx)(m().sA,{id:"AdvancedModuleMenuItem.buttons.convertToRelationsGroupModule",defaultMessage:"Convert to relations group"}),f={key:"moveOrConvertToRelationsGroup",render:(e,t)=>(0,B.jsx)(ue().A,{...e,icon:(0,B.jsx)(Le,{icon:(0,Be().H)({width:14})}),title:y,caption:(0,B.jsx)(m().sA,{id:"AdvancedModuleMenuItem.moveOrConvertToRelationsGroup.caption",defaultMessage:"Supports minimal or responsive page sections"})}),action:()=>o()};return(0,B.jsx)(Pe().A,{...r,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,B.jsx)(ue().A,{...e,ref:t,title:p,icon:g}),renderExtension:e=>{let o;return o=i.device.isMobile?{menuType:ve().gu.ActionSheet}:{menuType:ve().gu.Popup},(0,B.jsx)(me().A,{...o,...e,children:(0,B.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,B.jsx)(ye().A,{...e}),items:[f]}],onAccept:t.onAccept})})}})}const Oe=(0,U().wt)("propertyGroup",{viewBox:"0 0 20 20",svg:(0,B.jsx)("path",{d:"M5.49512 7.7334C5.35384 7.7334 5.23079 7.68099 5.12598 7.57617C5.02116 7.47135 4.96875 7.34603 4.96875 7.2002C4.96875 7.05436 5.01888 6.92904 5.11914 6.82422C5.22396 6.7194 5.34928 6.66699 5.49512 6.66699H6.27441C6.42025 6.66699 6.54557 6.7194 6.65039 6.82422C6.75977 6.92904 6.81445 7.05436 6.81445 7.2002C6.81445 7.35059 6.75977 7.47819 6.65039 7.58301C6.54557 7.68327 6.42025 7.7334 6.27441 7.7334H5.49512ZM5.49512 9.97559C5.34928 9.97559 5.22396 9.92546 5.11914 9.8252C5.01888 9.72038 4.96875 9.59505 4.96875 9.44922C4.96875 9.29883 5.01888 9.1735 5.11914 9.07324C5.22396 8.96842 5.34928 8.91602 5.49512 8.91602H6.27441C6.4248 8.91602 6.55241 8.96842 6.65723 9.07324C6.76204 9.1735 6.81445 9.29883 6.81445 9.44922C6.81445 9.59505 6.75977 9.72038 6.65039 9.8252C6.54557 9.92546 6.42025 9.97559 6.27441 9.97559H5.49512ZM8.16113 7.65137C8.03353 7.65137 7.92643 7.60807 7.83984 7.52148C7.75781 7.4349 7.7168 7.3278 7.7168 7.2002C7.7168 7.07715 7.76009 6.97461 7.84668 6.89258C7.93327 6.80599 8.03809 6.7627 8.16113 6.7627H14.5732C14.6963 6.7627 14.7988 6.80599 14.8809 6.89258C14.9674 6.97461 15.0107 7.07715 15.0107 7.2002C15.0107 7.3278 14.9674 7.4349 14.8809 7.52148C14.7988 7.60807 14.6963 7.65137 14.5732 7.65137H8.16113ZM8.16113 9.89355C8.03353 9.89355 7.92643 9.85026 7.83984 9.76367C7.75781 9.67708 7.7168 9.57227 7.7168 9.44922C7.7168 9.32161 7.76009 9.21452 7.84668 9.12793C7.93327 9.04134 8.03809 8.99805 8.16113 8.99805H14.5732C14.6963 8.99805 14.7988 9.04362 14.8809 9.13477C14.9674 9.22135 15.0107 9.32617 15.0107 9.44922C15.0107 9.57682 14.9674 9.68392 14.8809 9.77051C14.7988 9.85254 14.6963 9.89355 14.5732 9.89355H8.16113ZM4.1416 16.4492C3.40332 16.4492 2.84505 16.2624 2.4668 15.8887C2.08854 15.515 1.89941 14.9635 1.89941 14.2344V5.9082C1.89941 5.17904 2.08854 4.6276 2.4668 4.25391C2.84505 3.87565 3.40332 3.68652 4.1416 3.68652H15.8447C16.5876 3.68652 17.1481 3.87565 17.5264 4.25391C17.9046 4.6276 18.0938 5.17904 18.0938 5.9082V14.2344C18.0938 14.9635 17.9046 15.515 17.5264 15.8887C17.1481 16.2624 16.5876 16.4492 15.8447 16.4492H4.1416ZM4.22363 15.1094H15.7695C16.084 15.1094 16.3255 15.0273 16.4941 14.8633C16.6628 14.6947 16.7471 14.4463 16.7471 14.1182V6.02441C16.7471 5.69629 16.6628 5.4502 16.4941 5.28613C16.3255 5.11751 16.084 5.0332 15.7695 5.0332H4.22363C3.90462 5.0332 3.66081 5.11751 3.49219 5.28613C3.32812 5.4502 3.24609 5.69629 3.24609 6.02441V14.1182C3.24609 14.4463 3.32812 14.6947 3.49219 14.8633C3.66081 15.0273 3.90462 15.1094 4.22363 15.1094Z"})});function De(e){let{propertyGroups:t,propertyIds:r,parent:a,onSelectSectionMove:d,...u}=e;const c=(0,n().v3)(),p=(0,M().ET)(),g=(0,i.useCallback)((e=>{const i=p.collectionStore();let n=t;for(const t of r)n=(0,o(262578).lT)({propertyGroups:n,propertyId:t,destinationGroupId:e.id});i&&le().createAndCommit({environment:c,perform(e){(0,o(801600).Yf)({collectionStore:i,newGroups:n,transaction:e})},canUndo:!0,userAction:"MoveToPropertyGroupMenuItem.handlePropertyGroupClick"}),d()}),[p,c,d,t,r]),y=(0,l().IS)((e=>({icon:{width:20,height:20},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[]),f=(0,s().K8)((()=>t.map((e=>({key:e.id,render:(t,o)=>(0,B.jsx)(ue().A,{...t,title:e.title}),action:()=>g(e)})))),[g,t]),v=(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.moveToPropertiesGroupButton",defaultMessage:"Add to property group"}),h=(0,B.jsx)(Le,{icon:Oe(y.icon)});return t.length<=1?(0,B.jsx)(ue().A,{...u,icon:h,title:v}):(0,B.jsx)(Pe().A,{...u,onFocus:a.onFocus,renderOrigin:(e,t)=>(0,B.jsx)(ue().A,{...e,ref:t,title:v,icon:h}),renderExtension:e=>{let t;return t=c.device.isMobile?{menuType:ve().gu.ActionSheet}:{menuType:ve().gu.Popup,width:200},(0,B.jsx)(me().A,{...t,...e,children:(0,B.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,B.jsx)(ye().A,{...e,style:y.sectionMenuItem,title:(0,B.jsx)(m().sA,{id:"moveToPropertyGroupMenuItem.sections",defaultMessage:"Sections"})}),items:f}],onAccept:a.onAccept})})}})}const Re=i.memo(De),Ee=i.memo((function(e){const{layoutType:t,module:o,isModuleHoveredOrSelected:r}=e;switch(t){case"form":if("formQuestion"===o.type)return(0,B.jsx)(Qe,{moduleId:o.id,isModuleHoveredOrSelected:r});break;case"page_in_collection":case void 0:return(0,B.jsx)(Ke,{module:o});default:(0,f().HB)(t)}return null}));function Qe(e){let{moduleId:t,isModuleHoveredOrSelected:o}=e;const{canEditLayout:r}=(0,T().LH)(),i=(0,l().IS)((()=>({actionButton:{position:"absolute",top:10,right:10,zIndex:1e3}})),[]);return r?(0,B.jsx)("div",{style:i.actionButton,children:(0,B.jsx)(Ge,{moduleId:t,isModuleHoveredOrSelected:o})}):null}function Ke(e){let{module:t}=e;const{canEditLayout:o}=(0,T().LH)(),r=function(e){const{layoutModule:t}=e,{sessionId:o,layoutStore:r,setModuleSelection:l}=(0,T().LH)(),a=(0,n().v3)(),u=(0,M().ET)(),c=(0,s().K8)((()=>u.collectionStore()),[u]),{collectionSchema:p,collectionFormat:g,propertyGroups:y}=(0,s().K8)((()=>({collectionSchema:null==c?void 0:c.getSchema(),collectionFormat:null==c?void 0:c.getFormat(),propertyGroups:(null==c?void 0:c.getNormalizedPropertyGroups())??[]})),[c]),v=(0,i.useMemo)((()=>g&&p?(0,N().T)({format:g,schema:p,visibilityLevels:["inline","minimal"]}).map((e=>e.section)):[]),[g,p]),{layoutType:h,isTabbedLayout:x,viewsMainTabModuleKey:S,currentModulePosition:b,modulesSplitByMoveable:C}=(0,s().K8)((()=>{var e,o;const i=r.getModules(),n=(0,oe().JO)(i,(e=>e.id===t.id)),s=null==n?void 0:n.area;if("form_conditional_modules"===s)throw new Error("[Forms Conditional Logic Not Implemented] usePageLayoutModuleActionMenuListItems not implemented for form_conditional_modules");const l=s&&("views_main_tab_modules"===s?null==i||null===(e=i[s])||void 0===e?void 0:e[n.viewId]:null==i?void 0:i[s]),a=s&&l&&(0,ie().jS)(s,l),d=null===(o=function(e){if(e.views_main_tab_modules)return(0,f().uv)(e.views_main_tab_modules)}(i))||void 0===o?void 0:o[0];return{layoutType:r.getLayoutType(),isTabbedLayout:r.isTabbedPageLayout(),viewsMainTabModuleKey:d,currentModulePosition:n,modulesSplitByMoveable:a}}),[t.id,r]),_=(0,i.useCallback)((e=>{let{destinationModuleId:t}=e;h&&((0,te().Hc)(h)?l(void 0):l({type:"existing_module",moduleId:t,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0}),(0,te().U2)(h)&&(0,Ae().z)({layoutStore:r,moduleId:t,environment:a}))}),[r,h,l,a]),w=(0,i.useMemo)((()=>{const e=[],i=(0,re().p)(t,"page_details");if(C&&C.moveableModules.length>1&&null!=b&&b.area){const i=C.moveableModules.findIndex((e=>e.id===t.id)),n=-1!==i,s=0===i,l=i===C.moveableModules.length-1;n&&!s&&e.push({key:"move-up",render:e=>(0,B.jsx)(ue().A,{...e,title:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.moveUpButton",defaultMessage:"Move up"}),icon:(0,B.jsx)(Le,{icon:(0,J().q)({width:14})})}),action:()=>{const e=C.nonMoveableHeaderModules.length+i;(0,Me().E)({environment:a,layoutStore:r,position:{type:"absolute",index:e-1,..."views_main_tab_modules"===(null==b?void 0:b.area)?{area:"views_main_tab_modules",viewId:b.viewId}:{area:b.area}},moduleId:t.id,sessionId:o}),_({destinationModuleId:t.id})}}),n&&!l&&e.push({key:"move-down",render:e=>(0,B.jsx)(ue().A,{...e,title:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.moveDownButton",defaultMessage:"Move down"}),icon:(0,B.jsx)(Le,{icon:(0,z().P)({width:14})})}),action:()=>{const e=C.nonMoveableHeaderModules.length+i;(0,Me().E)({environment:a,layoutStore:r,position:{type:"absolute",index:e+1,..."views_main_tab_modules"===(null==b?void 0:b.area)?{area:"views_main_tab_modules",viewId:b.viewId}:{area:b.area}},moduleId:t.id,sessionId:o}),_({destinationModuleId:t.id})}})}if("page_main"!==(null==b?void 0:b.area)&&"views_main_tab_modules"!==(null==b?void 0:b.area)||!i?"page_details"===(null==b?void 0:b.area)&&e.push({key:"moveToMainPage",render:e=>(0,B.jsx)(ue().A,{...e,title:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.moveToPage",defaultMessage:"Move to page"}),icon:(0,B.jsx)(Le,{icon:Y({width:14})})}),action:()=>{x&&S?(0,Me().E)({environment:a,position:{type:"area_relative",area:"views_main_tab_modules",viewId:S,location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}):(0,Me().E)({environment:a,position:{type:"area_relative",area:"page_main",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),_({destinationModuleId:t.id})}}):e.push({key:"moveToSidebar",render:e=>(0,B.jsx)(ue().A,{...e,title:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.moveToInfoPanel",defaultMessage:"Move to panel"}),icon:(0,B.jsx)(Le,{icon:(0,Z().o)({width:14})})}),action:()=>{(0,Me().E)({environment:a,position:{type:"area_relative",area:"page_details",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),_({destinationModuleId:t.id})}}),(0,ne().Fe)(t)&&(0,ne().wm)(t)){let o=[];(0,R().gx)(t)?o=[t.propertyId]:(0,R().V_)(t)?o=v:(0,f().HB)(t);const i=()=>{var e;le().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToPropertyGroup",perform(e){for(const t of o)(0,Ie().HD)({environment:a,transaction:e,layoutStore:r,property:t})}});const t=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;t?_({destinationModuleId:t}):l(void 0)};e.push({key:"moveToPropertiesGroupModule",render:(e,t)=>(0,B.jsx)(Re,{...e,parent:t,propertyIds:o,onSelectSectionMove:i,propertyGroups:y}),action:i})}if((0,R().Yp)(t)){const o=()=>{var e;le().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToRelationsGroupModule",perform(e){const o=r.getCollectionModel();if(!o)return;const i=A().md.createChildStore(r,o.pointer);(0,Ie().HD)({environment:a,transaction:e,layoutStore:r,property:t.propertyId}),se().Z7({property:t.propertyId,visibility:"inline",schema:o.getSchema(),format:o.getFormat(),collectionStore:i,environment:a,transaction:e})}});const o=null===(e=r.firstModuleOfType("relationsGroup"))||void 0===e?void 0:e.id;o?_({destinationModuleId:o}):l(void 0)};e.push({key:"moveToRelationsGroup",render:(e,t)=>(0,B.jsx)(He,{parent:t,onSelect:o,...e}),action:o})}if((0,ne().Fe)(t)){const i=async()=>{var e;if(null==b||!b.area||!p)return;const i=await we(t.type);if(i)switch(i){case"delete_module":le().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,perform(e){if((0,R().gx)(t))(0,Ie().HD)({environment:a,transaction:e,layoutStore:r,property:t.propertyId});else if((0,R().V_)(t))for(const t of v)(0,Ie().HD)({environment:a,transaction:e,layoutStore:r,property:t});else(0,be().U)({environment:a,layoutStore:r,position:{..."views_main_tab_modules"===(null==b?void 0:b.area)?{area:"views_main_tab_modules",viewId:b.viewId}:{area:b.area},moduleId:t.id},sessionId:o})},userAction:"ModuleActionsMenu.removePropertyFromLayout.deleteModule"});const s=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;return void(s&&_({destinationModuleId:s}));case"delete_property_and_module":let c=[];if((0,R().gx)(t)?c=[t.propertyId]:(0,R().V_)(t)&&(c=v||[]),c.length)for(const e of c){var n;(0,ae().B)({collectionContextStore:u,environment:a,property:e,schema:p,from:"table_column"}),(0,je().PS)({environment:a,module:t,sessionId:o,collectionId:null===(n=r.getCollectionModel())||void 0===n?void 0:n.id,layoutId:r.id,context:(0,d().We)(null==b?void 0:b.area),area:null==b?void 0:b.area,depth:0})}else(0,be().U)({environment:a,layoutStore:r,sessionId:o,position:{..."views_main_tab_modules"===(null==b?void 0:b.area)?{area:"views_main_tab_modules",viewId:b.viewId,moduleId:t.id}:{area:b.area,moduleId:t.id}}});return void l(void 0);default:(0,f().HB)(i)}};e.push({key:"removeModule",render:e=>(0,R().gx)(t)?(0,B.jsx)(de().$,{...e,getTitleOverride:e=>{let{isRequiredProperty:t}=e;return t?void 0:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.removeFromPropertyModule",defaultMessage:"Remove from layout"})},iconTransformer:e=>(0,B.jsx)(Le,{icon:e}),collectionContextStore:u,property:t.propertyId}):(0,B.jsx)(ue().A,{...e,title:(0,B.jsx)(m().sA,{id:"ModuleActionMenu.buttons.removeFromModule",defaultMessage:"Remove from layout"}),isRedOnHover:!0,icon:(0,B.jsx)(Le,{icon:(0,ee().I)({width:14})})}),action:i})}return e}),[t,C,b,a,r,o,_,x,S,v,l,y,p,u]);return w}({layoutModule:t}),a=(0,l().IS)((()=>({actionButton:{position:"absolute",top:4,right:4,zIndex:1e3}})),[]);return o&&0!==r.length?(0,B.jsx)("div",{style:a.actionButton,children:(0,B.jsx)(Ve,{moduleId:t.id,menuListItems:r})}):null}function Ge(e){let{moduleId:t,isModuleHoveredOrSelected:o}=e;const{layoutStore:r,setModuleSelection:i}=(0,T().LH)(),n=(0,s().K8)((()=>r.getModuleById(t)),[r,t]),a=(0,s().K8)((()=>{if(n&&"formQuestion"===n.type)return Se().c.createChildStore(r,{table:"form_question",id:n.formQuestionId,spaceId:r.getSpaceId()??""})}),[r,n]),d=(0,ke().d)(),u=(0,l().IS)((e=>({iconStyle:{fill:e.accentColors.uiBlue[600]}})),[]),c=(0,m().tz)();if(!n||!a)return null;const p=c.formatMessage({id:"FormLayoutModuleActionMenu.editQuestion.tooltip",defaultMessage:"Edit question"});return(0,B.jsx)("div",{style:{opacity:o?1:0,pointerEvents:o?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24},children:(0,B.jsx)(fe().A,{render:e=>(0,B.jsx)(pe().A,{...e,icon:X()._,hasBackground:!0,style:{...d.button,cursor:"pointer"},iconStyle:u.iconStyle,pressedStyle:d.buttonPressed,hoveredStyle:d.buttonHovered,ariaLabel:p,onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown})},onClick:()=>i({type:"existing_module",moduleId:t,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),renderTooltip:()=>p})})}function Ve(e){let{moduleId:t,menuListItems:o}=e;const r=(0,m().tz)(),n=(0,i.useMemo)((()=>[{type:"actionGroup",label:r.formatMessage({id:"ModuleActionMenu.openButton",defaultMessage:"Action menu for module"}),icon:X()._,menuListItems:o}]),[r,o]);return(0,B.jsx)(We,{moduleId:t,actionMenuItems:n,isModuleHoveredOrSelected:!0,boxShadow:!1})}function qe(e){let{isFirst:t,isLast:o}=e;return{borderTopLeftRadius:t?4:0,borderBottomLeftRadius:t?4:0,borderTopRightRadius:o?4:0,borderBottomRightRadius:o?4:0,borderRight:"solid rgba(15, 15, 15, 0.1)",borderRightWidth:o?0:1}}function We(e){let{moduleId:t,actionMenuItems:o,isModuleHoveredOrSelected:r,boxShadow:n}=e;const[s,l]=(0,i.useState)(!1),a=(0,i.useCallback)((e=>{l(e)}),[]);return(0,B.jsx)("div",{style:{opacity:r||s?1:0,pointerEvents:r||s?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24,boxShadow:n?"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 2px 4px":void 0},children:o.map(((e,t)=>{const r=0===t,i=o.length-1===t;switch(e.type){case"action":return(0,B.jsx)($e,{item:e,isFirst:r,isLast:i},t);case"actionGroup":return(0,B.jsx)(Ne,{itemGroup:e,isFirst:r,isLast:i,isOpen:s,setIsOpen:a},t)}}))})}function $e(e){let{item:t,isFirst:o,isLast:r}=e;const{layoutStore:i}=(0,T().LH)(),n=(0,s().K8)((()=>i.getLayoutType()),[i]),a=(0,l().IS)((e=>({iconButton:{...qe({isFirst:o,isLast:r})},icon:{..."form"===n?{fill:e.icon.secondary}:{}}})),[o,r,n]);return(0,B.jsx)(fe().A,{render:e=>(0,B.jsx)(pe().A,{...e,icon:t.icon,hasBackground:!0,ariaLabel:t.label,style:a.iconButton,iconStyle:a.icon,onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown})},onClick:t.action}),renderTooltip:()=>t.tooltipLabel??null,disableTooltip:!t.tooltipLabel})}function Ne(e){let{itemGroup:t,isFirst:o,isLast:r,isOpen:i,setIsOpen:n}=e;const{layoutStore:a}=(0,T().LH)(),d=(0,s().K8)((()=>a.getLayoutType()),[a]),u=(0,l().IS)((e=>({iconButton:{...qe({isFirst:o,isLast:r})},icon:{..."form"===d?{fill:e.icon.secondary}:{fill:e.text.uiBluePrimary}},iconButtonHovered:{..."form"===d?void 0:{background:e.tint.uiBlueHover}},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[o,r,d]);return(0,B.jsx)(ce().Ay,{alignmentToOrigin:he().C.End,popupType:xe().n.Popup,onClose:()=>n(!1),onClick:()=>n(!0),open:i,render:()=>(0,B.jsx)(me().A,{menuType:ve().gu.Popup,onClick:()=>n(!1),children:(0,B.jsx)(ge().Ay,{initialFocus:void 0,sections:[{key:0,render:e=>(0,B.jsx)(ye().A,{...e,desktopStyle:u.sectionMenuItem}),items:t.menuListItems}],type:ge().Oh.Vertical})}),renderOrigin:e=>(0,B.jsx)(pe().A,{...e,icon:t.icon,hasBackground:"form"===d,ariaLabel:t.label,style:u.iconButton,iconStyle:u.icon,onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown})},hoveredStyle:u.iconButtonHovered,pressedStyle:u.iconButtonHovered})})}const ze=(0,i.createContext)(void 0);ze.displayName="PageEditorModuleContext";const Ue=ze.Provider;var Ye=()=>o(116485);const Ze=!1,Je=10;function Xe(e){const{isSelected:t,isDragging:o,isConfigurable:r,isDraggable:n}=function(){const e=(0,i.useContext)(ze);if(!e)throw new Error("PageEditorModuleContext not found");return e}(),{style:a,children:d,module:u,area:c}=e,p="placeholder"===u.type,{setModuleSelection:m,layoutStore:g,currentModuleSelection:y}=(0,T().LH)(),[f,v]=(0,G().B)(),h=(0,i.useRef)(null),x=(0,H().A)(f,h),S=(0,s().K8)((()=>{var e;return null===(e=g.getModel())||void 0===e?void 0:e.getLayoutType()}),[g]),M=(0,s().K8)((()=>(0,Q().cq)(g)),[g]),b=(0,$().z)();(0,O().b)(V().A,(()=>({layoutStore:g,moduleId:u.id,moduleType:u.type,area:c,getNode:()=>h.current})),[g,u,h,c]);const C=(0,i.useCallback)((e=>{if(!r||"viewsMain"===u.type)return{};const i={margin:0,borderRadius:"form"===S?12:8,...!r||n||"form"===S&&p?{}:{cursor:"pointer",margin:"0 0 12px 0"},padding:"form"!==S||p?0:12,transition:"box-shadow 0.3s"};if(o&&!p)return{...i,...(0,K().nl)({width:3,color:e.stroke.uiBluePrimary}),transform:"scale(1.03)",transition:"transform 0.8s cubic-bezier(0.5, -1.5, 0.5, 2)"};if(t&&!p)return{...i,...(0,K().nl)({width:3,color:e.stroke.uiBluePrimary})};const s=null==y?void 0:y.isDragging;return v&&!s?{...i,...(0,K().nl)({width:3,color:"light"===e.mode?e.stroke.uiBlueSecondary:e.text.uiBlueSecondary})}:{...i,...(0,K().nl)({width:1,color:"light"===e.mode?e.stroke.uiBlueSecondary:e.text.uiBlueSecondary})}}),[null==y?void 0:y.isDragging,r,n,o,v,p,t,S,u.type]),_=(0,l().IS)((e=>{const t=C(e),o="form"!==S?Je:"cover"===u.type?0:"formTitle"===u.type?b:Je,i=p?e.accentColors.uiBlue[75]:"form"===S&&M?e.peekModalBackground:e.contentBackground;return{labelContainer:{height:32,backgroundColor:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],display:"flex",alignItems:"center",gap:4,padding:6},dragHandle:{fill:e.text.uiBluePrimary,width:12,height:12},noDragHandle:{},label:{fontSize:14,fontWeight:500,color:e.text.uiBluePrimary,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",paddingRight:24},previewContainer:{padding:12},container:{background:i,width:"100%",position:"relative",marginBottom:o,...r?t:{},overflow:"formTitle"!==u.type&&"viewsMain"!==u.type?"hidden":void 0,...a},mouseEventCover:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:999}}}),[C,r,u.type,a,S,b,p,M]),w="form"!==S&&!Ze&&"viewsMain"!==u.type,I=((0,W().H)(u),v||t);return(0,B.jsxs)("div",{style:_.container,ref:x,onClick:e=>{r&&!n&&"viewsMain"!==u.type&&m({type:"existing_module",moduleId:u.id,isDragging:!1}),r&&(0,E().SQ)({event:e,context:E().y$.EditorClick})},className:"cover"===u.type?Ye().pv:Ye().hg,children:["form"!==S&&"viewsMain"!==u.type&&r?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{style:_.labelContainer,children:[n?(0,D().i)(_.dragHandle):(0,B.jsx)("div",{style:_.noDragHandle}),(0,B.jsx)("div",{style:_.label,children:(0,B.jsx)(et,{module:u})})]}),(0,B.jsx)("div",{style:_.previewContainer,children:d})]}):d,w&&(0,B.jsx)("div",{style:_.mouseEventCover}),r&&(0,B.jsx)(Ee,{layoutType:S,module:u,isModuleHoveredOrSelected:I})]})}function et(e){const{module:t}=e;return(0,R().gx)(t)?(0,B.jsx)(tt,{module:t}):(0,B.jsx)(m().sA,{...q().s[t.type]})}function tt(e){const{module:t}=e,{collectionStore:o}=(0,T().bi)(),r=(0,s().K8)((()=>o.getSchema()),[o]),i=(0,s().K8)((()=>r[t.propertyId]),[t,r]);return i?(0,B.jsx)(B.Fragment,{children:i.name}):null}var ot=()=>o(543396),rt=()=>o(284594),it=()=>o(384221),nt=()=>o(680645),st=()=>o(227083),lt=()=>o(201254),at=()=>o(284002),dt=()=>o(79634),ut=()=>o(400279),ct=()=>o(943540),pt=()=>o(517198),mt=()=>o(779921);function gt(e){let{layoutStore:t,formQuestionId:o}=e;const r=(0,n().v3)(),l=(0,M().ET)(),d=(0,i.useRef)(null),{canEditLayout:u}=(0,T().LH)(),{collectionStore:c,formBlock:p}=(0,s().K8)((()=>{var e;return{collectionStore:l.collectionStore(),formBlock:null===(e=l.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[l]);if(!c)throw new Error("No collection store found");const m=(0,s().K8)((()=>t.getSpaceId()),[t]),g=(0,s().K8)((()=>{if(m)return A().c7.createChildStore(t,{table:"form_question",id:o,spaceId:m})}),[o,t,m]),y=(0,s().K8)((()=>!(null!=g&&g.isReady())),[g]),f=(0,s().K8)((()=>{var e;if(g)return null===(e=g.getConfig())||void 0===e?void 0:e.propertyId}),[g]),v=(0,s().K8)((()=>c.getSchema()),[c]),x=(0,s().K8)((()=>{if(v&&f)return(0,a()._g)({schema:v,property:f})}),[v,f]),S=(0,ut().W)({inMemoryRecordCacheName:"FormQuestionTemporaryRecordCache",collectionSchema:v,collectionId:c.id,spaceId:m,formMode:"builder"}),b=(0,s().K8)((()=>{const e=c.getSchema();if(!e||!g)return"generic_error";return g.getQuestionErrorState(r,e,null==p?void 0:p.hasSitePublicPermission())}),[c,r,p,g]),{autofocusedQuestionTextStore:C}=(0,h().cJ)(),_=(0,s().K8)((()=>Boolean(C.state&&C.state.questionId===(null==g?void 0:g.id))),[C,null==g?void 0:g.id]);return(0,i.useEffect)((()=>{var e,t;g&&(_&&("title"===(null===(e=C.state)||void 0===e?void 0:e.questionInputType)?it().selectAllTextMulti({environment:r,store:g.getNameStore(),canSelectAllBlocks:!1,contentEditableContextId:void 0}):"description"===(null===(t=C.state)||void 0===t?void 0:t.questionInputType)&&it().setSelectionAtEnd({store:g.getDescriptionStore()}),C.clear()))}),[C,r,_,g]),y?(0,B.jsx)(yt,{}):g&&f&&c&&S?(0,B.jsxs)("div",{ref:d,children:[(0,B.jsx)(ft,{formQuestionStore:g}),b?(0,B.jsx)(xt,{questionErrorState:b,propertyType:null==x?void 0:x.type}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(vt,{formQuestionStore:g}),x&&(0,ot().OG)(x)&&(0,B.jsx)(ht,{formQuestionStore:g,propertySchema:x}),(0,B.jsx)(ct().qm,{store:S,property:f,disabled:!0,locked:!u,format:"form_editor",blockPropertyValueOverlayStore:mt().A,collectionStore:c,tableWrap:!1,formQuestionStore:g},f)]})]}):null}function yt(){const e=(0,l().IS)((e=>({questionTitleShimmer:{borderRadius:8,height:22,width:200},questionInputShimmer:{borderRadius:5,height:16,width:"100%",marginTop:12}})),[]);return(0,B.jsxs)("div",{children:[(0,B.jsx)(pt().A,{style:e.questionTitleShimmer}),(0,B.jsx)(pt().A,{style:e.questionInputShimmer})]})}function ft(e){let{formQuestionStore:t}=e;const o=(0,n().v3)(),r=(0,M().ET)(),{collectionStore:l}=(0,h().cJ)(),{canEditLayout:a}=(0,T().LH)(),d=(0,s().O$)(r.normalizedSchemaStore),u=(0,i.useCallback)((()=>{(0,nt().maybeSyncQuestionNameToPropertyName)({environment:o,questionStore:t,collectionStore:l,collectionContextStore:r})}),[r,l,o,t]),c=!a;return d&&l?(0,B.jsx)(dt().j,{formMode:"builder",disabled:c,onChange:u,formQuestionStore:t}):null}function vt(e){let{formQuestionStore:t}=e;const{canEditLayout:o}=(0,T().LH)(),r=!o;return(0,B.jsx)(lt().P,{disabled:r,formQuestionStore:t,formMode:"builder"})}function ht(e){return(0,B.jsx)(at().A,{...e,formMode:"builder"})}function xt(e){let{questionErrorState:t,propertyType:o}=e;const r=(0,l().IS)((e=>({helpIcon:{width:16,marginLeft:6,fill:e.icon.secondary},container:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:8},textSpan:{color:e.text.tertiary}})),[]),n=(0,i.useMemo)((()=>{switch(t){case"deleted_property":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.deletedProperty",defaultMessage:"This question's corresponding property has been deleted."});case"invalid_property_type":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.invalidProperty",defaultMessage:"This question's corresponding property is not supported."});case"invalid_property_type_for_public_form":return"person"===o?(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.person",defaultMessage:"Person property is not supported in public forms."}):(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.generic",defaultMessage:"This question's linked property type is not supported in public forms."});case"related_collection_not_public":return(0,B.jsx)(m().sA,{...st().yh.relatedCollectionNotPublic});case"generic_error":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.message",defaultMessage:"Something is wrong with this linked property."})}}),[o,t]),s=(0,i.useMemo)((()=>{switch(t){case"deleted_property":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.deletedProperty.helperTooltip",defaultMessage:"Delete this question or link it to a different property."});case"invalid_property_type":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.invalidProperty.helperTooltip",defaultMessage:"Change the question type to a supported type"});case"generic_error":return(0,B.jsx)(m().sA,{id:"BrokenLinkedPropertyWarning.genericError.helperTooltip",defaultMessage:"Delete this question or link it to a different property."})}}),[t]);return(0,B.jsxs)("div",{style:r.container,children:[(0,B.jsx)("span",{style:r.textSpan,children:n}),(0,B.jsx)(fe().A,{renderTooltip:()=>(0,B.jsx)("div",{style:{width:240,whiteSpace:"pre-wrap"},children:s}),disableTooltip:"invalid_property_type_for_public_form"===t||"related_collection_not_public"===t,render:e=>"invalid_property_type_for_public_form"===t||"related_collection_not_public"===t?null:(0,B.jsx)("div",{...e,children:(0,rt().$)(r.helpIcon)})})]})}var St=()=>o(209242),Mt=()=>o(702011),bt=()=>o(581101),Ct=()=>o(991649),_t=()=>o(394094),wt=(o(500234),o(113085),()=>o(15552)),It=()=>o(346239),jt=()=>o(267521),At=()=>o(749351),kt=()=>o(804750),Tt=()=>o(109046),Bt=()=>o(401548),Pt=()=>o(521325),Ft=()=>o(303330),Lt=()=>o(956070),Ht=()=>o(505521),Ot=()=>o(126451),Dt=()=>o(209684),Rt=()=>o(97787),Et=()=>o(443252),Qt=()=>o(863969),Kt=()=>o(155352),Gt=()=>o(121686),Vt=()=>o(755769),qt=()=>o(943066),Wt=()=>o(133926);function $t(e){const{parentModule:t}=e,o=(0,s().K8)((()=>t.conditionalGroups),[t]);return o?(0,B.jsx)(B.Fragment,{children:o.map((e=>(0,B.jsx)(Nt,{conditionalGroup:e,parentModule:t},e.id)))}):null}function Nt(e){var t;const{conditionalGroup:o,parentModule:r}=e,a=(0,n().v3)(),{setModuleSelection:d,currentModuleSelection:u,canEditLayout:c,layoutStore:p,sessionId:m}=(0,T().LH)(),g=(0,Qt().O)(),{formConditionalGroupsStore:f}=(0,h().cJ)(),v=(0,s().K8)((()=>{const e=(0,Lt().h8)(r.id,o.id);return!f.state.conditionalGroupCollapsedStates[e]}),[o.id,f,r.id]),x=(0,i.useMemo)((()=>new(Gt().A)),[]),[S,M]=(0,i.useState)(!1),[b,C]=(0,i.useState)(!1),_=(0,l().IS)((e=>({conditionalGroupContainer:{display:"flex",cursor:"auto",paddingTop:20},conditionalGroupContent:{display:"flex",flexDirection:"column",paddingBottom:12,paddingLeft:10,marginLeft:4,cursor:"auto",flexGrow:1},draggableList:{gap:24,display:"flex",flexDirection:"column"}})),[]),w=(0,s().K8)((()=>{var e;const t=null===(e=r.conditionalGroups)||void 0===e?void 0:e.find((e=>e.id===o.id));return t?t.children??[]:[]}),[o,r]),I=(0,i.useCallback)((e=>{const t="existing_module"===(null==u?void 0:u.type)&&u.moduleId===e;return(0,B.jsx)(so,{pageModuleId:e,active:t,area:"form_conditional_modules"})}),[u]),j=(0,s().K8)((()=>{const e=p.getModules().form_conditional_modules;if(!e)return!0;return w.some((t=>"formQuestion"===e[t].type))}),[w,p]),A=(0,Wt()._X)({name:"forms_conditional_logic",spaceId:g,userId:null===(t=a.currentUser)||void 0===t?void 0:t.id}),k=null==A?void 0:A.upsell,P=void 0===r.parentModuleId&&k,F=(0,i.useCallback)(((e,t)=>{let{key:i,endPosition:n}=t;(0,Me().E)({environment:a,layoutStore:p,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:o.id,parentModuleId:r.id,index:n},moduleId:i,sessionId:m})}),[o.id,a,p,r.id,m]),L=(0,i.useCallback)((()=>{const e=(0,Lt().h8)(r.id,o.id),t=f.state.conditionalGroupCollapsedStates[e];f.setState({conditionalGroupCollapsedStates:{...f.state.conditionalGroupCollapsedStates,[e]:!t}})}),[o.id,f,r.id]),H=(0,i.useCallback)((()=>{d(void 0)}),[d]),O=(0,i.useCallback)((e=>{e&&d({type:"existing_module",moduleId:e,isDragging:!1})}),[d]);return(0,B.jsxs)("div",{onMouseDown:e=>{M(!1),C(!1),(0,E().SQ)({event:e,context:E().y$.EditorMouseDown,callback:y().D_})},children:[P&&(0,B.jsx)(zt,{upsell:k}),(0,B.jsxs)("div",{style:_.conditionalGroupContainer,children:[(0,B.jsx)(Ut,{isGroupExpanded:v,toggleGroupVisibility:L}),(0,B.jsxs)("div",{style:_.conditionalGroupContent,children:[(0,B.jsx)(Yt,{parentModule:r,groupId:o.id,trigger:o.trigger,isGroupExpanded:v,filterOptionsPopupOpen:S,setFilterOptionsPopupOpen:M,filterOperatorPopupOpen:b,setFilterOperatorPopupOpen:C}),v&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Rt().Ay,{className:Ye().hg,store:x,keys:w,direction:"vertical",onDrop:(e,t)=>{F(e,t)},onDragCancel:H,hoverCursorStyleOverride:1===w.length?"pointer":void 0,onClick:O,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:e=>I(e),disabled:!c,style:_.draggableList}),j&&(0,B.jsx)(eo,{parentModuleId:r.id,parentConditionalGroupId:o.id})]})]})]})]})}function zt(e){const{upsell:t}=e,o=(0,n().v3)(),r=(0,l().IS)((e=>({container:{color:e.text.uiYellowPrimary,background:e.tint.uiYellowHover,borderRadius:6,width:"100%",padding:"10px 22px",marginTop:24,fontSize:14,display:"flex",alignItems:"center"},upgradeButton:{marginRight:-4,color:e.text.uiYellowPrimary,fontWeight:v().Wy.medium},upgradeButtonHovered:{backgroundColor:(0,Bt().X4)(e.text.uiYellowPrimary,.1)},upgradeButtonPressed:{backgroundColor:(0,Bt().X4)(e.text.uiYellowPrimary,.2)}})),[]);return(0,B.jsxs)("div",{style:r.container,children:[(0,B.jsx)("div",{style:{width:"90%",marginRight:10},children:(0,B.jsx)(m().sA,{id:"upgradeForConditionalLogicWarning.warning",defaultMessage:"Conditional logic is only available on Business and Enterprise plan types."})}),(0,B.jsx)(Dt().p,{style:r.upgradeButton,hoveredStyle:r.upgradeButtonHovered,pressedStyle:r.upgradeButtonPressed,onMouseDown:()=>{qt().K(o,{upsell:t,from:"forms_conditional_logic"})},children:(0,B.jsx)(m().sA,{id:"upgradeForConditionalLogicWarning.upgrade",defaultMessage:"Upgrade"})})]})}function Ut(e){const{isGroupExpanded:t,toggleGroupVisibility:o}=e,r=(0,l().IS)((e=>({groupBar:{gap:6,opacity:"light"===e.mode?.5:.75,color:e.text.uiBlueSecondary,display:"flex",flexDirection:"column",alignItems:"center",marginTop:3,paddingLeft:26},toggleHovered:{background:void 0,opacity:"light"===e.mode?.8:1},toggleIcon:{height:14,width:14,transform:t?"rotate(180deg)":"rotate(90deg)",fill:e.text.uiBlueSecondary}})),[t]);return(0,B.jsxs)(Ot().A,{style:r.groupBar,onClick:o,hoveredStyle:r.toggleHovered,pressedStyle:r.toggleHovered,children:[(0,It().l)(r.toggleIcon),(0,B.jsx)("div",{style:{width:2,flexGrow:1,background:"linear-gradient(0deg, rgba(35, 131, 226, 0) 0px, rgba(35, 131, 226, 0.57) 64px)",borderRadius:1,opacity:.4}})]})}function Yt(e){const{isGroupExpanded:t,groupId:o,trigger:r,parentModule:a,filterOptionsPopupOpen:d,setFilterOptionsPopupOpen:u,filterOperatorPopupOpen:c,setFilterOperatorPopupOpen:p}=e,g=(0,m().tz)(),f=(0,n().v3)(),{layoutStore:v,sessionId:x}=(0,T().LH)(),{isCollectionEmpty:S}=(0,h().cJ)(),b=(0,M().ET)(),C=(0,Qt().O)(),_=(0,s().K8)((()=>{const e=r.filter;if((0,wt().gc)(e)&&((0,wt().v0)(e)||(0,wt().as)(e))){return(0,wt().v0)(e)?(0,wt().Zl)(e):(0,wt().SM)(e)}}),[r]),w=(0,i.useMemo)((()=>(0,wt().Ui)(r.filter)?void 0===r.filter.value.value:0===(null==_?void 0:_.length)),[r.filter,_]),I=(0,l().IS)((e=>({indentedBranchContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginBottom:12},triggerText:{display:"flex",alignItems:"center",gap:4,color:e.text.uiBlueSecondary},deleteIcon:{width:20,height:20},triggerOption:{color:e.text.uiBluePrimary},descendantCount:{display:"flex",alignItems:"center",gap:4,marginLeft:4},popupButton:{display:"flex",padding:"0px 3px",borderRadius:4,color:e.text.uiBluePrimary},triggerButtonHoveredStyle:{background:e.lightBlueBannerBackground},triggerButtonPressedStyle:{background:e.lightBlueBannerBackground},chevronIcon:{height:14,width:14,color:e.text.uiBluePrimary,marginTop:3,marginLeft:2},triggerOptionText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:300,color:w?e.text.uiBlueTertiary:void 0}})),[w]),[j,k]=(0,i.useState)(!1),P=(0,i.useMemo)((()=>j),[j]),F=(0,s().K8)((()=>v.getModules().form_conditional_modules||{}),[v]),L=(0,i.useMemo)((()=>{var e;const t=null===(e=a.conditionalGroups)||void 0===e?void 0:e.find((e=>e.id===o));if(!t)return 0;let r=0;for(const o of t.children??[]){const e=F[o];if(!e||"formQuestion"!==e.type)continue;const{formQuestionDescendants:t}=(0,Lt().Yg)({currentModule:e,nestedModules:F,includePlaceholders:!1});r+=t.length}return r}),[a,o,F]),H=(0,s().K8)((()=>{var e;if(!C)return;const t=A().c7.createChildStore(v,{id:a.formQuestionId,table:Tt().lo,spaceId:C}),o=null===(e=b.collectionStore())||void 0===e?void 0:e.getSchema();if(!o)return;const r=o[t.getPropertyId()??""];return(0,ot().hm)(r,t.getModel())}),[a.formQuestionId,v,C,b]),O=(0,s().K8)((()=>{if(!_||_.length<2||(0,wt().Ui)(r.filter))return;const e=r.filter;return(0,wt().v0)(e)?"any":"enum_contains_all"===e.operator?"all":"any"}),[r,_]),D=(0,s().K8)((()=>{if(!O)return;const e="any"===O?(0,B.jsx)(m().sA,{defaultMessage:"any",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.any"}):(0,B.jsx)(m().sA,{defaultMessage:"all",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.all"});return(0,wt().v0)(r.filter)||1===H?e:(0,B.jsx)(Et().Ay,{popupType:Et().nl.Popup,placementToOrigin:Vt().UV.Bottom,alignmentToOrigin:Vt().MY.Start,style:{marginLeft:-14},open:c,origin:(0,B.jsxs)(Ot().A,{onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown,callback:y().D_})},onClick:()=>p(!0),style:I.popupButton,hoveredStyle:I.triggerButtonHoveredStyle,pressedStyle:I.triggerButtonPressedStyle,children:[e,(0,jt().arrowChevronSingleDownFillIcon)(I.chevronIcon)]}),onDismiss:()=>p(!1),disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:6,render:()=>(0,B.jsx)(Zt,{trigger:r,currentOperator:O,parentModule:a,conditionalGroupId:o}),trapFocus:!0})}),[O,r,H,c,p,I,a,o]),R=(0,s().K8)((()=>{if((0,wt().Ui)(r.filter))switch(r.filter.value.value){case!0:return(0,B.jsx)(m().sA,{defaultMessage:"checked",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfCheckboxIsChecked"});case!1:return(0,B.jsx)(m().sA,{defaultMessage:"unchecked",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfCheckboxIsUnchecked"});default:return(0,B.jsx)(m().sA,{defaultMessage:"Select",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.NoOptionsSelected"})}return _&&0!==_.length?_.map((e=>e.value)).join(", "):(0,B.jsx)(m().sA,{defaultMessage:"Select",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.NoOptionsSelected"})}),[_,r.filter]),Q=(0,s().K8)((()=>(0,B.jsx)(Et().Ay,{popupType:Et().nl.Popup,placementToOrigin:Vt().UV.Bottom,alignmentToOrigin:Vt().MY.Start,style:{marginLeft:-14},open:d,origin:(0,B.jsxs)(Ot().A,{style:I.popupButton,onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown,callback:y().D_})},onClick:()=>u(!0),hoveredStyle:I.triggerButtonHoveredStyle,pressedStyle:I.triggerButtonPressedStyle,children:[(0,B.jsx)("span",{style:I.triggerOptionText,children:R}),(0,jt().arrowChevronSingleDownFillIcon)(I.chevronIcon)]}),onDismiss:()=>u(!1),disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:6,render:()=>(0,B.jsx)(Jt,{parentModule:a,trigger:r,groupId:o}),trapFocus:!0})),[d,R,o,a,u,I,r]),K=(0,i.useCallback)((()=>{k(!0)}),[]),G=(0,i.useCallback)((()=>{k(!1)}),[]),V=(0,i.useCallback)((()=>{Ft().FG({environment:f,parentModule:a,layoutStore:v,groupId:o,collectionContextStore:b,isCollectionEmpty:S,sessionId:x})}),[f,a,o,v,b,S,x]),q=(0,s().K8)((()=>(0,wt().v0)(r.filter)||(0,wt().as)(r.filter)?O?(0,B.jsx)(m().sA,{defaultMessage:"If {filterOperatorPopup} of {filterValuesPopup} is selected",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfFilterValueIsSelected",values:{filterOperatorPopup:D,filterValuesPopup:Q}}):(0,B.jsx)(m().sA,{defaultMessage:"If {filterValuesPopup} is selected",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.SimpleFilter.Trigger",values:{filterValuesPopup:Q}}):(0,wt().Ui)(r.filter)?(0,B.jsx)(m().sA,{defaultMessage:"If {filterValuesPopup}",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.Checkbox",values:{filterValuesPopup:Q}}):void 0),[O,D,Q,r.filter]);return(0,B.jsxs)("div",{style:I.indentedBranchContainer,onMouseMove:K,onMouseLeave:G,children:[(0,B.jsxs)("div",{style:I.triggerText,children:[q,!t&&L>0&&(0,B.jsxs)("div",{style:I.descendantCount,children:[(0,At().O)({height:16,width:16}),(0,B.jsx)("span",{children:L})]})]}),P&&(0,B.jsx)(fe().A,{placement:he().W.Top,textWrap:!1,renderTooltip:()=>(0,B.jsx)(m().sA,{defaultMessage:"Delete condition",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.DeleteIcon.Tooltip.title"}),render:e=>(0,B.jsx)(pe().A,{style:I.deleteIcon,isBlue:!0,onClick:V,icon:ee().I,ariaLabel:g.formatMessage({defaultMessage:"Delete condition",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.DeleteIcon.title"}),...e})})]})}function Zt(e){const{currentOperator:t,trigger:o,parentModule:r,conditionalGroupId:i}=e,s=(0,n().v3)(),{layoutStore:l}=(0,T().LH)(),a=[{key:"any",render:e=>(0,B.jsx)(ue().A,{...e,disabled:!1,title:(0,B.jsx)(m().sA,{defaultMessage:"any",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.any"}),isChecked:"any"===t}),action:()=>{(0,wt().gc)(o.filter)&&(0,wt().as)(o.filter)&&Ft().Is({environment:s,layoutStore:l,module:r,conditionalGroupId:i,newValue:{...o.filter,operator:"enum_contains"}})}},{key:"all",render:e=>(0,B.jsx)(ue().A,{...e,disabled:!1,title:(0,B.jsx)(m().sA,{defaultMessage:"all",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.all"}),isChecked:"all"===t}),action:()=>{(0,wt().gc)(o.filter)&&(0,wt().as)(o.filter)&&Ft().Is({environment:s,layoutStore:l,module:r,conditionalGroupId:i,newValue:{...o.filter,operator:"enum_contains_all"}})}}],d=[{key:0,render:e=>(0,B.jsx)(ye().A,{...e}),items:a}],u={menuType:ve().gu.Popup,width:200};return(0,B.jsx)(me().A,{...u,children:(0,B.jsx)(ge().Ay,{type:ge().Oh.Vertical,sections:d,onAccept:()=>{},initialFocus:void 0})})}function Jt(e){const{parentModule:t,trigger:o,groupId:r}=e,i=(0,n().v3)(),{layoutStore:l,canEditLayout:a}=(0,T().LH)(),d=(0,M().ET)(),{collectionViewStore:u,schema:c}=(0,s().K8)((()=>{const e=d.collectionStore();if(!e)throw new Error("No collection store found");return{collectionViewStore:d.collectionViewStore(),schema:e.getSchema()}}),[d]);return u?(0,B.jsx)(Ht().td,{collectionViewId:u.id,propertyFilter:o,schema:c,parentStore:u,onChange:e=>{Ft().Is({environment:i,layoutStore:l,module:t,conditionalGroupId:r,newValue:e})},onChangeDebounced:y().lQ,onClose:y().lQ,onDelete:y().lQ,onAddToCombinatorFilter:y().lQ,context:Ht().mL.PropertyFilter,userCanConfigureFilters:a,allowRelativeDateFilter:!1,allowRelativePersonFilter:!1,collectionContextStore:d}):null}function Xt(){const e=(0,l().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:"100%",gap:8,color:e.text.uiBluePrimary},plusIcon:{borderRadius:"100%",background:e.tint.uiBlue,width:20,height:20,padding:2,boxShadow:`0 0 0 3px ${e.tint.uiBlue}`,marginRight:4}})),[]);return(0,B.jsxs)("div",{style:e.container,children:[(0,kt().b)(e.plusIcon),(0,B.jsx)("span",{children:(0,B.jsx)(m().sA,{defaultMessage:"Add or select questions",id:"FormConditionalLogicModuleRenderer.NestedPlaceholderModuleTitle"})})]})}function eo(e){var t;const o=(0,n().v3)(),r=(0,Qt().O)(),{parentModuleId:a,parentConditionalGroupId:d}=e,u=(0,M().ET)(),c=(0,i.useRef)(null),p=(0,s().K8)((()=>{const e=(0,Kt().S)(u.settingsStore);return"formQuestionCreateSettings"===(null==e?void 0:e.type)&&u.settingsStore.state.ref===c}),[u.settingsStore,c]),g=(0,l().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",marginTop:12},plusButton:{borderRadius:"100%",background:e.tint.uiBlue,width:20,height:20,padding:2,boxShadow:`0 0 0 3px ${e.tint.uiBlue}`,marginRight:4},pressedStyle:{background:void 0,color:e.text.uiBluePrimary},hoveredStyle:{background:void 0,color:e.text.uiBluePrimary},buttonStyle:{height:32,color:p?e.text.uiBluePrimary:e.text.uiBlueSecondary,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8}})),[p]),y=(0,i.useCallback)((()=>{Pt().Ow({collectionContextStore:u,collectionSettingsStore:u.settingsStore,ref:c}),Pt().dP({collectionSettingsStore:u.settingsStore,item:{type:"formQuestionCreateSettings",area:"form_conditional_modules",parentModuleId:a,parentConditionalGroupId:d},ref:c})}),[u,c,a,d]),f=(0,Wt()._X)({name:"forms_conditional_logic",spaceId:r,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id});return(null==f?void 0:f.upsell)?null:(0,B.jsx)("div",{style:g.container,ref:c,children:(0,B.jsxs)(Dt().p,{onClick:y,onMouseDown:e=>{(0,E().SQ)({event:e,context:E().y$.EditorMouseDown})},style:g.buttonStyle,pressedStyle:g.pressedStyle,hoveredStyle:g.hoveredStyle,children:[(0,kt().b)({...g.plusButton}),(0,B.jsx)("span",{children:(0,B.jsx)(m().sA,{defaultMessage:"Add more questions",id:"FormConditionalLogicModuleRenderer.NestedAddMoreQuestionsButton"})})]})})}const to={transcript:!0,bottomControls:!0,expandedBacklinks:!0,inlinePageSections:!0},oo={editor:!0,discussions:!0};function ro(e){if("editor"===e.type||"viewsMain"===e.type)return{minHeight:"500px"}}const io="16px",no=o(129044).default.createValue(!1,{name:"HEADER_FOCUS_STORE"});function so(e){let{pageModuleId:t,active:o=!1,isDragging:r=!1,area:n,style:l}=e;const{layoutStore:a}=(0,T().LH)(),d=(0,s().K8)((()=>null==a?void 0:a.getModuleById(t)),[a,t]),u=(0,s().K8)((()=>!!d&&(0,c()._)(d)),[d]),m=(0,s().K8)((()=>{var e;return null===(e=a.getModel())||void 0===e?void 0:e.getLayoutType()}),[a]),g=(0,s().K8)((()=>!!d&&(("form"!==m||"placeholder"!==d.type)&&(0,p().i)(d))),[m,d]),y=(0,i.useMemo)((()=>({isSelected:o,isDragging:r,isConfigurable:u,isDraggable:g})),[o,r,u,g]);return d?(0,B.jsx)(Ue,{value:y,children:"form"===m?(0,B.jsx)(uo,{pageModule:d,style:l}):(0,B.jsx)(lo,{pageModule:d,style:l,area:n})}):null}const lo=i.memo(ao);function ao(e){let{pageModule:t,style:r,area:a}=e;const{pageStore:d}=(0,T().bi)(),c=(0,s().K8)((()=>Boolean(d.getCover())),[d]),p=(0,u().Lv)(t).type,m=t.type,g=(0,n().v3)(),v=(0,s().K8)((()=>(0,o(506181).A)({environment:g,store:d,pageViewBlockStore:void 0})),[g,d]),h=(0,l().IS)((()=>{return{wrapper:{...ro(t),opacity:(e=t,!0===(null==oo?void 0:oo[e.type])?"33%":void 0),marginTop:c&&"normalizedTitleWithIcon"===m?"-50px":void 0,...r}};var e}),[c,t,m,r]),x=(0,i.useCallback)((e=>(0,B.jsx)(Xe,{module:t,style:h.wrapper,area:a,children:e})),[t,h.wrapper,a]);if(to[p])return null;switch(m){case"cover":return(0,B.jsx)(po,{wrapper:x,pageStore:d,isEditable:!1},`${t.id}-${d.id}`);case"properties":return(0,B.jsx)(fo,{pageStore:d,wrapper:x,pageModule:t},`${t.id}-${d.id}`);case"viewsMain":case"views":return(0,B.jsx)(P,{wrapper:x,viewsModule:t},`${t.id}-${d.id}`);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_geo_point":return(0,B.jsx)(o(92627).v,{propertyId:t.propertyId,context:C().Rr.Frame,disabled:!0,store:d,pageModule:t,wrapper:x,stackPropertyLabelAndValue:!0},`${t.id}-${d.id}`);case"normalizedTitleWithIcon":return(0,B.jsx)(mo,{wrapper:x,module:t},`${t.id}-${d.id}`);case"editor":return(0,B.jsx)(o(587912).p,{context:C().Rr.Frame,disabled:!0,handlePlaceholderWrapClick:y().lQ,pageBlockStore:d,editorWrapper:x},`${t.id}-${d.id}`);case"discussions":return(0,B.jsx)(o(521869).d,{store:d,wrapper:x,showDefaultTitle:!0,discussionLocation:"page_discussion",pageDiscussionsRenderState:v},`${t.id}-${d.id}`);case"inlinePageSections":return(0,B.jsx)(go,{wrapper:x},`${t.id}-${d.id}`);case"relationsGroup":return(0,B.jsx)(o(851861).z,{pageStore:d,wrapper:x,disabled:!0,context:C().Rr.Frame,showDefaultTitle:!0});case"transcript":case"bottomControls":case"expandedBacklinks":case"deleted_property":return null;case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":throw new Error(`Cannot render ${m} in page layout editor.`);default:(0,f().HB)(m)}}function uo(e){let{pageModule:t,style:o}=e;const n=(0,u().Lv)(t).type,{layoutStore:a,canEditLayout:d}=(0,T().LH)(),{formBlockStore:c,headerFocusStore:p,headerMouseStore:m}=(0,h().cJ)(),y=(0,M().ET)(),v=(0,s().K8)((()=>y.permissionScopesStore.state.canConfigureCollection),[y.permissionScopesStore]),x=(0,i.useCallback)((()=>{m.setState({...m.state,mouseEntered:!0})}),[m]),S=(0,i.useCallback)((()=>{m.setState({...m.state,mouseEntered:!1})}),[m]),b=(0,s().K8)((()=>{var e;const t=null===(e=y.collectionViewBlockStore())||void 0===e?void 0:e.getParentBlockStore();return null==t?void 0:t.getFormatStore().getKeyStore("block_color").getValue()}),[y]),C=(0,s().K8)((()=>"formQuestion"===t.type&&t.conditionalGroups&&t.conditionalGroups.length>0),[t]),_=(0,s().K8)((()=>{var e;return void 0!==(null===(e=a.getModules().form_conditional_modules)||void 0===e?void 0:e[t.id])}),[a,t]),w=(0,l().IS)((e=>({formTitleWrapper:{background:b?(0,g().ed)(b,e).background:void 0}})),[b]);if(to[n])return null;const I=e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Xe,{module:t,style:o,area:_?"form_conditional_modules":"form_layout_schema",children:e}),C&&"formQuestion"===t.type&&(0,B.jsx)($t,{parentModule:t})]}),j=t.type;switch(j){case"formTitle":return I((0,B.jsxs)("div",{style:w.formTitleWrapper,children:[(0,B.jsx)("div",{style:{paddingLeft:io},children:(0,B.jsx)(St().zE,{formBlockStore:c,disabled:!d,formMode:"builder",headerFocusStore:p,onHeaderMouseEnter:x,onHeaderMouseLeave:S})}),(0,B.jsx)(St().Y1,{collectionContextStore:y,formBlockStore:c})]}));case"formQuestion":return I((0,B.jsx)(gt,{layoutStore:a,formQuestionId:t.formQuestionId}));case"formSubmit":return null;case"placeholder":return I((0,B.jsx)(r().P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:_?72:36},transition:{duration:.2},children:_&&(0,B.jsx)(Xt,{})},"placeholderModule"));case"cover":return(0,B.jsx)(po,{wrapper:I,pageStore:c,isEditable:v},t.id);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_geo_point":case"normalizedTitleWithIcon":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"editor":case"transcript":case"properties":case"views":case"viewsMain":case"relationsGroup":case"deleted_property":case"recentActivity":case"collaborators":case"teamspaces":throw new Error("Cannot render these modules in a form.");default:(0,f().HB)(j)}}const co=160;function po(e){const{wrapper:t,pageStore:o,isEditable:r}=e;return(0,s().K8)((()=>Boolean(o.getCover())),[o])?t((0,B.jsx)(bt().f,{store:o,isEditable:r,onMouseEnter:y().lQ,onMouseLeave:y().lQ,paddingX:0,pageCoverHeight:co})):(0,B.jsx)("div",{className:Ye().hg,style:{height:0}})}function mo(e){const{wrapper:t,module:o}=e,{pageStore:r,collectionStore:i}=(0,T().bi)(),n=(0,s().K8)((()=>i.getFormat()),[i]),l=(0,s().K8)((()=>Boolean(r.getCover())),[r]),{backlinksConfiguredToShowAboveTitle:a}=(0,w().X1)({format:n}),d=a?(0,B.jsx)("div",{style:{marginTop:8},children:(0,B.jsx)(L().y,{pageStore:r,customization:{buttonIsLightGray:!0}})}):void 0,u=(0,M().ET)();return t((0,B.jsx)(_t().H,{store:r,context:C().Rr.Frame,isEditable:!1,headerControls:d,hasCover:l,isInSidePeek:!1,headerFocusStore:no,openMenuOnMount:!1,openMenuOnMountCallback:y().lQ,disabled:!0,titlePlaceholder:void 0,collectionContextStore:u,shouldShowTemplatePicker:!1,onTitleChange:y().lQ,onTitleEditText:y().lQ,onTitleEsc:y().lQ,onTitleUntab:y().lQ,onTitleTab:y().lQ,handleHeaderMouseEnter:y().lQ,handleHeaderMouseLeave:y().lQ,isInPageLayoutModuleEditor:!0,layoutModule:o}))}function go(e){const{pageStore:t}=(0,T().bi)(),o=(0,s().K8)((()=>t.getSchema()),[t]),r=(0,s().K8)((()=>(0,b().gV)(t)),[t]),i=(0,s().K8)((()=>{if(!r)return;return(r.collection_page_sections||[]).filter((e=>{const r=o[e.section];if(!r||"relation"!==r.type)return;const i=t.getPropertyValue(e.section),n=(0,a().bG)({relationValue:(0,a().n)(i),propertySchema:r,getRecordModel:t.getRecordModel,includeNoAccess:!0}).length;return"inline"===e.visibility&&o[e.section]&&0!==n})).map((e=>e.section))}),[r,o,t]);return(i??[]).length>0?(0,B.jsx)(Mt().LG,{context:C().Rr.Frame,disabled:!0,inlinePropertyIDs:i,store:t,wrapper:e.wrapper}):(0,B.jsx)(yo,{text:"Inline page sections"})}function yo(e){const t=(0,l().IS)((e=>({text:{fontSize:14,color:"light"===e.mode?e.accentColors.gray[500]:e.accentColors.gray[600]}})),[]);return(0,B.jsx)(Ye().vV,{children:(0,B.jsxs)(S().Ye,{children:[(0,B.jsx)("span",{style:t.text,children:e.text}),(0,B.jsx)(x().A,{content:"Not enabled"})]})})}function fo(e){const{pageModule:t,pageStore:o,wrapper:r}=e,i=(0,n().v3)(),{layoutStore:a}=(0,T().LH)(),u=(0,l().IS)((e=>({empty:{color:e.text.tertiary,fontSize:v().J.UIRegular.desktop,padding:"0 6px"}})),[]),c=(0,s().K8)((()=>{var e;const o=null==a||null===(e=a.getModel())||void 0===e?void 0:e.getRawPageModuleAreaById(t.id);if(o)return(0,d().Fw)(o)}),[a,t.id]),p=(0,s().K8)((()=>!(0,_().g)({environment:i,layoutArea:c,moduleType:t.type,pageViewBlockContext:C().Rr.Frame})),[i,c,t.type]);return(0,B.jsx)(Ct().h,{context:C().Rr.Frame,disabled:!0,store:o,wrapper:r,layoutModule:t,variant:t.variant,customization:{disableContainerPadding:!0,neverShowPropertiesElsewhereInLayout:!0,disableLastRowBottomPadding:!0,stackPropertyLabelAndValue:p,emptyState:(0,B.jsx)("div",{style:u.empty,children:(0,B.jsx)(m().sA,{id:"pageLayout.emptyModule",defaultMessage:"Empty"})})},forceGroupsOpenOrClosed:"open"},`${t.id}-${o.id}`)}},838218:(e,t,o)=>{o.d(t,{A:()=>i});o(725707),o(500234);class r extends(()=>o(151255))().A{findModuleContainer(e){let{layoutStore:t,moduleId:o}=e;return this.find((e=>e.layoutStore===t&&e.moduleId===o))}}const i=new r},911421:(e,t,o)=>{o.d(t,{A:()=>s});var r=()=>o(716605),i=()=>o(34662);class n extends(()=>o(129044))().default{getInitialState(){return{isLoaded:!1}}getFormState(){if(this.state.isLoaded)return this.state}getQuestionError(e){if(this.state.isLoaded)return this.state.formQuestionErrorMap.get(e)}updateFormState(e){this.state.isLoaded&&this.setState({...this.state,...e})}updateFilePropertyIdToFormFiles(e,t){var o;if(!this.state.isLoaded)return;const r=null===(o=this.getFormState())||void 0===o?void 0:o.filePropertyIdToFormFiles;this.updateFormState({filePropertyIdToFormFiles:{...r,[e]:t((null==r?void 0:r[e])??[])}})}updateFormErrorMap(e,t){if(!this.state.isLoaded)return;const n=this.state.collectionSchema;if(!n)return;const s=new Map;for(const c of e){var l,a,d;const e=c.id,p=null===(l=c.getConfig())||void 0===l?void 0:l.propertyId;if(!p)continue;const m=null===(a=this.state.draftFormBlockStore)||void 0===a?void 0:a.getProperties()[p],g=(0,r()._g)({schema:n,property:p});if(g){if(c.isRequired()&&null!==(d=this.state.questionIdsVisibleAtLastSubmissionAttempt)&&void 0!==d&&d.includes(e)){const t=this.state.filePropertyIdToFormFiles;if("file"===g.type){var u;if(((null===(u=t[p])||void 0===u?void 0:u.length)??0)<1){s.set(e,"required");continue}}else if("checkbox"===g.type){if(!0!==(0,r().wu)(m)){s.set(e,"required");continue}}else if((0,i().w9s)(m)){s.set(e,"required");continue}}if(!(0,i().w9s)(m)){const r=(0,i().q4_)(m);if("number"===g.type&&!(0,o(361308).kf)(r,t)){s.set(e,"invalid_number");continue}if("email"===g.type&&!(0,o(599932).DT)(r)){s.set(e,"invalid_email");continue}if("url"===g.type&&!(0,o(215458).w)(r)){s.set(e,"invalid_url");continue}if("phone_number"===g.type&&!(0,o(298028).e)(r)){s.set(e,"invalid_phone_number");continue}}}}this.updateFormState({formQuestionErrorMap:s})}}const s=n}}]);