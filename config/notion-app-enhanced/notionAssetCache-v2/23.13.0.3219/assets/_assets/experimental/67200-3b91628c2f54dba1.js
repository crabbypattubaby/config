"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67200],{63108:(e,t,s)=>{s.d(t,{_:()=>m,a:()=>p});s(242343);var i=()=>s(803290),r=()=>s(174114),n=()=>s(409211),a=()=>s(653998),o=()=>s(485966),l=()=>s(413871),c=()=>s(59279),d=()=>s(482570),u=s(163643);function m(e){let{userId:t}=e;const s=(0,a().tz)(),m=(0,r().IS)((e=>({iconStyle:{color:e.text.tertiary,fontWeight:500}})),[]),g=(0,i().K8)((()=>{const e=o().default.state.currentSpaceStore;if(!e)return;const i=l().LU.createChildStore(e,{table:n().oo,id:t});return{userStore:i,isReady:i.isReady(),userName:i.getDisplayName(s),userEmail:i.getEmail()}}),[t,s]);return null!=g&&g.isReady?(0,u.jsx)(c().s7,{useThinTitle:!0,title:g.userName,byline:g.userEmail,icon:(0,u.jsx)(d().A,{size:28,userStore:g.userStore,iconStyle:m.iconStyle})}):(0,u.jsx)(p,{})}function p(e){const t=(0,r().IS)((()=>({icon:{borderRadius:"100%",height:e.iconSize??28,width:e.iconSize??28,marginLeft:-4}})),[e.iconSize]);return(0,u.jsx)(c().mf,{includeByline:!0,includeIcon:!0,iconStyles:t.icon})}},64256:(e,t,s)=>{s.d(t,{BY:()=>h,Lg:()=>y,id:()=>w,nE:()=>_,xi:()=>S});s(362833),s(725707),s(324989),s(403517);var i=()=>s(502140),r=()=>s(707781),n=()=>s(446588),a=()=>s(647242),o=()=>s(818369),l=()=>s(919536),c=()=>s(575015),d=()=>s(477784),u=()=>s(485966),m=()=>s(436622),p=()=>s(138385),g=()=>s(133926),v=()=>s(307542),f=()=>s(814059);async function h(e){const{environment:t,spaceStore:s,contextualInviteStore:i}=e;!function(e){const{spaceStore:t,contextualInviteStore:s}=e,i=t.getRole();if(!i||!(0,n().NB)(i))return!1;if(!s.hasGuests())return!1;if(t.getDisableMembershipRequests())return!1;return(0,v().x3)()}({environment:t,spaceStore:s,contextualInviteStore:i})?await async function(e){const{spaceStore:t,contextualInviteStore:s,environment:i}=e,r=t.getRole();if(!r||!(0,n().vp)(r))return!1;if(!s.hasGuests())return!1;return await(0,g().Se)(i,{name:"members",spaceId:t.id,userId:t.userId,amount:1})}({environment:t,spaceStore:s,contextualInviteStore:i})?i.startWorkspaceInvite():i.setState({...i.state,inviteStage:p().d5.closed}):i.startRequestMembership()}async function y(e){const{environment:t,spaceStore:s,contextualInviteStore:r,from:n,intl:a}=e,{selection:o,flowId:d}=r.state;if("page_guest"===o||!r.hasGuests())return r.reset(),!1;const{inviteTargets:u,unknownEmails:m}=await x({environment:t,contextualInviteStore:r}),p={...r.state};r.reset();const v=await(0,g().Se)(t,{name:"non_admin_members",spaceId:s.id,userId:s.userId})?e.inviteRole??"read_and_write":"editor";try{await l().eP({environment:t,store:s,inviteTargets:u,inviteRole:v,isOnboarding:!1,invite:{inviteOrigin:n,inviteFlowId:d,disable_invite_email:!0}})}catch(f){return function(e,t){if(0===t.length)return;c().D6({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"{userCount, plural, one {Failed to invite {users} as member} other {Failed to invite {users} as members}}"},{users:w(t,e),userCount:t.length})})}(a,p.invitedUsers),i().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{...p,inviteTargets:u}}}),!1}finally{m.length&&i().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.unknownUserId",data:{miscDataToConvertToString:{...p,unknownEmails:m}}})}return!0}async function S(e){const{environment:t,spaceStore:s,originId:r,originType:n,reasonMessage:a,contextualInviteStore:l,intl:d}=e,{selection:u}=l.state;if("page_guest"===u||!l.hasGuests())return l.reset(),!1;const{inviteTargets:m,unknownEmails:p}=await x({environment:t,contextualInviteStore:l}),g={...l.state};l.reset();const v=[];try{const e=m.map((e=>o().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:e.value.id,spaceId:s.id,message:a,attributes:{origin_id:r,origin_type:n,origin_table:"share_menu"===n?"block":"space",add_permissions_on_approval:!1}}}).catch((()=>v.push(e)))));await Promise.all(e)}catch(f){return function(e,t){if(0===t.length)return;c().D6({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members"},{users:w(t,e)})})}(d,g.invitedUsers),i().log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.inviteTargets",data:{miscDataToConvertToString:{...g,inviteTargetsWithErrors:v}}}),!1}finally{p.length&&i().log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.unknownUserId",data:{miscDataToConvertToString:{...g,unknownEmails:p}}})}return!0}async function x(e){const{environment:t,contextualInviteStore:s}=e,{invitedEmailToUserIdMap:i}=s.state,r=[],n=[];for(const a of s.state.invitedUsers){if(!a.isGuest)continue;const e=await b(t,a,i);e?r.push({type:"existingUser",value:{id:e,email:a.email,version:1}}):n.push(a.email)}return{inviteTargets:r,unknownEmails:n}}async function b(e,t,s){const i=await async function(e,t,s){let i=t.id;if(i||(i=s[t.email]),!i){const s=await o().callApi({eventName:"findUser",environment:e,data:{email:t.email}});if("failed"!==s.type){const e=s.data;e.value&&(i=e.value.value.id)}}return i}(e,t,s);if(i)return i;const n=(0,r().H)(d().A.getIntl()),a=await o().callApi({eventName:"createEmailUser",environment:e,data:{email:t.email,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:n}});return"failed"!==a.type?a.data.userId:void 0}function w(e,t){return(0,f().l)(e.flatMap((e=>e.email||[])))}function _(e,t){var s;const{state:i}=t,r=null===(s=u().default.state.currentSpaceStore)||void 0===s?void 0:s.id,n=r?(0,a().AI)(m().A.getData(e,{spaceId:r})):void 0,o=t.getGuestEmails();return{invite_flow_id:i.flowId,user_count:o.length,user_emails:o,invite_space_role_selection:i.selection,is_bot:!1,subscription_tier:n}}},93004:(e,t,s)=>{s.d(t,{P:()=>a});var i=()=>s(21164),r=()=>s(818369),n=()=>s(413871);async function a(e){const{environment:t,teamStore:s}=e,a=null==s?void 0:s.getSpaceId(),o=s&&a&&{id:s.id,table:i().Vl,spaceId:a},l=s&&o&&n().md.createChildStore(s,o),c=l&&l.isReady()&&!l.isDefined()&&l.canEdit();if(s&&a&&l&&c){const e=await r().callApi({eventName:"createCollectionViewBlockForPosts",environment:t,data:{spaceId:a,teamId:s.id}});if("failed"===e.type)throw e.error;if("success"===e.type){const{collectionViewBlockId:t}=e.data;return t}}}},127776:(e,t,s)=>{s.d(t,{Vs:()=>M,gj:()=>A,hX:()=>k,oH:()=>j,v4:()=>C});s(610931);var i=()=>s(488587),r=()=>s(502140),n=()=>s(427091),a=()=>s(214144),o=()=>s(218357),l=()=>s(412527),c=()=>s(779470),d=()=>s(34662),u=()=>s(539174),m=()=>s(818369),p=()=>s(649334),g=()=>s(84543),v=()=>s(477784),f=()=>s(213124),h=()=>s(904697),y=()=>s(513060),S=()=>s(196387),x=()=>s(320462),b=()=>s(485966),w=()=>s(413871),_=()=>s(810733),I=()=>s(93004),T=()=>s(628854);async function A(e){let{environment:t,name:s,description:i,icon:r,accessLevel:n,isDefault:a,flowId:l,createTeamHome:c,teamPermissionRole:d,spacePermissionRole:p,members:g,settings:v}=e;const{currentSpaceStore:f}=b().default.getState();if(!f)throw new Error("currentSpaceStore does not exist");const h=S().default.mark("client_create_team_latency"),y=f.id,x=await m().callApi({eventName:"createTeam",environment:t,data:{spaceId:y,name:s,description:i,icon:r,isDefault:a,accessLevel:n,teamPermissionRole:d,spacePermissionRole:p,members:g,settings:v}});if("failed"===x.type)return void(0,T().O)(x);const{teamId:_}=x.data,A=w().h4.createChildStore(f,{table:o().yK,id:_,spaceId:y});return await A.load(),(0,I().P)({environment:t,teamStore:A}),c&&P({environment:t,teamStore:A}),u()._P(t,{store:A,flowId:l}),S().default.measure(h,{environment:t}),A}function M(e){var t;let{environment:s,page:i}=e;const r=a().JW(),n=(null===(t=i.getParentPointer())||void 0===t?void 0:t.table)!==o().yK?"page_to_team_nested":"page_to_team";u().H8(s,{from:n,flowId:r}),_().A.setState({open:!0,pageStore:i,flowId:r})}async function C(e){var t;let{environment:s,page:i,flowId:r,intl:a}=e;const{accessLevel:l,spacePermissionRole:c,teamPermissionRole:u,members:m}=(0,h().getAccessLevelAndPermissionsForTeamCreatedFromPage)(i),p=(i.isDefined()?i.getModel().getRenderTitle({intl:a,userTimeZone:(0,n().P)(),getRecordModel:i.getRecordModel}):void 0)??d().q4_(i.getTitleValue()),v=await A({environment:s,name:p,icon:null===(t=i.getIcon())||void 0===t?void 0:t.icon,accessLevel:l,isDefault:!1,description:"",flowId:r,createTeamHome:!1,teamPermissionRole:u,spacePermissionRole:c,members:m});if(!v)return;const{currentSpaceViewStore:f}=b().default.state;if(!f)return;const S=await(0,y().U)();g().createAndCommit({userAction:"teamActions.movePageToCreatedTeam",environment:s,canUndo:!0,perform:e=>{S({environment:s,currentSpaceViewStore:f,transaction:e,teamStore:v,action:"move",value:{type:o().yK,id:v.id},targets:[i],location:{type:"append"}})}}),(0,T().F2)({environment:s,teamId:v.id,tab:x().p.Members,from:"create_team_from_page"}),await new Promise((e=>setTimeout((()=>(0,T().Mh)({teamStore:v,environment:s})),100)))}async function j(e){let{environment:t,name:s,description:i,icon:r,flowId:n,trackCreateTeamComplete:a}=e;const{currentSpaceStore:l}=b().default.getState();if(!l)throw new Error("currentSpaceStore does not exist");const c=l.id,d=await m().callApi({eventName:"enableTeams",environment:t,data:{spaceId:c,defaultTeamName:s,defaultTeamIcon:r,defaultTeamDescription:i}});if("failed"===d.type)return void(0,T().O)(d);const{teamId:p}=d.data,g=w().h4.createChildStore(l,{table:o().yK,id:p,spaceId:c});return await g.load(),await P({environment:t,teamStore:g}),u().b0(t,{spaceId:c,store:g,flowId:n}),a&&p&&u()._P(t,{store:g,flowId:n}),g}async function k(e){var t;let{environment:s,teamStore:r,from:n,buttonPopupStore:o}=e;if(!s.currentUser.id)return!1;const l=a().JW(),c=r.isDefault(),d=r.getTeamAccessLevel();if(c)return!1;const m=r.getName(),p=await A({environment:s,name:(0,i().Q)(m||""),description:"",icon:r.getRawIcon(),accessLevel:d,isDefault:c,createTeamHome:!0,teamPermissionRole:null===(t=r.getTeamPermission())||void 0===t?void 0:t.role,spacePermissionRole:r.getSpacePermissionRole(),members:[],settings:r.getSettings(),flowId:l});return!!p&&(u().KK(s,{store:p,from:n}),(0,T().L0)({environment:s,teamStore:p,shouldScroll:!0}),(0,T().F2)({environment:s,teamId:p.id,tab:x().p.General,from:"duplicate_team",buttonPopupStore:o}),new Promise((e=>setTimeout(e,500))).then((()=>{(0,f().jH)(m)})),!0)}async function P(e){const{environment:t,teamStore:s}=e,i=b().default.state.currentSpaceStore,n=b().default.state.currentSpaceViewStore;if(!i||!n)return r().log({level:"error",from:"teamActions",type:"createHomepageOnTeamCreation-SpaceOrSpaceViewStoreError"}),!1;const a=(o=v().A.getIntl(),(0,c().B)(l().wA.teamsHomepage,o));var o;return!!(await p().createTemplateInstance({environment:t,item:a,spaceStore:i,spaceViewStore:n,useMinimalTemplates:!1,type:"inTeam",teamStore:s,from:"homepage_team",isOnboarding:!1}))||(r().log({level:"error",from:"teamActions",type:"createHomepageOnTeamCreation-PageNotCreated"}),!1)}},138385:(e,t,s)=>{s.d(t,{Ay:()=>a,NJ:()=>i,d5:()=>r});s(725707),s(491955),s(403517),s(113085);let i=function(e){return e.unselected="unselected",e.workspace_member="workspace_member",e.request_workspace_member="request_workspace_member",e.page_guest="page_guest",e.closed="closed",e}({}),r=function(e){return e[e.closed=0]="closed",e[e.share_page=1]="share_page",e[e.share_workspace=2]="share_workspace",e[e.request_workspace=3]="request_workspace",e}({});class n extends(()=>s(129044))().default{getInitialState(){return{inviteStage:r.closed,selection:i.workspace_member,order:[i.workspace_member,i.page_guest],invitedUsers:[],invitedEmailToUserIdMap:{},flowId:s(214144).JW()}}startWorkspaceInvite(){this.setState({...this.state,inviteStage:r.share_workspace,order:[i.workspace_member,i.page_guest],selection:i.workspace_member})}startRequestMembership(){this.setState({...this.state,inviteStage:r.request_workspace,order:[i.request_workspace_member,i.page_guest],selection:i.request_workspace_member})}hasGuests(){return this.state.invitedUsers.some((e=>e.isGuest))}getGuestEmails(){return this.state.invitedUsers.filter((e=>e.isGuest)).map((e=>e.email))}}const a=n},150957:(e,t,s)=>{s.d(t,{A:()=>h,v:()=>f});var i=s(242343),r=()=>s(803290),n=()=>s(850313),a=()=>s(518797),o=()=>s(409211),l=()=>s(653998),c=()=>s(76394),d=()=>s(951156),u=()=>s(35462),m=()=>s(482570),p=()=>s(485966),g=s(163643);function v(e){const{actorStore:t,avatar:s,isLarge:i}=e,r=i?32:28;return t?t.table===a().GP?(0,g.jsx)(d().A,{botStore:t,size:r}):t.table===o().oo?(0,g.jsx)(m().A,{userStore:t,size:r}):t.table===n().yj?(0,g.jsx)(m().A,{userStore:void 0,size:r}):void(0,c().HB)(t):s?(0,g.jsx)(m().A,{avatar:s,size:r}):(0,g.jsx)(m().A,{userStore:void 0,size:r})}function f(e){return"membership_admin"===e?"membership_admin":"editor"===e||"admin"===e?"admin":"none"===e||"guest"===e?"guest":"team_level_guest"===e?"team_level_guest":void("member"!==e&&"read_and_write"!==e&&"no_access"!==e&&"not_in_space"!==e&&e&&(0,c().HB)(e))}const h=function(e){const t=(0,l().tz)(),{actorStore:n,avatar:a,containerStyle:c,id:d,spaceRole:m,avatarBadge:f,caption:h,isLarge:y,restorationStatus:S,hideRolePill:x}=e,b=!x&&("admin"===m||"membership_admin"===m),w="guest"===m||"team_level_guest"===m,_=!x&&w,I=(0,r().K8)((()=>n?n.getDisplayName(t):null==a?void 0:a.name),[n,a,t]),T=(0,r().K8)((()=>{const{currentUserStore:e}=p().default.state;return!!e&&(!!n&&e.id===n.id)}),[n]),A=(0,s(174114).IS)((e=>({titleYouIndicator:{color:e.text.secondary}})),[]),M=(0,r().K8)((()=>Boolean(h)?h:n?n.getDetail():null==a?void 0:a.email),[h,n,a]),C=(0,r().O$)(p().AppStoreCurrentSpaceStore),j=(0,r().K8)((()=>(0,s(268117).FI)()),[]),[k,P]=(0,i.useState)(!1);return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:y?"unset":300,marginLeft:y&&!j?2:0,...c},children:[(0,g.jsxs)("div",{style:{position:"relative",...!y&&{height:28,width:28}},children:[(0,g.jsx)(v,{actorStore:n,avatar:a,isLarge:y}),f]}),(0,g.jsxs)("div",{style:{minWidth:0,marginLeft:y?10:6,marginRight:y?10:6},children:[(0,g.jsxs)("div",{id:d,style:{display:"flex",gap:4},children:[(0,g.jsx)(u().A,{children:T?(0,g.jsx)(l().sA,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:I,youIndicatorText:e=>(0,g.jsx)("span",{style:A.titleYouIndicator,children:e})}}):I}),b&&(0,g.jsx)(s(829182).A,{role:m}),_&&(0,g.jsx)(s(781007).Q,{labelType:m,shouldUseTabStyle:j}),C&&S&&(0,g.jsx)(s(614434).A,{spaceStore:C,restorationStatus:S,didAttemptRecovery:k})]}),(0,g.jsx)(u().A,{isSmall:!0,style:{display:"flex"},children:(0,g.jsx)(u().A,{isSmall:!0,children:M})})]}),!w&&!k&&C&&(null==n?void 0:n.table)===o().oo&&I&&"canBeRestored"===(null==S?void 0:S.status)&&(0,g.jsx)(s(726623).A,{userStore:n,spaceId:C.id,onSubmit:()=>P(!0)})]})}},151258:(e,t,s)=>{s.d(t,{Ay:()=>p,mI:()=>u,vb:()=>m});s(242343);var i=()=>s(174114),r=()=>s(752903),n=()=>s(388732),a=()=>s(653998),o=()=>s(31448),l=()=>s(126451),c=s(163643);const d=(0,a().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),u=r().NY,m={[r().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[r().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[r().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:16},[r().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[r().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[r().NY.Inline]:{height:20,fontSize:14,closeIconSize:8,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[r().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:10,avatarSize:20}};function p(e){let{avatarSize:t,format:s,isSingle:r,onClickRemove:u,renderAvatar:p,showRemoveButton:g,shouldShrink:v,style:f,title:h}=e;const y=(0,a().tz)(),{height:S,fontSize:x,margin:b,marginEditState:w,closeIconSize:_,avatarSize:I}=m[s],T=t??I,A=(0,i().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:v?1:0,minWidth:0,height:S,borderRadius:6,fontSize:x,lineHeight:"120%",margin:r?0:g?w:b,...f}})),[x,S,r,b,w,v,g,f]);return(0,c.jsxs)("div",{style:A.root,children:[null==p?void 0:p(T),(0,c.jsx)("div",{className:"notranslate",style:{...o().RC},children:h}),g?(0,c.jsx)(l().A,{ariaLabel:void 0!==h?y.formatMessage(d.removeTokenLabel,{title:h}):y.formatMessage(d.removeTokenLabelGeneric),onClick:u,style:{display:"flex",alignItems:"center",justifyContent:"center",width:S,height:S,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,n().l)({width:_,height:_,opacity:.5})}):null]})}},190230:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(129044))().default{getInitialState(){return{disablePublicAccess:!1,disableGuests:!1,disableMoveToSpace:!1,disableExport:!1,disableSpacePageEdits:!1,disablePublicAccessRequests:!1,disableTeamCreation:!1,disableMembershipRequests:!1,disableExternalMembershipRequests:!1,disableGuestMembershipRequests:!1,disableMemberUpgradeRequests:!1,enableGuestInviteRequests:!1,disableTeamGuests:!1,disableGuestsModalOpen:!1,enableAiTraining:!1,zeroRetentionEnabled:!1}}getValueForSpace(e){if(e.isDefined())return{disablePublicAccess:Boolean(e.getDisablePublicAccess()),disableGuests:Boolean(e.getDisableGuests()),disableMoveToSpace:Boolean(e.getDisableMoveToSpace()),disableExport:Boolean(e.getDisableExport()),disableSpacePageEdits:Boolean(e.getDisableSpacePageEdits()),disablePublicAccessRequests:Boolean(e.getDisablePublicAccessRequests()),disableTeamCreation:Boolean(e.getDisableTeamCreation()),disableMembershipRequests:Boolean(e.getSetting("disable_membership_requests")),disableExternalMembershipRequests:Boolean(e.getSetting("disable_external_membership_requests")),disableGuestMembershipRequests:Boolean(e.getSetting("disable_guest_membership_requests")),enableGuestInviteRequests:Boolean(e.getSetting("enable_guest_invite_requests")),disableTeamGuests:Boolean(e.getSetting("disable_team_guests")),enableAiTraining:Boolean(e.getSetting("enable_ai_training")),zeroRetentionEnabled:Boolean(e.getSetting("zero_retention_enabled")),disableMemberUpgradeRequests:Boolean(e.getSetting("disable_member_upgrade_requests"))}}}const r=i},199557:(e,t,s)=>{s.d(t,{n:()=>y});s(725707),s(491955),s(403517);var i=s(242343),r=()=>s(237385),n=()=>s(803290),a=()=>s(409211),o=()=>s(653998);class l{constructor(e){this.rowsStore=new c,this.sort=void 0,this.filter=void 0,this.abortController=void 0,this._isFetching=!1,this.rowsStore.setState({rows:e,hasMore:!0})}async _maybeFetch(){if(!this._isFetching){this._isFetching=!0;try{return await this.fetch()}finally{this._isFetching=!1}}}async loadMore(){const e=await this._maybeFetch();e&&this.rowsStore.setState({rows:[...this.rowsStore.getState().rows??[],...e.rows??[]],hasMore:e.hasMore})}async setSort(e){this.sort=e,await this.refresh()}async setFilter(e){this.filter=e,await this.refresh()}async refresh(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this._isFetching=!1;const t=await this._maybeFetch();t&&this.rowsStore.setState({rows:t.rows,hasMore:t.hasMore})}}class c extends(()=>s(129044))().default{getInitialState(){return{rows:void 0,hasMore:!0}}}class d extends l{constructor(e){const{users:t,initialMembershipFilter:s,initialSort:i,initialQuery:r,limit:n}=e;super([]),this._allUsers=void 0,this._filteredAndSortedUsers=[],this._currentPage=0,this._limit=void 0,this._query=void 0,this._allUsers=[...t],this._limit=n??20,this._query=void 0,this.filter=s,this.sort=i,this._query=r,this._updateFilteredAndSortedUsers()}_updateFilteredAndSortedUsers(){let e=this._applyMembershipFilter(this._allUsers);this._query&&(e=this._applySearch(e)),this.sort&&(e=this._applySort(e)),this._filteredAndSortedUsers=e}_applyMembershipFilter(e){return this.filter?e.filter((e=>"members"===this.filter?"member"===e.membership_type||"owner"===e.membership_type||"membership_admin"===e.membership_type:"guests"!==this.filter||"page_guest"===e.membership_type)):e}_applySearch(e){return this._query&&0!==this._query.length?(0,s(188877).Ay)(this._query,e,(e=>[e.name,e.email].filter(Boolean).join(" "))):e}_applySort(e){if(!this.sort)return e;const{field:t,direction:s}=this.sort,i="asc"===s?1:-1,r=e.map((e=>{let s,i;switch(t){case"name_normalized":s=this._normalizeName(e.name)||e.email.toLowerCase();break;case"type":s=this._getMembershipTypeRank(e.membership_type),i=this._normalizeName(e.name)||e.email.toLowerCase();break;case"first_joined":s=e.first_joined_space_time||0;break;default:s=null}return{user:e,sortValue:s,secondarySortValue:i}}));return r.sort(((e,s)=>{if(null===e.sortValue&&null===s.sortValue);else{if(null===e.sortValue)return Number(i);if(null===s.sortValue)return-1*i;if(e.sortValue<s.sortValue)return-1*i;if(e.sortValue>s.sortValue)return Number(i)}if("type"===t&&e.secondarySortValue&&s.secondarySortValue){if(e.secondarySortValue<s.secondarySortValue)return-1;if(e.secondarySortValue>s.secondarySortValue)return 1}return(e.user.id<s.user.id?-1:1)*i})),r.map((e=>e.user))}_normalizeName(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}_getMembershipTypeRank(e){switch(e){case"owner":return 5;case"membership_admin":return 4;case"member":return 3;case"page_guest":return 2;case"none":return 1;default:return 0}}async setUsers(e){this._allUsers=[...e],this._updateFilteredAndSortedUsers(),await this.refresh()}async setFilter(e){this.filter!==e&&(this._currentPage=0,this.filter=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._currentPage=0,this.sort=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._currentPage=0,this._updateFilteredAndSortedUsers(),await this.refresh())}async fetch(){const e=this._currentPage*this._limit,t=e+this._limit,s=this._filteredAndSortedUsers.slice(e,t),i=t<this._filteredAndSortedUsers.length;return Promise.resolve({rows:s,hasMore:i})}async loadMore(){this._currentPage++,await super.loadMore()}async refresh(){this._currentPage=0,await super.refresh()}TEST_ONLY_setLimit(e){this._limit=e}}class u extends l{constructor(e){let{users:t,environment:s,spaceId:i,initialMembershipFilter:r,initialSort:n,initialQuery:a,limit:o}=e;super(t),this._spaceId=void 0,this._environment=void 0,this._cursor=void 0,this._limit=void 0,this._query=void 0,this._environment=s,this._limit=o??20,this._cursor=void 0,this._query=void 0,this._spaceId=i,this.filter=r,this.sort=n,this._query=a,this.refresh()}async setFilter(e){this.filter!==e&&(this._cursor=void 0,this.filter=e,await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._cursor=void 0,this.sort=e,await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._cursor=void 0,await this.refresh())}async refresh(){this._cursor=void 0,await super.refresh()}async fetch(){var e,t;const{callApi:i}=await Promise.resolve().then(s.bind(s,818369));this.abortController=new AbortController;const r=await i({eventName:"listUsers",environment:this._environment,data:{cursor:this._cursor,membershipFilter:this.filter,limit:this._limit,sort:null===(e=this.sort)||void 0===e?void 0:e.field,sortDirection:null===(t=this.sort)||void 0===t?void 0:t.direction,query:this._query,spaceId:this._spaceId},abortSignal:this.abortController.signal});if(this.abortController=void 0,"success"===r.type)return this._cursor=r.data.nextCursor,{rows:r.data.users,hasMore:r.data.hasMore}}}var m=()=>s(985532),p=()=>s(413871),g=()=>s(111826),v=()=>s(305043),f=()=>s(997310),h=()=>s(931371);function y(e){const{query:t,filter:s,limit:l,disable:c,sort:y}=e,x=(0,n().O$)(v().subscriptionDataStoreInstance),b=(0,n().K8)((()=>m().A.state.shouldUseEdgeCache),[]),w=(0,o().tz)(),_=(0,f().r)(),I=(0,r().v3)(),T=(0,n().K8)((()=>{if(c||b||!x||!_)return[];return g().Be(x).map((e=>{var t,s;const i=p().LU.createChildStore(_,{table:a().oo,id:e.userId}),r=(0,h().dp)(_,e.userId);return{id:e.userId,email:i.getEmail()||"",space_id:_.id,name:i.getDisplayName(w),profile_photo:null===(t=i.getModel())||void 0===t?void 0:t.profile_photo,membership_type:r.getMembershipType(),onboarding_completed:null===(s=i.getModel())||void 0===s?void 0:s.onboarding_completed,first_joined_space_time:S(e)}}))}),[c,b,x,_,w]),A=(0,i.useMemo)((()=>c?void 0:b&&_?new u({users:void 0,environment:I,spaceId:_.id,initialMembershipFilter:s,initialSort:y,initialQuery:t,limit:l}):new d({users:T,initialMembershipFilter:s,initialSort:y,initialQuery:t})),[c,b,_,I]);return(0,i.useEffect)((()=>{A instanceof d&&A.setUsers(T)}),[A,T]),(0,i.useEffect)((()=>{null==A||A.setSort(y)}),[A,y]),(0,i.useEffect)((()=>{null==A||A.setQuery(t)}),[A,t]),(0,i.useEffect)((()=>{null==A||A.setFilter(s)}),[A,s]),A}function S(e){return"firstJoinedSpaceTime"in e?e.firstJoinedSpaceTime??Date.now():Date.now()}},235843:(e,t,s)=>{s.d(t,{Ah:()=>U,D6:()=>E,KW:()=>j,Oo:()=>C,Pp:()=>z,St:()=>R,hQ:()=>L,iS:()=>P,kW:()=>k,l5:()=>M,lf:()=>N});s(610931),s(362833),s(333225),s(494367),s(516262),s(573119),s(240480),s(950443),s(619601),s(725707),s(491955),s(771702),s(403517);var i=()=>s(599932),r=()=>s(446588),n=()=>s(145017),a=()=>s(528762),o=()=>s(975392),l=()=>s(23371),c=()=>s(76394),d=()=>s(919536),u=()=>s(64256),m=()=>s(352723),p=()=>s(861095),g=()=>s(360482),v=()=>s(904697),f=()=>s(509484),h=()=>s(485966),y=()=>s(436622),S=()=>s(138385),x=()=>s(836331),b=()=>s(714604),w=()=>s(413871),_=()=>s(943066),I=()=>s(127776),T=()=>s(528643),A=()=>s(818369);async function M(e){const{environment:t,store:s,sudoModeStore:o,permissionsInviteStore:l,onInviteStart:u,contextualInviteStore:v,inviteOrigin:f}=e,{tokenQuery:h}=l.state;if((0,i().DT)(h.trim())&&(l.state.isInviteTargetsEmpty||!(0,b().qs)(l.state))){const e={type:"newUser",value:{email:h.trim()},source:"email"};p().mQ({target:e,permissionsInviteStore:l})||l.setState({...l.state,inviteTargets:[...l.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}if(!l.state.isInviteTargetsEmpty&&l.state.inviteTargets.length>0){null==u||u();const e=l.state;if((0,b().qs)(e)){if(e.table===n().ev){if(!(0,g()._p)(s))throw new Error("Table mismatch.");const{inviteTargets:i,flowId:r,emailMessage:n}=e;l.reset();const a=await d().eP({environment:t,store:s,sudoModeStore:o,inviteTargets:i,inviteRole:void 0,isOnboarding:!1,invite:{inviteFlowId:r,inviteMessage:n,inviteOrigin:f}});return{success:a.success,requestedUserCount:a.success?Object.keys(a.requestedUsers).length:0}}if(e.table===a().NX){if(!(0,g().Yu)(s))throw new Error("Table mismatch.");const{inviteTargets:i,inviteRole:r,flowId:n}=e;l.reset();return{success:(await d().eP({environment:t,store:s,sudoModeStore:o,inviteTargets:i,inviteRole:r,isOnboarding:!1,invite:{inviteFlowId:n,inviteOrigin:f}})).success,requestedUserCount:0}}(0,c().HB)(e)}else{const{inviteRole:i,flowId:n,emailMessage:a}=e;l.reset();const c=await(0,m().hb)(s,e.inviteTargets);if((0,r().PW)(i)){const e=await d().eP({environment:t,store:s,sudoModeStore:o,inviteTargets:c,inviteRole:i,isOnboarding:!1,invite:{inviteFlowId:n,inviteMessage:a,inviteOrigin:f}});return e.success&&(null==v||v.setState({...null==v?void 0:v.state,invitedEmailToUserIdMap:e.invitedUsers})),{success:e.success,requestedUserCount:e.success?Object.keys(e.requestedUsers).length:0}}if((0,g().$R)(s)&&(0,b().nV)(e)){return{success:await d().sQ({environment:t,store:s,inviteTargets:e.inviteTargets,inviteRole:i,createNewTeamFlowId:n}),requestedUserCount:0}}}}return{success:!0,requestedUserCount:0}}function C(e){e.permissionsInviteStore.setState({...e.permissionsInviteStore.state,modalOpen:!1,flowId:void 0})}function j(e){const{permissionsInviteStore:t,contextualInviteStore:s}=e;if(!s)return;const i=[];t.state.inviteTargets.forEach((e=>{if("newUser"===e.type)i.push({email:e.value.email,isGuest:!0});else if("existingUser"===e.type){const t={...e.value,email:e.value.email,isGuest:"none"===e.spaceRole||"not_in_space"===e.spaceRole};i.push(t)}})),s.setState({...s.state,invitedUsers:i})}async function k(e){const{environment:t,store:s,sudoModeStore:i,permissionsInviteStore:r,contextualInviteStore:n,onInviteClick:o,onInviteComplete:l,inviteOrigin:c,intl:d}=e,m=s.getSpaceId(),p=new(w().SL)(t,{table:a().NX,id:m}),g=m?await y().A.awaitData(t,{spaceId:m}):void 0;if((null==n?void 0:n.state.selection)===S().NJ.workspace_member&&p&&(0,v().isEligibleToCreateTeamspace)(t,g)){if(!(await I().oH({environment:t,flowId:r.state.flowId||"",trackCreateTeamComplete:!1})))return;j({permissionsInviteStore:r,contextualInviteStore:n}),await(0,u().Lg)({environment:t,spaceStore:p,contextualInviteStore:n,from:c,intl:d})}else j({permissionsInviteStore:r,contextualInviteStore:n});let f={success:!1,requestedUserCount:0};try{f=await M({environment:t,store:s,sudoModeStore:i,permissionsInviteStore:r,contextualInviteStore:n,onInviteStart:()=>{null==o||o()},inviteOrigin:c})}catch(h){}finally{null==l||l(f.success,f.requestedUserCount)}}async function P(e){const{environment:t,permissionsInviteStore:s,from:i}=e;await p().iQ({environment:t,permissionsInviteStoreState:s.state,from:i})||s.reset()}function R(e){const{permissionsInviteStore:t,targetToRemove:s,defaultRoleForNonBot:i}=e;if(!t.state.isInviteTargetsEmpty)if((0,b().qs)(t.state))if((0,b().qs)(t.state)){const e=t.state.inviteTargets.filter((e=>e!==s));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:i,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}else(0,c().HB)(t.state);else{const e=t.state.inviteTargets.filter((e=>e!==s));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:i,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}}function E(e){const{environment:t,onUpgradeButtonClick:s,upgradeButtonName:i}=e;_().K(t,{from:i,upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}}),null==s||s()}async function U(e,t){const s=new Set(t),i=Array.from(s).map((async t=>{const s=await A().callApi({eventName:"findUser",environment:e,data:{email:t}});if("success"===s.type){const e=s.data;if(e.value){return{type:"existingUser",value:e.value.value}}}return{type:"newUser",value:{email:t},source:"email"}}));return await Promise.all(i)}async function z(e){const t="invitee",{environment:s,permissionsInviteStore:r,event:n}=e;if(!r.state.isInviteTargetsEmpty&&(0,b().qs)(r.state)){const e=n.target.value;r.setState({...r.state,inputFocus:t,tokenQuery:e})}else{const e=n.target.value,{extractedEmails:a,newInputValue:o}=(0,i().Ct)(e),l=(await U(s,a)).filter((e=>!p().mQ({target:e,permissionsInviteStore:r}))),c=[...r.state.inviteTargets,...l];c.length>0?r.setState({...r.state,inviteTargets:c,isInviteTargetsEmpty:!1,inputFocus:t,tokenQuery:o}):r.setState({...r.state,inviteTargets:[],isInviteTargetsEmpty:!0,inputFocus:t,tokenQuery:o})}}function N(e){const{environment:t,newRole:s,permissionsInviteStore:i}=e,{state:r}=i;T().Jy(t,{...p().oX(t,r),invite_updated_role:s}),!r.isInviteTargetsEmpty&&(0,b().qs)(r)||i.setState({...r,inviteRole:s})}async function L(e){var t;const{query:s,environment:i,sectionLimit:r,intl:n,membersOnly:a,importContactType:c,shouldUseEdgeCacheRollout:d}=e,{currentSpaceStore:u}=h().default.state;if(!u)return{inviteUsers:[],inviteBots:[],inviteGroups:[]};const m=x().default.getConfigKey("search_contacts_timeout","timeoutMs"),{userLimit:p,botLimit:g,groupLimit:v,importContactLimit:y}=r,S=await f().T.searchActions.load(),[b,w,_,{user:I,email:T},M]=await Promise.all([p>0?S.searchSpaceUsers({environment:i,query:s,membersOnly:a,limit:p,shouldUseEdgeCacheRollout:d}):[],g>0?S.searchSpaceBots({environment:i,query:s}):[],v>0?S.searchSpaceGroups({query:s,intl:n}):[],S.searchEmailUser(i,s),y>0?(0,l().nQ)(m,A().callApi({eventName:"searchContacts",environment:i,data:{spaceId:u.id,limit:y,query:s,importContactType:c,includeNonNotionUsers:!a,includeUserId:!0}})):void 0]),C=b.slice(0,p).map((e=>({type:"existingUser",value:e}))),j=w.slice(0,g).map((e=>({type:"bot",value:e}))),k=_.slice(0,v).map((e=>({type:"group",value:e})));I&&C.unshift({type:"existingUser",value:I}),T&&C.unshift({type:"newUser",value:{email:T},source:"email"});let P=[];return"success"===(null==M||null===(t=M.result)||void 0===t?void 0:t.type)&&(P=M.result.data.contacts.map((e=>({type:"newUser",value:{email:e.email,name:e.name,avatar_url:e.profile_photo,user_id:e.user_id},source:e.type})))),{inviteUsers:o().hS(C,(e=>e.value.email)),inviteBots:j,inviteGroups:k,importedContacts:P}}},304372:(e,t,s)=>{s.d(t,{BV:()=>p,CR:()=>x,Gg:()=>S,k4:()=>h,r1:()=>f,rl:()=>g,t1:()=>v,tU:()=>b,zh:()=>y});var i=()=>s(237385),r=()=>s(803290),n=()=>s(162901),a=()=>s(455831),o=()=>s(818369),l=()=>s(145046),c=()=>s(307542),d=()=>s(794564),u=()=>s(111826),m=()=>s(840925);function p(e){let{spaceStore:t,members:s}=e;const r=f({spaceStore:t}),a=(0,i().v3)(),c=t.id,[d]=(0,n().Yb)((async()=>{if(!r)return;const e=await o().callApi({eventName:"getRecentlyRemovedUsers",environment:a,data:{spaceId:c}});if("failed"===e.type)throw l().Qg(e),e;return e.data.recentlyRemovedMembers}),[c,a,r,s]);return d.value}function g(e){let{spaceStore:t,subscriptionData:s}=e;const r=v({spaceStore:t,subscriptionData:s}),a=(0,i().v3)();(0,n().Yb)((async()=>{if(!r)return;const e=await o().callApi({eventName:"getRecoverableSpaceUserContent",environment:a,data:{spaceId:t.id}});if("failed"===e.type)throw e;const s=e.data.recentSpaceRecoverPages;return m().A.setState({...m().A.state,recentRecoverableUsers:s}),s}),[t,a,r])}function v(e){let{spaceStore:t,subscriptionData:s}=e;return(0,r().K8)((()=>t.canAdmin()&&a().OX(s.subscriptionTier)),[s,t])}function f(e){let{spaceStore:t}=e;return(0,r().K8)((()=>t.canAdmin()),[t])}function h(e){let{spaceStore:t}=e;return(0,r().K8)((()=>!!t&&t.canEditMembership()),[t])}function y(){const e=(0,i().v3)();return(0,r().K8)((()=>u().vl(e)),[e])}function S(e){let{spaceStore:t}=e;const s=(0,d().h)();return(0,r().K8)((()=>(null==t?void 0:t.canEditMembership())&&s),[t,s])}function x(e){let{spaceStore:t}=e;const s=(0,r().K8)((()=>(0,c().qm)()),[]),i=(0,d().h)();return(0,r().K8)((()=>null==t?void 0:t.canAdmin()),[t])&&i&&s}function b(e){let{spaceStore:t}=e;const s=(0,r().K8)((()=>(0,c().F0)()),[]),i=(0,d().h)();return(0,r().K8)((()=>null==t?void 0:t.canAdmin()),[t])&&i&&s}},331132:(e,t,s)=>{s.d(t,{$:()=>x});var i=s(242343),r=()=>s(803290),n=()=>s(174114),a=()=>s(712437),o=()=>s(220959),l=()=>s(427091),c=()=>s(634468),d=()=>s(885323),u=()=>s(145017),m=()=>s(653998),p=()=>s(31448),g=()=>s(951920),v=()=>s(485966),f=()=>s(638907),h=()=>s(330358),y=()=>s(611824),S=s(163643);function x(){const e=(0,m().tz)(),{collectionViewPageName:t,collectionViewPageURL:s}=(0,r().K8)((()=>{const t=v().default.state.currentSpaceStore;if(!t)return{collectionViewPageName:void 0,collectionViewPageURL:void 0};const s=t.id,i=(0,d().Pg)({spaceId:s}),r=f().B.createChildStore(t,{table:u().ev,id:i,spaceId:t.id}),n=null==r?void 0:r.getModel();if(!n)return{collectionViewPageName:void 0,collectionViewPageURL:void 0};const c=(0,o().A)({pageId:i,pageVisitSource:a().y8.WorkspaceSettingsPeopleSectionHeader});return{collectionViewPageName:n.getRenderTitle({getRecordModel:r.getRecordModel,userTimeZone:(0,l().P)(),intl:e}),collectionViewPageURL:c}}),[e]),x=(0,i.useCallback)((e=>{e.metaKey||h().A.setState({...h().A.state,open:!1})}),[]),[b,w]=(0,g().B)(),_=(0,n().IS)((e=>({icon:{width:16,height:16,fill:w?e.text.uiBluePrimary:e.text.secondary},textLink:{color:e.text.secondary,fontWeight:p().Wy.medium,fontSize:p().J.UISmall.desktop,display:"flex",alignItems:"center"}})),[w]);return(0,S.jsx)("div",{ref:b,children:(0,S.jsxs)(y().A,{onClick:x,href:s,disableUnderline:!0,style:_.textLink,hoverColor:"blue",children:[(0,S.jsx)("span",{children:(0,S.jsx)(m().sA,{id:"spacePermissionsSettings.people.common.managePeopleDirectoryLink",defaultMessage:"Manage {directoryName}",values:{directoryName:t}})}),(0,S.jsx)("span",{children:(0,c().arrowDiagonalUpRightFillIcon)(_.icon)})]})})}},388732:(e,t,s)=>{s.d(t,{l:()=>r});s(242343);var i=s(163643);const r=(0,s(680369).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,i.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},415806:(e,t,s)=>{s.d(t,{Ay:()=>h,t_:()=>y,v7:()=>S});s(242343);var i=()=>s(237385),r=()=>s(803290),n=()=>s(950635),a=()=>s(752903),o=()=>s(76394),l=()=>s(413871),c=()=>s(888575),d=()=>s(951156),u=()=>s(151258),m=()=>s(732165),p=()=>s(482570),g=s(163643);function v(e){const t=(0,i().v3)(),{actor:s,format:n,hasTooltip:v,tooltipHeader:h}=e,y=(0,r().K8)((()=>{const e=s.asActor;return e&&l().sk.createUniqueRootStore(t,e.pointer)}),[s,t]);return(0,g.jsx)(u().Ay,{...e,renderAvatar:e=>{if(y)return y instanceof l().vK?n===a().NY.Inline?(0,g.jsx)(d().A,{botStore:y,size:e,style:f}):(0,g.jsx)(c().A,{botStore:y,avatarSize:e,inline:!0,style:f}):y instanceof l().LU?n===a().NY.Inline?(0,g.jsx)(p().A,{userStore:y,size:e,avatarShouldShowShadow:!0,hasTooltip:v??!0,style:f,tooltipHeader:h}):(0,g.jsx)(m().A,{userStore:y,avatarSize:e,inline:!0,hasTooltip:v,style:f,tooltipHeader:h}):void(y instanceof l().pH||(0,o().HB)(y))}})}const f={minWidth:0};v.Format=a().NY;const h=v;function y(e){const{userValue:t,...s}=e;return(0,g.jsx)(v,{actor:(0,n().MR)(t),...s})}function S(e){const{botValue:t,...s}=e;return(0,g.jsx)(v,{actor:(0,n().oC)(t),...s})}y.Format=u().mI,S.Format=u().mI},429318:(e,t,s)=>{s.d(t,{Dd:()=>Ie,z_:()=>Te,_3:()=>Ae,Lw:()=>Ne,uU:()=>ke,UP:()=>ue,QF:()=>ze,U6:()=>Pe,M0:()=>Re,s6:()=>we,AO:()=>De,IG:()=>he,P_:()=>me,aC:()=>Ue,X:()=>Le,Sg:()=>ye,id:()=>je,li:()=>be,Ss:()=>ve});s(725707),s(491955),s(500234),s(324989),s(403517),s(242343);var i=()=>s(762847),r=()=>s(502140),n=()=>s(427091),a=()=>s(524118),o=()=>s(329911),l=()=>s(519423),c=()=>s(145017),d=()=>s(21164),u=()=>s(16043),m=()=>s(528762),p=()=>s(409211),g=()=>s(653998),v=()=>s(975392),f=()=>s(23371),h=()=>s(76394),y=()=>s(851552);const S=(0,y().Dv)("exportAdminContentSearch"),x=(0,y().Dv)("exportAuditLog"),b=(0,y().Dv)("exportBlock"),w=(0,y().Dv)("exportContentAnalytics"),_=(0,y().Dv)("exportDomainClaimableSpaces"),I=(0,y().Dv)("exportDomainClaimableSpacesForOrganization"),T=(0,y().Dv)("exportLegalHoldContentSummary"),A=(0,y().Dv)("exportSpace"),M=(0,y().Dv)("exportUserAnalytics");var C=()=>s(577040),j=()=>s(803290),k=()=>s(814059),P=()=>s(884373),R=s(163643);const E={fontWeight:s(31448).Wy.semibold};const U=function(e){let{exportProgressStore:t,disabledExportTeamNames:i}=e;const{messageStyle:r,spinnerContainerStyle:n}=(0,s(174114).IS)((e=>({messageStyle:{fontSize:14,color:e.text.secondary,textAlign:"center"},spinnerContainerStyle:{marginTop:24,marginBottom:24,display:"flex",justifyContent:"center"}})),[]);return(0,R.jsxs)("div",{style:r,children:[(0,R.jsx)("div",{style:n,children:(0,R.jsx)(s(966789).A,{})}),(0,R.jsx)(L,{exportProgressStore:t}),(0,R.jsx)(N,{exportProgressStore:t}),(0,R.jsx)(z,{disabledExportTeamNames:i})]})};function z(e){let{disabledExportTeamNames:t}=e;return t.length>0?(0,R.jsxs)("span",{children:[(0,R.jsx)(P().A,{size:10}),(0,R.jsx)("p",{children:(0,R.jsx)(g().sA,{id:"exportActions.exportDisabledTeams.message",defaultMessage:"Export is disabled for the following teamspaces: <b>{teamNames}</b>",values:{teamNames:(0,k().l)(t),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,R.jsx)("span",{style:E,children:t})}}})})]}):null}function N(e){let{exportProgressStore:t}=e;return(0,j().K8)((()=>t.state.targetEmailAddress),[t])?(0,R.jsx)("p",{children:(0,R.jsx)(g().sA,{id:"exportProgressDialog.emailMessage",defaultMessage:"We'll also send you an email with the download link."})}):null}function L(e){let{exportProgressStore:t}=e;const s=(0,j().K8)((()=>t.state.pagesExported),[t]);return s>0?(0,R.jsx)("p",{children:(0,R.jsx)(g().sA,{id:"exportProgressDialog.exportedPagesMessage",defaultMessage:"{pagesExported, plural, one {{pagesExported} page exported} other {{pagesExported} pages exported}}",values:{pagesExported:s}})}):(0,R.jsx)("p",{children:(0,R.jsx)(g().sA,{id:"exportProgressDialog.exportStartedMessage",defaultMessage:"Exporting…"})})}var D=()=>s(944498),F=()=>s(155297),B=()=>s(868325),O=()=>s(477784),q=()=>s(92451),V=()=>s(986392),W=()=>s(485966),G=()=>s(736953),K=()=>s(985532),H=()=>s(836331),Y=()=>s(558714);class Q extends(()=>s(129044))().default{getInitialState(){return{pagesExported:0}}}const $=Q;var J=()=>s(413871),X=()=>s(14679),Z=()=>s(111826),ee=()=>s(305043),te=()=>s(441288),se=()=>s(137476);function ie(e,t){se().vd(e,"export",t)}function re(e,t){se().vd(e,"export_failed",t)}var ne=()=>s(818369),ae=()=>s(145046),oe=()=>s(85751),le=()=>s(839618),ce=()=>s(70989);const de=(0,g().YK)({exporting:{id:"exportActions.exporting.loadingMessage",defaultMessage:"Exporting"},exportAuditLogEmail:{id:"exportActions.auditLog.exporting.EmailMessage",defaultMessage:"Your CSV export is currently being generated. The generated CSV has a 2-hour delay from the real time audit log. Once it is ready, an email will be sent to you with the download link."},exportCSVEmail:{id:"exportActions.exportingCSV.EmailMessage",defaultMessage:"Your CSV export is currently being generated. Once it is ready, an email will be sent to you with the download link."},exportFailed:{id:"exportActions.exportFailedError.message",defaultMessage:"Export failed."},workspaceOwnerMessage:{defaultMessage:"Workspace owner",id:"export.userPermissionsRole.workspaceOwner.message"},memberMessage:{defaultMessage:"Member",id:"export.userPermissionsRole.member.message"},membershipAdminMessage:{defaultMessage:"Membership admin",id:"export.userPermissionsRole.membershipAdmin.message"},guestMessage:{defaultMessage:"Guest",id:"export.userPermissionsRole.guest.message"},idMessage:{defaultMessage:"ID",id:"export.csvHeader.id"},emailMessage:{defaultMessage:"Email",id:"export.csvHeader.email"},nameMessage:{defaultMessage:"Name",id:"export.csvHeader.name"},roleMessage:{defaultMessage:"Role",id:"export.csvHeader.role"},permissionGroupsMessage:{defaultMessage:"Permission groups",id:"export.csvHeader.permissionGroups"},pagesMessage:{defaultMessage:"Pages",id:"export.csvHeader.pages"},partitionMessage:{defaultMessage:"Export is still in progress due to file size. We will send you an email about its progress.",id:"export.exportPartitioned.message"},privatePageMessage:{defaultMessage:"Private page",id:"export.privatePageTitle.message"},pageTitleAndIdMessage:{defaultMessage:"{pageTitle} ({pageId})",id:"export.pageTitleAndId.message"},pageSeparatorMessage:{defaultMessage:", ",id:"export.pageSeparator.message"}});async function ue(e,t){if(!_e({environment:e,...t}))return void re(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const{currentUserStore:s}=W().default.state;if(!s)return void re(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const i=s.getEmail();if(!i)return void re(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});ie(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=ge(s.id));const r=(0,le().UT)(e,b,t,{spaceId:t.block.spaceId}),n=W().default.state.currentSpaceStore;await pe(e,r,t.recursive,i,null==n?void 0:n.id)}async function me(e,t,s,i){if(!_e({environment:e,recursive:!0,exportOptions:t.exportOptions,isOrgConsole:void 0!==s}))return void re(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const{currentUserStore:r}=W().default.state;if(!r)return void re(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const n=r.getEmail();if(!n)return void re(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});ie(e,{target:"space",format:t.exportOptions.exportType,recursive:!0}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=ge(r.id));const a=(0,le().UT)(e,A,t);await pe(e,a,!0,n,t.spaceId,i)}async function pe(e,t,s,i,r,n){const{currentSpaceViewStore:a}=W().default.state;if(!a&&!n)return;const o=new $;o.setState({pagesExported:0,targetEmailAddress:i});let l,c=!1;const d=((null==a?void 0:a.getTeamsStores())||n)??[],u=null==d?void 0:d.filter((e=>e.getSetting("disable_export"))).flatMap((e=>e.getName()||[]));if(s){const t=u.length>0?6e3:1250;l=(0,f().wR)(t);const s={exportProgressStore:o,disabledExportTeamNames:u};ae().ui({message:(0,R.jsx)(U,{...s}),showCancel:!1,keepFocus:!0,disableBackgroundDismiss:!0,items:[{label:(0,R.jsx)(g().sA,{id:"exportProgressDialog.closeButton.label",defaultMessage:"Close"}),onAccept:()=>{Le({environment:e,spaceId:r}),c=!0}}]})}else l=Promise.resolve(),ce().m({message:de.exporting});for await(const m of t){if(c)return;if(m.error)return ce().V(),void ae().f1(O().A.formatMessage(de.exportFailed));{const{value:t}=m;if("complete"===t.type||"partition"===t.type)return await l,ce().V(),void("complete"===t.type?(ae().zw(),!c&&t.exportURL&&oe().I5(e,t.exportURL)):ae().rG({message:O().A.formatMessage(de.partitionMessage)}));o.setState({...o.state,pagesExported:t.pagesExported})}}}function ge(e){const t={};return o().K.scan(((s,i)=>{if(s.includes(F().Ie)&&s.includes(e)){const e=s.split(F().Ie)[1];e&&i&&(t[e]=i)}})),t}function ve(e){const{root:t,environment:s,isCollectionViewExportTypeSupported:i}=e,r=s.currentUser.id,a=Ce(r),o=a&&a.exportType||"markdown",l=i?"currentView":void 0,c="pdf"===o?{exportType:"pdf",timeZone:(0,n().P)(),pdfFormat:je(r),locale:"en",collectionViewExportType:l}:{exportType:o,timeZone:(0,n().P)(),locale:"en",collectionViewExportType:l};Te(s,{open:!0,root:t,recursive:"space"===t.table,exportOptions:c,shouldExportComments:!1})}function fe(e,t){switch(t){case"editor":return e.formatMessage(de.workspaceOwnerMessage);case"membership_admin":return e.formatMessage(de.membershipAdminMessage);case"read_and_write":return e.formatMessage(de.memberMessage);case"none":return e.formatMessage(de.guestMessage);default:return r().log({level:"error",from:"exportActions",type:"roleNotFound",data:{miscDataToConvertToString:{role:t}}}),""}}async function he(e,t){const{spaceStore:s,subscriptionData:i,intl:r}=t;await ne().callApi({eventName:"exportSpaceMembers",environment:e,data:{spaceId:s.getSpaceId()}});const n=i.users.map((e=>e.userId)),a=await ne().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:s.getSpaceId(),userIds:n},headers:(0,l().WS)({cellId:void 0,spaceId:s.getSpaceId()})}),o={};if("success"===a.type)for(const[l,c]of Object.entries(a.data.userToGroupMap)){const e=(c||[]).map((e=>G().A.state.permissionGroupsAndMemberCounts.find((t=>t.group.group_id===e)))),t=v().oE(e).map((e=>e.group.name)).sort().join(",");o[l]=t}await ye(s,i.users,o,r)}async function ye(e,t,s,i){const r=H().default.checkGate({gateName:"dont_load_users"})?[]:v().oE(await f().lX(t,40,(async t=>{const r=X().L.createChildStore(e,{table:p().oo,id:t.userId});await r.waitUntil((()=>r.isReady()));const n=r.getEmail(),a=r.getFullName(i);if(n||a)return[n||"",a||"",fe(i,t.role),s[t.userId]||"",r.id]})));Se(xe([[de.emailMessage,de.nameMessage,de.roleMessage,de.permissionGroupsMessage,de.idMessage].map((e=>i.formatMessage(e))),...r]),"members.csv")}function Se(e,t){const s=document.createElement("a");s.setAttribute("href",`data:text/csv;charset=utf-8,${encodeURIComponent(e)}`),s.setAttribute("download",t),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function xe(e){return e.map((e=>e.map((e=>((e=e.replace(/"/g,'""')).search(/("|,|\n)/g)>=0&&(e=`"${e}"`),e))).join(","))).join("\n")}async function be(e){let{spaceStore:t,intl:s,environment:i}=e;const r=ee().subscriptionDataStoreInstance.state;if(void 0===r||"subscribed_admin"!==r.type)return;let n=[];if(K().A.state.shouldUseEdgeCache){const e=await ne().callApi({eventName:"listUsers",environment:i,data:{cursor:void 0,membershipFilter:"guests",limit:1e4,sort:"name_normalized",sortDirection:"asc",query:"",spaceId:t.id}});if("success"!==e.type)return void ae().rG({message:O().A.formatMessage(de.exportFailed)});const s=e.data.users,r=await ne().callApi({eventName:"getGuestPagesForUserIds",environment:i,data:{spaceId:t.id,guestUserIds:s.map((e=>e.id))},headers:(0,l().WS)({cellId:void 0,spaceId:t.id})});if("success"!==r.type)return void ae().rG({message:O().A.formatMessage(de.exportFailed)});n=s.map((e=>({userId:e.id,role:"none",guestPageIds:r.data.guestIdToPages[e.id].pageIds,isPageGuest:!0,isTeamGuest:!1})))}else n=(0,Z().oe)(r);we(i,{intl:s,spaceStore:t,guests:n})}async function we(e,t){let{guests:s,intl:r,spaceStore:n}=t;await ne().callApi({eventName:"exportSpaceGuests",environment:e,data:{spaceId:n.getSpaceId()}});const a=r.formatMessage(de.pageSeparatorMessage),o=v().oE(await Promise.all(s.map((async t=>{const s=X().L.createChildStore(n,{table:p().oo,id:t.userId});async function o(t){const s=J().Bv.createChildStore(n.getPagesStore(),{table:c().ev,id:t});if(await s.load(),s.isCollectionView()){const e=s.getCollectionPointer();if(e){const t=J().md.createChildStore(n,{table:d().Vl,id:e.id});t&&await t.load()}}else if(s.getType()===i().xd.alias){const e=s.getAliasTargetStore();e&&await e.load()}return(0,q().Qe)(s,r,e,!1)??r.formatMessage(de.privatePageMessage)}const[,...l]=await Promise.all([s.load(),...t.guestPageIds.map((e=>async function(e){return r.formatMessage(de.pageTitleAndIdMessage,{pageId:e,pageTitle:await o(e)})}(e)))]),u=s.getEmail(),m=s.getFullName(r);if(u||m)return[u||"",m||"",l.join(a),s.id]})))),l=[[de.emailMessage,de.nameMessage,de.pagesMessage,de.idMessage].map((e=>r.formatMessage(e))),...o];Se(xe(l),"guests.csv"),te().Is(e,{line_count:l.length})}function _e(e){const t="pdf"===e.exportOptions.exportType&&e.recursive;return!!e.isOrgConsole||(!t||Ie(e.environment))}function Ie(e){return(0,Z().n)(e,"enterprise")||(0,Z().n)(e,"business")||D().hfc()}function Te(e,t){const s=Y().Ay.state,i=e.currentUser.id;let r=t;if(Y().xt(r)&&!Ie(e))if("space"===r.root.table){const e=s.open&&!Y().xt(s)?s.exportOptions.exportType:"html";r={...r,exportOptions:{...r.exportOptions,exportType:e}}}else r={...r,recursive:!1};if(!_e({environment:e,...r}))throw new(a().Umn)("Invalid export options",{data:r});Y().Ay.setState(r),function(e){const t=Y().Ay.state;if(t.open){const s={...Ce(e),exportType:t.exportOptions.exportType};"pdf"===t.exportOptions.exportType&&(s.pdfFormat=t.exportOptions.pdfFormat),o().K.set({userId:e,key:Me,value:s})}}(i)}function Ae(){Y().Ay.setState({open:!1,shouldExportComments:!1})}const Me="ExportSettings";function Ce(e){return o().K.get({userId:e,key:Me})}function je(e){const t=Ce(e);return t&&t.pdfFormat||Y().N4()}async function ke(e,t){const{currentUserStore:s}=W().default.state,{targetPointer:i}=t;if(!s)return r().log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserStoreNotFound",data:{miscDataToConvertToString:{targetPointer:i}}}),ae().rG({message:O().A.formatMessage(de.exportFailed)}),void re(e,{target:"auditLog",format:"csv",recursive:!1});if(!s.isDefined())return r().log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserValueNotFound",data:{miscDataToConvertToString:{targetPointer:i}}}),ae().rG({message:O().A.formatMessage(de.exportFailed)}),void re(e,{target:"auditLog",format:"csv",recursive:!1});let n;ie(e,{target:"auditLog",format:"csv",recursive:!1}),i.table===m().NX?n=(0,le().UT)(e,x,{spaceId:i.id,exportOptions:t.exportOptions}):i.table===u().y7?n=(0,le().UT)(e,x,{organizationId:i.id,exportOptions:t.exportOptions}):(0,h().HB)(i),await Ee(n,de.exportAuditLogEmail)}async function Pe(e){const{environment:t,data:s}=e;ie(t,{target:"domainClaimableSpaces",format:"csv",recursive:!1});const i=(0,le().UT)(t,_,s);await Ee(i,de.exportCSVEmail)}async function Re(e){const{environment:t,data:s}=e;ie(t,{target:"domainClaimableSpaces",format:"csv",recursive:!1});const i=(0,le().UT)(t,I,s);await Ee(i,de.exportCSVEmail)}async function Ee(e,t){const s=await e.next();if(s.value.error){const e=(0,B().A)(O().A.getIntl(),s.value.error);ae().f1(e)}else ae().rG({message:O().A.formatMessage(t)})}async function Ue(e,t){ie(e,{target:"userAnalytics",format:"csv",recursive:!1});const s=(0,le().UT)(e,M,t);await Ee(s,de.exportCSVEmail)}async function ze(e,t){ie(e,{target:"contentAnalytics",format:"csv",recursive:!1});const s=(0,le().UT)(e,w,t);await Ee(s,de.exportCSVEmail)}async function Ne(e,t){ie(e,{target:"adminContentSearchAnalytics",format:"csv",recursive:!1});const s=(0,le().UT)(e,S,{spaceId:t.spaceId,organizationId:t.organizationId,sort:{field:"relevance",direction:"desc"},query:t.filters.query,audience:t.filters.audience,lastEditedTime:(0,C().ES)(t.filters.lastEditedTime),createdTime:(0,C().ES)(t.filters.createdTime),createdBy:t.filters.createdBy,sharedWith:t.filters.sharedWith,teamspaceIds:t.filters.teamIds,deletionStatuses:t.filters.pageStatus});await Ee(s,de.exportCSVEmail)}async function Le(e){let{environment:t,spaceId:s}=e;if(!s)return;const i=await ne().callApi({eventName:"getActiveExportTasks",environment:t,data:{spaceId:s}});var r;"success"===i.type&&V().A.setState({count:i.data.length,exportedPageCount:null===(r=i.data[0])||void 0===r?void 0:r.exportedPageCount})}async function De(e,t){ie(e,{target:"legalHoldContentSummary",format:"csv",recursive:!1});const s=(0,le().UT)(e,T,{spaceId:t.spaceId,legalHoldId:t.legalHoldId,teamIds:t.teamIds,userIds:t.userIds,blockIds:t.blockIds,query:t.query},{spaceId:t.spaceId});await Ee(s,de.exportCSVEmail)}},462125:(e,t,s)=>{s.d(t,{oc:()=>f,q7:()=>h,tL:()=>y});s(725707),s(491955),s(403517),s(242343);var i=()=>s(803290),r=()=>s(174114),n=()=>s(427091),a=()=>s(653998),o=()=>s(477784),l=()=>s(378219),c=()=>s(485966),d=()=>s(413871),u=()=>s(308265),m=()=>s(28210),p=()=>s(35462),g=s(163643);const v=(0,a().YK)({privateTeamspace:{id:"baseTable.pageCell.privateTeamspace",defaultMessage:"Private teamspace"},untitledPath:{id:"baseTable.pageCell.untitledPath",defaultMessage:"Untitled"}});function f(e){let{blockStore:t,parentSpaceStore:s,rightIcon:n,inlineTitleContent:o,useThinTitle:l,skipUntitledStyling:d}=e;const v=(0,a().tz)(),f=(0,u().BG)(),S=(0,i().K8)((()=>s||c().default.state.currentSpaceStore),[s]),x=(0,i().K8)((()=>{const e=null==t?void 0:t.getModel();if(e&&t)return e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),{displayTitle:b,pageTitle:w}=(0,i().K8)((()=>y({blockStore:t,isWorkflowsAppContainerEnabled:f})),[t,f]),_=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",position:"relative",overflow:"hidden"},summaryContainer:{flex:1,overflow:"hidden"},iconContainer:{height:20,width:20,flexGrow:0,flexShrink:0,flexBasis:20,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},byline:{lineHeight:1.3,fontSize:12,opacity:.5},titleContainer:{alignItems:"center",flexDirection:"row",display:"flex"},title:{fontSize:14,fontWeight:l?400:500,...w||d?{}:{opacity:.25}}})),[l,w,d]),I=(0,i().K8)((()=>h({blockStore:t,spaceStore:S,intl:v,isWorkflowsAppContainerEnabled:f})),[t,S,v,f]);return(0,g.jsxs)("div",{style:_.container,children:[(0,g.jsx)("div",{style:_.iconContainer,children:(0,g.jsx)(m().B,{icon:x,size:20,isEmptyPage:!1,disabled:!0})}),(0,g.jsxs)("div",{style:_.summaryContainer,children:[(0,g.jsxs)("div",{style:_.titleContainer,children:[(0,g.jsx)(p().A,{showTooltipWhenTruncated:!0,style:_.title,children:b}),o]}),(0,g.jsx)(p().A,{showTooltipWhenTruncated:!0,style:_.byline,children:I})]}),n]})}function h(e){const{intl:t,blockStore:s,spaceStore:i,isWorkflowsAppContainerEnabled:r}=e;const a=s?(0,l().fU)(s).filter((e=>e.id!==s.id)).map((e=>{if(e instanceof d().h4)return e.getName()||t.formatMessage(v.privateTeamspace);const s=e.getModel();return(null==s?void 0:s.getRenderTitleWithPlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,n().P)(),intl:o().A.getIntl(),isWorkflowsAppContainerEnabled:r}))||t.formatMessage(v.untitledPath)})).reverse():[];return a.length>0?a.join("/"):null==i?void 0:i.getName()}function y(e){let{blockStore:t,isWorkflowsAppContainerEnabled:s}=e;const i=null==t?void 0:t.getModel();if(!i||!t)return{pageTitle:void 0,displayTitle:void 0};const r=t.getRecordModel,a=(0,n().P)(),l=o().A.getIntl(),c=i.getRenderTitle({getRecordModel:r,userTimeZone:a,intl:l}),d=i.getEmptyTitlePlaceholder({getRecordModel:r,userTimeZone:a,intl:l,isWorkflowsAppContainerEnabled:s});return{pageTitle:c,displayTitle:c||d}}},501578:(e,t,s)=>{s.d(t,{j:()=>d});var i=s(242343),r=()=>s(237385),n=()=>s(174114),a=()=>s(31448),o=()=>s(103151);var l=()=>s(907721),c=s(163643);function d(e){let{children:t,style:s,tooltipStyle:d,placement:u=l().W.Bottom}=e;const{isSafari:m}=(0,r().Y0)(),p=(0,i.useRef)(null),g=function(e){const[t,s]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const{current:t}=e;if(!t)return void s(!1);const i="ResizeObserver"in window?new ResizeObserver((e=>{let[t]=e;s(t.target.scrollWidth>t.target.clientWidth)})):void 0;return null==i||i.observe(t),()=>null==i?void 0:i.unobserve(t)}),[]),t}(p),v=(0,n().IS)((()=>({overflowText:{...a().RC,...s}})),[s]);return(0,c.jsx)(o().A,{delayThreshold:500,placement:u,textWrap:!0,style:d,forceVisibleState:!(m||!g)&&void 0,renderTooltip:()=>g?t:void 0,render:e=>(0,c.jsx)("div",{ref:p,style:v.overflowText,...e,children:t})})}},547851:(e,t,s)=>{s.d(t,{C:()=>n});s(242343);var i=()=>s(653998),r=s(163643);function n(){return(0,r.jsx)(i().sA,{id:"organization.workspaceSettings.locked.tooltip",defaultMessage:"This setting is being managed by your organization."})}},558714:(e,t,s)=>{s.d(t,{Ay:()=>l,N4:()=>a,xt:()=>n});var i=()=>s(16791);const r=["en","en-us","en-ca"];function n(e){return"pdf"===e.exportOptions.exportType}function a(){return r.includes(i().locale.toLowerCase())?"Letter":"A4"}class o extends(()=>s(129044))().default{getInitialState(){return{open:!1,shouldExportComments:!1}}}const l=new o},577040:(e,t,s)=>{s.d(t,{BI:()=>d,ES:()=>g,Em:()=>o,Hl:()=>p,Ht:()=>m,Tq:()=>a,jO:()=>v,qC:()=>u,r6:()=>l,y2:()=>c});var i=()=>s(846581),r=()=>s(16456),n=()=>s(427091);function a(e,t){return(0,i().eV)({value:r().C6.notionDateTimeToLuxon(e,t.locale),preset:"short"})}function o(e,t){return(0,i().eV)({value:r().C6.notionDateTimeToLuxon(e,t.locale),preset:"time"})}function l(e,t){return r().C6.notionDateTimeToLuxon(e,t.locale).toFormat(r().k8)}function c(e,t){let s={starting:void 0,ending:void 0};var i,r,a,o;if(t.starting&&t.ending)s={starting:{type:"datetime",start_time:"",start_date:t.starting.start_date,time_zone:""},ending:{type:"datetime",start_time:"",start_date:t.ending.start_date,time_zone:""}},null!==(i=e.starting)&&void 0!==i&&i.start_time&&null!==(r=e.starting)&&void 0!==r&&r.time_zone&&(s.starting={...s.starting,start_time:e.starting.start_time,time_zone:e.starting.time_zone}),null!==(a=e.ending)&&void 0!==a&&a.start_time&&null!==(o=e.ending)&&void 0!==o&&o.time_zone?s.ending={...s.ending,start_time:e.ending.start_time,time_zone:e.ending.time_zone}:s={starting:{...s.starting,start_time:"00:00",time_zone:(0,n().P)()},ending:{...s.ending,start_time:"23:59",time_zone:(0,n().P)()}};else if(t.starting){var l,c;s=null!==(l=e.starting)&&void 0!==l&&l.start_time&&null!==(c=e.starting)&&void 0!==c&&c.time_zone?{starting:{type:"datetime",start_date:t.starting.start_date,start_time:e.starting.start_time,time_zone:e.starting.time_zone},ending:e.ending}:{starting:{type:"datetime",start_date:t.starting.start_date,start_time:"00:00",time_zone:(0,n().P)()},ending:e.ending}}else if(t.ending){var d,u;s=null!==(d=e.ending)&&void 0!==d&&d.start_time&&null!==(u=e.ending)&&void 0!==u&&u.time_zone?{ending:{type:"datetime",start_date:t.ending.start_date,start_time:e.ending.start_time,time_zone:e.ending.time_zone},starting:e.starting}:{ending:{type:"datetime",start_date:t.ending.start_date,start_time:"23:59",time_zone:(0,n().P)()},starting:e.starting}}else s={starting:e.starting,ending:e.ending};return s}function d(e){return e.starting&&e.ending?{starting:{type:"date",start_date:e.starting.start_date},ending:{type:"date",start_date:e.ending.start_date}}:e.starting?{starting:{type:"date",start_date:e.starting.start_date}}:e.ending?{ending:{type:"date",start_date:e.ending.start_date}}:{}}function u(e){if(e)return{type:"date",start_date:e.start_date}}function m(e){return`${e.actorType}:${e.actorId}`}function p(e){const t=e.split(":");if(2===t.length)return"bot"===t[0]?{actorId:t[1],actorType:"bot"}:"notion_user"===t[0]?{actorId:t[1],actorType:"notion_user"}:void 0}function g(e){return{starting:e.starting?{type:"date",start_date:e.starting.start_date}:void 0,ending:e.ending?{type:"date",start_date:e.ending.start_date}:void 0}}function v(e){return void 0===e.starting&&void 0===e.ending}},583362:(e,t,s)=>{s.d(t,{Ay:()=>M});s(725707),s(491955),s(403517);var i=s(242343),r=()=>s(237385),n=()=>s(803290),a=()=>s(174114),o=()=>s(198654),l=()=>s(653998),c=()=>s(477784),d=()=>s(640979),u=()=>s(904697),m=()=>s(320462),p=()=>s(628854),g=()=>s(424339),v=()=>s(518397),f=()=>s(209684),h=()=>s(535906),y=()=>s(273520),S=()=>s(401382),x=()=>s(935091),b=()=>s(88271),w=()=>s(35462),_=s(163643);function I(e){let{teamsForMember:t,shouldHideTeamMemberCount:s}=e;const i=(0,a().IS)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.text.tertiary},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),r=t.length;return(0,_.jsx)(y().Ay,{popupType:y().z7.Popup,renderOrigin:e=>(0,_.jsx)(f().p,{disabled:0===r,style:0===r?i.noTeams:i.button,...e,children:0===r?(0,_.jsx)(l().sA,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(l().sA,{id:"teamsDropdownForMember.teamsCount.label",defaultMessage:"{numberOfTeams, plural, one {{numberOfTeams} teamspace} other {{numberOfTeams} teamspaces}}",values:{numberOfTeams:r}}),(0,o().b)(i.chevron)]})}),render:()=>(0,_.jsx)(A,{teamStores:t,shouldHideTeamMemberCount:s})})}const T=(0,l().YK)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder"}});function A(e){const{shouldHideTeamMemberCount:t}=e,s=(0,r().v3)(),o=(0,a().IS)((()=>({teamMenuItem:{fontWeight:400,maxWidth:180}})),[]),[f,y]=(0,i.useState)(""),I=(0,i.useCallback)((e=>p().F2({environment:s,teamId:e,tab:m().p.Members,from:"teams_dropdown_for_team_member"})),[s]),A=(0,n().K8)((()=>[{key:"teams for member",render:e=>(0,_.jsx)(b().A,{...e}),actions:e.teamStores.map((e=>{const s={key:e.id,displayName:e.getName(),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:s=>{var i;return(0,_.jsx)(h().A,{icon:(0,_.jsx)(g().x,{disabled:!0,store:e}),title:(0,_.jsx)(w().A,{style:o.teamMenuItem,children:e.getName()}),caption:t?void 0:(0,_.jsx)(l().sA,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",values:{numMembers:(null===(i=(0,u().getTeamMemberCountAndSampleUserIds)(e))||void 0===i?void 0:i.memberCountWithGuests)??0}}),inline:!0,...s})},action:()=>{I(e.id)},closeParentMenu:!1};return s}))}]),[e.teamStores,o.teamMenuItem,I,t]),M=f,C=(0,_.jsx)(b().A,{isInput:!0,children:(0,_.jsx)(S().Ay,{value:M,onChange:(0,i.useCallback)((e=>{y(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:c().A.formatMessage(T.filterTeams)})}),j={menuType:d().gu.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?C:void 0};return(0,_.jsx)(x().A,{...j,children:(0,_.jsx)(v().A,{filter:M,context:{blocks:[],environment:s,publicEditMode:void 0},initialFocus:0,sections:A})})}const M=function(e){const t=(0,u().useTeamsFromCache)(),s=(0,n().K8)((()=>e.teamStores??t),[e.teamStores,t]),i=(0,n().K8)((()=>s.filter((t=>t.isMemberOrGuest(e.memberId,e.userPermissionGroupIds)))),[s,e.memberId,e.userPermissionGroupIds]);return(0,_.jsx)(I,{teamsForMember:i})}},591090:(e,t,s)=>{s.d(t,{$:()=>r});s(242343);var i=s(163643);const r=(0,s(680369).wt)("membersFilled",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},614434:(e,t,s)=>{s.d(t,{A:()=>v});s(242343);var i=()=>s(16791),r=()=>s(803290),n=()=>s(174114),a=()=>s(846581),o=()=>s(653998),l=()=>s(31448),c=()=>s(225679),d=()=>s(907721),u=()=>s(695951),m=()=>s(103151),p=()=>s(35462),g=s(163643);function v(e){let{spaceStore:t,restorationStatus:s,didAttemptRecovery:i}=e;const r=h();return(0,g.jsx)(m().A,{placement:d().W.Bottom,renderTooltip:()=>(0,g.jsx)(f,{spaceStore:t,restorationStatus:s,didAttemptRecovery:i}),render:e=>(0,g.jsx)("div",{...e,children:(0,g.jsx)(u().A,{content:(0,g.jsx)(p().A,{style:r.recentlyReaddedText,children:(0,g.jsx)(o().sA,{id:"userCell.recentlyReadded.label",defaultMessage:"Recently re-added"})}),style:r.recentlyReaddedBadge})})})}function f(e){let{spaceStore:t,restorationStatus:s,didAttemptRecovery:n}=e;const l=h(),{displayName:d,displayTime:u}=function(e){let{spaceStore:t,restorationStatus:s}=e;const n="restored"===s.status?{table:s.restoredByTable,id:s.restoredById,spaceId:t.id}:void 0,l=n?(0,c().JQ)({parentStore:t,pointer:n}):void 0,d=(0,o().tz)(),{displayName:u}=(0,r().K8)((()=>({displayName:null==l?void 0:l.getDisplayName(d)})),[l,d]),m="restored"===s.status?(0,a().W_)(s.restoredTime,"medium_with_time",i().locale):void 0;return{displayName:u,displayTime:m}}({spaceStore:t,restorationStatus:s});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:l.tooltipFirstLine,children:(0,g.jsx)(o().sA,{id:"userCell.recentlyReaddedTooltip.label",defaultMessage:"Member was removed and re-added within the last 30 days"})}),n&&(0,g.jsx)("div",{style:l.tooltipSecondLine,children:(0,g.jsx)(o().sA,{id:"userCell.recentlyReaddedTooltip.inProgress.description",defaultMessage:"Restoration of access is in progress",values:{displayName:d,displayTime:u}})}),!n&&d&&u&&(0,g.jsx)("div",{style:l.tooltipSecondLine,children:(0,g.jsx)(o().sA,{id:"userCell.recentlyReaddedTooltip.description",defaultMessage:"{displayName} restored their access on {displayTime}",values:{displayName:d,displayTime:u}})})]})}function h(){return(0,n().IS)((e=>({recentlyReaddedBadge:{background:e.fill.blueSecondary,marginLeft:0,maxWidth:"max-content"},recentlyReaddedText:{color:e.text.bluePrimary,fontSize:l().J.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px"},tooltipFirstLine:{color:e.text.contrastPrimary,fontWeight:l().Wy.semibold},tooltipSecondLine:{color:e.text.contrastSecondary}})),[])}},634468:(e,t,s)=>{s.r(t),s.d(t,{arrowDiagonalUpRightFillIcon:()=>r,iconDefinition:()=>i});s(242343);const i={viewBox:"0 0 20 20",svg:(0,s(163643).jsx)("path",{d:"M15.825 5.05a.875.875 0 0 0-.875-.875H7.313a.875.875 0 1 0 0 1.75h5.524L4.393 14.37c-.32.32-.303.857.039 1.198.341.342.878.36 1.198.039l8.445-8.444v5.524a.875.875 0 1 0 1.75 0z"})},r=(0,s(680369).wt)("arrowDiagonalUpRightFill",i)},726623:(e,t,s)=>{s.d(t,{A:()=>T});var i=s(242343),r=()=>s(727567),n=()=>s(653998),a=()=>s(31448),o=()=>s(907721),l=()=>s(356813),c=()=>s(103151),d=()=>s(237385),u=()=>s(803290),m=()=>s(174114),p=()=>s(818369),g=()=>s(145046),v=()=>s(575015),f=()=>s(529305),h=()=>s(539048),y=()=>s(289241),S=()=>s(421338),x=()=>s(204435),b=()=>s(701270),w=()=>s(482570),_=s(163643);function I(e){let{spaceId:t,userStore:s,onDismiss:r,onSubmit:a}=e;const o=(0,d().v3)(),l=s.id,c=(0,n().tz)(),h=(0,u().K8)((()=>s.getDisplayName(c)),[s,c]),y=(0,m().IS)((e=>({secondaryIcon:{fill:e.icon.uiBlueSecondary},primaryIcon:{fill:e.icon.uiBluePrimary},title:{color:e.text.primary,textAlign:"center",fontSize:17,fontWeight:500,lineHeight:"22px"}})),[]),I=(0,i.useCallback)((async()=>{const e=await p().callApi({eventName:"recoverUserContentInSpace",environment:o,data:{spaceId:t,userId:l}});if("failed"===e.type)throw g().Qg(e),e;a(),r(),v().D6({label:(0,_.jsx)(n().sA,{id:"restoreAccessModal.snackbarMessage",defaultMessage:"Initiated restoration of access for{nbsp}{displayName}",values:{displayName:(0,_.jsx)("b",{children:h}),nbsp:(0,_.jsx)(_.Fragment,{children:" "})}})})}),[o,t,l,h,r,a]);return(0,_.jsx)(f().tf,{header:(0,_.jsx)(f().YA,{iconAndTitle:(0,_.jsxs)(S().Y1,{align:"top-center",gap:9,children:[(0,_.jsx)(w().A,{userStore:s,size:40}),(0,_.jsx)("div",{style:y.title,children:(0,_.jsx)(n().sA,{defaultMessage:"Restore access",id:"restoreAccessModal.title"})})]}),description:(0,_.jsx)(n().sA,{id:"restoreAccessModal.subtitle",defaultMessage:"Restore additional access for members who were removed and re-added within the last 30 days"})}),footer:(0,_.jsx)(f().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,_.jsx)(n().sA,{defaultMessage:"Restore access",id:"restoreAccessModal.restoreButton"}),onClick:I}],secondaryButtons:[{buttonType:"secondary",label:(0,_.jsx)(n().sA,{defaultMessage:"Cancel",id:"restoreAccessModal.cancelButton"}),onClick:r}]}),children:(0,_.jsxs)(x().VP,{gap:24,children:[(0,_.jsx)(b().D,{styleName:"Body-14px/Regular",colorName:"primary",customStyles:{textAlign:"center"},children:(0,_.jsx)(n().sA,{id:"restoreAccessModal.contextDescription",defaultMessage:"<b>{displayName}</b> already has access to their private pages",values:{b:e=>(0,_.jsx)("b",{children:e}),displayName:h}})}),(0,_.jsx)(b().D,{styleName:"Body-14px/Regular",colorName:"primary",customStyles:{textAlign:"center"},children:(0,_.jsx)(n().sA,{id:"restoreAccessModal.actionDescription",defaultMessage:"Would you like to restore <b>{displayName}</b>'s access to their shared pages, groups, and teamspaces?",values:{b:e=>(0,_.jsx)("b",{children:e}),displayName:h}})})]})})}function T(e){let{spaceId:t,userStore:s,onSubmit:i}=e;const a=(0,n().tz)();return(0,_.jsx)(c().A,{placement:o().W.Right,renderTooltip:()=>(0,_.jsx)(A,{}),render:e=>(0,_.jsx)(l().A,{icon:r()._,ariaLabel:a.formatMessage({id:"restoreAccessButton.aria",defaultMessage:"Restore access"}),onClick:()=>async function(e,t,s){return await y().T.showAsyncModal((i=>(0,_.jsx)(h().s,{isOpen:i.isOpen,onDismiss:i.onDismiss,onClosed:i.onClosed,areaConstraint:{width:{type:"fixed",length:380}},render:()=>(0,_.jsx)(I,{spaceId:e,userStore:t,onDismiss:i.onDismiss,onSubmit:s})})))}(t,s,i),...e})})}function A(){return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{style:{fontWeight:a().Wy.semibold},children:(0,_.jsx)(n().sA,{id:"userCell.restoreAccessTooltip.label",defaultMessage:"Restore access to teamspaces, groups, and shared pages"})}),(0,_.jsx)("div",{children:(0,_.jsx)(n().sA,{id:"userCell.restoreAccessTooltip.description",defaultMessage:"Only available if a member was removed and re-added in the last 30 days"})})]})}},794564:(e,t,s)=>{s.d(t,{h:()=>a});var i=()=>s(803290),r=()=>s(485966),n=()=>s(133926);function a(){var e;const{currentSpaceId:t,currentUserId:s}=(0,i().K8)((()=>{var e,t;return{currentSpaceId:null===(e=r().default.state.currentSpaceStore)||void 0===e?void 0:e.id,currentUserId:null===(t=r().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),a=(0,n()._X)({name:"members",spaceId:t,userId:s,amount:"unknown"}),o=null==a||null===(e=a.limit)||void 0===e?void 0:e.total;return!!o&&("unlimited"===o||o>1)}},810073:(e,t,s)=>{s.d(t,{b:()=>n});var i=()=>s(137476),r=()=>s(836331);function n(e){i().vd(e,"workspace_invite_copy_link"),r().default.logEvent("workspace_invite_copy_link")}},810733:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(129044))().default{getInitialState(){return{open:!1}}}const r=new i},829182:(e,t,s)=>{s.d(t,{A:()=>a});s(242343);var i=()=>s(653998),r=()=>s(678523),n=s(163643);function a(e){return(0,n.jsx)(r().A,{...e,children:"membership_admin"===e.role?(0,n.jsx)(i().sA,{id:"spacePermissionsSettings.user.membershipAdmin",defaultMessage:"Membership admin"}):(0,n.jsx)(i().sA,{id:"spacePermissionsSettings.user.workspaceOwner",defaultMessage:"Workspace owner"})})}},840925:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(129044))().default{getInitialState(){return{recentRecoverableUsers:[],searchQuery:void 0}}}const r=new i},877199:(e,t,s)=>{s.d(t,{A:()=>a});s(242343),s(403517);function i(){return(navigator.languages?navigator.languages.map((e=>e.toLowerCase())):navigator.language?[navigator.language.toLowerCase()]:navigator.userLanguage?[navigator.userLanguage.toLowerCase()]:[]).map((e=>e.split("-")[0]))}const r=["ar","az","he","fa","ur"];var n=s(163643);const a=function(e){const{style:t,translations:s}=e,a=i();for(const i of a){const e=s[i];if(e){const s=r.includes(i);return(0,n.jsx)("div",{style:{...s&&{direction:"rtl"},...t},children:e})}}return null}},888575:(e,t,s)=>{s.d(t,{A:()=>r});s(242343);var i=s(163643);const r=function(e){const{botStore:t,avatarSize:r,shouldShowBadge:n,style:a,inline:o}=e,l=(0,s(653998).tz)(),c=(0,s(237385).Y0)(),d=(0,s(803290).K8)((()=>null==t?void 0:t.getDisplayName(l)),[t,l]),{outerStyle:u,avatarWrapStyle:m,badgeStyle:p}=(0,s(174114).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...a},avatarWrapStyle:o?{width:"none",minHeight:"none",marginRight:6}:{marginRight:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:c.isMobile?11:9,lineHeight:c.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginLeft:8,marginTop:1}})),[a,o,c]);return(0,i.jsxs)("div",{style:u,children:[(0,i.jsx)("div",{style:m,children:(0,i.jsx)(s(951156).A,{botStore:t,size:r})}),(0,i.jsx)("div",{style:{...s(31448).RC},children:d}),n&&(0,i.jsx)("div",{style:p,children:"Bot"})]})}},896958:(e,t,s)=>{s.d(t,{f:()=>i});const i=28*s(141666).nD},919035:(e,t,s)=>{s.d(t,{_:()=>o});s(242343);var i=()=>s(174114),r=()=>s(31448),n=()=>s(611824),a=s(163643);function o(e){let{href:t,external:s,onClick:o,children:l}=e;const c=(0,i().IS)((e=>({link:{color:e.icon.uiBluePrimary,fontWeight:r().Wy.medium}})),[]);return(0,a.jsx)(n().A,{disableUnderline:!0,href:t,external:s,onClick:o,color:c.link.color,hoverColor:"blue",style:c.link,children:l})}},969836:(e,t,s)=>{s.d(t,{A:()=>a});s(242343);var i=()=>s(174114),r=()=>s(591090),n=s(163643);function a(e){const t=function(e){const{size:t,style:s}=e;return(0,i().IS)((e=>({icon:{width:.6*t,height:.6*t,fill:e.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:e.regularDividerColor,display:"flex",alignItems:"center",justifyContent:"center",...s}})),[t,s])}(e),s=(0,r().$)(t.icon);return(0,n.jsx)("div",{style:t.iconContainer,children:s})}},986392:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(129044))().default{getInitialState(){return{count:0,exportedPageCount:0}}}const r=new i},998959:(e,t,s)=>{s.d(t,{K:()=>D,gz:()=>z,jo:()=>L});var i=s(242343),r=()=>s(237385),n=()=>s(803290),a=()=>s(174114),o=()=>s(284594),l=()=>s(653998),c=()=>s(31448),d=()=>s(168907),u=()=>s(810073),m=()=>s(818369),p=()=>s(91472),g=()=>s(145046),v=()=>s(110975),f=()=>s(783759),h=()=>s(84543),y=()=>s(392608),S=()=>s(548694),x=()=>s(162976),b=()=>s(104838),w=()=>s(421338),_=()=>s(286270),I=()=>s(884373),T=()=>s(204435),A=()=>s(356813),M=()=>s(431551),C=()=>s(35462),j=()=>s(611824),k=()=>s(629457),P=()=>s(919035),R=()=>s(304372),E=()=>s(331132),U=s(163643);function z(e){let{spaceStore:t}=e;const s=F(),n=(0,r().v3)(),a=(0,i.useCallback)((()=>{v().f({environment:n,url:(0,y().xS)("guides.invitePerson")})}),[n]),c=(0,l().tz)(),d=(0,x().$)({spaceStore:t});return(0,U.jsxs)(k().A,{divider:"none",large:!0,style:s.headingStyle,children:[(0,U.jsxs)("div",{children:[(0,U.jsx)(l().sA,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"}),(0,U.jsx)(A().A,{onClick:a,icon:o().$,ariaLabel:c.formatMessage({id:"spacePermissionsSettings.people.common.iconButton.ariaLabel",defaultMessage:"Learn more about inviting people"})})]}),d&&(0,U.jsx)(E().$,{})]})}function N(e){let{spaceStore:t,inviteLink:s,spacePermissionsSettingsStore:i}=e;const a=(0,r().v3)(),o=F(),c=(0,n().K8)((()=>Boolean(t.getInviteLinkEnabled())),[t]);return(0,U.jsxs)("div",{style:o.inviteLinkSection,children:[(0,U.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,U.jsx)(k().A,{smallMarginBottom:!0,children:(0,U.jsx)(l().sA,{id:"spacePermissionsSettings.spaceMembers.inviteLink.description",defaultMessage:"Invite link to add members"})}),(0,U.jsx)(C().A,{isSmall:!0,isMultiline:!0,style:{marginTop:0,width:"85%"},children:i&&c&&s?(0,U.jsx)(L,{spaceStore:t}):(0,U.jsx)(l().sA,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Only people with permission to invite members can see this."})})]}),(0,U.jsx)("div",{style:{minWidth:130},children:(0,U.jsxs)(w().Y1,{gap:16,align:"center-right",direction:"horizontal",children:[i&&c&&s&&(0,U.jsx)(_().E,{color:"uiBlue",onClick:()=>{!async function(e){let{environment:t,inviteLinkUrl:s}=e;const i=await p().R.clipboardActions.load();i.copyString({environment:t,stringValue:s,copiedMessage:i.clipboardMessages.copiedLinkToClipboard}),(0,u().b)(t)}({environment:a,inviteLinkUrl:s})},children:(0,U.jsx)(l().sA,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})}),(0,U.jsx)(M().A,{on:c,onClick:()=>{!function(e){let{environment:t,spaceStore:s,inviteLinkEnabled:i}=e;const r=!i;d().OE(t,{enabled:r}),h().createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,canUndo:!0,perform:e=>{f().Xk({transaction:e,spaceStore:s,inviteLinkEnabled:Boolean(r)})}})}({environment:a,spaceStore:t,inviteLinkEnabled:c})}})]})})]})}function L(e){let{spaceStore:t,organizationId:s,showBlueLink:n}=e;const a=(0,r().v3)(),o=(0,i.useCallback)((()=>{g().ui({message:(0,U.jsx)(l().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:g().zw,items:[{label:(0,U.jsx)(l().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await m().callApi({eventName:"refreshInviteLink",environment:a,data:{spaceId:t.id,organizationId:s}}),b().x(a)}}]})}),[a,t.id,s]);return(0,U.jsx)(l().sA,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"Only people with permission to invite members can see this. You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>n?(0,U.jsx)(P()._,{onClick:o,children:e}):(0,U.jsx)(j().A,{onClick:o,children:e})}})}function D(e){let{spaceStore:t,inviteLinkCode:s,spacePermissionsSettingsStore:i}=e;const o=(0,r().v3)(),l=(0,n().K8)((()=>(0,S().e3)({spaceStore:t,environment:o,inviteLinkCode:s})),[t,s,o]),c=(0,R().Gg)({spaceStore:t})&&l,d=(0,a().IS)((e=>({divider:{color:e.stroke.secondary}})),[]);return(0,U.jsx)(T().VP,{marginTop:16,children:c?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(N,{spaceStore:t,inviteLink:l,spacePermissionsSettingsStore:i}),(0,U.jsx)(I().A,{size:40,dividerColor:d.divider.color})]}):null})}function F(){return(0,a().IS)((()=>({inviteLinkSection:{display:"flex",alignItems:"center"},headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:c().Wy.medium,display:"flex",justifyContent:"space-between",alignItems:"center"}})),[])}}}]);