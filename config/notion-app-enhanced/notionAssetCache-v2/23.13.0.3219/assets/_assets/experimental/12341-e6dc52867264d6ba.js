"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[12341],{130935:(e,t,o)=>{o.d(t,{_:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("layout",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.39999 2.19999C2.28953 2.19999 2.19999 2.28953 2.19999 2.39998V11.5999C2.19999 11.7103 2.28953 11.7999 2.39999 11.7999H4.99997C5.11042 11.7999 5.19997 11.7103 5.19997 11.5999V2.39998C5.19997 2.28953 5.11042 2.19999 4.99997 2.19999H2.39999ZM1 2.39998C1 1.6268 1.62679 1 2.39999 1H4.99997C5.77316 1 6.39995 1.6268 6.39995 2.39998V11.5999C6.39995 12.3731 5.77316 12.9999 4.99997 12.9999H2.39999C1.62679 12.9999 1 12.3731 1 11.5999V2.39998ZM9 8.80036C8.88954 8.80036 8.8 8.88991 8.8 9.00036V11.6003C8.8 11.7108 8.88954 11.8003 9 11.8003H11.6C11.7105 11.8003 11.8 11.7108 11.8 11.6003V9.00036C11.8 8.88991 11.7105 8.80036 11.6 8.80036H9ZM7.60001 9.00036C7.60001 8.22717 8.2268 7.60037 9 7.60037H11.6C12.3731 7.60037 13 8.22717 13 9.00036V11.6003C13 12.3736 12.3731 13.0003 11.6 13.0003H9C8.2268 13.0003 7.60001 12.3736 7.60001 11.6003V9.00036ZM8.79994 2.39998C8.79994 2.28953 8.88949 2.19999 8.99994 2.19999H11.5999C11.7104 2.19999 11.7999 2.28953 11.7999 2.39998V4.99997C11.7999 5.11043 11.7104 5.19996 11.5999 5.19996H8.99994C8.88949 5.19996 8.79994 5.11043 8.79994 4.99997V2.39998ZM8.99994 1C8.22675 1 7.59995 1.6268 7.59995 2.39998V4.99997C7.59995 5.77316 8.22675 6.39995 8.99994 6.39995H11.5999C12.3731 6.39995 12.9999 5.77316 12.9999 4.99997V2.39998C12.9999 1.6268 12.3731 1 11.5999 1H8.99994Z"})})},194585:(e,t,o)=>{o.d(t,{n:()=>k,z:()=>C});o(610931),o(242343);var n=()=>o(803290),r=()=>o(174114),i=()=>o(505966),l=()=>o(73658),a=()=>o(916963),c=()=>o(758989),s=()=>o(242978),d=()=>o(584044),p=()=>o(130935),u=()=>o(40642),m=()=>o(76394),g=()=>o(511441),f=()=>o(327665),y=()=>o(622286),v=()=>o(328653),S=()=>o(940445),h=o(163643);const b=16;function x(e){let{icon:t,theme:o,size:n,style:i}=e;const a=(0,r().IS)((e=>({icon:{fill:(0,v().d)(t,e).icon.primary,...i}})),[t,i]);return(0,h.jsx)(l().p,{icon:t,theme:o,size:n,style:a.icon})}function C(e){var t;let{template:o,size:n,iconStyle:l}=e;const a=n??b,f=(0,r().IS)((()=>({icon:{width:a,height:a,...l}})),[a,l]),y=(0,r().DP)();if((0,i().cB)(o.templateId))return(0,d().L)(f.icon);const{type:v}=o;switch(v){case"property":return(0,h.jsx)(w,{template:o,iconSize:a,styles:f});case"collection_view":return(0,h.jsx)(g().h,{viewIcon:null===(t=o.value.format)||void 0===t?void 0:t.collection_view_icon,viewType:o.value.type,color:"lightGray",style:f.icon});case"layout":return(0,h.jsx)(h.Fragment,{children:(0,p()._)(f.icon)});case"block":return(0,h.jsx)(h.Fragment,{children:(0,u().b)(f.icon)});case"collection":case"compound":const e="collection"===o.type?o.value.targetCollection.icon:o.icon;if(!(0,c().T8)(e))throw new Error("Only Notion static icons are allowed for template icons");return(0,h.jsx)(x,{icon:e,theme:y,size:a,style:f.icon});case"automation":return(0,h.jsx)(h.Fragment,{children:(0,s().v)(f.icon)});default:(0,m().HB)(v)}}function w(e){let{template:t,iconSize:o,styles:i}=e;const l=(0,r().DP)(),c=(0,y().X)("nds_default_property_noticon"),s=(0,n().K8)((()=>{const{relatedCollectionTemplateId:e}=t;if("relation"===t.value.type&&e){return S().globalWorkflowTemplates.fromIdOfType({templateId:e,type:"collection"}).value.targetCollection.icon}return t.value.icon}),[t]);return(0,h.jsx)(a().zB,{type:t.value.type,icon:s,size:o,style:i.icon,theme:l,isDefaultNoticonEnabled:c})}function k(e){let{template:t,backgroundSize:o}=e;const n=(0,r().IS)((e=>({iconContainer:{background:I({theme:e,template:t})[30]},icon:{fill:I({theme:e,template:t})[400]}})),[t]);return(0,h.jsx)(f().y,{backgroundColor:n.iconContainer.background,backgroundSize:o,icon:(0,h.jsx)(C,{template:t,iconStyle:n.icon})})}function I(e){let{theme:t,template:o}=e;const{type:n}=o;switch(n){case"collection_view":case"automation":return t.accentColors.blue;case"property":return"relation"===o.value.type?t.accentColors.yellow:t.accentColors.red;case"layout":return t.accentColors.orange;case"block":return t.accentColors.purple;case"compound":return t.accentColors.green;case"collection":return t.accentColors.pink;default:(0,m().HB)(n)}}},242978:(e,t,o)=>{o.d(t,{v:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},246132:(e,t,o)=>{o.d(t,{S:()=>m,f:()=>g});o(362833);var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(502140),a=(o(610931),()=>o(73751)),c=()=>o(413871),s=()=>o(84543);var d=()=>o(838572),p=()=>o(166632),u=()=>o(303862);function m(e,t){let{canUndo:o,shouldPersistOperation:m}=t;const g=(0,r().v3)(),f=(0,n.useRef)([]).current,y=(0,n.useCallback)((e=>{f.push(...e)}),[f]),v=(0,n.useCallback)((e=>{m&&!m(e)||y([e])}),[y,m]),S=(0,u().l)(e,{cacheFallback:g.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0,onOperationCallback:v});(0,n.useEffect)((()=>{d().A.initializeCache(e,S)}),[e,S]);const h=(0,n.useCallback)((()=>{p().default.reset(),d().A.clearCache(e)}),[e]);(0,n.useEffect)((()=>(p().default.reset(),()=>{p().default.reset(),d().A.expire(e)})),[e]);const b=(0,i().K8)((()=>p().default.state.undoStack.length>0),[]);(0,n.useEffect)((()=>{d().A.updateUnsavedCacheState(e,b)}),[e,b]);const x=(0,n.useCallback)((async e=>{if(0===f.length)return void 0;S.assertUnexpired(),function(e){for(const t of p().default.state.undoStack)for(const o of t.transactions)for(const t of o.stores)if(t.inMemoryRecordCache!==e&&!t.inMemoryRecordCache.isMockTextStore){const n=o.getUserActionForAnalyticsPurposesOnly(),r=t.inMemoryRecordCache.name,i=e.name,a=`Undoable user action "${n}" was applied to cache "${r}", but only operations in the cache "${i}" should be in the undo stack!`;(0,l().log)({from:"useLocalDraft",type:"invalidStoreInRevisionStack",level:"error",data:{message:a,miscDataToConvertToString:{userAction:n,inMemoryRecordCacheName:r,expectedInMemoryRecordCacheName:i}}})}}(S);const{serverCommitResult:t}=s().createAndCommit({environment:g,userAction:e,perform(e){!function(e){let{environment:t,transaction:o,operationsWithStores:n}=e;for(const{operation:r,store:i}of n){if(!(i instanceof c().pm))continue;const e=i.clone(t.defaultRecordCache.inMemoryRecordCache);(0,a().ph)(r)?s().applyCrdtTextOperation({store:i,operation:r,transaction:o,invertedOperation:void 0}):s().applyOperation({transaction:o,store:e,operation:r})}}({environment:g,transaction:e,operationsWithStores:f}),e.postSubmitCallbacks.push((e=>{e||(S.expire(),p().default.reset())}))},canUndo:o});return t}),[e,o,g,f,S]);return(0,n.useMemo)((()=>({cache:S,hasChanges:b,persist:x,reset:h})),[b,x,h,S])}function g(e,t){return(0,i().K8)((()=>t.clone(e.cache)),[t,e.cache])}},327665:(e,t,o)=>{o.d(t,{y:()=>i});o(242343);var n=()=>o(174114),r=o(163643);function i(e){let{icon:t,backgroundColor:o,backgroundSize:i}=e;const l=(0,n().IS)((e=>({iconContainer:{height:i??28,width:i??28,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",background:o??e.tint.regular}})),[o,i]);return(0,r.jsx)("div",{style:l.iconContainer,children:t})}},328653:(e,t,o)=>{o.d(t,{d:()=>i});var n=()=>o(758989);const r={light:{gray:{stroke:{secondary:"rgba(84, 72, 49, 0.15)"},fill:{primary:"rgba(84, 72, 49, 0.15)",secondary:"rgba(84, 72, 49, 0.08)",tertiary:"rgba(84, 72, 49, 0.04)"},text:{primary:"#1D1B16"}},red:{stroke:{secondary:"rgba(244, 171, 159, 0.40)"},fill:{primary:"rgba(244, 171, 159, 0.40)",secondary:"rgba(244, 171, 159, 0.40)",tertiary:"rgba(243, 136, 118, 0.07)"},text:{primary:"#5D1715"}},brown:{stroke:{secondary:"rgba(210, 162, 141, 0.35)"},fill:{primary:"rgba(210, 162, 141, 0.35)",secondary:"rgba(210, 162, 141, 0.17)",tertiary:"rgba(210, 162, 141, 0.07)"},text:{primary:"#442A1E"}},orange:{stroke:{secondary:"rgba(224, 124, 57, 0.27)"},fill:{primary:"rgba(224, 124, 57, 0.27)",secondary:"rgba(224, 124, 57, 0.15)",tertiary:"rgba(224, 124, 57, 0.07)"},text:{primary:"#49290E"}},yellow:{stroke:{secondary:"rgba(236, 191, 66, 0.39)"},fill:{primary:"rgba(236, 191, 66, 0.39)",secondary:"rgba(215, 177, 24, 0.15)",tertiary:"rgba(215, 177, 24, 0.07)"},text:{primary:"#402C1B"}},green:{stroke:{secondary:"rgba(123, 183, 129, 0.27)"},fill:{primary:"rgba(123, 183, 129, 0.27)",secondary:"rgba(123, 183, 129, 0.15)",tertiary:"rgba(123, 183, 129, 0.07)"},text:{primary:"#1C3829"}},blue:{stroke:{secondary:"rgba(93, 165, 206, 0.27)"},fill:{primary:"rgba(93, 165, 206, 0.27)",secondary:"rgba(95, 167, 208, 0.15)",tertiary:"rgba(91, 166, 209, 0.07)"},text:{primary:"#183347"}},purple:{stroke:{secondary:"rgba(168, 129, 197, 0.27)"},fill:{primary:"rgba(168, 129, 197, 0.27)",secondary:"rgba(204, 170, 229, 0.15)",tertiary:"rgba(206, 175, 229, 0.07)"},text:{primary:"#412454"}},pink:{stroke:{secondary:"rgba(225, 136, 179, 0.27)"},fill:{primary:"rgba(225, 136, 179, 0.27)",secondary:"rgba(235, 159, 196, 0.15)",tertiary:"rgba(231, 147, 188, 0.07)"},text:{primary:"#4C2337"}}},dark:{gray:{stroke:{secondary:"rgba(255, 255, 255, 0.09)"},fill:{primary:"rgba(255, 255, 255, 0.13)",secondary:"rgba(255, 255, 255, 0.09)",tertiary:"rgba(255, 255, 255, 0.03)"},text:{primary:"rgba(255, 255, 255, 0.81)"}},red:{stroke:{secondary:"rgba(222, 85, 85, 0.25)"},fill:{primary:"rgba(222, 85, 84, 0.30)",secondary:"rgba(222, 85, 84, 0.30)",tertiary:"rgba(222, 85, 88, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},brown:{stroke:{secondary:"rgba(184, 101, 69, 0.25)"},fill:{primary:"rgba(184, 101, 68, 0.30)",secondary:"rgba(184, 101, 68, 0.30)",tertiary:"rgba(184, 101, 72, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},orange:{stroke:{secondary:"rgba(233, 126, 37, 0.20)"},fill:{primary:"rgba(233, 126, 36, 0.30)",secondary:"rgba(233, 126, 36, 0.30)",tertiary:"rgba(233, 126, 40, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},yellow:{stroke:{secondary:"rgba(179, 129, 61, 0.20)"},fill:{primary:"rgba(231, 161, 55, 0.30)",secondary:"rgba(231, 161, 55, 0.30)",tertiary:"rgba(162, 105, 50, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},green:{stroke:{secondary:"rgba(45, 153, 100, 0.20)"},fill:{primary:"rgba(45, 153, 100, 0.30)",secondary:"rgba(45, 153, 100, 0.30)",tertiary:"rgba(45, 153, 100, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},blue:{stroke:{secondary:"rgba(51, 126, 169, 0.20)"},fill:{primary:"rgba(51, 126, 169, 0.33)",secondary:"rgba(51, 126, 169, 0.33)",tertiary:"rgba(51, 126, 169, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},purple:{stroke:{secondary:"rgba(155, 97, 211, 0.18)"},fill:{primary:"rgba(155, 97, 211, 0.28)",secondary:"rgba(155, 97, 211, 0.28)",tertiary:"rgba(155, 97, 211, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},pink:{stroke:{secondary:"rgba(220, 76, 145, 0.22)"},fill:{primary:"rgba(220, 76, 145, 0.30)",secondary:"rgba(220, 76, 145, 0.30)",tertiary:"rgba(220, 76, 145, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}}}};function i(e,t){const o=(0,n().VA)(e),i="lightgray"===o?"gray":o;return{...r[t.mode][i],icon:{primary:n().l8[t.mode][i]}}}},363998:(e,t,o)=>{o.d(t,{Cx:()=>C,Dr:()=>B,If:()=>w,aZ:()=>P,n9:()=>A});o(725707),o(500234);var n=o.n(o(485359)),r=o(242343),i=()=>o(237385),l=()=>o(803290),a=()=>o(174114),c=()=>o(887508),s=()=>o(169201),d=()=>o(653998),p=()=>o(421338),u=()=>o(209684),m=()=>o(701270),g=()=>o(951540),f=()=>o(245388),y=()=>o(137476),v=()=>o(518022),S=()=>o(961397),h=()=>o(197562),b=()=>o(618464),x=o(163643);function C(e){const{sidebar:t,cornerButton:o,preview:n,featuresStep:r}=e,{isPhone:l}=(0,i().Y0)();return(0,x.jsxs)(x.Fragment,{children:[o,(0,x.jsx)(p().Y1,{direction:l?"vertical":"horizontal",height:"fill",padding:l?32:24,gap:l?28:24,style:{minHeight:l?"100vh":0},children:l?(0,x.jsxs)(x.Fragment,{children:[n&&(0,x.jsx)(p().Y1,{width:"fill",height:450,padding:"60px 0 16px 0",style:{maxWidth:400,minHeight:r?"49vh":"54vh"},children:n}),t&&(0,x.jsx)(p().Y1,{width:"fill",height:320,gap:25,style:{flexShrink:0,minHeight:r?"51vh":"46vh"},children:t})]}):(0,x.jsxs)(x.Fragment,{children:[t&&(0,x.jsx)(p().Y1,{width:320,height:"fill",padding:"60px 0 0 0",gap:25,style:{flexShrink:0},children:t}),n]})})]})}function w(e){let{children:t,overrides:o={hideCornerButton:!1},featuresStep:n}=e;const{isPhone:c}=(0,i().Y0)(),s=(0,a().IS)((()=>({sidebarFooter:{flexShrink:0,position:"relative",top:c?-16:void 0}})),[c]),d=(0,l().K8)((()=>h().A.state),[]),u=r.useMemo((()=>{var e,t;if(d.open&&d.collectionTemplate)return null!==(e=d.previewCollectionInfo)&&void 0!==e&&e.focusViewTemplateId?d.previewCollectionInfo.focusViewTemplateId:null===(t=d.userCustomizations.featureTemplateSelections.find((e=>"collection_view"===e.template.type&&e.selected)))||void 0===t?void 0:t.template.templateId}),[d]);if(!d.open||!d.collectionTemplate||!u)return null;const m=(0,x.jsx)(b().Z,{collectionTemplate:d.collectionTemplate,flowId:d.flowId},d.collectionTemplate.setupId);return(0,x.jsx)(C,{sidebar:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(p().Y1,{height:c?300:"fill",padding:2,children:t}),(0,x.jsx)(p().Y1,{style:s.sidebarFooter,children:(0,x.jsx)(I,{modalState:d})})]}),cornerButton:o.hideCornerButton?null:(0,x.jsx)(B,{modalState:d}),preview:m,featuresStep:n})}const k=!1;function I(e){let{modalState:t}=e;const o=(0,d().tz)(),{isPhone:n}=(0,i().Y0)(),{isOnFirstModalStep:r,isOnLastModalStep:a}=(0,l().K8)((()=>({isOnFirstModalStep:!(0,S().pp)(t,n),isOnLastModalStep:!(0,S().Rh)(t,n)})),[t,n]),c=(0,l().K8)((()=>{var e;return!!t.open&&(null===(e=t.setupGenerator)||void 0===e?void 0:e.store.state.isBusy)}),[t]);if(!t.collectionTemplate)return null;const s=o.formatMessage({id:"workflowTemplatesOnboardingModalStep.getStarted",defaultMessage:"Get started"}),p=r&&a;return a?(0,x.jsx)(j,{label:p?s:(0,x.jsx)(d().sA,{id:"workflowTemplatesOnboardingModalStep.done",defaultMessage:"Done"})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(T,{disabled:t.isSaving||t.isFollowUpInputFocused||c,modalState:t,label:r?s:o.formatMessage({id:"workflowTemplatesOnboardingModalStep.continue",defaultMessage:"Continue"})}),k&&!p&&(0,x.jsx)(V,{})]})}function T(e){let{modalState:t,label:o,isLoading:n,disabled:r,onClick:l}=e;const c=(0,a().IS)((()=>({button:{padding:10,width:"100%",height:32,borderRadius:8}})),[]),s=(0,i().v3)(),{isPhone:d}=(0,i().Y0)();return t.collectionTemplate?(0,x.jsx)(g().A,{style:c.button,isLoading:n,disabled:r,onClick:async()=>{h().A.update((e=>({...e,isSaving:!0})));const e=await(null==l?void 0:l());if(h().A.update((e=>({...e,isSaving:!1}))),!1===e)return;const o=(0,S().aO)(t,d);o>=0&&((0,y().u4)({environment:s,event:{eventName:"workflow_template_onboarding_next_step",eventProperties:{next_step:(0,S().Wm)(t)[o],step:(0,S().hq)(t),...(0,S().gM)(t)}}}),h().A.update((e=>({...e,currentStepIndex:o}))))},children:o}):null}function V(){const e=(0,i().v3)(),t=(0,l().K8)((()=>h().A.state),[]);return n()(t.open,"Modal should always be open for this to render."),(0,x.jsx)(u().p,{isGray:!0,style:{height:32,borderRadius:8,justifyContent:"center",marginTop:8},isLoading:t.isSaving,disabled:t.isSaving,onClick:()=>(0,v().createCollectionTemplateFromModalState)({environment:e,modalState:t}),children:(0,x.jsx)("span",{children:"Customize later"})})}function j(e){const{label:t}=e,o=(0,i().v3)(),a=(0,l().O$)(h().A);n()(a.open,"Modal should always be open for this to render.");const c=(0,l().K8)((()=>{var e;return null===(e=a.setupGenerator)||void 0===e?void 0:e.store.state.isBusy}),[a]),s=(0,r.useCallback)((()=>{(0,v().createCollectionTemplateFromModalState)({environment:o,modalState:a})}),[o,a]);return(0,x.jsx)(g().A,{style:{height:32,borderRadius:8},isLoading:a.isSaving,disabled:a.isSaving||a.isFollowUpInputFocused||c,onClick:s,children:t})}function P(e){var t;let{title:o,caption:n}=e;const r=(0,l().O$)(h().A),i=r.open?null===(t=r.collectionTemplate)||void 0===t?void 0:t.value.targetCollection.name:void 0,c=(0,a().IS)((e=>({title:{whiteSpace:"pre-line",hangingPunctuation:"first",textWrap:"balance"}})),[]);return(0,x.jsx)("div",{style:{flexShrink:0},children:(0,x.jsxs)(p().Y1,{gap:4,children:[(0,x.jsx)(m().D,{styleName:"UITitle-22px/Semibold",customStyles:c.title,children:o??(0,x.jsx)(d().sA,{id:"workflowTemplatesOnboardingModal.customizeCollection",defaultMessage:"Customize {collectionName}",values:{collectionName:i}})}),n?(0,x.jsx)(m().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n}):null]})})}function B(e){const{modalState:t}=e;return 0===t.currentStepIndex?(0,x.jsx)(_,{}):(0,x.jsx)(M,{modalState:t})}function A(e){const{iconFn:t,onClick:o,style:n}=e,{isPhone:r}=(0,i().Y0)(),l=(0,a().IS)((e=>({button:{position:"absolute",top:r?56:20,left:20,zIndex:1,height:26,paddingLeft:5,paddingRight:5,...n},icon:{width:r?20:16,height:r?20:16,fill:e.icon.secondary}})),[n,r]);return(0,x.jsx)(u().p,{onClick:o,style:l.button,children:t(l.icon)})}function _(){const e=(0,r.useContext)(f().eh);return(0,x.jsx)(A,{iconFn:s().u,onClick:()=>null==e?void 0:e()})}function M(e){const{modalState:t,style:o}=e,n=(0,i().v3)(),{isPhone:l}=(0,i().Y0)(),a=(0,r.useCallback)((()=>{const e=t.currentStepIndex,o=Math.max(0,t.currentStepIndex-1);(0,v().moveToPreviousOnboardingStep)(l),(0,y().u4)({environment:n,event:{eventName:"workflow_template_onboarding_previous_step",eventProperties:{previous_step:(0,S().Wm)(t)[o],step:(0,S().Wm)(t)[e],...(0,S().gM)(t)}}})}),[n,t,l]);return t.collectionTemplate?(0,x.jsx)(A,{style:o,iconFn:c().v,onClick:a}):null}},471745:(e,t,o)=>{o.d(t,{A:()=>r});o(725707),o(500234);class n extends(()=>o(151255))().A{findTableHeaderCell(e,t){return this.find((o=>o.collectionContextStore===e&&o.property===t))}}const r=new n},618464:(e,t,o)=>{o.d(t,{Z:()=>$,c:()=>Q});o(725707),o(491955),o(403517);var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(174114),a=()=>o(951592),c=()=>o(64713),s=()=>o(421338),d=()=>o(142708),p=()=>o(35462),u=()=>o(390263),m=()=>o(96297),g=()=>o(471745),f=()=>o(98508),y=()=>o(194585),v=(o(500234),()=>o(259897)),S=()=>o(197562);var h=()=>o(505966),b=()=>o(84543),x=()=>o(921706),C=()=>o(745859),w=()=>o(314164),k=()=>o(486963),I=()=>o(605845),T=()=>o(823301),V=()=>o(940445),j=()=>o(727528);function P(e){var t;let{environment:o,collectionTemplate:n,featureTemplate:r,collectionViewBlockStore:i,previousFeatureSelections:l,examplePageStores:a}=e;const c=null==i?void 0:i.getCollectionStore();if(!c)return;const s=(0,j().Zp)({environment:o,scopeStore:c,templateId:r.templateId});if(s&&!(0,j().DM)(s))return;(null===(t=l.find((e=>e.template.templateId===r.templateId)))||void 0===t?void 0:t.selected)??!1?s&&b().createAndCommit({userAction:"workflowTemplatesOnboardingPreview.removeFeatureTemplate",environment:o,canUndo:!1,perform:e=>{_({environment:o,transaction:e,collectionViewBlockStore:i,collectionStore:c,instancePointer:s,previousSelectionIds:l.map((e=>e.template.templateId))})}}):b().createAndCommit({userAction:"workflowTemplatesOnboardingPreview.addFeatureTemplate",environment:o,canUndo:!1,perform:e=>{B({environment:o,transaction:e,collectionViewBlockStore:i,collectionStore:c,collectionTemplate:n,featureTemplate:r,existingInstancePointer:s,examplePageStores:a})}})}function B(e){let{environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,featureTemplate:i,existingInstancePointer:l,examplePageStores:a,collectionTemplate:c}=e;if(!n||!(0,h().Jb)(i))return;const s=l&&(0,j().aI)({environment:t,instancePointer:l,inMemoryRecordCache:r.inMemoryRecordCache});if(!s||"compound"===l.type)if(s&&"compound"===l.type)for(const d of l.instancePointers)if("property"===d.type)M({environment:t,transaction:o,propertyId:d.id,collectionStore:r});else{const e=(0,j().Fy)({environment:t,collectionStore:r,instancePointerId:d.id});if(!e)return;B({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,collectionTemplate:c,featureTemplate:e,existingInstancePointer:d,examplePageStores:a})}else if(!A({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,featureTemplate:i})){if("compound"===i.type)for(const e of i.value.templateItems){const i=V().globalWorkflowTemplates.fromId(e.pointer);"property"===i.type&&A({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,featureTemplate:i})}(0,I().ai)({environment:t,transaction:o,collectionStore:r,template:i,logger:new(V().WorkflowTemplateLogger),origin:"onboarding_preview",preserveCollectionFeatureOrdering:c,examplePageStores:a})}}function A(e){var t,o;const{environment:n,transaction:r,collectionStore:i,collectionViewBlockStore:l,featureTemplate:a}=e,c=null===(t=(0,k().U)(l))||void 0===t?void 0:t.normalizedDeletedSchemaStore.state,s=c&&(null===(o=Object.entries(c))||void 0===o?void 0:o.find((e=>{var t;let[o,n]=e;return(null==n||null===(t=n.workflow_template_instance)||void 0===t?void 0:t.template_id)===a.templateId})));return!!s&&(M({environment:n,transaction:r,propertyId:s[0],collectionStore:i}),!0)}function _(e){let{environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,instancePointer:i,previousSelectionIds:l}=e;"compound"===i.type?function(e){let{environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,instancePointer:i,previousSelectionIds:l}=e;if("compound"!==i.type)return;const a=(0,j().FE)({environment:t,collectionStore:r}).find((e=>e.instancePointer.id===i.id));if(!a)return;const c=(0,j().aL)({environment:t,collectionStore:r,compoundTemplateInstancesToDelete:[a]}).filter((e=>{const o=(0,j().Fy)({environment:t,collectionStore:r,instancePointerId:e.id});return o&&!l.includes(o.templateId)}));for(const s of c)_({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,instancePointer:s,previousSelectionIds:l});(0,T().HQ)({environment:t,transaction:o,collectionStore:r,instance:i})}({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,instancePointer:i,previousSelectionIds:l}):(0,I().Z5)({environment:t,transaction:o,collectionViewBlockStore:n,collectionStore:r,instancePointer:i})}function M(e){let{environment:t,transaction:o,collectionStore:n,propertyId:r}=e;const i=w().KA({deletedSchema:n.getDeletedSchema(),property:r});i&&((0,C().F)({environment:t,collectionStore:n,update:i.updateSchema,transaction:o}),(0,x().E)({collectionStore:n,update:i.updateDeletedSchema,transaction:o}))}function F(){const e=(0,r().v3)(),{featureTemplateSelections:t,prevFeatureTemplateSelections:o}=(0,i().K8)((()=>{const e=S().A.state;return e.open&&e.collectionTemplate?{featureTemplateSelections:e.userCustomizations.featureTemplateSelections,prevFeatureTemplateSelections:e.userCustomizations.prevFeatureTemplateSelections}:{}}),[]);(0,n.useEffect)((()=>{o&&function(e){let{environment:t,featureTemplateSelections:o,prevFeatureTemplateSelections:n}=e;const r=S().A.state;if(!r.open||!r.collectionTemplate||!r.previewCollectionInfo)return;const{collectionTemplate:i,previewCollectionInfo:l}=r,a=n.filter((e=>{const t=o.find((t=>t.template.templateId===e.template.templateId));return t&&t.selected!==e.selected}));for(const c of a)P({environment:t,collectionTemplate:i,featureTemplate:c.template,previousFeatureSelections:n,collectionViewBlockStore:l.collectionViewBlockStore,examplePageStores:l.examplePageStores})}({environment:e,featureTemplateSelections:t,prevFeatureTemplateSelections:o})}),[e,t,o])}var R=()=>o(102659),z=()=>o(468933),O=()=>o(246132),H=()=>o(595922),K=()=>o(752414);const D=3;o(324989),o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(113085);var L=()=>o(76394);function N(e){let{normalizedSchema:t,collectionView:o,considerGroupByAsVisible:n=!1}=e;const r=function(e){let{collectionView:t,includeGroupByProperties:o=!1}=e;const n={},r=e=>{if(e)for(const t of e)n[t.property]||(n[t.property]=[]),n[t.property].push(t)},i=t.getType(),l=t.getFormatStore();switch(i){case"board":if(r(l.getKeyValue("board_properties")),o){const e=l.getKeyValue("board_columns_by");e&&r([{property:e.property,visible:!0}])}break;case"calendar":r(l.getKeyValue("calendar_properties"));break;case"gallery":r(l.getKeyValue("gallery_properties"));break;case"list":r(l.getKeyValue("list_properties"));break;case"timeline":r(l.getKeyValue("timeline_properties")),r(l.getKeyValue("timeline_table_properties"));break;case"table":r(l.getKeyValue("table_properties"));break;case"chart":case"chat":case"feed":case"page":case"form_editor":case"map":case"custom":break;default:(0,L().HB)(i)}if(o){const e=l.getKeyValue("collection_group_by");e&&r([{property:e.property,visible:!0}])}return n}({collectionView:o,includeGroupByProperties:n}),i={visibleProperties:new Set,invisibleProperties:new Set};for(const l of Object.keys(t)){const e=r[l];(null==e?void 0:e.some((e=>e.visible)))??!1?i.visibleProperties.add(l):i.invisibleProperties.add(l)}return i}var U=()=>o(916963),Y=()=>o(31448),W=o(163643);function E(e){let{collectionContextStore:t}=e;const n=(0,i().K8)((()=>{var e;const o=t.collectionStore(),n=null===(e=t.collectionViewStore())||void 0===e?void 0:e.getModel();if(!o||!n)return[];const{invisibleProperties:r}=N({normalizedSchema:o.getSchema(),collectionView:n,considerGroupByAsVisible:!0});return Array.from(r)}),[t]),r=n.length,a=(0,l().IS)((e=>({container:{position:"absolute",zIndex:1,bottom:0,right:0,margin:8,color:e.text.primary,opacity:0===r?0:1,transition:0===r?"opacity 0s ease":"opacity 0.1s ease"},button:{backdropFilter:"blur(40px)"}})),[r]);return(0,W.jsx)("div",{style:a.container,children:(0,W.jsx)(o(103151).A,{alignment:o(907721).C.Start,renderTooltip:()=>(0,W.jsx)(Z,{collectionContextStore:t,invisibleProperties:n}),render:e=>(0,W.jsx)(o(209684).p,{hovered:!0,disabled:!0,...e,style:a.button,children:(0,W.jsx)(o(701270).D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,W.jsx)(o(653998).sA,{id:"hiddenPropertiesIndicator.hiddenCount",defaultMessage:"{numHiddenProperties, plural, one {1 hidden property} other {# hidden properties}}",values:{numHiddenProperties:r}})})})})})}function Z(e){let{collectionContextStore:t,invisibleProperties:o}=e;const n=(0,l().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:4,marginTop:2,marginBottom:2},propertyContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:2},propertyIcon:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},propertyName:{maxWidth:150,...Y().RC}})),[]),r=(0,i().K8)((()=>{var e;const n=(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{},r={};for(const t of o){const e=n[t];e&&(r[t]=e)}return r}),[t,o]),a=(0,l().DP)();return(0,W.jsx)("div",{style:n.container,children:o.flatMap((e=>{const t=r[e];return t?[(0,W.jsxs)("div",{style:n.propertyContainer,children:[(0,W.jsx)(U().zB,{icon:t.icon,type:t.type,size:14,style:n.propertyIcon,theme:a,willShowOnTooltip:!0}),(0,W.jsx)("span",{style:n.propertyName,children:t.name})]},t.name)]:[]}))})}const G=n.memo(E);function $(e){let{collectionTemplate:t,flowId:o}=e;const m=(0,r().v3)(),{isPhone:g}=(0,r().Y0)(),h=g?10:32,x=(0,n.useMemo)((()=>({flowId:o,location:"workflow_templates_onboarding",isPreviewing:!0,disableAllPointerEvents:!0,disablePageLinks:!0,hideTableAggregationRow:!0,hideViewBlockSource:!0})),[o]),C=function(){const e=(0,r().v3)(),t=(0,O().S)(z().Zu,{canUndo:!0}),o=(0,n.useRef)(void 0),l=(0,i().O$)(S().A);return(0,n.useEffect)((()=>{if(l.open&&l.collectionTemplate&&l.parentStore&&!o.current){var n;const{performResult:{collectionStore:r,collectionViewBlockStore:i,collectionViewStore:a,examplePageStores:c}}=b().createAndCommit({userAction:"workflowTemplateCustomizationOnboarding.previewCollection",environment:e,perform:o=>{const{collectionStore:n,collectionViewBlockStore:r,collectionViewStore:i,examplePageStores:a}=(0,K().mm)({environment:e,existingCollectionInfo:void 0,inMemoryRecordCache:t.cache,parentStore:l.parentStore.clone(t.cache),template:l.collectionTemplate,transaction:o,logger:new(V().WorkflowTemplateLogger)});if(0===a.length){const t=new(H().A)(e);for(let r=0;r<D;r++)(0,R().Q)({environment:e,collectionContextStore:t,groupsPointer:[],insertAtIndex:0,shouldCoerce:!0,templateStore:t.defaultPageTemplateStore.state,transaction:o,from:{createBlock:"workflow_template"},inMemoryRecordCache:n.inMemoryRecordCache})}return{collectionViewBlockStore:r,collectionViewStore:i,collectionStore:n,examplePageStores:a}},canUndo:!1});o.current={collectionStore:r,collectionViewBlockStore:i,collectionViewStore:a},S().A.setState({...l,previewCollectionInfo:{collectionViewBlockStore:i,examplePageStores:c,collectionContextStore:void 0,focusViewTemplateId:null===(n=l.previewCollectionInfo)||void 0===n?void 0:n.focusViewTemplateId}})}}),[l,t,e]),o.current}(),w=(0,i().K8)((()=>S().A.getPreviewCollectionContextStore()),[]),k=(0,i().K8)((()=>{const e=null==w?void 0:w.getViewType();return"gallery"===e||"list"===e?h:0}),[w,h]),I=(0,i().K8)((()=>C?function(e){let{collectionStore:t,collectionViewStore:o}=e;const n=t.getSchema(),r=o.getFormat().table_properties;return null==r?void 0:r.filter((e=>{let{property:t}=e;return t in n})).map((e=>{let{property:t}=e;return t}))}(C):void 0),[C]),T=(0,a().ZC)(I),j=(0,n.useCallback)((e=>{S().A.updatePreviewCollectionContextStore(e)}),[]);F(),function(){const{viewTemplateId:e,collectionViewBlockStore:t,collectionContextStore:o}=(0,i().K8)((()=>{var e;const t=S().A.state;return t.open&&t.collectionTemplate&&null!==(e=t.previewCollectionInfo)&&void 0!==e&&e.collectionContextStore?{viewTemplateId:t.previewCollectionInfo.focusViewTemplateId,collectionViewBlockStore:t.previewCollectionInfo.collectionViewBlockStore,collectionContextStore:t.previewCollectionInfo.collectionContextStore}:{viewTemplateId:void 0,collectionViewBlockStore:void 0,collectionContextStore:void 0}}),[]),l=(0,a().ZC)(e),c=(0,r().v3)();(0,n.useEffect)((()=>{var n;if(e===l)return;if((null==o||null===(n=o.collectionViewStore())||void 0===n||null===(n=n.getFormat().workflow_template_instance)||void 0===n?void 0:n.template_id)===e)return;const r=null==t?void 0:t.getCollectionViewStores().find((t=>{var o;return(null===(o=t.getFormat().workflow_template_instance)||void 0===o?void 0:o.template_id)===e}));r&&o&&(0,v().t)({environment:c,collectionContextStore:o,collectionViewId:r.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}),[e,l,t,o,c])}(),(0,n.useEffect)((()=>{!function(e){let{collectionContextStore:t,previousPropertyIds:o,propertyIds:n,environment:r}=e;const i=null==t?void 0:t.collectionViewStore(),l=t&&"table"===(null==i?void 0:i.getType())&&n&&o&&n!==o;if(!l)return;if(n.length===o.length)return;if(n.length<o.length){const e=o.findIndex((e=>!n.includes(e)));Q({propertyId:0===e?n[0]:n[e-1],collectionContextStore:t,environment:r})}else{const e=n.filter((e=>!o.includes(e)));Q({propertyId:e[e.length-1],collectionContextStore:t,environment:r})}}({collectionContextStore:w,previousPropertyIds:T,propertyIds:I,environment:m})}),[w,T,I,m]);const P=(0,l().IS)((e=>({container:{position:"relative",backgroundColor:e.contentBackground,paddingTop:h,overflowY:"auto",borderRadius:12,border:`1px solid ${e.stroke.primary}`},titleWrapper:{display:"flex",alignItems:"center",paddingLeft:g?h+10:h+8,margin:"8px 0"},titleText:{fontSize:24,fontWeight:700,lineHeight:"26px",whiteSpace:"pre-line",marginLeft:12,overflow:"initial"},collectionViewScroller:{height:"100%",paddingBottom:h-8}})),[h,g]);return t?(0,W.jsxs)(s().Y1,{height:"fill",style:P.container,children:[(0,W.jsxs)("div",{style:P.titleWrapper,children:[(0,W.jsx)(y().z,{template:t,size:28}),(0,W.jsx)(p().A,{style:P.titleText,children:t.value.targetCollection.name})]}),(0,W.jsx)(d().H,{type:f().A.All,style:P.collectionViewScroller,children:(0,W.jsx)(u().tx,{value:x,children:C&&(0,W.jsx)(c().dN,{store:C.collectionViewBlockStore,disabled:!0,productUseCase:"preview_collection",forceLocalQueryCollection:!0,headerActionsBehavior:"hidden",overridePaddingLeft:g?h+4:h,overridePaddingRight:k,setCollectionContextStore:j})})}),w&&(0,W.jsx)(G,{collectionContextStore:w})]}):(0,W.jsx)(s().Y1,{height:"fill",style:P.container})}function Q(e){let{propertyId:t,collectionContextStore:o,environment:n,padding:r=150}=e;const i=g().A.findTableHeaderCell(o,t);if(!i)return;const l=i.getNode();if(!l)return;const a=(0,m().T8)(l);if(!a)return;const c=l.getBoundingClientRect(),s=a.getBoundingClientRect(),d=c.left-s.left,p=c.right-s.left,u=a.clientWidth;let f;p>u-r?f=p-u+r:d<r&&(f=d-r),f&&m().VG({element:a,environment:n,options:{left:a.scrollLeft+f,behavior:"smooth"}})}}}]);