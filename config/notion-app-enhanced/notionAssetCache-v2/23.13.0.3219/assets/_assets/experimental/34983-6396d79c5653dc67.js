"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[34983],{18376:(e,t,o)=>{o.d(t,{W:()=>u});var n=()=>o(477784),i=()=>o(652039),a=()=>o(883249),r=()=>o(145046),s=()=>o(927999),l=()=>o(791497),d=()=>o(84543),c=()=>o(663539);const g=1500,p=(0,o(653998).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},preparing:{defaultMessage:"Preparing...",id:"pageCover.status.preparing"},downloading:{defaultMessage:"Downloading...",id:"pageCover.status.downloading"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image linkâ€¦",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function u(e){let{environment:t,intl:o,store:n,rect:i}=e;l().W(t,{originGap:3,originRect:i,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:o.formatMessage(p.pageCover),onDelete:()=>{!function(e){let{environment:t,store:o}=e;l().I(),d().createAndCommit({userAction:"PageCover.handleDelete",environment:t,canUndo:!0,perform:e=>{s().PT({store:o,transaction:e})}})}({environment:t,store:n})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:o,position:i}=e;m({environment:t,store:n,url:{originUrl:o},position:i})}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:o.formatMessage(p.fileTypeCaption,{idealImageWidth:g}),onUpload:e=>{var i;l().I(),c().QM({environment:t,file:e[0],bucket:"secure",record:(null===(i=n.getCoverStore())||void 0===i?void 0:i.pointer)??n.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:v,onProgress:f,onComplete:e=>{var o;o={environment:t,store:n,url:{originUrl:e}},h({...o,position:.5})},onError:()=>{r().f1(o.formatMessage(p.uploadFailed))}})}},{type:"embed",title:o.formatMessage(p.embedTitle),inputPlaceholder:o.formatMessage(p.embedPlaceholder),caption:o.formatMessage(p.embedCaption),buttonText:o.formatMessage(p.embedSubmit),onChange:e=>{var o;o={environment:t,store:n,url:e},h({...o,position:.5}),l().I()}},{type:"unsplash",onChange:e=>{let{url:o,position:i}=e;m({environment:t,store:n,url:{originUrl:o},position:i})}}]})}async function h(e){const{environment:t,store:o,url:r,position:l}=e,{serverCommitResult:c}=d().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{s().fg({store:o,url:r,position:l||.5,transaction:e})}});await c,a().A.state.loadingMode===i().vS&&a().A.setState({loadingMode:i().Gi,dataURL:a().A.state.dataURL,uploadProgress:t.device.isMobileNative?void 0:100,progressText:n().A.formatMessage(p.downloading)})}function m(e){h(e),e.environment.device.isMobile&&l().I()}function v(e){const{file:t,name:o,size:r}=e;if(l().I(),a().A.setState({loadingMode:i().Wc,file:t,name:o,size:r}),t.type.indexOf("image")>=0)if(t instanceof File){const e=new FileReader;e.onload=e=>{a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,uploadProgress:0,dataURL:e.target.result})},e.readAsDataURL(t)}else a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,dataURL:t.dataURL,progressText:n().A.formatMessage(p.preparing)});else a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,progressText:n().A.formatMessage(p.preparing)})}function f(e){const{progressPercent:t,progressText:o}=e;a().A.state.loadingMode===i().vS&&a().A.setState({...a().A.state,uploadProgress:t,progressText:o})}},143920:(e,t,o)=>{o.d(t,{y:()=>c});var n=()=>o(763555),i=()=>o(284320);const a={ko:()=>o.e(2268).then(o.bind(o,662161)),es:()=>o.e(95264).then(o.bind(o,894994)),de:()=>o.e(35390).then(o.bind(o,133788)),fr:()=>o.e(3272).then(o.bind(o,447454)),pt:()=>o.e(27315).then(o.bind(o,193182)),zh:()=>o.e(69945).then(o.bind(o,316605)),ja:()=>o.e(77757).then(o.bind(o,108299)),da:()=>o.e(9423).then(o.bind(o,965826)),fi:()=>o.e(59337).then(o.bind(o,122956)),nb:()=>o.e(2040).then(o.bind(o,763585)),nl:()=>o.e(51106).then(o.bind(o,696090)),sv:()=>o.e(53631).then(o.bind(o,485349))};let r=!1,s=!1;async function l(e){for(const[o,i]of Object.entries(e.emojiLocaleKeywords)){var t;n().fB[o]={...n().fB[o],keywords:[...i,...(null===(t=n().fB[o])||void 0===t?void 0:t.keywords)||[]]}}await i().A.waitUntilLoaded(),i().A.update((t=>{let{emojiByName:o,...n}=t;return{...n,emojiByName:{...o,...e.emojiByName}}}))}async function d(){if(r)return;const[e]=o(16791).locale.split("-");e in a&&(await l(await a[e]()),r=!0)}const c=(0,o(531367).A)((async()=>{await async function(){s||(await l(await o.e(51872).then(o.bind(o,531983))),s=!0)}(),await d()}))},150936:(e,t,o)=>{o.d(t,{b:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},180365:(e,t,o)=>{o.d(t,{A:()=>S});var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(653998),s=()=>o(927999),l=()=>o(18376),d=()=>o(84543),c=()=>o(481148),g=()=>o(400885),p=()=>o(802955),u=()=>o(652039),h=()=>o(883249),m=()=>o(470414),v=()=>o(615917),f=()=>o(126451),b=()=>o(392968),y=()=>o(174114),C=()=>o(76394),x=o(163643);function A(e){let{src:t,placeholderSrc:o,placeholderBehavior:i,imageStyle:a,containerStyle:r,onLoadComplete:s,testId:l}=e;const[d,c]=(0,n.useState)(!0);let g;switch(i){case"force-show-placeholder":g=!0;break;case"force-show-src":g=!1;break;case"show-placeholder-if-loading-src":g=!!o&&(d||void 0===t);break;default:(0,C().HB)(i)}const p=(0,y().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...r},srcWrapper:{...g&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[r,g]);(0,n.useEffect)((()=>{void 0!==t&&c(!0)}),[t]);const u=(0,n.useCallback)((e=>{c(!1),null==s||s()}),[s]);return(0,x.jsxs)("div",{style:p.container,children:[(0,x.jsx)(b().Ay,{src:t,onLoad:u,style:a,placeholderStyle:p.srcWrapper,placeholderLoadedStyle:p.srcWrapper,testId:l}),o&&(0,x.jsx)(b().Ay,{src:o,style:a,placeholderStyle:p.placeholderWrapper,placeholderLoadedStyle:p.placeholderWrapper})]})}var w=()=>o(410090);const S=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:c,height:g,proxyWidth:p}=e;const m=(0,i().v3)(),v=(0,a().uB)(void 0,o(116586).A),f=(0,a().K8)((()=>r||"suggest"===o(615661).Uv.getMode(t)),[r,t]),y=(0,a().K8)((()=>t.getCover()),[t]),C=(0,a().O$)(h().A),[w,S]=(0,n.useState)(void 0);if(!y)return null;const R=C.loadingMode!==u().pF&&C.loadingMode!==u().Wc;return(0,x.jsx)(o(982717).A,{mouseStore:v,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:n,reset:i}=e;d().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{s().yY({store:t,coverPosition:n,transaction:e}),i()}})}(e,t,m),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:i,isVisible:a,isRepositioning:r}=e;return(0,x.jsx)(k,{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:i,isVisible:a,isRepositioning:r,lastProxiedUrl:w,store:t,disabled:f,paddingRight:l,paddingLeft:c,mouseStore:v})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:g,maxHeight:280,cursor:"default"},render:e=>(0,x.jsxs)(n.Fragment,{children:[(0,x.jsx)(o(283992).A,{url:y.cover,isAuthenticated:!0,permissionRecord:y.pointer,width:p,onFinishedLoadingProxyUrl:S,render:(t,o)=>{const n={width:"100%",height:g,maxHeight:280,objectFit:"cover",opacity:R?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},i={width:"100%",height:g,maxHeight:280};return(0,x.jsx)(A,{src:o,placeholderSrc:R?C.dataURL:void 0,placeholderBehavior:R?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:i,imageStyle:n,onLoadComplete:M,testId:"pageCover"})}}),R&&(0,x.jsxs)("div",{style:b().fd,children:[(0,x.jsx)(o(966789).A,{size:"md",style:{marginRight:4}}),(0,x.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:void 0!==C.uploadProgress?(0,x.jsx)(o(335157).A,{percentage:C.uploadProgress}):C.progressText?(0,x.jsx)("span",{children:C.progressText}):null})]})]})})};function M(){h().A.reset()}function k(e){let{isVisible:t,isRepositioning:o,handleCancelClick:s,handleRepositionClick:d,handleSavePositionClick:b,lastProxiedUrl:y,store:C,disabled:A,paddingRight:S,paddingLeft:M,mouseStore:k}=e;const R=(0,i().v3)(),P=(0,r().tz)(),j=(0,n.useCallback)((e=>function(e,t,o,n,i){i.reset();const a=e.target.getBoundingClientRect();l().W({environment:t,intl:o,store:n,rect:a})}(e,R,P,C,k)),[R,P,C,k]),L=(0,a().K8)((()=>h().A.state.loadingMode),[]),T=(0,a().K8)((()=>function(e){let t;return t=Boolean(e.isFullWidth())?"100%":g().x6,t}(C)),[C]),{device:I}=R,U=(0,a().K8)((()=>!o&&!(0,c().LX)({device:I})),[o,I]),B=(0,a().O$)(p().e);if(A||L!==u().pF||!B)return null;const{isMobile:W}=I;return(0,x.jsx)(v().A,{animate:{width:T,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,x.jsxs)(m().A,{isVisible:t,position:"bottom",style:{marginRight:S,marginLeft:M},children:[U&&(0,x.jsx)(f().A,{style:{borderRight:W?"none":void 0,...w().k},onClick:j,children:(0,x.jsx)(r().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!W&&(0,x.jsx)(f().A,{style:{...w().k,borderRight:"none"},onClick:e=>d(e,y),children:(0,x.jsx)(r().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!W&&(0,x.jsx)(f().A,{style:w().k,onClick:b,children:(0,x.jsx)(r().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!W&&(0,x.jsx)(f().A,{style:{...w().k,borderRight:"none"},onClick:s,children:(0,x.jsx)(r().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}},470414:(e,t,o)=>{o.d(t,{A:()=>c});o(725707),o(491955),o(403517),o(229032);var n=o(242343),i=()=>o(174114),a=()=>o(755002),r=()=>o(31448),s=()=>o(551116),l=o(163643);function d(e){const{button:t,isLast:o}=e,s=(0,i().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return n.cloneElement(t,{...(0,a().AH)(t.props.style,s.button,o&&s.buttonLast),hoveredStyle:(0,a().AH)(s.buttonHovered,o&&s.buttonLast).style,pressedStyle:s.buttonPressed})}const c=function(e){let{children:t,isVisible:c,position:g,style:p}=e;const u=(0,o(237385).v3)(),h=(0,i().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:s().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:u.device.isMobile?"auto":"none",opacity:u.device.isMobile?1:0,fontFamily:r().vc(o(16791).locale).sans,position:"absolute",right:s().A.horizontal.small,bottom:s().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:s().A.vertical.small,bottom:void 0}})),[u]),m=n.Children.toArray(t).filter(o(76394).O9),v=m.length;return(0,l.jsx)(o(615917).A,{animate:{opacity:c?1:0},...(0,a().AH)(h.container,p,c&&h.containerHover,"top"===g&&h.containerTop),children:m.map(((e,t)=>{const i=t===v-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(103151).A&&n.isValidElement(e))return n.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,l.jsx)(d,{isLast:i,button:n},e.key)}});if(e.type===o(126451).A&&n.isValidElement(e))return(0,l.jsx)(d,{isLast:i,button:e},e.key)}}))})}},472951:(e,t,o)=>{o.d(t,{k:()=>i});o(403517);class n extends(()=>o(129044))().default{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}getSortedUserIds(){return Object.entries(this.state||{}).sort(((e,t)=>{let[o,n]=e,[i,a]=t;return a-n})).map((e=>{let[t,o]=e;return t}))}}const i=new n;(0,o(996094).exposeDebugValue)("UserSimilarityStore",i)},531367:(e,t,o)=>{function n(e){let t,o,n;return async function(){for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return t?(n=a,o||(o=t.then((()=>(o=void 0,t=e(...n),t))),o)):(t=e(...a),t)}}o.d(t,{A:()=>n})},652039:(e,t,o)=>{o.d(t,{Ay:()=>l,Gi:()=>a,Wc:()=>n,pF:()=>r,vS:()=>i});const n="loadingLocalImage",i="uploading",a="downloading",r="loaded";class s extends(()=>o(129044))().default{getInitialState(){return{loadingMode:r}}}const l=s},883249:(e,t,o)=>{o.d(t,{A:()=>n});const n=new(o(652039).Ay)},982717:(e,t,o)=>{o.d(t,{A:()=>v});var n=o(242343),i=()=>o(16791),a=()=>o(237385),r=()=>o(803290),s=()=>o(755002),l=()=>o(653998),d=()=>o(220413),c=()=>o(975392),g=()=>o(31448),p=()=>o(141666),u=()=>o(615917),h=o(163643);const m={isRepositioning:!1};const v=function(e){const t=(0,n.useRef)(null),i=(0,a().v3)(),{isMobile:l}=(0,a().Y0)(),[d,g]=(0,n.useState)(m),u=(0,n.useCallback)((()=>{g(m)}),[]),{renderControl:v,onFlushTemporaryPosition:b,style:y,source:C,store:x}=e,{isRepositioning:A,image:w,startDragRenderedPosition:S,startDragImageScreenHeight:M}=d,k=(0,r().K8)((()=>0===o(182613).default.state.stores.length),[]),[R,P]=(0,n.useState)(!1),j=(0,r().uB)(e.mouseStore,o(116586).A),L=(0,r().K8)((()=>j.state.mouseEntered),[j]),T=(0,o(174114).IS)((()=>({dragContainer:{width:"100%",cursor:A?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[A]),I=(0,r().K8)((()=>function(e,t,o){return(0,c().Et)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,c().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,p().pN)(t)?o:t}}const n=t.getFormat(),i=n.page_cover_position;if((0,c().Et)(i))return i;return o}(e,t)}(C,x,d.temporaryPosition)),[d.temporaryPosition,C,x]);(0,n.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&A&&b({imagePosition:I,reset:()=>{j.reset(),u()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[I,A,j,b,u]),A&&!k&&u();const U=(0,n.useMemo)((()=>(0,c().nF)((e=>{j.setState({...j.state,mouseEntered:!0})}),100)),[j]),B=(0,n.useMemo)((()=>(0,c().sg)((e=>{j.setState({...j.state,mouseEntered:!1})}),100)),[j]),W=(0,n.useCallback)(((e,t)=>{o(360378).IU({environment:i});const n=new Image;n.onload=()=>{g((e=>({...e,isRepositioning:!0,image:n})))},t&&(n.src=t)}),[i]),E=(0,n.useCallback)((e=>{b({imagePosition:I,reset:()=>{u()}})}),[I,b,u]),D=(0,n.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(152058).p)(t)&&P(!0)}),[]),F=(0,n.useCallback)((()=>{P(!0)}),[]),H=(0,n.useCallback)((e=>{if(w&&A){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/w.width*w.height;g((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:I})))}}}),[w,I,A]),z=(0,n.useCallback)((e=>{if(A){const t=e.diffY/(M||0)+(S||0);g((e=>({...e,temporaryPosition:(0,c().LI)((0,o(944342).A)(t,0,1),4)})))}}),[A,M,S]),K=(0,n.useCallback)((()=>{g((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),V=(0,r().K8)((()=>v({handleRepositionClick:W,handleSavePositionClick:E,handleCancelClick:u,isVisible:l||L||R||A,isRepositioning:A})),[W,E,R,l,A,L,v,u]);return(0,h.jsxs)("div",{ref:t,onFocus:D,onBlur:F,onMouseEnter:U,onMouseMove:U,onMouseLeave:B,...(0,s().AH)(T.container,y),children:[(0,h.jsx)(o(928567).A,{onDraggableDragStart:H,onDraggableDragMove:z,onDraggableDragEnd:K,onDraggableDragCancel:K,disabled:!A,render:t=>(0,h.jsx)("div",{...(0,s().AH)(T.dragContainer),...t,children:e.render({imagePosition:I,isRepositioning:A})})}),(0,h.jsx)(f,{small:e.small,isRepositioning:A}),V]})};function f(e){let{small:t,isRepositioning:o}=e;if(t)return null;const n={background:d().Ay.blackWithAlpha(.4),borderRadius:4,color:d().Ay.white,fontSize:12,fontFamily:g().vc(i().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,h.jsx)(u().A,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:n,children:(0,h.jsx)(l().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}}}]);