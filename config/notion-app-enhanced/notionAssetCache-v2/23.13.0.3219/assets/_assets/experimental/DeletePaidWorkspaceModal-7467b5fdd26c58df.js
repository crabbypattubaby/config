"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98906],{922664:(e,s,t)=>{t.r(s),t.d(s,{DeletePaidWorkspaceModal:()=>b});var n=t(242343),o=()=>t(237385),r=()=>t(803290),a=()=>t(214144),u=()=>t(647242),i=()=>t(331863),c=()=>t(395665),l=()=>t(653998),d=()=>t(975392),p=()=>t(421650),h=()=>t(575015),f=()=>t(485966),v=()=>t(384055),g=()=>t(613313),y=()=>t(981899),S=()=>t(875500),m=()=>t(469461),w=()=>t(795266),_=t(163643);function b(e){let{isOpen:s,onClose:t,onConfirmDelete:d,billingData:S,spaceStore:b}=e;const k=(0,o().v3)(),O=(0,u().AI)(S),x="free",[C,I]=n.useState("survey"),[D,V]=n.useState({reasons:[],reasonOther:void 0,reasonOtherTools:void 0}),[A]=n.useState(a().JW()),[B,j]=n.useState(void 0),P=(0,r().K8)((()=>Boolean(null==b?void 0:b.canAdmin())),[b]);(0,n.useEffect)((()=>p().u4(k,{name:"churn_survey",args:{churnType:O,reasons:D.reasons,reasonOther:D.reasonOther,reasonOtherTools:D.reasonOtherTools,stage:C,churnSurveyId:A}})),[k,C,D,A,O]);const R=n.useCallback((()=>{p().u4(k,{name:"churn_survey_close",args:{churnSurveyId:A}}),t()}),[A,k,t]),W=n.useCallback((()=>{R(),d()}),[R,d]);return(0,_.jsx)(w().W,{step:C,isOpen:s,onClose:R,children:(()=>{switch(C){case"survey":return(0,_.jsx)(m().lU,{options:T(),description:(0,_.jsx)(l().sA,{id:"deletePaidWorkspaceFlow.surveyStep.description",defaultMessage:"Let us know why youâ€™re deleting your workspace"}),onSubmit:async e=>{var s,t;p().u4(k,{name:"churn_survey_submitted",args:{newProduct:x,churnType:O,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0,stage:C,churnSurveyId:A}}),V((s=>({...s,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0})));const n=await v().z6(k,{spaceId:null===(s=f().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),offerCampaign:(0,y().p)(k,null===(t=f().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId())}),o=(0,i().RS)(n);if(o&&(0,c().OJ)(o))return j(o),void I("offer");W()}});case"offer":return B?(0,_.jsx)(m().hL,{currentProduct:O,currentSubscriptionTier:O,coupon:B,newProduct:x,secondaryButtonMessage:(0,_.jsx)(l().sA,{id:"churnSurvey.offer.continueDeletingWorkspace.title",defaultMessage:"Continue deleting workspace"}),onSubmit:async e=>{if(e){var s;p().u4(k,{name:"offer_accepted",args:{coupon:B}});const e=null===(s=f().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),t=(0,u().Rz)(S),n=(0,y().p)(k,e);t&&e&&(0,u().qd)({billingData:S,canUpdateBilling:P})&&(0,c().OJ)(B)&&((0,g().S7)()&&n?await v().VY({environment:k,spaceId:e,offerCampaign:n,entrypoint:"deleted_space"}):await v().Qm(k,{customerId:t,newPlan:O,coupon:B,offerType:"downgrade_flow"}),h().D6({label:(0,_.jsx)(l().sA,{id:"applyCoupon.success",defaultMessage:"Coupon successfully applied"})})),R()}else W()}}):void W()}})()})}function T(){return[...(0,d().k4)([S().V.consolidatingWorkspaces,S().V.missingFeatures,S().V.notUsingEnough,S().V.switching,S().V.tooExpensive,S().V.tooDifficult]),S().V.other]}},981899:(e,s,t)=>{t.d(s,{p:()=>r});var n=()=>t(647242),o=()=>t(436622);function r(e,s){if(!s)return;const t=o().A.getData(e,{spaceId:s});if(!t)return;const r=(0,n().AI)(t),a=(0,n().q8)(t);if(r&&a&&"year"!==a)switch(r){case"plus":return"team_three_months";case"business":return"business_three_months";case"enterprise":return"enterprise_three_months";default:return}}}}]);