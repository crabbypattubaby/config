"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21088,78217],{11016:(e,t,n)=>{n.d(t,{A:()=>u});n(403517),n(242343);var o=()=>n(237385),r=()=>n(803290),i=()=>n(174114);const a=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]];var s=()=>n(517198),c=()=>n(216273),l=()=>n(440588),d=n(163643);function u(e){let{skipFadeinDelay:t}=e;const{isElectronMac:n}=(0,o().Y0)(),u=(0,r().O$)(c().b),m=n&&!u,f=(0,r().O$)(l().sidebarExpandedStore),g=(0,r().K8)((()=>f?l().sidebarWidthStore.state:0),[f]),v=(0,i().IS)((e=>{const t={width:20,height:20,borderRadius:4},n={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:e.surface.wash,boxShadow:e.sidebarBoxShadow,display:f?"flex":"none",minWidth:g,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{paddingTop:m?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...t,width:22,height:22},heroSectionTitle:{width:177,marginLeft:8,...n},toplevelMenu:{marginBottom:20,width:78,...n},toplevelMenuLast:{marginBottom:36,width:135,...n},sectionHeader:{marginBottom:14,width:56,...n},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...t},pageTitle:{marginLeft:8,...n}}}),[f,g,m]),h=(0,d.jsxs)("div",{style:v.heroSection,children:[(0,d.jsx)(s().A,{style:v.heroSectionIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:v.heroSectionTitle,emphasized:!0})]}),b=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s().A,{style:v.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:v.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:v.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:v.toplevelMenuLast,emphasized:!0})]}),S=(0,d.jsx)(s().A,{style:v.sectionHeader,emphasized:!0}),y=a.map(((e,n)=>e.map(((e,o)=>(0,d.jsxs)("div",{style:{...!t&&p(n),...v.pageRow},children:[(0,d.jsx)(s().A,{style:v.pageIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:{...v.pageTitle,width:80+20*e},emphasized:!0})]},`${n}-${o}`)))));return(0,d.jsxs)("div",{style:v.sidebar,children:[h,b,S,y]})}function p(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},24071:(e,t,n)=>{n.d(t,{A:()=>u});n(242343);var o=()=>n(237385),r=()=>n(803290),i=()=>n(174114),a=()=>n(333889),s=()=>n(136239),c=()=>n(48913),l=n(163643);function d(){const e=(0,i().IS)((e=>({icon:{position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===e.mode?e.text.primary:"#3E3C38",stroke:"dark"===e.mode?e.surface.wash:"white",strokeWidth:"dark"===e.mode?"1.85px":"1.5px"}})),[]);return(0,l.jsx)("div",{children:(0,a().G)(e.icon)})}function u(e){var t;const n=(0,o().v3)(),a=n.device.isMobile,{isTablet:u}=(0,o().Y0)(),p=(0,r().K8)((()=>{var t,o;if(a)return n.WindowSizeStore.getSafePaddingLeftCSS("number"==typeof(null===(t=e.style)||void 0===t?void 0:t.paddingLeft)?null===(o=e.style)||void 0===o?void 0:o.paddingLeft:10)}),[n.WindowSizeStore,a,null===(t=e.style)||void 0===t?void 0:t.paddingLeft]),m=(0,i().IS)((t=>({wrapper:{...a?{display:"flex",alignItems:"center",width:"100%",minHeight:26,fontSize:16,paddingTop:u?4:8,paddingBottom:u?4:8,paddingLeft:p,paddingRight:10,userSelect:"none",WebkitUserSelect:"none",boxShadow:void 0,marginBottom:e.shouldShowMobileMarginBottom?12:1}:{display:"flex",alignItems:"center",width:"100%",fontSize:14,minHeight:e.isBottomItem?24:27,height:c().Zr,paddingTop:4,paddingBottom:4,...(0,s().ic)()},...e.style},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:a?28:22,height:a?24:18,marginRight:8,position:"relative"},right:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,height:"100%",...e.rightStyle},left:{flexShrink:0,flexGrow:0,borderRadius:4,color:t.text.secondary,width:a?24:c().ry,height:a?24:c().ry,display:"flex",alignItems:"center",justifyContent:"center",marginRight:e.icon?0:8},children:{flexGrow:1,flexShrink:1,flexBasis:"auto",whiteSpace:"nowrap",minWidth:0,overflow:"hidden",textOverflow:e.right&&!a?"clip":"ellipsis",...e.childrenStyle}})),[a,u,p,e.shouldShowMobileMarginBottom,e.isBottomItem,e.style,e.rightStyle,e.icon,e.right,e.childrenStyle]);return(0,l.jsxs)("div",{role:e.role,dir:"ltr","aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:m.wrapper,onFocus:e.onFocus,onBlur:e.onBlur,onMouseMove:e.onMouseMove,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:e.className,children:[e.left&&(0,l.jsx)("div",{style:m.left,children:e.left}),e.icon&&(0,l.jsxs)("div",{style:m.icon,children:[e.icon,e.isAlias&&(0,l.jsx)(d,{})]}),(0,l.jsx)("div",{style:m.children,children:e.children}),e.right&&(0,l.jsx)("div",{style:m.right,children:e.right})]})}},36178:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(242343),r=()=>n(653998),i=n(163643);const a=(0,r().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:c,isModalOpen:l,onDismiss:d}=e,[u,p]=(0,o.useState)(""),m=(0,n(237385).v3)(),f=(0,r().tz)(),g=async()=>{await n(465235).Ip({environment:m,teamId:c,message:u}),d()},v=(0,n(174114).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,i.jsx)(n(922172).a,{open:l,onDismiss:d,innerStyle:v.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:v.requestTitle,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,i.jsx)(n(424339).x,{style:v.icon,store:t,disabled:!0,size:22})}})}),(0,i.jsx)(n(59175).A,{textarea:!0,style:v.input,value:u,onChange:e=>{p(e.target.value)},placeholder:f.formatMessage(a.message_placeholder)}),(0,i.jsxs)("div",{style:v.footer,children:[(0,i.jsx)(n(35462).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,i.jsx)(n(951540).A,{size:"lg",style:v.requestInvitesButton,onClick:g,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},57246:(e,t,n)=>{n.d(t,{j:()=>o});const o=new(n(380123).R)({key:"SimulateOffline",namespace:"Offline",important:!0,trackingType:"necessary"})},61962:(e,t,n)=>{n.d(t,{o:()=>i});var o=()=>n(129978);const r=new(o().O2)("PageError",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(23063),n.e(38546),n.e(25049),n.e(30873),n.e(66960)]).then(n.bind(n,468116)))),i=(0,o()._h)(r,(e=>e.PageError))},89969:(e,t,n)=>{n.d(t,{D:()=>o});function o(e,t){t.route.name;return!1}},95049:(e,t,n)=>{n.d(t,{t:()=>a});var o=()=>n(485966),r=()=>n(836331),i=()=>n(995625);function a(e){const{currentUserSettingsStore:t}=o().default.state;if(!t)return!1;const n=(0,i().iZ)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===r().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},109007:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(242343),r=()=>n(983050),i=()=>n(502852),a=()=>n(526445),s=n(163643);function c(e){const{overlayContainerStore:t,zIndex:n}=e,c=(0,o.useCallback)((e=>{(t??a().A).containerDomNodeStore.setState(e)}),[t]);return(0,s.jsx)("div",{ref:c,className:`${r().MUV} ${r().H1c}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:n??999,pointerEvents:"none",overflow:"hidden"},onMouseMove:e=>{(0,i().SQ)({event:e,context:i().y$.SidebarMouseMove,callback:()=>{}})},children:(0,s.jsx)("div",{style:{position:"relative",zIndex:0}})})}},120890:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(962373).A)},125091:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>i});var o=()=>n(662962),r=()=>n(10497);function i(){o().A.removeAllIfNoPermission(),r().A.removeAllIfNoPermission()}},126635:(e,t,n)=>{n.d(t,{RK:()=>i,uC:()=>a});var o=()=>n(129978);const r={Toaster:new(o().O2)("Toaster",(()=>Promise.all([n.e(94476),n.e(47381)]).then(n.bind(n,560023)))),PerfmarkTrialIneligibleToast:new(o().O2)("PerfmarkTrialIneligibleToast",(()=>Promise.all([n.e(75134),n.e(58790)]).then(n.bind(n,449800))))},i=(0,o()._h)(r.Toaster,(e=>e.Toaster)),a=(0,o()._h)(r.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},183103:(e,t,n)=>{n.d(t,{Ay:()=>u,Gf:()=>m});var o=n(242343),r=()=>n(237385),i=()=>n(803290),a=()=>n(812815),s=()=>n(635703),c=()=>n(449596),l=()=>n(376869);const d=(0,n(3311).Ay)();function u(){!function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();(0,o.useEffect)((()=>{e&&t&&(0,s().readAndCacheOfflinePagesMemo)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t])}(),function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();m((0,o.useCallback)((()=>{e&&t&&(0,s().readAndCacheOfflinePages)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t]))}(),function(){const e=(0,i().K8)((()=>c().A.state.shouldPublishUpdate),[]),t=function(){const e=p();return(0,o.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.postMessage({type:"update",tabId:d})}),[e])}();(0,o.useEffect)((()=>{e&&(t(),c().A.setState({...c().A.state,shouldPublishUpdate:!1}))}),[e,t])}()}function p(){const{currentUser:{id:e},device:t}=(0,r().v3)(),n=(0,l().y)(),i=t.isElectron,s=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{if(n&&i&&e)try{const t=new BroadcastChannel(`offlinePageUpdates-${e}`);return s.current=t,()=>{t.close(),s.current=void 0}}catch(t){a().Fg(t,{tags:{event:"useOfflinePageUpdatesChannel"}})}}),[n,i,e]),s}function m(e){const t=p();(0,o.useEffect)((()=>{const n=t.current;if(!n)return;const o=t=>{var n;"update"===(null===(n=t.data)||void 0===n?void 0:n.type)&&t.data.tabId!==d&&e()};return n.addEventListener("message",o),()=>{n.removeEventListener("message",o)}}),[t,e])}},213766:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>u,getUserControlledCloseConfirmationDialogReason:()=>d,setupOnBeforeUnload:()=>m,showConfirmationDialogEventEmitter:()=>c});n(610931);var o=()=>n(76394),r=()=>n(210562),i=()=>n(799220),a=()=>n(838572),s=()=>n(359009);const c=new(n(279011).A);let l;function d(){const e=u();switch(e){case"have_local_draft_unsaved_changes":case"dictation_in_progress":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,o().HB)(e)}function u(){if(!l)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return l()}const p="Changes you made may not be saved. Are you sure you want to quit?";function m(e){const{TransactionQueue:t,device:n,AppUpdateStore:o,GlobalFileUploadStore:d}=e;l=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||o.isMajorUpdate()?(0,i().A5)()?"have_pending_ai_edits":a().A.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":d.isUploading()?"uploading_files":s().A.hasPendingSyncedCollectionChanges()?"have_pending_synced_collection_changes":r().gZ.state?"dictation_in_progress":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=u();if(e)return c.emit(e),p}}},277013:(e,t,n)=>{n.d(t,{$:()=>l,S:()=>d});var o=()=>n(803290),r=()=>n(174114),i=()=>n(782422),a=()=>n(48913),s=()=>n(755648),c=()=>n(566255);function l(e){const{environment:t,rightEdgeDistance:n,isInPeekRenderer:l}=e,u=e.width??36,p=(0,o().K8)((()=>(0,a().zo)(t,l)-(0,a().Ql)(t)),[t,l]),m=(0,o().K8)((()=>d(t,16+s().A.state)),[t]),f=(0,o().K8)((()=>n+s().A.state),[n]),g=(0,o().K8)((()=>i().$o.state?0:1),[]);return(0,r().IS)((e=>({buttonPositionStyle:{display:"flex",position:"absolute",bottom:m,right:f,opacity:g,transform:`translateX(-${p}px) translateZ(0)`,transition:`\n\t\t\t\t\topacity ${c().L}ms,\n\t\t\t\t\tcolor ${c().L}ms,\n\t\t\t\t\ttransform 200ms\n\t\t\t\t`,alignItems:"center",gap:10},roundButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",background:e.whiteButtonBackground,width:u,height:u,borderRadius:"100%",fontSize:20,boxShadow:e.shadowSM}})),[p,m,f,u,g])}function d(e,t){return e.WindowSizeStore.getSafePaddingBottomCSS(t+(e.device.isTablet?-12:0))}},286270:(e,t,n)=>{n.d(t,{E:()=>a});var o=n(242343),r=()=>n(81e4),i=n(163643);const a=o.forwardRef(((e,t)=>{let{children:o,color:a,disabled:s,icon:c,iconStyle:l,isLoading:d,shape:u="default",size:p="md",style:m,...f}=e;const g=(0,n(174114).IS)((e=>{const t=a?`${a}Primary`:"primary",i=a||"regular",f=a?`${a}Hover`:"primaryHover",g=a?`${a}Pressed`:"primaryPressed";return{button:{...(0,r().qq)({shape:u,size:p,hasIconOnly:Boolean(c)&&!o}),justifyContent:"center",color:e.text[t],background:e.tint[i],opacity:s||d?.3:1,fontWeight:n(31448).Wy.medium,...m},hovered:{background:s?e.tint[i]:e.tint[f]},pressed:{background:s?e.tint[i]:e.tint[g]},icon:{...(0,r().D3)({size:p,hasIconOnly:!o}),...l}}}),[o,a,s,c,l,d,u,p,m]);return(0,i.jsxs)(n(417653).A,{ref:t,style:g.button,hoveredStyle:g.hovered,pressedStyle:g.pressed,disabled:s,isLoading:d,...f,children:[c?c(g.icon):null,o]})}));a.displayName="TintButton"},313432:(e,t,n)=>{n.d(t,{Z:()=>i});var o=()=>n(129978);const r=new(o().O2)("SearchModal",(async()=>Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(55373),n.e(44711),n.e(53321),n.e(16471),n.e(90825),n.e(37353),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(4422),n.e(28866),n.e(67435),n.e(76181),n.e(72832),n.e(90280),n.e(84778),n.e(19361),n.e(26090),n.e(12341),n.e(47864),n.e(40828),n.e(5023),n.e(90978),n.e(80187)]).then(n.bind(n,320703)))),i=(0,o()._h)(r,(e=>e.Search))},343833:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>c,xw:()=>a});var o=()=>n(427091),r=()=>n(84543),i=()=>n(658388);function a(e){const{environment:t,userSettingsStore:n}=e,r=n.getSettings(),i=null==r?void 0:r.time_zone,a=(0,o().P)();i!==a&&s({environment:t,userSettingsStore:n,timeZone:a})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},377403:(e,t,n)=>{n.d(t,{W:()=>i});var o=()=>n(803290),r=()=>n(950347);function i(){return(0,o().K8)((()=>(0,r().M5)()),[])}},430619:(e,t,n)=>{n.d(t,{s:()=>r});n(242343);var o=n(163643);const r=(0,n(680369).wt)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},463344:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(242343),r=()=>n(803290),i=()=>n(150649),a=n(163643);const s=function(e){const t=(0,n(237385).Y0)(),s=(0,r().K8)((()=>({initiator:n(330608).A.state.initiator,isDragging:n(716826).Ay.state.isDragging})),[]),c=(0,r().K8)((()=>i().default.state.isActive),[]),l=(0,r().K8)((()=>!!i().default.state.isActive&&i().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),d=(0,o.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===l&&(e+=" notion-disable-local-cursor"),e}),[l]);return(0,o.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,a.jsx)("div",{style:{...e.style,cursor:l},className:d,children:e.children})}},465235:(e,t,n)=>{n.d(t,{D2:()=>A,Ip:()=>S,Jk:()=>y,YT:()=>w,e2:()=>h,g:()=>b});n(725707),n(491955);var o=()=>n(712437),r=()=>n(409211),i=()=>n(539174),a=()=>n(818369),s=()=>n(759625),c=()=>n(575015),l=()=>n(783759),d=()=>n(84543),u=()=>n(477784),p=()=>n(548694),m=()=>n(485966),f=()=>n(628854),g=()=>n(723);const v=(0,n(653998).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function h(e){let{environment:t,userId:n,teamStore:o,user:r}=e;const a=o.getSpaceId();if(!a)return;await f().rU({environment:t,teamId:o.id,spaceId:a,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:n})&&(i().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await b({environment:t,userId:n,teamStore:o}),c().D6({label:u().A.formatMessage(v.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function b(e){let{environment:t,userId:n,teamStore:r}=e;const i=m().default.state.currentUserRootStore,a=r.getSpaceId();if(!a||!i)return;const s=i.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await l().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:i,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await g().J({environment:t,spaceId:a,userId:n}),f().L0({environment:t,teamStore:r,shouldScroll:!0})}async function S(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(i().XQ(t,{teamId:n}),await w({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c().D6({label:u().A.formatMessage(v.requestTeamSuccessMessage)})}))):c().D6({label:u().A.formatMessage(v.requestTeamFailureMessage)})}async function y(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const c=o.getForActorId();if(!c)return;const l=o.getRecordModel({table:r().oo,id:c});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await f().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().oo,resolved_by_id:t.currentUser.id,status:a}})}}),i().GW(t,{store:n,resolution:a})}}async function w(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:r,userSettingsStore:i}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await l().tR({environment:t,spaceViewStore:n,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().t9({environment:t,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward})}async function A(e){let{environment:t,teamId:n}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},465594:(e,t,n)=>{n.d(t,{Y:()=>i});var o=()=>n(129978);const r=new(o().O2)("invoice",(async()=>await n.e(60896).then(n.bind(n,508131)))),i=(0,o()._h)(r,(e=>e.Invoice))},473096:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(242343),r=()=>n(174114),i=()=>n(162339),a=()=>n(966789),s=n(163643);function c(e){let{loadingMessage:t}=e;const n=(0,r().DP)(),c=(0,i().A)(!0,400);return(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:c&&(0,s.jsxs)(o.Fragment,{children:[(0,s.jsx)(a().A,{}),t&&(0,s.jsx)("div",{style:{marginLeft:8,color:n.text.secondary},children:t})]})})}},493302:(e,t,n)=>{n.d(t,{A:()=>Or});var o=n(242343),r=()=>n(16791),i=()=>n(237385),a=()=>n(269280),s=()=>n(659196),c=()=>n(350792),l=()=>n(707781),d=()=>n(77993),u=()=>n(311055),p=()=>n(214144),m=()=>n(485966),f=()=>n(148649),g=()=>n(329911);function v(e){g().K.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}const h=6e4;async function b(e){var t,n;void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore||await m().default.waitUntil((()=>void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore));const o=null===(t=m().default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=m().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!o||!r)return;const i=(0,f().g)({userId:o,spaceId:r}),a=Date.now();v(i?{userId:o,spaceId:r,session:{...i,lastFocusedTime:a}}:{userId:o,spaceId:r,session:{id:p().JW(),sessionStartTime:a,lastFocusedTime:a}})}var S=()=>n(927685),y=()=>n(129978);const w=new(y().O2)("thirdPartyScripts",(()=>n.e(1978).then(n.bind(n,471695)))),A=(0,y()._h)(w,(e=>e.InjectThirdPartyScripts));var I=()=>n(137476),k=()=>n(983050),x=()=>n(622286);const C={GlobalInAppMessageListener:new(y().O2)("GlobalInAppMessageListener",(()=>n.e(94869).then(n.bind(n,448956))))},T=(0,y()._h)(C.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener));var E=()=>n(376869),P=()=>n(764605),_=()=>n(803290),U=()=>n(174114),L=()=>n(653998),M=()=>n(31448),j=()=>n(575015),R=()=>n(782422),B=()=>n(802955),N=()=>n(836331),D=()=>n(273541),O=()=>n(449596),q=n(163643);function z(){const e=(0,L().tz)(),t=(0,U().DP)(),n=!(0,_().O$)(B().e),r=(0,_().K8)((()=>(0,R().s0)()),[]),i=(0,o.useRef)(n),a=(0,o.useRef)(r);(0,o.useEffect)((()=>{!n||i.current&&r===a.current||function(e){var t;const{isOffline:n,currentPageId:o,intl:r,theme:i}=e;if(!(O().A.state.offlinePages&&N().default.checkGate({gateName:"download_for_offline"})&&n&&o&&(0,D().Bd)(o)))return;const a=null===(t=O().A.state.offlinePages[o])||void 0===t?void 0:t.lastDownloadedAt,s=a?r.formatDate(a,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;j().D6({label:(0,q.jsxs)("div",{children:[(0,q.jsx)("div",{style:{fontWeight:M().Wy.medium},children:(0,q.jsx)(L().sA,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),a&&(0,q.jsx)("div",{style:{color:i.text.secondary},children:(0,q.jsx)(L().sA,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:s}})})]})})}({isOffline:n,currentPageId:r,intl:e,theme:t}),i.current=n,a.current=r}),[n,r,e,t])}var W=()=>n(183103),K=(n(610931),n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(725707),n(491955),n(403517),()=>n(951592)),$=()=>n(975392),F=()=>n(23371),V=()=>n(646591),G=()=>n(925701),H=()=>n(172470),J=()=>n(94417),Z=()=>n(635703);const Y=1e3;class X extends Error{constructor(e){super(e),this.name="OfflineAutosyncAbortedError"}}async function Q(e){const{environment:{currentUser:{id:t},defaultRecordCache:{persistedRecordCache:n}},recentPageIds:o}=e;if(!n||!t)return{pagesToAdd:[],pagesToRemove:[]};return function(e){const{recentPageIds:t,existingAutosyncedPageIds:n}=e,o=new Set(t),r=new Set(n);return{pagesToAdd:t.filter((e=>!r.has(e))),pagesToRemove:Array.from(n).filter((e=>!o.has(e)))}}({recentPageIds:o,existingAutosyncedPageIds:(await n.getOfflineAutosyncedOrigins({userId:t})).map((e=>{let[t]=e;return t}))})}async function ee(e){const{environment:t,abortSignal:n,autosyncIntervalMs:o}=e,{currentUser:{id:r},defaultRecordCache:{persistedRecordCache:i}}=t;if(!i||!r)return;const a=function(e){var t;let{limit:n}=e;return null===(t=V().wI.state)||void 0===t?void 0:t.slice(0,n).map((e=>e.pageId))}({limit:N().default.getConfigKey("offline_mode_settings","autosynced_pages_limit")});if(void 0===a)return;const{pagesToAdd:s,pagesToRemove:c}=await Q({environment:t,recentPageIds:a});n.throwIfAborted(),await navigator.locks.request(`download_autosynced_pages_${t.currentUser.id}`,{ifAvailable:!0},(async e=>{if(!e)return;const a=await i.getOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync"});if(a){if(Date.now()-a<.95*o)return}const c=Date.now(),l=new Set;await(0,F().lX)(s,5,(async e=>{await(0,J().og)({from:"addAutosyncedPage",autosyncTypes:["frecent"],pageId:e,environment:t,originPageId:e,visitedBlockIds:{forThisOriginPage:new Set,forThisInterval:l},stats:{imageCount:0,loadCachedPageChunkV2ForOfflineCount:0,queryCollectionCount:0},downloadAbortSignal:n,skippedCollectionIds:new Set}),n.throwIfAborted()})),await i.updateOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync",lastExecutedAt:c})}));for(const l of c)await(0,J().zB)({from:"removeAutosyncedPage",pageId:l,environment:t}),n.throwIfAborted()}function te(){const e=(0,i().v3)(),t=(0,E().y)(),n=(0,x().X)("offline_autosync"),r=(0,_().K8)((()=>function(){const e=(0,G().dE)();if(void 0===e)return(0,G().Nw)("on"),"on";return e}()),[]),a=(0,K().ZC)(r)??"off",s=(0,_().K8)((()=>H().A.state.initialRenderCompleted&&B().A.state.online&&t&&n),[t,n]),c=(0,_().K8)((()=>N().default.getConfigKey("offline_mode_settings","autosync_interval_ms")),[]);(0,o.useEffect)((()=>{const t=new AbortController,n=$().sg((()=>{if(s)if("on"!==a||"off"!==r){if("on"===r){ee({environment:e,abortSignal:t.signal,autosyncIntervalMs:c}).catch((e=>{if(!(e instanceof X))throw e}));const n=.05*c,o=c+Math.random()*n*2-n;return setInterval((()=>{ee({environment:e,abortSignal:t.signal,autosyncIntervalMs:o}).catch((e=>{if(!(e instanceof X))throw e}))}),o)}}else(async function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=e;t&&n&&(await t.removeAllOfflineAutosyncedOrigins({userId:n}),await t.updateOfflineMetadataLastExecutedAt({userId:n,taskType:"autosync",lastExecutedAt:0}),(0,Z().readAndCacheOfflinePages)({userId:n,persistedRecordCache:t,tellOtherTabsToUpdate:!0}))})(e).catch((e=>{if(!(e instanceof X))throw e}))}),Y),o=n();return()=>{t.abort(new X("Autosync aborted because hook deps changed")),n.cancel(),o&&clearInterval(o)}}),[e,s,r,a,c])}var ne=()=>n(842617),oe=()=>n(76394),re=()=>n(437071),ie=()=>n(57246);async function ae(e,t){var n;return"undefined"==typeof navigator||void 0===(null===(n=navigator.locks)||void 0===n?void 0:n.request)?t():await navigator.locks.request(e,{ifAvailable:!0},(async e=>{if(e)return t()}))}const se=(0,n(851552).Dv)("extractWebClipperContent");var ce=()=>n(686449),le=()=>n(818369),de=()=>n(402351),ue=()=>n(839618),pe=()=>n(664463),me=()=>n(366069);const fe=new(n(574607).A);var ge=()=>n(748001),ve=()=>n(559301);var he=()=>n(678008),be=()=>n(548694),Se=()=>n(341720);function ye(){const e=(0,i().v3)(),t=(0,_().K8)((()=>m().default.state.currentUserRootStore),[]);(0,o.useEffect)((()=>{t&&async function(e,t){await he().y();const n=t.getSpaceViewStores();for(const o of n){const t=o.getBookmarkedPageStores();for(const e of t)we(e);const n=o.getSharedPages();if(n)for(const e of n)we(e);const r=o.getTeamsStores();for(const e of r){const t=e.getTeamPagesStores();for(const e of t)we(e)}const i=o.getSpaceStore();if(i){Se().A.getData(e,{spaceId:i.id});const t=(0,be().I0)(e,i);for(const e of t)we(e)}}}(e,t)}),[t,e])}function we(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var Ae=()=>n(502140),Ie=()=>n(885237),ke=()=>n(598744),xe=()=>n(897665),Ce=()=>n(216268),Te=()=>n(145046),Ee=()=>n(653147),Pe=()=>n(352723),_e=()=>n(990394),Ue=()=>n(825634);const Le=6e4;function Me(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n;o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),r=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),a=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=(0,ke().parseVersion)(t.version),i=re().getDesktopVersion(),a=(0,ke().getUpdateType)({currentVersion:i,nextVersion:r,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"downloading",type:a,version:r,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),s=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=o.state;r.electronUpdate&&"downloading"===r.electronUpdate.state&&o.setState({appUpdate:r.appUpdate,electronUpdate:{...r.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),c=(0,o.useCallback)(((t,n)=>function(e,t,n){const{device:o}=n,{AppUpdateStore:r}=n,i=Ie().A.get(xe().wp),a=t.version;if(i===a){if(o.isMac)return r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:ke().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void Te().ui({message:(0,q.jsx)(L().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>xe().K0(n),items:[{label:(0,q.jsx)(L().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>xe().K0(n)}]});Ae().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:i,nextUpdateReady:a}}})}const s=re().getDesktopVersion(),c=(0,ke().parseVersion)(t.version),l=(0,ke().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:l,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),l=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),d=(0,o.useCallback)(((t,n)=>Be(n,e)),[e]),u=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),p=(0,o.useCallback)(((t,n)=>Ne(n,e)),[e]),m=(0,o.useCallback)(((t,n)=>De(n,e)),[e]),f=(0,o.useCallback)(((t,n)=>Oe(n,e)),[e]),g=(0,o.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(B().A.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;xe().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,o.useEffect)((()=>{const{device:o}=e;if(o.isElectron){const e=re().electronUpdateReady.addListener(c),o=re().electronUpdateError.addListener(n),i=re().electronUpdateChecking.addListener(t),v=re().electronUpdateAvailable.addListener(a),h=re().electronUpdateProgress.addListener(s),b=re().electronUpdateNotAvailable.addListener(r),S=re().appUpdateReady.addListener(f),y=re().appUpdateError.addListener(d),w=re().appUpdateChecking.addListener(l),A=re().appUpdateAvailable.addListener(p),I=re().appUpdateInstall.addListener(g),k=re().appUpdateProgress.addListener(m),x=re().appUpdateNotAvailable.addListener(u);return()=>{null==e||e(),null==o||o(),null==i||i(),null==v||v(),null==h||h(),null==b||b(),null==S||S(),null==y||y(),null==w||w(),null==A||A(),null==I||I(),null==k||k(),null==x||x()}}}),[e,l,u,p,d,g,m,f,a,t,n,r,s,c]),(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>Oe(t,e),appUpdateError:t=>Be(t,e),appUpdateChecking:l,appUpdateAvailable:t=>Ne(t,e),appUpdateProgress:t=>De(t,e),appUpdateNotAvailable:u}),function(e){const t=xe().Cv(),n=xe().B0();if(!(0,ke().isEqualVersion)(t,n)){0;Re((0,ke().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,xe().bg(),e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,o=t.isAndroid&&(0,ke().isLessThanVersion)(n,[7,0]),r=t.isIOS&&(0,ke().isLessThanVersion)(n,[16,0]);(o||r)&&function(e){const{mobileNative:t}=e;if(!t)return;Ce().HQ({bannerStore:_e().A,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:Ee().q.Red})}(e)}}),[e,l,u]);const v=(0,o.useRef)("");(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!S().A.isAdminMode&&(!S().A.isLocalhost||S().A.offline)){async function o(){if(Ue().A.state.isVisible)try{const t=xe().Cv(),n=await le().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:v.current}});if("success"===n.type){const o=n.data;if(o.version){const n=o,r=(0,ke().parseVersion)(n.version);r&&((0,ke().isEqualVersion)(r,t)||Oe(n,e)),v.current=o.hash}}}catch(t){}}const r=setInterval(o,Le);return()=>clearInterval(r)}}),[e])}async function je(e,t){const n=await async function(e){await m().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=m().default.state;return!(!n||!t||(0,Pe().qb)(e,t))}(e);n&&(xe().Dv(e,t,"banner"),Ce().HQ({bannerStore:_e().A,id:"AppUpdate",contentKey:"minor_app_update",styleKey:Ee().q.Blue}))}function Re(e,t,n,o){e===ke().UpdateType.Major||e===ke().UpdateType.Minor||xe().wT()?(t&&xe().fC(t)&&xe().qr(t,n),je(o,e)):xe().KD()?function(e,t){xe().Dv(e,t,"modal"),Te().ui({message:(0,q.jsx)(L().sA,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>xe().K0(e),items:[{label:(0,q.jsx)(L().sA,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>xe().K0(e)}],innerStyle:{width:380}})}(o,e):t&&xe().fC(t)&&xe().qr(t,n)}function Be(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function Ne(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const o=(0,ke().parseVersion)(e.version),r=xe().Cv(),i=(0,ke().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})}function De(e,t){const{AppUpdateStore:n}=t,o=n.state;o.appUpdate&&"downloading"===o.appUpdate.state&&n.setState({electronUpdate:o.electronUpdate,appUpdate:{...o.appUpdate,progress:e.downloaded/e.total}})}function Oe(e,t){const{AppUpdateStore:n}=t,o=(0,ke().parseVersion)(e.version),r=xe().Cv(),i=(0,ke().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"}),a=e.createdTime;if(!xe().fC(o)){const e={state:"ready",type:i,version:o,versionCreatedTime:a};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}Re(i,o,a,t)}var qe=()=>n(545250),ze=()=>n(809811);var We=()=>n(469608);async function Ke(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await re().isWindowVisible()))return;if(We().isConnected())return void $e(!0);if(!1===navigator.onLine&&!S().A.isLocalhost)return void $e(!1);"success"===(await le().callApi({eventName:"ping",environment:e,data:{}})).type?$e(!0):$e(!1)}function $e(e){B().A.setState({...B().A.state,online:e,lastOfflineTimestamp:e?B().A.state.lastOfflineTimestamp:Date.now()})}const Fe=5e3;var Ve=()=>n(497420);n(500234),n(324989);var Ge=()=>n(755002),He=()=>n(34662),Je=()=>n(123047),Ze=()=>n(401548),Ye=()=>n(220413),Xe=()=>n(312720),Qe=()=>n(610546),et=()=>n(695387),tt=()=>n(747459),nt=()=>n(716409),ot=()=>n(750169),rt=()=>n(468258),it=()=>n(332284);function at(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Ge().EJ)({level:n})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\tbackground: ${(0,Ye().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().JG)(e)} !important;\n\t\t}\n\t`}function st(e){const{level:t}=e;return`\n\t\t.${(0,Ge().EJ)({level:t})}.${Je().uU}.${Je().Do} {\n\t\t\tbackground: ${(0,Ye().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().JG)(e)} !important;\n\t\t}\n\t`}function ct(e){const t=(0,Ye().aO)({level:1,mode:e.mode,hovered:!1,selected:!1}),n=(0,Ze().Mj)(t).alpha()/2,o=(0,Ze().Mj)(t).alpha(n).toRgbString(),r=(0,Ye().JG)({level:1,mode:e.mode,hovered:!1,selected:!1}),i=(0,Ze().Mj)(r).alpha()/2,a=(0,Ze().Mj)(r).alpha(i).toRgbString();return`\n\t\t.${Je().K6}.${Je().Do} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${o} !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function lt(e){const{theme:t,selected:n,hovered:o}=e;return`background: ${(0,Ye().FK)({annotationType:"update",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,Ye().FK)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t.mode})} !important;`}function dt(e){const{discussionId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Ge().ED)({type:"update"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${lt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t\t.${(0,Ge().ED)({type:"remove"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${function(e){const{theme:t,selected:n,hovered:o}=e,r=(0,Ye().FK)({annotationType:"remove",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode}),i=(0,Ye().FK)({annotationType:"remove",type:"underline",selected:n,hovered:o,overlapping:!1,mode:t.mode});return`background: ${r} !important;\n\t\t\tcolor: ${t.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;`}({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}function ut(e){var t,n,o;const r=(null===(t=Qe().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=ot().A.state)&&void 0!==n&&n.open&&(null===(o=ot().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.flatMap((t=>$().Hn(Ge().DS).map((n=>at({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e.mode}))))),...i.flatMap((t=>$().Hn(Ge().DS).map((n=>at({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e.mode})))))].join("\n")}function pt(e){var t,n,o;const r=(null===(t=Qe().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=ot().A.state)&&void 0!==n&&n.open&&(null===(o=ot().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.map((t=>dt({theme:e,discussionId:t,selected:!1,hovered:!0}))),...i.map((t=>dt({theme:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function mt(e){let t="";const n=nt().A.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,Ge().K3)({type:"insert",editId:n.editId})} {\n\t\t\t\t${lt({theme:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,Ge().K3)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,Ye().FK)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e.mode})} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${k()._Qb} .${(0,Ge().h_)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.primary} !important;\n\t\t}\n\n\t\t.${k()._Qb} .${(0,Ge().h_)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.quaternary} !important;\n\t\t}\n\t`}\n\t`}function ft(e){const t=Xe().W.getHoveredEditId();return t?function(e){const{editId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Ge().rI)({editId:t})}.${Je().Do} {\n\t\t\t${lt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}({editId:t,theme:e,selected:!1,hovered:!0}):""}function gt(){const e=(0,U().DP)(),t=(0,_().K8)((()=>[ut(e),pt(e)].join("\n")),[e]),n=(0,_().K8)((()=>function(){var e,t,n;const o=null===(e=rt().A.state)||void 0===e?void 0:e.store,r="token"===(null===(t=rt().A.state)||void 0===t?void 0:t.type)?null===(n=rt().A.state)||void 0===n||null===(n=n.annotations)||void 0===n?void 0:n.find(He().sh$):void 0;if(!r)return"";const i=(0,He().cQR)(r);return"block"!==(null==o?void 0:o.table)?"":`\n\t\t\t.${(0,Ge().re)({href:i,blockId:o.id})}.${Je().Do} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),r=(0,_().K8)((()=>mt(e)),[e]),i=(0,_().K8)((()=>function(e){var t,n,o;if(!(null===(t=tt().A.state)||void 0===t?void 0:t.open))return"";let r=[],i=[];return null!==(n=et().A.state)&&void 0!==n&&n.isHovered&&(r=$().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!0,selected:!1,mode:e.mode})))),null!==(o=et().A.state)&&void 0!==o&&o.isActivelyComposing&&(i=$().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!1,selected:!0,mode:e.mode})))),[...r,...i].join("\n")}(e)),[e]),a=(0,_().K8)((()=>function(e){return it().default.isRightMarginCommentHovered()?[ct(e)].join("\n"):""}(e)),[e]),s=(0,_().K8)((()=>ft(e)),[e]),c=(0,o.useMemo)((()=>[t,n,r,i,a,s].filter(Boolean).join("\n")),[r,t,n,i,a,s]),l=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{if(!l.current){const e=document.createElement("style");l.current=e,document.head.appendChild(e)}l.current.innerHTML=c}),[c])}var vt=()=>n(950635),ht=()=>n(83544),bt=()=>n(829090),St=()=>n(185912),yt=()=>n(145054),wt=()=>n(427091),At=()=>n(758989),It=()=>n(694225),kt=()=>n(632627),xt=()=>n(218357),Ct=()=>n(865226),Tt=()=>n(441165),Et=()=>n(284320),Pt=()=>n(944498),_t=()=>n(115562),Ut=()=>n(699887);const Lt=32;const Mt=32;async function jt(e){const t=document.createElement("canvas");t.width=Mt,t.height=Mt;const n=t.getContext("2d"),o=document.createElement("img");return o.src=e,o.crossOrigin="anonymous",new Promise((e=>{o.onload=()=>{n.drawImage(o,0,0,Mt,Mt),e(t.toDataURL("image/png"))},o.onerror=()=>{e("")}}))}var Rt=()=>n(29869),Bt=()=>n(37312),Nt=()=>n(477784),Dt=()=>n(520969),Ot=()=>n(539581),qt=()=>n(112907),zt=()=>n(515347),Wt=()=>n(840024),Kt=()=>n(426496),$t=()=>n(493065),Ft=()=>n(230557),Vt=()=>n(413871),Gt=()=>n(308265);const Ht=(0,L().YK)({notionAiDocTitle:{id:"documentTitleListener.notionAi.title",defaultMessage:"Notion AI"},homeLabelTitle:{id:"DocumentTitleListener.personalHomeLabel",defaultMessage:"Home"}});function Jt(){const e=(0,i().v3)(),t=(0,L().tz)(),n=(0,U().DP)(),r=(0,o.useRef)(),a=(0,Gt().BG)(),s=(0,_().O$)(Wt().ts),c=(0,_().r6)((()=>{var n,o;const{RouterStore:r,device:i}=e,c=r.state.route,l=("space"===c.name||"page"===c.name)&&Boolean(c.requestedOnPublicDomain);if("chat"===c.name){return{assetPath:s?ht().A.images.assistantStaticFaceFaviconPng:ht().A.images.sparklesFavicon2Png,title:t.formatMessage(Ht.notionAiDocTitle)}}if("marketplace"===c.name)return{assetPath:ht().A.images.templates.faviconIco};if("settingsConsoleOrganization"===c.name)return{title:"Organization settings"};if("team"===c.name){const t=new(Vt().h4)(e,{table:xt().yK,id:c.teamId});if(!t.isReady())return;return{title:t.getName(),icon:t.getIcon()}}const d=m().default.state.mainEditorCurrentBlockStore;if(!d||!d.isReady())return;const u="page"===c.name&&c.blockId===d.id,p=d.getSpaceStore()??m().default.state.currentSpaceStore;let f=!1;if("space"===c.name&&c.requestedOnPublicDomain){const e=qt().NG(p,d.id);f=(null==e?void 0:e.getDomainName())===c.spaceDomain}if(!u&&!f)return;const g=Ot().A.getUnreadCountForCurrentSpace().mentions,v=d.getModel(),h=function(e){const{store:t,spaceStore:n,environment:o,device:r,intl:i,unreadCountInCurrentSpace:a,isPublicSite:s,isWorkflowsAppContainerEnabled:c}=e,l=t.getTitleStore(),d=t.getModel(),u=t.getCollectionViewIds(),p=null==l?void 0:l.getRecordModel(l.pointer);if(s&&d){const e=d.getFormat();if(null!=e&&e.seo_title)return e.seo_title}if(!l||!p)return;let f=(0,kt().r4)({intl:Nt().A.getIntl(),textValue:l.getValue(),userTimeZone:(0,wt().P)(),getRecordModel:t.getRecordModel})||p.getEmptyTitlePlaceholder({getRecordModel:l.getRecordModel,userTimeZone:(0,wt().P)(),intl:i,isWorkflowsAppContainerEnabled:c});if("block"===l.table&&(0,Dt().lU)(t)&&n){f=`${n.getName()} - ${i.formatMessage(Ht.homeLabelTitle)}`}if("collection"===l.table&&d&&d.isCollectionView()&&u.length>1){const e=m().default.state.currentCollectionViewStore;e&&e.getName()&&(f=`${f} | ${e.getName()}`)}r.isElectron||(f=(0,bt().sd)(f.slice(0,100),Et().A.state));Pe().qb(o,t)||o.device.isElectron||o.device.isMobileNative||(a>9?f=`(9+) ${f}`:a>0&&(f=`(${a}) ${f}`));return f}({store:d,spaceStore:p,environment:e,device:i,intl:t,unreadCountInCurrentSpace:g,isPublicSite:l,isWorkflowsAppContainerEnabled:a}),b=function(e){const{store:t,spaceStore:n,route:o}=e;if(null==n||!n.getPublicSpaceData())return;return"page"===o.name?(0,Rt().Ay)({store:t,fullyQualified:!1,scrollToBlockId:null==o?void 0:o.scrollToBlockId,peekViewBlockId:o.peekViewBlockId,peekMode:o.peekMode,collectionViewId:o.collectionViewId,discussionId:o.discussionId,showMoveTo:o.showMoveTo,saveParent:o.saveParent,templateGalleryItem:o.templateGalleryItem,projectManagementLaunch:o.projectManagementLaunch,pageVisitSource:void 0,embedded:o.embedded,...(0,qe().Fy)(o)}):(0,Rt().Ay)({store:t,fullyQualified:!1,pageVisitSource:void 0})}({store:d,spaceStore:p,route:c}),{isNonverified:S,hasBypassedContentClassification:y}=function(e){const{blockModel:t,store:n}=e,o=Boolean(null==t?void 0:t.isNonverifiedContentClassification()),r=o&&t&&Kt().A.bypassedPage(n.id);return{isNonverified:o,hasBypassedContentClassification:Boolean(r)}}({blockModel:v,store:d}),w=(0,Pt().TMT)(),A=function(e,t,n){if("space"!==e.name&&"page"!==e.name||!e.requestedOnPublicDomain||!t)return n.getIcon();{const e=zt().GN(n);if(null==e||!e.getSiteId())return n.getIcon();const t=null==e?void 0:e.getSiteStore();if(e&&t&&t.isDefined()){const o=t.getFaviconUrl();return o?{pointer:e.pointer,icon:o}:n.getIcon()}}}(c,p,d),I=!(null!==(n=(0,zt().GN)(d))&&void 0!==n&&null!==(n=n.getSiteStore())&&void 0!==n&&n.isSearchEngineIndexingEnabled()),k=l&&c.spaceDomain?t.formatMessage({id:"seo.SiteNameMetaTitle",defaultMessage:"{spaceDomainName} on Notion"},{spaceDomainName:c.spaceDomain}):t.formatMessage({id:"seo.defaultMetaTitle",defaultMessage:"Default notion title meta tag"}),x=null==v?void 0:v.getSeoDescription(),C=null==v||null===(o=v.getRenderCover(d.getRecordModel))||void 0===o?void 0:o.cover,T=null==v?void 0:v.getLastEditedByPointer(),E=null==v?void 0:v.getCreatedByPointer();let P;if(E){const e=d.getRecordModel(E);e&&(P=(0,vt().lR)(t,e))}if(!P&&T){const e=d.getRecordModel(T);e&&(P=(0,vt().lR)(t,e))}return{title:h,url:b,icon:A,isNonverified:S,isPublicSite:l,hasBypassedContentClassification:y,isMemberOfSpace:w,shouldNoIndex:I,spaceNameForMetaTag:k,description:x,coverImage:C,authorName:P}}),[e,t,s,a],{useDeepEqual:!0});(0,_().O$)(c),(0,o.useEffect)((()=>{const o=$().sg((function(){const{device:o}=e,i=c.state;if(!i)return;const{url:a,title:s,icon:l,assetPath:d,isNonverified:u,hasBypassedContentClassification:p,isMemberOfSpace:m,description:f,shouldNoIndex:g,spaceNameForMetaTag:v,authorName:h,coverImage:b,isPublicSite:y}=i;let w,A,I,k;l&&(0,At().T8)(l.icon)?I=l.icon:l&&(0,It().A)(l.icon)?w=l.icon:l&&St().GM(l.icon)?A=l.icon:d&&St().Du(d)&&(k=d);const x=u&&!p&&!m;s&&document.title!==s&&(x?document.title=t.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):o.isSafari&&w?document.title=`${w} ${s}`:document.title=s),a&&ze().ZO(a)!==ze().ZO(window.location.href)&&(window.history.replaceState(window.history.state,void 0,a),Ct().Mu({environment:e,url:window.location.href}));const C=document.querySelector("link[rel='shortcut icon']");if(C){const t={linkEl:C,environment:e,device:o,theme:n,config:S().A,lastSetIconStringRef:r},i="local"===(T="production")?ht().A.images.faviconLocalIco:"development"===T?ht().A.images.faviconDevIco:ht().A.images.faviconIco;x?(C.href=i,r.current=i):w?function(e,t){const{linkEl:n,environment:o,lastSetIconStringRef:r}=e;if(t===r.current)return;r.current=t,async function(e,t){const n=document.createElement("canvas");n.width=Lt,n.height=Lt;const o=n.getContext("2d");if(o.font="normal normal normal 32px/32px sans",o.textAlign="center",o.textBaseline="middle","raw"===t)return o.fillText(e,n.width/2,n.height/2+4),n;const r=await Ut().w.load(),i=(0,_t().$)(e,r);if(!i)return;const a=document.createElement("img");a.src=(0,bt().bz)(t);const s=(0,bt().LJ)(i);return new Promise((e=>{a.onload=()=>{o.drawImage(a,s.x,s.y,s.size,s.size,0,0,Lt,Lt),e(n)},a.onerror=()=>{e(void 0)}}))}(t,(0,Tt().FN)(o)).then((async e=>{await Bt().waitForInitialPageRenderToComplete(),await Ft().A.waitUntil((()=>!Ft().A.state.isMeasuring)),n.href=(null==e?void 0:e.toDataURL("image/png"))||""}))}(t,w):I?function(e,t){const{linkEl:n,device:o,theme:r,lastSetIconStringRef:i}=e;if(t===i.current)return;i.current=t;const a=`${t}?mode=${r.mode}`;o.isFirefox?n.href=a:jt(a).then((e=>{n.href=e}))}(t,I):l&&A?function(e,t,n){const{linkEl:o,environment:r,config:i,lastSetIconStringRef:a}=e,{...s}=t,c=window.location.origin!==i.domainBaseUrl,l=yt().wY({url:n,permissionRecord:s.pointer,baseUrl:i.domainBaseUrl,fullyQualified:!1,userId:r.currentUser.id,...c?{favicon:!0}:{width:100}});if(l===a.current)return;a.current=l,$t().transactionQueue.awaitRecordTransaction(s.pointer).then((()=>{if(!c)return jt(l);o.href=l})).then((e=>{!c&&e&&(o.href=e)}))}(t,l,A):k?function(e,t){const{linkEl:n,environment:o,config:r,lastSetIconStringRef:i}=e,a=yt().x8({url:t,width:100,baseUrl:r.domainBaseUrl,fullyQualified:!1,userId:o.currentUser.id});if(a===i.current)return;i.current=a,jt(a).then((e=>{n.href=e}))}(t,k):i!==r.current&&(C.href=i,r.current=i)}var T;re().electronApi&&re().electronApi.setWindowTitle&&s&&re().electronApi.setWindowTitle(s),y&&function(e){let{title:t,description:n,url:o,icon:r,image:i,shouldNoIndex:a,author:s,spaceName:c}=e;function l(e,t){const n=`meta[property="${t}"], meta[name="${e}"]`,o=document.querySelector(n);if(o&&o instanceof HTMLMetaElement)return o;const r=document.createElement("meta");return t?r.setAttribute("property",t):r.setAttribute("name",e),document.head.appendChild(r),r}function d(e){const t=document.querySelector(`link[rel="${e}"]`);if(t&&t instanceof HTMLLinkElement)return t;const n=document.createElement("link");return n.setAttribute("rel",e),document.head.appendChild(n),n}['meta[name="twitter:site"]'].forEach((e=>{const t=document.querySelector(e);t&&t instanceof HTMLMetaElement&&t.remove()}));l("twitter:title").setAttribute("content",t);if(l("og:title","og:title").setAttribute("content",t),n){l("description").setAttribute("content",n);l("twitter:description").setAttribute("content",n);l("og:description","og:description").setAttribute("content",n)}if(o){l("twitter:url").setAttribute("content",o);l("og:url","og:url").setAttribute("content",o);d("canonical").setAttribute("href",o)}if(i){l("twitter:image").setAttribute("content",i);l("og:image","og:image").setAttribute("content",i)}if(s){l("article:author","article:author").setAttribute("content",s)}if(c){l("og:site_name","og:site_name").setAttribute("content",c)}if(r){d("shortcut icon").setAttribute("href",r)}if(a){l("robots").setAttribute("content","noindex")}else{const e=document.querySelector('meta[name="robots"]');e&&e instanceof HTMLMetaElement&&e.remove()}}({title:s??"",description:f,url:a,icon:null==C?void 0:C.href,image:b,shouldNoIndex:g,author:h,spaceName:v})}),500,{leading:!0}),i=document.title;return c.state&&o(),c.addListener(o),()=>{c.removeListener(o),document.title=i}}),[e,t,c,n])}n(771702);var Zt=()=>n(401116),Yt=()=>n(8519);const Xt={transcription_idle:async(e,t)=>{(await Yt().$O.load()).idleTranscriptionActions.showIdleTranscriptionToast(e,t)},transcription_error:async(e,t)=>{(await Yt().$O.load()).transcriptionErrorActions.showTranscriptionErrorToast(e,t)}};var Qt=()=>n(533787),en=()=>n(191756);const tn=["us.zoom.xos","com.apple.WebKit.GPU","com.google.Chrome.helper","com.microsoft.teams2"];function nn(e){return"string"==typeof e&&!!(0,oe().Xk)(tn,e)}n(362833);var on=()=>n(714013),rn=()=>n(210562);var an=()=>n(377403);function sn(e){const t=(0,i().v3)(),n=(0,an().W)(),r=(0,_().K8)((()=>t.device.isElectron&&e&&n),[t.device.isElectron,n,e]),a=function(){const e=(0,_().O$)(m().AppStoreCurrentSpaceStore);return(0,_().K8)((()=>{const t=on().A.state.tabs,n=rn().ei.state,o=[];return null!=n&&n.isTranscriptionBlock()&&o.push(n),o.push(...t.flatMap((e=>e.activeBlocks)).flatMap((t=>{if(!t)return[];if(!e)return[];const n=Vt().Bv.createChildStore(e,t.pointer);return n.isTranscriptionBlock()&&o.push(n),[]}))),$().hS(o,"id")}),[e])}(),s=(0,o.useCallback)((async(e,n,o)=>{if(!r)return;const i=o.filter(nn),s=n.filter(nn);for(const r of i){if(a.length>0)break;if(!s.includes(r)){(await Yt().$O.load()).audioProcessDetectionActions.sendNotificationForRunningAudioProcess(t,r);break}}const c=a[0];for(const r of s)if(!i.includes(r)&&c){(await Yt().$O.load()).transcriptionBlockActions.stopTranscription({environment:t,blockStore:c,from:"audio_process_detection"});break}}),[t,r,a]);(0,o.useEffect)((()=>re().runningInputAudioProcessesChanged.addListener(s)),[s]),(0,o.useEffect)((()=>{r&&re().initializeRunningInputAudioProcessDetection(1e3)}),[r])}var cn=()=>n(213766);const ln=(0,L().YK)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"},dictation_in_progress:{defaultMessage:"Transcription is in progress.",id:"closeConfirmationMessages.dictationInProgress"}});var dn=()=>n(667801),un=()=>n(440588),pn=()=>n(216273),mn=()=>n(429044),fn=()=>n(638907);var gn=()=>n(141666),vn=()=>n(814370);function hn(e){(0,vn().default)({url:`${S().A.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}n(107652),n(113085);var bn=()=>n(455831),Sn=()=>n(305043);function yn(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,_().K8)((()=>{const{currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r}=m().default.state;if(!(e.currentUser.id&&n&&o&&r))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const i=r.getSpaceViewStores(),a=i.length>0&&i.every((e=>e.isReady()));if(!n.isDefined()||!o.isDefined()||!a)return;const s=$().oE(i.map((e=>e.getSpaceId()))).map((t=>Se().A.getData(e,{spaceId:t})));if(!s.every((e=>Boolean(e)||null===e)))return;const c=function(e){const t=e.map((e=>(0,be().Gb)(e))),n=new Set($().oE(t));if(n.has("enterprise"))return"enterprise";if(n.has("business"))return"business";if(n.has("plus"))return"plus";if(n.has("personal"))return"personal_pro";if(n.has("team_free"))return"team_free";if(n.has("personal_free"))return"personal_free";if(n.has("free"))return"free";return"none"}(s),l=o.getSettings();if(!l)return;if(void 0===Sn().subscriptionDataStoreInstance.state)return;const d={user_id:n.id,email:n.getEmail(),user_persona:l.persona,user_team_role:l.team_role,user_use_cases:l.use_cases,user_company_size:l.company_size,user_source:l.source,user_plan_type:c,user_subscription_tier:Sn().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:An(s),time_zone:l.time_zone,locale:l.locale,preferred_locale:l.preferred_locale,signup_time:l.signup_time,app_version:t.version};return l.signup_time&&(d.created_at=Math.floor(l.signup_time/1e3)),t.desktopAppVersion&&(d.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(d.mobile_app_version=t.mobileAppVersion),l.used_desktop_web_app&&(d.used_desktop_web_app=l.used_desktop_web_app),l.used_mobile_web_app&&(d.used_mobile_web_app=l.used_mobile_web_app),l.used_mac_app&&(d.used_mac_app=l.used_mac_app),l.used_windows_app&&(d.used_windows_app=l.used_windows_app),l.used_ios_app&&(d.used_ios_app=l.used_ios_app),l.used_android_app&&(d.used_android_app=l.used_android_app),d}),[e,t],{useDeepEqual:!0});(0,o.useEffect)((()=>{n&&"none"!==n.user_plan_type&&wn(e,n)}),[e,n]);const r=void 0!==n;(0,o.useEffect)((()=>{const t=window.setTimeout((()=>{!r&&e.currentUser.id&&wn(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,r])}const wn=$().nF(n(280367).k,5e3);function An(e){return e.map((e=>(0,be().Gb)(e))).filter(oe().Vq).some((e=>bn().dL(e)))}var In=()=>n(420615),kn=()=>n(155691);var xn=()=>n(82958),Cn=()=>n(594528);var Tn=()=>n(623882),En=()=>n(982177),Pn=()=>n(102688),_n=()=>n(877042),Un=()=>n(271932);const Ln={recentPagesActions:new(y().O2)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,610759)))),userSignalsHelpers:new(y().O2)("userSignalsHelpers",(async()=>n.e(84084).then(n.bind(n,33399)))),broadcastChannel:new(y().O2)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,521108)))),minisearchDependency:Pn().f};function Mn(e){const{elector:t,broadcastChannel:n}=e.state;e.setState(e.getInitialState());(async()=>{await(null==t?void 0:t.die()),await(null==n?void 0:n.close())})()}function jn(){(0,o.useEffect)((()=>{(0,_n().So)((()=>({appStart:(0,En().getAppStartTime)(),hookStart:performance.now()})))}),[]);const e=(0,i().v3)(),{currentUserId:t,currentSpaceId:n}=(0,_().K8)((()=>{var e,t;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),r=(0,K().ZC)(t),a=(0,K().ZC)(n);(0,o.useEffect)((()=>{t&&n&&(t!==r||n!==a)&&(Mn(Un().A),async function(e){const{spaceId:t,userId:n,environment:o}=e;Mn(Un().A),(0,_n().So)((e=>({appStart:e.appStart,hookStart:e.hookStart,setupLocalSearchStart:performance.now()})));const r=Ln.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(o,n,t)})),i=Ln.userSignalsHelpers.load(),a=Ln.broadcastChannel.load(),s=(async()=>{const{BroadcastChannel:e,createLeaderElection:o}=await a,r=new e(`local_search_${t}_${n}`),i=o(r);Un().A.update((e=>({...e,elector:i,broadcastChannel:r})))})(),c=(await i).initializeAndLoadAllUserSignals({spaceId:t,userId:n,environment:o});await Promise.all([Pn().f,r,c,s])}({spaceId:n,userId:t,environment:e}))}),[e,t,n,r,a])}var Rn=()=>n(914877);var Bn=()=>n(752597),Nn=()=>n(111066),Dn=()=>n(367111),On=()=>n(205670);const qn=new(n(496985).default)((()=>{const e=Dn().A.state;return e.phase===Dn().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var zn=()=>n(813958),Wn=()=>n(85706),Kn=()=>n(196387);function $n(){const e=(0,i().v3)();(0,o.useEffect)((()=>{function t(t){!function(e,t){I().vd(e,"show_page_reload_confirmation_dialog",t)}(e,{reason:t})}return cn().showConfirmationDialogEventEmitter.addListener(t),()=>{cn().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}const Fn=300;var Vn=()=>n(162901),Gn=()=>n(378569);var Hn=()=>n(450475);var Jn=()=>n(37445);const Zn=5e3,Yn=Math.random()<.01,Xn=!S().A.isLocalhost,Qn=Yn&&Xn;Jn().I.setShouldCollect(Qn);var eo=()=>n(384221),to=()=>n(729522),no=()=>n(848457);const oo=window.matchMedia("(prefers-color-scheme: dark)");var ro=()=>n(132793),io=()=>n(532269);const ao=!1,so=(ao?1:10)*gn().TD,co=5*so;function lo(){ao&&console.log(...arguments)}function uo(){(0,o.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,ro().x0)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const o=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[o,r]of t.entries())n-r>co&&e.push(o);e.length&&lo("Removing tab ids:",e);for(const o of e)t.delete(o)})(),n.postMessage(e);const o=t.size+1;lo("Tab count is",o),(0,io().g)(o)}),so);return()=>{n.close(),window.clearInterval(o)}}),[])}var po=()=>n(113269),mo=()=>n(873617);const fo="loadCachedPageChunk";const go=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"initialize",error:(0,Hn().convertErrorToLog)(t),data:{userId:e.currentUser.id}})}),[e]);(0,a().l)((()=>{Gn().StatsigInitializer.initializePromise?Gn().StatsigInitializer.error?t(Gn().StatsigInitializer.error):Gn().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap")):t(new Error("`statsig.initialize` was not called on app bootstrap"))}))};var vo=()=>n(84543);var ho=()=>n(432924);const bo=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"updateUser",error:(0,Hn().convertErrorToLog)(t),data:{nextUserId:e.currentUser.id,err:(0,n(704082).A)(t).message}})}),[e]),[a]=(0,Vn().Yb)((async()=>await ho().getExperimentDeviceId(e)),[e]),[s]=(0,Vn().Yb)((async()=>await ho().getBrowserId(e)),[e]),c=(0,_().K8)((()=>{var e,t;return!(null===(e=m().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=m().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),l=(0,_().K8)((()=>{var e;return null===(e=m().default.state.currentSpaceStore)||void 0===e?void 0:e.isDefined()}),[]),d=(0,_().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),u=(0,o.useRef)(Gn().StatsigInitializer.statsigStageTwoUser),p=(0,_().K8)((()=>{if("resolved"===a.status&&"resolved"===s.status&&(H().A.state.initialRenderCompleted||d)&&(!e.currentUser.id||l||c||d)){const o=n(194717).getDataForStatsigUser({environment:e,deviceId:a.value,browserId:s.value});if(void 0===o.subscriptionTier){var t;const e=null===(t=u.current)||void 0===t||null===(t=t.custom)||void 0===t?void 0:t.spaceSubscriptionTier;n(532444).nb.find((t=>t===e))&&(o.subscriptionTier=e)}return(0,Gn().tX)(o)}}),[e,a,s,l,c,d],{useDeepEqual:!0}),f=(0,o.useRef)(0),g=!(0,_().O$)(B().e);(0,o.useEffect)((()=>{!async function(){if(Gn().StatsigInitializer.isComplete&&p&&!$().n4(p,u.current)&&!g){u.current=p,f.current++;try{const t=await Gn().statsigClientLoader.getClient()||Gn().statsigClientLoader.getUninitializedStatsigClient({statsigUser:p,initialValues:void 0,overrideStableID:(0,Gn().getOrCreateStableID)()}),o=async function(){var o;const i=(0,n(20971).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...p.customIDs,device:(0,Gn().getDeviceAttributesForStatsigUser)(e.device),locale:r().locale,clientSdkApiKey:S().A.statsig.apiKey,spaceId:null===(o=m().default.state.currentSpaceStore)||void 0===o?void 0:o.id},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(430434).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),a=await(0,vn().default)(i);"success"===a.type?(t.dataAdapter.setData(JSON.stringify(a.data.initialValues)),t.updateUserSync(a.data.statsigUser)):Ae().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,vn().V)(a),nextUserId:e.currentUser.id}})},i=async function(n){t.off("initialization_failure",i),Ae().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}}),await o()};t.dataAdapter.getDataSync(p)?(t.on("initialization_failure",i),await t.updateUserAsync(p)):await o()}catch(o){t(o)}f.current--,0===f.current&&N().default.recomputeAllGroupStores()}}()}),[t,p,e,g])};var So=()=>n(966789);var yo=()=>n(81421),wo=()=>n(68677),Ao=()=>n(712437),Io=()=>n(584215),ko=()=>n(758611),xo=()=>n(145017),Co=()=>n(32194);const To=["compact","regular","unknown"];var Eo=()=>n(3311),Po=()=>n(44658),_o=()=>n(627618),Uo=()=>n(392336),Lo=()=>n(563546),Mo=()=>n(358053),jo=()=>n(582633),Ro=()=>n(10895),Bo=()=>n(399309),No=()=>n(637650),Do=()=>n(264330),Oo=()=>n(874206),qo=()=>n(932387),zo=()=>n(360378),Wo=()=>n(783759),Ko=()=>n(178594),$o=()=>n(782150),Fo=()=>n(410090);var Vo=()=>n(489088);var Go=()=>n(733158),Ho=()=>n(819788),Jo=()=>n(422650);var Zo=()=>n(48913);var Yo=()=>n(98508),Xo=()=>n(526445),Qo=()=>n(166746);var er=()=>n(728373);function tr(e){const t=(0,yo().Xz)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var nr=()=>n(73631),or=()=>n(707423),rr=()=>n(644026),ir=()=>n(392608),ar=()=>n(73876),sr=()=>n(36746),cr=()=>n(672796),lr=()=>n(190094),dr=()=>n(138121);const ur={MobileNativePerformanceListener:new(y().O2)("MobileNativePerformanceListener",(async()=>await n.e(62058).then(n.bind(n,840664))))},pr=(0,y()._h)(ur.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var mr=()=>n(157230),fr=()=>n(838625),gr=()=>n(593745),vr=()=>n(509484),hr=()=>n(723969),br=()=>n(413240),Sr=()=>n(807913),yr=()=>n(600648),wr=()=>n(639916),Ar=()=>n(927105),Ir=()=>n(265987),kr=()=>n(901574),xr=()=>n(120890),Cr=()=>n(973440),Tr=()=>n(134915),Er=()=>n(7379),Pr=()=>n(104838);const _r=(0,L().YK)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}}),Ur=$().Bj((async(e,t)=>(await vr().T.searchActions.load()).getLocalCacheFromAppState(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=m().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function Lr(e){const{mobileNative:t,TabbedRouterStore:o,device:r}=e();if(r.isMobileNative&&t){var i;t.updateReceiveApiHandlers({nativeToWebRenderStart:e=>{mr().N.markNativeStart(e)},connectivityTypeChanged:e=>{B().A.setState({...B().A.state,mobileConnectivityType:e})},toggleAvailableOffline:t=>{const{pageId:n}=t;J().lX({store:new(Vt().Bv)(e(),{table:xo().ev,id:n}),environment:e(),analyticsFrom:"mobile_home"})},statusBarTap:jr,backButtonPress:()=>Qt().N6(e(),{type:"backbutton"}),keyboardWillShow:t=>{Dn().A.updateKeyboardPhase(e(),Dn().i.willShow,t??0)},keyboardDidShow:t=>{Dn().A.updateKeyboardPhase(e(),Dn().i.shown,t??0)},keyboardWillHide:()=>{Dn().A.updateKeyboardPhase(e(),Dn().i.willHide,0)},keyboardDidHide:()=>{var t;(Dn().A.updateKeyboardPhase(e(),Dn().i.hidden,0),r.isIpad)&&(zo().IU({environment:e()}),null===(t=e().NativeMobileActionBarStore)||void 0===t||t.clear(!0))},keyboardConfigChanged:e=>{Dn().A.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,Ho().T)("supportsNativeSafeAreaConfig")?(wo().U4.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):wo().U4.reset()},keyboardShortcut:t=>Qt().N6(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&Dn().A.update((t=>t.lastUpdatedTimestamp&&e.timestamp&&e.timestamp<t.lastUpdatedTimestamp?t:{...t,nativeBottomBarHeight:e.height,lastUpdatedTimestamp:e.timestamp}))},pushNotificationTokenRefresh:t=>jo().handleTokenRefresh(e(),t,"refresh"),resume:Ar().A.resume,pause:async()=>{Ar().A.pause();const{stopDictation:t}=await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(19361),n.e(63327),n.e(26090),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(65554),n.e(66885),n.e(45620),n.e(2681),n.e(32503),n.e(52287)]).then(n.bind(n,649833));await t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await le().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}});const n=m().default.state.currentSpaceStore;n&&await Pr().o2({environment:e(),spaceStore:n})},refreshSubscriptionDataV2:async()=>{const t=m().default.state.currentSpaceStore;t&&await Pr().o2({environment:e(),spaceStore:t})},processMobileActionBarAction:e=>{const{componentId:n,action:o}=e;t.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:o})},logout:t=>{cr().logoutSingleAccount({environment:e(),userId:t,logoutOrigin:Io().d.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:o}=t;cr().logoutSingleAccount({environment:e(),userId:n,logoutOrigin:Io().d.MobileNativeListener,fcmToken:o})},logoutAll:()=>{cr().logout(e())},openDestinationV2:t=>{Jo().A.closeAll();const n=e(),o=(0,yo().Xz)(n.TabbedRouterStore.state),{activeTab:r,tabs:i}=n.TabbedRouterStore.state,a=o===i[r].rootPage,s="native"===o.type,c=a&&s;switch((0,ir().Al)(n)&&Oo().s({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":!function(e,t){const n=new(Vt().Bv)(t,{table:xo().ev,id:e});Ro().ho({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{Do().Y({store:n,environment:t,pageVisitSource:Ao().y8.Move})}})}(t.blockId,n);break;case"trash":Nr({query:t.query});break;case"webSearch":!function(e,t){qo()._N({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),Uo().Mq(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){Dr(e),Tr().A.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){Cr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),Ct().oo({environment:e,url:`${ko().GJ.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"createOrJoinWorkspace":return Br(n,t.userId)}},openDestination:t=>{Jo().A.closeAll();const n=e();switch("closePopup"!==t&&(0,ir().Al)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&Oo().s({environment:n,tab:o.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":Dr(n);break;case"allUpdates":!function(e){(0,Ho().T)("supportsNativeHome")&&e.device.isPhone?(No().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Ct().oo({environment:e,url:`${ko().GJ.nativeTab}/updates`,redirect:!0})):Er().A.setState({...Er().A.state,open:!0})}(n);break;case"addAccount":Sr().c.setState({...Sr().c.state,open:!0});break;case"createOrJoinWorkspace":return Br(n);case"notificationAndSettings":br().A.setState({open:!0,source:br().C.Home});break;case"trash":Nr({});break;case"memberSettings":xr().A.setState({...xr().A.state,open:!0});break;case"help":kr().A.setState({...kr().A.state,open:!0});break;case"intercom_messages":!function(e){$o().SI({environment:e,from:"help_button"})}(n);break;case"aiWriter":!function(e){or().hW(e)}(n)}},updateFileUploadProgress:e=>{const{uploadKey:t,progressPercent:n}=e,o=Ir().default.getKeyState(t);o&&Ir().default.setKeyState(t,{...o,progressPercent:n})},setCurrentUserId:async t=>{await Rr(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const o=await Ko().T({environment:n,newCurrentUserId:e}),{currentUserRootStore:r,currentUserSettingsStore:i}=m().default.state;if(!r)return;await r.load();const a=(0,be().km)(t);a&&await Wo().tR({environment:o,spaceViewStore:a,userSettingsStore:i,userRootStore:r,pageVisitSource:Ao().y8.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const n=(0,Po().tf)(_o().literals(...To),e)?"unknown":e;n!==t.horizontalSizeClass.state&&t.horizontalSizeClass.setState(n)},updateTabbedRouterState:t=>{var n;const o=e(),{TabbedRouterStore:r}=o,i=r.state;if(t.tab!==i.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!$().n4(t.modal,i.modal)||i.tabs[i.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)Cr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)})));Oo().s({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else jr();const a=r.state;return[{state:a,topPage:(0,yo().Xz)(a),webTransitionType:tr(a),updateId:t.updateId??(0,Eo().Ay)()}]},getLocalSearchResults:async t=>{const n=await Ur(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const o=(0,Po().tf)(Co().gG,t.sort);if(o)return[{error:`old sort type is unsupported! ${o}`}];const r=t.sort,i=!B().A.state.online&&N().default.checkGate({gateName:"download_for_offline"}),a={...t.filters,isOfflineOnly:i},s=(0,hr().k)({query:{query:{text:t.query??"",filters:a,sort:r},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e()}),c=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!s||0===s.results.length)return c;const l=B().A.state.online?sr().kZ(e(),s.results):s.results;return[{value:{results:l,total:l.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await nr().T.formulas.load();(0,or().aI)(e(),"custom_add_comment_menu_item",t)},filterValidMoveToBlocks:t=>{const n=t.targets.map((t=>new(Vt().Bv)(e(),{table:xo().ev,id:t}))),o=t.blocks.filter((t=>{const o=new(Vt().Bv)(e(),{table:xo().ev,id:t});return o.canEdit()&&(0,rr().zO)(o,n)}));return[{value:{targets:t.targets,blocks:o}}]},completeMoveToTransaction:async t=>{const{targets:n,destination:o,moveToContext:r,timeToSelectMs:i,isSearchResult:a,flowId:s}=t,c=n.map((t=>new(Vt().Bv)(e(),{table:xo().ev,id:t}))),l=Ro().zs(e(),n,o);if(c&&c.length>0&&!l)try{return await vo().createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:e(),waitForServerCommit:!1,perform:async t=>{await Ro().Ju({targets:c,value:o,transaction:t,environment:e(),moveToContext:r,renderType:"native",timeToSelectMs:i,disableSuccessToast:!0,isSearchResult:a,flowId:s})}}),[{value:t}]}catch(d){}return Lo().qN(e(),{type:"moved_to_subpage"}),[{error:Nt().A.formatMessage(_r.failedToMovePageGeneric)}]},undoRevision:()=>{Bo().tN({environment:e(),preventSelectText:!0})},searchTeams:async e=>{const{query:t}=e,n=m().default.state.currentSpaceStore,o=m().default.state.currentSpaceViewStore;if(!n||!o)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const r=await vr().T.searchActions.load();return[{value:{ids:(await r.searchTeams({spaceViewStore:o,query:t,teamStores:o.getTeamsStores()})).map((e=>e.id))}}]},getImageBlockUrls:async t=>{var n;const{blockId:o,renderWidth:r}=t,i=null===(n=gr().K.findBlockFromId(o))||void 0===n?void 0:n.getBlockStore();if(!i||"image"!==i.getType())return[{error:"blockId points to a non-image block"}];const a=i,s=(0,Fo().x7)(a),c={isAuthenticated:!0,url:s,width:r,permissionRecord:a.pointer},l=e(),d=await(0,fr().L)(c,l);if(!d)return[{error:"could not get proxied image url"}];const u=0===d.indexOf("https:")?d:`${S().A.domainBaseUrl}${d}`;let p;return St()._J(s)&&(p=await(0,Mo().k)(l,{url:s,download:!1,downloadName:"image",permissionRecord:a.pointer},!1,!1)),[{value:{previewUrl:u,originalUrl:p}}]}});const s=e().mobileNative;var a;if(null!=s&&null!==(i=s.api)&&void 0!==i&&i.ready)null==s||null===(a=s.api)||void 0===a||a.ready()}}function Mr(){const e=(0,i().v3)(),{device:t}=e;(0,o.useEffect)((()=>Lr((()=>e))),[e]),function(){const e=(0,i().v3)(),t=(0,_().K8)((()=>(0,Vo().Y)(e)),[e]);(0,o.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,i().v3)(),t=(0,_().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=m().default.state;if(!e||!t)return;const n=Wt().zD.isShowingQNAOnMobile(),o=Wt().zD.shouldShowAssistantFace();return{userId:e.id,spaceId:t.id,enabled:n,showAssistantFace:o}}),[]);(0,o.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const{mobileNative:e}=(0,i().v3)();(0,o.useEffect)((()=>{null==e||e.updateAiAssistantVisibilityState({enabled:!1})}),[e])}(),function(){const e=(0,i().v3)(),{mobileNative:t,WindowSizeStore:n}=e,r=(0,_().O$)(n),a=(0,_().K8)((()=>({visible:un().sidebarExpandedStore.state&&!(0,Zo().o1)(e),width:(0,Zo().r6)(e)})),[e]);(0,o.useEffect)((()=>{null==t||t.sidebarVisibility(a.visible,a.width)}),[e,t,r,a])}(),function(){const e=(0,i().v3)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:r,previousState:a}=(0,_().K8)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,o.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:r,topPage:(0,yo().Xz)(r),webTransitionType:tr(r),updateId:(0,er().Ay)()}),!a)return;const t=(0,yo().WP)(a),o=(0,yo().WP)(r);$().n4(t,o)||Uo().yY(e,{origin:t,destination:o,from:r.navigationSource,action:r.navigationAction,logging_source:"mobile_native"})}}),[e,t,r,a])}(),function(){const{mobileNative:e,RouterStore:t}=(0,i().v3)(),{isIOS:n}=(0,i().Y0)(),r=(0,o.useRef)(!1),a=(0,_().O$)(Xo().A),s=(0,_().K8)((()=>"onboarding"===t.state.route.name),[t]);(0,o.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(s||un().sidebarOpenStore.state||Qo().A.getPreventScrollType()!==Yo().A.None?!1!==r.current&&(r.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==r.current&&(r.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,s,e,a])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,i().v3)(),n=(0,_().K8)((()=>{var e;if(!(0,Ho().T)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=m().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,Ho().T)("supportsNativeBottomBarOverlappingWebView")?Jo().A.hasOpenMobileSlideUps():Jo().A.hasOpenPopups())return!1;const o=(0,yo().Xz)(t.state),r="web"===o.type&&((null===(e=o.redirectedTo)||void 0===e?void 0:e.route)||o.route);if(!r||"page"!==r.name)return!1;const i=On().default.state;if("empty"===i.mode)return!1;const a=(0,Go().ZS)({multiSelection:i.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!a||0===a.stores.length)&&a.stores.every((e=>e.canComment()))}),[t]);(0,o.useEffect)((()=>{(0,Ho().T)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),function(){const{mobileNative:e}=(0,i().v3)(),t=(0,_().K8)((()=>{var e;return Boolean(null===(e=rn().ei.state)||void 0===e?void 0:e.isTranscriptionBlock())}),[]);(0,o.useEffect)((()=>{null==e||e.requestKeepScreenOn(t)}),[t,e])}(),(0,lr().qh)(),(0,o.useEffect)((()=>{t.isTablet&&un().sidebarWidthStore.setState(300)}),[t]);const n=(0,o.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const o=n;t&&(e.tabs[o].nativeRootPageOverrideEnabled=void 0),o!==e.activeTab?e.tabs[o].pages=[]:e.tabs[o].pages=e.tabs[o].pages.slice(-1)}))}),[]),r=(0,o.useCallback)(((t,o)=>{var r;const{mobileNative:i,TabbedRouterStore:a,currentUser:s}=e,c=m().default.state.currentSpaceStore,l=null==c?void 0:c.id;if(null!=i&&null!==(r=i.api)&&void 0!==r&&r.setCurrentSpaceInfo&&(Ae().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:l}}),i.api.setCurrentSpaceInfo({spaceId:l,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,ir().Al)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=l&&(0,Eo().Xw)(l);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=$().mg(a.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==o?void 0:o.id)&&n(t),a.setState(t)}Ur(e,void 0)}),[n,e]),a=(0,o.useCallback)((t=>{var o;null!==(o=e.mobileNative)&&void 0!==o&&null!==(o=o.api)&&void 0!==o&&o.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const r=!(0,ir().Al)(e)||void 0===e.currentUser.id,{TabbedRouterStore:i}=e,a=$().mg(i.state);n(a,r),i.setState(a)}),[n,e]),s=(0,_().K8)((()=>m().default.state.currentUserStore),[]),c=(0,K().ZC)(s);(0,o.useEffect)((()=>{(null==s?void 0:s.id)!==(null==c?void 0:c.id)&&a(s)}),[a,s,c,t.isMobileNative,e.mobileNative]);const l=(0,_().O$)(m().AppStoreCurrentSpaceViewStore),d=(0,K().ZC)(l);(0,o.useEffect)((()=>{(null==l?void 0:l.id)!==(null==d?void 0:d.id)&&r(l,d)}),[r,l,d,t.isMobileNative,e.mobileNative]);const u=(0,x().X)("mab_debugging");return(0,o.useEffect)((()=>{or().tu(u)}),[u]),(0,q.jsx)(pr,{})}function jr(){var e;if(Qo().A.getPreventScrollType()===Yo().A.None)if(un().sidebarOpenStore.state)ar().A.SidebarMobileScroller&&(null===(e=ar().A.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(ar().A.MenuScroller){var t;null===(t=ar().A.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(ar().A.MenuPageScroller){var n;null===(n=ar().A.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(ar().A.PageScroller){var o;null===(o=ar().A.PageScroller.getNode())||void 0===o||o.scrollTo({top:0,behavior:"auto"})}}async function Rr(e,t){return t.currentUser.id===e?t:await Ko().T({environment:t,newCurrentUserId:e})}async function Br(e,t){let n=e;t&&(n=await Rr(t,e)),await dr().Ig(n,"mobile_native_listener")}function Nr(e){yr().A.setState({open:!0});const{query:t}=e;t&&wr().Ay.setState({...wr().Ay.state,currentTab:"all_pages",filter:t,limit:wr().Ay.startLimit})}function Dr(e){(0,Ho().T)("supportsNativeHome")&&e.device.isPhone?(No().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),dn().quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):dn().quickAddPage({environment:e,from:"mobile_bottom_bar"}),Uo().Mq(e,{itemName:"add_page"})}function Or(e){const t=(0,i().v3)();(0,a().l)((()=>{const{device:e,mobileNative:n}=t;if(d().cL(t),u().fD(t),n&&n.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(k().Hw6)}(0,I().ET)(t),s().hR({device:e,config:S().A,cookieService:t.cookieService}),l().g5(r().locale),(0,c().O8)(window.location.href)})),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{b()}),h),b());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{b()}),h),b()},o=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",o),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,o.useRef)(!1),t=(0,i().v3)(),n=(0,o.useCallback)((async e=>{if(e.currentUser.id&&ue().fJ.size>0){const t=await le().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(ue().fJ.values())}});if("success"===t.type){const{results:n}=t.data,o=new Set(ue().fJ);for(const t of n)o.delete(t.id),t.status&&(0,de().s)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),ue().u_.emit(t.id,t),fe.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||ue().fJ.delete(t.id);if(o.size>0)for(const e of o.values())ue().fJ.delete(e)}}}),[]),r=(0,_().K8)((()=>{var e;return null===(e=m().default.state)||void 0===e||null===(e=e.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),a=(0,o.useCallback)((async e=>{if(e.currentUser.id&&r){const t=await le().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:r}});if("success"===t.type){for(const e of t.data.taskIds)ue().fJ.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,r]),s=(0,o.useCallback)((()=>{const n=B().A.state.online;n&&!e.current&&a(t),e.current=n}),[t,a]);function c(e){"success"===e.state?pe().A.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?pe().A.setStatus(e.request.blockId,e.status):pe().A.setStatus(e.request.blockId,void 0)}function l(e){"success"===e.state?me().A.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?me().A.setStatus(e.request.blockId,!0):me().A.setStatus(e.request.blockId,!1)}(0,o.useEffect)((()=>{e.current=B().A.state.online;const o=setInterval((()=>n(t)),2e3);return a(t),B().A.addListener(s),fe.addListener(ce().r,c),fe.addListener(se,l),()=>{clearInterval(o),B().A.removeListener(s),fe.removeListener(ce().r,c),fe.removeListener(se,l)}}),[t,n,s,a])}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>{ge().uh(e)}),[e]);(0,o.useEffect)((()=>(t(),ve().A.addListener(t),()=>{ve().A.removeListener(t)})),[t])}(),ye(),Me(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const{device:t}=e;"external"===(0,qe().parseRoute)({url:window.location.href,isMobile:t.isMobile,baseUrl:S().A.domainBaseUrl,publicDomainName:S().A.publicDomainName,protocol:S().A.protocol,currentUrl:window.location.href}).name&&Te().ui({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,q.jsx)(L().sA,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=ze().pf({relativeUrl:ze().ZO(window.location.href),baseUrl:S().A.domainBaseUrl}),t=ze().qg(e);t.protocol=ze().qg(window.location.href).protocol,window.location.href=ze().GP(t)}}]})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Ke(e);const t=window.setInterval((()=>Ke(e)),Fe);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{(0,Ve().setEnvironment)(e)}),[e])}(),gt(),Jt(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{hn(e);const t=window.setInterval((()=>hn(e)),gn().pT);return()=>window.clearInterval(t)}),[e])}(),yn(),function(){const e=(0,i().v3)(),t=(0,_().K8)((()=>kn().default.state.isLoaded),[]),n=(0,_().K8)((()=>kn().default.state.isLoggingEnabled),[]);(0,o.useEffect)((()=>{t&&async function(){const t=await(0,I().TZ)(e);await In().n_({config:S().A,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:kn().default.state.endpoint})}()}),[e,t,n])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const t=t=>{Qt().N6(e,t)},n=t=>{const n=(0,xn().a)(e.device,pn().A.state.preferences),o=$().Tj(n,((n,o)=>(0,Cn().A)(e,t,n)));o&&!{cut:!0,copy:!0,paste:!0}[o]&&Qt().uj(e,t,o)};return window.addEventListener("keydown",n),window.addEventListener("cut",t),window.addEventListener("copy",t),window.addEventListener("paste",t),window.addEventListener("keypress",t),()=>{window.removeEventListener("keydown",n),window.removeEventListener("cut",t),window.removeEventListener("copy",t),window.removeEventListener("paste",t),window.removeEventListener("keypress",t)}}))}(),(0,Tn().A)(),jn(),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{t.isElectron&&re().setLogglyData(Ae().clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(Ae().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Rn().GB({environment:e})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(e.device.isMobile){function t(){Bn().default.afterNextFlush((()=>{Nn().pS(e)}))}return On().default.addListener(t),qn.addListener(t),Dn().A.addListener(t),()=>{On().default.removeListener(t),qn.removeListener(t),Dn().A.addListener(t)}}}),[e])}(),(0,zn().A)(),(0,Wn().Ay)(),function(){const[{value:e}]=(0,Vn().Yb)((()=>Gn().statsigClientLoader.getClient()),[]),t=(0,_().O$)(B().e);(0,o.useEffect)((()=>{e&&(t?e.updateRuntimeOptions({disableLogging:!1}):e.updateRuntimeOptions({disableLogging:!0}))}),[e,t])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(!Jn().I.getShouldCollect())return;const t=setInterval((()=>{Jn().I.getLongEventMetrics().forEach((t=>{(0,I().u4)({environment:e,event:t})})),Jn().I.resetMetrics()}),Zn);return()=>clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,Kn().default,N().default)}),[e])}(),$n(),function(){const e=(0,i().v3)(),t=(0,_().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]);(0,o.useEffect)((()=>{if(t)return;let n,o=!document.hidden;function r(){e.device.isElectron||Ue().A.setState({...Ue().A.state,isVisible:!document.hidden});const t=!document.hidden;t!==o&&(o=t,Ue().P.setState(t),clearTimeout(n),t&&(n=setTimeout((()=>{Ue().P.setState(!1)}),Fn)));const r=xe().K7(),i=r&&(Date.now()-r)/gn().nD>=7;if(e.device.isBrowser&&!document.hidden&&(!r||i)&&B().A.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;xe().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",r),r(),()=>{document.removeEventListener("visibilitychange",r)}}),[e,t])}(),function(){const{defaultRecordCache:{persistedRecordCache:e}}=(0,i().v3)(),t=(0,x().X)("recover_from_sqlite_corruption"),n=(0,x().X)("recover_from_sqlite_corruption_log_integrity_check_results");(0,o.useEffect)((()=>{const o=new AbortController;if(t||n)return async function(){if(e)for(;!o.signal.aborted;){try{const{corruptRecordCacheResults:o,corruptOfflineResults:i}=await e.getCorruptTables();if(n&&Ae().log({level:"info",from:"useRecoverFromSqliteCorruption",type:"corruptTablesFound",data:{corruptRecordCacheResults:o,corruptOfflineResults:i}}),t&&(o.length>0||i.length>0)){let t;try{t=await e.backupOfflineTables()}catch(r){}await e.completelyRebuildSqliteDb(),t&&await e.restoreOfflineTablesBackup(t)}}catch(r){Ae().log({level:"error",from:"useRecoverFromSqliteCorruption",type:"unexpectedError",error:(0,Hn().convertErrorToLog)(r)});break}await(0,F().wR)(5e3)}}(),()=>{o.abort()}}),[e,t,n])}(),function(){const{deviceType:e}=(0,i().Y0)(),t=(0,i().v3)(),n=t.currentUser.isLoggedIn();(0,o.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const o=async()=>{await re().isMainTabOrWindow()&&le().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};o();const r=window.setInterval((()=>{o()}),5*gn().Xb);return()=>{window.clearInterval(r)}}),[n,e,t])}(),uo(),function(){const e=(0,i().v3)(),t=(0,o.useRef)(),n=(0,o.useRef)();(0,o.useEffect)((()=>{function o(){const o=On().default.state,r="empty"===o.mode?void 0:o.multiSelection.start.store,i="empty"===o.mode?void 0:o.multiSelection.end.store;if(t.current===r&&n.current===i)return;if(t.current=r,n.current=i,t.current!==n.current)return;const a=mo().wg();if(!a)return;const{rowIndex:s,columnIndex:c,simpleTableStore:l}=a.getProps();po().VC({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:l})}return On().default.addListener(o),()=>{On().default.removeListener(o),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{var n,o;const r={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(o=m().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id})`))||void 0===n?void 0:n.type)},i={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};Kn().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...r,sub_metrics:{dns_lookup:i.dns_lookup.endTime-i.dns_lookup.startTime,connection_establish:i.connection_establish.endTime-i.connection_establish.startTime,request_queued:i.request_queued.endTime-i.request_queued.startTime,response_wait:i.response_wait.endTime-i.response_wait.startTime,response_download:i.response_download.endTime-i.response_download.startTime}}});for(const[a,{startTime:s,endTime:c}]of Object.entries(i))Kn().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${a}`,startTime:s,endTime:c},{environment:e,data:r})}),[e]);(0,o.useEffect)((()=>{const e=new PerformanceObserver((n=>{const o=n.getEntries().find((e=>e.name.includes(`${S().A.api.http}/${fo}`)&&!e.name.endsWith("s")));o&&("resource"===o.entryType&&t(o),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),go(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const t=()=>vo().updateConnectionState(e);return t(),B().A.addListener(t),()=>{B().A.removeListener(t)}}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,i().v3)(),t=(0,o.useRef)("none"),n=(0,o.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?no().A.setState({isDragging:!0}):"dragging"===n&&no().A.setState({isDragging:!1}))}),[]),r=(0,o.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),a=(0,o.useCallback)((()=>{n("none")}),[n]),s=(0,o.useCallback)((()=>{"touching"===t.current&&to().isExpanded(to().get())&&n("dragging")}),[n]);(0,o.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",r),window.addEventListener("touchend",a),window.addEventListener("touchcancel",a),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchend",a),window.removeEventListener("touchcancel",a),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,r,a,s]);const c=(0,o.useCallback)((()=>{Bn().default.afterNextFlush((()=>{eo().clearSavedSelectionXPosition()}))}),[]),l=(0,o.useCallback)((()=>{setTimeout((()=>{to().get()||eo().clear({environment:e})}),0)}),[e]);(0,o.useEffect)((()=>(window.addEventListener("mousedown",c),e.device.isMobileBrowser&&document.addEventListener("focusout",l),()=>{window.removeEventListener("mousedown",c),document.removeEventListener("focusout",l)})),[e,c,l])}(),function(){const e=(0,_().O$)(ie().j),t=(0,x().X)("simulate_offline");(0,o.useEffect)((()=>{ae("simulate_offline_set_value_in_local_storage",(()=>{t&&void 0===e&&ie().j.setState({shouldSimulateOffline:!1,lastUpdatedTime:Date.now()})}))}),[t,e]);const n=(0,_().K8)((()=>{var e;return null===(e=ie().j.state)||void 0===e?void 0:e.shouldSimulateOffline}),[]),r=(0,K().ZC)(n);(0,o.useEffect)((()=>{ae("simulate_offline_update_electron_with_new_value",(async()=>{t&&void 0!==n&&("boolean"==typeof r&&n!==r||void 0===r&&!0===n)&&(n?await re().setNetworkEmulation({title:"Offline",requestsAllowed:"none"}):await re().setNetworkEmulation({title:"Online (No throttling)",requestsAllowed:"all",latency:0,downloadThroughput:-1,uploadThroughput:-1}))}))}),[t,n,r]),(0,o.useEffect)((()=>{}),[])}(),(0,P().o_)(),(0,W().Ay)(),te(),z(),function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,o.useRef)(!1),r=(0,o.useCallback)((()=>{"system"===ge().lv(e)&&ve().A.emit()}),[e]),a=(0,_().K8)((()=>{var e;return null===(e=m().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,o.useLayoutEffect)((()=>{!n.current&&a&&(r(),n.current=!0)}),[a,r]),(0,o.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>r()});else{if(oo.addEventListener&&oo.removeEventListener)return oo.addEventListener("change",r),()=>{oo.removeEventListener("change",r)};if(oo.addListener&&oo.removeListener)return oo.addListener(r),()=>{oo.removeListener(r)}}}),[t.isAndroid,e,r])}(),bo(),function(){const e=S().A.isLocalhost||!1;(0,o.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?j().D6({label:(0,q.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,q.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,q.jsx)(So().A,{size:"md",onDarkBackground:!0})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackStillOk\t"!==n&&"webpackWarnings"!==n||j().N2()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e])}();const n=(0,ne().kg)();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Mr,{}),t.device.isElectron&&(0,q.jsx)($r,{}),n&&(0,q.jsx)(Fr,{}),(0,q.jsx)(qr,{}),(0,q.jsx)(A,{}),(0,q.jsx)(T,{})]})}function qr(){const e=(0,E().y)(),t=(0,x().X)("offline_push_updates");return e&&t?(0,q.jsx)(Wr,{}):null}const zr=new(y().O2)("usePageSubscriptionManager",(()=>n.e(25556).then(n.bind(n,811958))));function Wr(){const{value:e}=(0,y().fJ)(zr);return e?(0,q.jsx)(Kr,{usePageSubscriptionManager:e.usePageSubscriptionManager}):null}function Kr(e){return e.usePageSubscriptionManager(),null}function $r(){return function(){const e=(0,i().v3)(),t=(0,L().tz)(),n=(0,_().K8)((()=>({observedWidth:un().sidebarSizeObserver.rect.state.width,targetWidth:un().sidebarWidthStore.state,isExpanded:un().sidebarExpandedStore.state,resizing:un().sidebarResizingStore.state,isMouseEntered:un().sidebarMouseEnteredStore.state})),[]),r=(0,_().K8)((()=>mn().A.state.open),[]),a=(0,_().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),[s,c]=(0,o.useState)(!1),l=e.currentUser.isLoggedIn(),d=(0,ke().formatVersion)(re().getDesktopVersion()),[u,p]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{u&&s&&re().windowSidebarState.set({isLoggedIn:l,...n})}),[n,l,u,s]);const f=(0,_().K8)((()=>{var e,t;const n="transcription"===(null===(e=rn().Ay.state.rootBlock)||void 0===e?void 0:e.getType())?null===(t=rn().Ay.state.rootBlock)||void 0===t?void 0:t.pointer:void 0;return n?[{type:"transcription",pointer:n}]:[]}),[]);(0,o.useEffect)((()=>{re().setActiveBlocks(f)}),[f]);const g=(0,_().K8)((()=>rn().Ay.getState().enabled),[]);(0,o.useEffect)((()=>{re().setIsRecording(g)}),[g]);const v=(0,an().W)(),h=(0,i().Y0)();(0,o.useEffect)((()=>{if(v){var e;const t=(null===(e=pn().A.state.preferences)||void 0===e?void 0:e.transcriptionShortcut)??(0,Zt().C)(h.isMac);re().electronAppFeatures.setPreference("transcriptionShortcut",t)}}),[v,h.isMac]),(0,o.useEffect)((()=>{let e;e=l?n.isExpanded?"expanded":"collapsed":"disabled",re().sidebarState.set(e)}),[n.isExpanded,l]);const b=(0,_().K8)((()=>{var e,t,n;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),currentPageId:null===(n=m().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id}}),[]);(0,o.useEffect)((()=>{re().setAppStoreState(b)}),[b]);const y=(0,x().X)("tab_groups_beta_launch");(0,o.useEffect)((()=>{re().tabSpacesState.setIsTabSpacesBetaEnabled(y)}),[y]),sn(Boolean(u));const w=(0,_().K8)((()=>R().$o.state&&"page"===e.RouterStore.state.route.name),[e.RouterStore]);(0,o.useLayoutEffect)((()=>{re().setZenMode(w)}),[w]);const A=(0,o.useCallback)(((t,n,o)=>{I().vd(e,n,o)}),[e]);(0,o.useEffect)((()=>re().track.addListener(A)),[A]);const k=(0,o.useCallback)(((t,n)=>{n.forEach((t=>{I().u4({environment:e,event:t})}))}),[e]);(0,o.useEffect)((()=>re().trackBatched.addListener(k)),[k]);const C=(0,o.useCallback)(((e,t)=>{a||p(t)}),[a]),T=(0,o.useCallback)(((e,t)=>{!async function(){const e=await Yt().$O.load();await e.dictationActions.updateActiveBlocks(t)}()}),[]),E=(0,_().K8)((()=>{const{tabs:e}=on().A.state;return e.flatMap((e=>e.activeBlocks??[]))}),[]);(0,o.useEffect)((()=>{E.length>0&&T(void 0,E)}),[T,E]),(0,o.useEffect)((()=>{if(void 0===u||a)return;const e=()=>{Ue().A.update((e=>({...e,isVisible:!document.hidden&&u})))};return e(),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[u,a]),(0,o.useEffect)((()=>{if(!a)return re().isActiveTab.get().then((e=>{p(e)})),re().isActiveTab.addListener(C)}),[C,a]);const P=(0,o.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),pn().A.setState(t)}),[]);(0,o.useEffect)((()=>{var e;return null===(e=re().electronAppFeatures.get())||void 0===e||e.then((e=>{pn().A.setState(e)})),re().electronAppFeatures.addListener(P)}),[P]);const U=(0,o.useCallback)(((e,t)=>{on().A.update((e=>({...e,tabs:t})))}),[]);(0,o.useEffect)((()=>re().electronTabs.addListener(U)),[U]);const M=(0,o.useCallback)(((e,t)=>{on().A.update((e=>({...e,currentTab:t})))}),[]);(0,o.useEffect)((()=>re().electronCurrentTab.addListener(M)),[M]);const B=(0,o.useCallback)(((e,t)=>{on().A.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const o=Array.from(n);return{...e,unauthorizedIframeUrls:o}}))}),[]);(0,o.useEffect)((()=>re().setUnauthorizedIframeUrls.addListener(B)),[B]);const D=(0,o.useCallback)((t=>{dn().setExpand({environment:e,isExpanded:!n.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,n.isExpanded]);(0,o.useEffect)((()=>re().sidebarState.addToggleListener(D)),[D]);const O=(0,o.useCallback)(((e,t)=>{t?dn().open({fromElectron:!0}):dn().close()}),[]);(0,o.useEffect)((()=>re().sidebarState.addSetSidebarOpenListener(O)),[O]);const q=(0,o.useCallback)(((e,t)=>{un().sidebarExpandedStore.setState(t.isExpanded),un().sidebarWidthStore.setState(t.targetWidth)}),[]),z=(0,o.useCallback)((e=>{mn().A.update((e=>({...e,open:!e.open})))}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addToggleMenuListener(z)),[z]);const W=(0,o.useCallback)(((e,t)=>{mn().A.update((e=>({...e,tabSpacesState:{...e.tabSpacesState,...t}})))}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addListener(W)),[W]),(0,o.useEffect)((()=>{!u&&r&&mn().A.update((e=>({...e,open:!1})))}),[u,r]);const K=(0,o.useCallback)(((e,t)=>{j().D6({label:t})}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addSnackBarMessageListener(K)),[K]),(0,o.useEffect)((()=>(re().windowSidebarState.get().then((e=>{e&&(un().sidebarExpandedStore.setState(e.isExpanded),un().sidebarWidthStore.setState(e.targetWidth)),c(!0)})),re().windowSidebarState.addListener(q))),[q]),(0,o.useEffect)((()=>{!async function(){if(void 0===d)return;const t=await le().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:d}});"success"!==t.type||t.data.compatible||window.location.replace(S().A.domainBaseUrl+t.data.redirect)}()}),[d,e]),(0,o.useEffect)((()=>re().performShortcut.addListener(((t,n)=>{Qt().N6(e,n)}))),[e]);const $=(0,_().K8)((()=>{if(N().default.checkGate({gateName:"desktop_close_confirmation_dialog"})){const e=(0,cn().getUserControlledCloseConfirmationDialogReason)();if(e)return{analytics_id:e,localized_message:t.formatMessage(ln[e])}}}),[t]);(0,o.useEffect)((()=>{re().setCloseConfirmationDialogReason($)}),[$]);const F=(0,_().O$)(m().AppStoreCurrentSpaceStore),V=(0,o.useCallback)(((t,n)=>{if(!F)return;const o=fn().B.createChildStore(F,n.pointer);en().uK({environment:e,store:o,pageVisitSource:n.source})}),[e,F]);(0,o.useEffect)((()=>re().navigateToBlock.addListener(V)),[V]);const G=(0,o.useCallback)(((t,n)=>{Xt[n.toastId](e,n)}),[e]);(0,o.useEffect)((()=>{var e;return null===(e=re().pushToast)||void 0===e?void 0:e.addListener(G)}),[G])}(),null}function Fr(){return(0,ne().a1)(),null}},506631:(e,t,n)=>{var o=()=>n(129978);const r={WorkflowTemplatesBuilderNotInProd:new(o().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(92845),n.e(48486),n.e(63077),n.e(90966),n.e(94611)]).then(n.bind(n,576217)))),CollectionItemNameConfigMenuItemNotInProd:new(o().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(12062).then(n.bind(n,327351))))};(0,o()._h)(r.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,o()._h)(r.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},591723:(e,t,n)=>{n.d(t,{O:()=>i,t:()=>r});var o=()=>n(129978);const r=(0,o()._h)(new(o().O2)("PeekRenderer",(async()=>{const{default:e}=await Promise.all([n.e(43380),n.e(16471),n.e(28866),n.e(48632),n.e(21194),n.e(60499),n.e(13402),n.e(44632),n.e(43151)]).then(n.bind(n,944564));return{PeekRenderer:e}})),(e=>e.PeekRenderer)),i=(0,o()._h)(new(o().O2)("RestrictedAccess",(async()=>{const{RestrictedAccessComponent:e}=await n.e(57314).then(n.bind(n,81404));return{RestrictedAccessComponent:e}})),(e=>e.RestrictedAccessComponent))},595945:(e,t,n)=>{n.d(t,{P:()=>m,U:()=>p});var o=()=>n(803290),r=()=>n(621641),i=()=>n(486881),a=()=>n(339190),s=()=>n(485966),c=()=>n(205670),l=()=>n(84543),d=()=>n(658388);function u(){const e=c().default.state;if("editing"===e.mode){const t=(0,r().H7)(e.multiSelection);if(t&&(0,i().gE)(t.selection)){const e=t.store,n=a().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,o().K8)(u,[])}function m(e){const{currentUserSettingsStore:t}=s().default.state;t&&l().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{d().mJ({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},601178:(e,t,n)=>{n.d(t,{EG:()=>a,K5:()=>i,RH:()=>r,Yi:()=>s,ls:()=>o});const o=32,r=202,i=1e3,a="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",s="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},642910:(e,t,n)=>{n.d(t,{A:()=>_});var o=n(242343),r=()=>n(237385),i=()=>n(152058),a=()=>n(803290),s=()=>n(174114),c=()=>n(155342),l=()=>n(653998),d=()=>n(16791),u=()=>n(502140),p=()=>n(397227),m=()=>n(782150),f=()=>n(137476),g=()=>n(144485),v=()=>n(155691);var h=()=>n(983050),b=()=>n(906230),S=()=>n(901574),y=()=>n(413124),w=()=>n(277013),A=()=>n(126451),I=()=>n(273520),k=()=>n(397791),x=()=>n(103151),C=()=>n(24071),T=n(163643);const E="?";function P(e){const t=(0,r().v3)(),{isMobile:n}=t.device,d=(0,l().tz)(),u=(0,a().K8)((()=>S().A.state.open),[]),{roundButtonStyle:p,buttonPositionStyle:m}=(0,w().$)({environment:t,rightEdgeDistance:16,isInPeekRenderer:!1}),f={...p,...m,zIndex:111},g=(0,s().IS)((e=>({hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),v=(0,o.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,i().p)(t)&&y().A.setState(!0)}),[]),I=(0,o.useCallback)((()=>{y().A.setState(!1)}),[]);if(n)return(0,T.jsx)(A().A,{hovered:u,testId:h().prN,mobileFeedback:n,...e,children:(0,T.jsx)(C().A,{left:(0,T.jsx)(k().I,{icon:c().questionMarkCircleIcon,color:"secondary"}),disableMobileBorder:!0,children:(0,T.jsx)(l().sA,{defaultMessage:"Help & support",id:"helpButton.mobileHelpSupportButton.label"})})});const P=d.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),_=(0,b().A)(e,{onFocus:v,onBlur:I});return(0,T.jsx)(x().A,{renderTooltip:()=>(0,T.jsx)("span",{children:(0,T.jsx)(l().sA,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,T.jsx)("br",{})}})}),render:e=>(0,T.jsx)(A().A,{ariaLabel:P,className:h().prN,testId:h().prN,style:f,hoveredStyle:g.hoveredStyle,pressedStyle:g.pressedStyle,...(0,b().A)(_,e),children:E})})}const _=function(){const e=(0,r().v3)(),{isMobile:t}=e.device,i=(0,n(622286).X)("sidebar_contentful_releases"),s=(0,a().K8)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),c=(0,o.useCallback)((()=>{n(598995).VX(e,{from:"corner"}),async function(e){const t=v().default.state;if((0,f().kb)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:o}=(0,g().N1)(e),r=await m().be({environment:e,isSalesAssistedPlan:o});p().n({type:"decagon",locale:d().locale,analyticsSettings:t,decagonInitializeArgs:r,onError:e=>{u().log({level:"error",from:"decagonHelpers",type:"initializeDecagon",error:{message:e.message}})},userHighestPlanType:n,isSalesAssistedPlan:o,cookieService:e.cookieService})}}(e)}),[e]);return(0,T.jsx)(I().Ay,{popupType:t?i?I().z7.BottomSheet:I().z7.SlideUp:I().z7.Popup,hidesMobileNativeBottomBar:s,preventSlideUpTransition:s,renderOrigin:e=>(0,T.jsx)(P,{...e}),originGap:t?0:12,placementToOrigin:t?I().sx.Right:I().sx.Top,alignmentToOrigin:t?I().yP.Center:I().yP.End,buttonPopupStore:S().A,onClick:c,render:()=>(0,T.jsx)(n(992849).p,{})})}},674798:(e,t,n)=>{n.d(t,{setupTransactionLoadGenerator:()=>c});var o=()=>n(996094),r=()=>n(448316),i=()=>n(84543),a=()=>n(485966),s=()=>n(205670);function c(e){(0,o().exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=a().default.state.mainEditorCurrentBlockStore;if(!c)return void console.info("Cannot generateTransactionLoad: No current block");const l=c.getTitleStore();if(!l)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==s().default.state.mode)return void console.info("not editing anything. Click the page title.");const d=t=>{i().createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,canUndo:!0,perform:o=>{console.info("createAndCommit #",t);for(let i=0;i<n;i++){const n=`This is transaction #${t+1}, op ${i+1}, of load started at ${u}`;r().dw({environment:e,editorMode:"default",store:l,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}})},u=new Date;if(0===o)for(let e=0;e<t;e++)d(e);else{let e=0;const n=setInterval((()=>{e<t?(d(e),e++):clearInterval(n)}),o)}}))}},686449:(e,t,n)=>{n.d(t,{r:()=>o});const o=(0,n(851552).Dv)("importEvernote")},740602:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>re});var o=()=>n(371807),r=()=>n(590791),i=()=>n(388901),a=()=>n(400668),s=()=>n(294965),c=()=>n(67151),l=()=>n(81421),d=()=>n(637529),u=()=>n(58065),p=()=>n(68677),m=()=>n(437071),f=()=>n(748001);class g extends(()=>n(375009))().K{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var v=()=>n(432924),h=()=>n(277735),b=()=>n(137650),S=(n(610931),n(362833),n(725707),n(324989),n(771702),n(403517),()=>n(502140)),y=()=>n(220574),w=()=>n(145017),A=()=>n(846657),I=()=>n(149467),k=()=>n(955124),x=()=>n(975392),C=()=>n(450475),T=()=>n(137476),E=()=>n(196387);let P=1;class _{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(290279).B),this.batchReadWorkers=15,this.queuedGetErrors=[],this.pendingWrites=y().RecordMapPolymorphic.create(),this.getManyFromDisk=async e=>{const t=y().RecordMapPolymorphic.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await k().tB(this.connection,e),o=y().RecordMapPolymorphic.create();for(const r of n)this.setCachedRecordMap(o,r);return e.map((e=>{let{pointer:t,userId:n}=e;const r=this.getInMemory(t,n);if(r)return r;const i=o.get(t);return i&&i[n]}))},this.diskReadQueue=new(n(945569).A)({batchSize:Math.floor(n(280151).Zj/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=y().RecordMapPolymorphic.create();const t=Array.from(e).flatMap((e=>{let{value:t}=e;return t?Object.values(t):[]})),o=E().default.DO_NOT_USE_markLegacy("sqlite_record_cache.flush_writes.duration");try{await k()._D(this.connection,t);const e={status:"success"};T().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}catch(r){S().log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:(0,C().convertErrorToLog)(r),data:(0,A().CS)(r,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};T().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}n(836331).default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const o=await(0,n(964968).w)({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:o})}))},this.debouncedFlushWrites=x().sg(this.flushWrites,500,{maxWait:3e3}),this.throttledLogGetErrorBatched=x().nF(this.logGetErrorBatched,3e3,{leading:!1,trailing:!0}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:o,importance:r,maybeStaleRecordMap:i}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return S().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(812815).Fg(e)}const a=e.userId||I().m,s={pointer:t,userId:a,value:o,timestamp:Date.now(),importance:r};this.removePendingWrite(t,a,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:i})}async get(e){const{pointer:t,skipAccessWrites:n}=e,o=`get ${P}`,r=e.userId||I().m;let i;P++,this.getLatency.start(o);try{const e=this.getInMemory(t,r);if(e)return n||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(o,"memory"),e.value;i=E().default.DO_NOT_USE_markLegacy("sqlite_record_cache.get_record.duration");const a=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:r}):this.getFromDiskUnbatched(t,r));if(a){n||this.enqueueWrite({type:"access",record:a}),this.getLatency.end(o,"disk");const e={status:"success"};return T().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}),a.value}}catch(a){a instanceof A().PW||a instanceof A().lh?(this.queuedGetErrors.push(a),this.throttledLogGetErrorBatched(),this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()):S().log({level:"warning",from:"SqliteRecordCache",type:"getError",error:(0,C().convertErrorToLog)(a),data:(0,A().CS)(a,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};return T().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),void(i&&E().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(o,"miss")}}deleteRecord(e,t){t=t||I().m,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||I().m,o=await k().rH(this.connection,{...e,timestamp:t,userId:n}),r=y().RecordMapPolymorphic.create(),i=x().oE(Array.from(this.pendingWrites).map((o=>{const i=o&&o.value&&n&&o.value[n];if(!i||"set"!==i.type)return;const a=i.record.value?i.record.value.value:void 0;if(!a)return;if(i.record.pointer.table!==w().ev)return;const s=a;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(r.set(i.record.pointer,!0),i.record.timestamp<t&&(i.record.timestamp=t),i.record.value):void 0})));for(const a of o)r.get(a.pointer)||this.getInMemory(a.pointer,a.userId)||i.push(a.value);return i}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||I().m,o=await k().NJ(this.connection,{...e,timestamp:t,userId:n});return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async getOfflinePages(e){const{userId:t,orderBy:n}=e;return await k().W9({connection:this.connection,userId:t,orderBy:n})}async getOfflineOriginPages(e){const{userId:t}=e;return await k().Kg({connection:this.connection,userId:t})}async getOfflineAutosyncedOrigins(e){const{userId:t}=e;return await k().M2({connection:this.connection,userId:t})}async isPageAvailableOffline(e){const{pageId:t,userId:n}=e;return await k().gh({connection:this.connection,pageId:t,userId:n})}async getOfflineActions(e){const{impactedPageId:t,userId:n}=e;return await k().Pf({connection:this.connection,impactedPageId:t,userId:n})}async getOfflineLastDownloadedVersion(e){return await k().d6({...e,connection:this.connection})}async getOfflinePageMetadata(e){return await k().cz({...e,connection:this.connection})}async addOfflinePage(e){const{userId:t,pageId:n}=e;await k().i4({connection:this.connection,userId:t,pageId:n})}async addOfflineAction(e){const{userId:t,originPageId:n,impactedPageId:o,autosyncTypes:r}=e;await k().Fo({connection:this.connection,userId:t,originPageId:n,impactedPageId:o,autosyncTypes:r})}async deleteOfflineActionsAndCleanUp(e){const{userId:t,impactedPageIds:n,originPageId:o}=e;await k().JP({connection:this.connection,userId:t,originPageId:o,impactedPageIds:n})}async addOfflinePageAndOfflineAction(e){const{userId:t,impactedPageId:n,originPageId:o,autosyncTypes:r,downloadStatus:i}=e;await k().OR({connection:this.connection,userId:t,impactedPageId:n,originPageId:o,autosyncTypes:r,downloadStatus:i})}async updateOfflinePageLastDownloadedMetadata(e){const{pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r}=e;await k().qM({connection:this.connection,pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r})}async getPageIdsToGarbageCollect(e){const{originPageId:t,userId:n,visitedBlockIds:o,skippedCollectionIds:r}=e;return await k().An({connection:this.connection,originPageId:t,userId:n,visitedBlockIds:o,skippedCollectionIds:r})}async getTeams(e){const{spaceId:t,userId:n,includeArchived:o=!1}=e;return await k().ZN({connection:this.connection,spaceId:t,userId:n,includeArchived:o})}async deleteOfflineActionsWithOriginPageIdAndCleanUp(e){const{originPageId:t,userId:n,autosyncType:o}=e;return await k().Li({connection:this.connection,originPageId:t,userId:n,autosyncType:o})}async removeAllOfflineAutosyncedOrigins(e){const{userId:t}=e;return await k().zv({connection:this.connection,userId:t})}async isPageExplicitlyToggledOffline(e){const{pageId:t,userId:n}=e;return await k().OL({connection:this.connection,pageId:t,userId:n})}async getInlineCollectionsInOfflinePage(e){const{pageId:t,userId:n}=e;return k().ew({connection:this.connection,pageId:t,userId:n})}async getPageDownloadStatus(e){const{pageId:t,userId:n}=e;return await k().sm({connection:this.connection,pageId:t,userId:n})}async setPageDownloadStatus(e){const{pageId:t,userId:n,downloadStatus:o}=e;await k().g8({connection:this.connection,pageId:t,userId:n,downloadStatus:o})}async getOfflineLastDownloadedAt(e){const{pageId:t,userId:n}=e;return await k().g_({connection:this.connection,pageId:t,userId:n})}async updateOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n,lastExecutedAt:o}=e;await k().I6({connection:this.connection,userId:t,taskType:n,lastExecutedAt:o})}async getOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n}=e;return await k().TI({connection:this.connection,userId:t,taskType:n})}async reset(){this.pendingWrites=y().RecordMapPolymorphic.create(),await k().tV(this.connection)}async deleteAllRecordTables(){try{await k().ry(this.connection),await k().lg(this.connection),await k().Wr(this.connection)}catch(e){S().log({level:"error",from:"SqliteRecordCache",type:"deleteAllRecordTablesError",error:(0,C().convertErrorToLog)(e)})}}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}async getCorruptTables(){return await k().ZU({connection:this.connection})}async completelyRebuildSqliteDb(){this.pendingWrites=y().RecordMapPolymorphic.create(),await this.connection.completelyRebuildSqliteDb()}async backupOfflineTables(){return await k().Nt({connection:this.connection})}async restoreOfflineTablesBackup(e){return await k().Rr({connection:this.connection,backup:e})}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),r=o&&o[n];if(r){if("set"===r.type&&"access"===e.type){const t={type:"set",record:{...r.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===r.type&&!r.maybeStaleRecord&&r.record.value&&r.record.value.value?r.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:r}=n.record,i=e.get(o)||{};e.set(o,{...i,[r]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,r=e.get(n)||{};e.set(n,{...r,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}logGetErrorBatched(){const e=this.getEnvironment(),t=x().$z(this.queuedGetErrors,(e=>(0,C().convertErrorToLog)(e).message));for(const[n,o]of Object.entries(t)){if(!n)break;S().log({level:"warning",from:"SqliteRecordCache",type:"getErrorBatched",error:(0,C().convertErrorToLog)(o[0]),data:{batchedData:o.map((t=>(0,A().CS)(t,{isBrowser:e.device.isBrowser})))}},{forceSuppressConsoleLog:!0})}this.queuedGetErrors=[]}async getTablesThatNeedEviction(){try{return await k().W3({connection:this.connection,maxSize:this.maxSize})}catch(e){return T().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),S().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,C().convertErrorToLog)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await k().$c({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}),T().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(o){T().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),S().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,C().convertErrorToLog)(o)})}}}var U=()=>n(214144),L=()=>n(999031),M=()=>n(728405);const j=[WebSocket.OPEN,WebSocket.CONNECTING];class R{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){"message-ports"===await this.getConnectionType()?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){var e;const{preferences:t}=await m().electronAppFeatures.get()||{};if("message-ports"===(null==t?void 0:t.sqliteConnectionType))return"message-ports";const n=m().getDesktopVersion();if(n&&n[0]>=4)return"message-ports";const o=navigator.userAgent.match(/Notion\/(\d+\.\d+\.\d+)/);if(o){const[,e]=o,[t]=e.split(".").map(Number);if(t>=4)return"message-ports"}return null!==(e=m().electronApi)&&void 0!==e&&e.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();const e={execSqliteBatchV2:async e=>{let{batch:t,precondition:n}=e;return this.execSqliteBatchInnerMessagePort({id:U().JW(),batch:t,precondition:n})},execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:U().JW(),batch:e}),completelyRebuildSqliteDb:async()=>this.completelyRebuildSqliteDbInnerMessagePort(U().JW())};this.sqliteConnection=new(M().i)({connection:e,type:"v2",migrations:await(0,L().G)(e)})}async initializeWebSocket(){await this.initializeWebSocketConnection();const e={execSqliteBatchV2:async e=>{const t=U().JW(),{batch:n,precondition:o}=e,r=JSON.stringify({id:t,batch:n,precondition:o,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,r)},execSqliteBatch:async e=>{const t=U().JW(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)},completelyRebuildSqliteDb:async()=>{}};this.sqliteConnection=new(M().i)({connection:e,type:"v2",migrations:await(0,L().G)(e)})}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(r){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const o=await n;if(o.error)throw new Error("Received SQLite error.");return o.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.");return n.value}async completelyRebuildSqliteDbInnerMessagePort(e){const t={id:e,command:"completelyRebuildSqliteDb",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(t);if((await n).error)throw new Error("completelyRebuildSqliteDb error.")}async initializeMessagePortConnection(){return new Promise((async e=>{var t;if(null===(t=m().electronApi)||void 0===t||!t.getSqliteMeta)return;if(this.messagePort)return;const n=t=>{try{if(!t.ports.length||t.source!==window)return;this.messagePort=t.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=e=>{const{id:t,result:n}=e.data,o=this.requests.get(t);o&&(this.requests.delete(t),o({value:n}))},window.removeEventListener("message",n),e()}catch(o){S().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,C().convertErrorToLog)(o)})}};window.addEventListener("message",n);(await m().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){var e;if(null===(e=m().electronApi)||void 0===e||!e.getSqliteMeta)return;const t=await m().electronApi.getSqliteMeta();if(t.error)return;if(this.ws&&j.includes(this.ws.readyState))return;const{serverProcessPort:n,authToken:o}=t.value;this.authToken=o;const r=`ws://127.0.0.1:${n}`;this.ws=new WebSocket(r),this.ws.onclose=()=>{S().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:o}=JSON.parse(t),r=this.requests.get(n);r&&(this.requests.delete(n),r({value:o}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}n(875472),n(76509),n(863754);var B=()=>n(652876);Error;class N{constructor(e){this.initializePromise=void 0,this.dedicatedWorkerConnection=void 0,this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}async execSqliteBatch(e){return(await this.initializePromise).execSqliteBatch(e)}async completelyRebuildSqliteDb(){return(await this.initializePromise).completelyRebuildSqliteDb()}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){const{loadWorker:t,loadSharedWorker:o}=e,r=U().JW(),i=t(),a=o(),s=B().LV(a.port);var c;this.dedicatedWorkerConnection=B().LV(i),B().p(this.dedicatedWorkerConnection,a.port),await(c=n(556866).S(r),new Promise(((e,t)=>{navigator.locks.request(c,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),await s.initializeNewTab({tabId:r});const l={execSqliteBatch:e=>s.execSqliteBatch(e),execSqliteBatchV2:e=>s.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>s.completelyRebuildSqliteDb()},d=new(M().i)({connection:l,type:"v2",migrations:await(0,L().G)(l)});try{await d.ensureMigrated()}catch(u){S().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,C().convertErrorToLog)(u),data:(0,A().CS)(u,{isBrowser:!0})})}return d.optimize().catch((e=>{S().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,C().convertErrorToLog)(e),data:(0,A().CS)(e,{isBrowser:!0})})})),d}}class D{constructor(e){this.sqliteConnection=void 0,this.sqliteConnection=new N({loadWorker:()=>new Worker(new URL(n.p+n.u(75528),n.b)),loadSharedWorker:()=>new SharedWorker(new URL(n.p+n.u(33429),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!(!e.isBrowser||"undefined"==typeof navigator||void 0===(null===(t=navigator.locks)||void 0===t?void 0:t.request)||"undefined"==typeof SharedWorker||"localhost"===window.location.hostname&&"3003"!==window.location.port||e.isAndroid)}(t)){O("loading");const e=new D({currentUserId:n});return e.waitForInitialize().then((()=>{O("success")}),(e=>{O("error"),S().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,C().convertErrorToLog)(e),data:{...(0,A().CS)(e,{isBrowser:!0}),userId:n}})})),e}O("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}}function O(e){n(172470).A.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e})))}var q=()=>n(129044);class z extends q().default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(34662).IcF(t).length)return;const o=n(982288).V.load();this.setState({loading:!0,loaded:!1,result:o}),this.setState({loading:!1,loaded:!0,result:await o})}getKatex(){if(this.state.loaded)return this.state.result}}n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(491955),n(244387),n(113085);var W=()=>n(329911),K=()=>n(141666),$=()=>n(698094),F=()=>n(493065);class V extends q().default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:o}=e;if(this.instanceState[t.id])return;const r=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});r?this.setState({...this.instanceState,[t.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),G(o,t),this.startMessageListeners(t,o)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const o=this.state[t];return o?o.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:o});const r=this.state[t];r&&this.setState({...this.state,[t]:{...r,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:o}=e,r=(0,K().qt)(t),i=(0,K().qt)(n),a=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=i.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(a),...Object.keys(s)]);return c.forEach((e=>{const t=a[e]||[],n=s[e]||[],r=this.getBacklinkState({blockId:e,currentUserId:o}),i=t.filter((e=>!r.backlinks.some((t=>x().n4(e,t))))),c=[...r.backlinks,...i].filter((e=>!n.some((t=>x().n4(e,t)))));this.setBacklinkState({blockId:e,state:{...r,backlinks:c},currentUserId:o})})),Array.from(c)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const o of t)this.setCachedBacklinkState({blockId:o,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return W().K.get({userId:n,key:V.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;return W().K.set({userId:o,key:V.getCacheKey(t),value:n})}async startMessageListeners(e,t){const o=n(293665).L3.fromSpaceShardRecordId(e,w().ev);F().transactionQueue.isPendingTransactionForRecord(o)&&await F().transactionQueue.drain();const r=this.instanceState[o.id];if(!r)return;let i,a=!1;const s=x().nF((n=>{let{value:o}=n;const r=i,s=o||void 0;i=s,a?r!==s&&G(t,e):a=!0}),1e3),c=(0,n(201430).U)(o.id);r.messageStoreListenerReference=$().Ay.addListener(c,void 0,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&($().Ay.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function G(e,t){await F().transactionQueue.awaitRecordTransaction({id:t.id,table:w().ev});const o=(0,n(96814).dR)(t.id),r=o?{"x-notion-space-short-id":o.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},i=n(818369).callMultiCellApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:r}),a=[];let s=0;for await(const n of i)"failed"!==n.type&&(a.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:a,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}class H extends q().default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenu:void 0,menu:void 0,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1,session:void 0}}clear(e){this.update((t=>({...t,menu:void 0,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){var e;void 0!==(null===(e=this.state.menu)||void 0===e?void 0:e.type)&&(this.clear(!0),await n(23371).wR(10))}}function J(e){return`PageDetailsStore:${e.type}:${e.id}`}class Z extends q().default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(76394).HB)(e)}getToggleState(e){const t=J(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=J(e);this.setState({...this.state,[n]:t})}}var Y=()=>n(885237);const X="spellcheckEnabled";class Q{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=Y().A.get(X);this.setEnabled(void 0===e||e)}setEnabled(e){var t,n;(this.enabled=e,Y().A.set(X,e),null!==(t=m().electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=m().electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=m().electronApi)&&void 0!==t&&t.addToDictionary&&m().electronApi.addToDictionary(e)}setLanguages(e){var t;x().n4(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=m().electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&m().electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=m().electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await m().electronApi.getSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=m().electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await m().electronApi.getAvailableSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}}class ee extends(()=>n(496985))().default{}const te=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","desktopEmailConfirm","root","chat","posts","marketplace","team","gallery","settingsConsoleOrganization"],ne=[...te,"login","login/calendar","signup","quickSearch"];let oe=0;async function re(e){var t;const{minimalEnvironment:n,prefetchCache:S,currentUserId:y}=e,{device:w,deviceStore:A,mobileNative:I,cookieService:k}=n,x=""+oe++,C=w.isElectron&&Boolean(null===(t=m().electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=m().electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new R;return await n.initialize(),n}({device:w}):void 0,T=D.maybeCreateInstance({device:w,currentUserId:y}),E=new(c().A),P=new(l().Bd),U=new(u().A),L=new Q,M=(null==I?void 0:I.sqliteConnection)||(null==C?void 0:C.sqliteConnection)||(null==T?void 0:T.sqliteConnection),j=M?new _({connection:M,maxSize:w.isDesktop?1e6:1e5,getEnvironment:function(){return $}}):void 0,B=new(r().L)({inMemoryRecordCache:new(o().A)({name:"default"}),persistedRecordCache:j});T&&T.waitForInitialize().catch((()=>{B.disablePersistedRecordCache()}));const N=function(e){const{device:t,RouterStore:n,ThemeStore:o}=e;let r=te;return(t.isElectron||t.isElectronCalendar||t.isMobileNative)&&(r=ne),new ee((()=>{const e=n.state.route;return e&&r.includes(e.name)?o.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:w,RouterStore:E,ThemeStore:U}),O=w.isMobile?new H:void 0,q=await v().getPublicDomainUserId({device:w,deviceStore:A,mobileNative:I,cookieService:k}),W=new(i().CurrentUser),K=new g({environmentName:"production",getSettings:()=>({enableTestDateOffset:!1,enableIdSchema:!0}),isServerOriginated:!1,currentUserId:y,mapSpaceIdToShortId:(e,t)=>{const n=(0,h().Jn)({defaultRecordCache:B,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str)}}),$={key:x,AppUpdateStore:new(a().I),device:w,deviceStore:A,WindowSizeStore:new(p().nJ)({device:w},window),KeyboardShortcutStackStore:new(s().X),defaultRecordCache:B,mobileNative:I,RouterStore:E,ThemeStore:U,ThemeModeStore:N,ElectronSqlite:C,KatexStore:new z,LocalBacklinkStore:new V,PageDetailsStore:new Z,updateCurrentUserId:void 0,currentUser:W,SpellCheckStore:L,NativeMobileActionBarStore:O,TextSelectionCompositionStore:new(d().P),recordSubscriptionActions:b(),prefetchCache:S,TabbedRouterStore:P,cookieService:k,publicDomainUserId:q,idCreator:K};return f().uh($),$}},741679:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>o});n(610931);async function o(e){const{minimalEnvironment:t,mainStartTime:o,prefetchInitiatedTime:r,prefetchCache:i,initializeStatsigResult:a,currentUserId:s}=e,{device:c}=t,[{setupOnBeforeUnload:l},d,{createClientEnvironment:u},{setupTransactionQueue:p},{default:m},f]=await Promise.all([Promise.resolve().then(n.bind(n,213766)),Promise.resolve().then(n.bind(n,502140)),Promise.resolve().then(n.bind(n,740602)),Promise.resolve().then(n.bind(n,493065)),Promise.resolve().then(n.bind(n,265987)),Promise.resolve().then(n.bind(n,170687))]);let g=await u({minimalEnvironment:t,prefetchCache:i,currentUserId:s});const{ElectronSqlite:v,RouterStore:h}=g;f.setupRecordCacheDebugging(c);const b=await p(g);l({device:c,TransactionQueue:b,AppUpdateStore:g.AppUpdateStore,GlobalFileUploadStore:m});const[S,{default:y}]=await Promise.all([Promise.resolve().then(n.bind(n,795442)),Promise.resolve().then(n.bind(n,196387))]);if(S.initialize(g),c.isMobileNative){const e=y.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,o,r]=await Promise.all([Promise.resolve().then(n.bind(n,582633)),Promise.resolve().then(n.bind(n,893574)),Promise.resolve().then(n.bind(n,58584))]);await t.initializeMobileNativeApp(g),Object.assign(d.clientLogglyEnvironmentData,o.getMobileNativeDeviceInfo(),r.getMobileNativeSessionInfo()),y.DO_NOT_USE_measureLegacy(e,{environment:g,data:{}})}if(c.isElectron){const e=y.mark("desktop.initialize_from_js"),t=await Promise.resolve().then(n.bind(n,437071));await t.initializeElectron({device:c,electronSqlite:v,routerStore:h});const o=await Promise.resolve().then(n.bind(n,519349)),r=await o.getDesktopDeviceInfo();Object.assign(d.clientLogglyEnvironmentData,r,{desktopVersion:c.desktopAppVersion}),y.measure(e,{environment:g})}const[w,A,I,k,x,C]=await Promise.all([Promise.resolve().then(n.bind(n,672796)),Promise.resolve().then(n.bind(n,667801)),Promise.resolve().then(n.bind(n,729522)),Promise.resolve().then(n.bind(n,797096)),Promise.resolve().then(n.bind(n,84543)),Promise.resolve().then(n.bind(n,635703))]),{setupTransactionLoadGenerator:T}=await Promise.resolve().then(n.bind(n,674798));T(g);const[{default:E},P,_,U,{CurrentUser:L},{getGhostAdminUserId:M},{default:j}]=await Promise.all([Promise.resolve().then(n.bind(n,758288)),Promise.resolve().then(n.t.bind(n,242343,19)),Promise.resolve().then(n.t.bind(n,535370,19)),Promise.resolve().then(n.t.bind(n,753081,19)),Promise.resolve().then(n.bind(n,388901)),Promise.resolve().then(n.bind(n,432924)),Promise.resolve().then(n.bind(n,836331))]);I.startListeners(c),g=await w.initialize(g),g.currentUser.id&&g.defaultRecordCache.persistedRecordCache&&C.readAndCacheOfflinePagesMemo({userId:g.currentUser.id,persistedRecordCache:g.defaultRecordCache.persistedRecordCache,tellOtherTabsToUpdate:!1}),g.updateCurrentUserId=async e=>{const t=await M(g),n={...e.environment,currentUser:new L({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};await X(n),n.idCreator.updateCurrentUserId(e.currentUserId)},k.initialize(g),b.startLoop();const[{maybeClearCookies:R,refreshNotionCookies:B,validateHasPermissionArgs:N,clearNotionCookiesWithNoPermission:D,clearThirdPartyCookiesAndLocalStorageWithNoPermission:O},{clearNotionLocalStorageWithNoPermission:q},z,W,K,$,{default:F},V]=await Promise.all([Promise.resolve().then(n.bind(n,432924)),Promise.resolve().then(n.bind(n,125091)),Promise.resolve().then(n.bind(n,469608)),Promise.resolve().then(n.bind(n,601661)),Promise.resolve().then(n.bind(n,982177)),Promise.resolve().then(n.bind(n,37312)),Promise.resolve().then(n.bind(n,982850)),Promise.resolve().then(n.bind(n,991230))]);R(),Promise.all([D(g),O(g)]).then((()=>B(g))),q(),N(g);const[{TransactionQueueDependenciesImpl:G},{waitForStatsigInitialization:H},{isPrewarmedTabInitialRender:J}]=await Promise.all([Promise.resolve().then(n.bind(n,289699)),Promise.resolve().then(n.bind(n,194717)),Promise.resolve().then(n.bind(n,37312))]);let Z,Y;async function X(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await H({environment:g,initializeStatsigResult:a});Z??=j.checkGate({gateName:"react_18_concurrent_rendering"});const i=performance.now(),s=document.querySelector("#notion-app");if(!s)throw new Error('Could not find element with id "notion-app"');b.updateDependencies(new G(e)),x.updateConnectionState(e),z.updateEnvironment(e),d.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),a=document.getElementById("skeleton");e&&e.remove(),a&&a.remove();const s=performance.now();W.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:r,statsigBootupBlockingStartTime:t,renderStartTime:i,renderEndTime:s});const c=K.getAppStartTime();c&&y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:g,data:{sub_metrics:$.getTimeOriginToAppStartSubMetrics()}}),y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:r},{environment:g}),F.state&&y.measure({metricName:"client.migrate_sqlite",startTime:F.state.startTime,endTime:F.state.endTime},{environment:g}),y.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:i},{environment:g,data:{timed_out:n,is_prewarmed_tab:J(g)}})},l=P.createElement(E,{environment:e,onMount:Z?c:void 0});Z?(Y??=U.createRoot(s),Y.render(l)):_.render(l,s,c)}A.initialize(g),await X(g);const{startFlushing:Q}=await Promise.resolve().then(n.bind(n,430434));return Q(((e,t)=>{y.measure(e,{environment:g,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:b,environment:g}}},744819:(e,t,n)=>{n.d(t,{A:()=>r});n(242343);var o=n(163643);const r=(0,n(680369).wt)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},758288:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ho});var o=n(242343),r=()=>n(101565),i=()=>n(114101),a=()=>n(16791),s=()=>n(653998),c=(n(725707),n(491955),()=>n(951592)),l=()=>n(975392),d=()=>n(172516),u=n(163643);function p(e){const t=(0,o.useRef)(new Map),n=(0,o.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),o=n.length-e.maxPreferredIFrames;if(o<=0)return;const r=n.filter((e=>!e.isVisible));r.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of r.slice(0,o))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),r=(0,o.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),i=(0,o.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(r):null);(0,o.useEffect)((()=>()=>{i.current&&(i.current.disconnect(),i.current=null)}),[]);const a=(0,c().ZC)(e.maxPreferredIFrames);(0,o.useEffect)((()=>{a&&e.maxPreferredIFrames<a&&n()}),[n,e.maxPreferredIFrames,a]);const s=(0,o.useMemo)((()=>({track:(e,n)=>{i.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:l().sg(n,50)}),i.current.observe(e)):d().mm.track(e,n)},untrack:e=>{i.current?(i.current.unobserve(e),t.current.delete(e)):d().mm.untrack(e)}})),[]);return(0,u.jsx)(d().jq.Provider,{value:s,children:e.children})}function m(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var f=()=>n(470637),g=()=>n(237385),v=()=>n(71193),h=()=>n(263512),b=()=>n(927685),S=()=>n(137476),y=()=>n(836331);function w(){return 1}function A(e){let{id:t,targetRenderPhase:n="all",samplePercent:r=w(),children:i}=e;const a=(0,g().v3)(),s=(0,o.useCallback)(((e,t,o,i,s,c)=>{(0,h().rQ)(r)&&("all"!==n&&t!==n||S().vd(a,`${v().PX}.${e}`,{time:o,render_phase:t}))}),[a,n,r]),[c]=(0,o.useState)(f().A.withListenerIgnored((()=>y().default.checkGate({gateName:"client-performance-profiler"}))));return c?(0,u.jsx)(o.Profiler,{id:t,onRender:s,children:i}):(0,u.jsx)(u.Fragment,{children:i})}var I=()=>n(88310),k=()=>n(173736),x=()=>n(782422),C=()=>n(842617);function T(){return(0,C().kg)()?(0,u.jsx)(C().MG,{}):null}var E=()=>n(269280),P=()=>n(778417),_=()=>n(430619),U=()=>n(220413),L=()=>n(437071),M=()=>n(865226),j=()=>n(782150),R=()=>n(286404),B=()=>n(951540),N=()=>n(611824),D=()=>n(610271),O=()=>n(83823),q=()=>n(697428);function z(e){var t;let{clearErrorState:n,error:o,errorId:r}=e;const i=(0,g().v3)();(0,E().w)((()=>{L().navigationReady(!1)}));const a=()=>{j().SI({environment:i,from:"page_error"})};return(0,u.jsxs)("div",{style:W,children:[(0,_().s)({width:42,height:42}),(0,u.jsxs)("div",{style:K,children:[(0,u.jsx)("div",{children:(0,u.jsx)(s().sA,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,u.jsx)("div",{children:(0,u.jsx)(s().sA,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,u.jsx)(N().A,{onClick:a,children:e})}})}),r&&(0,u.jsx)("div",{style:$,children:(0,u.jsx)(O().b,{error:o,errorId:r,enablePopup:(0,q().o)(r)})})]}),(0,u.jsxs)(D().Ye,{gap:8,children:[null!==(t=i.currentUser)&&void 0!==t&&t.isLoggedIn()?(0,u.jsx)(R().A,{size:"lg",onClick:()=>{M().oo({environment:i,url:"/home",callback:n})},focused:!0,children:(0,u.jsx)(s().sA,{id:"router.renderErrorPage.homeButton.label",defaultMessage:"Back to my content"})}):null,(0,u.jsx)(B().A,{size:"lg",onClick:()=>window.location.reload(),children:(0,u.jsx)(s().sA,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]})]})}const W={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,P().xH)(a().locale)},K={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:U().Ay.uiGray},$={fontSize:10,marginTop:8};var F=()=>n(803290),V=()=>n(174114),G=(n(362833),n(771702),n(403517),()=>n(31448)),H=()=>n(145046),J=()=>n(172563),Z=()=>n(204435),Y=()=>n(858023),X=()=>n(922172),Q=()=>n(823519),ee=()=>n(279150);function te(e){let{items:t,selectType:n,selectAlignXAxis:o,selectedKeys:r,setSelectedKeys:i}=e;const a=t.map(((e,a)=>{const s=e.key;return(0,u.jsx)(ne,{text:e.text,description:e.description,selected:r[s]??!1,isBelowButtons:Boolean(e.showBelowButtons),isLastItem:a===t.length-1,onSelect:t=>{var o;null===(o=e.onSelect)||void 0===o||o.call(e,t),i("radio"===n?t=>{const n={...t};return Object.keys(n).forEach((t=>{n[t]=t===e.key})),n}:e=>({...e,[s]:t}))},selectType:n,selectAlignXAxis:o},s)}));return(0,u.jsxs)(Z().VP,{children:[(0,u.jsx)(ee().A,{size:5}),a]})}function ne(e){let{text:t,description:n,selected:r,onSelect:i,isBelowButtons:a,selectType:s="checkbox",selectAlignXAxis:c,isLastItem:l}=e;const d=(0,o.useCallback)((()=>{"radio"===s?null==i||i(!0):null==i||i(!r)}),[s,i,r]);return(0,u.jsx)(Q().a,{label:t,description:n,isSelected:r,value:"select_item",width:a?"hug":"fill",colorName:a?"secondary":"primary",style:{marginBottom:l?0:12,...a?{justifyContent:"center",border:"none"}:{}},selectType:s,selectAlignXAxis:c,onChange:d})}const oe=function(){const e=(0,o.useId)(),t=(0,o.useId)(),{open:r,innerStyle:i,keepFocus:a,mode:c,message:d,debugInfo:p,description:m,items:f,selectionItems:g,showCancel:v,showCloseButton:h,renderDraftCommentIcon:S,icon:y,allowCopy:w,selectType:A,selectAlignXAxis:I}=(0,F().K8)((()=>{const{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,shouldRenderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:g}=J().A.state;return{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,renderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:g}}),[]),k=(0,o.useCallback)((()=>{H().zw();const{handleCancel:e}=J().A.state;return e&&e(),!1}),[]),x=(0,o.useCallback)((()=>{const{disableBackgroundDismiss:e}=J().A.state;e||k()}),[k]),C=(0,V().IS)((e=>{const t={width:"100%",marginTop:8};return{plainButton:{...t,marginBottom:"-12px",justifyContent:"center",borderRadius:6},button:{...t,borderRadius:6},description:{color:e.text.secondary,paddingTop:6,paddingBottom:6,textWrap:"pretty"},debugMessage:{paddingTop:10,fontSize:12,color:e.text.tertiary,textAlign:m?"unset":"center"},overflowWrap:{overflowWrap:"break-word"},modal:{overflow:"hidden",width:"wide"===c?406:324,marginLeft:24,marginRight:24,padding:20,boxShadow:e.shadowLG,background:e.modalBackground,borderRadius:12,fontSize:16,alignItems:"center",justifyContents:"center",...i},message:{textAlign:m?"unset":"center",fontWeight:G().Wy.semibold,textWrap:"pretty"},iconContainer:{width:"100%",display:"flex",justifyContent:"center",marginBottom:10,fill:e.mediumIconColor},buttonContainer:{paddingBottom:0}}}),[m,i,c]),[T,E]=(0,o.useState)({});(0,o.useEffect)((()=>{const e={};null==g||g.forEach((t=>{e[t.key]=t.preSelected??!1})),E(e)}),[g]);const P=(0,o.useCallback)((()=>{const o=f.map(((e,t)=>({key:t,render:t=>"plain"===e.buttonType?(0,u.jsx)(n(209684).p,{size:"lg",hovered:t.focused,isRed:"red"===e.color,isBlue:"blue"===e.color,isGray:"gray"===e.color,style:C.plainButton,className:e.className,...t,children:e.label||"Label"}):"solid"===e.buttonType?"gray"===e.color?(0,u.jsx)(n(286270).E,{size:"lg",hovered:t.focused,style:C.button,className:e.className,...t,children:e.label||"Label"}):(0,u.jsx)(B().A,{size:"lg",hovered:t.focused,style:C.button,className:e.className,isRed:"red"===e.color,...t,children:e.label||"Label"}):(0,u.jsx)(R().A,{hovered:t.focused,style:C.button,size:e.isSmall?"sm":"lg",color:"red"===e.color?"uiRed":"blue"===e.color?"uiBlue":void 0,className:e.className,...t,children:e.label||"Label"}),action:()=>{e.onAccept&&(e.onAccept(g?T:void 0),H().zw())}})));v&&o.push({key:"cancel",render:e=>(0,u.jsx)(R().A,{size:"lg",hovered:e.focused,style:C.button,...e,children:(0,u.jsx)(s().sA,{id:"genericDialogModal.cancelButton.label",defaultMessage:"Cancel"})}),action:()=>{k()}});const r=(null==g?void 0:g.filter((e=>!e.showBelowButtons)))??[],i=r.length>0?(0,u.jsx)(te,{items:r,selectType:A,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:E}):void 0,a=(null==g?void 0:g.filter((e=>e.showBelowButtons)))??[],c=a.length>0?(0,u.jsx)(te,{items:a,selectType:A,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:E}):void 0;let P;return p&&(null!=p&&p.messagePrefix?P=`${p.messagePrefix}: ${p.message}`:b().A.isAdminMode&&(P=(0,u.jsx)(s().sA,{id:"dialogRenderer.debugMessage.messagePrefix",defaultMessage:"Debug message: {message}",values:{message:p.message}}))),(0,u.jsx)(n(611871).A,{capture:!0,preventType:n(98508).A.All,children:(0,u.jsxs)("div",{style:C.overflowWrap,children:[h&&(0,u.jsx)(n(972522).A,{onClick:x}),S&&(0,u.jsx)(n(55299).h,{}),y&&(0,u.jsx)("div",{style:C.iconContainer,children:y}),w&&(0,u.jsx)(n(668261).k,{enable:!0,shortcuts:{copy:l().D_},debugName:"DialogRenderer.allowCopy"}),d&&(0,u.jsx)("div",{style:C.message,id:e,children:d}),P&&(0,u.jsx)("div",{style:C.debugMessage,children:P}),m&&(0,u.jsx)("div",{style:C.description,id:t,children:m}),i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ee().A,{size:20}),i,(0,u.jsx)(ee().A,{size:8})]}),(0,u.jsx)(Y().Ay,{type:Y().Oh.Vertical,priority:1,initialFocus:0,sections:[{key:"dialog",render:e=>(0,u.jsx)(n(88271).A,{topBorder:!1,disableMobileBorders:!0,style:C.buttonContainer,...e}),items:o}]}),c&&(0,u.jsx)(u.Fragment,{children:c})]})})}),[f,v,g,A,I,T,p,C.overflowWrap,C.iconContainer,C.message,C.debugMessage,C.description,C.plainButton,C.button,C.buttonContainer,h,x,S,y,w,d,e,m,t,k]);return(0,u.jsx)(X().a,{ariaLabelledBy:e,ariaDescribedBy:t,open:r,keepFocus:a,overlayZIndex:9999999,onDismiss:x,preventHideChildrenWhileOpening:!0,innerStyle:C.modal,render:P})};var re=()=>n(109007),ie=()=>n(992577),ae=()=>n(400088),se=()=>n(549157),ce=()=>n(966789);const le=function(){const e=(0,F().O$)(ae().A);return(0,u.jsx)(X().a,{open:e.open,render:()=>(0,u.jsx)(pe,{}),overlayZIndex:9999})};function de(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function ue(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.text.secondary}}function pe(){const e=(0,V().DP)(),t=(0,g().v3)(),n=(0,F().O$)(ae().A),{targetRecordId:o}=n,r=(0,F().K8)((()=>function(e){return void 0!==e&&Boolean(se().A.state[e])}(o)),[o]);return n.open?(0,u.jsxs)("div",{style:de(t),children:[(0,u.jsxs)("div",{style:ue(e),children:[n.message,(0,u.jsx)(ce().A,{style:{marginLeft:6}})]}),r&&o&&(0,u.jsx)(ie().A,{targetRecordId:o,style:{marginTop:10}})]}):null}var me=()=>n(289241),fe=()=>n(983050),ge=()=>n(601178),ve=()=>n(216273),he=()=>n(631555),be=()=>n(748001),Se=()=>n(755648);function ye(){const e=(0,o.useRef)(null),t=(0,V().DP)().mode,n=(0,V().IS)((()=>({container:{display:"block",position:"fixed",visibility:"hidden",overflowY:"scroll",width:20,height:20}})),[]);return(0,o.useEffect)((()=>{const n=e.current;if(!n)return;const o=new ResizeObserver((e=>{const[n]=e,o=20-n.contentRect.width;o!==Se().A.state&&(Se().A.setState(o),be().u7(t))}));return o.observe(n),()=>{o.unobserve(n)}}),[t]),(0,u.jsx)("div",{style:n.container,ref:e})}function we(e){let{children:t}=e;const n=(0,g().v3)(),r=(0,V().DP)();(0,o.useEffect)((()=>{const{mobileNative:e}=n;null==e||e.markTransitionReady({environment:n,type:"mount"})}),[n]);const i="light"===r.mode?fe().fRh:fe().Rsl,s=(0,C().kg)(),c=(0,C().n_)(),l=(0,C().lC)(),d=(0,F().K8)((()=>{var e;return Boolean(null===(e=ve().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)}),[]),p={inert:(0,F().K8)((()=>!n.device.isMobile&&he().A.state.openModals.size>0),[n])?"true":null},m=(0,V().IS)((e=>({root:{...(0,P().xH)(a().locale),color:e.text.primary,WebkitFontSmoothing:"auto",backgroundColor:d?"rgba(0, 0, 0, 0)":e.contentBackground,transition:"height 0.1s ease",...s&&c&&l&&{height:`calc(100% - ${ge().ls}px)`}},content:{height:"100%"}})),[s,c,l,d]);return(0,u.jsxs)("div",{style:m.root,className:["notion-app-inner",i].join(" "),children:[(0,u.jsx)("div",{style:m.content,...p,children:t}),(0,u.jsx)(re().A,{}),(0,u.jsx)(oe,{}),(0,u.jsx)(le,{}),(0,u.jsx)(me().b,{}),(0,u.jsx)(ye,{})]})}var Ae=()=>n(493302),Ie=()=>n(659196),ke=()=>n(17514),xe=()=>n(105090),Ce=()=>n(545250),Te=()=>n(758611),Ee=()=>n(218357),Pe=()=>n(132793),_e=()=>n(83072),Ue=()=>n(728373),Le=()=>n(234151),Me=()=>n(809811),je=()=>n(539174),Re=()=>n(601661),Be=()=>n(336519),Ne=()=>n(637650),De=()=>n(838790),Oe=()=>n(25503),qe=()=>n(343833),ze=()=>n(178594),We=()=>n(658388),Ke=()=>n(473096),$e=()=>n(76394),Fe=()=>n(818369);var Ve=()=>n(931085);const Ge=function(e){const t=(0,V().DP)(),o={width:42,height:42,flexShrink:0,flexGrow:0};return(0,u.jsxs)("div",{style:{width:"100vw",height:"90vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,u.jsx)(Ve().A,{href:Te().JZ.root,innerStyle:{padding:8,borderRadius:4,marginBottom:2},children:"light"===t.mode?(0,n(713055).S)(o):(0,n(744819).A)(o)}),(0,u.jsx)("div",{style:{maxWidth:320,paddingLeft:18,paddingRight:18},children:e.children})]})};function He(e){let{payload:t}=e;const n=(0,g().v3)(),[r,i]=(0,o.useState)(t?{type:"unconfirmed"}:{type:"error"}),a=(0,o.useCallback)((async()=>{if(!t)return void i({type:"error"});i({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const o=await Fe().callApi({eventName:"unsubscribeFromEmails",environment:t,data:{payload:n}});return"success"===o.type?{type:"success",spaceName:o.data.spaceName}:{type:"error"}}({environment:n,payload:t});i("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),c=(0,V().IS)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(r.type){case"loading":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{defaultMessage:"Loading",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,u.jsxs)(Ge,{children:[(0,u.jsx)("div",{style:c.confirmUnsubscribeDescription,children:(0,u.jsx)(s().sA,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,u.jsx)(B().A,{size:"lg",onClick:a,analyticsName:"unsubscribe_confirm",children:(0,u.jsx)(s().sA,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,u.jsx)("b",{children:r.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,$e().HB)(r)}}var Je=()=>n(129978);const Ze=new(Je().O2)("desktopEmailConfirmPage",(()=>n.e(32568).then(n.bind(n,813998)))),Ye=(0,Je()._h)(Ze,(e=>e.default));var Xe=()=>n(54126),Qe=()=>n(360128),et=()=>n(876065);function tt(e){const{preventFrontRedirect:t}=e,n=(0,g().v3)(),{pathname:o,search:r,hash:i}=window.location;if(!t&&(0,et().D8)(n,o)){const e=r.length>0?`${r}&${Xe().Kr}=1`:`?${Xe().Kr}=1`;return window.location.href=o+e+i,null}return(0,u.jsx)(Qe().C6,{isSignup:!n.currentUser.isLoggedIn()})}var nt=()=>n(34559);const ot=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,g().v3)().currentUser.isLoggedIn()?(0,u.jsx)("div",{style:t,children:(0,u.jsx)(n(46550).A,{style:{width:"100%",height:"100%"},legacySpinnerSize:nt().Kh,showSpinnerTimeout:500})}):null};var rt=()=>n(635934);const it=function(e){let{redirect:t,callbackType:n}=e;const r=(0,V().DP)(),i=(0,g().v3)();return(0,o.useEffect)((()=>{at({redirect:t,environment:i,callbackType:n})}),[i,t,n]),(0,u.jsxs)(Ge,{children:[(0,u.jsx)("div",{style:{color:r.text.primary},children:"nativemailredirect"===n?(0,u.jsx)(s().sA,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail app"}):"nativecalendarredirect"===n?(0,u.jsx)(s().sA,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar app"}):(0,u.jsx)(s().sA,{defaultMessage:"Redirecting to your Notion app",id:"webApp.redirectingToDesktop.message"})}),(0,u.jsx)(Ve().A,{onClick:()=>at({redirect:t,environment:i,callbackType:n}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:r.text.tertiary},children:(0,u.jsx)(s().sA,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,u.jsx)(Ve().A,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:U().Ay.uiGray},children:(0,u.jsx)(s().sA,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function at(e){let{redirect:t,environment:n,callbackType:o}=e;M().eG({url:t,environment:n,callbackType:o})}var st=()=>n(185639),ct=()=>n(110975);function lt(){const e=(0,g().v3)();return(0,E().l)((()=>{const t=Le().kb({schemeUrl:window.location.href,baseUrl:b().A.domainBaseUrl});ct().f({environment:e,url:t}),st().Aj(),M().oo({environment:e,url:Te().JZ.root,redirect:!0})})),null}var dt=()=>n(463344),ut=()=>n(520969),pt=()=>n(382640),mt=()=>n(485966);function ft(e){let{children:t}=e;const n=(0,g().v3)(),o=(0,V().DP)(),r=(0,F().K8)((()=>{var e;const{mainEditorCurrentBlockStore:t}=mt().default.state,r=(0,ut().lU)(t),i=n.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=ve().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)?"rgba(0, 0, 0, 0)":r?(0,pt().Lu)({theme:o,isPhone:i}):o.contentBackground}}),[n,o]);return(0,u.jsx)(dt().A,{style:r,children:t})}var gt=()=>n(780450),vt=()=>n(313432);function ht(){const e=(0,g().v3)(),t=(0,F().K8)((()=>x().Qr(e)),[e]),n=(0,F().K8)((()=>x().X4(e).shouldShowError),[e]),o=(0,F().O$)(mt().default),r=x().tR(e);return(0,u.jsxs)(ft,{children:[t&&!n&&r&&(0,u.jsx)(vt().Z,{parentStore:t,quickSearchMode:!0}),"rendered"===o.renderPhase&&(0,u.jsx)(gt().S,{})]})}const bt=new(Je().O2)("CreatorProfile",(()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(42838),n.e(27634),n.e(74728),n.e(78205),n.e(49353),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(19361),n.e(63327),n.e(26090),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(65554),n.e(66885),n.e(67183),n.e(11721),n.e(88372),n.e(40200)]).then(n.bind(n,84775)))),St=(0,Je()._h)(bt,(e=>e.CreatorProfile)),yt={CreatorProgram:new(Je().O2)("CreatorProgram",(()=>Promise.all([n.e(34709),n.e(58251)]).then(n.bind(n,19536))))},wt=(0,Je()._h)(yt.CreatorProgram,(e=>e.CreatorProgram));var At=()=>n(465594);const It=new(Je().O2)("Onboarding",(async()=>Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(55373),n.e(44711),n.e(53321),n.e(58550),n.e(22900),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(67435),n.e(72832),n.e(89693),n.e(87598),n.e(25368),n.e(28773),n.e(45016)]).then(n.bind(n,108753)))),kt=(0,Je()._h)(It,(e=>e.Onboarding)),xt=new(Je().O2)("settingsConsole",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(58550),n.e(16471),n.e(90825),n.e(49889),n.e(97727),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(41870),n.e(74562),n.e(18895),n.e(78708),n.e(4422),n.e(28866),n.e(48632),n.e(59794),n.e(84778),n.e(11341),n.e(26090),n.e(76007),n.e(65554),n.e(21194),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(38546),n.e(67183),n.e(45354),n.e(82720),n.e(19596)]).then(n.bind(n,644510)))),Ct=(0,Je()._h)(xt,(e=>e.OrganizationSettingsConsole));var Tt=()=>n(61962);const Et=new(Je().O2)("githubStudentPack",(()=>Promise.all([n.e(34709),n.e(54564)]).then(n.bind(n,765588)))),Pt=(0,Je()._h)(Et,(e=>e.default)),_t=new(Je().O2)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(96159),n.e(96346),n.e(58550),n.e(37353),n.e(74728),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(28271),n.e(21864),n.e(27991),n.e(72597),n.e(11721),n.e(77177),n.e(79239)]).then(n.bind(n,355719));return{LocalizedTemplates:e}})),Ut=(0,Je()._h)(_t,(e=>e.LocalizedTemplates)),Lt={AddAnotherAccountLoginPage:new(Je().O2)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(44711),n.e(35837),n.e(23063),n.e(25049),n.e(30873),n.e(20488)]).then(n.bind(n,602029))))},Mt=(0,Je()._h)(Lt.AddAnotherAccountLoginPage,(e=>e.default));var jt=()=>n(760813),Rt=()=>n(936997);const Bt=new(Je().O2)("StartupsApplication",(async()=>Promise.all([n.e(34709),n.e(47057)]).then(n.bind(n,231143)))),Nt=(0,Je()._h)(Bt,(e=>e.default)),Dt={LennyApplication:new(Je().O2)("LennyApplication",(()=>Promise.all([n.e(34709),n.e(86279)]).then(n.bind(n,90527))))},Ot=(0,Je()._h)(Dt.LennyApplication,(e=>e.LennyApplication));var qt=()=>n(413871);const zt=new(Je().O2)("StudentGroupSignup",(async()=>Promise.all([n.e(34709),n.e(84969)]).then(n.bind(n,890788)))),Wt=(0,Je()._h)(zt,(e=>e.default));var Kt=()=>n(465235),$t=()=>n(884373),Ft=()=>n(35462),Vt=()=>n(424339);const Gt=function(e){const{teamStore:t}=e,n=(0,g().v3)(),{teamName:o}=(0,F().K8)((()=>({teamName:t.getName()})),[t]),r=(0,V().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:G().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18,padding:12},divider:{maxWidth:280},rightButton:{fontWeight:G().Wy.semibold,marginLeft:10}})),[]);return(0,u.jsxs)("div",{style:r.container,children:[(0,u.jsx)(Vt().x,{store:t,disabled:!0,size:55}),(0,u.jsx)("div",{style:r.title,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:o}})}),(0,u.jsx)("div",{style:r.subtitle,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,u.jsxs)("div",{style:r.buttonContainer,children:[(0,u.jsx)(B().A,{size:"lg",onClick:async()=>{const e=n.currentUser.id;if(!e)return;const o={type:"member",entity_type:"user",user_id:e};await Kt().e2({environment:n,userId:e,teamStore:t,user:o}),je().pi(n,{store:t,selection:"yes"})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,u.jsx)(R().A,{size:"lg",style:r.rightButton,onClick:async()=>{je().pi(n,{store:t,selection:"no"}),await Kt().YT({environment:n})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,u.jsx)($t().A,{size:48,innerStyle:r.divider}),(0,u.jsx)(Ft().A,{isSmall:!0,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};function Ht(e){const{teamStore:t,teamName:n,onRequestClick:o}=e,r=(0,g().v3)(),i=(0,V().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:G().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:G().Wy.semibold,marginLeft:10}})),[]);return(0,u.jsxs)("div",{style:i.container,children:[(0,u.jsx)(Vt().x,{store:t,disabled:!0,size:55}),(0,u.jsx)("div",{style:i.title,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??Jt()}})}),(0,u.jsx)("div",{style:i.subtitle,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,u.jsxs)("div",{style:i.buttonContainer,children:[(0,u.jsx)(B().A,{size:"lg",onClick:o,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,u.jsx)(R().A,{size:"lg",style:i.rightButton,onClick:async()=>{await Kt().YT({environment:r})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,u.jsx)($t().A,{size:48,innerStyle:i.divider}),(0,u.jsx)(Ft().A,{isSmall:!0,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function Jt(){return(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const Zt=function(e){const{teamStore:t}=e,[r,i]=(0,o.useState)(!1),{teamName:a}=(0,F().K8)((()=>({teamName:t.getName()})),[t]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Ht,{teamStore:t,teamName:a,onRequestClick:()=>i(!0)}),(0,u.jsx)(n(36178).A,{teamStore:t,teamName:a??Jt(),teamId:t.id,isModalOpen:r,onDismiss:()=>i(!1)})]})};function Yt(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,u.jsx)(Gt,{teamStore:n});case"closed":case"private":return(0,u.jsx)(Zt,{teamStore:n})}}const Xt=function(e){const{teamId:t}=e,r=(0,g().v3)(),i=(0,F().K8)((()=>new(qt().h4)(r,{table:Ee().yK,id:t})),[r,t]),[{value:a}]=(0,n(162901).Yb)((async()=>await Kt().D2({environment:r,teamId:t})),[r,t]);(0,o.useEffect)((()=>{!0===(null==a?void 0:a.isValidTeamRequest)&&null!=a&&a.isTeamMember&&(async()=>{var e;const t=null===(e=r.currentUser)||void 0===e?void 0:e.id;t&&i&&await Kt().g({environment:r,userId:t,teamStore:i})})()}),[r,i,a]);const s=(0,V().IS)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return a?(0,u.jsx)("div",{style:s.container,children:a.isValidTeamRequest?(0,u.jsx)(Yt,{teamStore:i,teamAccessLevel:a.teamAccessLevel}):"nonSpaceMember"===a.invalidRequestReason?(0,u.jsx)(Tt().o,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,u.jsx)(Tt().o,{route:{name:"notFound"},publicPageData:void 0})}):null};var Qt=()=>n(594878),en=()=>n(193302);const tn={chatSidebar:new(Je().O2)("chatSidebar",(()=>Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(36209),n.e(88552),n.e(1647),n.e(2703)]).then(n.bind(n,133989)))),chatSidebarActions:new(Je().O2)("chatSidebarActions",(async()=>await Promise.resolve().then(n.bind(n,895085)))),chatSidebarHelpers:new(Je().O2)("chatSidebarHelpers",(async()=>await Promise.resolve().then(n.bind(n,321185))))},nn=(0,Je()._h)(tn.chatSidebar,(e=>e.ChatSidebar));var on=()=>n(871949);function rn(e){return(0,u.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const an=function(){const e=(0,g().v3)(),{currentUser:t}=e,n=(0,F().K8)((()=>t.isLoggedIn()),[t]),r=(0,F().K8)((()=>mt().default.state.inAppCalloutStore),[]),i=(0,F().K8)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,o.useEffect)((()=>{n&&(r.getCalloutVisibility("customer_io").canShow?i?on().A.state.suppressReason===on().e.IN_APP_CALLOUT_CONFLICT?on().A.setState({...on().A.state,isVisible:!0,suppressReason:void 0}):on().A.setState({...on().A.state,suppressReason:void 0}):on().A.setState({isVisible:!1,suppressReason:on().e.DARK_MODE}):on().A.setState({isVisible:!1,suppressReason:on().e.IN_APP_CALLOUT_CONFLICT}))}),[r,n,i]);const a=(0,F().K8)((()=>on().A.state.isVisible&&r.getCalloutVisibility("customer_io").canShow),[r]);return(0,o.useEffect)((()=>{if(a)return r.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{r.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[r,a]),n?rn(!!a):null};var sn=()=>n(595945),cn=()=>n(822493);const ln=(0,s().YK)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function dn(e){return(0,u.jsx)("div",{style:{background:U().Ay.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function un(){const e=(0,g().v3)(),t=sn().U();return(0,F().K8)((()=>{const{currentUserSettingsStore:e}=mt().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,u.jsx)(cn().k,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,u.jsx)(s().sA,{...ln.pressSlashHeader,values:{slashkey:(0,u.jsx)(dn,{char:"/"})}}),content:null,onCloseClick:()=>sn().P(e)})}const pn=new(Je().O2)("InPageFind",(async()=>Promise.all([n.e(75134),n.e(28958)]).then(n.bind(n,748095)))),mn=(0,Je()._h)(pn,(e=>e.InPageFind));const fn=new(Je().O2)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(28271),n.e(27761)]).then(n.bind(n,472256)))),gn=(0,Je()._h)(fn,(e=>e.ForkPageModalWrapper)),vn=new(Je().O2)("SecondarySidebar",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(19361),n.e(63327),n.e(26090),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(65554),n.e(66885),n.e(44760),n.e(36141),n.e(19632),n.e(95281)]).then(n.bind(n,283579)))),hn=(0,Je()._h)(vn,(e=>e.SecondarySidebar)),bn=new(Je().O2)("SpaceSettings",(async()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,289610)))),Sn=(0,Je()._h)(bn,(e=>e.SpaceSettings));var yn=()=>n(8519),wn=()=>n(172496),An=()=>n(352723);const In=new(Je().O2)("Marketplace",(async()=>{const{default:e}=await Promise.all([n.e(96159),n.e(96346),n.e(58550),n.e(37353),n.e(74728),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(28271),n.e(21864),n.e(27991),n.e(72597),n.e(11721),n.e(77177),n.e(79239)]).then(n.bind(n,99271));return{Marketplace:e}})),kn=(0,Je()._h)(In,(e=>e.Marketplace));var xn=()=>n(667801),Cn=()=>n(48913),Tn=()=>n(840024),En=(n(610931),()=>n(486826)),Pn=()=>n(996094);async function _n(e,t){const n=await Fe().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Un(e){const{environment:t,spaceId:n,advanceTestClockArgument:o}=e;if(o)return"number"==typeof o?o:"function"==typeof o?await async function(e){const{environment:t,spaceId:n,callback:o}=e,r=await _n(n,t);if(r)return o(r)}({environment:t,spaceId:n,callback:o}):"object"==typeof o?await async function(e){const{environment:t,spaceId:n,durationLike:o}=e,r=await _n(n,t);if(!r)return;const i=En().c9.fromSeconds(r),a=En().dw.fromDurationLike(o);return i.plus(a).toSeconds()}({environment:t,spaceId:n,durationLike:o}):void 0}var Ln=()=>n(496985);const Mn=new(Je().O2)("PageLayoutEditor",(async()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,433330)))),jn=(0,Je()._h)(Mn,(e=>e.PageLayoutEditor)),Rn=new(Je().O2)("SiteSettingsLayoutEditor",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(19361),n.e(63327),n.e(26090),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(65554),n.e(66885),n.e(21194),n.e(62922),n.e(46204)]).then(n.bind(n,190606)))),Bn=(0,Je()._h)(Rn,(e=>e.SiteSettingsLayoutEditor));var Nn=()=>n(521972);const Dn={presentationMode:new(Je().O2)("PresentationMode",(async()=>await Promise.all([n.e(44711),n.e(53321),n.e(81330)]).then(n.bind(n,708723))))},On=(0,Je()._h)(Dn.presentationMode,(e=>e.PresentationMode));function qn(e){const{mainEditorCurrentBlockStore:t,currentCollectionViewStore:n}=(0,F().O$)(mt().default),o=(0,F().K8)((()=>{const o=e.routerState,r=o.route;if("team"===r.name)return{store:void 0,collectionViewStore:void 0,routerState:o};if("posts"===r.name)return{store:void 0,collectionViewStore:void 0,routerState:o};return t?{store:t,collectionViewStore:n,routerState:o}:void 0}),[n,t,e.routerState]),r=(0,F().K8)((()=>zn.getState()),[]),i=(0,F().K8)((()=>Wn.getState()),[]),a=(0,F().K8)((()=>Kn.getState()),[]);return r?(0,u.jsx)(jn,{}):a?(0,u.jsx)(On,{}):o?i?(0,u.jsx)(Bn,{}):(0,u.jsx)(nt().Ay,{...o}):null}const zn=new(Ln().default)((()=>{const e=Nn().g.getState();return e.isOpen&&"layout-editor"===e.mode}),{debugName:"isPageLayoutEditorOpenStore"}),Wn=new(Ln().default)((()=>{const e=Nn().g.getState();return e.isOpen&&"site-settings-editor"===e.mode}),{debugName:"isSiteSettingsLayoutEditorOpenStore"}),Kn=new(Ln().default)((()=>{const e=Nn().g.getState();return e.isOpen&&"presentation"===e.mode}),{debugName:"isPresentationModeOpenStore"}),$n={FullPageAIChatLoader:new(Je().O2)("FullPageAIChatLoader",(()=>n.e(58596).then(n.bind(n,791601))))},Fn=(0,Je()._h)($n.FullPageAIChatLoader,(e=>e.FullPageAIChatLoader));var Vn=()=>n(502140),Gn=()=>n(578269),Hn=()=>n(392608),Jn=()=>n(504690),Zn=()=>n(277167),Yn=()=>n(633990),Xn=()=>n(11016),Qn=()=>n(819788),eo=()=>n(802955);function to(){const e=(0,g().v3)(),{isPhone:t,isTablet:n}=(0,g().Y0)(),o=(0,F().K8)((()=>(0,Cn().KB)(e)),[e]),r=(0,Qn().T)("supportsNativeHome"),i=(0,F().K8)((()=>(0,Jn().y)(e)),[e]);return t||n&&i?r?(0,u.jsx)(Gn().As,{}):(0,u.jsx)(Yn().Nd,{}):(0,u.jsx)(no,{isExpanded:o})}function no(e){let{isExpanded:t}=e;const n=(0,g().v3)(),r=n.device.isElectronMac,i=(0,F().K8)((()=>void 0!==x().rp(n).state),[n]),a=(0,F().K8)((()=>(0,Hn().w6)(n)),[n]),s=(0,F().K8)((()=>(0,Zn().j)(n)),[n]);!function(e){const{isLoaded:t,isOnPublicPage:n,isOnPublicShareLinkPage:r}=e,i=(0,o.useRef)();(0,o.useEffect)((()=>(i.current=setTimeout((()=>{const e={level:"error",from:"SidebarContentContainer",type:"sidebarLoadingTimeout",error:{message:`Sidebar took longer than ${oo/1e3} seconds to load.`},data:{miscDataToConvertToString:{isOnline:eo().A.state.online,hasCurrentSpaceStore:Boolean(mt().default.state.currentSpaceStore),hasCurrentSpaceViewStore:Boolean(mt().default.state.currentSpaceViewStore),hasCurrentUserRootStore:Boolean(mt().default.state.currentUserRootStore),hasCurrentUserSettingsStore:Boolean(mt().default.state.currentUserSettingsStore),documentVisibilityState:document.visibilityState,isOnPublicPage:n,isOnPublicShareLinkPage:r}}};L().electronApi?L().logErrorForOffline(e):Vn().log(e),i.current=void 0}),oo),()=>{i.current&&(clearTimeout(i.current),i.current=void 0)})),[n,r]),(0,o.useEffect)((()=>{t&&i.current&&(clearTimeout(i.current),i.current=void 0)}),[t])}({isLoaded:i,isOnPublicPage:a,isOnPublicShareLinkPage:s});const c=(0,o.useCallback)((()=>(0,u.jsx)(Xn().A,{skipFadeinDelay:!0})),[]),{isTablet:l}=(0,g().Y0)();return(0,u.jsx)(Yn().YZ,{isElectronMac:r,isTablet:l,isExpanded:t,renderLoading:c,forceRenderLoading:!i&&!(a||s)})}const oo=9e4;const ro=(0,Je()._h)(new(Je().O2)("NotionBanners",(()=>Promise.all([n.e(64387),n.e(18724)]).then(n.bind(n,162383)))),(e=>e.default)),io=new(Je().O2)("NotionModals",(()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(44711),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(4422),n.e(28866),n.e(67435),n.e(48632),n.e(59794),n.e(72832),n.e(84778),n.e(11341),n.e(26090),n.e(12341),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(65554),n.e(66885),n.e(21194),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(98071),n.e(96453),n.e(8081),n.e(38546),n.e(67183),n.e(45354),n.e(82720),n.e(76074),n.e(67378),n.e(21864),n.e(52181),n.e(66406),n.e(5186)]).then(n.bind(n,270816)))),ao=(0,Je()._h)(io,(e=>e.default));const so=function(e){let{routerState:t}=e;const r=(0,g().v3)();(0,o.useEffect)((()=>{var e;if(null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return r.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&r.mobileNative.api.appComponentMountState(!1)}}),[r]);const{route:i}=t,a=(0,F().O$)(mt().AppStoreMainEditorCurrentBlockStore),s=(0,F().K8)((()=>n(695412).A.state.publicPageData),[]),{shouldShowSidebar:c,shouldShowFrame:l,shouldShowError:d,shouldRedirectFromHome:p}=(0,F().K8)((()=>x().X4(r)),[r]),m=(0,F().K8)((()=>"page"===i.name&&wn().A.state.open&&(0,An().K1)(wn().A.state.blockStore)),[i.name]),f=(0,n(373023).x9)(),{showAiChatModuleInHome:v}=(0,n(456143).w)(),h=(0,F().K8)((()=>{const{device:e}=r;return"chat"!==i.name&&("marketplace"!==i.name&&(!zn.state&&(!Wn.state&&(!Kn.state&&(!f&&((!v||null==a||!a.isType(n(762847).xd.personalHomePage))&&Tn().zD.shouldShowAssistantInCorner(e)))))))}),[r,i.name,f,a,v]),b=(0,F().K8)((()=>!r.device.isMobile&&!zn.state),[r.device.isMobile]),S=(0,F().K8)((()=>{if(!r.currentUser.isLoggedIn())return!1;if(r.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=mt().default.state;return!(!e||!t)&&(!(0,An().qb)(r,e)&&(!h&&(!zn.state&&(!Wn.state&&!Kn.state))))}),[r,h]),y=(0,F().K8)((()=>{const{device:e}=r;return!!e.isMobileNative&&("page"===i.name?Tn().zD.isXMLAssistantEnabled():void 0)}),[r,i.name]),w=(0,F().K8)((()=>c&&!(0,Cn().tv)(r)&&n(440588).sidebarOpenStore.state),[r,c]),A=(0,F().K8)((()=>(0,n(95049).t)(r)),[r]),I=(0,F().K8)((()=>(0,n(88442).ZE)(void 0)),[]),k=(0,F().K8)((()=>mt().default.state.renderPhase),[]),C=(0,n(639659).a)(),T=(0,n(48768).V)();return function(){const e=["local","staging","development"].includes("production"),t=(0,g().v3)();(0,o.useEffect)((()=>{e&&((0,Pn().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=mt().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await _n(n,t);if(e){const t=En().c9.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Pn().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const o=null===(n=mt().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o)return;const r=await Un({environment:t,spaceId:o,advanceTestClockArgument:e});r&&await Fe().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:o,epochSeconds:r}})})))}),[e,t])}(),(0,u.jsxs)(ft,{children:[c&&(0,u.jsx)(to,{}),l&&(a||C||"team"===i.name||"posts"===i.name)&&(0,u.jsx)(qn,{routerState:t}),!C&&"chat"===i.name&&(0,u.jsx)(Fn,{route:i}),"marketplace"===i.name&&(0,u.jsx)(kn,{}),!T&&c&&(0,u.jsx)(hn,{}),!T&&(0,u.jsx)(nn,{}),m&&(0,u.jsx)(gn,{}),(d||p)&&!m&&(0,u.jsx)(Tt().o,{route:t.route,publicPageData:s,shouldRedirectFromHome:p}),w&&(0,u.jsx)(lo,{}),(0,u.jsx)(an,{}),S&&(0,u.jsx)(n(642910).A,{}),!T&&h&&(0,u.jsx)(en().LazyAssistantMenuPopup,{}),!T&&r.device.isMobile&&(0,u.jsx)(yn().IM,{}),!T&&y&&(0,u.jsx)(en().LazyMobileAssistantPendingOperationsCollapsedElement,{}),!T&&h&&(0,u.jsx)(en().LazyAssistantOriginElement,{}),!T&&(0,u.jsx)(mn,{}),!T&&I&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Qt().eE,{}),(0,u.jsx)(Qt().ZT,{})]}),A&&(0,u.jsx)(un,{}),!r.device.isMobile&&"nativeTab"!==t.route.name&&(0,u.jsx)(n(591723).t,{}),"rendered"!==k||r.device.isMobile?null:(0,u.jsx)(n(126635).RK,{}),!T&&b&&a&&(0,u.jsx)(n(773498).Sx,{currentBlockStore:a,isElectronMac:r.device.isElectronMac}),!T&&(0,u.jsx)(yn().i6,{}),!T&&(0,u.jsx)(ro,{}),!T&&(0,u.jsx)(ao,{}),!1,(0,u.jsx)(uo,{})]})};function co(){xn().close()}function lo(){const e=(0,g().v3)(),t=(0,F().K8)((()=>function(e){return{position:"absolute",top:0,left:(0,Cn().r6)(e),right:0,bottom:0,zIndex:2}}(e)),[e]);return(0,u.jsx)("div",{style:t,onClick:co})}function uo(){const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=(0,F().K8)((()=>{const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=mt().default.state;return{currentSpaceStore:e,currentUserStore:t,renderPhase:n}}),[]);return e&&t&&"rendered"===n?(0,u.jsx)(Sn,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function po(){const e=(0,g().v3)();(0,o.useEffect)((()=>{!b().A.isAdminMode&&e.currentUser.isLoggedIn()&&mt().default.waitUntil((()=>{const t=mt().default.state.currentUserSettingsStore,n=(null==t?void 0:t.isDefined())??!1;if(t&&n){const n=t.getSettings(),o=null==n?void 0:n.disable_auto_set_timezone;n&&!o&&qe().xw({environment:e,userSettingsStore:t})}return n}))}),[e]),(0,o.useEffect)((()=>{function t(){const{RouterStore:t,currentUser:n}=e,o=n.id;Ne().zd({historyId:t.state.id,currentUserId:o}),L().navigationReady(!1)}return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)}),[e]),(0,o.useEffect)((()=>{async function t(t){const{RouterStore:n}=e,o=window.location.href,r=t.state?t.state.currentUserId:void 0;let i=e;(0,jt().w8)({environment:e}),r&&r!==e.currentUser.id&&(i=await ze().T({environment:i,newCurrentUserId:r}));const a=n.state.route,s=Ce().parseRoute({url:o,isMobile:i.device.isMobile,baseUrl:b().A.domainBaseUrl,publicDomainName:b().A.publicDomainName,protocol:b().A.protocol,currentUrl:window.location.href}),c="page"===a.name&&"page"===s.name&&a.blockId===s.blockId,l="onboarding"!==a.name&&"onboarding"===s.name;Ne().zd({historyId:n.state.id,currentUserId:r}),await Oe().Yw({environment:i,id:t.state&&t.state.id||(0,Ue().Ay)(),action:"pop",href:o}),l&&!e.device.isMobileNative&&M().oo({environment:i,url:Te().JZ.root}),c&&M().qf(i)}return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}),[e]),(0,E().l)((()=>{L().subscribeToProtocolUrl((t=>function(e,t){go("string"==typeof e?e:e.url,!1,!1,t)}(t,e))),L().subscribeToSettingsMenuItem(fo),L().navigationReady(!0),L().onNewWindow(((t,n)=>{M().oo({environment:e,url:n,openInNew:"tab"})}))})),(0,o.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((t,n,o)=>go(t,n,o,e)))}),[e]);const t=(0,F().O$)(e.RouterStore);(0,o.useEffect)((()=>{var e;"root"===t.route.name||"page"===t.route.name||"space"===t.route.name||"posts"===t.route.name||"blank"===t.route.name&&0===(null===(e=t.historyState)||void 0===e?void 0:e.index)||(Re().setInitialRenderCompleted(),mt().default.setState({...mt().default.state,renderPhase:"rendered"}))}),[t]),(0,o.useEffect)((()=>{e.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||Ie().u4({device:e.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:e.cookieService})}),[e.cookieService,e.currentUser,e.device,t.route.name]),(0,o.useEffect)((()=>{const t=mt().default.state.currentUserSettingsStore;e.currentUser.isLoggedIn()&&t&&We().Sz(e,t)}),[e]);const{device:r}=e;if(r.isNative&&Ce().L7[t.route.name])return(0,u.jsx)(lt,{});if("front"===t.route.name)return(0,u.jsx)(tt,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,u.jsx)(ot,{route:t.route});if("nativeRedirect"===t.route.name||"nativeMailRedirect"===t.route.name||"nativeCalendarRedirect"===t.route.name)return(0,u.jsx)(it,{redirect:t.route.redirect,callbackType:"nativeMailRedirect"===t.route.name?"nativemailredirect":"nativeCalendarRedirect"===t.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Rt().AuthSyncListener,{}),(0,u.jsx)(Qe().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL})]});if("login/calendar"===t.route.name||"login/mail"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Rt().AuthSyncListener,{}),(0,u.jsx)(Qe().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)})]});if("addAnotherAccount"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Rt().AuthSyncListener,{}),(0,u.jsx)(Mt,{redirectURL:t.route.redirectURL})]});if("desktopEmailConfirm"===t.route.name)return(0,u.jsx)(Ye,{});if("teamsInvite"===t.route.name){const{teamId:n}=t.route;return je().WO(e,{teamId:n}),(0,u.jsx)(rt().A,{fetch:async()=>{const t=new(qt().h4)(e,{table:Ee().yK,id:n});await t.load()},render:()=>(0,u.jsx)(Xt,{teamId:n})})}if("signup"===t.route.name)return(0,u.jsx)(Qe().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer});if("signup/calendar"===t.route.name||"signup/mail"===t.route.name)return(0,u.jsx)(Qe().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)});if("unsubscribe"===t.route.name)return(0,u.jsx)(He,{payload:t.route.payload});if("make"===t.route.name)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(55373),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(8184),n.e(28387)]).then(n.bind(n,82397)),render:e=>{let{PublicAIBuilder:t}=e;return(0,u.jsx)(t,{})}});if("onboarding"===t.route.name)return(0,u.jsx)(kt,{});if("upcomingInvoice"===t.route.name)return(0,u.jsx)(At().Y,{route:t.route});if("invoiceById"===t.route.name)return(0,u.jsx)(At().Y,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(e.currentUser.isLoggedIn())return(0,u.jsx)(Ct,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=(0,_e().re)({organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,queryParams:t.route.params}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(mo,{url:n})}}if(t.route.name,t.route.name,"admin"===t.route.name&&b().A.isAdminMode)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(30370),n.e(72008),n.e(19884)]).then(n.bind(n,914019)),render:e=>{let{Admin:t}=e;return(0,u.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(b().A.isAdminMode)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(30370),n.e(72008),n.e(19884)]).then(n.bind(n,70848)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&b().A.isAdminMode){const{id:e,table:o}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(30370),n.e(72008),n.e(18303)]).then(n.bind(n,971538)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{table:o,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(75134),n.e(58550),n.e(41870),n.e(4422),n.e(11341),n.e(76007),n.e(67378),n.e(75104),n.e(9647)]).then(n.bind(n,964322)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c})}})}if("passkeyAuthVerify"===t.route.name){const{callbackType:e}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(25049),n.e(66805)]).then(n.bind(n,956728)),render:t=>{let{VerifyPasskeyRedirectPage:n}=t;return(0,u.jsx)(n,{callbackType:e})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(58777).then(n.bind(n,691920)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a})}})}if("globalOauthPostLogin"===t.route.name){const{clientId:e,redirectUri:o,state:r,responseType:i,scope:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(75134),n.e(75104),n.e(56353)]).then(n.bind(n,382554)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{clientId:e,redirectUri:o,csrfState:r,responseType:i,scope:a})}})}if("passkeyRegistrationVerification"===t.route.name){const{callbackType:o,csrfToken:r,attemptId:i,options:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(67045).then(n.bind(n,543942)),render:t=>{let{AddPasskeyRedirectPage:n}=t;return(0,u.jsx)(n,{environment:e,callbackType:o,csrfToken:r,attemptId:i,options:a})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(18071).then(n.bind(n,36850)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:o}=t.route;if(e.currentUser.isLoggedIn())return(0,u.jsx)(rt().A,{fetch:()=>n.e(58657).then(n.bind(n,975446)),render:e=>{let{default:t}=e;return(0,u.jsx)(t,{redirectUri:o})}});{const e=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:o}}),t=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return Pe().TR(),(0,u.jsx)(mo,{url:t})}}if("myIntegrations"===t.route.name)return(0,u.jsx)(mo,{url:Te().JZ.creatorProfileIntegrations});if("inAppTemplateSubmission"===t.route.name)return(0,u.jsx)(mo,{url:Te().JZ.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===t.route.name)return(0,u.jsx)(mo,{url:Te().JZ.creatorProfile});if("creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name||"creatorProfileIntegrations"===t.route.name||"creatorProfileAnalytics"===t.route.name||"creatorProfileCoupons"===t.route.name){if(e.currentUser.isLoggedIn())return"pointer"in t.route?(0,u.jsx)(St,{publish:Boolean(t.route.publish),lab:Boolean(t.route.lab),botOrIntegrationPointer:t.route.pointer}):(0,u.jsx)(St,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=Me().Gm({url:`${Te().JZ[t.route.name]}`}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(mo,{url:n})}}if("localizedTemplates"===t.route.name){if(e.currentUser.isLoggedIn())return(0,u.jsx)(Ut,{});{const e=Me().Gm({url:`${Te().JZ[t.route.name]}`}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(mo,{url:n})}}if("studentGroupSignup"===t.route.name)return(0,u.jsx)(Wt,{});if("startupsApplication"===t.route.name)return(0,u.jsx)(Nt,{formType:"startups"});if("smbsApplication"===t.route.name)return(0,u.jsx)(Nt,{formType:"smb"});if("lennyApplication"===t.route.name)return(0,u.jsx)(Ot,{});if("creatorProgramApplication"===t.route.name)return(0,u.jsx)(wt,{});if("githubStudentPackHome"===t.route.name)return(0,u.jsx)(Pt,{});if("notFound"===t.route.name)return(0,u.jsx)(Tt().o,{route:t.route,publicPageData:void 0});if("modal"===t.route.name&&!e.currentUser.isLoggedIn()&&(t.route.templateGalleryItem||t.route.projectManagementLaunch)){const e={};return t.route.projectManagementLaunch?e.tg="gallery":t.route.templateGalleryItem&&(e.tg=t.route.templateGalleryItem),(0,u.jsx)(mo,{url:Te().JZ.login,queryParams:e})}if("chat"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,ke().X_)(t.route),n=(0,Me().Gm)({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(mo,{url:n})}if("marketplace"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,xe().YD)(b().A,t.route),n=(0,Me().Gm)({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(mo,{url:n})}return"quickSearch"===t.route.name?(0,u.jsx)(ht,{}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"modal"===t.route.name||"chat"===t.route.name||"marketplace"===t.route.name||"team"===t.route.name||"posts"===t.route.name||"blank"===t.route.name?(0,u.jsx)(so,{routerState:t}):(0,u.jsx)(Ke().A,{})}function mo(e){let{url:t,queryParams:n}=e;const r=(0,g().v3)(),i=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{i.current||(i.current=!0,n&&De().I({currentUserId:void 0,params:n}),M().oo({environment:r,url:t,redirect:!0}))}),[r,n,t]),(0,u.jsx)(Ke().A,{})}function fo(e){Be().Ow({currentTab:e})}function go(e,t,n,o){const{RouterStore:r}=o,i=Le().Q1({url:e,protocol:b().A.protocol,baseUrl:b().A.domainBaseUrl}),a=Le().kb({schemeUrl:i,baseUrl:b().A.domainBaseUrl}),s=Ce().parseRoute({url:a,baseUrl:b().A.domainBaseUrl,publicDomainName:b().A.publicDomainName,isMobile:o.device.isMobile,protocol:b().A.protocol,currentUrl:window.location.href});(o.device.isAndroid||t)&&Ne().TC({RouterStore:r,currentUserId:o.currentUser.id}),o.mobileNative&&o.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name&&"passkeyAuthCallback"!==s.name?M().oo({environment:o,url:a,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):M().oo({environment:o,url:a})}const vo=!1;function ho(e){let{environment:t,onMount:n}=e;const c=(0,o.useRef)(!1);(0,o.useEffect)((()=>{c.current||(c.current=!0,null==n||n())}),[n]),(0,o.useEffect)((()=>{x().jx()}),[]);const l=vo?o.StrictMode:o.Fragment;return(0,u.jsx)(l,{children:(0,u.jsx)(r().aw,{value:t,children:(0,u.jsx)(I().k,{children:(0,u.jsxs)(i().wX,{children:[(0,u.jsx)(s().Dk,{defaultLocale:"en-US",locale:a().locale,messages:a().D,children:(0,u.jsx)(p,{...m(t.device),children:(0,u.jsx)(k().K,{fallback:e=>(0,u.jsx)(z,{...e}),from:"Router",type:"AppCrash",children:(0,u.jsxs)(A,{id:"app",targetRenderPhase:"mount",children:[(0,u.jsx)(Ae().A,{}),(0,u.jsx)(we,{children:(0,u.jsx)(po,{})})]})})})}),(0,u.jsx)(T,{})]})})})})}},773498:(e,t,n)=>{n.d(t,{rU:()=>p,QB:()=>i,hR:()=>l,pT:()=>c,JN:()=>u,i8:()=>a,Wt:()=>d,Sx:()=>s});var o=()=>n(129978);const r=new(o().O2)("notifications",(()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(49889),n.e(97727),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(60499),n.e(78917),n.e(36141),n.e(42601),n.e(41864),n.e(19632),n.e(6893)]).then(n.bind(n,855022)))),i=(0,o()._h)(r,(e=>e.GetNotifiedFor)),a=(0,o()._h)(r,(e=>e.TopbarUpdatesMenu)),s=(0,o()._h)(r,(e=>e.UpdateSidebar)),c=(0,o()._h)(r,(e=>e.MobileInboxPopup)),l=(0,o()._h)(r,(e=>e.InboxActionsMenu)),d=((0,o()._h)(r,(e=>e.InboxNotificationSettingsButton)),(0,o()._h)(r,(e=>e.UnreadMentionsBadge))),u=(0,o()._h)(r,(e=>e.NotificationInboxPanelContent)),p=(0,o()._h)(r,(e=>e.AnimatedEmojiBadge))},780450:(e,t,n)=>{n.d(t,{S:()=>i});var o=()=>n(129978);const r=new(o().O2)("AppComponents",(async()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,591925)))),i=(0,o()._h)(r,(e=>e.AppComponents))},795442:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>s});var o=()=>n(502140),r=()=>n(927685),i=()=>n(836331),a=()=>n(234231);function s(e){"object"==typeof r().A&&r().A.version&&(o().clientLogglyEnvironmentData.version=r().A.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(o().clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(o().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(o().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(o().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(o().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(o().clientLogglyEnvironmentData.isChromeExtension=!0),o().clientLogglyEnvironmentData.os=t.os,o().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(o().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(o().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(o().clientLogglyEnvironmentData.userId=n.id),o().clientLogglyEnvironmentData.is_experimental_build="clientExperimental"===r().A.buildTarget,o().clientLogglyEnvironmentData.experiments=i().default.getUsedNonControlExperimentsMap(),i().default.addListener((()=>{o().clientLogglyEnvironmentData.experiments=i().default.getUsedNonControlExperimentsMap()})),(0,a().xs)().then((e=>{e&&(o().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,o().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},807913:(e,t,n)=>{n.d(t,{c:()=>i,y:()=>r});var o=()=>n(962373);const r=new(o().A),i=new(o().A)},842617:(e,t,n)=>{n.d(t,{MG:()=>f,T1:()=>m,a1:()=>S,dt:()=>g,kg:()=>v,lC:()=>b,n_:()=>h});var o=n(242343),r=()=>n(237385),i=()=>n(803290),a=()=>n(162901),s=()=>n(129978),c=()=>n(514860),l=()=>n(271748),d=()=>n(440588),u=()=>n(370557),p=()=>n(89969);const m=new(s().O2)("PerformanceToolbar",(()=>Promise.all([n.e(96159),n.e(96346),n.e(16471),n.e(36209),n.e(92845),n.e(71718),n.e(17989),n.e(48632),n.e(90625),n.e(21194),n.e(5910),n.e(62427),n.e(45624)]).then(n.bind(n,524636)))),f=(0,s()._h)(m,(e=>e.PerformanceToolbar)),g=(0,s()._h)(m,(e=>e.PerformanceToolbarSettings));function v(){const e=(0,r().v3)();return(0,i().K8)((()=>(0,p().D)(e,e.RouterStore.state)),[e])}function h(){const e=(0,r().v3)(),t=y("PerformanceToolbarStore"),n=y("isPerformanceToolbarVisible");return(0,i().K8)((()=>!(!t||!n)&&n(e,e.RouterStore.state,t.state)),[n,e,t])}function b(){const e=y("PerformanceToolbarStore");return(0,i().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function S(){const e=(0,r().v3)(),t=y("createPerformanceToolbarMouseListeners"),n=y("PerformanceToolbarStore"),{sidebarExpanded:a,sidebarWidth:s,secondarySidebarExpanded:p,secondarySidebarWidth:m,updateSidebarExpanded:f,updateSidebarWidth:g}=(0,i().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:l().default.isOpen(),secondarySidebarWidth:c().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,o.useEffect)((()=>{if(n&&t)return t(e,(e=>n.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),a,s,p,m,f,g)}),[t,e,n,a,s,p,m,f,g])}function y(e){const t=v(),[{value:n}]=(0,a().Yb)((()=>t?m.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return n}},871949:(e,t,n)=>{n.d(t,{A:()=>i,e:()=>o});let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class r extends(()=>n(129044))().default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const i=new r},925701:(e,t,n)=>{n.d(t,{AC:()=>i,dE:()=>s,Nw:()=>c,tn:()=>a});var o=()=>n(137476);const r=new(n(380123).R)({key:"offline_autosync_setting",namespace:n(146325).cd,important:!0,trackingType:"necessary"});function i(){return"on"===r.getState()}function a(e){let{environment:t}=e;const n=i()?"off":"on";(0,o().u4)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),r.setState(n)}function s(){return r.getState()}function c(e){r.setState(e)}},936997:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>b});n(725707),n(491955);var o=n(242343),r=()=>n(237385),i=()=>n(803290);const a="initial_handshake";var s=()=>n(409211),c=()=>n(653998),l=()=>n(975392),d=()=>n(23371),u=()=>n(3311),p=()=>n(927685),m=()=>n(413871),f=()=>n(539581),g=()=>n(348965),v=n(163643);const h=1;function b(){const e=(0,r().v3)(),t=(0,c().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,y]=(0,o.useState)(null),[w,A]=(0,o.useState)({value:!1,count:0}),I=(0,i().K8)((()=>f().A.getTotalUnreadMentionsCount()),[]),k=(0,i().K8)((()=>g().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(y(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{b&&(w.value||0===w.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:I}))}),[b,w.count,w.value,S,I]);const x=(0,o.useCallback)((async()=>{const e=l().hS(k,"userId"),n=await(0,d().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const o=n.getEmail()??"",r=n.getDisplayName(t)??"";return{id:e.userId,displayName:r,emailAddress:o}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,k]);(0,o.useEffect)((()=>{b&&S&&(w.value||0===w.count)&&x()}),[b,x,w.count,w.value,S]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,S]),(0,o.useEffect)((()=>{b||(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[b,S]);const C=(0,o.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(y((e=>(e&&(e.onmessage=C),e))),()=>{y((e=>(e&&(e.onmessage=null),e)))})),[C,S]),(0,v.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(a,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},972522:(e,t,n)=>{n.d(t,{A:()=>s});n(242343);var o=()=>n(174114),r=()=>n(81322),i=()=>n(417653),a=n(163643);function s(e){const{top:t,right:n,onClick:s}=e,c=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:c.buttonBackground,children:(0,a.jsx)(i().A,{style:c.button,hoveredStyle:c.buttonHovered,onClick:s,children:(0,r().V)(c.icon)})})}},973440:(e,t,n)=>{n.d(t,{X:()=>o});const o=n(129044).default.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},992849:(e,t,n)=>{n.d(t,{p:()=>i});var o=()=>n(129978);const r=new(o().O2)("HelpButtonContent",(async()=>await n.e(42481).then(n.bind(n,718356)))),i=(0,o()._h)(r,(e=>e.HelpButtonContent))}}]);