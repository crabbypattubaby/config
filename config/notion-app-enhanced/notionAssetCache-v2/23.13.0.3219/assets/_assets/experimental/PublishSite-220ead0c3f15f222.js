"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[16345],{40504:(e,t,i)=>{i.d(t,{EL:()=>M,KD:()=>S,Ss:()=>v,l2:()=>w,n0:()=>x,rw:()=>A});i(610931),i(362833),i(725707),i(491955),i(242343);var s=()=>i(220574),a=()=>i(145017),l=()=>i(653998),n=()=>i(23371),o=()=>i(818369),d=()=>i(145046),r=()=>i(509484),c=()=>i(480415),u=()=>i(422340),h=()=>i(802955),p=()=>i(413871),b=()=>i(189823),m=()=>i(213094),g=()=>i(913001),f=i(163643);const y=50;function v(e){g().A.resetSitesForSpace(e.id)}async function A(e,t){const{spaceStore:i,currentUserId:l,limit:d}=t;if(!i.id)return;const[r]=await Promise.all([o().callApi({eventName:"getPublishedPagesForUser",environment:e,data:{spaceId:i.id,limit:d||y,fetchPublishedMetadata:!0}}),(0,n().wR)(1500)]);if("failed"===r.type)throw new Error("Failed to fetch published pages.");if(r.data.recordMap){const e=[],t=s().RecordMapWithRole.create(r.data.recordMap),n=r.data.publishedEdits;for(const{model:s}of t)if(s&&s.table===a().ev){const t=p().Bv.createChildStore(i,{table:a().ev,id:s.id}),l=n[t.id],o=l&&l.authors?l.authors[0]:void 0,d={publishedTime:null==l?void 0:l.timestamp,publishedBy:o};e.push({store:t,publishedMetadata:d})}let o=e;return l&&(o=m().X(e,l)),g().A.initializeSiteResultsForSpace(i.id,o),o}}async function S(e,t){const{spaceStore:i}=t,s=e.currentUser.id,a=await A(e,{spaceStore:i,currentUserId:s});return a?a.filter((e=>{var t;return(null===(t=e.publishedMetadata.publishedBy)||void 0===t?void 0:t.id)===s})):[]}function x(e){c().Tk(e),u().Ay.setState({...u().Ay.state,display:u().pP.Publish,tab:u().QC.Publish})}async function M(e){return new Promise(((t,i)=>{d().ui({message:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(l().sA,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(l().sA,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,f.jsx)(l().sA,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>t(!0)}],showCancel:!0})}))}async function w(e,t){if(!h().A.state.online)return[];const i=await r().T.searchActions.load();return await i.searchPublicPages({environment:t,query:e,source:"public_home_page_menu",limit:b().ZK})}},213094:(e,t,i)=>{i.d(t,{X:()=>l,c:()=>n});i(725707),i(500234);var s=()=>i(446588),a=()=>i(352723);function l(e,t){return e.sort(((e,i)=>{const s=e.store.canAdmin();if(s===i.store.canAdmin()){var a,l;const s=null===(a=e.publishedMetadata.publishedBy)||void 0===a?void 0:a.id,n=e.publishedMetadata.publishedTime,o=null===(l=i.publishedMetadata.publishedBy)||void 0===l?void 0:l.id,d=i.publishedMetadata.publishedTime;if(t){if(s===t&&o===t&&n&&d)return d-n;if(s===t)return-1;if(o===t)return 1}return n&&d?d-n:0}return s?-1:1}))}function n(e){const{environment:t,store:i}=e;if(!i.pathIsAccessibleAndAlive())return!1;if(!a().i0(i).find((e=>(0,s().W8)(e.permissionItem))))return!1;return!a().qb(t,i)}},301892:(e,t,i)=>{i.d(t,{y:()=>a});var s=()=>i(836331);function a(e){const{permissionItem:t,allowDuplicate:i}=e,{is_public_share_link:a}=t;return s().default.checkGate({gateName:"sharing_anyone_with_the_link"})&&a?{...t,is_site:!0,allow_duplicate:i}:{...t,role:"reader",is_site:!0,allow_duplicate:i}}},474536:(e,t,i)=>{i.d(t,{P:()=>d});var s=()=>i(803290),a=()=>i(76394),l=()=>i(378219),n=()=>i(533625),o=()=>i(485966);function d(e){let{store:t}=e;return(0,s().K8)((()=>{const e=(0,n().h)({blockId:t.id,setting:"publicAccess"});if((0,a().O9)(e))return e;const i=o().default.state.currentSpaceStore,s=(0,l().Uo)(t);return s?{disabled:Boolean(s.getDisablePublicAccess()),disabledBy:"team"}:!s&&null!=i&&i.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}),[t])}},883929:(e,t,i)=>{i.r(t),i.d(t,{default:()=>H,messages:()=>F});var s=i(242343),a=()=>i(237385),l=()=>i(803290),n=()=>i(174114),o=()=>i(680369),d=i(163643);const r=(0,o().wt)("disabledGlobe",{viewBox:"0 0 27 27",svg:(0,d.jsx)("path",{d:"M13.487.885c1.77 0 3.437.338 5.002 1.015a13.216 13.216 0 0 1 4.139 2.806 13.216 13.216 0 0 1 2.806 4.139c.677 1.557 1.015 3.22 1.015 4.989 0 1.329-.199 2.607-.597 3.834a12.81 12.81 0 0 1-1.663 3.377l-2.348-2.336 2.018-.965c.288-.61.504-1.244.648-1.904a9.39 9.39 0 0 0 .216-2.006c0-1.075-.148-2.103-.445-3.085a15.528 15.528 0 0 1-2.78 1.816c-.973.499-1.98.892-3.021 1.18.177.474.35.935.52 1.384.178.44.351.855.52 1.244l-3.732-3.732.673-.039c-.27-.99-.453-1.976-.546-2.957a16.834 16.834 0 0 1-.025-2.92c.084-.974.254-1.939.508-2.895l-.127-.025A17.942 17.942 0 0 0 14.73 7.13a19.65 19.65 0 0 0-.863 3.605l-1.308-1.32c.23-1.185.555-2.336.978-3.453A21.505 21.505 0 0 1 15.1 2.726a16.891 16.891 0 0 0-.28-.026 1.558 1.558 0 0 0-.279-.025 19.794 19.794 0 0 0-3.936 4.799L9.514 6.369c.389-.66.82-1.299 1.295-1.917.474-.618.986-1.214 1.536-1.79-.88.093-1.727.288-2.54.584-.812.288-1.57.669-2.272 1.143L6.276 3.132a12.772 12.772 0 0 1 3.377-1.65 12.355 12.355 0 0 1 3.834-.597ZM23.694 9.25a11.144 11.144 0 0 0-2.31-3.339 11.096 11.096 0 0 0-3.352-2.31 14.048 14.048 0 0 0-.596 2.856 15.699 15.699 0 0 0 0 2.958c.093.982.27 1.942.533 2.882 1.05-.28 2.056-.673 3.021-1.18a14.658 14.658 0 0 0 2.704-1.867ZM13.5 26.783c-1.769 0-3.436-.338-5.002-1.015a13.258 13.258 0 0 1-4.126-2.806 13.257 13.257 0 0 1-2.806-4.126 12.466 12.466 0 0 1-1.015-5.002c0-1.329.199-2.603.596-3.821a13.258 13.258 0 0 1 1.65-3.39L4.03 7.867c-.55.872-.981 1.811-1.295 2.818a10.814 10.814 0 0 0-.457 3.149c0 .127.005.254.013.38l.025.369a19.857 19.857 0 0 0 4.063 2.653c.008-1.05.093-2.082.254-3.097.16-1.016.393-2.006.698-2.971l1.244 1.231c-.228.83-.402 1.685-.52 2.565-.11.88-.161 1.862-.153 2.945 1.6.627 3.255 1.037 4.964 1.232a19.7 19.7 0 0 1-.342-1.486c-.094-.49-.161-.99-.204-1.498l1.816 1.803a4.261 4.261 0 0 0 .203.965c.127.017.254.03.38.038.136 0 .272-.004.407-.013l1.765 1.765a11.57 11.57 0 0 1-.927.063c-.305.009-.614.013-.927.013.254.643.538 1.278.85 1.904.322.618.674 1.22 1.054 1.803a9.848 9.848 0 0 0 2.514-1.219l1.27 1.257a12.927 12.927 0 0 1-3.403 1.65 12.237 12.237 0 0 1-3.821.597ZM7.089 23a23.751 23.751 0 0 1-.432-2.006c-.11-.66-.186-1.337-.228-2.031a18.156 18.156 0 0 1-1.905-.952 22.422 22.422 0 0 1-1.802-1.155 10.839 10.839 0 0 0 1.663 3.465A11.602 11.602 0 0 0 7.089 23Zm8.29 1.892a21.73 21.73 0 0 1-1.13-2.032 19.554 19.554 0 0 1-.889-2.133 20.538 20.538 0 0 1-5.332-1.142c.076.787.203 1.566.381 2.336.186.762.406 1.494.66 2.196a11.21 11.21 0 0 0 2.133.686c.745.169 1.51.254 2.298.254.322 0 .639-.013.952-.038.313-.026.622-.068.927-.127Zm9.077 1.294L1.147 2.891a.932.932 0 0 1-.279-.686c0-.28.093-.512.28-.698a.953.953 0 0 1 .698-.292c.279 0 .512.097.698.292L25.84 24.79a.96.96 0 0 1 .28.686c0 .27-.094.503-.28.698a.926.926 0 0 1-.698.292.871.871 0 0 1-.686-.28Z"})});var c=()=>i(350492),u=()=>i(446588),h=()=>i(496580),p=()=>i(653998),b=()=>i(31448),m=()=>i(110975),g=()=>i(421378),f=()=>i(356813),y=()=>i(286404),v=()=>i(951540),A=()=>i(103151),S=()=>i(35462),x=()=>i(392608),M=()=>i(838517),w=()=>i(474536),I=()=>i(880026),j=()=>i(301892),k=()=>i(40504),B=()=>i(907721),P=()=>i(485966),C=()=>i(935989),_=()=>i(760034),T=()=>i(702761);const F=(0,p().YK)({disabledByTeamspaceHeadline:{defaultMessage:"Publishing is disabled in this teamspace",id:"publishSite.disabledByTeamspace.headline"},disabledByWorkspaceHeadline:{defaultMessage:"Publishing is disabled in this workspace",id:"publishSite.disabledByWorkspace.headline"},pageInTrashHeadline:{defaultMessage:"Pages in the trash can’t be published",id:"publishSite.pageInTrash.headline"},hasAIEditsHeadline:{defaultMessage:"Pages with pending Notion AI changes can’t be published",id:"publishSite.hasAIEdits.headline"},noFullAccessHeadline:{defaultMessage:"You need full access to publish",id:"publishSite.noFullAccess.headline"}});function H(e){const{store:t,mostPermissivePublicItem:i,sudoModeStore:o,location:c}=e,{permissionItem:h,from:m}=i,f=(0,a().v3)(),A=(0,l().K8)((()=>t.getSpaceStore()),[t]),x=(0,s.useCallback)((()=>{A&&k().KD(f,{spaceStore:A}).then((e=>{(0,C().kW)(f,{target_block_id:t.id,user_current_live_sites_count:e.length})}))}),[f,t,A]),B=(0,l().K8)((()=>t.canAdmin()),[t]),F=(0,w().P)({store:t}),H=(0,M().i0)(t),D=(0,M().ty)(t),R=!B||F.disabled||H||D,U=(0,n().IS)((e=>({container:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:R?"center":"flex-start",paddingTop:R?6:12,paddingBottom:R?24:20,paddingLeft:20,paddingRight:20,gap:R?8:0,cursor:R?"not-allowed":"default",height:f.device.isMobile&&R?"100%":R?276:"auto"},titleContainer:{display:"flex",alignItems:"center",flexDirection:"column",gap:4},title:{fontWeight:b().Wy.semibold,fontSize:16,lineHeight:1.2,color:R?e.text.secondary:e.text.primary},caption:{display:"flex",alignItems:"center",marginLeft:26,marginRight:26,marginBottom:R?0:20,width:R?"85%":"auto",textAlign:"center"},button:{display:"flex",width:"100%",padding:16,borderRadius:6,zIndex:1},disabledIcon:{height:27,width:27,margin:5,fill:e.text.tertiary},overlay:{height:12,left:0,top:0,background:e.contentBackground,width:"100%",position:"absolute"},restoreFromTrashButton:{fontSize:12,fontWeight:b().Wy.medium,margin:"12px",padding:"0px 8px",height:28}})),[R,f.device.isMobile]),E=(0,s.useCallback)((()=>{var e;const i=!(null===(e=P().default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())&&h.allow_duplicate;_().d8({environment:f,type:"site",store:t});const s=(0,j().y)({permissionItem:h,allowDuplicate:i}),a=(0,u().Yi)(m);(0,I().Hc)({oldPermissionItem:h,newPermissionItem:s,wasInherited:a!==t.id,environment:f,store:t,sudoModeStore:o,location:c}),x()}),[x,f,t,h,m,o,c]),K=(0,s.useCallback)((()=>{const{currentSpaceStore:e}=P().default.state;e&&g().iN({environment:f,block:t,spaceId:t.pointer.spaceId||e.id,from:"disabled_publish_modal"})}),[t,f]),z=(0,p().tz)();return(0,d.jsxs)("div",{style:U.container,children:[R?r(U.disabledIcon):null,(0,d.jsxs)("div",{style:U.titleContainer,children:[R?(0,d.jsx)(W,{store:t,intl:z}):(0,d.jsx)("div",{style:U.title,children:(0,d.jsx)(p().sA,{id:"publishSite.publishTab.title",defaultMessage:"Publish to web"})}),(0,d.jsx)(S().A,{isMultiline:!0,isSecondaryColor:!0,style:U.caption,children:(0,d.jsx)(L,{store:t})}),R&&H&&(0,d.jsx)(y().A,{size:"lg",onClick:K,style:U.restoreFromTrashButton,children:"Restore"})]}),R?null:(0,d.jsx)(T().A,{store:t}),R?null:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(v().A,{style:U.button,disabled:R,onClick:E,children:(0,d.jsx)(p().sA,{id:"publishSite.publish.title",defaultMessage:"Publish"})}),f.device.isMobile&&(0,d.jsx)("div",{style:{position:"relative",width:"100%"},children:(0,d.jsx)("div",{style:U.overlay})})]})]})}function W(e){const{store:t,intl:i}=e,s=(0,n().IS)((()=>({disabledPublishingHeadline:{fontWeight:b().Wy.medium,textAlign:"center",width:"85%"}})),[]),a=e=>(0,d.jsx)("div",{style:s.disabledPublishingHeadline,children:(0,d.jsx)(S().A,{isSecondaryColor:!0,isMultiline:!0,children:e})}),o=(0,w().P)({store:t}),r=(0,M().i0)(t),c=(0,M().ty)(t),u=(0,l().K8)((()=>!t.canAdmin()),[t]);return(0,h().MX)(o.disabled||r||c||u,"Disabled headline not allowed for block's current state"),o.disabled&&"team"===o.disabledBy?a(i.formatMessage(F.disabledByTeamspaceHeadline)):o.disabled&&"space"===o.disabledBy?a(i.formatMessage(F.disabledByWorkspaceHeadline)):a(r?i.formatMessage(F.pageInTrashHeadline):c?i.formatMessage(F.hasAIEditsHeadline):i.formatMessage(F.noFullAccessHeadline))}function L(e){const{store:t}=e,i=(0,p().tz)(),s=(0,a().v3)(),r=(0,w().P)({store:t}),u=(0,M().i0)(t),h=(0,M().ty)(t),b=(0,l().K8)((()=>!t.canAdmin()),[t]),g=(0,n().IS)((e=>({helpIcon:{width:o().Ev.sm,height:o().Ev.sm,fill:e.icon.tertiary}})),[]);if(r.disabled&&"team"===r.disabledBy)return(0,d.jsx)(p().sA,{id:"publishSite.disabledByTeamspace.caption",defaultMessage:"Contact a teamspace owner to modify this setting"});if(r.disabled&&"space"===r.disabledBy)return(0,d.jsx)(p().sA,{id:"publishSite.disabledByWorkspace.caption",defaultMessage:"Contact a workspace owner to modify this setting"});if(u)return(0,d.jsx)(p().sA,{id:"publishSite.pageInTrash.caption",defaultMessage:"Restore this page to publish it to the web"});if(h)return(0,d.jsx)(p().sA,{id:"publishSite.hasAIEdits.caption",defaultMessage:"Accept or discard changes on this page to publish it to the web"});if(b)return(0,d.jsx)(p().sA,{id:"publishSite.noFullAccess.caption",defaultMessage:"Contact someone with full access to modify this setting"});const y=i.formatMessage({id:"publishSite.help.tooltip",defaultMessage:"Learn more about Notion sites"});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(p().sA,{id:"publishSite.hasFullAccess.caption",defaultMessage:"Create a website with Notion"}),(0,d.jsx)(A().A,{renderTooltip:()=>y,render:e=>(0,d.jsx)(f().A,{...e,style:{marginLeft:2,height:20,width:20},iconStyle:g.helpIcon,onClick:()=>{m().f({environment:s,url:(0,x().xS)("guides.autogeneratedDomains")})},icon:c().questionMarkCircleSmallIcon,ariaLabel:y}),placement:B().W.Bottom})]})}},913001:(e,t,i)=>{i.d(t,{A:()=>l});i(725707),i(491955);var s=()=>i(975392);class a extends(()=>i(129044))().default{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}getSortedSitesForSpace(e,t){const{sortAscending:a,sortColumn:l}=this.state,n=this.state.sites[e];if(n)switch(l){case"page":return s().My(n,(e=>i(34662).q4_(e.store.getTitleValue()).toLowerCase()),a?"asc":"desc");case"published-by":return s().My(n,(e=>{const s=e.publishedMetadata.publishedBy,a=s?i(413871).sk.createChildStore(e.store,s):void 0;return null==a?void 0:a.getDisplayName(t).toLowerCase()}),a?"asc":"desc");case"published-date":return s().My(n,(e=>e.publishedMetadata.publishedTime),a?"asc":"desc");default:return n}}removeSiteFromSpace(e,t){const i=this.state.sites[e];i&&(this.state.sites[e]=i.filter((e=>e.store.id!==t)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const l=new a}}]);