"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[73361,90871],{44250:(e,t,r)=>{function o(e){return!(!e||"askUserToPick"in e)}function n(e){if(!e||!("askUserToPick"in e))return e}function a(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}r.d(t,{DK:()=>n,K$:()=>o,j6:()=>a})},75187:(e,t,r)=>{r.d(t,{B:()=>g,G:()=>d});var o=()=>r(712437),n=()=>r(193302),a=()=>r(524727),i=()=>r(163182),l=()=>r(29869),c=()=>r(87797),s=()=>r(10895),u=()=>r(865226),p=()=>r(84543);function d(e){const{collectionContextStore:t,environment:r,originRect:n,isChartDrilldown:i,intl:l}=e,u=null==t?void 0:t.collectionViewBlockStore(),d=null==t?void 0:t.collectionViewStore();u&&d&&s().ho({environment:r,blocks:[u],originRect:n,moveToContext:"ai_ephemeral_view",isAddTo:!0,isDefaultPrivateLocation:!0,forceShowPrivatePageOption:!0,dontCommitActions:!0,onAccept:async e=>{const{performResult:n}=await p().createAndCommitAsync({environment:r,userAction:"UnlistedCollectionViewMoreButton.handleAddViewToMenuClick",waitForServerCommit:!0,perform:o=>i?c().Iz({environment:r,collectionViewStore:d,collectionViewBlockStore:u,collectionContextStore:t,acceptMoveToArgs:e,transaction:o,intl:l}):(0,a().h)({environment:r,transaction:o,linkedDatabaseBlockStore:u,acceptMoveToArgs:e})});await g({environment:r,blockStore:n,pageVisitSource:i?o().y8.ChartsDrilldown:o().y8.AIEphemeralView})}})}async function g(e){const{environment:t,blockStore:r,pageVisitSource:o}=e;if(!r)return;const a=(0,l().Ay)({store:r,pageVisitSource:o});u().oo({environment:t,url:a});const{assistantMenuActions:c}=await n().assistantDependency.load();i().S.close(),await c.closeAssistantRightHandSideMenu({environment:t})}},87797:(e,t,r)=>{r.d(t,{Sp:()=>w,sw:()=>x,Iz:()=>B});var o=()=>r(712437),n=()=>r(716605),a=()=>r(10895),i=()=>r(541543),l=()=>r(163182),c=()=>r(137476),s=()=>r(876695),u=(r(725707),r(491955),()=>r(571785)),p=()=>r(768022),d=()=>r(15552),g=()=>r(502140),y=()=>r(427091),m=()=>r(3311),f=()=>r(348124);var v=()=>r(569555),h=()=>r(29869),_=()=>r(502852),S=()=>r(413871),C=()=>r(759625),b=()=>r(865226);function w(e){const{chartConfig:t,collectionViewBlockStore:r,format:o,dataPoint:a,clickEvent:i,schema:h,environment:S,collectionContextStore:C,intl:b,query2:w,temporaryViewState:x}=e;if(!r||"groups_reducer"!==(null==t?void 0:t.dataConfig.type))return;(0,_().SQ)({event:i,context:_().y$.EditorClick});const B=function(e){const{dataPoint:t,propertySchema:r,groupByFormat:o,aggregation:n,intl:a}=e,i=t.name??t.x.toString();if(!r)return i;return(0,v().w$)({propertySchema:r,groupByFormat:o,aggregation:n,highChartsLabel:i,intl:a})}({dataPoint:a,propertySchema:(0,n()._g)({schema:h,property:t.dataConfig.groupBy.property}),groupByFormat:null==t?void 0:t.dataConfig.groupBy,aggregation:null==t?void 0:t.dataConfig.aggregationConfig.aggregation,intl:b}),k=function(e){var t,r;const{chartConfig:o,dataPoint:n,format:a,schema:i,collectionViewBlockStore:l,query2:c,temporaryViewState:s}=e;if(!(o&&"placeholder"!==o.type&&"results_reducer"!==o.dataConfig.type&&o.dataConfig.groupBy&&n&&l&&l.pointer.spaceId))return void g().log({level:"error",from:"chartDrilldownHelpers",type:"chartDrilldownMissingRequiredData",error:{name:"chartDrilldownHelpers",message:"Unexpected error"},data:{miscDataToConvertToString:{chartConfig:o,dataPoint:n,collectionViewBlockStore:l}}});const v=o.dataConfig.groupBy.property,h=(0,f().Q)(l,v),_={type:"table",parent_id:l.pointer.id,parent_table:l.pointer.table,alive:!0,space_id:l.pointer.spaceId,format:{is_unlisted:!0,collection_pointer:null==a?void 0:a.collection_pointer,property_filters:(null==s||null===(t=s.propertyFilters)||void 0===t?void 0:t.value)??(null==a?void 0:a.property_filters),table_properties:h},query2:{...c,filter:(null==s||null===(r=s.combinatorFilter)||void 0===r?void 0:r.value)??(null==c?void 0:c.filter)}};let S;var C;return n.groupFormat&&(S=(0,p().K8)({schema:i,propertyMapping:void 0,groupBy:o.dataConfig.groupBy,group:n.groupFormat,timeZone:(0,y().P)()})),S&&((0,d().dU)(S)?null!==(C=_.query2)&&void 0!==C&&C.filter?_.query2.filter=(0,d().GV)([_.query2.filter,S]):_.query2.filter=S:(0,d().yX)(S)&&(_.format.property_filters=[..._.format.property_filters??[],{filter:S,id:(0,m().Ay)()}])),"groups_reducer"===o.dataConfig.type&&(0,u().m)(o)&&o.dataConfig.aggregationConfig.stackOptions&&(_.format.collection_group_by=function(e){var t;if(null===(t=e.aggregationConfig)||void 0===t||!t.stackOptions)return;const r=e.aggregationConfig.stackOptions.groupBy;return r.hideEmptyGroups=!0,r}(o.dataConfig)),_}({chartConfig:t,format:o,dataPoint:a,schema:h,collectionViewBlockStore:r,query2:w,temporaryViewState:x});if(!k)return;const F=(0,s().sl)(C);(0,c().u4)({environment:S,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...F,drilldown_type:"grouped",from:"chart_data_point"}}}),l().S.openCollectionDrilldownView({collectionViewValue:k,collectionViewBlockStore:r,viewsModuleContext:C.viewsModuleContextStore.state,title:B})}function x(e){var t;const{collectionStore:r,dataPoint:n,clickEvent:a,environment:i,collectionContextStore:l}=e;if(null==n||null===(t=n.pagePointer)||void 0===t||!t.id||!r)return;(0,_().SQ)({event:a,context:_().y$.EditorClick});const u=S().Bv.createChildStore(r,n.pagePointer),p=(0,h().Ay)({store:u,fullyQualified:!1,pageVisitSource:o().y8.Expand,showMoveTo:!1,openInCenterPeek:!0});if(!p)return;const d=(0,s().sl)(l);(0,c().u4)({environment:i,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...d,drilldown_type:"results",from:"chart_data_point"}}}),b().oo({environment:i,url:p})}async function B(e){const{environment:t,collectionViewStore:r,collectionViewBlockStore:o,collectionContextStore:n,acceptMoveToArgs:l,transaction:u,intl:p}=e;if(!r)return;const d=o.getCollectionPointer(),g=C().Wv({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,type:"collection_view",transaction:u}),y=(0,i().t)({environment:t,transaction:u,collectionViewStore:r,collectionViewBlockStore:g,intl:p,copyNameExactly:!0});if(!y)return;y.getFormatStore().getKeyValue("collection_pointer")||C().zv({store:y.getFormatStore().getKeyStore("collection_pointer"),data:d,transaction:u}),C().zv({store:y.getFormatStore(),data:{is_unlisted:null},transaction:u}),await a().Ju({...l,targets:[g],transaction:u});const m=(0,s().sl)(n);return(0,c().u4)({environment:t,event:{eventName:"collection_chart_drilldown_save",eventProperties:{...m,new_collection_view_block_id:g.pointer.id}}}),g}},348124:(e,t,r)=>{r.d(t,{Q:()=>n});r(725707),r(491955),r(500234);var o=()=>r(564134);function n(e,t){const r={property:o().rn,visible:!0,width:276},n={property:t,visible:!0},a=[r,n],i=e.getCollectionViewStores().find((e=>"table"===e.getType())),l=null==i?void 0:i.getFormatStore().getKeyStore("table_properties").getValue();if(!i||!l||0===l.length)return a;const c=l.find((e=>e.property===o().rn))??r;return[c,l.find((e=>e.property===t))??n,...l.filter((e=>e.property!==o().rn&&e.property!==t))]}},524727:(e,t,r)=>{r.d(t,{M:()=>p,h:()=>d});r(610931),r(725707),r(491955);var o=()=>r(762847),n=()=>r(716402),a=()=>r(145017),i=()=>r(289765),l=()=>r(10895),c=()=>r(759625),s=()=>r(425447),u=()=>r(485966);function p(e){const{environment:t,collectionViewStore:r,parentCollectionViewBlockStore:l,transaction:s,filter:p,inMemoryRecordCache:d,sort:g,semanticQuery:y,assistantChatSessionId:m}=e,f=u().default.state.currentSpaceStore,v=u().default.state.currentSpaceViewStore;if(!f||!v)throw new Error("No current space or space view.");const h=t.currentUser.id;if(!h)throw new Error("User is not logged in.");const _=c().Wv({environment:t,type:o().xd.collectionViewPage,inMemoryRecordCache:f.inMemoryRecordCache,transaction:s,spaceId:f.id,permissions:[{type:"user_permission",user_id:h,role:"editor"}]}),S={type:"table",parent_id:_.id,parent_table:a().ev,alive:!0,space_id:f.id,format:{table_properties:r.getFormat().table_properties,timeline_arrows_by:void 0,subitem_display_mode:"hidden",table_subitem_toggle_column:"title",is_unlisted:!0,collection_pointer:r.getFormat().collection_pointer??l.getCollectionPointer(),...y?{is_unlisted_from_semantic_query:{is_from_semantic_query:!0,query:y}}:{is_unlisted_from_semantic_query:{is_from_semantic_query:!1}}},query2:{filter:p,sort:g}},C=c().eC({environment:t,table:i().Gy,value:S,inMemoryRecordCache:d,transaction:s});return c().zv({store:_,data:{parent_id:m,parent_table:n().TF,alive:!0,view_ids:[C.id]},transaction:s}),{collectionViewStore:C,linkedDatabaseCollectionBlockStore:_}}async function d(e){const{environment:t,transaction:r,acceptMoveToArgs:o,linkedDatabaseBlockStore:n}=e,{blockStores:[a]}=s().duplicateBlock({environment:t,stores:[n],transaction:r,targetSpaceId:n.getSpaceId(),preferDuplicateLocation:"local",options:{resolveTemplateVariables:!1,addCopyName:!1,deepCopyTransclusionContainers:!0}});c().zv({store:a,data:{alive:!0},transaction:r});for(const i of a.getCollectionViewStores())c().zv({store:i.getFormatStore(),data:{is_unlisted:null,is_unlisted_from_semantic_query:null},transaction:r});return await l().Ju({...o,targets:[a],transaction:r}),a}},533639:(e,t,r)=>{r.d(t,{p:()=>o});class o extends(()=>r(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},569555:(e,t,r)=>{r.d(t,{_G:()=>W,$k:()=>M,w$:()=>z,H$:()=>T,l9:()=>L,NH:()=>j,jY:()=>D,JI:()=>R,ck:()=>A,i5:()=>I,EN:()=>O,gc:()=>P,wK:()=>V});var o=()=>r(486826),n=r(242343),a=()=>r(174114),i=()=>r(950635),l=()=>r(877905),c=()=>r(571785),s=()=>r(572589),u=()=>r(716605),p=()=>r(145054),d=()=>r(769884),g=r(163643);const y=n.memo((function(e){const{size:t,style:r,icon:o,baseUrl:n,getRecordModel:a}=e;return(0,g.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...r},children:(0,g.jsx)(v,{icon:o,size:t,baseUrl:n,getRecordModel:a})})}));function m(e){return.9*e}function f(e){return.888*e}function v(e){let{icon:t,size:o,baseUrl:n,getRecordModel:a}=e;if(!t)return null;const i=(e,t)=>{const r=p().wY({url:e,baseUrl:n,fullyQualified:!0,permissionRecord:t,width:f(o),userId:void 0});return(0,g.jsx)("img",{alt:"icon",src:r,style:{width:f(o),height:f(o),objectFit:"cover",borderRadius:4,marginTop:1}})},l=(0,r(810111).WO)(t.icon);switch(l.type){case"unicode_emoji":return(0,g.jsx)("div",{style:{fontSize:m(o)},children:l.emoji.unicode});case"custom_emoji":const e=d().xm7.resolveCustomEmojiIcon(t,a);return e?i(e.icon,e.pointer):null;case"app_package_asset":case"notion_icon":case"url":return i(t.icon,t.pointer);default:(0,r(76394).HB)(l)}}var h=()=>r(770908);const _=function(e){const{botValue:t,avatarSize:o,baseUrl:n,theme:a,style:i}=e;if(null!=t&&t.icon){const l=r(185912).GM(t.icon)?p().x8({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:n,userId:void 0}):t.icon;return(0,g.jsx)("div",{style:{...(0,h().fo)({theme:a,avatarSize:o}),...i},children:(0,g.jsx)("img",{src:l,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,g.jsx)("div",{children:(0,g.jsx)("div",{style:{...(0,h().ws)({theme:a,avatarSize:o}),...i},children:(0,g.jsx)("div",{children:e})})})}return(0,g.jsx)("span",{children:"🤖"})};var S=()=>r(871002),C=()=>r(846581),b=()=>r(361308),w=()=>r(880395),x=()=>r(220413),B=()=>r(31448),k=()=>r(927685),F=()=>r(401857);const M=(0,r(653998).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function P(e,t,r){const o=(0,a().IS)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor,fontSize:r?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...B().RC}})),[r]);return(0,n.useCallback)(((n,a)=>{var l,c;if(!a)return n.toString();let s,u,p;if(a.actorPointer&&e){var y;const r=(0,i().xC)({pointer:a.actorPointer,getRecordModel:e});u=null==r?void 0:r.asActor,p=null===(y=u)||void 0===y?void 0:y.getDisplayName(t)}return p||(p=n||t.formatMessage(d().Fvx.messages.anonymousPlaceholder)),s=null!==(l=u)&&void 0!==l&&l.isUser()?(0,g.jsx)(h().Ay,{userValue:u,avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,x().x0)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}):null!==(c=u)&&void 0!==c&&c.isBot()?(0,g.jsx)(_,{botValue:u,avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,x().x0)(),style:o.botStyle}):(0,g.jsx)(h().Ay,{userValue:{name:"?"},avatarSize:r?16:20,baseUrl:k().A.domainBaseUrl,theme:(0,x().x0)(),fontSize:r?8:10,initialStyle:o.initialStyle,avatarStyle:o.avatarStyle}),w().A.renderToStaticMarkup((0,g.jsxs)("div",{style:o.wrapper,children:[(0,g.jsx)("div",{style:o.avatarWrapper,children:s}),r?(0,g.jsx)("div",{style:o.nameWrapper,children:p}):null]}))}),[e,t,r,o])}function V(e,t,r){const o=(0,a().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...B().RC}})),[]),i=t.formatMessage(M.titlePlaceholder);return(0,n.useCallback)(((n,a)=>{if(!a||!e)return n.toString()||i;let l;if(a.pagePointer&&e&&(l=e(a.pagePointer)),!l)return n.toString()||i;const c=l.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:r,intl:t,isWorkflowsAppContainerEnabled:!1}),s=l.getRenderIcon({getRecordModel:e});return w().A.renderToStaticMarkup((0,g.jsxs)("div",{style:o.wrapper,children:[s&&(0,g.jsx)("div",{style:o.avatarWrapper,children:(0,g.jsx)(y,{getRecordModel:e,icon:s,size:16,baseUrl:k().A.domainBaseUrl})}),(0,g.jsx)("div",{style:o.titleWrapper,children:c})]}))}),[e,r,t,i,o.wrapper,o.avatarWrapper,o.titleWrapper])}function A(e){var t,r,o,n;const a="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)?"number":R(e.propertySchema);let i;return i="count"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)||"unique"===(null===(n=e.aggregation)||void 0===n?void 0:n.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?I(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,b().ZV)(t,a,e.intl,"compact",i):(0,b().ZV)(O(t,2),a,e.intl,"compact",void 0)}function D(e){let{groupBy:t,dateFormat:r,intl:o}=e;return(e,n)=>{let a;return a=n?n.name:"string"==typeof e?e:e.toString(),T({dateString:a,dateFormat:r,groupBy:t,intl:o})}}function T(e){let{dateString:t,dateFormat:r,groupBy:n,intl:a}=e;const i=parseInt(t,10);if(isNaN(i))return t;switch(n){case"relative":default:return t;case"day":return(0,C().ZF)({value:{type:"date",start_date:o().c9.fromMillis(i).toISODate()},date_format:r||S().vz,allowRelativeDates:!0,intl:a});case"week":case"month":case"year":const e=o().c9.fromMillis(i),l={type:n,range:{type:"daterange",start_date:e.toISODate(),end_date:e.plus({[`${n}s`]:1}).minus({days:1}).toISODate()}};return(0,F().nc)({value:l,intl:a})}}function R(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function I(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function j(e){let{chartConfig:t,schema:r,highChartsLabel:o,highChartsValue:n,isMultiSeries:a,intl:i,numberPrecisionOverride:s}=e,p=o,d=n;if(!t)return{label:p,value:d};const g=t.dataConfig;let y,m,f,v;if(a){if((0,c().m)(t)&&"groups_reducer"===t.dataConfig.type){var h;const e=t.dataConfig;if(y=null===(h=e.aggregationConfig.stackOptions)||void 0===h?void 0:h.groupBy,y){const e=(0,u()._g)({schema:r,property:y.property});e&&(0,l().zn)(e)&&(m=e)}v=e.aggregationConfig.aggregation,"count"!==v.aggregator&&(f=(0,u()._g)({schema:r,property:v.property}))}}else"groups_reducer"===g.type?(y=g.groupBy,m=(0,u()._g)({schema:r,property:g.groupBy.property}),v=g.aggregationConfig.aggregation,"count"!==v.aggregator&&(f=(0,u()._g)({schema:r,property:v.property}))):f=(0,u()._g)({schema:r,property:g.valueProperty});if(p=m?z({propertySchema:m,groupByFormat:y,aggregation:void 0,highChartsLabel:o,intl:i}):p,d&&"number"==typeof d&&f&&(0,l().JW)(f)){var _,S,C,w;const e="count"===(null===(_=v)||void 0===_?void 0:_.aggregator)||"unique"===(null===(S=v)||void 0===S?void 0:S.aggregator)?"number":R(f),t="count"===(null===(C=v)||void 0===C?void 0:C.aggregator)||"unique"===(null===(w=v)||void 0===w?void 0:w.aggregator)?"precision_0":s??I(f);d=t&&"precision_uncapped"!==t?(0,b().ZV)(d,e,i,"compact",t):(0,b().ZV)(O(d,2),e,i,"compact")}return{label:p,value:d}}function z(e){const{propertySchema:t,groupByFormat:r,aggregation:o,highChartsLabel:n,intl:a}=e;if(t&&(0,l().JW)(t)){const e="count"===(null==o?void 0:o.aggregator)||"unique"===(null==o?void 0:o.aggregator)?"number":R(t),r=parseInt(n,10);return isNaN(r)||"percent"===e?n:(0,b().ZV)(r,e,a,"compact")}const i="formula"===(null==r?void 0:r.type)?r.groupBy:r;return t&&(0,l().i8)(t)&&i&&(0,s().Ik)(i)?T({dateString:n,dateFormat:t.date_format,groupBy:i.groupBy,intl:a}):n}const U=1.2,q=2;function W(e){var t,r,o,n;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator))return!1;return"percent"===R(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<q||(!!(null!==(o=e.userYAxisMax)&&void 0!==o&&o.toString().includes(".")||null!==(n=e.userYAxisMin)&&void 0!==n&&n.toString().includes("."))||Math.abs(e.dataYAxisMax)<U&&Math.abs(e.dataYAxisMin)<U))}function L(e){return e%1==0?e:e.toFixed(1)}function O(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}},877905:(e,t,r)=>{r.d(t,{CN:()=>k,D0:()=>_,D5:()=>T,GL:()=>m,I9:()=>y,JQ:()=>v,JW:()=>M,PC:()=>h,Rb:()=>B,SK:()=>x,UK:()=>D,VY:()=>u,YU:()=>b,Yp:()=>C,_x:()=>w,bg:()=>d,fn:()=>V,i8:()=>A,kq:()=>p,q_:()=>R,sh:()=>g,tG:()=>f,xS:()=>F,zn:()=>P});var o=()=>r(76394),n=()=>r(61014),a=()=>r(572589),i=()=>r(564134),l=()=>r(716605),c=()=>r(215152),s=()=>r(571785);const u=["gray","blue","yellow","green","purple","teal","orange","pink","red"],p=["auto","colorful"];let d=function(e){return e.small="small",e.medium="medium",e.large="large",e.extra_large="extra_large",e}({});function g(e){switch(e){case d.small:return 300;case d.medium:return 400;case d.large:return 600;case d.extra_large:return 800;default:(0,o().HB)(e)}}function y(e){switch(e){case d.small:return 150;case d.medium:return 250;case d.large:return 300;case d.extra_large:return 400;default:(0,o().HB)(e)}}let m=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),f=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),v=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),h=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({}),_=function(e){return e.none="none",e.value="value",e.name="name",e.name_and_value="name_and_value",e}({});function S(e){if(!e)return!1;return a().BI.includes(e)}function C(e){const t=(0,n().getFormulaPropertySchemaBaseResultType)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function b(e,t){var r,n;let i,s=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var u;const{chartFormat:r,chartGroupByFormat:o}=function(e,t,r,o){const n=(0,l()._g)({schema:o,property:e.property});if(n&&"donut"===r&&(0,c().e0)(n)){const r=(0,a().MP)(e);return{chartFormat:{...t,mainSort:c().S0.yDescending},chartGroupByFormat:r}}return{chartFormat:t,chartGroupByFormat:e}}(null==e||null===(u=e.dataConfig)||void 0===u?void 0:u.groupBy,null==e?void 0:e.chartFormat,"donut",t);s=r,i={...e.dataConfig,groupBy:o,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?(i=e.dataConfig,s={...s,mainSort:c().S0.yDescending}):(0,o().HB)(e.dataConfig);R(e)&&s&&(void 0===(null===(r=s)||void 0===r?void 0:r.donutDataLabels)||(null===(n=s)||void 0===n?void 0:n.donutDataLabels)===_.none)?s.donutDataLabels=_.value:!R(e)&&s&&(s.donutDataLabels=_.none);const p={...e,type:"donut",dataConfig:i};return s&&(p.chartFormat=s),p}function w(e,t){let r;"groups_reducer"===e.dataConfig.type?r={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o().HB)(e.dataConfig);const n=e.chartFormat;return n&&n.donutDataLabels&&n.donutDataLabels!==_.none?n.axisShowDataLabels=!0:!n||n.donutDataLabels!==_.none&&void 0!==n.donutDataLabels||(n.axisShowDataLabels=!1),{...e,type:t,dataConfig:r}}function x(e,t){let r;if("groups_reducer"===e.dataConfig.type){var n;const o=null==e||null===(n=e.dataConfig)||void 0===n?void 0:n.groupBy;r={...e.dataConfig,groupBy:o,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,o().HB)(e.dataConfig);return{...e,type:t,dataConfig:r}}const B={main:c().S0.xAscending,stacked:c().S0.manual};function k(e){let{chartConfig:t,xAxisPropertyId:r,newDataConfigType:n,groupBy:a,aggregation:i,valueProperty:l}=e;const s="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.seriesFormat:t.dataConfig.valueSeriesFormat;"groups_reducer"===n?t.dataConfig={type:"groups_reducer",groupBy:a,aggregationConfig:{aggregation:i,seriesFormat:s,stackOptions:"groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===n?t.dataConfig={type:"results_reducer",nameProperty:r,valueProperty:l,valueSeriesFormat:s}:(0,o().HB)(n);const u="formula"===a.type?a.groupBy.sort:a.sort;return t.chartFormat={...t.chartFormat,mainSort:(0,c().gN)(u)},t}function F(e){let{property:t,propertySchema:r,groupByOption:o,hideEmptyGroups:i}=e;const l=r.type;if((0,a().Eg)(r)){if((0,a()._o)(l)){if(o&&S(o))return{type:l,property:t,groupBy:o,sort:{type:"ascending"}}}else{if((0,a().KI)(l)||"select"===l||"multi_select"===l)return{type:l,property:t,sort:{type:"ascending"}};if((0,a().iF)(l)){if(o&&((c=o)&&a().PC.includes(c)))return{type:l,property:t,groupBy:o,sort:{type:"ascending"}}}else{if("number"===l)return{type:l,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===l){const e=(0,n().getFormulaPropertySchemaResultType)(r);if("number"===e)return{type:"formula",property:t,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===e&&S(o))return{type:"formula",property:t,groupBy:{type:"date",groupBy:o,sort:{type:"ascending"}}}}else if("person"===l)return{type:l,property:t,sort:{type:"manual"}}}}var c;return(0,a().V0)({property:t,propertySchema:r,hideEmptyGroups:i})}}function M(e){const t="formula"===e.type?(0,n().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().AM)(e)||"number"===t}function P(e){const t="formula"===e.type?(0,n().getFormulaPropertySchemaResultType)(e):void 0;return(0,a()._o)(e.type)||"date"===t}function V(e){const t="formula"===e.type?(0,n().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().JY)(e)||"person"===t}function A(e){if("formula"===e.type){const t=(0,n().getFormulaPropertySchemaResultType)(e);return(0,a()._o)(t)}return(0,a()._o)(e.type)}function D(e){return"text"===e||"number"===e||"person"===e||"date"===e}function T(e){var t;return!(!e||!(0,s().m)(e))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function R(e){return!!T(e)&&(!(!e||!(0,s().m)(e))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(r=e.chartFormat)||void 0===r?void 0:r.axisShowDataLabels)));var t,r}},994488:(e,t,r)=>{r.d(t,{o:()=>o});r(362833),r(403517);function o(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(0===r.length)return e.map((e=>[e]));const a=[];for(const i of e)a.push(...o(r[0],...r.slice(1)).map((e=>[i,...e])));return a}}}]);