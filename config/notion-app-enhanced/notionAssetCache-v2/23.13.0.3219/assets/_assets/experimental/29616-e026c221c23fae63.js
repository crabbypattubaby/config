"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25700,29616],{16250:(e,t,n)=>{n.d(t,{m:()=>u});n(725707),n(491955),n(500234),n(113085);var i=n(242343),a=()=>n(237385),o=()=>n(803290),r=()=>n(706788),s=()=>n(485966),l=()=>n(836331),d=()=>n(773082),c=()=>n(427871);function u(){const e=(0,a().v3)(),t=(0,i.useRef)(void 0);return(0,o().K8)((()=>{if(void 0===t.current){if(!l().default.isStatsigReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};t.current=l().default.checkGate({gateName:"calendar_home_tile_caching"})}if(t.current){var n;const{currentSpaceViewStore:t}=s().default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const i=t.getSelectedCalendarBotId(),a=!d().A.state.loaded;if(i&&a)return{loading:!1,botId:i,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:o,userId:l}=d().A.state.loaded?d().A.state:{spaceId:void 0,userId:void 0},u=d().A.bots.state.filter((e=>e.integration_id===r().io)),m=null===(n=u[0])||void 0===n?void 0:n.id,p=i&&u.some((e=>e.id===i))?i:m;return p&&p!==i?(0,c().rq)({environment:e,botId:p,shouldLog:!1}):!p&&i&&(0,c().k2)({environment:e}),{loading:a,botId:p,botSpaceId:o,botUserId:l}}{var i,a,o;const e=d().A.bots.state.filter((e=>e.integration_id===r().io)),t=null===(i=s().default.state.currentSpaceViewStore)||void 0===i?void 0:i.getSelectedCalendarBotId(),n=!d().A.state.loaded||!(null!==(a=s().default.state.currentSpaceViewStore)&&void 0!==a&&a.isReady()),{spaceId:l,userId:c}=d().A.state.loaded?d().A.state:{spaceId:void 0,userId:void 0},u=null===(o=e[0])||void 0===o?void 0:o.id;if(!t)return{loading:n,botId:u,botSpaceId:l,botUserId:c};const m=e.find((e=>e.id===t));return{loading:n,botId:(null==m?void 0:m.id)??u,botSpaceId:l,botUserId:c}}}),[e])}},78245:(e,t,n)=>{n.d(t,{z:()=>r});n(242343);var i=()=>n(129978),a=n(163643);const o=new(i().O2)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await n.e(79883).then(n.bind(n,824997));return{CollectionItemCover:e}})),r=(0,i()._h)(o,(e=>e.CollectionItemCover),{renderLoading:(e,t)=>{const{coverHeight:i,coverSizeFormat:o,emptyGalleryCoverStyle:r,showEmptyGalleryCover:s}=t;return s?(0,a.jsx)(n(803291).t,{coverHeight:i,coverSizeFormat:o,emptyGalleryCoverStyle:r}):null}})},138598:(e,t,n)=>{n.d(t,{J:()=>a});n(242343);var i=n(163643);const a=(0,n(680369).wt)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,i.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,i.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,i.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})},533666:(e,t,n)=>{n.d(t,{Y:()=>a});n(242343);const i={viewBox:"0 0 16 16",svg:(0,n(163643).jsx)("path",{d:"M3.2 6.725a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55"})},a=(0,n(680369).wt)("ellipsisSmall",i)},604296:(e,t,n)=>{n.d(t,{N:()=>o,V:()=>a});var i=()=>n(137476);function a(e){i().vd(e,"view_public_site_click")}function o(e,t){i().vd(e,"share_menu_tab_click",t)}},634280:(e,t,n)=>{n.d(t,{A:()=>a});class i extends(()=>n(129044))().default{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const a=new i},741848:(e,t,n)=>{n.d(t,{oq:()=>se,aR:()=>te,zM:()=>ie});var i=n(242343),a=()=>n(237385),o=()=>n(803290),r=()=>n(174114),s=()=>n(83544),l=()=>n(887508),d=()=>n(138598),c=()=>n(145322),u=()=>n(81322),m=()=>n(214144),p=()=>n(446588),g=()=>n(653998),h=()=>n(76394),v=()=>n(31448),f=()=>n(604296),b=()=>n(516267),S=()=>n(356813),I=()=>n(35462),y=()=>n(207762),A=()=>n(983050),x=()=>n(622163),k=()=>n(575015),C=()=>n(126451),w=()=>n(103151),B=()=>n(907721),M=(n(610931),()=>n(818369)),U=()=>n(485966);var j=n(163643);function _(e){const{beamMetadata:t}=e,[n,o]=(0,i.useState)(!1),s=(0,a().v3)(),l=(0,r().IS)((e=>({beamIcon:{height:24,width:24},button:{borderRadius:6},tooltipWidth:{width:280}})),[]);return n||!t?null:(0,j.jsx)(w().A,{delayThreshold:500,placement:B().W.Bottom,renderTooltip:()=>(0,j.jsx)(g().sA,{defaultMessage:"Beam sends a real-time link of this page to your teammates who are online and on the same calendar event",id:"shareMenu.beam.tooltip"}),textWrap:!0,style:l.tooltipWidth,render:e=>(0,j.jsx)(C().A,{...e,style:l.button,onClick:async()=>{o(!0);const e=await function(e){var t,n;const{environment:i,beamMetadata:a}=e;if(!(null===(t=U().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id))throw new Error("No current page selected");if(!(null===(n=U().default.state.currentSpaceStore)||void 0===n?void 0:n.id))throw new Error("No current space selected");return M().callApi({eventName:"sendBeam",environment:i,data:{beamMetadata:a}})}({environment:s,beamMetadata:t});"failed"!==e.type?k().D6({label:(0,j.jsx)(g().sA,{id:"shareMenu.beam.sent",defaultMessage:"Beam sent!"})}):k().D6({label:(0,j.jsx)(g().sA,{id:"shareMenu.beam.failed",defaultMessage:"There was an issue sending the beam. Please try again later."})})},children:(0,d().J)(l.beamIcon)})})}n(725707),n(491955),n(403517);var P=()=>n(774041),T=()=>n(976841),N=()=>n(975392),D=()=>n(643553),R=()=>n(332440),E=()=>n(427871),W=()=>n(16250),H=()=>n(542683),O=()=>n(707715),z=()=>n(613313),L=(n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(500234),()=>n(545250)),Q=()=>n(145017),F=()=>n(927685),K=()=>n(413871);function V(e){const{environment:t,currentSpaceStore:n}=e;let i=e.fileUrl;F().A.isLocalhost&&(i=i.replace("dev.notion.so","localhost:3000").replace("https","http"));const a=(0,L().parseRoute)({url:i,isMobile:t.device.isMobile,baseUrl:F().A.domainBaseUrl,publicDomainName:F().A.publicDomainName,protocol:F().A.protocol,currentUrl:window.location.href}),o="page"===a.name?a.blockId:void 0;if(!o)return;const r=K().Bv.createChildStore(n,{table:Q().ev,id:o});return r.load(),r.isReady()?r:void 0}function G(e){var t;return"block"===(null==e||null===(t=e.pointer)||void 0===t?void 0:t.table)}function q(){const e=(0,a().v3)(),t=(0,o().K8)((()=>(0,z().Bh)()),[]),{botId:n}=(0,W().m)(),r=(0,o().O$)(U().AppStoreCurrentSpaceViewStore),s=(0,i.useRef)(!1),l=(0,i.useRef)(0);(0,i.useEffect)((()=>{s.current=!1,l.current=0;(async()=>{if(t&&!s.current&&n&&r&&l.current<3)try{await(0,E().qq)({environment:e,currentSpaceViewStore:r,botId:n,timeRange:(0,H().M)(),forceRefetch:!0,reason:"background_load"}),s.current=!0,l.current=0}catch(i){s.current=!1,l.current+=1}})()}),[e,r,n,t]);const[d,c]=(0,i.useState)([]),[u,m]=(0,o().K8)((()=>{const e=U().default.state.mainEditorCurrentBlockStore;if(!e)return[void 0,void 0];const t=e.getIcon();return[e.id,G(t)?t:void 0]}),[]),p=(0,o().O$)(U().AppStoreCurrentSpaceStore),g=(0,o().K8)((()=>O().A.getEvents()),[]),h=(0,i.useCallback)((()=>{if(!p||!t)return[];return g.filter((e=>{var t;if(e.isAllDay||"declined"===e.responseStatus)return!1;const n=new Date(e.start.dateTime),i=(0,P().A)(n,-5),a=new Date(e.end.dateTime),o=(0,P().A)(a,5),r=new Date;return((null===(t=e.attachments)||void 0===t?void 0:t.length)??0)>0&&o>=i&&r>=i&&r<=o}))}),[p,g,t]);(0,R().n)((()=>{if(!t)return;const e=h(),n=e.map((e=>e.id)),i=d.map((e=>e.id));(0,N().R9)(n,i).length>0&&c(e)}),2*D().Xb,!0);const v=(0,o().K8)((()=>{if(!t)return;if(!u||!p)return;const n=function(e){const{environment:t,upcomingEvents:n,currentBlockId:i,currentSpaceStore:a}=e;for(const o of n){const e=(o.attachments||[]).find((e=>{const n=V({environment:t,fileUrl:e.fileUrl,currentSpaceStore:a});return(null==n?void 0:n.id)===i}));if(e)return{event:o,attachment:e}}}({environment:e,upcomingEvents:d,currentBlockId:u,currentSpaceStore:p});if(!n)return;const i=n.event,a=n.attachment,o=null!=(r=i)&&r.attendees&&0!==r.attendees.length?Array.from(new Set(r.attendees.filter((e=>!e.self&&e.email)).map((e=>e.email)))).filter((e=>void 0!==e)):[];var r;return 0!==o.length?{beamType:"calendarAttendees",emails:o,attachment:a,recordIcon:m}:void 0}),[u,d,e,p,m,t]);if(v&&!(v.emails.length>T().Hs))return{beamType:v.beamType,emails:v.emails,attachment:v.attachment,recordIcon:v.recordIcon}}var $=()=>n(935989),J=()=>n(760034),Y=()=>n(33705),X=()=>n(268117),Z=()=>n(422340);const ee=(0,g().YK)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"},shareOnSocial:{defaultMessage:"Share via social",id:"shareMenu.shareOnSocial"}});function te(e){let{inviteTargetsStore:t,mostPermissivePublicItem:n}=e;const{display:i,source:a}=(0,o().K8)((()=>{const{display:e}=Z().Ay.state;if(e===Z().pP.Invite){const{source:t}=Z().Ay.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(i){case Z().pP.MainShareMenu:case Z().pP.Publish:return(0,j.jsx)(ie,{mostPermissivePublicItem:n});case Z().pP.Invite:if("notion"===a)return(0,j.jsx)(ae,{inviteTargetsStore:t});if("slack"===a||"google"===a)return(0,j.jsx)(oe,{source:a});throw(0,h().HB)(a);default:(0,h().HB)(i)}}const ne=[Z().QC.Share,Z().QC.Publish];function ie(e){let{mostPermissivePublicItem:t}=e;const n=(0,a().v3)(),s=i.useRef(null),{isMobile:l}=n.device,c=(0,o().K8)((()=>(0,p().W8)(t.permissionItem)),[t.permissionItem]);(0,i.useEffect)((()=>{const e=Z().Ay.state,t=e.tab===Z().QC.Share&&e.display===Z().pP.MainShareMenu?e.source:void 0;c&&t!==Z().mc.InviteBackButton&&(Z().Ay.setState({tab:Z().QC.Publish,display:Z().pP.Publish,sessionId:m().JW(),isInitialized:!0}),(0,$().EN)(n,{source:"share_button"}))}),[n,c]);const u=(0,o().K8)((()=>Z().Ay.state.tab),[]),h=(0,o().K8)((()=>(0,X().FI)()),[]),b=(0,r().IS)((e=>({tabStyle:{color:e.text.tertiary,...l&&{width:"50%",textAlign:"center"}},selectedTabStyle:h?{}:{fontWeight:v().Wy.medium},tabTitleStyle:{color:"inherit",...h&&{fontSize:(0,x().ny)(n,"UIRegular"),fontWeight:v().Wy.medium}},style:l?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:h?16:14,paddingLeft:h?16:8},tabBorderStyle:h?{left:0,right:0}:{}})),[n,l,h]),S=(0,r().IS)((e=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:e.text.secondary,fontWeight:v().Wy.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===e.mode?e.tint.regular:e.surface.elevated},tabTitleStyle:{color:"inherit",fontSize:(0,x().ny)(n,"UIRegular"),fontWeight:v().Wy.regular},selectedTabTitleStyle:{fontWeight:v().Wy.medium},style:{justifyContent:"space-between",padding:2,background:e.tint.regular,borderRadius:10,marginBottom:0,height:34}})),[n]),I=(0,r().IS)((e=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginLeft:4,opacity:u===Z().QC.Publish?1:.5},tabBarContainer:{paddingLeft:20,paddingRight:20,paddingTop:8,paddingBottom:16,backgroundColor:e.surface.page}})),[u]),k=(0,i.useCallback)((e=>{const t=ne[e];t!==u&&(f().N(n,{tab:t}),t===Z().QC.Share&&Z().Ay.setState({...Z().Ay.state,display:Z().pP.MainShareMenu,tab:Z().QC.Share,source:Z().mc.ShareTab}),t===Z().QC.Publish&&Z().Ay.setState({...Z().Ay.state,display:Z().pP.Publish,tab:Z().QC.Publish}))}),[u,n]),C=q(),w=C&&C.emails.length>0,B=[(0,j.jsx)(i.Fragment,{children:l&&!h?(0,j.jsx)(g().sA,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,j.jsx)(g().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,j.jsxs)("div",{ref:s,style:I.publishTabContainer,className:A().hKK,children:[(0,j.jsx)(g().sA,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),c&&(0,d().J)(I.publishIcon)]},"publishTab")],M=(0,o().K8)((()=>Y().A.state.siteSettingContentType),[]);return"seo"===M?(0,j.jsx)(le,{}):"embed"===M?(0,j.jsx)(de,{handleBackButtonClick:()=>{J().Bp("initial")}}):"social"===M?(0,j.jsx)(ce,{handleBackButtonClick:()=>{J().Bp("initial")}}):l&&h?(0,j.jsx)("div",{style:I.tabBarContainer,children:(0,j.jsx)(y().Ay,{...S,tabs:B,selectedIndex:ne.indexOf(u),onChange:k,hideTabBorder:!0})}):(0,j.jsx)(y().Ay,{...b,tabs:B,selectedIndex:ne.indexOf(u),onChange:k,right:w&&C?(0,j.jsx)(_,{beamMetadata:C}):null})}function ae(e){let{inviteTargetsStore:t}=e;const n=(0,o().K8)((()=>(0,X().FI)()),[]),a=(0,r().IS)((e=>({container:n?{display:"flex",paddingLeft:12,paddingRight:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${e.regularDividerColor}`}:{display:"flex",margin:"0 12px 6px",height:48}})),[n]),s=(0,i.useCallback)((()=>{t.reset(),Z().Ay.setState({...Z().Ay.state,display:Z().pP.MainShareMenu,tab:Z().QC.Share,source:Z().mc.InviteBackButton})}),[t]);return(0,j.jsx)("div",{style:a.container,children:(0,j.jsx)(se,{onClick:s,titleMessage:n?(0,j.jsx)(g().sA,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"}):(0,j.jsx)(g().sA,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})})}function oe(e){const{source:t}=e,n=(0,g().tz)(),a=(0,r().IS)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:v().Wy.semibold}})),[]),o=(0,i.useCallback)((()=>{Z().Ay.setState({...Z().Ay.state,tab:Z().QC.Share,display:Z().pP.Invite,source:Z().NL.Notion,focus:Z().yZ.Search,emailMessage:""})}),[]);return(0,j.jsxs)("div",{style:a.container,children:[(0,j.jsx)(I().A,{style:a.titleLabel,children:(0,j.jsx)(g().sA,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,j.jsx)(re,{source:t})}})}),(0,j.jsx)(S().A,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:u().V,style:{borderRadius:"100%"},onClick:o})]})}function re(e){let{source:t}=e;const n=(0,r().IS)((()=>({imageStyle:{marginLeft:4,marginRight:4}})),[]);return t===Z().NL.Slack?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(b().A,{type:"image_url",imageURL:s().A.images.externalIntegrations.slackIconPng,size:18,imageStyle:n.imageStyle}),(0,j.jsx)(g().sA,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):t===Z().NL.Google?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(b().A,{type:"image_url",imageURL:s().A.images.externalIntegrations.googleGIconPng,size:18,imageStyle:n.imageStyle}),(0,j.jsx)(g().sA,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):void(0,h().HB)(t)}function se(e){const{onClick:t,titleMessage:n}=e,i=(0,a().v3)(),s=(0,o().K8)((()=>(0,X().FI)()),[]),d=(0,g().tz)(),u=(0,r().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{...s?{height:20,width:20}:{height:16,width:16},strokeWidth:v().Wy.semibold},sendInviteLabel:{fontWeight:v().Wy.medium,...s&&{fontSize:(0,x().ny)(i,"UIRegular")}}})),[i,s]);return(0,j.jsxs)("div",{style:u.topContainer,children:[(0,j.jsx)(S().A,{icon:s?c().Z:l().v,iconStyle:u.arrowIcon,style:u.iconButton,onClick:t,ariaLabel:d.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,j.jsx)(I().A,{style:u.sendInviteLabel,children:n})]})}function le(){const e=(0,r().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]),t=(0,i.useCallback)((()=>{J().Bp("initial")}),[]);return(0,j.jsx)("div",{style:e.container,children:(0,j.jsx)(se,{onClick:t,titleMessage:(0,j.jsx)(g().sA,{...ee.seo})})})}function de(e){const t=(0,r().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,j.jsx)("div",{style:t.container,children:(0,j.jsx)(se,{onClick:e.handleBackButtonClick,titleMessage:(0,j.jsx)(g().sA,{...ee.embed})})})}function ce(e){const t=(0,r().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,j.jsx)("div",{style:t.container,children:(0,j.jsx)(se,{onClick:e.handleBackButtonClick,titleMessage:(0,j.jsx)(g().sA,{...ee.shareOnSocial})})})}},760023:(e,t,n)=>{n.d(t,{Kz:()=>o,Sc:()=>r,as:()=>a});var i=()=>n(137476);function a(e,t){(0,i().u4)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function o(e,t){(0,i().u4)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function r(e){(0,i().u4)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},760034:(e,t,n)=>{n.d(t,{Bp:()=>P,DD:()=>E,E9:()=>$,H6:()=>M,HE:()=>U,HY:()=>T,JI:()=>L,Nf:()=>Q,P8:()=>G,V_:()=>F,XL:()=>W,Xz:()=>H,aD:()=>j,aN:()=>z,d7:()=>O,d8:()=>C,j4:()=>K,n0:()=>V,pu:()=>D,uH:()=>N,uY:()=>q,wl:()=>_,yF:()=>R,zV:()=>B});n(610931),n(362833),n(725707),n(491955),n(403517),n(242343);var i=()=>n(446588),a=()=>n(66460),o=()=>n(792007),r=()=>n(32194),s=()=>n(653998),l=()=>n(975392),d=()=>n(3311),c=()=>n(818369),u=()=>n(759625),m=()=>n(110975),p=()=>n(575015),g=()=>n(84543),h=()=>n(927685),v=()=>n(754697),f=()=>n(880026),b=()=>n(112907),S=()=>n(208897),I=()=>n(33705),y=()=>n(634280),A=()=>n(935989),x=()=>n(760023),k=n(163643);function C(e){const{environment:t,store:n,type:i,header:r,domainId:s}=e,l=n.getSiteStore();if(l)return l.id;let d=s;var c;d||(d=null===(c=b().Nq(n.getSpaceStore()))||void 0===c?void 0:c.id);const m=(0,v().JH)({environment:t,table:o().Eu,spaceId:(0,a().e)(n.getSpaceId())});g().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const a=u().vt({environment:t,table:m.table,args:{id:m.id,type:i,spaceId:m.spaceId,blockId:n.id,domainId:d,currentUserId:t.currentUser.id,header:r??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return u().zv({store:n.getFormatStore(),data:{site_id:a.id},transaction:e}),a.id}})}function w(e){const{environment:t,siteRootBlockStore:n,domainId:i}=e;let a=n.getSiteStore();if(a||(C({environment:t,type:"site",store:n,domainId:i}),a=n.getSiteStore()),a)return a}function B(e){const{environment:t,domainId:n,resetWatermark:i}=e,a=w(e);a&&a.isDefined()&&(g().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{a.getDomainId()!==n&&g().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),g().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(i){const n=a.getHeader();g().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),p().D6({label:(0,k.jsx)(s().sA,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function M(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:i}=e,o=w(e);if(!o)return;"form"!==o.getType()&&g().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{o&&o.isDefined()&&i!==o.isSearchEngineIndexingEnabled()&&(g().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:i,currentUserId:t.currentUser.id})}),i&&e.postSubmitCallbacks.push((async e=>{e||await c().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,a().e)(n.pointer.spaceId)}}})})))}})}function U(e){const{environment:t,store:n,seoTitle:i,seoDescription:a}=e;g().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const o=n.getFormat().seo_title,r=n.getFormat().seo_description;o===i&&r===a||(u().zv({store:n.getFormatStore(),data:{seo_title:i,seo_description:a},transaction:e}),(0,A().NZ)(t,{target_block_id:n.id,new_title:i??null,new_description:a??null}),p().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function j(e){y().A.setState({...y().A.state,settingOpen:e})}function _(){y().A.setState({...y().A.state,settingOpen:"initial"})}function P(e){I().A.setState({...I().A.state,siteSettingContentType:e})}function T(e){var t,n,i;const{siteRootBlockStore:a,permissionItem:o,from:r,sudoModeStore:s}=e,l=a.getSiteStore(),d=null==l?void 0:l.getHeader(),c=(null==d||null===(t=d.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];y().A.setState({settingOpen:"initial",permissionItem:o,from:r,sudoModeStore:s,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==d?void 0:d.hideBreadcrumbs,hideSearch:null==d?void 0:d.hideSearch,hideWatermark:null==d?void 0:d.hideWatermark,enableDuplicateAsTemplate:o.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,enableQna:null==l||null===(i=l.getSettings())||void 0===i?void 0:i.enableQna})}async function N(e){var t;const{environment:n,store:a,siteRootBlockStore:o}=e,r=w({environment:n,siteRootBlockStore:o}),u=null==r?void 0:r.getType();if(!r||"form"===u)return;const m=y().A.getState();let h=!1;const v={};let S;m.enableQna&&(S=await async function(e){var t,n,i,a;const{environment:o,siteStore:r}=e,s=null===(t=r.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=r.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(i=b().Nq(r.getSpaceStore()))||void 0===i?void 0:i.domain_name)))throw new Error("no domain on site");const l=b().Ix({spaceStore:r.getSpaceStore(),domainId:null===(a=r.getDomainStore())||void 0===a?void 0:a.id}).split(":")[0],u=`${(0,d().S2)(r.id)}@${l}`,m=await c().callApi({eventName:"createEmailUser",environment:o,data:{email:u}});if("failed"===m.type)throw new Error("failed to create qna user");return m.data.userId}({environment:n,siteStore:r})),g().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(r&&r.isDefined()){var t,i;(r.getFaviconUrl()||null)!==m.faviconUrl&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateFaviconUrl({faviconUrl:m.faviconUrl,currentUserId:n.currentUser.id})}),h=!0,v.favicon=m.faviconUrl);(r.getPreviewImageUrl()||null)!==m.previewImageUrl&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updatePreviewImageUrl({previewImageUrl:m.previewImageUrl,currentUserId:n.currentUser.id})}),h=!0,v.preview_image=m.previewImageUrl);const a=r.getHeader();let o=a;const s=function(e,t){const n=e.map((e=>({type:"block",blockId:e})));if(!t&&0===n.length)return;if(t&&(0,l().n4)(n,t))return;return n}(m.customHeaderBlockIds,null==a?void 0:a.customItems);s&&(o={...o,customItems:s},v.custom_headers=s.map((e=>e.blockId))),(null==a?void 0:a.hideBreadcrumbs)!==m.hideBreadcrumbs&&(o={...o,hideBreadcrumbs:m.hideBreadcrumbs},v.hide_breadcrumbs=m.hideBreadcrumbs),(null==a?void 0:a.hideSearch)!==m.hideSearch&&(o={...o,hideSearch:m.hideSearch},v.hide_search=m.hideSearch),(null==a?void 0:a.hideWatermark)!==m.hideWatermark&&(o={...o,hideWatermark:m.hideWatermark},v.hide_watermark=m.hideWatermark),o&&a!==o&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateHeader({header:o,currentUserId:n.currentUser.id})}),h=!0);r.getGoogleAnalyticsId()!==m.googleAnalyticsId&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:m.googleAnalyticsId,currentUserId:n.currentUser.id})}),h=!0,v.google_analytics_id=m.googleAnalyticsId);(null===(t=r.getSettings())||void 0===t?void 0:t.theme)!==m.theme&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateTheme({theme:m.theme,currentUserId:n.currentUser.id})}),h=!0,v.theme=m.theme);(null===(i=r.getSettings())||void 0===i?void 0:i.enableQna)!==m.enableQna&&(m.enableQna?S&&g().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna,siteUserId:S}}}):g().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna}}}),h=!0)}}});if((null===(t=m.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==m.enableDuplicateAsTemplate&&m.permissionItem&&m.from){const e=(0,i().Yi)(m.from);(0,f().Hc)({oldPermissionItem:m.permissionItem,newPermissionItem:{...m.permissionItem,allow_duplicate:m.enableDuplicateAsTemplate},wasInherited:e!==a.id,environment:n,store:a,sudoModeStore:m.sudoModeStore,location:"published_site_settings"}),h=!0,v.enable_duplicate_as_template=m.enableDuplicateAsTemplate}h&&((0,x().Kz)(n,{settings_changed:v}),p().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})}))}function D(e){y().A.setState({...y().A.state,faviconUrl:e})}function R(e){y().A.setState({...y().A.state,previewImageUrl:e})}function E(e){y().A.setState({...y().A.state,hideBreadcrumbs:e})}function W(e){y().A.setState({...y().A.state,hideSearch:e})}function H(e){y().A.setState({...y().A.state,hideWatermark:e})}function O(e){y().A.setState({...y().A.state,enableDuplicateAsTemplate:e})}function z(e){const t=y().A.state.customHeaderBlockIds.concat([e]);y().A.setState({...y().A.state,customHeaderBlockIds:t})}function L(e){const t=y().A.state.customHeaderBlockIds.filter((t=>t!==e));y().A.setState({...y().A.state,customHeaderBlockIds:t})}function Q(e){y().A.setState({...y().A.state,googleAnalyticsId:e})}function F(e){y().A.setState({...y().A.state,theme:e})}async function K(e){const{environment:t,spaceStore:n,query:i,siteRootBlockId:a}=e;if(!n)return;const o=await c().callApi({eventName:"searchPagesInSite",environment:t,data:{query:i,spaceId:n.id,filters:r().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[a],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==o.type?o.data:void 0}async function V(e){const{environment:t,blockStore:n,slug:i}=e,a=await c().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:i,clientVersion:h().A.version}});if("success"!==a.type)return{error:a};p().D6({label:(0,k.jsx)(s().sA,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function G(e){y().A.setState({...y().A.state,enableQna:e})}function q(e){const{environment:t,store:n,pageVisitSource:i}=e,a=S().R({store:n,pageVisitSource:i});m().f({environment:t,url:a})}function $(e){const{environment:t,siteStore:n,embedSettings:i}=e;g().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{u().zv({store:n.getSettingsStore(),data:{embedSettings:i},transaction:e})}})}},803291:(e,t,n)=>{n.d(t,{t:()=>o});var i=n(242343),a=n(163643);const o=i.memo((function(e){const{coverHeight:t,coverSizeFormat:i,emptyGalleryCoverStyle:o}=e,r=(0,n(174114).IS)((()=>({container:{height:(0,n(869596).F)(t,i),...o}})),[t,i,o]);return(0,a.jsx)("div",{style:r.container})}))},869596:(e,t,n)=>{n.d(t,{F:()=>a});var i=()=>n(551116);function a(e,t){if(e)return e;switch(t){case"large":return i().A.card.desktop.large.height;case"small":return i().A.card.desktop.small.height;default:return i().A.card.desktop.medium.height}}},935989:(e,t,n)=>{n.d(t,{EN:()=>a,Ex:()=>o,NZ:()=>r,T6:()=>l,i_:()=>s,kW:()=>d});var i=()=>n(137476);function a(e,t){(0,i().u4)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function o(e,t){(0,i().u4)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function r(e,t){(0,i().u4)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,i().u4)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function l(e,t){(0,i().u4)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function d(e,t){(0,i().u4)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},976841:(e,t,n)=>{n.d(t,{Hs:()=>a,nw:()=>r,vI:()=>s});var i=()=>n(141666);const a=100,o=5*i().Xb,r=15*i().TD;function s(e){return!!e.sendDateMs&&Date.now()-e.sendDateMs<=o}}}]);