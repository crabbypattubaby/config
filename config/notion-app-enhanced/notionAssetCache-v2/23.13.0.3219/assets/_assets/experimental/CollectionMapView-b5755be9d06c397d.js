"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[51680],{8947:(e,t,o)=>{o.d(t,{S:()=>a});var n=o(242343),r=o(163643);const a=n.forwardRef((function(e,t){const n="dark"===(0,o(174114).eP)();return(0,r.jsx)(o(529402).T5,{ref:t,mapStyle:n?"https://tiles.openfreemap.org/styles/dark":"https://tiles.openfreemap.org/styles/liberty",...e})}))},129243:(e,t,o)=>{o.d(t,{GO:()=>R,Ju:()=>V,KA:()=>B,L0:()=>H,L2:()=>W,dA:()=>Z,gI:()=>k,iN:()=>F,oG:()=>j,sK:()=>T});o(725707),o(491955),o(771702);var n=()=>o(519423),r=()=>o(486540),a=()=>o(446588),i=()=>o(220574),s=()=>o(145017),c=()=>o(518797),l=()=>o(66460),d=()=>o(528762),p=()=>o(409211),u=()=>o(23371),m=()=>o(76394),g=()=>o(145046),v=()=>o(303298),C=()=>o(754697),f=()=>o(477784),S=()=>o(352723),b=()=>o(413871),y=()=>o(818369),h=()=>o(70989),P=()=>o(919536),w=()=>o(759625),M=()=>o(575015),_=()=>o(84543),I=()=>o(271674);const x=(0,o(653998).YK)({duplicatingTemplate:{id:"botActions.duplicatingTemplate.loadingMessage",defaultMessage:"Duplicating template..."},duplicatingTemplateError:{id:"botActions.duplicateTemplateAndShareWithBot.snackbar.failure",defaultMessage:"Failed to duplicate template for to your workspace"}});function A(e,t){const{environment:o,spaceStore:n,spaceRole:r}=t,a=function(e){const{name:t,spaceStore:o,userId:n,icon:r,type:a,environment:i}=e,s=Date.now(),l={name:t,created_at:s,created_by_table:p().oo,created_by_id:n,alive:!0,icon:r,space_id:o.id,last_edited_at:s,last_edited_by_id:n,last_edited_by_table:p().oo};switch(a){case"guest":return{...l,type:"guest",capabilities:e.capabilities,parent_table:d().NX,parent_id:o.id,integration_id:void 0};case"scim":return{...l,id:(0,C().Z1)({environment:i,table:c().GP,spaceId:o.id}),type:"scim",parent_table:p().oo,parent_id:n};default:(0,m().HB)(a)}}(t),i=w().eC({environment:o,table:c().GP,value:a,inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e});return P().dy({environment:o,spaceStore:n,permissionItems:[{type:"bot_permission",role:r,bot_id:i.id}],transaction:e}),{botStore:i}}function k(e){const{environment:t}=e,{serverCommitResult:o,performResult:{botStore:n}}=_().createAndCommit({userAction:"botActions.createSpaceBot",environment:t,canUndo:!0,perform:t=>A(t,e)});return{botStore:n,transactionPromise:o}}async function B(e){const{environment:t,botId:o,onSuccess:n}=e,r=await y().callApi({eventName:"deleteBot",environment:t,data:{botId:o}});"failed"===r.type?g().Qg(r):"success"===r.type&&n&&(await I().oX({environment:t}),n())}async function V(e){const{environment:t,table:o,id:r,type:a}=e,i=await y().callApi({eventName:"getBots",environment:t,data:{table:o,id:r,type:a},headers:(0,n().WS)({spaceId:o===d().NX?r:void 0})});return"failed"===i.type?(g().Qg(i),{botIds:[],recordMap:{}}):{botIds:i.data.botIds,recordMap:i.data.recordMap}}async function R(e){const{environment:t,currentSpaceStore:o,botIds:n}=e;if(!o)return;const r=await y().callApi({eventName:"getBotSharedPageIds",environment:t,data:{spaceId:o.id,botIds:n}});if("failed"!==r.type)return r.data;g().Qg(r)}async function Z(e){const{environment:t,botId:o}=e,n=await y().callApi({eventName:"getBotToken",environment:t,data:{botId:o}});if("failed"!==n.type)return n.data.token;g().Qg(n)}function T(e){const{botValue:t,store:o,environment:n}=e,{id:a,parent_id:i,parent_table:s,capabilities:c}=t,l={type:"bot_permission",bot_id:a,parent_id:i,parent_table:s,role:(0,r().MD)(c)};_().createAndCommit({userAction:"TopbarMoreButton.handleAddingConnection",environment:n,canUndo:!0,perform:e=>{P().zP({environment:n,store:o,permissionItems:[l],transaction:e})}})}function j(e){const{botId:t,store:o,environment:n}=e,r=o.getPermissionItems().filter((0,m().u0)((e=>(0,a().P3)(e)?{true:e}:{false:e})));for(const a of r)if(a.bot_id===t){const e={...a,role:"none"};_().createAndCommit({userAction:"TopbarMoreButton.handleRemovingConnection",environment:n,canUndo:!0,perform:t=>{P().zP({environment:n,store:o,permissionItems:[e],transaction:t})}})}}function H(e){const{currentSpaceStore:t,environment:o,pages:n,botStore:r,addPermission:a}=e;if(!t)return;const i=(0,S().Ws)({botStore:r,addPermission:a});n.forEach((e=>{const n=b().sk.createChildStore(t,{table:s().ev,id:e,spaceId:t.getSpaceId()});_().createAndCommit({userAction:"botActions.updateBlockPermissionsForBot",environment:o,canUndo:!0,perform:e=>{P().zP({environment:o,store:n,permissionItems:[i],transaction:e})}})}))}async function F(e){const{environment:t,spaceStore:o,botStore:n,pageIdAndOperations:r,concurrency:a=20}=e;0!==r.length&&await(0,u().lX)(r,a,(async e=>{const r=b().sk.createChildStore(o,{table:s().ev,id:e.pageId,spaceId:o.getSpaceId()}),a=(0,S().Ws)({botStore:n,addPermission:"add"===e.operationType}),{serverCommitResult:i}=_().createAndCommit({userAction:`botActions.updateBotPermissionsForPages.${e.operationType}`,environment:t,canUndo:!0,perform:e=>{P().zP({environment:t,store:r,permissionItems:[a],transaction:e})}});await i}))}async function W(e){const{environment:t,spaceStore:o,spaceViewStore:r,templatePageId:a,botValue:s,pages:d}=e;if(!o)return;const p=b().sk.createChildStore(o,{table:c().GP,id:s.id});if(a)return await async function(e){const{environment:t,spaceStore:o,spaceViewStore:r,templatePageId:a,botStore:s}=e;if(!o||!r)return;try{h().m({message:x.duplicatingTemplate});const e=await y().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:a,spaceId:(0,l().e)(void 0)},shallow:!1},headers:(0,n().WS)({recordId:a})});if("failed"===e.type)return;const c=i().RecordMapWithRole.create(e.data.subtreeRecordMap),{createAndDuplicatePageInSpace:d}=await(0,v().nd)(),{performResult:p}=_().createAndCommit({userAction:"botActions.duplicateTemplateAndShareWithBot",environment:t,canUndo:!0,perform:e=>{const n=d({environment:t,recordMap:c,copyPageId:a,isPrivate:!0,spaceStore:o,spaceViewStore:r,transaction:e,allowCopyExternalObjectInstances:!1}),i=r.getPrivatePageIds();i.length>0&&w().zv({store:r,data:{private_pages:[n.id,...i]},transaction:e});const l=(0,S().Ws)({botStore:s,addPermission:!0});return P().zP({environment:t,store:n,permissionItems:[l],transaction:e}),n}});return p}catch(c){M().D6({label:f().A.formatMessage(x.duplicatingTemplateError)})}finally{h().V()}}({environment:t,templatePageId:a,botStore:p,spaceStore:o,spaceViewStore:r});H({environment:t,currentSpaceStore:o,botStore:p,pages:d,addPermission:!0})}},162976:(e,t,o)=>{o.d(t,{$:()=>a});var n=()=>o(803290),r=()=>o(307542);function a(e){let{spaceStore:t}=e;const o=(0,n().K8)((()=>Boolean(null==t?void 0:t.getSetting("disable_people_directory"))),[t]);return(0,n().K8)((()=>(0,r().F0)()),[])&&!o}},225679:(e,t,o)=>{o.d(t,{JQ:()=>d,d5:()=>p,vt:()=>l});var n=()=>o(950635),r=()=>o(850313),a=()=>o(518797),i=()=>o(409211),s=()=>o(76394),c=()=>o(413871);function l(e){const{parentStore:t,pointer:o}=e,r=(0,c().Oo)(t,o).getValue();if(r)return(0,n().D3)({table:o.table,value:r})}function d(e){const{parentStore:t,pointer:o}=e;return o.table===a().GP?c().vK.createChildStore(t,o):o.table===i().oo?c().LU.createChildStore(t,o):o.table===r().yj?c().pH.createChildStore(t,o):void(0,s().HB)(o)}function p(e){return e.table===a().GP?(0,n().oC)(e.getValue()):e.table===i().oo?(0,n().MR)(e.getValue()):e.table===r().yj?(0,n().w2)(e.getValue()):void(0,s().HB)(e)}},279968:(e,t,o)=>{o.d(t,{h:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("globe2",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM3.88477 3.76465C4.56836 3.11523 5.39551 2.61621 6.31836 2.34277C5.83301 2.82812 5.42285 3.51172 5.11523 4.3457C4.63672 4.19531 4.22656 3.99707 3.88477 3.76465ZM9.68848 2.34961C10.6045 2.62305 11.4316 3.11523 12.1084 3.76465C11.7734 4.00391 11.3633 4.19531 10.8848 4.35254C10.5771 3.51172 10.167 2.82812 9.68848 2.34961ZM8.47852 2.56836C9.0459 2.8418 9.56543 3.58008 9.93457 4.58496C9.4834 4.66699 8.99805 4.71484 8.47852 4.73535V2.56836ZM6.06543 4.58496C6.44141 3.58008 6.9541 2.8418 7.52148 2.56836V4.73535C7.00195 4.71484 6.5166 4.66699 6.06543 4.58496ZM2.05273 7.58594C2.14844 6.42383 2.58594 5.35059 3.25586 4.46875C3.67285 4.77637 4.21289 5.04297 4.8418 5.24121C4.66406 5.95215 4.54785 6.74512 4.51367 7.58594H2.05273ZM11.4863 7.58594C11.4521 6.74512 11.3359 5.95215 11.1582 5.24121C11.7871 5.04297 12.3271 4.7832 12.7373 4.46875C13.4141 5.35059 13.8516 6.42383 13.9473 7.58594H11.4863ZM5.49121 7.58594C5.52539 6.84082 5.62793 6.12988 5.78516 5.4873C6.33203 5.59668 6.91309 5.66504 7.52148 5.69238V7.58594H5.49121ZM8.47852 7.58594V5.69238C9.08691 5.66504 9.66797 5.59668 10.2148 5.4873C10.3721 6.12988 10.4746 6.84082 10.5088 7.58594H8.47852ZM2.05273 8.54297H4.51367C4.54785 9.39746 4.66406 10.1973 4.8418 10.915C4.21973 11.1133 3.68652 11.373 3.27637 11.6807C2.59277 10.792 2.14844 9.71191 2.05273 8.54297ZM5.49121 8.54297H7.52148V10.4707C6.91992 10.498 6.33203 10.5664 5.79199 10.6689C5.62793 10.0195 5.51855 9.29492 5.49121 8.54297ZM8.47852 10.4707V8.54297H10.5088C10.4814 9.29492 10.3721 10.0195 10.208 10.6689C9.66797 10.5664 9.08691 10.498 8.47852 10.4707ZM11.1582 10.915C11.3428 10.1973 11.4521 9.39746 11.4863 8.54297H13.9473C13.8516 9.71191 13.4072 10.792 12.7236 11.6807C12.3135 11.373 11.7803 11.1133 11.1582 10.915ZM8.47852 11.4277C8.99121 11.4482 9.47656 11.4961 9.9209 11.5781C9.55176 12.5625 9.03906 13.2939 8.47852 13.5605V11.4277ZM6.0791 11.5781C6.52344 11.4961 7.00879 11.4482 7.52148 11.4277V13.5605C6.96094 13.2939 6.44824 12.5625 6.0791 11.5781ZM3.90527 12.3848C4.24023 12.1523 4.65039 11.9609 5.12207 11.8105C5.42969 12.6309 5.83301 13.3008 6.30469 13.7793C5.40234 13.5059 4.58203 13.0205 3.90527 12.3848ZM10.8779 11.8105C11.3496 11.9609 11.7598 12.1523 12.0947 12.3848C11.418 13.0205 10.5977 13.5059 9.69531 13.7793C10.167 13.3008 10.5703 12.6309 10.8779 11.8105Z"})})},389324:(e,t,o)=>{o.r(t),o.d(t,{gearIcon:()=>a,iconDefinition:()=>r});o(242343);var n=o(163643);const r={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.29 10c0 1.5 1.22 2.71 2.71 2.71 1.5 0 2.71-1.21 2.71-2.71S11.5 7.29 10 7.29 7.29 8.5 7.29 10m1.25 0c0-.81.66-1.46 1.46-1.46.81 0 1.46.65 1.46 1.46s-.65 1.46-1.46 1.46-1.46-.65-1.46-1.46"}),(0,n.jsx)("path",{d:"M8.49 17.64q.75.15 1.53.15v-.01c.47 0 .94-.04 1.41-.13.26-.05.46-.25.5-.51l.26-1.53.15-.06 1.28.91c.21.14.49.14.71 0 .41-.28.8-.61 1.18-.98.33-.33.63-.7.9-1.09.15-.21.15-.5 0-.71l-.9-1.27.06-.15 1.55-.27c.26-.05.46-.25.51-.5a7.8 7.8 0 0 0 .02-2.94.62.62 0 0 0-.51-.5l-1.53-.26-.06-.15.91-1.28c.14-.21.14-.49 0-.71a7.9 7.9 0 0 0-2.07-2.08.62.62 0 0 0-.71 0l-1.27.9-.15-.06-.27-1.55a.64.64 0 0 0-.5-.51c-.5-.1-1-.15-1.53-.15-.47 0-.95.04-1.41.13-.26.05-.46.25-.5.51l-.26 1.53-.15.06-1.28-.91a.65.65 0 0 0-.71 0 7.9 7.9 0 0 0-2.08 2.07c-.15.21-.15.5 0 .71l.9 1.27-.06.15-1.55.27c-.26.05-.46.25-.51.5-.1.5-.15 1-.15 1.53 0 .47.04.95.13 1.41.05.26.25.46.51.5l1.53.26.06.15-.91 1.28c-.14.21-.15.49 0 .71.29.42.61.81.98 1.18.34.34.7.65 1.09.91.21.15.5.15.71 0l1.27-.9.15.06.27 1.55c.05.26.25.46.5.51m2.29-1.15c-.53.07-1.09.07-1.63 0l-.25-1.47a.62.62 0 0 0-.42-.49 6 6 0 0 1-.68-.28.63.63 0 0 0-.65.04l-1.2.85a6.8 6.8 0 0 1-1.14-1.16l.86-1.21c.13-.19.15-.43.05-.64-.11-.22-.21-.45-.28-.68a.62.62 0 0 0-.49-.43l-1.45-.25a6.7 6.7 0 0 1 0-1.63l1.47-.25c.23-.04.42-.2.49-.42.07-.23.17-.46.28-.68.11-.21.09-.46-.04-.65l-.85-1.2A6.8 6.8 0 0 1 6.01 4.8l1.21.86c.19.13.43.15.64.05.22-.11.45-.21.68-.28s.39-.26.43-.49l.25-1.45c.53-.07 1.09-.07 1.63 0l.25 1.47c.04.23.2.42.42.49.23.07.46.17.68.28.21.11.46.09.65-.04l1.2-.85A6.8 6.8 0 0 1 15.19 6l-.86 1.21c-.13.19-.15.43-.05.64.11.22.21.45.28.68s.26.39.49.43l1.45.25a6.7 6.7 0 0 1 0 1.63l-1.47.25c-.23.04-.42.2-.49.42-.07.23-.17.46-.28.68-.11.21-.09.46.04.65l.85 1.2a6.8 6.8 0 0 1-1.16 1.14l-1.21-.86a.64.64 0 0 0-.64-.05c-.22.11-.45.21-.68.28s-.39.26-.43.49z"})]})},a=(0,o(680369).wt)("gear",r)},530987:(e,t,o)=>{o.d(t,{s:()=>a});o(242343);var n=()=>o(174114),r=o(163643);function a(){const e=(0,n().IS)((e=>({markerWrapper:{filter:"drop-shadow(0px 1px 6px rgba(0,0,0,0.35))"}})),[]);return(0,r.jsx)("svg",{style:e.markerWrapper,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"26",viewBox:"0 0 20 26",fill:"none",children:(0,r.jsx)("path",{d:"M10 1C14.9706 1 19 5.02944 19 10C19 12.3789 17.4727 14.8818 15.3408 17.5752C14.2851 18.909 13.1605 20.1965 12.0576 21.5293C11.3314 22.4069 10.6256 23.2945 10 24.1807C9.37437 23.2945 8.66859 22.4069 7.94238 21.5293C6.83952 20.1965 5.71493 18.909 4.65918 17.5752C2.52725 14.8818 1 12.3789 1 10C1 5.02944 5.02944 1 10 1Z",fill:"#2383E2",stroke:"white",strokeWidth:"2"})})}},534895:(e,t,o)=>{o.d(t,{V:()=>n});const n=(0,o(851552).Dv)("importFile")},583066:(e,t,o)=>{o.r(t),o.d(t,{CollectionMapView:()=>R});o(725707),o(403517),o(244387);var n=()=>o(529402),r=o.n(o(430560)),a=o(242343),i=()=>o(237385),s=()=>o(803290),c=()=>o(712437),l=()=>o(499842),d=()=>o(314164),p=()=>o(29869),u=()=>o(589704),m=()=>o(907721),g=()=>o(485966),v=()=>o(111583),C=()=>o(103151),f=()=>o(206363),S=()=>o(434498),b=()=>o(197881),y=()=>o(102659),h=()=>o(191756),P=()=>o(981927),w=()=>o(448316),M=()=>o(84543),_=()=>o(86416),I=()=>o(876695),x=()=>o(937968);function A(e){const{environment:t,geoPoint:o,collectionContextStore:n,query:r,schema:a,isFullScreen:i,store:s}=e,p="map_add_item";M().createAndCommit({userAction:"CollectionMapView.handleClick",environment:t,canUndo:!0,perform:e=>{const u=function(e){const{environment:t,transaction:o,geoPoint:n,query:r,isFullScreen:a,groupFormat:i,collectionContextStore:s,from:p}=e;if(!(0,x().EF)(t))return;const u=i?[i]:[],m=s.groupsStore.getGroupState(u);if(!m)return;s.searchQueryStore.state&&(0,_().S)({searchQuery:"",collectionContextStore:s,isFullScreen:a});const g=(0,y().Q)({environment:t,collectionContextStore:s,groupsPointer:u,shouldCoerce:!0,templateStore:s.defaultPageTemplateStore.state,transaction:o,from:{createBlock:p},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!g)return;const v=g.newStore;(function(e){const{environment:t,store:o,query:n,geoPoint:r,transaction:a}=e,{map_by:i}=n;if(!i)return;const s=o.getAssociatedCollectionStore(),c=(null==s?void 0:s.getMappedProperty(i))??i;w().R9({environment:t,store:o.getPropertyStore(c),value:(0,l().n)(r),transaction:a})})({environment:t,store:v,query:r,geoPoint:n,transaction:o}),t.device.isMobile?h().uK({environment:t,store:v,pageVisitSource:c().y8.Create}):P().VU({environment:t,store:v,peekMode:(0,d().hH)(s),resultsStore:null==m?void 0:m.resultsStore,collectionContextStore:s,pageVisitSource:c().y8.Create});return v}({environment:t,transaction:e,store:s,query:r,schema:a,geoPoint:o,isFullScreen:i,groupFormat:void 0,collectionContextStore:n,from:p});b().v(t,{from:p,type:"page",new_page_id:null==u?void 0:u.id,creating_block_id:null==u?void 0:u.id,...(0,I().sl)(n)})}})}var k=()=>o(530987),B=()=>o(8947),V=o(163643);function R(e){const{collectionContextStore:t,query:o,paddingLeft:n,paddingRight:c,format:d,renderGroupResults:p,schema:m,store:g}=e,v=(0,i().v3)(),C=(0,u().A)(!0),f=(0,a.useRef)(null),S=(0,s().K8)((()=>{var e;const n=(null==t||null===(e=t.groupsStore.getGroupState([]))||void 0===e?void 0:e.resultsStore.state)||[],r=o.map_by;return r?n.map((e=>{const t=r?e.getProperties()[r]:void 0;return(0,l().w)(t)})):[]}),[t,o.map_by]);(0,a.useEffect)((()=>{const e=S.reduce((function(e,t){return t?e.extend(t):e}),new(r().LngLatBounds));var t;e.isEmpty()||(null===(t=f.current)||void 0===t||t.getMap().fitBounds(e))}));const b=(0,a.useCallback)((e=>{const n={lat:e.lngLat.lat,lon:e.lngLat.lng};A({environment:v,geoPoint:n,collectionContextStore:t,query:o,schema:m,isFullScreen:t.isFullScreenStore.state,store:g})}),[v,t,o,m,g]);return(0,V.jsx)("div",{style:{paddingLeft:n,paddingRight:c,height:400},...C,children:(0,V.jsx)(B().S,{ref:f,initialViewState:{longitude:-100,latitude:40,zoom:3.5},onClick:b,style:{width:"100%",height:"100%",display:"flex"},children:p({disabled:!1,canDrag:!1,canDrop:!1,collectionContextStore:t,format:d,groupsPointer:[],shouldShowHoverMenu:!1,resultProps:{mapByProperty:o.map_by,disabled:!1,environment:v,collectionContextStore:t},resultComponent:Z,emptyDroppableSize:0,analyticsName:"map"})})})}function Z(e){const{mapByProperty:t,store:o,handleOpenPeekPage:r,environment:u,collectionContextStore:b}=e,y=(0,i().Y0)().isMobile,{geoPoint:h,title:P,url:w,peekUrl:M}=(0,s().K8)((()=>{const e=t?o.getProperties()[t]:void 0,n=o.getProperties().title,r=g().default.state.mainEditorCurrentBlockStore;return{geoPoint:(0,l().w)(e),title:n,url:(0,p().J8)({store:o,fullyQualified:!1,pageVisitSource:c().y8.LinkInPage}),peekUrl:(0,d().wy)({environment:u,store:o,mainEditorCurrentBlockStore:r,collectionContextStore:b,fullyQualified:!1})}}),[t,o,u,b]),_=(0,a.useCallback)((e=>(0,V.jsx)(f().yf,{store:o,events:e})),[o]);return h?(0,V.jsx)(n().pH,{longitude:h.lon,latitude:h.lat,anchor:"bottom",children:(0,V.jsx)(C().A,{originGap:6,alignment:S().C1.Center,placement:m().W.Top,renderTooltip:_,closeDelay:0,noStyle:!0,textWrap:!0,render:e=>(0,V.jsx)(v().A,{...e,style:{cursor:"pointer"},onClick:e=>{r(),e.stopPropagation()},href:w,metaHref:y?w:M,children:(0,V.jsx)(k().s,{})})})},null==P?void 0:P.toString()):null}}}]);