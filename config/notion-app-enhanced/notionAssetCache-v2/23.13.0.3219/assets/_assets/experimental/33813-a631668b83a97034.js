"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[33813],{87715:(e,t,n)=>{n.d(t,{YH:()=>s,bi:()=>a});n(362833),n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(725707),n(771702),n(403517),n(244387);var o=()=>n(34662),i=()=>n(975392),r=()=>n(402047);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const o=r().zn(n);for(const r of o){const e=i().ih(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${l({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function l(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function s(e,t){const n={text:u(e),syntax:u(t)},i=function(e){let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}(function(e,t){const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i}(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},l=[],s=e.map(o().N8A).join("");for(const[o,u]of i){const e=o+u,i=t[r.syntax],d={value:s.substring(o,e),textTokenIndex:r.text,classNames:(p=i,p&&p[1])};l.push(d);const c=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+c&&(r.text+=1,a.text+=c),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var p;return l}function u(e){return e.map((e=>e[0].length))}},291424:(e,t,n)=>{n.d(t,{y:()=>r});var o=()=>n(803290),i=()=>n(836331);function r(e){const{experimentId:t,groups:n,disableExposureLogging:r}=e,a=function(e){const{experimentId:t,disableExposureLogging:n,defaultGroup:r}=e;return(0,o().K8)((()=>i().default.getEligibleGroup({experimentId:t,defaultGroup:r??"control",disableExposureLogging:n})),[t,n,r])}({experimentId:t,disableExposureLogging:r});return n[a]}},404354:(e,t,n)=>{n.d(t,{b:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("sendArrow",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},642053:(e,t,n)=>{n.d(t,{K:()=>i});n(242343);const o={viewBox:"0 0 20 20",svg:(0,n(163643).jsx)("path",{d:"M4.78 3.524a.63.63 0 0 1 .583-.399h9.274a.625.625 0 0 1 0 1.25h-7.66l5.662 5.163a.625.625 0 0 1 0 .924l-5.663 5.163h7.661a.625.625 0 0 1 0 1.25H5.363a.625.625 0 0 1-.421-1.087L11.29 10 4.942 4.212a.625.625 0 0 1-.162-.688"})},i=(0,n(680369).wt)("formula",o)},664698:(e,t,n)=>{n.d(t,{J:()=>c});n(242343);var o=()=>n(237385),i=()=>n(404354),r=()=>n(653998),a=()=>n(356813),l=()=>n(151835),s=()=>n(103151),u=()=>n(907721),p=()=>n(759139),d=n(163643);function c(e){const t=(0,r().tz)(),{onSubmit:n,canSend:c}=e,m=(0,p().q2)(),y=(0,o().WS)(),f=t.formatMessage({id:"completions.CompletionMenuActionBar.sendTooltip",defaultMessage:"Send to AI"});return(0,d.jsx)(s().A,{renderTooltip:()=>(0,d.jsxs)("div",{children:[f,(0,d.jsx)(l().A,{style:m.keyboardShortcutInverted,name:"enter"})]}),placement:u().W.Bottom,render:e=>(0,d.jsx)(a().A,{icon:i().b,onClick:n,isPurple:c,disabled:!c,iconStyle:{height:y?24:20,width:y?24:20},ariaLabel:f,style:{pointerEvents:"auto",height:y?24:20,width:y?24:20},...e})})}},735347:(e,t,n)=>{n.d(t,{_:()=>g});n(403517);var o=n(242343),i=()=>n(427091),r=()=>n(880395),a=()=>n(34662),l=()=>n(123047),s=()=>n(975392),u=()=>n(927685),p=()=>n(284320),d=()=>n(402047),c=()=>n(477784),m=()=>n(87715),y=()=>n(836331),f=()=>n(773082),x=n(163643);function g(e){const{currentUserId:t,errorRanges:n,getPublicBaseUrlForPage:d,isAndroid:g,isMobileNative:v,isSafariOrIOS:h,isWindows:k,parentSpaceId:C,Prism:I,store:S,theme:M,valueTypes:P,textValue:T,hoveredErrorRange:A}=e,E=a().q4_(T),w="notion",F=I.languages[w],j=document.createElement("div"),D=I.highlight(E,F,w);j.innerHTML=m().bi(D);const B=s().oE(Array.from(j.childNodes).map(b));let L=T;for(const o of n)L=a().Mwp({annotation:[a().Ifu.FormulaError],selection:o,textValue:L});const R=function(e){let{syntaxTokens:t,textValue:n,store:o,parentSpaceId:r,valueTypes:s,theme:d,isAndroid:g,isSafariOrIOS:b,isWindows:v,isMobileNative:h,currentUserId:k,getPublicBaseUrlForPage:C,hoveredErrorRange:I}=e;const S=m().YH(n,t),M=n.map(a().uPN).map(((e,t)=>l().sT({annotations:e,theme:d,getRecordModel:o.getRecordModel,spaceId:r})));let P=0;return S.map(((e,t)=>{const m=n[e.textTokenIndex],S=M[e.textTokenIndex],T=e.value.length,A=P,E=P+T;P=E;let w=!1;if(I){const{startIndex:e,endIndex:t}=I;void 0!==e&&void 0!==t&&A<t&&E>e&&(w=!0)}if(a().qXl(m)){const e=[...S.classNames||[],...w?["formula-error-underline"]:[]];return(0,l().Au)({args:{textValue:{value:n,spaceId:r},getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,i().P)(),disabled:!1,isAndroid:g,isSafariOrIOS:b,isWindows:v,showEmojiInline:v,emojiType:"raw",highlightDiscussionId:void 0,theme:d,intl:c().A.getIntl(),renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:u().A.domainBaseUrl,publicDomainName:u().A.publicDomainName,currentUserId:k,getPublicBaseUrlForPage:C,externalIntegrations:f().A.integrations.state,formulaValueTypes:s,emojiData:p().A.state,isMobileNative:h,isMobileNativeExternalLinkFixEnabled:y().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0},style:S.style,classNames:e,index:t,token:m,tokenValue:a().N8A(m),tokenAnnotations:a().uPN(m)})}{const n=[e.classNames||"",...S.classNames||[],...w?["formula-error-underline"]:[]];return(0,x.jsx)("span",{className:n.join(" ").trim(),style:S.style,"data-token-index":e.textTokenIndex,children:e.value},t)}}))}({store:S,parentSpaceId:C,valueTypes:P,syntaxTokens:s().oE(B),textValue:T,theme:M,isAndroid:g,isSafariOrIOS:h,isWindows:k,isMobileNative:v,getPublicBaseUrlForPage:d,currentUserId:t,hoveredErrorRange:A}),H=(0,x.jsxs)(o.Fragment,{children:[R,(0,x.jsx)("span",{children:"\n"})]});return r().A.renderToStaticMarkup(H)}function b(e){return d().KH(e)?[e.data]:d().vq(e)?[e.textContent||"",e.className]:void 0}},819249:(e,t,n)=>{n.d(t,{v:()=>Tt});n(362833),n(725707),n(491955),n(771702),n(403517);var o=n(242343),i=()=>n(237385),r=()=>n(803290),a=()=>n(174114),l=()=>n(305948),s=()=>n(336185),u=()=>n(465546),p=()=>n(427091),d=()=>n(951592),c=()=>n(632627),m=()=>n(34662),y=()=>n(653998),f=()=>n(975392),x=()=>n(204132),g=()=>n(76394),b=()=>n(31448),v=()=>n(91472),h=()=>n(384221),k=()=>n(73631),C=()=>n(137476),I=()=>n(126996),S=()=>n(621641),M=()=>n(129978),P=()=>n(485966),T=()=>n(205670),A=()=>n(291424),E=()=>n(655830),w=()=>n(214144),F=()=>n(519423),j=()=>n(543736),D=()=>n(818369),B=()=>n(145046),L=()=>n(448316),R=()=>n(84543);var H=()=>n(531568),Y=()=>n(421338),N=()=>n(126451),_=()=>n(441292),V=()=>n(59175),U=()=>n(701270),K=n(163643);const z=o.memo((function(e){const{formulaAssistantStore:t,onStop:n,onSubmit:i}=e,l=(0,y().tz)(),{prompt:s,inputMode:u}=(0,r().K8)((()=>{const{state:e}=t;return{prompt:e.prompt,inputMode:e.inputMode}}),[t]),p=(0,o.useCallback)((()=>{i(t.state.prompt)}),[t,i]),d=(0,o.useCallback)((e=>{t.update((t=>({...t,prompt:e})))}),[t]),c=(0,a().IS)((e=>({wrapper:{borderTop:`1px solid ${e.stroke.secondary}`,background:e.popoverBackground}})),[]);return(0,K.jsx)(_().A,{capture:!0,debugName:"FormulaAssistantInput",priority:1,children:(0,K.jsxs)(Y().Y1,{direction:"horizontal",align:"top-left",gap:6,padding:"9px 12px",style:c.wrapper,children:[(0,K.jsx)(Y().Y1,{width:20,height:28,align:"center",children:(0,K.jsx)(H().iB,{})}),(0,K.jsx)(Y().Y1,{width:"fill",children:"busy"===u?(0,K.jsx)(O,{}):(0,K.jsx)(U().D,{styleName:"Body-14px/Regular",children:(0,K.jsx)(_().A,{debugName:"FormulaAssistantInput_PromptInput",capture:!0,allowMenuList:!1,allowEsc:!0,children:(0,K.jsx)(V().A,{format:V().C.Transparent,placeholder:l.formatMessage(q(u)),selectAll:!1,value:s,textarea:!0,textareaSubmitOnEnter:!0,autosize:!0,style:{minHeight:28,paddingTop:5,paddingBottom:3},onSubmit:e=>{s&&(e.stopPropagation(),p())},onChange:e=>{d(e.target.value)},focusInitial:!0})})})}),"busy"===u?(0,K.jsx)(W,{onStop:n}):(0,K.jsx)($,{onSubmit:p,isEnabled:s.length>0})]})})}));function W(e){const{onStop:t}=e,n=(0,y().tz)(),{isPhone:o}=(0,i().Y0)(),r=(0,a().IS)((e=>({lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.text.secondary,height:32,marginTop:2},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.text.tertiary,display:o?"none":void 0}})),[o]);return(0,K.jsx)(E().A,{debugName:"FormulaAssistantInput_StopButton",capture:!0,onEnter:t,onEsc:t,priority:1,children:(0,K.jsx)(Y().Y1,{width:"hug",height:28,align:"center",children:(0,K.jsxs)(N().A,{style:r.lightweightButton,onClick:t,children:[n.formatMessage(G.cancel),(0,K.jsx)("span",{style:r.keyboardShortcut,children:n.formatMessage(G.cancelShortcut)})]})})})}function $(e){const{isEnabled:t,onSubmit:o}=e;return(0,K.jsx)(Y().Y1,{width:"hug",height:28,align:"center",children:(0,K.jsx)(n(664698).J,{onSubmit:o,canSend:t})})}function O(){const e=(0,y().tz)();return(0,K.jsxs)(Y().Y1,{direction:"horizontal",gap:6,height:28,align:"center-left",children:[(0,K.jsx)(U().D,{styleName:"Body-14px/Regular",colorName:"secondary",children:e.formatMessage(G.assistantIsBusy)}),(0,K.jsx)(n(345022).A,{isTriColored:!0})]})}function q(e){switch(e){case"initial":return G.initialPlaceholder;case"followUp":case"busy":return G.subsequentPlaceholder;default:(0,g().HB)(e)}}const G=(0,y().YK)({cancel:{id:"formulaAssistantInput.cancel",defaultMessage:"Cancel"},cancelShortcut:{id:"formulaAssistantInput.cancelShortcut",defaultMessage:"esc"},initialPlaceholder:{id:"formulaAssistantInput.initialPlaceholder",defaultMessage:"What do you want the formula to do?"},subsequentPlaceholder:{id:"formulaAssistantInput.subsequentPlaceholder",defaultMessage:"What do you want to do next?"},assistantIsBusy:{id:"formulaAssistantInput.assistantIsBusy",defaultMessage:"Notion AI is writing"}});class Q extends(()=>n(129044))().default{constructor(){super(...arguments),this.hideAssistant=()=>{this.update((e=>({...e,isAssistantVisible:!1})))},this.toggleAssistantVisible=()=>{this.update((e=>({...e,isAssistantVisible:!e.isAssistantVisible})))},this.didBeginRequest=()=>{this.update((e=>({...e,inputMode:"busy"})))},this.didFinishRequest=()=>{this.update((e=>({...e,prompt:"",inputMode:"followUp"})))}}getInitialState(){return{id:w().JW(),inputMode:"initial",isAssistantVisible:!1,prompt:""}}}var J=()=>n(916963),Z=()=>n(807912),X=()=>n(86335),ee=()=>n(623972);const te={true:{name:"true",type:{type:"checkbox"},description:X().Q$.true,examples:[{input:"true"},{input:[(0,ee().Py)("Checked"),[" == true"]]}]},false:{name:"false",type:{type:"checkbox"},description:X().Q$.false,examples:[{input:"false"},{input:[(0,ee().Py)("Checked"),[" == false"]]}]},and:{name:"and",type:{type:"checkbox"},description:X().Q$.and,examples:[{input:"3 > 2 and 2 > 3",output:"false"},{input:[(0,ee().Py)("Naughty"),[" && "],(0,ee().Py)("Nice")]}]},or:{name:"or",type:{type:"checkbox"},description:X().Q$.or,examples:[{input:"3 > 2 or 2 > 3",output:"true"},{input:[(0,ee().Py)("Naughty"),[" || "],(0,ee().Py)("Nice")]}]},not:{name:"not",type:{type:"checkbox"},description:X().Q$.not,examples:[{input:"not true",output:"false"},{input:"not (2 > 3)",output:"true"},{input:[["!"],(0,ee().Py)("Checked")]}]},"+":{name:"+",type:{type:"number"},description:X().Q$["+"],examples:[{input:"3 + 2",output:"5"},{input:"add(-1, 2)",output:"1"}]},"-":{name:"-",type:{type:"number"},description:X().Q$["-"],examples:[{input:"3 - 2",output:"1"},{input:"subtract(-1, 2)",output:"-3"}]},"*":{name:"*",type:{type:"number"},description:X().Q$["*"],examples:[{input:"3 * 2",output:"6"},{input:"multiply(-1, 2)",output:"-2"}]},"/":{name:"/",type:{type:"number"},description:X().Q$["/"],examples:[{input:"3 / 2",output:"1.5"},{input:"divide(-1, 2)",output:"-0.5"}]},"%":{name:"%",type:{type:"number"},description:X().Q$["%"],examples:[{input:"3 % 2",output:"1"},{input:"mod(-1, 2)",output:"-1"}]},"^":{name:"^",type:{type:"number"},description:X().Q$["^"],examples:[{input:"3 ^ 2",output:"9"},{input:"pow(-1, 2)",output:"1"}]},"==":{name:"==",type:{type:"checkbox"},description:X().Q$["=="],examples:[{input:"3 == 2",output:"false"},{input:'equal("A", "A")',output:"true"}]},"!=":{name:"!=",type:{type:"checkbox"},description:X().Q$["!="],examples:[{input:"3 != 2",output:"true"},{input:'unequal("A", "A")',output:"false"}]},">":{name:">",type:{type:"checkbox"},description:X().Q$[">"],examples:[{input:"3 > 2",output:"true"},{input:'now() > parseDate("2040-01-01")',output:"false"}]},"<":{name:"<",type:{type:"checkbox"},description:X().Q$["<"],examples:[{input:"3 < 2",output:"false"},{input:'now() < parseDate("2040-01-01")',output:"true"}]},">=":{name:">=",type:{type:"checkbox"},description:X().Q$[">="],examples:[{input:"3 >= 2",output:"true"},{input:'now() >= parseDate("2040-01-01")',output:"false"}]},"<=":{name:"<=",type:{type:"checkbox"},description:X().Q$["<="],examples:[{input:"3 <= 2",output:"false"},{input:'now() <= parseDate("2040-01-01")',output:"true"}]}};var ne=()=>n(477784),oe=()=>n(640979),ie=()=>n(210466),re=()=>n(725460),ae=()=>n(535906),le=()=>n(273520),se=()=>n(935091),ue=()=>n(858023),pe=()=>n(88271),de=()=>n(120082);const ce=(0,y().YK)({property:{id:"formula2Input.propertyHelper.descriptionGeneric",defaultMessage:"Database property."},titlePropertyDescription:{id:"formulaLibrary.property.title.description",defaultMessage:"Title property."},textPropertyDescription:{id:"formulaLibrary.property.text.description",defaultMessage:"Text property."},urlPropertyDescription:{id:"formulaLibrary.property.url.description",defaultMessage:"URL property."},emailPropertyDescription:{id:"formulaLibrary.property.email.description",defaultMessage:"Email property."},phoneNumberPropertyDescription:{id:"formulaLibrary.property.phoneNumber.description",defaultMessage:"Phone number property."},selectPropertyDescription:{id:"formulaLibrary.property.select.description",defaultMessage:"Select property."},multiSelectPropertyDescription:{id:"formulaLibrary.property.multiSelect.description",defaultMessage:"Multi-select property, list."},statusPropertyDescription:{id:"formulaLibrary.property.status.description",defaultMessage:"Status property."},checkboxPropertyDescription:{id:"formulaLibrary.property.checkbox.description",defaultMessage:"Checkbox property."},datePropertyDescription:{id:"formulaLibrary.property.date.description",defaultMessage:"Date property."},personPropertyDescription:{id:"formulaLibrary.property.person.description",defaultMessage:"Person property, list."},relationPropertyDescription:{id:"formulaLibrary.property.relation.description",defaultMessage:"Relation property, list."},rollupPropertyDescriptionList:{id:"formulaLibrary.property.rollup.description",defaultMessage:"Rollup property, list."},rollupPropertyDescription:{id:"formulaLibrary.property.rollup.descriptionWithList",defaultMessage:"Rollup property."},numberPropertyDescription:{id:"formulaLibrary.property.number.description",defaultMessage:"Number property."},formulaPropertyDescription:{id:"formulaLibrary.property.formula.description",defaultMessage:"Formula property."},formulaPropertyDescriptionList:{id:"formulaLibrary.property.formula.descriptionWithList",defaultMessage:"Formula property, list."},createdTimePropertyDescription:{id:"formulaLibrary.property.createdTime.description",defaultMessage:"Created time property."},lastEditedTimePropertyDescription:{id:"formulaLibrary.property.lastEditedTime.description",defaultMessage:"Last edited time property."},createdByPropertyDescription:{id:"formulaLibrary.property.createdBy.description",defaultMessage:"Created by property."},lastEditedByPropertyDescription:{id:"formulaLibrary.property.lastEditedBy.description",defaultMessage:"Last edited by property."},filePropertyDescription:{id:"formulaLibrary.property.file.description",defaultMessage:"File property, list."},autoincrementIdDescription:{id:"formulaLibrary.property.autoincrementId.description",defaultMessage:"ID property."}}),me={title:{name:"title",type:{type:"text"},description:ce.titlePropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),['.style("b")']],isCopyable:!0},{input:[(0,ee().Py)("Full Name"),['.split(" ").at(0)']]}]:[{input:[(0,ee().Py)("Title")]},{input:[(0,ee().Py)("Title"),['.style("b")']]},{input:[(0,ee().Py)("Name"),['.split(" ").at(0)']]}]},text:{name:"text",type:{type:"text"},description:ce.textPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[["upper("],(0,ee().Y2)(e),[")"]],isCopyable:!0},{input:[(0,ee().Y2)(e),['.style("b", "red")']],isCopyable:!0}]:[{input:[["upper("],(0,ee().Py)("Name"),[")"]]},{input:[(0,ee().Py)("Name"),['.style("b", "red")']]}]},url:{name:"url",type:{type:"text"},description:ce.urlPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[' ? link("Link", '],(0,ee().Y2)(e),[').style("green") : ""']],isCopyable:!0}]:[{input:[(0,ee().Py)("URL"),[' ? link("Link", '],(0,ee().Py)("URL"),[').style("green") : ""']]}]},email:{name:"email",type:{type:"text"},description:ce.emailPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[' ? link("Email", "mailto:" + '],(0,ee().Y2)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,ee().Py)("Email"),[' ? link("Email", "mailto:" + '],(0,ee().Py)("Email"),[').style("blue") : ""']]}]},phone_number:{name:"phone_number",type:{type:"text"},description:ce.phoneNumberPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[' ? link("Call", "tel:" + '],(0,ee().Y2)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,ee().Py)("Email"),[' ? link("Call", "tel:" + '],(0,ee().Py)("Email"),[').style("blue") : ""']]}]},number:{name:"number",type:{type:"number"},description:ce.numberPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,ee().Y2)(e),[" ^ 2"]],isCopyable:!0}]:[{input:[(0,ee().Py)("Cost"),[" / "],(0,ee().Py)("Total Units")]},{input:[["pi() * "],(0,ee().Py)("Radius"),[" ^ 2"]]}]},select:{name:"select",type:{type:"text"},description:ce.selectPropertyDescription,examples:e=>{const t=[{input:[(0,ee().Py)("Priority"),[' == "High"']]},{input:[['["Feature", "Bug"].includes('],(0,ee().Py)("Task Type"),[")"]]}];return e&&t.unshift({input:[(0,ee().Y2)(e)],isCopyable:!0}),t}},multi_select:{name:"select",type:{type:"array",of:{type:"text"}},description:ce.multiSelectPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().Py)("Tags"),['.includes("Finance")']]}]:[{input:[(0,ee().Py)("Tags"),[".length()"]]},{input:[(0,ee().Py)("Tags"),['.includes("Finance")']]}]},status:{name:"status",type:{type:"text"},description:ce.statusPropertyDescription,examples:e=>"Status"===(null==e?void 0:e.name)?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[' == "Done"']],isCopyable:!0},{input:[['["Not started", "In progress"].includes('],(0,ee().Y2)(e),[")"]],isCopyable:!0}]:[{input:[(0,ee().Py)("Status"),[' == "Done"']]},{input:[['["Not started", "In progress"].includes('],(0,ee().Py)("Status"),[")"]]}]},checkbox:{name:"checkbox",type:{type:"checkbox"},description:ce.checkboxPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[["not "],(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Py)("Signed"),[" and "],(0,ee().Py)("Sealed"),[" and "],(0,ee().Py)("Delivered")]}]:[{input:[["not"],(0,ee().Py)("Done")]},{input:[(0,ee().Py)("Signed"),[" and "],(0,ee().Py)("Sealed"),[" and "],(0,ee().Py)("Delivered")]}]},date:{name:"date",type:{type:"date"},description:ce.datePropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[" > now()"]],isCopyable:!0},{input:[(0,ee().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[["dateBetween("],(0,ee().Y2)(e),[', now(), "days")']],isCopyable:!0}]:[{input:[(0,ee().Py)("Due Date"),[" > now()"]]},{input:[["formatDate("],(0,ee().Py)("Date"),[', "YYYY/MM/DD HH:mm")']]},{input:[["dateBetween("],(0,ee().Py)("Birthday"),[', now(), "days")']]}]},person:{name:"person",type:{type:"array",of:{type:"text"}},description:ce.personPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().Y2)(e),[".at(0)"]],isCopyable:!0},{input:[(0,ee().Y2)(e),[".map(current.email())"]],isCopyable:!0},{input:[(0,ee().Y2)(e),['.some(current.name() == "Alice")']]}]:[{input:[(0,ee().Py)("Participants"),[".at(0)"]]},{input:[(0,ee().Py)("Participants"),[".length()"]]},{input:[(0,ee().Py)("Participants"),['.some(current.name() == "Alice")']]}]},relation:{name:"relation",type:{type:"array",of:{type:"block"}},description:ce.relationPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().Py)("Tasks"),[".filter(current."],(0,ee().Py)("Status"),[' != "Done")']]}]:[{input:[(0,ee().Py)("Tasks"),[".length()"]]},{input:[(0,ee().Py)("Tasks"),[".filter(current."],(0,ee().Py)("Status"),[' != "Done")']]}]},rollup:{name:"rollup",type:e=>{if("rollup"===(null==e?void 0:e.type)&&("show_unique"===e.aggregation||void 0===e.aggregation))return{type:"array",of:{type:"unknown"}};if(e&&"aggregation"in e&&void 0!==e.aggregation){return{type:(0,de().ou)((0,de().ZP)(e.aggregation))}}return{type:"unknown"}},description:e=>"rollup"!==(null==e?void 0:e.type)||"show_unique"!==e.aggregation&&void 0!==e.aggregation?ce.rollupPropertyDescription:ce.rollupPropertyDescriptionList,examples:(e,t)=>{let n;return n=!t||"rollup"!==(null==t?void 0:t.type)||"show_unique"!==t.aggregation&&void 0!==t.aggregation?[{input:[(0,ee().Py)("Average cost"),[" * 12"]]},{input:[(0,ee().Py)("Sum of customers"),[" > 100"]]}]:[void 0!==e?{input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0}:{input:[(0,ee().Py)("Purchases"),[".length()"]]},{input:[["sum("],(0,ee().Py)("Purchases"),[".map(current."],(0,ee().Py)("Cost"),["))"]]}],e&&n.unshift({input:[(0,ee().Y2)(e)],isCopyable:!0}),n}},file:{name:"file",type:{type:"array",of:{type:"text"}},description:ce.filePropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().Y2)(e),['.filter(current.match(".pdf$"))']],isCopyable:!0},{input:[(0,ee().Y2)(e),['.map(link("File", current))']],isCopyable:!0}]:[{input:[(0,ee().Py)("Attachments"),[".length()"]]},{input:[(0,ee().Py)("Attachments"),['.filter(current.match(".pdf$"))']]},{input:[(0,ee().Py)("Attachments"),['.map(link("File", current))']]}]},formula:{name:"formula",type:e=>{var t,n,o;return e&&"formula2"in e&&null!==(t=e.formula2)&&void 0!==t&&null!==(t=t.result_type)&&void 0!==t&&t.type?e.formula2.result_type:e&&"formula"in e&&null!==(n=e.formula)&&void 0!==n&&n.result_type?{type:null===(o=e.formula)||void 0===o?void 0:o.result_type}:{type:"unknown"}},description:e=>{var t;return e&&"formula2"in e&&"array"===(null===(t=e.formula2)||void 0===t||null===(t=t.result_type)||void 0===t?void 0:t.type)?ce.formulaPropertyDescriptionList:ce.formulaPropertyDescription},examples:(e,t)=>{var n,o;let i={type:"unknown"};if(t&&"formula2"in t&&null!==(n=t.formula2)&&void 0!==n&&null!==(n=n.result_type)&&void 0!==n&&n.type)i=t.formula2.result_type;else if(t&&"formula"in t&&null!==(o=t.formula)&&void 0!==o&&o.result_type){var r;i={type:null===(r=t.formula)||void 0===r?void 0:r.result_type}}if(!e)return[];const a=[{input:[(0,ee().Y2)(e)],isCopyable:!0}];switch(i.type){case"array":switch(a.push({input:[(0,ee().Y2)(e),[".length()"]],isCopyable:!0}),i.of.type){case"text":a.push({input:[(0,ee().Y2)(e),['.join("\\n")']],isCopyable:!0});break;case"number":a.push({input:[(0,ee().Y2)(e),[".sum()"]],isCopyable:!0});break;case"date":a.push({input:[(0,ee().Y2)(e),['.map(dateBetween(now(), current, "days"))']],isCopyable:!0});break;case"person":a.push({input:[(0,ee().Y2)(e),[".map(current.name())"]],isCopyable:!0}),a.push({input:[(0,ee().Y2)(e),[".some(current.name() == 'Alice')"]],isCopyable:!0});break;case"checkbox":a.push({input:[(0,ee().Y2)(e),[".every(current == true)"]],isCopyable:!0});break;case"block":a.push({input:[(0,ee().Py)("Primary Tasks"),[".filter(current."],(0,ee().Py)("Status"),[' == "Done")']]})}break;case"number":a.push({input:[(0,ee().Y2)(e),[" * 2 > 100"]],isCopyable:!0});break;case"text":a.push({input:[(0,ee().Y2)(e),[".upper()"]],isCopyable:!0});break;case"date":a.push({input:[(0,ee().Y2)(e),[" > now()"]],isCopyable:!0});break;case"person":a.push({input:[(0,ee().Y2)(e),[".name()"]],isCopyable:!0});break;case"checkbox":a.push({input:[["not "],(0,ee().Y2)(e)],isCopyable:!0});break;case"block":a.push({input:[(0,ee().Y2)(e),[".map(current."],(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[")"]]})}return a}},created_time:{name:"created_time",type:{type:"date"},description:ce.createdTimePropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,ee().Y2)(e),[' > dateSubtract(now(), 1, "years")']],isCopyable:!0}]:[{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedTime),['.dateAdd(1, "weeks")']]},{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedTime),[' > dateSubtract(now(), 1, "years")']]}]},last_edited_time:{name:"last_edited_time",type:{type:"date"},description:ce.lastEditedTimePropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,ee().Y2)(e),[' > dateSubtract(now(), 1, "month")']],isCopyable:!0}]:[{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),['.dateAdd(1, "weeks")']]},{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),[' > dateSubtract(now(), 1, "month")']]}]},created_by:{name:"created_by",type:{type:"person"},description:ce.createdByPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".name()"]],isCopyable:!0},{input:[(0,ee().Y2)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".name()"]]},{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".email()"]]}]},last_edited_by:{name:"last_edited_by",type:{type:"person"},description:ce.lastEditedByPropertyDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),[".name()"]],isCopyable:!0},{input:[(0,ee().Y2)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".name()"]]},{input:[(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".email()"]]}]},auto_increment_id:{name:"auto_increment_id",type:{type:"number"},description:ce.autoincrementIdDescription,examples:e=>e?[{input:[(0,ee().Y2)(e)],isCopyable:!0},{input:[(0,ee().Y2)(e),['.split("-").first() /* Prefix */']],isCopyable:!0},{input:[(0,ee().Y2)(e),['.split("-").last().toNumber() /* ID */']],isCopyable:!0}]:[{input:[(0,ee().Py)("ID Code")]},{input:[(0,ee().Py)("Task ID"),['.split("-").first() /* Prefix */']],output:'"TASK"'},{input:[(0,ee().Py)("Task ID"),['.split("-").last().toNumber() /* ID */']],output:"123"}]},button:null,location:null,last_visited_time:null,verification:null,geo_point:null},ye={text:{examples:e=>e?[{input:[(0,ee().HH)({id:e.id})]},{input:[["upper("],(0,ee().HH)({id:e.id}),[")"]]},{input:[(0,ee().HH)({id:e.id}),['.style("b", "red")']]}]:[]},number:{examples:e=>e?[{input:[(0,ee().HH)(e)],isCopyable:!0},{input:[(0,ee().HH)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,ee().HH)(e),[" ^ 2"]],isCopyable:!0}]:[]},checkbox:{examples:e=>e?[{input:[(0,ee().HH)(e)]},{input:[["not "],(0,ee().HH)(e)]}]:[]},date:{examples:e=>e?[{input:[(0,ee().HH)(e)]},{input:[(0,ee().HH)(e),[" > now()"]]},{input:[(0,ee().HH)(e),['.dateAdd(1, "weeks")']]},{input:[["dateBetween("],(0,ee().HH)(e),[', now(), "days")']]}]:[]},block:{examples:e=>e?[{input:[(0,ee().HH)(e)]},{input:[(0,ee().HH)(e),[".format()"]]},{input:[(0,ee().HH)(e),["."],(0,ee().pC)(Z().FormulaTokenSupportedBlockSystemProperty.CreatedBy)]}]:[]},person:{examples:e=>e?[{input:[(0,ee().HH)(e)]},{input:[(0,ee().HH)(e),[".email()"]]},{input:[(0,ee().HH)(e),['.name() == "Alice"']]}]:[]},array:{examples:e=>e?[{input:[(0,ee().HH)(e)]},{input:[(0,ee().HH)(e),[".length()"]]},{input:[(0,ee().HH)(e),[".at(0).format()"]]}]:[]},select:null,function:null,unknown:null};var fe=()=>n(908568),xe=()=>n(169671),ge=()=>n(123047),be=()=>n(927685),ve=()=>n(211379),he=()=>n(441165),ke=()=>n(284320),Ce=()=>n(402047),Ie=()=>n(87715),Se=()=>n(863969),Me=()=>n(836331),Pe=()=>n(356813);const Te=o.memo((function(e){let{infoHelper:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const r=t;if(void 0===(null==r?void 0:r.kind))return null;switch(r.kind){case Z().FormulaEditorInfoCompletionKind.Token:return(0,K.jsx)(we,{completion:r,getRecordModel:n,style:o,typecheckContextValues:i});case Z().FormulaEditorInfoCompletionKind.LibraryFunction:{const e=Boolean(null==t?void 0:t.calledFromUnifiedFunctionProperty),i=function(e,t){if(t&&void 0!==e.syntax[1])return e.syntax[1];return e.syntax[0]}(r.libraryFunction,e),a=function(e,t){if(t&&void 0!==e.examples[1])return e.examples[1];return e.examples[0]}(r.libraryFunction,e),l=r.libraryFunction.returnType;return(0,K.jsx)(Ee,{icon:Ve("function"==typeof l?l([]).type:l.type),name:i,description:ne().A.formatMessage(r.libraryFunction.description),examples:a.length>0?a.map(((e,t)=>(0,K.jsx)(Ae,{example:e,getRecordModel:n},t))):void 0,style:o})}case Z().FormulaEditorInfoCompletionKind.Binding:var a;return r.text===Z().CURRENT_VALUE_NAME?(0,K.jsx)(Ee,{icon:Ve(r.type.type),name:r.text,description:ne().A.formatMessage(Le.currentValueDescription),style:o}):r.text===Z().CURRENT_INDEX_NAME?(0,K.jsx)(Ee,{icon:Ve(r.type.type),name:r.text,description:ne().A.formatMessage(Le.currentIndexDescription),style:o}):(0,K.jsx)(Ee,{icon:Ve(r.type.type),name:r.text,description:ne().A.formatMessage("array"===(null==r||null===(a=r.type)||void 0===a?void 0:a.type)?Le.listVariableType:Le.variableType),style:o});case Z().FormulaEditorInfoCompletionKind.Builtin:{const e=te[r.builtin];return(0,K.jsx)(Ee,{icon:Ve(e.type.type),name:e.name,description:ne().A.formatMessage(e.description),examples:e.examples.length>0?e.examples.map(((e,t)=>(0,K.jsx)(Ae,{example:e,getRecordModel:n},t))):void 0,style:o})}default:return(0,g().HB)(r)}}));function Ae(e){let{example:t,getRecordModel:n,typecheckContextValues:l}=e;const s=(0,M().fJ)(ve().y),u=(0,he().Ol)(),d=(0,i().v3)(),{device:x}=d,g=(0,Se().O)(),b=(0,a().DP)(),h=(0,y().tz)(),k=(0,ke()._)(),C=(0,r().K8)((()=>{var e;const o=document.createElement("div"),i="string"!=typeof t.input?m().q4_(t.input):t.input,r=(null===(e=s.value)||void 0===e?void 0:e.highlight(`${i}`,s.value.languages[xe().PrismLanguages.notion],xe().PrismLanguages.notion))??"";o.innerHTML=Ie().bi(r);const a=f().oE(Array.from(o.childNodes).map(De)),c="string"==typeof t.input?[[t.input],[" = "]]:t.input.concat([[" = "]]),y=Ie().YH(c,f().oE(a)),v=c.map(m().uPN).map(((e,t)=>ge().sT({annotations:e,theme:b,getRecordModel:n,spaceId:g})));return y.map(((e,t)=>{const o=v[e.textTokenIndex],i=c[e.textTokenIndex];return m().qXl(i)?(0,ge().Au)({args:{textValue:{value:c,spaceId:g},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,p().P)(),disabled:!1,isAndroid:x.isAndroid,isSafariOrIOS:x.isSafari||x.isIOS,isWindows:x.isWindows,showEmojiInline:x.isWindows,emojiType:u,highlightDiscussionId:void 0,theme:b,intl:h,renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:be().A.domainBaseUrl,publicDomainName:be().A.publicDomainName,currentUserId:d.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:l??[],emojiData:k,isMobileNative:x.isMobileNative,isMobileNativeExternalLinkFixEnabled:Me().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0},style:o.style,classNames:o.classNames,index:t,token:i,tokenValue:m().N8A(i),tokenAnnotations:m().uPN(i)}):(0,K.jsx)("span",{className:[e.classNames||"",...o.classNames].join(" "),style:o.style,"data-token-index":e.textTokenIndex,children:e.value},t)}))}),[t.input,s.value,b,n,g,x.isAndroid,x.isSafari,x.isIOS,x.isWindows,x.isMobileNative,u,h,d.currentUser.id,l,k]),I=(0,r().K8)((()=>Array.isArray(t.output)?(0,ge().S5)({textValue:{value:t.output,spaceId:g},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,p().P)(),disabled:!1,isAndroid:x.isAndroid,isSafariOrIOS:x.isSafari||x.isIOS,isWindows:x.isWindows,showEmojiInline:x.isWindows,emojiType:u,theme:b,intl:h,katex:void 0,isClient:!0,baseUrl:be().A.domainBaseUrl,publicDomainName:be().A.publicDomainName,currentUserId:d.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:k,isMobileNative:x.isMobileNative,isMobileNativeExternalLinkFixEnabled:Me().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0}):t.output),[x.isAndroid,x.isIOS,x.isSafari,x.isWindows,x.isMobileNative,k,u,d.currentUser.id,t.output,n,h,g,b]),S=!1!==t.isCopyable&&("string"==typeof t.input||!0===t.isCopyable),P=(0,o.useCallback)((async()=>{if(S){const e=(Array.isArray(t.input)?(0,c().r4)({intl:h,textValue:t.input,getRecordModel:n,userTimeZone:(0,p().P)()}):t.input).replaceAll(/\/\*.*\*\//g,"").trim();(await v().R.clipboardActions.load()).copyString({stringValue:e,environment:d,copiedMessage:Be.copiedExampleMessage})}}),[d,t.input,n,h,S]),T=(0,a().IS)((e=>({code:{fontFamily:"monospace",whiteSpaceCollapse:"preserve",fontSize:11,borderRadius:5,border:`1px solid ${e.stroke.secondary}`,margin:"0 -4px",padding:"0 6px",pointerEvents:"none",opacity:.95,display:"flex",flexDirection:"row",alignItems:"center",tabSize:2},left:{flexGrow:1,padding:"6px 0"},right:{alignSelf:"center"},copyButton:{height:22,width:22,pointerEvents:"auto"},copyButtonIcon:{height:12,width:12}})),[]);return(0,K.jsxs)("div",{style:T.code,children:[(0,K.jsxs)("div",{style:T.left,children:[(0,K.jsx)("div",{children:C}),I?(0,K.jsxs)("div",{children:["= ",I]}):null]}),S?(0,K.jsx)("div",{style:T.right,children:(0,K.jsx)(Pe().A,{ariaLabel:h.formatMessage(Be.copyToClipboard),onClick:P,icon:fe().n,style:T.copyButton,iconStyle:T.copyButtonIcon,disallowTabbing:!0})}):null]})}function Ee(e){let{name:t,icon:n,description:o,examples:i,style:r}=e;const l=(0,a().IS)((e=>({helper:{display:"flex",flexDirection:"column",fontSize:12,height:"auto",width:"100%",gap:8,overflow:"auto",textWrap:"wrap",...r},name:{fontSize:14,fontWeight:600,display:"flex",alignItems:"center"},description:{color:e.text.secondary},iconStyle:{height:14,width:14,fill:e.mediumIconColor,display:"inline",marginRight:6},examples:{display:"flex",flexDirection:"column",gap:4}})),[r]);return(0,K.jsxs)("div",{style:l.helper,children:[(0,K.jsxs)("span",{style:l.name,children:[void 0!==n&&n(l.iconStyle),t]}),void 0!==o&&(0,K.jsx)("span",{style:l.description,children:o}),void 0!==i&&(0,K.jsx)("div",{style:l.examples,children:i})]})}function we(e){let{completion:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const{name:a,description:l,icon:s,examples:p}=(0,r().K8)((()=>{if(!n)return{};if(t.token.type===Z().FormulaTokenType.BlockProperty){var e;if((0,u().ix)(t.token))return{};if(Z().FormulaTokenSupportedBlockSystemPropertyList.includes(t.token.property)&&!t.token.collection){var o;const e=null===(o=Z().FormulaTokenSupportedBlockSystemPropertyToType[t.token.property])||void 0===o?void 0:o.type,i=e?J().LE[e]:void 0,r=me[t.token.property],a="function"==typeof(null==r?void 0:r.description)?r.description():null==r?void 0:r.description,l=t.name??t.token.property;return{name:l,icon:i,description:a?ne().A.formatMessage(a):void 0,examples:null!==r?Fe(r,n,{collection:t.token.collection,property:t.token.property,name:l},{name:l,type:t.token.property}):void 0}}if(!t.token.collection)return{};const i=(0,u().Yi)(t.token.property),r=n(t.token.collection),a=null==r||null===(e=r.getNormalizedSchema())||void 0===e?void 0:e[i];if(!a)return{};const l=me[a.type];return l?{name:t.name,icon:J().LE[a.type],description:ne().A.formatMessage("function"==typeof l.description?l.description(a):l.description),examples:Fe(l,n,{collection:t.token.collection,property:i,name:t.name},a)}:{}}if(t.token.type===Z().FormulaTokenType.ContextValue){const e=(0,u()._H)(i,(0,u().GH)(t.token.valueId));if(!e||e.kind!==Z().FormulaContextValueKind.ContextValue)return{};const o=e.type.type,r=ye[o];return{name:e.name,description:e.description??e.tooltipName,icon:Ve(e.type.type),examples:null!=r&&r.examples?je(r,n,i,e):void 0}}if(t.token.type===Z().FormulaTokenType.Block||t.token.type===Z().FormulaTokenType.Checkbox||t.token.type===Z().FormulaTokenType.Date||t.token.type===Z().FormulaTokenType.Person)return{};(0,g().HB)(t.token)}),[t.name,t.token,n,i]);return void 0===a?null:(0,K.jsx)(Ee,{name:a,icon:s,description:l,examples:p,style:o})}function Fe(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(n,o).map(((e,n)=>(0,K.jsx)(Ae,{example:e,getRecordModel:t},n))):i.map(((e,n)=>(0,K.jsx)(Ae,{example:e,getRecordModel:t},n))),r.length>0?r:void 0}function je(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(o).map(((e,o)=>(0,K.jsx)(Ae,{example:e,getRecordModel:t,typecheckContextValues:n},o))):i.map(((e,o)=>(0,K.jsx)(Ae,{example:e,getRecordModel:t,typecheckContextValues:n},o))),r.length>0?r:void 0}function De(e){return Ce().KH(e)?[e.data]:Ce().vq(e)?[e.textContent||"",e.className]:void 0}const Be=(0,y().YK)({copiedExampleMessage:{id:"formula2Input.helperText.copiedExampleMessage",defaultMessage:"Copied example to clipboard!"},copyToClipboard:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),Le=(0,y().YK)({currentValueDescription:{id:"formula2Input.helperText.currentValueDescription",defaultMessage:"Returns the value of the current item in the list function."},currentIndexDescription:{id:"formula2Input.helperText.currentIndexDescription",defaultMessage:"Returns the index of the current item in the list function, starting from 0."},variableType:{id:"formula2Input.variableHelper.description",defaultMessage:"User-defined variable."},listVariableType:{id:"formula2Input.variableHelper.descriptionWithList",defaultMessage:"User-defined variable, list."}});function Re(e){const{store:t,selection:n,cursorEditorInfo:l,cursorEditorInfoRef:s,context:p,onChange:d,getRecordModel:c,setInfoHelper:y}=e,x=(0,a().IS)((()=>({menu:{top:0,left:0,right:0,bottom:0,position:"absolute",marginBottom:2},menuSection:{paddingTop:6,paddingBottom:2}})),[]),b=(0,i().Y0)(),v=(0,r().uB)(void 0,ie().A),h=(0,o.useMemo)((()=>{const e=f().$z((null==l?void 0:l.completions)??[],"kind");let o=-1;return Object.entries(e).map(((e,i)=>{const[r,a]=e,l=a.map(((e,r)=>{o+=1;const a=o;return{key:`${i}-${r}`,render:t=>(0,K.jsx)(He,{...t,completion:e,context:p,getRecordModel:c,menuListStore:v,indexGlobal:a,cursorEditorInfoRef:s,setInfoHelper:y}),action:()=>{var o;void 0!==e&&s.current&&(y({...e,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=s.current.completionsInfo)||void 0===o?void 0:o.type)}),function(e){var t;const{completion:n,store:o,selection:i,onChange:r,cursorEditorInfo:a}=e,l=(null==i?void 0:i.startIndex)||0,s=(null==i?void 0:i.endIndex)||0,p=l!==s,d=(null===(t=a.completionsInfo)||void 0===t?void 0:t.prefix)||"",c="overridePrefixLength"in n?n.overridePrefixLength??0:d.length,y=p?l:s-c,f=o.getValue();if(n.kind===Z().FormulaEditorInfoCompletionKind.Token){if(n.token.type===Z().FormulaTokenType.Checkbox)return;if(n.token.type===Z().FormulaTokenType.BlockProperty){if((0,u().ix)(n.token))return;const e=(0,m().lzV)(f,y,s),t=n.token.collection?(0,u().Yi)(n.token.property):n.token.property,o=(0,m().wmz)((0,m().ESw)({collection:n.token.collection,property:t,name:n.name}));return void r({newValue:(0,m().xym)(e,[o],y),newSelection:{startIndex:y+1,endIndex:y+1}})}if(n.token.type===Z().FormulaTokenType.ContextValue){const e=(0,m().lzV)(f,y,s),t=(0,u().GH)(n.token.valueId),o=(0,m().wmz)((0,m().CA$)({id:t}));r({newValue:(0,m().xym)(e,[o],y),newSelection:{startIndex:y+1,endIndex:y+1}})}else{if(n.token.type===Z().FormulaTokenType.Date||n.token.type===Z().FormulaTokenType.Block||n.token.type===Z().FormulaTokenType.Person)return;(0,g().HB)(n.token)}}else if(n.kind===Z().FormulaEditorInfoCompletionKind.LibraryFunction){var x,b,v,h;const e=(0,m().lzV)(f,y,s),t=(0,m().Ey_)(`${n.libraryFunction.name}()`,[]),o=(0,m().xym)(e,[t],y);let i=y+n.libraryFunction.name.length+1;void 0!==(null===(x=n.libraryFunction)||void 0===x||null===(x=x.parameters)||void 0===x?void 0:x.varargs)||null!==(b=n.libraryFunction)&&void 0!==b&&null!==(b=b.parameters)&&void 0!==b&&null!==(b=b.expected)&&void 0!==b&&b.length&&(1!==(null===(v=n.libraryFunction)||void 0===v||null===(v=v.parameters)||void 0===v||null===(v=v.expected)||void 0===v?void 0:v.length)||"member dot receiver"!==(null===(h=a.completionsInfo)||void 0===h?void 0:h.type))||(i+=1);r({newValue:o,newSelection:{startIndex:i,endIndex:i}})}else if(n.kind===Z().FormulaEditorInfoCompletionKind.Binding||n.kind===Z().FormulaEditorInfoCompletionKind.Builtin){const e=(0,m().lzV)(f,y,s),t=n.kind===Z().FormulaEditorInfoCompletionKind.Binding?n.text:`${n.builtin} `,o=(0,m().Ey_)(t,[]),i=(0,m().xym)(e,[o],y),a=y+t.length;r({newValue:i,newSelection:{startIndex:a,endIndex:a}})}else(0,g().HB)(n)}({completion:e,store:t,selection:n,onChange:d,cursorEditorInfo:s.current}))}}}));return{key:r,render:e=>(0,K.jsx)(pe().A,{...e,style:x.menuSection,title:ne().A.formatMessage(ze[r])}),items:l}}))}),[p,null==l?void 0:l.completions,s,c,v,d,n,y,t,x.menuSection]),k=(0,o.useCallback)((e=>{var t;if(b.isMobile)return;const n=void 0!==e.indexGlobal?null===(t=s.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[e.indexGlobal]:void 0;var o;n&&y({...n,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=s.current)||void 0===o||null===(o=o.completionsInfo)||void 0===o?void 0:o.type)})}),[s,b.isMobile,y]);let C;return(0,o.useEffect)((()=>{if(b.isMobile)return;const e=e=>{var t,n;if(void 0!==e.state.focus.indexGlobal&&null!==(t=s.current)&&void 0!==t&&t.completions&&(null===(n=s.current)||void 0===n?void 0:n.completions.length)>0){var o;const t=null===(o=s.current)||void 0===o||null===(o=o.completions)||void 0===o?void 0:o[e.state.focus.indexGlobal];void 0!==t&&y((e=>{var n;return void 0===e||void 0===(null===(n=s.current)||void 0===n?void 0:n.callParameter)?t:e}))}};return v.addListener(e),()=>v.removeListener(e)}),[s,v,y,b.isMobile]),(0,o.useEffect)((()=>{var e,t,n,o;if(b.isMobile)return;const i="function"===(null==l||null===(e=l.callParameter)||void 0===e||null===(e=e.expression)||void 0===e||null===(e=e.type)||void 0===e?void 0:e.type)?null===(t=l.callParameter.expression)||void 0===t?void 0:t.type:void 0;void 0!==i&&void 0!==(null==l||null===(n=l.callParameter)||void 0===n?void 0:n.parameterIndex)&&(null==l||null===(o=l.callParameter)||void 0===o?void 0:o.parameterIndex)>-1&&y({kind:Z().FormulaEditorInfoCompletionKind.LibraryFunction,libraryFunction:i.libraryFunction,calledFromUnifiedFunctionProperty:i.calledFromUnifiedFunctionProperty})}),[null==l?void 0:l.callParameter,b.isMobile,y]),(0,o.useEffect)((()=>{h.length>0&&v.update((e=>({focus:{...e,section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})))}),[h.length,v,y]),C=b.isPhone?{menuType:oe().gu.ActionSheet,disableBottomPadding:!0,maxHeight:"100%"}:{menuType:oe().gu.Popup,width:b.isPhone?180:228,minWidth:b.isPhone?180:228,maxWidth:b.isPhone?180:228},(0,K.jsx)(se().A,{...C,scrollerStyle:x.menu,children:(0,K.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:0,priority:1,store:v,onKeyboardArrow:k,sections:f().oE([...h,0===h.length&&{key:"no-results",render:e=>(0,K.jsx)(pe().A,{...e,disableDesktopPadding:!0,style:x.menuSection,children:(0,K.jsx)(Ue,{})}),items:[]}])})})}const He=o.forwardRef((function(e,t){const{completion:l,context:s,getRecordModel:p,menuListStore:d,indexGlobal:c,cursorEditorInfoRef:m,setInfoHelper:f,onMouseEnter:x,...b}=e,v=(0,i().Y0)(),h=(0,a().IS)((e=>({icon:{width:14,fill:e.mediumIconColor},lightParens:{color:e.text.tertiary}})),[]),k=(0,o.useCallback)((e=>{if(!v.isMobile){var t;const e=null===(t=m.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[c];f(e)}null==x||x(e)}),[m,c,x,f,v.isMobile]),C=(0,r().K8)((()=>d.state.focus.indexGlobal===c),[d,c]),I=(0,o.useMemo)((()=>v.isMobile?(0,K.jsx)(le().Ay,{popupType:le().z7.SlideUp,renderOrigin:e=>(0,K.jsx)(N().A,{mobileFeedback:!0,style:{width:16,height:16},...e,children:(0,n(484136).x)(h.icon)}),render:e=>{var t;let o;return o=v.isMobile?{menuType:oe().gu.Modal,title:(0,K.jsx)(y().sA,{defaultMessage:"Documentation",id:"database.formulaPropertyEntryMenuItem.title"}),right:(0,K.jsx)(n(743668).DoneMenuText,{}),onClickRight:e.close}:{menuType:oe().gu.Popup},(0,K.jsx)(se().A,{...o,children:(0,K.jsx)(pe().A,{children:(0,K.jsx)(n(932322).Ay,{title:(0,K.jsx)(Te,{infoHelper:{...l,calledFromUnifiedFunctionProperty:"member dot receiver"===(null==m||null===(t=m.current)||void 0===t||null===(t=t.completionsInfo)||void 0===t?void 0:t.type)},getRecordModel:p,style:{padding:4},typecheckContextValues:s.valueTypes}),style:{paddingTop:16,paddingBottom:16}})})})}}):(0,K.jsx)(Ye,{visible:C})),[l,s.valueTypes,m,v.isMobile,p,C,h.icon]),S=(0,r().K8)((()=>{var e;if(l.kind!==Z().FormulaEditorInfoCompletionKind.Token||l.token.type!==Z().FormulaTokenType.BlockProperty||!p)return;if(Z().FormulaTokenSupportedBlockSystemPropertyList.includes(l.token.property))return l.token.property;if((0,u().ix)(l.token)||!l.token.collection)return;const t=(0,u().Yi)(l.token.property),n=p(l.token.collection);return null==n||null===(e=n.getNormalizedSchema())||void 0===e||null===(e=e[t])||void 0===e?void 0:e.type}),[l,p]);if(l.kind===Z().FormulaEditorInfoCompletionKind.Token){if(l.token.type===Z().FormulaTokenType.Checkbox)return null;if(l.token.type===Z().FormulaTokenType.BlockProperty)return(0,K.jsx)(ae().A,{...b,icon:S?J().LE[S](h.icon):(0,K.jsx)(Ne,{type:"unknown"}),title:l.name??l.token.property,right:I,onMouseEnter:k,ref:t});if(l.token.type===Z().FormulaTokenType.ContextValue){const e=(0,u().IV)(s.valueTypes,(0,u().GH)(l.token.valueId));return e?(0,K.jsx)(ae().A,{...b,icon:(0,K.jsx)(_e,{contextValue:e}),title:(0,K.jsx)("div",{style:{display:"flex"},children:e.name}),right:I,onMouseEnter:k,ref:t}):null}if(l.token.type===Z().FormulaTokenType.Date)return null;if(l.token.type===Z().FormulaTokenType.Block)return null;if(l.token.type===Z().FormulaTokenType.Person)return null;(0,g().HB)(l.token)}else{if(l.kind===Z().FormulaEditorInfoCompletionKind.LibraryFunction){const e=l.libraryFunction.returnType;return(0,K.jsx)(ae().A,{...b,icon:(0,K.jsx)(Ne,{type:"function"==typeof e?e([]).type:e.type}),title:(0,K.jsxs)(K.Fragment,{children:[l.libraryFunction.name,(0,K.jsx)("span",{style:h.lightParens,children:"()"})]}),right:I,onMouseEnter:k,ref:t})}if(l.kind===Z().FormulaEditorInfoCompletionKind.Builtin)return(0,K.jsx)(ae().A,{...b,title:l.builtin,icon:(0,K.jsx)(Ne,{type:te[l.builtin].type.type}),right:I,onMouseEnter:k,ref:t});if(l.kind===Z().FormulaEditorInfoCompletionKind.Binding)return(0,K.jsx)(ae().A,{...b,title:l.text,icon:(0,K.jsx)(Ne,{type:l.type.type}),right:I,onMouseEnter:k,ref:t});(0,g().HB)(l)}})),Ye=o.memo((function(e){let{visible:t}=e;const o=(0,a().IS)((e=>({icon:{width:14,fill:e.mediumIconColor,transition:"opacity 50ms 200ms",visibility:t?"visible":"hidden",opacity:t?1:0}})),[t]);return(0,n(52223).K)(o.icon)})),Ne=o.memo((function(e){var t;let{type:n}=e;const o=(0,a().IS)((e=>({icon:{width:14,fill:e.mediumIconColor,transition:"transform .3s ease"}})),[]);return null===(t=Ve(n))||void 0===t?void 0:t(o.icon)}));function _e(e){const{contextValue:t}=e,o=(0,a().IS)((e=>({stepNumber:{color:e.mediumIconColor}})),[]);return(0,g().O9)(t.stepNumberForDisplay)?(0,K.jsx)(n(822606).Q,{size:n(303472).H.Small,number:t.stepNumberForDisplay,style:o.stepNumber}):(0,K.jsx)(Ne,{type:t.type.type})}function Ve(e){return"text"===e?J().LE.text:"number"===e?J().LE.number:"checkbox"===e?J().LE.checkbox:"date"===e?J().LE.date:"block"===e?J().LE.relation:"person"===e?J().LE.person:"select"===e?J().LE.select:"array"===e?J().LE.multi_select:"function"===e||void 0===e||"unknown"===e?J().LE.formula:void(0,g().HB)(e)}function Ue(){return(0,K.jsx)(re().A,{caption:(0,K.jsx)(y().sA,{defaultMessage:"No results",id:"FormulaAutocompleteMenu.noResults.message"})})}const Ke=(0,y().YK)({[Z().FormulaEditorInfoCompletionKind.Token]:{defaultMessage:"Properties",id:"formulaAutocompleteMenu.token.message"},[Z().FormulaEditorInfoCompletionKind.LibraryFunction]:{defaultMessage:"Functions",id:"formulaAutocompleteMenu.function.message"},[Z().FormulaEditorInfoCompletionKind.Binding]:{defaultMessage:"Variables",id:"formulaAutocompleteMenu.variables.message"},[Z().FormulaEditorInfoCompletionKind.Builtin]:{defaultMessage:"Built-ins",id:"formulaAutocompleteMenu.builtin.message"}}),ze={[Z().FormulaEditorInfoCompletionKind.Token]:Ke[Z().FormulaEditorInfoCompletionKind.Token],[Z().FormulaEditorInfoCompletionKind.LibraryFunction]:Ke[Z().FormulaEditorInfoCompletionKind.LibraryFunction],[Z().FormulaEditorInfoCompletionKind.Binding]:Ke[Z().FormulaEditorInfoCompletionKind.Binding],[Z().FormulaEditorInfoCompletionKind.Builtin]:Ke[Z().FormulaEditorInfoCompletionKind.Builtin]};var We=()=>n(907721),$e=()=>n(209684),Oe=()=>n(951540),qe=()=>n(103151);const Ge={height:24,padding:"0 8px"},Qe=(0,y().YK)({accept:{defaultMessage:"Accept",id:"database.formula.acceptFormulaInput.tooltip"},cancel:{defaultMessage:"Cancel",id:"formulas.formulaInputHeader.cancel"},close:{id:"formula2Input.close",defaultMessage:"Close"},save:{id:"formula2Input.save",defaultMessage:"Save"},formulaHeader:{id:"formula2Input.NotionFormula",defaultMessage:"Notion Formula"},learnTooltip:{id:"formula2Input.learnAboutFormulas",defaultMessage:"Learn about formulas!"},revert:{id:"formula2Input.revert",defaultMessage:"Revert"},revertTooltip:{id:"formula2Input.revertTooltip",defaultMessage:"Revert to previous formula"},askAi:{id:"formulas.formulaInputHeader.askAi",defaultMessage:"Ask AI"}}),Je=o.memo((function(e){const{disabled:t,onClickAssistant:n,onClickCancel:o,onClickClose:i,onClickRevert:r,isAssistantVisible:l}=e,s=(0,a().IS)((e=>({headerRow:{color:e.text.secondary,flexWrap:"wrap",fontWeight:500,fontSize:14}})),[]),u=!t&&!l;return(0,K.jsxs)(Y().Y1,{direction:"horizontal",padding:"10px 12px 0 12px",style:s.headerRow,children:[o&&!t?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Y().Y1,{width:"hug",children:(0,K.jsx)(Xe,{onClick:o})}),(0,K.jsx)(Y().Y1,{width:"fill"})]}):(0,K.jsx)(Y().Y1,{width:"fill",children:(0,K.jsx)(nt,{})}),(0,K.jsxs)(Y().Y1,{width:"hug",direction:"horizontal",gap:6,align:"center",children:[r&&!t?(0,K.jsx)(ot,{onClick:r}):null,u?(0,K.jsx)(A().y,{experimentId:"formula_assistant",groups:{on:(0,K.jsx)(Ze,{onClick:n}),control:null}}):null,t?(0,K.jsx)(et,{onClick:i}):(0,K.jsx)(tt,{onClick:i})]})]})}));function Ze(e){const{onClick:t}=e,n=(0,y().tz)(),o=(0,a().IS)((()=>({label:{marginLeft:6,marginRight:2}})),[]),i=n.formatMessage(Qe.askAi);return(0,K.jsxs)($e().p,{"aria-label":i,size:"sm",onClick:t,children:[(0,K.jsx)(H().iB,{}),(0,K.jsx)("span",{style:o.label,children:i})]})}function Xe(e){const{onClick:t}=e,n=(0,y().tz)();return(0,K.jsx)($e().p,{isGray:!0,size:"sm",onClick:t,children:n.formatMessage(Qe.cancel)})}function et(e){const{onClick:t}=e,n=(0,y().tz)();return(0,K.jsx)(Oe().A,{onClick:t,style:Ge,children:n.formatMessage(Qe.close)})}function tt(e){const{onClick:t}=e,o=(0,i().v3)(),r=(0,y().tz)(),l=(0,a().IS)((e=>({commandText:{color:e.text.contrastSecondary}})),[]);return(0,K.jsx)(qe().A,{renderTooltip:()=>(0,K.jsxs)("div",{children:[(0,K.jsx)("span",{children:r.formatMessage(Qe.accept)})," ",(0,K.jsxs)("span",{style:l.commandText,children:[(0,n(318394)._w)({environment:o}).command,"+Enter"]})]}),render:e=>(0,K.jsx)(Oe().A,{onClick:t,style:Ge,...e,children:r.formatMessage(Qe.save)})})}function nt(){const e=(0,y().tz)(),t=(0,a().IS)((()=>({headerTitle:{fontSize:12,display:"flex",alignItems:"center"},helpButton:{marginLeft:2,height:20,width:20}})),[]);return(0,K.jsxs)("span",{style:t.headerTitle,children:[e.formatMessage(Qe.formulaHeader),(0,K.jsx)(qe().A,{placement:We().W.Top,render:o=>(0,K.jsx)(Pe().A,{...o,ariaLabel:e.formatMessage(Qe.learnTooltip),icon:n(284594).$,href:(0,n(392608).xS)("guides.formulas"),external:!0,style:t.helpButton}),renderTooltip:()=>e.formatMessage(Qe.learnTooltip)})]})}function ot(e){const{onClick:t}=e,n=(0,y().tz)(),o=(0,a().IS)((e=>({revertButton:{color:e.mediumIconColor}})),[]);return(0,K.jsx)(qe().A,{placement:We().W.Top,render:e=>(0,K.jsx)($e().p,{...e,"aria-label":n.formatMessage(Qe.revertTooltip),isGray:!0,size:"sm",style:o.revertButton,onClick:t,children:n.formatMessage(Qe.revert)}),renderTooltip:()=>n.formatMessage(Qe.revertTooltip)})}n(358848),n(91270),n(113085);var it=()=>n(752597),rt=()=>n(269280),at=()=>n(829090),lt=()=>n(199001),st=()=>n(399309),ut=()=>n(92898),pt=()=>n(117041),dt=()=>n(190217),ct=()=>n(654548),mt=()=>n(594528),yt=()=>n(486881),ft=()=>n(196387),xt=()=>n(112907),gt=()=>n(618985),bt=()=>n(680719),vt=()=>n(735347);const ht={borderRadius:4,flexGrow:1,flexShrink:1,fontFamily:b().vc(n(16791).locale).githubMono,fontSize:12,height:"100%",minHeight:"1em",paddingBlock:"11px 10px",paddingInline:"12px 13px",tabSize:2,textAlign:"left",whiteSpace:"pre-wrap",wordBreak:"break-all"},kt=(0,y().YK)({formulaPlaceholder:{id:"formulas.formulaPlaceholder",defaultMessage:"Your formula"}});function Ct(e){const{analyticsContext:t,clipboardActions:n,disabled:l,errorRanges:s,focus:u,formulasModule:p,handleSave:d,markdownLinkifyIt:c,parentSpaceId:y,Prism:x,store:g,tinyMceMicrosoftWordPasteFilter:b,valueTypes:v,hoveredErrorRange:k}=e,C=(0,o.useRef)(null),I=(0,a().DP)(),M=(0,i().v3)(),P=(0,r().K8)((()=>{var e;const t=T().default.state;return"editing"===t.mode&&(null===(e=(0,S().H7)(t.multiSelection))||void 0===e?void 0:e.store)===g}),[g]),A=(0,o.useCallback)((()=>{var e;return(null===(e=C.current)||void 0===e?void 0:e.getNode())||void 0}),[C]),E=(0,r().K8)((()=>g.getValue()||[]),[g],{debugName:"FormulaInputText.textValueStore"}),w=(0,o.useCallback)((()=>{var e;return null===(e=A())||void 0===e?void 0:e.blur()}),[A]),F=(0,o.useCallback)((()=>{const e=at().PE(m().q4_(E));return{endIndex:e.length,startIndex:e.length}}),[E]),j=(0,o.useCallback)((()=>{if(P)return(0,yt().Do)(g)}),[P,g]),D=(0,o.useCallback)((()=>{const e=window.getSelection();null!=e&&e.rangeCount&&it().default.afterNextFlush((()=>{var t;const n=e.getRangeAt(0).getClientRects()[0],o=null===(t=A())||void 0===t||null===(t=t.parentElement)||void 0===t?void 0:t.parentElement,i=null==o?void 0:o.getBoundingClientRect();n&&o&&i&&(i.top>=n.top?o.scrollTo({top:o.scrollTop+(n.top-i.top)-6}):i.bottom<=n.bottom+n.height&&o.scrollTo({top:o.scrollTop+(n.bottom-i.bottom)+28}))}))}),[A]),B=(0,o.useCallback)((e=>{ct().HP({canEdit:!l,editorNode:A(),environment:M,event:e,store:g,textValue:E})}),[M,E,A,g,l]),H=(0,o.useCallback)((e=>{if(l)return;const t=T().default.state;"editing"===t.mode&&t.multiSelection.start.store===g&&(R().createAndCommit({userAction:"FormulaInputText.handleDelete",environment:M,canUndo:!0,perform:n=>{ut().wT({environment:M,multiSelection:t.multiSelection,deleteForwards:!0,transaction:n,event:e,editorMode:"default"})}}),D())}),[l,M,D,g]),Y=(0,o.useCallback)((e=>{if(l)return;const t=T().default.state;if("editing"===t.mode&&t.multiSelection.start.store===g){if(ut().CZ({device:M.device,event:e,multiSelection:t.multiSelection}))return;R().createAndCommit({userAction:"FormulaInputText.handleBackspace",environment:M,canUndo:!0,perform:n=>{ut().wT({environment:M,multiSelection:t.multiSelection,deleteForwards:!1,transaction:n,event:e,editorMode:"default"})}}),D()}}),[l,M,D,g]),N=(0,o.useCallback)((e=>{var t,n,o;if(l)return;if(null===(t=e.preventDefault)||void 0===t||t.call(e),C.current&&C.current.isComposing())return;const i=T().default.state,r="editing"===i.mode&&(0,S().H7)(i.multiSelection);if(!r)return;const a=at().PE(m().q4_(E)),s=null===(n=a.slice(0,r.selection.startIndex).join("").split("\n"))||void 0===n?void 0:n.at(-1),u=(null==s||null===(o=s.match(/^\t*/))||void 0===o?void 0:o[0].length)||0,p=(null==s?void 0:s.split("").reverse())||[];let d=0;const c=p.some((e=>{if(")"===e)d++;else if("("===e){if(0===d)return!0;d--}return!1}))?u+1:u;let y="\t".repeat(c);const f=")"===a[r.selection.endIndex],x=Boolean(null==s?void 0:s.endsWith("("))&&f;x&&(y+=`\n${"\t".repeat(c-1)}`),R().createAndCommit({userAction:"FormulaInputText.handleShiftEnter",environment:M,canUndo:!0,perform:e=>{L().$D({environment:M,editorMode:"default",store:g,string:`\n${y}`,selection:r.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e}),x&&h().setSelection({store:g,selection:{startIndex:r.selection.startIndex+c+1,endIndex:r.selection.startIndex+c+1}})}}),D()}),[l,M,D,g,E]),V=(0,o.useCallback)((e=>{var t;const o=window.getSelection();null!=o&&o.anchorNode&&null!==(t=A())&&void 0!==t&&t.contains(o.anchorNode)&&n.copy({environment:M,event:e,markdownLinkifyIt:c})}),[M,A,c,n]),U=(0,o.useCallback)((e=>{l?e.preventDefault():(n.cutWithMaybeConfirmation({environment:M,event:e,markdownLinkifyIt:c}),D())}),[l,M,D,c,n]),z=(0,o.useCallback)((e=>{l?e.preventDefault():(R().createAndCommit({userAction:"FormulaInputText.handlePaste",environment:M,canUndo:!0,perform:t=>{n.paste({environment:M,event:e,disableEmbedMenu:!0,transaction:t,onPasteFiles:n.pasteFilesForBlocks,formulasModule:p,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:b})}}),D())}),[l,M,D,c,b,p,n]),W=(0,o.useCallback)((e=>{ct().sp({environment:M,event:e,textValue:E,editorNode:A(),store:g,canEdit:!l})}),[M,E,A,g,l]),$=(0,o.useCallback)((e=>{ct().W5({environment:M,event:e,textValue:E,editorNode:A(),store:g,canEdit:!l})}),[M,E,A,g,l]),O=(0,o.useCallback)((e=>{l||e.preventDefault()}),[l]),q=(0,o.useCallback)((e=>{R().createAndCommit({userAction:"FormulaInputText.handleMoveUp",environment:M,canUndo:!0,perform:e=>{L().$P({environment:M,transaction:e,direction:"up"})}})}),[M]),G=(0,o.useCallback)((e=>{R().createAndCommit({userAction:"FormulaInputText.handleMoveDown",environment:M,canUndo:!0,perform:e=>{L().$P({environment:M,transaction:e,direction:"down"})}})}),[M]),Q=(0,o.useCallback)((e=>{var t;e.preventDefault&&e.preventDefault();const n=st().li();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===g.id&&st().tN({environment:M})}),[M,g.id]),J=(0,o.useCallback)((e=>{var t;e.preventDefault&&e.preventDefault();const n=st().Bl();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===g.id&&st().ZS({environment:M})}),[M,g.id]),Z=(0,o.useCallback)((e=>{if(l)return;e.preventDefault();const t=T().default.state,n="editing"===t.mode&&(0,S().H7)(t.multiSelection);n&&R().createAndCommit({userAction:"FormulaInputText.handleTab",environment:M,canUndo:!0,perform:e=>{L().RJ({environment:M,store:g,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[l,M,g]),X=(0,o.useCallback)((e=>{if(l)return;e.preventDefault();const t=T().default.state,n="editing"===t.mode&&(0,S().H7)(t.multiSelection);n&&R().createAndCommit({userAction:"FormulaInputText.handleUntab",environment:M,canUndo:!0,perform:e=>{L().Ye({environment:M,store:g,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[l,M,g]),ee=(0,o.useCallback)((e=>{const{newValue:o}=e;ft().default.measureAfterNextFlush({metricName:"formulas_typing_lag",startTime:performance.now()},{environment:M,getData:()=>t}),R().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:M,canUndo:!0,perform:e=>{L().dw({environment:M,editorMode:"default",store:g,newValue:o,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{R().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:M,canUndo:!0,perform:e=>{L().wu({clipboardActions:n,formulasModule:p,store:g,transaction:e})}})}))}})}),[t,M,p,g,n]),te=(0,o.useCallback)(((e,t)=>{let{leafRef:n,wrapperRef:o,...i}=e;const{device:r}=M,a=E.length>0;return(0,K.jsxs)("div",{ref:o,...i,onKeyDown:e=>{!function(e,t,n){(0,mt().A)(n,e,"command+enter")&&(t(),e.stopPropagation())}(e,d,M),null==i||i.onKeyDown(e)},style:{flexGrow:1,display:"table",position:"relative"},children:[(0,K.jsx)(St,{hasText:a}),(0,K.jsx)(gt().A,{leafRef:(0,lt().Px)(C,n),style:ht,isDisabled:l,debugName:"FormulaInputText",store:g,getHtml:()=>(0,vt()._)({currentUserId:M.currentUser.id,errorRanges:s,hoveredErrorRange:k,getPublicBaseUrlForPage:xt().SN(M),isAndroid:r.isAndroid,isMobileNative:r.isMobileNative,isSafariOrIOS:r.isSafari||r.isIOS,isWindows:r.isWindows,parentSpaceId:y,Prism:x,store:g,textValue:E,theme:I,valueTypes:v}),getSelection:j,onMutation:ee,spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:W,onMouseOut:$,suppressNewlineEvents:!1,expandSelectionOnTripleClick:!0,placeholder:" "})]})}),[M,E,j,ee,W,$,d,l,s,y,x,g,I,v,k]),ne=(0,o.useCallback)((()=>{u&&h().setSelectionAtEnd({store:g})}),[u,g]);return(0,rt().l)(ne),(0,K.jsxs)(_().A,{debugName:"FormulaInputText",capture:!0,allowEnter:!0,allowTabUntab:!0,allowUndo:!0,allowEsc:!0,allowCopyPaste:!0,children:[" ",(0,K.jsx)(bt().F,{store:g,disabled:l,clearBrowserSelection:w,getEndSelection:F,onBlur:w,onClick:B,onDelete:H,onBackspace:Y,onShiftEnter:N,onCommandShiftEnter:f().D_,onTab:Z,onUntab:X,onToggleBold:O,onToggleItalics:O,onToggleUnderline:O,onToggleStrike:O,onToggleCode:f().D_,onCopy:V,onCut:U,onPaste:z,onMoveUp:q,onMoveDown:G,onUndo:Q,onRedo:J,onEsc:d,render:te,disableStyleAnnotations:!0,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!1,canInsertText:!0,canSelectionDrag:!0,disableMobileActionBar:!0,topBottomPadding:40,pasteBehavior:"inline"})]})}function It(e){const{value:t}=(0,M().fJ)(ve().y),{value:n}=(0,M().fJ)(pt().g),{value:o}=(0,M().fJ)(dt().S),{value:i}=(0,M().fJ)(k().T.formulas),{value:r}=(0,M().fJ)(v().R.clipboardActions);return t&&i&&r?(0,K.jsx)(Ct,{...e,Prism:t,clipboardActions:r,formulasModule:i,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function St(e){const{hasText:t}=e,n=(0,y().tz)();return(0,K.jsx)(Y().Y1,{direction:"horizontal",gap:8,padding:"10px 12px",style:{position:"absolute",inset:0,pointerEvents:"none",userSelect:"none"},children:t?null:(0,K.jsx)(Y().Y1,{height:20,align:"center-left",children:(0,K.jsx)(U().D,{colorName:"quaternary",styleName:"Body-14px/Regular",children:n.formatMessage(kt.formulaPlaceholder)})})})}Ct.displayName="FormulaInputText";const Mt=!1,Pt=400;function Tt(e){const{evaluationErrors:t,initialCode:n,parentSpaceId:b,outputFooter:H,disabled:Y,typecheckContext:N,formulas:_,handleCancel:V,onCodeChange:U,onTypeChange:W,parentCollectionStore:$,handleClose:O,getRecordModel:q}=e,G=(0,y().tz)(),J=(0,i().Y0)(),Z=(0,i().v3)(),{value:X}=(0,M().fJ)(k().T.formulaEditor),[ee,te]=(0,o.useState)(void 0),ne=(0,o.useCallback)((e=>{te(e)}),[]),oe=(0,o.useCallback)((()=>{te(void 0)}),[]),ie=(0,o.useMemo)((()=>$?{collection_id:[[$.id]]}:void 0),[$]),{store:re,setValue:ae}=(0,I().AI)({initialValue:n,onChange:U,source:"formula",properties:ie}),le=(0,o.useCallback)((e=>{if(ae(e.newValue),e.newSelection){const t={start:{store:re,index:e.newSelection.startIndex},end:{store:re,index:e.newSelection.endIndex}};h().setMultiSelection({multiSelection:t})}}),[ae,re]),se=(0,r().K8)((()=>{var e;const t=T().default.state;if("editing"===t.mode&&(null===(e=(0,S().H7)(t.multiSelection))||void 0===e?void 0:e.store)===re)return{startIndex:t.multiSelection.start.index,endIndex:t.multiSelection.end.index}}),[re],{useDeepEqual:!0}),ue=(0,r().K8)((()=>re.getValue()),[re]),pe=(0,o.useMemo)((()=>!f().n4(ue,n)),[ue,n]),[de,ce]=(0,r().K8)((()=>!ue||I().Pe?[void 0,void 0]:_.processFormulaInput(ue)),[ue,_]),me=(0,r().K8)((()=>{if(de)return _.parseFormulaInputToCst(de,ce)}),[de,_,ce]),ye=(0,r().K8)((()=>{if(me)return _.convertFormulaCSTToAST(me[0])}),[_,me]),[fe,xe]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{!async function(){if(ye&&N&&x().Q.isSuccess(ye)){const e=await _.addTypesToFormulaASTAsync(ye.value,N,ce);xe(e),null==W||W(e.node.type)}else xe(void 0)}()}),[ye,N,ce,me,_,W]);const ge=(0,o.useMemo)((()=>void 0!==fe?[...(0,u().KH)(fe.node,!1),...fe.errors]:[]),[fe]),be=(0,o.useMemo)((()=>({parseErrors:(null==me?void 0:me[1])??[],typeErrors:ge,evaluationErrors:t})),[t,me,ge]),ve=(0,d().lW)(be,Pt,Object.is),he=be.parseErrors.length+be.typeErrors.length+be.evaluationErrors.length>0,ke=(0,r().K8)((()=>function(e){const{errors:t,intl:n,codeLength:o,formulas:i}=e,{parseErrors:r,typeErrors:a,evaluationErrors:s}=t,u=[];a&&a.length>0?a.forEach((e=>{const t=(0,l().ew)((0,l().rA)(n,e));u.push({msg:n.formatMessage(...t),range:{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}})})):s&&s.length>0&&s.forEach((e=>{const t=(0,l().ew)((0,l().yI)(n,e));u.push({msg:n.formatMessage(...t),range:i.isUniqueFormulaEvaluatorError(e)?{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}:void 0})}));r&&r.forEach((e=>{const t=(0,l().ew)((0,l().ml)(e));u.push({msg:n.formatMessage(...t),range:"eof"===e.offset?{startIndex:o-1,endIndex:o}:{startIndex:e.offset,endIndex:e.offset+1}})}));return u}({errors:ve,codeLength:ce?(0,s().sE)(ce):(0,m().q4_)(ue).length,formulas:_,intl:G})),[ue,ve,_,G,ce]),Ce=(0,o.useMemo)((()=>ke.map((e=>e.range)).filter(g().O9)),[ke]),Ie=(0,o.useCallback)((()=>{O(Y?n:re.getValue())}),[Y,O,n,re]),[Se,Me]=(0,o.useState)(void 0),Pe=(0,o.useRef)(void 0),[Ae,Ee]=(0,o.useState)(void 0),we=(0,o.useRef)(1);(0,o.useEffect)((()=>{we.current++;const e=we.current;!async function(){if(X){const t=await X.getFormulaEditorInfoAtPosition({formula:ue??[],inputPosition:se&&se.startIndex===se.endIndex?se.startIndex:0,context:N,includeDeprecatedCompletions:!1});x().Q.isSuccess(t)&&we.current===e&&(Pe.current=t.value,Me(t.value))}}()}),[se,X,N,ue]);const Fe=(0,o.useCallback)((()=>{ae(n)}),[n,ae]),je=(0,r().uB)(void 0,Q),De=(0,r().K8)((()=>{var e;return null==$||null===(e=$.getSchemaStore)||void 0===e||null===(e=e.call($))||void 0===e?void 0:e.getValue()}),[$]),Be=(0,r().K8)((()=>je.state.isAssistantVisible),[je]),Le=(0,o.useCallback)((()=>(0,c().r4)({textValue:re.getValue(),intl:G,getRecordModel:q,userTimeZone:(0,p().P)()})),[re,G,q]),He=null==$?void 0:$.id,Ye=ke.length>0,Ne=(0,o.useCallback)((()=>{var e;Be||(0,C().u4)({environment:Z,event:{eventName:"formula_assistant_open",eventProperties:{formula_assistant_session_id:je.state.id,has_existing_formula:(null===(e=Le())||void 0===e?void 0:e.length)>0,has_errors:Ye,collection_id:He}}});je.toggleAssistantVisible()}),[Be,je,Z,Le,Ye,He]),_e=(0,o.useCallback)((async()=>{var e;const t=null===(e=P().default.state.currentSpaceStore)||void 0===e?void 0:e.id,n=je.state.prompt;if(!t||!n)return;je.didBeginRequest();const o=ke.map((e=>{if("string"==typeof e.msg)return e.range?`${e.msg} [${e.range.startIndex},${e.range.endIndex}]`:e.msg})).filter(g().O9),i=function(e){const{prompt:t,collectionSchema:n,typecheckContext:o,existingFormula:i,formulaErrors:r}=e,a=[];if(n){const{sourceProperty:e}=o;for(const[t,o]of Object.entries(n))t!==e&&void 0!==o&&a.push({name:o.name,type:o.type,example:void 0})}return{type:"formula",prompt:t,properties:a,existingFormula:i,formulaErrors:r}}({prompt:n,collectionSchema:De,typecheckContext:N,existingFormula:Le(),formulaErrors:o}),r=await async function(e){const{environment:t,spaceId:n,formulaInferenceContext:o}=e,i=w().JW();await D().callApi({eventName:"publishAiSession",environment:t,data:{inference_type:"formula",spaceId:n,id:i,metadata:{from:"formulaAssistant"}}});const r=w().JW(),a=await D().callStreamApi({eventName:"getCompletion",environment:t,data:{id:r,context:o,model:"openai-gpt-4o",spaceId:n,isSpacePermission:!1,aiSessionId:i,metadata:{}},headers:(0,F().WS)({spaceId:n})});if("success"!==a.type)return void B().Qg(a);let l="";if(j().hS.is(a.data))for await(const s of a.data)"success"===s.type&&(l+=s.completion);return{formula:l,inferenceId:r}}({environment:Z,spaceId:t,formulaInferenceContext:i});if(r){const e=await v().R.clipboardActions.load();!function(e){const{clipboardActions:t,environment:n,formulasModule:o,newValue:i,store:r}=e;R().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:n,canUndo:!0,perform:e=>{L().kE({environment:n,store:r,newValue:i,editorMode:"default",disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{R().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:n,canUndo:!0,perform:e=>{L().wu({clipboardActions:t,formulasModule:o,store:r,transaction:e})}})}))}})}({environment:Z,clipboardActions:e,formulasModule:_,newValue:r.formula,store:re}),(0,C().u4)({environment:Z,event:{eventName:"formula_assistant_prompt",eventProperties:{formula_assistant_session_id:je.state.id,inference_id:r.inferenceId}}})}je.didFinishRequest()}),[je,ke,De,N,Le,Z,_,re]),Ve=(0,o.useCallback)((()=>{}),[]),Ue=(0,o.useCallback)((()=>je.hideAssistant()),[je]);Mt&&console.log("FormulaInput",{currentValue:ue,cursorEditorInfo:Se,infoHelper:Ae,errorMessagesWithRange:ke,errorRanges:Ce,astWithTypes:fe});const Ke=(0,a().IS)((e=>({container:{display:"flex",height:"100%",paddingBottom:void 0,flexDirection:"column"},editorSection:{display:"flex",flexDirection:"column",backgroundColor:"light"===e.mode?e.cardBackground:e.accentColors.gray[30]},inputText:{display:"flex",flexGrow:1,flexShrink:1,overflow:"auto",maxHeight:"min(calc(90vh - 240px - 38px - 30px), 298px)",minHeight:"40px",cursor:"text",position:"relative"},bottomSection:{display:"flex",flexDirection:"row",height:J.isMobile?"100%":240,maxHeight:J.isMobile?void 0:"calc(90vh - 38px - 31px - 38px - 30px)",borderTop:`1px solid ${e.outlineButtonBorder}`},leftColumn:{position:"relative",borderRight:`1px solid ${e.outlineButtonBorder}`,width:J.isMobile?"100%":void 0},rightColumn:{display:"flex",flexDirection:"column",flexGrow:1},infoHelper:{padding:"12px 14px"},assistantOverlay:{position:"absolute",inset:0,background:"transparent"}})),[J.isMobile]);return(0,K.jsx)(E().A,{debugName:"FormulaInput",capture:!0,children:(0,K.jsxs)("div",{style:Ke.container,children:[(0,K.jsxs)("div",{style:Ke.editorSection,children:[(0,K.jsx)(Je,{disabled:Y,onClickAssistant:Ne,onClickCancel:V,onClickClose:Ie,onClickRevert:pe?Fe:void 0,isAssistantVisible:Be}),(0,K.jsxs)("div",{style:Ke.inputText,children:[(0,K.jsx)(It,{value:ue,focus:!Be,store:re,disabled:Y||Be,parentSpaceId:b,valueTypes:N.valueTypes,errorRanges:Ce,handleSave:Ie,analyticsContext:{restrict_unaccessible_properties:N.restrictUnaccessibleProperties},hoveredErrorRange:ee},"input"),Be?(0,K.jsx)("div",{style:Ke.assistantOverlay,onClick:Ue}):null]})]}),he?(0,K.jsx)(At,{errorMessagesWithRange:ke,onHoverEnter:ne,onHoverLeave:oe,hoveredErrorRange:ee}):H,Be?(0,K.jsx)(A().y,{experimentId:"formula_assistant",groups:{on:(0,K.jsx)(z,{formulaAssistantStore:je,onStop:Ve,onSubmit:_e}),control:null}}):null,!Y&&!Be&&(0,K.jsxs)("div",{style:Ke.bottomSection,children:[(0,K.jsx)("div",{style:Ke.leftColumn,children:(0,K.jsx)(Re,{store:re,context:N,selection:se,cursorEditorInfo:Se,cursorEditorInfoRef:Pe,onChange:le,getRecordModel:e.getRecordModel,setInfoHelper:Ee})}),!J.isMobile&&(0,K.jsx)("div",{style:Ke.rightColumn,children:(0,K.jsx)(Te,{infoHelper:Ae,getRecordModel:e.getRecordModel,style:Ke.infoHelper,typecheckContextValues:N.valueTypes})})]})]})})}const At=o.memo((function(e){let{errorMessagesWithRange:t,onHoverEnter:o,onHoverLeave:i,hoveredErrorRange:r}=e;const l=(0,a().IS)((e=>({errors:{display:"flex",flexDirection:"row",alignItems:"start",padding:10,fontSize:b().J.UISmall.desktop,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,color:e.darkTextColor,flexShrink:0},icon:{width:14,height:14,fill:e.icon.uiRedPrimary,display:"inline",marginRight:3,marginTop:2},errorMessages:{color:e.text.uiRedPrimary}})),[]);return 0===t.length?null:(0,K.jsxs)("div",{style:l.errors,children:[(0,n(222324).f)(l.icon),(0,K.jsx)("span",{style:l.errorMessages,children:t.slice(0,3).map(((e,t)=>(0,K.jsx)(Et,{errorMessageWithRange:e,shouldAddLeadingSpace:t>0,onHoverEnter:o,onHoverLeave:i,hoveredErrorRange:r},t)))})]})})),Et=o.memo((function(e){let{errorMessageWithRange:t,shouldAddLeadingSpace:n,onHoverEnter:i,onHoverLeave:r,hoveredErrorRange:l}=e;const s=(0,a().IS)((e=>({errorRange:{opacity:.75},text:{color:e.text.uiRedPrimary,cursor:"pointer"}})),[]),{range:u}=t;(0,o.useEffect)((()=>()=>{u&&l&&u.startIndex===l.startIndex&&u.endIndex===l.endIndex&&r()}),[u,l,r]);const p=(0,o.useCallback)((()=>{u&&i(u)}),[u,i]),d=(0,o.useCallback)((()=>{r()}),[r]);return(0,K.jsxs)("span",{style:s.text,onMouseEnter:p,onMouseLeave:d,children:[n?" ":null,t.msg,void 0!==u&&(0,K.jsxs)(K.Fragment,{children:[" ",(0,K.jsx)("span",{style:s.errorRange,children:`[${u.startIndex},${u.endIndex}]`})]})]})}))},822606:(e,t,n)=>{n.d(t,{Q:()=>l});n(242343);var o=()=>n(237385),i=()=>n(174114),r=()=>n(303472),a=n(163643);function l(e){const{isMobile:t}=(0,o().Y0)(),n=(0,i().DP)();return(0,a.jsx)(r().Q,{...e,theme:n,isMobile:t})}}}]);