"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[43396],{5612:(e,t,o)=>{o.d(t,{K:()=>i});var n=()=>o(137476);function i(e){n().vd(e,"inline_collection_load_more_click")}},25058:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(242343),i=()=>o(237385);function r(e){const t=(0,i().v3)(),{onLongPress:o,hapticsEnabled:r=!0,timeout:s=300}=e,l=(0,n.useCallback)((()=>{var e,n,i;r&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(n=(i=window.navigator).vibrate)||void 0===n||n.call(i,20));o()}),[t.mobileNative,r,o]),a=(0,n.useRef)(),d=(0,n.useRef)(0),c=(0,n.useRef)(0),u=(0,n.useCallback)((()=>clearTimeout(a.current)),[]);(0,n.useEffect)((()=>u),[u]);return{onTouchStart:(0,n.useCallback)((()=>{clearTimeout(a.current),a.current=setTimeout(l,s)}),[s,l]),onTouchMove:(0,n.useCallback)((e=>{const t=e.touches[0].clientX,o=e.touches[0].clientY;(Math.abs(t-d.current)>50||Math.abs(o-c.current)>50)&&clearTimeout(a.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},125978:(e,t,o)=>{o.d(t,{w:()=>C});o(403517),o(242343);var n=()=>o(237385),i=()=>o(810111),r=()=>o(711361),s=()=>o(653998),l=()=>o(975392),a=()=>o(236339),d=()=>o(927999),c=()=>o(84543),u=()=>o(640979),p=()=>o(535906),g=()=>o(273520),m=()=>o(356813),f=()=>o(935091),v=()=>o(858023),h=()=>o(443252),S=()=>o(88271),y=o(163643);const b=(0,s().j4)((function(e){const{limit:t}=e;return(0,y.jsx)(s().sA,{defaultMessage:"{limit} pages",values:{limit:t.limit},id:"database.FirstLoadLimitSelectOption.limitPagesTitle"})})),x=(0,s().YK)({firstLoadLimitActionButtonAriaLabel:{defaultMessage:"Load limit settings menu",id:"database.firstLoadLimitActionButton.ariaLabel"}});function C(e){let{format:t,collectionContextStore:o}=e;const i=(0,n().v3)(),{device:l}=i,u=(0,s().tz)();return l.isMobile?null:(0,y.jsx)(g().Ay,{popupType:h().nl.Popup,renderOrigin:e=>(0,y.jsx)(m().A,{icon:r()._,style:{marginLeft:4,marginRight:4},ariaLabel:u.formatMessage(x.firstLoadLimitActionButtonAriaLabel),...e}),alignmentToOrigin:g().yP.End,placementToOrigin:g().sx.Bottom,originGap:8,render:e=>(0,y.jsx)(j,{currentLimit:w(t),onAccept:e=>function(e,t,o){const n=t.collectionViewStore();if(!n)return;if(!n.getType())return;c().createAndCommit({userAction:"FirstLoadLimitActionButton.handleFirstLoadLimitAccept",environment:o,canUndo:!0,perform:t=>{d().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),t.groupsStore.resetAllLimits(),(0,a().X)({environment:o,collectionContextStore:t,action:"set_first_load_limit"})}(e,o,i),onClose:e.close,showTitle:!0})})}function w(e){return(0,i().i3)(e.inline_collection_first_load_limit,Boolean(e.collection_group_by))}function j(e){const t=(0,n().v3)(),{device:o}=t,{currentLimit:r,onAccept:a,onClose:d,showTitle:c}=e,g=(0,l().oE)(i().X9.map(((e,t)=>{const o={key:t,render:t=>(0,y.jsx)(p().A,{...t,disabled:!1,title:(0,y.jsx)(b,{limit:e}),isChecked:(0,l().n4)(r,e)}),action:()=>a(e)};return o}))),m=[{key:0,render:e=>(0,y.jsx)(S().A,{enableActionSheetTitle:!0,title:c&&(0,y.jsx)(s().sA,{defaultMessage:"Show on first load",id:"database.firstLoadLimitSelectMenu.firstLoadLimitSetting"}),...e}),items:g}];let h;return h=o.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:200},(0,y.jsx)(f().A,{...h,children:(0,y.jsx)(v().Ay,{type:v().Oh.Vertical,sections:m,onAccept:d,initialFocus:void 0})})}},162976:(e,t,o)=>{o.d(t,{$:()=>r});var n=()=>o(803290),i=()=>o(307542);function r(e){let{spaceStore:t}=e;const o=(0,n().K8)((()=>Boolean(null==t?void 0:t.getSetting("disable_people_directory"))),[t]);return(0,n().K8)((()=>(0,i().F0)()),[])&&!o}},170582:(e,t,o)=>{o.d(t,{r:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10 2.355a2.35 2.35 0 0 0-2.253 1.686 5.06 5.06 0 0 0-2.803 4.527v1.189c0 .919-.334 1.806-.939 2.498l-.818.935c-.881 1.007-.166 2.583 1.173 2.583h3.02a2.65 2.65 0 0 0 5.24 0h3.02c1.339 0 2.054-1.576 1.173-2.583l-.818-.935a3.8 3.8 0 0 1-.939-2.498v-1.19a5.06 5.06 0 0 0-2.803-4.526A2.35 2.35 0 0 0 10 2.355m1.5 13.418a1.55 1.55 0 0 1-2.998 0zM8.909 4.564A1.104 1.104 0 0 1 10 3.605c.556 0 1.017.415 1.091.96l.049.353.329.138a3.81 3.81 0 0 1 2.337 3.512v1.189c0 1.221.444 2.401 1.248 3.32l.818.936a.307.307 0 0 1-.232.51H4.36a.308.308 0 0 1-.232-.51l.818-.935a5.04 5.04 0 0 0 1.248-3.321v-1.19c0-1.58.963-2.936 2.337-3.511l.33-.138z"})},i=(0,o(680369).wt)("bell",n)},204024:(e,t,o)=>{o.d(t,{A:()=>l,p:()=>r});var n=o(242343),i=o(163643);const r=8;function s(e,t){let{isSelected:n}=e;const{radioButtonStyle:s,dotStyle:l}=(0,o(174114).IS)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:r,background:n?e.blueColor:e.whiteButtonBackground,border:n?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.text.contrastPrimary,transition:"opacity 100ms ease-out",opacity:n?1:0}})),[n]);return(0,i.jsx)("div",{ref:t,style:s,children:(0,i.jsx)("div",{style:l})})}const l=n.forwardRef(s)},207762:(e,t,o)=>{o.d(t,{Ay:()=>d,Jy:()=>a,vU:()=>l});o(403517);var n=o(242343),i=()=>o(640979),r=o(163643);function s(e){let{tabs:t,selectedIndex:s,onChange:d,separatorIndexes:c,right:u,style:p,rightStyle:g,tabStyle:m,tabTitleStyle:f,selectedTabTitleStyle:v,tabBorderStyle:h,selectedTabStyle:S,readOnly:y,hideTabBorder:b,idPrefix:x,hideTabIndexes:C}=e;const w=(0,n.useContext)(i().xu),{device:j,WindowSizeStore:k}=(0,o(237385).v3)(),{safePaddingLeft:I,safePaddingRight:A}=(0,o(803290).K8)((()=>({safePaddingLeft:k.getSafePaddingLeftCSS(16),safePaddingRight:k.getSafePaddingRightCSS(16)})),[k]),M=(0,o(174114).IS)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.text.secondary,...m},o=`inset 0 -1px 0 ${e.regularDividerColor}`,n=w.menuType===i().gu.Popup,r={fontSize:16,paddingTop:2,paddingLeft:n?16:I,paddingRight:n?16:A,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:b?void 0:o,...j.isMobile?r:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...p},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},tab:t,selectedTab:{...t,position:"relative",color:e.text.primary,...S},border:{borderBottom:`2px solid ${e.text.primary}`,position:"absolute",bottom:0,left:8,right:8,...h},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.text.secondary,...g}}}),[w.menuType,j.isMobile,g,I,A,S,p,h,m,b]);return(0,r.jsxs)("div",{className:"hide-scrollbar",style:M.container,role:"tablist",children:[t.map(((e,t)=>{if(null!=C&&C.includes(t))return null;const i=t===s;return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)("div",{style:i?M.selectedTab:M.tab,children:[(0,r.jsx)(o(209684).p,{role:"tab",style:{...f,...i?v:{}},onClick:()=>d(t),disabled:y,mobileFeedback:j.isMobile,isLightGray:!Boolean(i),"aria-selected":i,id:l(x,t),"aria-controls":a(x,t),children:e}),i&&(0,r.jsx)("div",{style:M.border})]},`tabButton-${t}`),c&&c.includes(t)&&(0,r.jsx)("div",{style:M.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),u&&(0,r.jsx)("div",{style:M.rightContainer,children:u})]})}function l(e,t){if(e)return`${e}-tab-${t}`}function a(e,t){if(e)return`${e}-tabpanel-${t}`}const d=n.memo(s)},241406:(e,t,o)=>{o.d(t,{A:()=>r});var n=()=>o(966121),i=()=>o(76394);function r(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,n().JY)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,n().gK)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,n().lx)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,n().gU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().HB)(e)}}},245653:(e,t,o)=>{o.d(t,{v:()=>l});var n=()=>o(966121),i=()=>o(764872),r=()=>o(759625),s=()=>o(84543);function l(e){const{environment:t,key:o,selectedKey:l,following:a,followSettings:d,navigableBlockId:c,userId:u,spaceId:p,from:g}=e;s().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{r().vt({environment:e.environment,table:n().Cy,args:{following:a,followSettings:d,navigableBlockId:c,userId:u,spaceId:p},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),a?i().KN(t,{from:"page_updates"}):i().tm(t,{from:"page_updates"}),l!==o&&i().EV(t,{from:g,navigableBlockId:c,oldSetting:l,newSetting:o})}},317278:(e,t,o)=>{o.d(t,{g:()=>i});o(242343);const n={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"M8 2.125a.61.61 0 0 0-.625.599v9.017L4.122 8.488a.625.625 0 1 0-.884.884l4.32 4.32c.244.244.64.244.884 0l4.32-4.32a.625.625 0 0 0-.884-.884l-3.253 3.253V2.724A.61.61 0 0 0 8 2.125"})},i=(0,o(680369).wt)("arrowStraightDownSmall",n)},322199:(e,t,o)=>{o.d(t,{S:()=>r});var n=()=>o(803290),i=()=>o(307542);function r(e){let{spaceStore:t}=e;const o=(0,n().K8)((()=>Boolean(null==t?void 0:t.getSetting("disable_people_hover_card"))),[t]);return(0,n().K8)((()=>(0,i().qm)()),[])&&!o}},367923:(e,t,o)=>{o.d(t,{A:()=>p});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955);var n=o(242343),i=()=>o(752597),r=()=>o(803290),s=()=>o(833369),l=()=>o(192048),a=()=>o(975392),d=()=>o(728373),c=()=>o(572589);function u(e){const{reducerId:t,instanceId:o,reducer:n,collectionContextStore:i,groupsPointer:r}=e,s=i.reducersStore.state,l=s[t];let d,u;if(r&&r.length>0&&(d=(0,c().Hm)(r)),n){if(u={instanceIds:a().sb([...(null==l?void 0:l.instanceIds)||[],o]),reducer:n},d){i.reducerDependencies.has(d)||i.reducerDependencies.set(d,new Set);const e=i.reducerDependencies.get(d);null==e||e.add(t)}}else{if(d){const e=i.reducerDependencies.get(d);e&&(e.delete(t),0===e.size&&i.reducerDependencies.delete(d))}const e=a().FF((null==l?void 0:l.instanceIds)||[],o);u=l&&e.length>0?{instanceIds:e,reducer:l.reducer}:void 0}a().n4(l,u)||i.reducersStore.setState({...s,[t]:u})}function p(e){const{id:t,reducer:o,collectionContextStore:c,groupsPointer:p,debounceWait:g}=e,m=(0,r().K8)((()=>p),[p],{useDeepEqual:!0}),f=(0,r().K8)((()=>o),[o],{useDeepEqual:!0}),v=(0,r().K8)((()=>c.collectionViewStore()),[c]),h=(0,r().K8)((()=>c.normalizedFormatStore.state.collection_pointer),[c.normalizedFormatStore]),S=(0,r().K8)((()=>{var e;return null==v||null===(e=v.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[v]),y=(0,n.useRef)(!1),b=(0,l().O)(),[x,C]=(0,n.useReducer)(((e,t)=>a().n4(e,t)?e:t),void 0),w=(0,n.useCallback)((()=>{const e=c.localResultStore.state,o=c.remoteResultStore.state,n=e&&"reducer"===e.type?e.reducerResults[t]:void 0,i=o&&"reducer"===o.type?o.reducerResults[t]:void 0;return function(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:n,collectionContextStore:i,reducer:r}=e,l=i.reducersStore.state,d=i.remoteResultStore.state,c=i.isClientModeEnabledStore.state;if(c)return o;const u=i.isCreatingNewChartCollectionStore.state,p=i.wasCreatedThisSessionStore.state;if("aggregation"===r.type){if(u&&p){return Boolean(n&&"aggregation"===n.type&&"number"===n.aggregationResult.type&&0!==n.aggregationResult.value)&&i.isCreatingNewChartCollectionStore.setState(!1),o}if(n)return n;const e=Boolean(d&&"reducer"===d.type&&a().I6(d.reducerResults,((e,t)=>{const o=l[t];return!!o&&Boolean("results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===e.type&&e.hasMore&&a().n4(r.filter,o.reducer.filter))})));return e?o:n}if("groups"===r.type){if(u&&p){return Boolean(n&&"groups"===n.type&&("v2"===n.version?n.hasMore:0!==n.total))&&i.isCreatingNewChartCollectionStore.setState(!1),o}if("v2"===r.version){if(o&&"groups"!==o.type||o&&"groups"===o.type&&"v2"!==o.version)return;if(n&&"groups"!==n.type||n&&"groups"===n.type&&"v2"!==n.version)return;const e=function(e){var t;const{collectionContextStore:o,reducer:n,wasCreatedThisSession:i,localReducerResult:r,remoteReducerResult:l}=e;let a,d;n.aggregation&&(l?a=l.aggregationResults:r&&(a=r.aggregationResults));if(n.blockResults){var c;const e=Boolean(l&&l.blockResults),t=null===(c=o.collectionViewStore())||void 0===c?void 0:c.getCollectionSource(),n=(0,s().TR)(t)||(0,s().hJ)(t);if((e||i)&&!n&&r&&r.blockResults){const e=r.blockResults,t=(null==l?void 0:l.blockResults)??{},o=new Set([...Object.keys(e),...Object.keys(t)]),n={};for(const i of o){const o=e[i],r=t[i];let s=[];o?s=o.blockIds:r&&(s=r.blockIds);let l=!1;r?l=r.hasMore:o&&(l=o.hasMore),n[i]={blockIds:s,hasMore:l}}d=n}d||(d=o.forceLocalQueryCollection?null==l?void 0:l.blockResults:null==r?void 0:r.blockResults)}let u;r&&r.pinnedResults&&(u=r.pinnedResults);l&&l.pinnedResults&&(u={groupResults:l.pinnedResults.groupResults,...u,aggregationResults:l.pinnedResults.aggregationResults});const p=l?l.hasMore:Boolean(null==r?void 0:r.hasMore),g=l?l.hasMoreSubGroups:null==r?void 0:r.hasMoreSubGroups;let m=(null==r?void 0:r.results)??(null==l?void 0:l.results)??[],f=(null==r?void 0:r.subGroupResults)??(null==l?void 0:l.subGroupResults);const v=n.groupBy;l&&("relation"===v.type||"formula"===v.type&&"relation"===v.groupBy.type)&&(m=l.results);const h=null===(t=n.subGroup)||void 0===t?void 0:t.groupBy;l&&("relation"===(null==h?void 0:h.type)||"formula"===(null==h?void 0:h.type)&&"relation"===h.groupBy.type)&&(f=l.subGroupResults);o.forceLocalQueryCollection&&(m=(null==l?void 0:l.results)??(null==r?void 0:r.results)??[],f=(null==l?void 0:l.subGroupResults)??(null==r?void 0:r.subGroupResults));return{type:"groups",version:"v2",results:m,subGroupResults:f,pinnedResults:u,hasMore:p,hasMoreSubGroups:g,blockResults:d,aggregationResults:a}}({collectionContextStore:i,reducer:r,wasCreatedThisSession:p,localReducerResult:o,remoteReducerResult:n});return e}return n||o}if("results"===r.type){var g;const e=i.wasCreatedThisSessionStore.state,r=Boolean(d&&"reducer"===d.type&&d.reducerResults[t]),l=null===(g=i.collectionViewStore())||void 0===g?void 0:g.getCollectionSource(),a=(0,s().TR)(l)||(0,s().hJ)(l);if((r||e)&&!a&&o&&"results"===o.type){return{...o,hasMore:n&&"results"===n.type?n.hasMore:o.hasMore}}return n}}({reducerId:t,collectionContextStore:c,reducer:f,localReducerResult:n,remoteReducerResult:i})}),[c,f,t]),j=(0,n.useCallback)((()=>{y.current=!1,b.current||C(w())}),[w,b]),k=(0,n.useCallback)((()=>{y.current||(y.current=!0,i().default.afterNextFlush(j))}),[j]),[I]=(0,n.useState)((()=>(0,d().Ay)()));return(0,n.useEffect)((()=>{const e=g?(0,a().sg)(k,g,{leading:!0}):k;return c.remoteResultStore.addListener(k),c.localResultStore.addListener(e),()=>{c.remoteResultStore.removeListener(k),c.localResultStore.removeListener(e)}}),[c,k,g]),(0,n.useEffect)((()=>(u({reducerId:t,instanceId:I,reducer:f,collectionContextStore:c,groupsPointer:m}),()=>{u({reducerId:t,instanceId:I,reducer:void 0,collectionContextStore:c,groupsPointer:m})})),[c,v,h,S,m,f,t,I]),(0,n.useEffect)((()=>{k()}),[]),(0,n.useEffect)((()=>(c.timingTracker.mountCollectionReducerRequest(t,f.type),()=>{c.timingTracker.unmountCollectionReducerRequest(t)})),[c,t,f]),x}},394156:(e,t,o)=>{o.d(t,{L:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},416956:(e,t,o)=>{o.d(t,{E:()=>g});o(242343);var n=()=>o(803290),i=()=>o(174114),r=()=>o(850313),s=()=>o(518797),l=()=>o(409211),a=()=>o(76394),d=()=>o(951156),c=()=>o(482570),u=()=>o(225679),p=o(163643);function g(e){let{authorStore:t,avatarSize:o,avatarStyle:g,hasTooltip:m=!0}=e;const f=(0,n().K8)((()=>(0,u().d5)(t)),[t]),v=(0,i().IS)((e=>({placeholder:{width:o,height:o,background:e.lightDividerColor,borderRadius:o/2,flexShrink:0,...g}})),[o,g]);return f.asActor?f.table===l().oo?(0,p.jsx)(c().A,{hasTooltip:m,userValue:f.asActor,style:g,size:o,avatarShouldShowShadow:!1}):f.table===s().GP?(0,p.jsx)(d().A,{botValue:f,size:o,style:g}):f.table===r().yj?(0,p.jsx)("div",{style:v.placeholder}):void(0,a().HB)(f):(0,p.jsx)("div",{style:v.placeholder})}},501633:(e,t,o)=>{o.d(t,{e:()=>l});var n=o(242343),i=()=>o(237385),r=()=>o(84543),s=()=>o(485966);function l(){const[e,t]=(0,n.useState)(!0),o=(0,i().v3)();(0,n.useEffect)((()=>{if(e){const{currentSpaceViewStore:e}=s().default.state;if(!e)return;r().createAndCommit({userAction:"PostsHomePanel.updateLastOpened",environment:o,canUndo:!0,perform:t=>{r().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_aggregated_feed"],command:"set",args:Date.now()},transaction:t})}})}}),[e,o])}},614234:(e,t,o)=>{o.d(t,{H:()=>i});var n=()=>o(137476);function i(e){const{collectionContextStore:t,environment:o,incrementLimitArgs:i}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetailsStore.setState({type:"load_more_blocks",group:i.groupsPointer}),n().vd(o,"collection_load_more_blocks")}},631152:(e,t,o)=>{o.d(t,{LA:()=>C,jJ:()=>w});o(242343);var n=()=>o(237385),i=()=>o(803290),r=()=>o(174114),s=()=>o(712437),l=()=>o(317278),a=()=>o(680369),d=()=>o(653998),c=()=>o(5612),u=()=>o(614234),p=()=>o(191756),g=()=>o(360378),m=()=>o(782422),f=()=>o(48092),v=()=>o(502852),h=()=>o(126451),S=()=>o(966789),y=()=>o(125978),b=o(163643);const x=30,C=33;function w(e){const{style:t,iconStyle:o,store:C,format:w,collectionContextStore:j,groupsPointer:k,incrementLimitsInRelatedGroups:I,isFullScreen:A}=e,M=(0,n().v3)(),T=(0,i().K8)((()=>j.groupsStore.getGroupState(k)),[j,k]),R=(0,i().K8)((()=>(0,f().Kk)({collectionContextStore:j,groupsPointer:k})),[j,k]),_=(0,i().O$)(j.isInHomeWidgetStore),P=(0,r().IS)((e=>({homeContainer:{display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignItems:"center",justifyContent:"center",height:x,borderRadius:6,whiteSpace:"break-spaces",fontSize:14,..._?{textAlign:"center",width:"fit-content",marginLeft:12,marginBottom:0,padding:4}:{},...t},loadingContainer:{marginTop:1,marginLeft:8,marginRight:8},icon:{width:a().Ev.sm,height:a().Ev.sm,marginRight:6,fill:e.icon.tertiary,...o},text:{color:e.text.tertiary,width:"100%",fontSize:_?14:void 0},hoveredStyle:{...R?{background:e.whiteButtonBackground}:{background:e.tableRowHoveredBackground}}})),[_,t,R,o]),B=(0,i().K8)((()=>C.canEdit()),[C]);return T?_?(0,b.jsx)("div",{style:P.homeContainer,children:(0,b.jsx)(h().A,{onClick:e=>function(e,t,o){const n=e.metaKey||e.ctrlKey?"tab":void 0,i=(0,m().sj)(o.id)?s().y8.PersonalHomeTileTasks:s().y8.PersonalHomeTileCustomDb;p().uK({environment:t,store:o,pageVisitSource:i,openInNew:n})}(e,M,C),onMouseDown:v().tr,style:P.button,children:(0,b.jsx)("div",{style:P.text,children:(0,b.jsx)(d().sA,{id:"database.viewAllButtonTitle",defaultMessage:"View all"})})})}):(0,b.jsxs)(h().A,{onClick:e=>function(e,t,o,n,i,r){const s=o.groupsStore.getGroupState(n);if(!s)return;const l=s.reducerResultStore.state;(0,v().kV)(e),g().IU({environment:t}),l&&(0,u().H)({collectionContextStore:o,environment:t,incrementLimitArgs:{isFullScreen:r,currentResultCount:l.blockIds.length,groupsPointer:s.groupsPointer,incrementLimitsInRelatedGroups:i}});(0,c().K)(t)}(e,M,j,k,I,A),onMouseDown:v().tr,disabled:R,hoveredStyle:P.hoveredStyle,style:P.button,children:[(0,l().g)(P.icon),(0,b.jsx)("div",{style:P.text,children:(0,b.jsx)(d().sA,{id:"database.loadMoreButtonTitle",defaultMessage:"Load more"})}),R?(0,b.jsx)("div",{style:P.loadingContainer,children:(0,b.jsx)(S().A,{size:"sm"})}):B&&(0,b.jsx)(y().w,{collectionContextStore:j,format:w})]}):null}},740472:(e,t,o)=>{o.d(t,{a:()=>n});const n=(0,o(680369).xh)("checkmark",{default:{loader:()=>o.e(96772).then(o.bind(o,725494))},small:{loader:()=>o.e(96772).then(o.bind(o,247428))},fill:{loader:()=>o.e(96772).then(o.bind(o,726646))},fillSmall:{loader:()=>o.e(96772).then(o.bind(o,457967))}},["check","tick","confirm","approve","success"])},789533:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(129044))().default{getInitialState(){return{stores:{}}}getStore(e){return this.state.stores[e]||(this.state.stores[e]=new(o(380123).R)({key:`recentEmojis:${e}`,namespace:o(146325).Bq,important:!0,trackingType:"necessary"})),this.state.stores[e]}}const i=new n},789760:(e,t,o)=>{o.r(t),o.d(t,{MobileUnifiedFeed:()=>Pt,PostChannelCollectionView:()=>Ct,PostPresence:()=>uo});o(362833),o(725707),o(491955),o(500234),o(244387);var n=o(242343),i=()=>o(470637),r=()=>o(237385),s=()=>o(803290),l=()=>o(174114),a=()=>o(162901),d=()=>o(446588),c=()=>o(218357),u=()=>o(809226),p=()=>o(818369),g=()=>o(385531),m=()=>o(314164),f=()=>o(367923),v=()=>o(631152),h=()=>o(409179),S=()=>o(782422),y=()=>o(485966),b=()=>o(413871),x=()=>o(979537),C=()=>o(931573),w=()=>o(514040),j=()=>o(709863),k=()=>o(574361),I=()=>o(653998),A=()=>o(220413),M=()=>o(31448),T=()=>o(759625),R=()=>o(84543),_=()=>o(34559),P=()=>o(259897),B=()=>o(435819),L=()=>o(935091),U=()=>o(286404),F=()=>o(443252),K=()=>o(518471),D=()=>o(137476),z=()=>o(640979),O=()=>o(466321),V=()=>o(797470),E=()=>o(912978),N=()=>o(733968),W=()=>o(551919);var H=()=>o(747138);class G extends(()=>o(129044))().default{getInitialState(){return{type:"closed"}}open(e){this.setState({type:"open",storeId:e})}close(){this.setState({type:"closed"})}}const $=new G;var Y=()=>o(830491),q=()=>o(971522),J=(o(403517),()=>o(414930)),X=()=>o(740472),Q=()=>o(455022),Z=()=>o(23371),ee=()=>o(76394),te=()=>o(206799),oe=()=>o(817181),ne=()=>o(830820),ie=()=>o(952471),re=()=>o(712437),se=()=>o(271120),le=()=>o(280810),ae=()=>o(858691),de=()=>o(874512),ce=()=>o(525779),ue=()=>o(506181),pe=()=>o(273520),ge=()=>o(579494),me=()=>o(28210),fe=()=>o(385045),ve=()=>o(966638),he=()=>o(636045),Se=()=>o(608117),ye=()=>o(686329),be=()=>o(29869),xe=()=>o(868199),Ce=()=>o(378219),we=()=>o(622286),je=()=>o(25058),ke=()=>o(190094),Ie=()=>o(521869),Ae=()=>o(141122),Me=()=>o(869183),Te=()=>o(159275),Re=()=>o(170582),_e=()=>o(394156),Pe=()=>o(711361),Be=()=>o(718799),Le=()=>o(686752),Ue=()=>o(745719),Fe=()=>o(836693),Ke=()=>o(870099),De=()=>o(91472),ze=()=>o(245653),Oe=()=>o(865226),Ve=()=>o(421378),Ee=()=>o(56576),Ne=()=>o(105731),We=()=>o(289816),He=()=>o(747459),Ge=()=>o(535906),$e=()=>o(356813),Ye=()=>o(858023),qe=()=>o(397791),Je=()=>o(88271),Xe=()=>o(103151),Qe=()=>o(35462),Ze=()=>o(479813),et=()=>o(839466),tt=()=>o(789533),ot=()=>o(73631),nt=()=>o(360482),it=()=>o(129978),rt=()=>o(241406),st=()=>o(846409),lt=o(163643);const at=(0,I().YK)({addReaction:{id:"postActions.react.tooltip",defaultMessage:"React"},moreActions:{id:"postActions.more.tooltip",defaultMessage:"More actions"}}),dt=["👍","🎉","❤️"],ct=16;function ut(e){const{show:t,blockStore:o,feedType:n}=e,i=(0,r().v3)(),{value:a}=(0,it().fJ)(ot().T.formulas),d=(0,r().Y0)(),c=(0,I().tz)(),u=(0,we().X)("emoji_frecency"),p=(0,we().X)("suggested_reactions"),g=(0,s().K8)((()=>{if(u){const e=et().o.getEmojiFrecencyMap(),t=Object.keys(e).sort(((t,o)=>e[o].f-e[t].f)).slice(0,3);return[...t,...dt.slice(t.length)]}{var e,t;const o=(null===(e=y().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId())||"",n=(null===(t=tt().A.getStore(o).state)||void 0===t?void 0:t.split(",").filter(Boolean))||[];return[...n.slice(0,3),...dt.slice(n.slice(0,3).length)]}}),[u]),m=(0,l().IS)((e=>({container:{position:"absolute",zIndex:1,right:16,opacity:t?1:0,transition:"opacity 100ms ease-out",display:"flex",padding:"2px",boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)",borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary,borderRadius:6,backgroundColor:e.buttonGroupBackground,gap:1},reactIcon:{width:21,height:21,fill:e.icon.secondary}})),[t]),f=(0,ke().T4)();return(0,lt.jsxs)("div",{style:m.container,children:[p&&g.map((e=>(0,lt.jsx)("div",{children:(0,lt.jsx)($e().A,{ariaLabel:c.formatMessage(at.addReaction),hasBackground:!1,showShadow:!1,icon:()=>(0,lt.jsx)(Ze().A,{char:e,size:ct}),onClick:()=>(e=>{const t=(0,nt().O3)(o,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!1,excludeSelf:!1}).find((e=>e.getReactions().length>0));t?R().createAndCommit({environment:i,userAction:"Comment.toggleReactionFromMenu",canUndo:!0,perform:o=>{We().toggleReaction({environment:i,transaction:o,store:t,icon:e,discussionLocation:"post_top_level_discussion"})}}):(He().A.setState({open:!0,type:"block",content:"reaction",blockStore:o,blockId:o.id,emoji:e,rect:new DOMRect}),Ee().i5({environment:i,skipOpeningDiscussion:!0,formulasModule:a}))})(e)})},e))),(0,lt.jsx)(Xe().A,{renderTooltip:()=>(0,lt.jsx)(I().sA,{...at.addReaction}),render:e=>(0,lt.jsx)($e().A,{ariaLabel:c.formatMessage(at.addReaction),hasBackground:!1,showShadow:!1,icon:()=>(0,Ue().s)(m.reactIcon),onClick:e=>{(0,Ne().O)({environment:i,blockStore:o,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:a})},...e})}),(0,lt.jsx)(pe().Ay,{style:f.popup,popupType:d.isMobile?pe().z7.SlideUp:pe().z7.Popup,placementToOrigin:pe().sx.Right,stopClickPropagation:!0,renderOrigin:e=>(0,lt.jsx)(Xe().A,{renderTooltip:()=>(0,lt.jsx)(I().sA,{...at.moreActions}),render:t=>(0,lt.jsx)($e().A,{...e,...t,hasBackground:!1,showShadow:!1,icon:Pe()._,ariaLabel:c.formatMessage(at.moreActions)})}),render:e=>(0,lt.jsx)(pt,{blockStore:o,closeMenu:e.close,feedType:n})})]})}function pt(e){const{blockStore:t,closeMenu:o,feedType:n}=e,i=(0,r().v3)(),a=(0,r().Y0)(),{value:d}=(0,it().fJ)(ot().T.formulas),c=(0,st().x)(t),u=(0,st().A)(t),p=(0,s().K8)((()=>{var e;return"all"===(null===(e=t.getFollowStore())||void 0===e||null===(e=e.getFollowSettings())||void 0===e?void 0:e.comments)}),[t]),g=(0,s().K8)((()=>[...a.isPhone&&t.canComment()?["addReaction"]:[],"copyLink","toggleNotifications",...t.canEdit()?["edit","delete"]:[]]),[t,a.isPhone]),m=(0,l().IS)((()=>({icon:{height:16,width:16}})),[]),f=(0,ke().T4)(),v=g.map(((e,r)=>{const s=r===g.length-1&&a.isMobile;switch(e){case"addReaction":return{key:e,render:e=>(0,lt.jsx)(Ge().A,{...e,icon:(0,Ue().s)(m.icon),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.addReaction.button",defaultMessage:"React"}),onClick:e=>{(0,Ne().O)({environment:i,blockStore:t,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:d}),o()}}),action:()=>{}};case"copyLink":return{key:e,render:e=>(0,lt.jsx)(Ge().A,{...e,icon:(0,lt.jsx)(qe().I,{icon:Be().w}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.copyLink.button",defaultMessage:"Copy link"})}),action:async()=>{const e=await De().R.clipboardActions.load();u&&e.copyString({environment:i,stringValue:u,copiedMessage:e.clipboardMessages.copiedLinkToClipboard})}};case"toggleNotifications":return{key:e,render:e=>p?(0,lt.jsx)(Ge().A,{...e,icon:(0,_e().L)(m.icon),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.disableNotifications.button",defaultMessage:"Turn off reply notifications"})}):(0,lt.jsx)(Ge().A,{...e,icon:(0,lt.jsx)(qe().I,{icon:Re().r}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.enableNotifications.button",defaultMessage:"Get notifications for replies"})}),action:()=>{const e=t.getModel(),{currentUserStore:o}=y().default.state;if(!e||!o)return;const{following:n,followSettings:r}=(0,rt().A)(p?"none":"comments");ze().v({environment:i,followSettings:r,following:n,navigableBlockId:t.id,userId:o.id,spaceId:t.getSpaceId(),key:"comments",selectedKey:"comments",from:"more_menu"})}};case"edit":return{key:e,render:e=>(0,lt.jsx)(Ge().A,{...e,icon:(0,lt.jsx)(qe().I,{icon:Le().pencilLineIcon}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.edit.button",defaultMessage:"Edit"})}),action:()=>c&&Oe().oo({environment:i,url:c})};case"delete":return{key:e,render:e=>(0,lt.jsx)(Ge().A,{...e,icon:(0,lt.jsx)(qe().I,{icon:Fe().trashIcon}),isRedOnHover:!0,style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,lt.jsx)(I().sA,{id:"postActions.delete.button",defaultMessage:"Delete"})}),action:()=>{R().createAndCommit({userAction:"PostActions.delete",environment:i,canUndo:!0,perform:e=>{Ve().oD({environment:i,blocks:[t],transaction:e}),e.postSubmitCallbacks.push((e=>{e||(0,Ke().N)(i,{analyticsName:"delete",from:"block_more_menu",block_id:t.id,block_type:t.getType(),collection_id:t.getParentId()})}))}}),(0,D().u4)({environment:i,event:{eventName:"post_deleted",eventProperties:{block_id:t.id,from:n}}})}}}})).filter(ee().O9);return(0,lt.jsx)(L().A,{menuType:z().gu.Popup,height:a.isMobile?"50vh":void 0,minWidth:250,maxWidth:a.isMobile?"100vw":void 0,scrollerStyle:f.menuScroller,header:a.isMobile&&(0,lt.jsx)(Qe().A,{style:f.header,children:(0,lt.jsx)(I().sA,{id:"postActions.moreActions",defaultMessage:"More actions"})}),children:(0,lt.jsx)(Ye().Ay,{type:Ye().Oh.Vertical,initialFocus:void 0,onAccept:o,sections:[{key:0,render:e=>(0,lt.jsx)(Je().A,{...e,style:f.sectionMenuItem}),items:v}]})})}const gt=6,mt={mobile:350,desktop:700};function ft(e){const{store:t,inUnifiedFeed:o,index:i,onShowMoreClicked:a,disableInteraction:d,genericFeedDisplaySettings:c}=e,u=(0,r().v3)(),p=(0,r().Y0)(),g=p.isPhone,m=(0,we().X)("ken_new_home_design"),f=p.isMobile?150:500,[v,S]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),[C,w]=(0,n.useState)(!1),j=(0,n.useRef)(null),k=(0,n.useRef)(null),I=(0,je().A)({onLongPress:()=>{var e;return null===(e=k.current)||void 0===e?void 0:e.setOpen(!0)}}),A=(0,s().K8)((()=>t.getTitleStore()),[t]),T=(0,s().K8)((()=>t.getIcon()),[t]),R=(0,s().K8)((()=>t.getContentStore()),[t]),_=(0,s().K8)((()=>t.getCreatedByStore()),[t]),P=(0,s().K8)((()=>({lastEditedTime:t.getLastEditedTime(),createdTime:t.getCreatedTime()})),[t]),B=(0,s().O$)(y().AppStoreMainEditorCurrentBlockStore),L=(0,h().lU)(),U=(0,s().K8)((()=>{if("PersonalHome"===L){if(!B)return;return(0,be().Ay)({store:B,peekViewBlockId:t.id,peekMode:"c",fullyQualified:!1,pageVisitSource:re().y8.UnifiedFeed})}if("TeamHome"===L)return(0,be().Ay)({store:t,fullyQualified:!1,pageVisitSource:re().y8.TeamFeed});if(void 0===L){const e=null!=c&&c.collection_peek_mode?(0,Ae().getUrlParamFromPeekMode)((0,Ae().getPeekModeFromCollectionPeekModeFormat)(c.collection_peek_mode)):void 0;return e&&B?(0,be().Ay)({store:B,peekViewBlockId:t.id,peekMode:e,fullyQualified:!1,pageVisitSource:re().y8.GenericFeed}):(0,be().Ay)({store:t,fullyQualified:!1,pageVisitSource:re().y8.GenericFeed})}(0,ee().HB)(L)}),[t,c,B,L]),F=(0,s().K8)((()=>!t.isEmptyTitle()),[t]),K=(0,s().K8)((()=>(0,Ce().Uo)(t)),[t]),{pageVisitStore:z,presenceStore:O}=(0,Te().S)({store:t,environment:u,postContext:V().Rr.PostInFeed}),{initialRequestCompleted:E,ready:N}=(0,ae().A)({pageStore:t,pageVisitStore:z,disableSideEffects:!0}),W=(0,n.useCallback)((()=>{const e=u.currentUser.id;if(!N||!e)return;const n=(0,Q().$5)({parent_id:t.id,user_id:e});d||le().FZ(u,{blockStore:t,fromPageRefresh:!1,pageVisitStore:z,timestamp:Date.now(),type:"passive"}),se().yP(u,{query:"",page_id:t.id,is_peek:!1,peek_mode:void 0,page_visit_source_override:o?re().y8.UnifiedFeedScroll:re().y8.TeamFeedScroll,rank:i,type:"page",page_visit_id:n,previous_page_visit_id:void 0,debug_page_visit_source:"post_set_page_visited"})}),[u,z,N,t,o,i,d]);(0,n.useEffect)((()=>{Me().u.onResults({environment:u})}),[u]),(0,n.useEffect)((()=>{if(!j.current)return;const e=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&W()}),{threshold:1});return e.observe(j.current),()=>e.disconnect()}),[j,W]);const H=(0,n.useCallback)((()=>w(!0)),[]),G=(0,n.useCallback)((()=>w(!1)),[]),Y=(0,n.useCallback)((e=>{const t=(null==e?void 0:e.height)??0;x(t>=f&&!v)}),[v,f]),q=(0,n.useCallback)((()=>{p.isPhone?$.open(t.id):(S(!0),W()),null==a||a(),(0,D().u4)({environment:u,event:{eventName:"post_see_more_clicked",eventProperties:{block_id:t.id,rank:i,from:o?"unified_feed":"team_feed"}}})}),[S,W,u,t,i,o,a,p.isPhone]),J=(0,ke().T4)(),X=(0,s().K8)((()=>(0,ue().A)({environment:u,store:t,pageViewBlockStore:void 0})),[u,t]),Z=(0,n.useMemo)((()=>p.isMobile?mt.mobile:mt.desktop),[p]),te=(0,l().IS)((t=>{const{unhoveredBoxShadow:n,hoveredBoxShadow:i}=(0,ie().vy)({isPhone:g,theme:t}),r="dark"===t.mode;return{container:{position:"relative",padding:(0,ie().OD)(p),..."card"===e.mode&&{boxShadow:C?i:n,borderRadius:"12px",background:r?t.surface.wash:t.surface.page},..."minimal"===e.mode&&{borderBottomColor:t.regularDividerColor,borderBottomWidth:1,borderBottomStyle:"solid",background:t.surface.page},...E?{}:{height:Z}},titleRow:{display:"flex",alignItems:"baseline"},postIcon:{marginTop:2,marginRight:4},postSubject:{fontSize:26,marginBottom:8,fontWeight:M().Wy.semibold,...p.isMobile&&{fontSize:20,lineHeight:"130%"}},authorRow:{marginTop:2,marginBottom:2},postContent:{fontSize:14,overflowY:"hidden",maxHeight:v?void 0:f,position:"relative",...p.isPhone&&{pointerEvents:"none"}},commentContainer:{display:"flex",gap:gt,alignItems:"center",paddingTop:12},postIsReadCheckpoint:{position:"absolute",bottom:0,right:0,width:"100%"},mobileGradient:{position:"absolute",zIndex:1,left:0,right:0,height:30,background:`linear-gradient(to bottom, ${t.contentBackgroundTransparent} 0px, ${t.selectedMarginDiscussionBackground} 30px)`,marginTop:-28},contentContainer:{paddingLeft:30,paddingRight:"card"===e.mode?30:0,...m&&{paddingLeft:8,paddingRight:"card"===e.mode?8:0},...p.isMobile&&{paddingLeft:45},...p.isMobile&&!o&&{marginTop:-12}},contentWrapper:{position:"relative"},pageDiscussionsWrapper:{width:"100%"}}}),[g,p,e.mode,C,v,o,f,m,E,Z]),oe=(0,fe().i)();if(!_)return null;const ne=A&&(0,lt.jsx)(he().A,{style:te.postSubject,store:A,disabled:!0,disableEquationInteraction:!0,disableComment:!0,inPageFind:xe().Os.none,disableStyleAnnotations:d},t.id),Re=p.isMobile?{tabIndex:0,onClick:q,style:te.contentWrapper}:{style:te.contentWrapper};return(0,lt.jsx)(pe().Ay,{ref:k,style:J.popup,popupType:p.isMobile?pe().z7.SlideUp:pe().z7.Popup,bottomSheetInitialState:"half",stopClickPropagation:!0,render:e=>(0,lt.jsx)(pt,{blockStore:t,closeMenu:e.close,feedType:o?"unified_feed":"team_feed"}),renderOrigin:()=>(0,lt.jsxs)("div",{style:te.container,onMouseEnter:H,onMouseLeave:G,...I,children:[!p.isPhone&&!d&&(0,lt.jsx)(ut,{show:C,blockStore:t,feedType:o?"unified_feed":"team_feed"}),(0,lt.jsx)("div",{style:te.authorRow,children:"minimal"===e.mode?(0,lt.jsx)(de().e,{lastEditedTime:P.lastEditedTime,createdTime:P.createdTime,location:"mobile_post_creator",teamStore:o?K:void 0,authorStore:_}):(0,lt.jsx)(de().Y,{lastEditedTime:P.lastEditedTime,createdTime:P.createdTime,location:"post_creator",teamStore:o?K:void 0,authorStore:_})}),(0,lt.jsxs)("div",{style:te.contentContainer,children:[(0,lt.jsxs)("div",{style:te.titleRow,children:[!1!==(null==c?void 0:c.show_page_icon)&&T&&(0,lt.jsx)(me().B,{icon:T,isEmptyPage:!1,size:26,largeIcon:!0,disabled:!0,style:te.postIcon}),F&&A&&(d?ne:p.isMobile?(0,lt.jsx)("div",{onClick:()=>$.open(t.id),role:"button",tabIndex:-1,style:T?oe:void 0,children:ne}):(0,lt.jsx)("span",{style:T?oe:void 0,children:(0,lt.jsx)(ge().A,{href:U,children:ne})}))]}),(0,lt.jsx)(ye().EE,{onSizeChange:Y,children:(0,lt.jsxs)("div",{...Re,children:[(0,lt.jsx)("div",{style:te.postContent,children:(0,lt.jsx)(Se().c.Provider,{value:!0,children:(0,lt.jsx)(ve().A,{store:R,forceIsInsideMarginCollapseContainer:!0,disabled:!0,disableHoverMenu:!0,disableCommentMenu:!0,disableSuggestEdit:!0})})}),b&&!v&&(p.isPhone?(0,lt.jsx)("div",{style:te.mobileGradient}):(0,lt.jsx)(ce().d,{enableIcon:!p.isPhone,onClick:q})),(0,lt.jsx)("div",{ref:j,style:te.postIsReadCheckpoint})]})}),!d&&(0,lt.jsx)("div",{style:te.commentContainer,children:(0,lt.jsx)(Ie().d,{store:t,pageViewBlockContext:V().Rr.PostInFeed,pageDiscussionsRenderState:X,wrapper:e=>(0,lt.jsx)("div",{style:te.pageDiscussionsWrapper,children:e}),collapsed:!0,discussionLocation:"post_top_level_discussion",pageVisitStore:z,presenceStore:O})})]})]})})}function vt(e){var t;const{posts:o,inUnifiedFeed:i,renderCaughtUpAction:s,hasMore:a,genericFeedDisplaySettings:d}=e,[c,u]=(0,n.useState)(void 0),p=(0,r().v3)(),g=(0,r().Y0)(),m=p.currentUser.id,[f,v]=(0,ne().z)(),S=(0,h().tV)(),y=(0,n.useMemo)((()=>{const e=o.map(((e,t)=>({type:"user-created",store:e,index:t,inUnifiedFeed:i,renderCaughtUpAction:s,renderCaughtUpPostId:c})));return!a&&S&&e.push({type:"welcome",store:S,inUnifiedFeed:i}),e}),[o,i,s,c,a,S]),x=(0,n.useContext)(oe().R),C=null==x?void 0:x.verticalScroller,w=v<600||p.device.isMobile,j=(0,n.useCallback)((()=>(null==C?void 0:C.getNode())??null),[C]),[k,I]=(0,n.useState)(0);(0,n.useLayoutEffect)((()=>{function e(){var e,t;I(Math.floor(((null===(e=f.current)||void 0===e?void 0:e.getBoundingClientRect().top)??0)+((null===(t=j())||void 0===t?void 0:t.scrollTop)??0)))}e();const t=requestAnimationFrame(e),o=new ResizeObserver((t=>{t[0]&&e()})),n=j();return n&&o.observe(n),()=>{o.disconnect(),cancelAnimationFrame(t)}}),[f,j]);const A=(0,n.useMemo)((()=>({key:e.sizesKey,sizes:new Map})),[e.sizesKey]);function M(e){return"user-created"===y[e].type?y[e].store.id:"welcome"}const T=(0,J().Te)({count:y.length,getItemKey:M,getScrollElement:j,estimateSize:()=>g.isMobile?mt.mobile:mt.desktop,overscan:2,gap:(0,ie().iq)(g),scrollMargin:k,useAnimationFrameWithResizeObserver:!0,measureElement:(e,t)=>{const o=M(Number(e.getAttribute("data-index")));null!=t&&t.contentRect.height&&A.sizes.set(o,t.contentRect.height);const n=A.sizes.get(o);return n||e.getBoundingClientRect().height},initialOffset:null===(t=j())||void 0===t?void 0:t.scrollTop}),R=(0,n.useCallback)((()=>{T.shouldAdjustScrollPositionOnItemSizeChange=()=>(T.shouldAdjustScrollPositionOnItemSizeChange=void 0,!1)}),[T]);(0,n.useEffect)((()=>{if(!m||c)return;(async()=>{const e=await(0,Z().lX)(o,10,(async e=>{const t=e.getCreatedById()===m,o=e.pointer.spaceId;if(t||!o)return{id:e.id,read:!0};const n=(0,Q().$5)({parent_id:e.id,user_id:m}),i=(0,b().Oo)(e,{table:Q().F9,id:n,spaceId:o});await i.load();const r=i.getKeyStore("visited_at").getValue();return{id:e.id,read:Boolean(r)}})),t=null==e?void 0:e.findIndex((e=>e.read)),n=t>0?e[t]:null;u(null==n?void 0:n.id)})()}),[c,o,m]);const _=T.getTotalSize(),P=(0,l().IS)((e=>({container:{height:_,position:"relative"},item:{position:"absolute",top:0,left:0,width:"100%"}})),[_]);return(0,lt.jsx)("div",{ref:f,style:P.container,children:T.getVirtualItems().map((e=>(0,lt.jsx)("div",{"data-index":e.index,ref:T.measureElement,style:{...P.item,transform:`translateY(${e.start-T.options.scrollMargin}px)`},children:(0,lt.jsx)(ht,{item:y[e.index],renderCaughtUpPostId:c,renderCaughtUpAction:s,onShowMoreClicked:R,useMinimalLayout:w,genericFeedDisplaySettings:d})},"string"==typeof e.key?e.key:"unknown")))})}function ht(e){const{item:t,renderCaughtUpPostId:o,renderCaughtUpAction:i,onShowMoreClicked:r,useMinimalLayout:s,genericFeedDisplaySettings:l}=e,a=s?"minimal":"card";return"user-created"===t.type?(0,lt.jsxs)(n.Fragment,{children:[t.store.id===o&&(0,lt.jsx)(St,{renderCaughtUpAction:i}),(0,lt.jsx)(ft,{store:t.store,index:t.index,inUnifiedFeed:t.inUnifiedFeed,onShowMoreClicked:r,mode:a,genericFeedDisplaySettings:l})]}):"welcome"===t.type?(0,lt.jsx)(ft,{store:t.store,disableInteraction:!0,index:-1,inUnifiedFeed:t.inUnifiedFeed,mode:a,genericFeedDisplaySettings:l}):void(0,ee().HB)(t)}function St(e){const{renderCaughtUpAction:t}=e,o=(0,l().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:12,paddingTop:24,paddingBottom:24,alignItems:"center"},textWrapper:{display:"flex",flexDirection:"column",gap:2,alignItems:"center"},primaryText:{fontSize:M().J.UIRegular.desktop,fontWeight:M().Wy.medium,color:A().Tj.mediumTextColor}})),[]);return(0,lt.jsxs)("div",{style:o.container,children:[(0,lt.jsx)(te().Q,{iconGroup:X().a,variantName:"fill",colorName:"tertiary"}),(0,lt.jsxs)("div",{style:o.textWrapper,children:[(0,lt.jsx)("div",{style:o.primaryText,children:(0,lt.jsx)(I().sA,{defaultMessage:"You‘re all caught up",id:"posts.discoverCTA.caughtUp"})}),t]})]})}function yt(e){const{posts:t,draftPostStore:o,createDraft:i,composerStyle:a,setComposerStyle:d,inUnifiedFeed:c,canWritePosts:p,teamStore:g,collectionContextStore:m,subscribedUserTeamStores:f,hasMore:v}=e,S=(0,r().v3)(),{isMobile:y}=(0,r().Y0)(),{WindowSizeStore:b}=S,{canJoinTeam:x,postingRestricted:w}=(0,E().i)({teamStore:g}),j=(0,s().K8)((()=>H().A.state.isOpen),[]),I=function(){const[e,t]=(0,n.useState)(void 0),o=(0,s().K8)((()=>e&&!e.pathIsDead()),[e]),[i,r]=(0,n.useState)(!1),l=(0,n.useCallback)((()=>{r(!0)}),[]),a=(0,n.useCallback)((e=>{t(e),r(!1)}),[]),d=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{d.current=Boolean(o&&!i)}),[o,i]),(0,W().X)((()=>{d.current&&u().u4({name:"abandon_draft_post"})})),{handleCreatedDraft:a,handleComposerFullScreenClick:l,handleComposerDraftDiscarded:(0,n.useCallback)((()=>{u().u4({name:"abandon_draft_post"})}),[])}}(),A=(0,n.useCallback)((()=>{const e=i();return I.handleCreatedDraft(e),e}),[i,I]),M=(0,n.useCallback)((()=>{C().tt({environment:S,draftPostStore:o,from:c?"unified_feed":"team_home"}),null==d||d("preview")}),[o,S,d,c]),P=(0,n.useCallback)((()=>{o&&(0,N().s)(o)?H().A.setState({isOpen:!0}):M()}),[o,M]),U=(0,n.useCallback)((()=>{o&&(R().createAndCommit({environment:S,perform:e=>{T().zv({store:o,data:{alive:!1,permissions:[]},transaction:e})},userAction:"PostChannel.discardDraft",canUndo:!1}),I.handleComposerDraftDiscarded())}),[o,S,I]),D=(0,h().Vs)(),G=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:16,paddingTop:2,paddingLeft:0,maxWidth:D?752:void 0}})),[D]),J=(0,h().lU)(),X="PersonalHome"===J&&(!f||0===f.length),Q="TeamHome"===J&&(p||x||w),Z=(0,s().K8)((()=>c&&(null==m?void 0:m.databaseType)===k().SC),[m,c]),ee=(0,s().K8)((()=>{var e;return null==m||null===(e=m.collectionStore())||void 0===e?void 0:e.isPublishingEnabled()}),[m]),te=void 0===J,oe=Z||Q||te&&ee,ne=(0,s().K8)((()=>"open"===$.state.type),[]),ie=(0,s().K8)((()=>(0,_().gj)(S,b.state.height)),[S,b]),re=(0,s().K8)((()=>{if("open"!==$.state.type)return;const e=$.state.storeId;return t.find((t=>t.id===e))}),[t]),se=(0,s().K8)((()=>{const e=null==m?void 0:m.collectionViewStore(),t=null==m?void 0:m.getViewType(),o=null==e?void 0:e.getFormat();if(e&&t&&o&&"feed"===t&&te)return{show_page_icon:o.show_page_icon,collection_peek_mode:o.collection_peek_mode}}),[m,te]);return(0,lt.jsxs)("div",{style:G.container,children:[oe&&(0,lt.jsx)(q().pM,{collectionContextStore:"PersonalHome"===J?m:void 0,showEmptyComposerInUnifiedFeed:X,teamStore:g,postStore:o,isEditing:!1,onSubmit:P,createDraft:A,onFullScreenClick:I.handleComposerFullScreenClick,discardDraft:U,composerStyle:a,setComposerStyle:d}),(0,lt.jsx)(vt,{posts:t,inUnifiedFeed:c,renderCaughtUpAction:(0,lt.jsx)(bt,{collectionContextStore:m}),sizesKey:`${c?"unified":null==g?void 0:g.id}`,hasMore:v,genericFeedDisplaySettings:se}),y&&re&&(0,lt.jsx)(F().Ay,{popupType:O().n.BottomSheet,open:ne,onDismiss:()=>$.close(),bottomSheetInitialState:"full",trapFocus:!0,render:()=>(0,lt.jsx)(L().A,{menuType:z().gu.Modal,hideMobileTopbar:!0,children:(0,lt.jsx)(B().A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,lt.jsx)(K().Ay,{store:re,context:V().Rr.Frame,paddingBottom:ie,disabled:!0})})})}),(0,lt.jsx)(Y().A,{postStore:o,isOpen:j,onDismiss:()=>H().A.setState({isOpen:!1}),onConfirm:()=>{H().A.setState({isOpen:!1}),M()}})]})}function bt(e){const t=(0,r().v3)(),{collectionContextStore:o}=e,n=(0,l().IS)((e=>({secondaryText:{fontSize:M().J.UIRegular.desktop,fontWeight:M().Wy.regular,color:A().Ay.mediumTextColor},container:{display:"flex",flexDirection:"column",gap:12,alignItems:"center"}})),[]),i=(0,s().K8)((()=>{var e,n;const i=null==o||null===(e=o.collectionViewStore())||void 0===e?void 0:e.getCollectionSource(),r="typed"===(null==i?void 0:i.type)&&"notion://posts_collection_discover"===(null==i?void 0:i.databaseType);if(!o||r)return;const s=null==o||null===(n=o.collectionViewBlockStore())||void 0===n?void 0:n.getCollectionViewStores().find((e=>{const t=e.getCollectionSource();return"typed"===(null==t?void 0:t.type)&&"notion://posts_collection_discover"===t.databaseType}));return s?()=>{(0,P().t)({environment:t,collectionContextStore:o,collectionViewId:s.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),(0,D().u4)({environment:t,event:{eventName:"posts_discover_upsell_clicked",eventProperties:{}}})}:void 0}),[o,t]);return i?(0,lt.jsxs)("div",{style:n.container,children:[(0,lt.jsx)("div",{style:n.secondaryText,children:(0,lt.jsx)(I().sA,{defaultMessage:"Discover posts across the workspace",id:"posts.discoverCTA.discoverText"})}),(0,lt.jsx)(U().A,{size:"md",onClick:i,children:(0,lt.jsx)(I().sA,{defaultMessage:"Discover More",id:"posts.discoverCTA.discoverMore"})})]}):null}const xt=[];function Ct(e){const{collectionViewStore:t,collectionContextStore:o,paddingLeft:k,paddingRight:I}=e,[A,M]=(0,n.useState)("preview"),T=(0,r().v3)(),R=(0,s().K8)((()=>{var e;return null===(e=(0,S()._m)(T))||void 0===e?void 0:e.id}),[T]),_=(0,s().K8)((()=>t.getCollectionStore()),[t]),P=(0,s().K8)((()=>o.collectionViewBlockStore()),[o]),B=(0,s().K8)((()=>null==P?void 0:P.getParentStore()),[P]),L=(0,s().K8)((()=>o.groupsStore.getGroupState(xt)),[o]),U=(0,s().K8)((()=>{var e;return(null==L||null===(e=L.currentLimit)||void 0===e?void 0:e.state)??10}),[null==L?void 0:L.currentLimit]),F=void 0===_,K={type:"results",filter:{operator:"and",filters:[]},limit:U},D=(0,f().A)({id:"default_posts_collection_key",reducer:K,collectionContextStore:o,groupsPointer:xt}),[z,O]=(0,n.useState)(!1);(0,n.useEffect)((()=>{null==L||L.reducerResultStore.setState(D),D&&O(!0)}),[D,null==L?void 0:L.reducerResultStore]),(0,n.useEffect)((()=>{u().u4({name:"open_feed",args:{feed_type:F?"unified":"team"}})}),[F]);const{draftPosts:V,allPosts:E}=(0,s().K8)((()=>{if(null==L||!L.resultsStore||!z)return{draftPosts:void 0,allPosts:void 0};return((null==L?void 0:L.resultsStore.state)??[]).reduce(((e,t)=>{t.uiLocation.removeParent();const o=t.getModel();return"draft"===(null==o?void 0:o.getDraftStatus())?e.draftPosts.push(t):e.allPosts.push(t),e}),{draftPosts:[],allPosts:[]})}),[null==L?void 0:L.resultsStore,z]),N=(0,s().K8)((()=>Boolean(m().XQ({collectionContextStore:o,reducerResult:D,isFullScreen:!1}))),[o,D]),W=(0,s().K8)((()=>P?(0,lt.jsx)(v().jJ,{groupsPointer:xt,store:P,collectionContextStore:o,format:t.getFormat(),isFullScreen:o.isFullScreenStore.state,incrementLimitsInRelatedGroups:!1}):void 0),[P,o,t]),H=(0,h().lU)(),G=(0,s().K8)((()=>{if("TeamHome"!==H||!_)return;const e=_.id,t=y().default.state.currentSpaceStore;return t&&e?b().sk.createChildStore(t,{table:"team",id:e,spaceId:t.id}):void 0}),[_,H]),$=(0,s().K8)((()=>Boolean(R)&&(d().p2((null==_?void 0:_.getRole())??"none")??!1)),[R,_]),Y=(0,s().O$)(o.isLoadedStore),{currentSpaceViewStore:q,currentSpaceStore:J}=(0,s().K8)((()=>({currentSpaceViewStore:y().default.state.currentSpaceViewStore,currentSpaceStore:y().default.state.currentSpaceStore})),[]),[{value:X}]=(0,a().Yb)((async()=>{if(!J)return{unsubscribedTeamIds:void 0};const e=await p().callApi({eventName:"getSubscribedAndUnsubscribedTeams",environment:T,data:{spaceId:J.id}});if("failed"===e.type)throw e.error;return"success"===e.type?{unsubscribedTeamIds:e.data.unsubscribedTeamIds}:e}),[J,T]),{unsubscribedTeamIds:Q}=X??{unsubscribedTeamIds:void 0},Z=(0,n.useMemo)((()=>i().A.withListenerIgnored((()=>null==q?void 0:q.getTeamsStores()))),[q]),ee=(0,s().K8)((()=>{if(Z&&Q)return null==Z?void 0:Z.filter((e=>!(null!=Q&&Q.includes(e.id))&&e.allowsUserToPost()))}),[Z,Q]),te=(0,s().K8)((()=>{const e=t.getCollectionSource();if("typed"===(null==e?void 0:e.type))return e.teamId}),[t]),oe=(0,s().K8)((()=>{if(te&&J)return b().h4.createChildStore(J,{table:c().yK,id:te,spaceId:J.id})}),[te,J]),ne=(0,s().K8)((()=>{if(!oe||!R)return!1;return oe.isMemberOrGuest(R,x()._.getSpacePermissionGroupIds({userId:R,spaceId:oe.getSpaceId()}))}),[oe,R]),ie=(0,s().K8)((()=>!!oe&&oe.allowsUserToPost()),[oe]);(0,n.useEffect)((()=>{if(ee&&te&&Q&&(Q.includes(te)||!ne||!ie)){const e=ee[0];e&&(0,w().z)({environment:T,collectionContextStore:o,currentSpaceViewStore:q,selectedStore:e,postStore:void 0}),g().YH(),M("preview")}}),[Q,te,T,o,q,ee,ne,ie]);const re=(0,s().K8)((()=>{const e=t.getCollectionSource();if("typed"===(null==e?void 0:e.type)){var o;return(null==e?void 0:e.teamId)??(null==ee||null===(o=ee[0])||void 0===o?void 0:o.id)}}),[t,ee]),se=null==ee?void 0:ee.find((e=>e.id===re));(0,n.useEffect)((()=>{se&&ee&&o&&Y&&j().u.setState({selectedTeamStore:se,subscribedUserTeamStores:ee,collectionContextStore:o,isPostsCollectionLoaded:Y,setComposerStyle:M,teamTargetMobilePopupOpen:j().u.state.teamTargetMobilePopupOpen})}),[se,ee,o,Y]);const le=(0,s().K8)((()=>{if(V){if(F){return V.find((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===(null==se?void 0:se.id)}))}return V[0]}}),[V,se,F]),ae=(0,s().K8)((()=>{if(!J||!se)return;const e=b().sk.createUniqueRootStore(T,{table:"block",id:se.id,spaceId:J.id});return e.isCollectionView()?e:void 0}),[T,J,se]),de=(0,s().K8)((()=>null==ae?void 0:ae.getCollectionStore()),[ae]),ce=(0,n.useCallback)((()=>{const e=F?de:_;if(($||F)&&e)return(0,C().Nm)({environment:T,collectionStore:e,selectedTeamCollectionStore:de})}),[T,_,$,de,F]),ue=(0,l().IS)((()=>({padding:{paddingLeft:k,paddingRight:I},loadMore:{paddingTop:24,paddingBottom:24}})),[k,I]);return Y&&void 0!==E&&B?(0,lt.jsxs)("div",{style:ue.padding,children:[(0,lt.jsx)(yt,{collectionContextStore:o,posts:E,draftPostStore:le,composerStyle:A,setComposerStyle:M,createDraft:ce,inUnifiedFeed:F,canWritePosts:$,teamStore:G,subscribedUserTeamStores:ee,hasMore:N}),N&&(0,lt.jsx)("div",{style:ue.loadMore,children:W})]}):null}var wt=()=>o(64713),jt=()=>o(142708),kt=()=>o(73876),It=()=>o(116485),At=()=>o(520969),Mt=()=>o(98508),Tt=()=>o(460686),Rt=()=>o(372078),_t=()=>o(501633);function Pt(){const e=(0,r().v3)(),[t,o]=(0,n.useState)(void 0),i=(0,s().K8)((()=>{const e=null==t?void 0:t.isLoadedStore.state;return Boolean(e)}),[t]);(0,n.useEffect)((()=>{var t;null===(t=e.mobileNative)||void 0===t||t.markTransitionReady({environment:e,type:"posts"})})),(0,n.useEffect)((()=>{Me().u.initMeasurement({homeType:"personal"})}),[]);const a=(0,s().K8)((()=>({top:e.WindowSizeStore.getSafePaddingBottomPx(0),bottom:e.WindowSizeStore.getSafePaddingBottomPx(0)})),[e.WindowSizeStore]),d=(0,l().IS)((e=>{const t=a.bottom+70;return{pageLayout:{paddingTop:24,order:3,display:"flex",flexDirection:"column",width:"100%",backgroundColor:e.contentBackground},scroller:{marginBottom:a.bottom,width:"100%",paddingBottom:t+44},layoutContent:{flex:1,marginLeft:22,height:"100%"},header:{fontSize:36,fontFamily:M().Tf.sans,fontWeight:M().Wy.bold,marginLeft:22,marginBottom:8},container:{width:"100%",height:"100%",display:"flex"}}}),[a.bottom]);(0,_t().e)();const c=(0,n.useCallback)((e=>{kt().A.PageScroller=e}),[]),u=(0,s().K8)((()=>{const e=(0,At().XH)("posts");if(null!=e&&e.isCollectionView())return e}),[]);return u?(0,lt.jsx)("div",{id:q().d_,className:"home-content",style:d.container,children:(0,lt.jsx)(jt().H,{type:Mt().A.Y,ref:c,style:d.scroller,children:(0,lt.jsx)(It().Mx,{type:"home-phone",style:d.pageLayout,children:(0,lt.jsxs)(It().vV,{style:d.layoutContent,children:[(0,lt.jsx)("div",{style:d.header,children:(0,lt.jsx)(I().sA,{id:"posts.mobile.header",defaultMessage:"Feed"})}),(0,lt.jsx)(wt().dN,{setCollectionContextStore:o,store:u,disabled:!1,isFullScreen:!1,productUseCase:"mobile_feed",overrideViewType:"feed",isFirstItem:!0,isLastItem:!0,hideViewTabBar:!1,headerAllowedActions:Rt().l}),!i&&(0,lt.jsx)(Tt().SU,{hasComposer:!1})]})})})}):null}o(107652);var Bt=()=>o(16791),Lt=()=>o(846581),Ut=()=>o(1476);const Ft=(0,o(680369).xh)("eye",{default:{loader:()=>o.e(64632).then(o.bind(o,434626))},small:{loader:()=>o.e(64632).then(o.bind(o,767976))},fill:{loader:()=>o.e(64632).then(o.bind(o,121330))},fillSmall:{loader:()=>o.e(64632).then(o.bind(o,42635))}},["eye","vision","see","look","observe"]);var Kt=()=>o(409211),Dt=()=>o(14931),zt=()=>o(975392),Ot=()=>o(111066),Vt=()=>o(172007),Et=()=>o(466754),Nt=()=>o(126451),Wt=()=>o(732165),Ht=()=>o(482570),Gt=()=>o(8519),$t=()=>o(73410),Yt=()=>o(637269),qt=()=>o(800825),Jt=()=>o(802955),Xt=()=>o(216273);const Qt=5,Zt=25,eo=20,to=2;function oo(e){return zt().Ul(e,(e=>e.activityTimestampNearestMinuteMs))}function no(e,t){return b().LU.createChildStore(t,{table:Kt().oo,id:e})}function io(e){return{color:e.text.contrastSecondary,fontSize:12}}function ro(e){let{userData:t,isPresent:o,rootStore:n,isShowingInPostFeed:i}=e;const a=(0,l().DP)(),d=(0,r().v3)(),c=(0,I().tz)(),u=d.currentUser.id,p=(0,s().K8)((()=>no(t.userId,n)),[t,n]),g=(0,s().K8)((()=>p.isDefined()),[p]),m=(0,s().K8)((()=>(0,Dt().c6)(c,p.getModel())),[c,p]),f=(0,s().K8)((()=>p.getEmail()),[p]);if(!g)return null;let v;return o?u!==p.id&&(v=t.blockId&&!i?(0,lt.jsx)(I().sA,{defaultMessage:"Viewing now. Click to see where they are.",id:"post.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,lt.jsx)(I().sA,{defaultMessage:"Viewing now",id:"post.presenceIndicator.viewingNow.tooltip"})):u!==p.id&&t.activityTimestampNearestMinuteMs&&(v=(0,lt.jsx)(I().sA,{defaultMessage:"Last viewed {timeFromNow}",id:"post.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,Lt().v9)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),Bt().locale)}})),(0,lt.jsxs)("div",{children:[(0,lt.jsx)("div",{className:"notranslate",children:m}),(0,lt.jsx)("div",{style:{fontWeight:400},children:f}),v&&(0,lt.jsx)("div",{style:{color:a.text.contrastSecondary,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:v})]})}function so(e){let{userData:t,index:o,rootStore:n}=e;const i=(0,l().DP)(),a=(0,r().v3)(),d=(0,qt().dp)(a,t),c=(0,s().K8)((()=>no(t.userId,n)),[t,n]);if(!(0,s().K8)((()=>c.isDefined()),[c]))return null;let u;!d&&t.activityTimestampNearestMinuteMs&&(u=(0,Lt().v9)(t.activityTimestampNearestMinuteMs,Bt().locale));const p=(0,lt.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,lt.jsx)(Wt().A,{userStore:c,avatarSize:18,style:{flexGrow:1}}),(0,lt.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:i.text.contrastSecondary},children:u})]});if(d&&t.blockId){const e=t.blockId;return(0,lt.jsx)(Nt().A,{onClick:()=>Ot().BL([e],!0,a),style:{display:"flex",alignItems:"center"},children:p})}return(0,lt.jsx)("div",{style:{display:"flex",alignItems:"center"},children:p})}function lo(e){let{hiddenUsers:t,hiddenUsersCount:o,hasMore:n,rootStore:i,events:s}=e;const a=(0,l().DP)(),d=(0,r().v3)(),c=[],u=[];for(const r of t)(0,qt().dp)(d,r)?c.push(r):u.push(r);const p=u.slice(0,Zt-c.length),g=o-(c.length+p.length);return(0,lt.jsxs)("div",{...s,children:[c.length>0&&(0,lt.jsxs)("div",{style:{marginBottom:4},children:[(0,lt.jsx)(Qe().A,{style:io(a),children:(0,lt.jsx)(I().sA,{defaultMessage:"Viewing now",id:"post.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),c.map(((e,t)=>(0,lt.jsx)(so,{userData:e,index:t,rootStore:i},t)))]}),p.length>0&&(0,lt.jsxs)("div",{style:{marginBottom:4},children:[(0,lt.jsx)(Qe().A,{style:{...io(a)},children:(0,lt.jsx)(I().sA,{defaultMessage:"Last viewed by",id:"post.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),p.map(((e,t)=>(0,lt.jsx)(so,{userData:e,index:t,rootStore:i},t)))]}),(0,lt.jsx)(ao,{remainingHiddenUsersCount:g,hasMore:n})]})}function ao(e){let{hasMore:t,remainingHiddenUsersCount:o}=e;const n=(0,l().IS)((e=>({message:{marginLeft:2,marginTop:2,color:e.text.contrastSecondary}})),[]);return o>0?(0,lt.jsx)("div",{style:n.message,children:t?(0,lt.jsx)(I().sA,{defaultMessage:"{remainingVisitorsCount}+ more…",id:"topbarPresence.presenceIndicator.hiddenUsers.evenMoreUsersNotViewing.tooltip",values:{remainingVisitorsCount:o}}):(0,lt.jsx)(I().sA,{defaultMessage:"{remainingVisitorsCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{remainingVisitorsCount:o}})}):null}function co(e){const{userData:t,rootStore:o,isShowingInPostFeed:i=!1}=e,a=(0,r().v3)(),{userId:d}=t,c=(0,qt().dp)(a,t),{userStore:u,showAvatar:p}=(0,s().K8)((()=>{if((0,Kt().MF)(d))return{userStore:Ut().px,showAvatar:!0};const e=no(d,o);return{userStore:e,showAvatar:(e.isDefined()||(0,Kt().MF)(e.id))&&!e.getIsSuspended()}}),[d,o]),g=function(e,t){return(0,l().IS)((o=>{const n={width:eo,height:eo,borderRadius:eo},i=e(o);return{button:{transition:"all 0.2s ease",transform:"scale(1)"},buttonHovered:{transform:"scale(1.15)",background:"none"},buttonPressed:{transform:"scale(0.9)",background:"none"},uiUserAvatarStyles:{...n},avatarInnerOutline:{...n,outlineStyle:"solid",outlineColor:o.UIUserAvatarInnerOutline,outlineWidth:.5,outlineOffset:-.5},avatarBorder:t?{...n,outlineStyle:"solid",outlineColor:i,outlineWidth:1.5,outlineOffset:-.5}:n,avatarOuterOutline:{...n,outlineStyle:"solid",outlineColor:t?o.UIUserAvatarOuterOutline:o.UIUserAvatarIdleOutline,outlineWidth:.5,outlineOffset:t?1:0,marginRight:-6,position:"relative"},initialColor:{color:t?i:o.icon.secondary}}}),[e,t])}((0,n.useCallback)((e=>d===a.currentUser.id?e.UIUserAvatarSelfBorder:(0,A().Nq)(d,e)),[a.currentUser.id,d]),c);return p?(0,lt.jsx)(Xe().A,{disableTooltip:i,textWrap:!0,renderTooltip:()=>(0,lt.jsx)(ro,{rootStore:o,userData:t,isPresent:c,isShowingInPostFeed:i}),render:e=>{const o=(0,lt.jsx)("div",{style:g.avatarOuterOutline,children:(0,lt.jsx)("div",{style:g.avatarBorder,children:(0,lt.jsx)(Ht().A,{iconStyle:g.avatarInnerOutline,userStore:u,style:g.uiUserAvatarStyles,size:eo,avatarShouldShowShadow:!1,initialOverrideStyle:g.initialColor})})});if(c&&t.blockId){const n=t.blockId;return(0,lt.jsx)(Nt().A,{...e,onClick:()=>Ot().BL([n],!0,a),style:g.button,hoveredStyle:g.buttonHovered,pressedStyle:g.buttonPressed,children:o})}return(0,lt.jsx)("div",{...e,children:o})}}):null}function uo(e){const{rootStore:t,pageVisitStore:o,presenceStore:n,maxUsers:i,isShowingInPostFeed:a,enableFacepile:d=!0}=e,c=(0,r().v3)(),u=(0,r().Y0)(),p=c.currentUser.id,g=(0,s().K8)((()=>{const e=c.currentUser.id;if(!e)return;const r=(0,qt().PZ)({pageVisitStore:o,presenceStore:n}),s=(null==o?void 0:o.state.totalCount)??r.length,l=[],a=[];for(const t of r)t.userId!==e&&((0,qt().dp)(c,t)?l.push(t):a.push(t));t.isNavigableBlock()&&(0,Vt().BP)(t,c,c.device)&&l.push({userId:Ut().px.id,present:!0});const d=[...oo(l).reverse(),...oo(a).reverse()],u=function(e){return e??Qt}(i)-1;return{visibleUsers:d.slice(0,u),hiddenUsers:d.slice(u),totalCount:s,hasMore:Boolean(null==o?void 0:o.state.hasMore)}}),[o,n,c,i,t],{useDeepEqual:!0}),{visibleUsers:m,hiddenUsers:f,hiddenUsersCount:v,hasMoreHiddenUsers:h,isEveryUserStoreReady:S}=(0,s().K8)((()=>{if(!p)return{};const{visibleUsers:e=[],hiddenUsers:o=[]}=g??{},n=[p,...e.map((e=>e.userId)),...o.map((e=>e.userId))].map((e=>no(e,t)));return{visibleUsers:e,hiddenUsers:o,hiddenUsersCount:Number(null==g?void 0:g.totalCount)-e.length,hasMoreHiddenUsers:Boolean(null==g?void 0:g.hasMore),isEveryUserStoreReady:n.every((e=>e.isReady()||(0,Kt().MF)(e.id)))}}),[p,g,t]),y=(0,s().O$)(Xt().b),b=(0,$t().useIsDictatingToPage)(t),x=!(0,s().O$)(Jt().e),C=(0,l().IS)((e=>({presenceContainer:{...(0,Yt().g)({noDrag:c.device.isElectron&&!y}),display:"flex",gap:d?12:4,alignItems:"center",position:"relative",...Et().Of,width:"fit-content",padding:to,borderRadius:18,transform:"translateZ(0)",...u.isMobile?{...Et().ZR,padding:"1px 4px"}:{}},totalCount:{color:e.text.secondary,fontSize:13,marginRight:8},avatarsContainer:{display:"flex",flexDirection:"row-reverse",alignItems:"center"},eyeIcon:{color:e.text.secondary}})),[c.device.isElectron,y,d,u.isMobile]);if(!p||!g||!S||x)return null;if(0===m.length&&0===f.length)return b?(0,lt.jsx)("div",{style:C.presenceContainer,children:(0,lt.jsx)(Gt().hq,{enableClickToScroll:!0,rootStore:t})}):null;if(!d)return(0,lt.jsxs)("div",{style:C.presenceContainer,children:[(0,lt.jsx)(te().Q,{style:C.eyeIcon,iconGroup:Ft,variantName:"small"}),(0,lt.jsx)("span",{style:C.totalCount,children:g.totalCount})]});const w=[...m];return w.reverse(),(0,lt.jsx)(Xe().A,{disableTooltip:!(null==g||!g.totalCount)&&g.totalCount<5,allowHover:!0,originGap:7,renderTooltip:e=>(0,lt.jsx)(lo,{hiddenUsers:f,hiddenUsersCount:v,hasMore:h,rootStore:t,events:e}),render:e=>(0,lt.jsxs)(Nt().A,{style:C.presenceContainer,children:[(0,lt.jsxs)("div",{style:C.avatarsContainer,children:[w.map((e=>(0,lt.jsx)(co,{userData:e,rootStore:t},e.userId))),!a&&(0,lt.jsxs)(lt.Fragment,{children:[(0,lt.jsx)(co,{rootStore:t,userData:{userId:p,present:!0}}),(0,lt.jsx)(Gt().hq,{enableClickToScroll:!0,rootStore:t})]})]}),(0,lt.jsx)("div",{style:C.totalCount,...e,children:null==g?void 0:g.totalCount})]})})}},839466:(e,t,o)=>{o.d(t,{Z:()=>n,o:()=>r});const n=100;class i extends(()=>o(129044))().default{getInitialState(){return{stores:{}}}getStore(e){if(e)return this.state.stores[e]||(this.state.stores[e]=new(o(380123).R)({key:`emojiFrecency:${e}`,namespace:o(146325).Bq,important:!0,trackingType:"necessary"})),this.state.stores[e]}getEmojiFrecencyMap(){var e;const t=this.getStore(null===(e=o(485966).default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId());if(!t)return{};return t.state??{}}}const r=new i},988189:(e,t,o)=>{o.d(t,{A:()=>r});o(242343);var n=()=>o(35462),i=o(163643);const r=function(e){const{type:t,emoji:r,customEmojiStore:s,text:l,deletedText:a,subText:d}=e,c=(0,o(803290).K8)((()=>"custom"===t&&s.isDefined()&&s.getAlive()),[s,t]),u=(0,o(174114).IS)((e=>({container:{alignItems:"center"},label:{color:e.text.contrastPrimary,fontWeight:o(31448).Wy.medium,textAlign:"center",overflowWrap:"anywhere"},emojiContainer:{background:"white",borderRadius:4,padding:4,display:"flex",lineHeight:1,marginTop:2}})),[]);return(0,i.jsxs)(o(610271).wt,{gap:4,style:u.container,children:["custom"===t&&c?(0,i.jsx)("div",{style:u.emojiContainer,children:(0,i.jsx)(o(978483).A,{emojiStore:s,size:40})}):"unicode"===t?(0,i.jsx)("div",{style:u.emojiContainer,children:(0,i.jsx)(o(479813).A,{size:40,char:r})}):null,(0,i.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:"unicode"===t||c?l:a}),d&&(0,i.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:d})]})}}}]);