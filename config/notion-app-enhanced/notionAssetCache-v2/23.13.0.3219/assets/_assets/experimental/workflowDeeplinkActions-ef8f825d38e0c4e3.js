"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10399,11097,90871],{44250:(e,t,o)=>{function n(e){return!(!e||"askUserToPick"in e)}function r(e){if(!e||!("askUserToPick"in e))return e}function a(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}o.d(t,{DK:()=>r,K$:()=>n,j6:()=>a})},137696:(e,t,o)=>{o.d(t,{$X:()=>a,H8:()=>i,x2:()=>r});var n=()=>o(76394);function r(e){return"event"===e||"recurrence"===e}function a(e){const t=e.getTrigger();return(0,n().O9)(t)&&r(t.type)}function i(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,n().HB)(e)}},151602:(e,t,o)=>{o.d(t,{A:()=>a});class n extends(()=>o(129044))().default{getInitialState(){return{}}}const r=new n;o(996094).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",r);const a=r},155342:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>r,questionMarkCircleIcon:()=>a});o(242343);var n=o(163643);const r={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M9.978 7.154c-.804 0-1.333.456-1.438.874a.625.625 0 0 1-1.213-.303c.28-1.121 1.44-1.82 2.65-1.82 1.365 0 2.714.905 2.714 2.298 0 .812-.49 1.477-1.13 1.872l-.755.516a.84.84 0 0 0-.381.677.625.625 0 1 1-1.25 0c0-.688.36-1.318.921-1.706l.003-.002.784-.535.014-.008c.374-.228.544-.537.544-.814 0-.459-.517-1.049-1.463-1.049m.662 6.336a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,n.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},a=(0,o(680369).wt)("questionMarkCircle",r)},271142:(e,t,o)=>{o.d(t,{EC:()=>x,To:()=>T,YC:()=>k,or:()=>M,u:()=>h});o(610931);var n=o(242343),r=()=>o(237385),a=()=>o(803290),i=()=>o(496985),l=()=>o(232312),u=()=>o(653998),c=()=>o(76394),s=()=>o(337658),p=()=>o(73631),d=()=>o(137696),m=()=>o(129978),f=()=>o(113800),y=()=>o(830925),v=o(163643);const _=new WeakMap,g=(0,n.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});g.displayName="AutomationContext";function h(e){const{automationStore:t,children:o,contextType:n}=e,h=(0,r().v3)(),M=(0,u().tz)(),{value:T}=(0,m().fJ)(p().T.formulas),{value:x}=(0,m().fJ)(s().QV.automationTypecheck),k=(0,y().n)(t),S=(0,a().K8)((()=>{if(!T)return{error:new(l().N9)("Missing formulas dependency")};if(!x)return{error:new(l().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:o,automationTypecheckModule:n,contextType:r,formulasModule:a,intl:l,isSubscribed:u}=e,s=_.get(o);if(s)return s;{const e=new(i().default)((()=>{const e=o.getTriggerType();let i=r;return(0,c().O9)(e)&&(0,d().x2)(e)&&(i=(0,d().H8)(e)),(0,f().Z)({environment:t,automationStore:o,automationTypecheckModule:n,contextType:i,formulasModule:a,intl:l,isSubscribed:u})}),{debugName:"automationContextTypecheckResultCachedStore"});return _.set(o,e),e}}({environment:h,automationStore:t,automationTypecheckModule:x,contextType:n,formulasModule:T,intl:M,isSubscribed:k});return e.state}),[h,t,x,n,T,M,k]);return(0,v.jsx)(g.Provider,{value:{automationStore:t,typecheckResult:S,contextType:n,defined:!0},children:o})}function M(e){const{automationStore:t,children:o}=e,n=(0,a().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,v.jsx)(h,{automationStore:t,contextType:(0,d().H8)(n??"event"),children:o})}function T(e){var t;return null===(t=_.get(e))||void 0===t?void 0:t.state}function x(){const e=n.useContext(g);if(!1===e.defined)throw new Error("No automation context found!");return e}function k(){return n.useContext(g)}},367950:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{_:()=>n})},533639:(e,t,o)=>{o.d(t,{p:()=>n});class n extends(()=>o(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},658294:(e,t,o)=>{o.d(t,{G:()=>a});var n=()=>o(137476),r=()=>o(836331);function a(e,t){n().vd(e,"delete_property",t),r().default.logEvent("delete_property")}},686752:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,pencilLineIcon:()=>r});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"m13.987 5.682-.684.684-1.288-1.288.692-.691a.91.91 0 0 1 1.28 0c.35.35.35.93 0 1.28zm-9.433 9.433 7.914-7.914-1.289-1.289-7.92 7.908c-.122.122-.214.29-.274.457l-.336 1.082c-.06.229.153.442.366.366l1.082-.335q.252-.07.457-.275m12.446.76H5.61l1.25-1.25H17a.625.625 0 1 1 0 1.25"})},r=(0,o(680369).wt)("pencilLine",n)},779698:(e,t,o)=>{o.d(t,{Ah:()=>v,Dk:()=>m,Iv:()=>y,SF:()=>f,YO:()=>h,_f:()=>T,c_:()=>p,dW:()=>g,gW:()=>d,sp:()=>x,vN:()=>_});o(610931),o(362833),o(725707),o(491955),o(771702),o(403517),o(113085);var n=()=>o(975392),r=()=>o(204132),a=()=>o(76394),i=()=>o(599932),l=()=>o(465546),u=()=>o(409211),c=()=>o(34662),s=()=>o(876988);function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function d(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function _(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function h(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function M(e){const{formulaAnalyticsModule:t,formulasModule:o,formulaTypecheckContextValues:n,getRecordModel:i,spaceId:u,value:c,featureGates:s}=e;if("formula"===c.type){if(!(0,a().O9)(c.value))return;const e=r().Q.unwrapOr(o.parseFormulaInputToAst(c.value),void 0);if(e){const r=o.addTypesToFormulaAST(e,{handleDataRequest:(0,l().zg)(i),spaceId:u,valueTypes:n,featureGates:s});return{...t.getFormulaAnalytics(e,{getRecordModel:i,typecheckContextValues:n}),formula_return_type:r.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:i,typecheckContextValues:n})}}}else{if("simple"===c.type){if(!(0,a().O9)(c.value))return;return t.getSimpleFormulaAnalytics(c.value,{getRecordModel:i,typecheckContextValues:n})}(0,a().HB)(c.type)}}function T(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f,simpleFormulasModule:y}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:r,getRecordModel:i,featureGates:l}=e,u=t.getConfig();let c,s=[];const p=null==u?void 0:u.collection,d=null==u?void 0:u.properties;if((0,a().O9)(p)&&(0,a().O9)(d)&&d.length>0){const e=i(p),f=null==e?void 0:e.getNormalizedSchema();(0,a().O9)(f)&&(s=d.map((e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)??"unknown"})));const y=null==u?void 0:u.values;if(n&&(0,a().O9)(y)){c=[];for(const e of d){var m;const a=null===(m=y[e])||void 0===m?void 0:m.value;if(!a)continue;const u=M({formulaAnalyticsModule:o,formulasModule:n,getRecordModel:i,formulaTypecheckContextValues:r,spaceId:t.spaceId,value:a,featureGates:l});u&&c.push(u)}}}return{automation_action_id:t.pointer.id,property_formula_stats:c,property_types:s,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:r,getRecordModel:i,featureGates:l}=e,u=t.getConfig(),c=[];if(n&&(0,a().O9)(u)&&u.text){const e=M({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:r,spaceId:t.spaceId,value:u.text,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:o,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:u,simpleFormulasModule:s}=e,p={automation_action_id:o.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},d=o.getConfig();if(!(0,a().O9)(d))return p;if((0,a().O9)(d.target))if("formula"===d.target.type&&(0,a().O9)(d.target.value)){if(p.targetData={type:"formula",numUserFormulaTargets:(0,c().Fbh)(d.target.value.value).length,numFormulaContextTargets:s.getReferencedContextValueIds(d.target.value).length},r){const e=M({formulasModule:r,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:d.target.value,featureGates:u});e&&(p.formula_stats??=[],p.formula_stats.push(e))}}else if("property"===d.target.type&&(0,a().O9)(d.target.propertyId)&&(0,a().O9)(d.target.collectionPointer)){const e=l(d.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,a().O9)(t)&&(p.targetData={type:"property",propertyType:null===(m=t[d.target.propertyId])||void 0===m?void 0:m.type})}if((0,a().O9)(null===(t=d.notification_message)||void 0===t?void 0:t.value)&&(p.messageCharacterCount=(0,c().FAw)(d.notification_message.value),r)){const e=M({formulasModule:r,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:d.notification_message,featureGates:u});e&&(p.formula_stats??=[],p.formula_stats.push(e))}return p}({automationActionModel:t,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f,simpleFormulasModule:y}):t.isType("send_gmail_notification")?function(e){var t,o,r,l,s,p,d;const{automationActionModel:m,formulaAnalyticsModule:f,formulasModule:y,formulaTypecheckContextValues:v,getRecordModel:_,featureGates:g}=e,h=m.getConfig();if(!(0,a().O9)(h))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const T=Object.fromEntries(Object.entries(h||{}).map((e=>{let[t,o]=e;var n;return"formula"===(null==o?void 0:o.type)?[t,Boolean(null==o||null===(n=o.value)||void 0===n?void 0:n.value)]:"simple"===(null==o?void 0:o.type)?[t,Boolean(null==o?void 0:o.value)]:[t,Boolean(o)]}))),{to:x,cc:k,bcc:S}=h,b=[...(null==x||null===(t=x.value)||void 0===t?void 0:t.value)||[],...(null==k||null===(o=k.value)||void 0===o?void 0:o.value)||[],...(null==S||null===(r=S.value)||void 0===r?void 0:r.value)||[]],w=[...(0,c().Fbh)(b).map((e=>_({table:u().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(a().O9),...(0,i().C3)((0,c().k4p)(b))],C=n().Tr(w.map((e=>e.split("@")[1]))),I=[null===(l=h.to)||void 0===l?void 0:l.value,null===(s=h.cc)||void 0===s?void 0:s.value,null===(p=h.bcc)||void 0===p?void 0:p.value,null===(d=h.reply_to)||void 0===d?void 0:d.value,h.from_name,h.email_subject,h.email_body].map((e=>{if(y&&(0,a().O9)(e))return M({formulaAnalyticsModule:f,formulasModule:y,getRecordModel:_,formulaTypecheckContextValues:v,spaceId:m.spaceId,value:e,featureGates:g})})).filter(a().O9);return{automation_action_id:m.pointer.id,fields:T,formula_stats:I,recipient_domains:C,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:i,getRecordModel:u,featureGates:c}=e,p=t.getConfig(),d=[],m=[],f=[];if((0,a().O9)(p)&&(0,a().O9)(p.target)&&(0,a().O9)(p.properties)&&p.properties.length>0){let e;if("variable"===p.target.type){const t=(0,l().y5)(p.target.id);if("action"===t.source){const t=(0,s().y)({actionModels:o,id:p.target.id}).collectionPointer;if((0,a().O9)(t)){const o=u(t);e=null==o?void 0:o.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,l().IV)(i,p.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,a().O9)(t.type.collection)){const o=u(t.type.collection);e=null==o?void 0:o.getNormalizedSchema()}}}}else if("collection"===p.target.type){const t=u(p.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,a().O9)(e)&&p.properties.forEach((o=>{const l=e[o];if((0,a().O9)(l)&&(d.push(l.type),r&&(0,a().O9)(p.values))){const e=p.values[o];if((0,a().O9)(e)&&(m.push({type:l.type,operator:e.action}),e.value)){const o=M({formulasModule:r,formulaAnalyticsModule:n,getRecordModel:u,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:e.value,featureGates:c});o&&f.push(o)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:f,property_types:d,type:"update_pages"}}({automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:r,getRecordModel:i,featureGates:l}=e,u=t.getConfig(),c=[];if(n&&(0,a().O9)(u)&&u.values)for(const a of Object.values(u.values))if(a.value){const e=M({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:r,spaceId:t.spaceId,value:a.value,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:r,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:void(0,a().HB)(t)}function x(e){const{automationModel:t,builderType:o="sidebar",formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:u,simpleFormulasModule:c,source:s}=e,p=[],d=t.getActionPointers().map((e=>l(e))).filter(a().O9);for(const h of t.getActionPointers()){const e=l(h);(0,a().O9)(e)&&p.push(T({automationActionModel:e,automationActionModels:d,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:u,simpleFormulasModule:c}))}const m=[];let f,y,v;if(t.isEventType()){var _;const e=t.getEventConfiguration(),o=l(t.getParentPointer());f=t.getParentId();const n=t.getEventConfiguration();if("collection_view"===(null===(_=n.source)||void 0===_?void 0:_.type)){const e=l(n.source.pointer);v=null==e?void 0:e.parent_id,y=null==n?void 0:n.source.pointer.id}const r=null==o?void 0:o.getNormalizedSchema();if((0,a().O9)(r)){const{pagesAdded:t,pagePropertiesEdited:o}=e;if(t&&m.push({type:"page"}),"any"===o.type)m.push({condition:"any",type:"property"});else if("none"===o.type)m.push({condition:"none",type:"property"});else{let e=[];"some"===o.type?e=o.some??[]:"all"===o.type&&(e=o.all??[]);const t=[],n=[];e.forEach((e=>{var o;const i=null===(o=r[e.property])||void 0===o?void 0:o.type;(0,a().O9)(i)&&(t.push({type:i,operator:e.filter.operator}),n.push(i))})),m.push({condition:o.type,property_configs:t,property_types:n,type:"property"})}}}else if(t.isButtonType())m.push({type:"button"});else if(t.isRecurrenceType()){var g;m.push({type:"recurrence",frequency:null===(g=t.getTrigger().recurrence)||void 0===g?void 0:g.frequency})}else(0,a().HB)(t);return{automation_actions:p,automation_id:t.id,automation_triggers:m,collection_id:f,collection_view_id:y,collection_view_block_id:v,builder_type:o,source:s}}},793320:(e,t,o)=>{o.r(t),o.d(t,{handleWorkflowTemplatesDeeplink:()=>w});o(725707),o(491955),o(324989),o(403517);var n=()=>o(712437),r=()=>o(994966),a=()=>o(758611),i=()=>o(218357),l=()=>o(663571),u=()=>o(34662),c=()=>o(975392),s=()=>o(23371),p=()=>o(76394),d=()=>o(348965),m=()=>o(485966),f=()=>o(413871),y=()=>o(752414),v=()=>o(863977),_=()=>o(940445),g=()=>o(518022),h=()=>o(961397),M=()=>o(197562),T=()=>o(185639),x=()=>o(783759),k=()=>o(178594),S=()=>o(191756),b=()=>o(865226);async function w(e){const{nextRoute:t,origin:o="workflow_templates_deeplink"}=e,w=await async function(e){var t;let{environment:o,nextRoute:r}=e;if(!o.currentUser.id)return{error:"no_user_id",newEnvironment:o};const a=await async function(e){let{environment:t,nextRoute:o}=e;const{spaceId:n}=await T().wA(t),r=t.currentUser.id,a=o.spaceId??n,i=o.userId??r,u=t.currentUser.loggedInUserIds.map((e=>{const o={table:l().GD,id:e};return new(f().dZ)(t,o,{userId:e})}));await(0,s().lX)(u,25,(e=>e.load()));const p=u.flatMap((e=>e.getSpaceViewStores()));await(0,s().lX)(p,25,(e=>e.load()));const m=d().A.getAllSpaceViewStores(t).filter((e=>{var t;return null===(t=e.getSpaceStore())||void 0===t?void 0:t.canEdit()}));return(0,c().Ul)(m,(e=>e.getSpaceId()===a&&e.getParentId()===i?0:e.getParentId()===i&&e.getSpaceId()===n?1:e.getParentId()===i?2:e.getParentId()===r&&e.getSpaceId()===n?3:e.getParentId()===r?4:e.getSpaceId()===a?5:e.getSpaceId()===n?6:7))[0]}({environment:o,nextRoute:r}),i=null==a?void 0:a.getParentId();if(!a)return{error:"no_space_view_store",newEnvironment:o};if(!i)return{error:"no_space_view_user_id",newEnvironment:o};let u=o;i!==o.currentUser.id&&(u=await k().T({environment:o,newCurrentUserId:i}),u&&(o=u));await a.load();const p=a.getSpaceId();a.id!==(null===(t=m().default.state.currentSpaceViewStore)||void 0===t?void 0:t.id)&&(r.autoCreateDatabase?await x().yV({environment:o,spaceViewStore:a}):await x().tR({environment:u,spaceViewStore:a,userSettingsStore:m().default.state.currentUserSettingsStore,userRootStore:m().default.state.currentUserRootStore,pageVisitSource:n().y8.WorkflowTemplatesDeeplink,navigationType:"switchingToOrLoadingSpace"}));await m().default.waitUntil((()=>{var e;return(null===(e=m().default.state.currentSpaceStore)||void 0===e?void 0:e.id)===p}));const y=m().default.state.currentSpaceStore;if(!y||y.id!==p||!y.canEdit())return{error:"no_valid_space_store",newEnvironment:u};return{value:{newSpaceStore:y},newEnvironment:u}}(e);if(w.error)return void b().oo({environment:w.newEnvironment,url:a().JZ.root,redirect:!0});const C=w.newEnvironment,I=w.value.newSpaceStore,A=await async function(e){let{currentSpaceStore:t,nextRoute:o}=e;if("private"===o.location.type)return t;if("team"===o.location.type){const e=f().h4.createChildStore(t,{table:i().yK,id:o.location.teamId,spaceId:t.id});await e.load();return e.canAddOrRemoveTopLevelPages()&&e.getParentId()===t.id?e:t}(0,p().HB)(o.location)}({currentSpaceStore:I,nextRoute:t});let O;var V;t.autoCreateDatabase&&(O=await(0,y().my)({environment:C,parentStore:A}),null!==(V=O)&&void 0!==V&&V.collectionViewBlockStore&&S().uK({environment:C,store:O.collectionViewBlockStore,pageVisitSource:n().y8.WorkflowTemplatesDeeplink}));const R=_().globalWorkflowTemplates.fromIdOfType({templateId:r().MH,type:"collection"}),E=(0,h().XM)({origin:o,parentStore:A}),P="aiBuilder"===t.modalType;M().A.setState({open:!0,isSaving:!1,...E,...P?{version:"build_with_ai",collectionTemplate:R,userCustomizations:{featureTemplateSelections:[],recordTitles:[]},previewCollectionInfo:void 0,setupGenerator:(0,g().getSetupGeneratorForTemplate)({isForInAppFlows:!0,environment:C,template:R,parentStore:A,initialAiPrompt:t.prompt?(0,u().x9d)(t.prompt):void 0,analyticsArgs:{origin:o,hadSelectionModalSearchEntered:!1,workflowTemplatesFlowId:E.flowId}})}:{version:"select_and_customize_template"},currentStepIndex:0,parentStore:A,existingCollectionInfo:O,relationInfos:[],navigateToOnFinish:t.autoCreateDatabase?"skip":"created_collection",collectionTemplatesSearchQuery:void 0,onClose:e=>{var t,o;(0,v().ZM)({environment:C,userAction:"workflowDeeplinkActions.handleWorkflowTemplatesDeeplink",result:e,existingCollectionStore:null===(t=O)||void 0===t?void 0:t.collectionStore,existingCollectionViewBlockStore:null===(o=O)||void 0===o?void 0:o.collectionViewBlockStore})}})}},876988:(e,t,o)=>{o.d(t,{y:()=>a});o(725707),o(500234);var n=()=>o(76394),r=()=>o(465546);function a(e){var t;const{actionModels:o,id:a}=e,i=(0,r().y5)(a),l="action"===i.source?o.find((e=>e.id===i.action_id)):void 0,u=(0,n().O9)(l)&&l.isType("create_page")?null===(t=l.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:i,collectionPointer:u,actionModel:l}}},911575:(e,t,o)=>{o.d(t,{$0:()=>v,Fx:()=>k,Ge:()=>m,I3:()=>p,Kj:()=>T,PP:()=>S,TK:()=>b,Yy:()=>s,aE:()=>w,cQ:()=>x,kH:()=>f,m7:()=>d,nq:()=>h,nv:()=>_,tj:()=>y});o(725707),o(491955),o(113085);var n=()=>o(975392),r=()=>o(76394),a=()=>o(564134),i=()=>o(810111),l=()=>o(479056),u=()=>o(875089);(0,r().u0)((e=>(0,r().O9)(e)&&(0,r().O9)(e.target)&&(0,r().O9)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target,custom_message:e.custom_message}}:{false:e}));const c={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1},s={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function p(e){return Boolean(c[e.type]&&!(0,a().UU)(e)&&(!(0,a().$M)(e)||void 0===(0,a().om)(e)))}function d(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c,sourcePropertyIds:s}=e,d=(s??(0,r().uv)(o)).filter(((t,n,r)=>{const i=o[t];return!(!i||!p(i))&&(("relation"!==i.type||!e.restrictCrossSpace||!(0,a().o2)(e.spaceId,i))&&(!l||l([t,i],n,o)))}));if(0===d.length)return[];if(!t||!1===c)return d;const m=(0,u().L)(t,o,void 0,i().jf.Page).collection_page_properties||[];return n().Ul(d,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:o,sort:l}=e,c=(0,r().uv)(o).filter(((e,t,n)=>{const r=o[e];return!(!r||!(0,a().JY)(r))}));if(0===c.length)return[];if(!t||!1===l)return c;const s=(0,u().L)(t,o,void 0,i().jf.Page).collection_page_properties||[];return n().Ul(c,(e=>s.findIndex((t=>t.property===e))))}function f(e){return e.type===l().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===l().M9.TokenExpected?{type:e.type,token:e.token}:e.type===l().uW.MissingSchemaPropertyOnThisRow||e.type===l().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===l().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===l().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===l().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===l().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===l().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===l().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===l().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===l().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===l().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===l().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,geo_point:!1};function v(e){return Boolean(y[e.type])}function _(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c}=e,s=(0,r().uv)(o).filter(((e,t,n)=>{var r;const i=o[e];return!(!i||!y[i.type])&&((!(0,a().$M)(i)||null===(r=(0,a().om)(i))||void 0===r||!r.auto_update_on_edit)&&(!l||l([e,i],t,o)))}));if(0===s.length)return[];if(!t||!1===c)return s;const p=(0,u().L)(t,o,void 0,i().jf.Page).collection_page_properties||[];return n().Ul(s,(e=>p.findIndex((t=>t.property===e))))}const g={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function h(e){return g[e.type]}const M={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function T(e){return M[e.type]}function x(e){return 0===e}function k(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function S(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function b(e){const{collectionSchema:t,property:o,type:n}=e,r=null==t?void 0:t[o];return!r||("action"===n?!p(r):!y[r.type])}function w(e){let{automationTrigger:t,collectionSchema:o}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:n,source:a,relativeDate:i}=t.event;if(void 0===a)return!1;const l="some"===n.type&&n.some,u="all"===n.type&&n.all;if((l||u||[]).some((e=>S({collectionSchema:o,property:e.property})||b({collectionSchema:o,property:e.property,type:"trigger"}))))return!1;const c="some"===n.type&&(!(0,r().O9)(n.some)||0===n.some.length),s="all"===n.type&&(!(0,r().O9)(n.all)||0===n.all.length);if(!e&&("none"===n.type||c||s)&&!i)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},963644:(e,t,o)=>{o.d(t,{i:()=>a});var n=()=>o(876695),r=()=>o(658294);function a(e){const{environment:t,collectionContextStore:o,property_type:a,from:i,property:l,...u}=e,c=(0,n().sl)(o)||{};(0,r().G)(t,{property:l,property_type:a,from:i,...u,...c})}},994488:(e,t,o)=>{o.d(t,{o:()=>n});o(362833),o(403517);function n(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];if(0===o.length)return e.map((e=>[e]));const a=[];for(const i of e)a.push(...n(o[0],...o.slice(1)).map((e=>[i,...e])));return a}}}]);