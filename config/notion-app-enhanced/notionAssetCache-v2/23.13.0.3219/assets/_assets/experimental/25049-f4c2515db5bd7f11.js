"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25049],{32985:(e,t,i)=>{i.d(t,{z:()=>Z,W9:()=>z,Zr:()=>W,YN:()=>F,$p:()=>B,pe:()=>V,y8:()=>j,bn:()=>O,ho:()=>Y,yt:()=>q,WV:()=>R,BU:()=>J,Dh:()=>C,A$:()=>$});i(474872),i(875472),i(76509),i(863754);var n=()=>i(141714),o=()=>i(16791),a=()=>i(659196),s=()=>i(350792),r=()=>i(502140),l=()=>i(545250),d=()=>i(758611),c=()=>i(132793),u=()=>i(450475),g=()=>i(809811),m=()=>i(818369),p=()=>i(263159),v=()=>i(185639),f=()=>i(70989),h=()=>i(961987),y=()=>i(865226),w=()=>i(927685),S=()=>i(137476),b=()=>i(142548),k=(i(610931),()=>i(23371));const A="challengeHelpers";async function T(e,t,i,n){if(!t||!i.executeTurnstile)return;const o=performance.now();let a;try{const e=await(0,k().Vq)(i.executeTurnstile(n),15e3);e.timeout?(r().log({level:"error",from:A,type:"turnstileExecutionTimeout"}),a=void 0):a=e.result}catch(s){r().log({level:"error",from:A,type:"turnstileExecutionError",error:(0,u().convertErrorToLog)(s)}),a=void 0}return function(e,t){(0,S().vd)(e,"challenge_executed",t)}(e,{provider:"turnstile",action:n,is_success:void 0!==a,time_ms:performance.now()-o}),a}var I=()=>i(432924),N=()=>i(868325),P=()=>i(286513),L=()=>i(477784),M=()=>i(665317),_=()=>i(330358),x=()=>i(672796),E=()=>i(993717);const U=(0,i(653998).YK)({loggingInWithApple:{id:"loginActions.loggingInWithApple.loadingMessage",defaultMessage:"Logging in with Apple…"},loggingInWithGoogle:{id:"loginActions.loggingInWithGoogle.loadingMessage",defaultMessage:"Logging in with Google…"},googleErrorMessage:{id:"loginActions.loggingInWithGoogle.errorMessage",defaultMessage:"Something went wrong while trying to log in with Google."},titleMessageGooglePopup:{defaultMessage:"Google login",id:"loginActions.googleLoginPopupModal.title"},titleMessageMicrosoftPopup:{defaultMessage:"Microsoft login",id:"loginActions.microsoftLoginPopupModal.title"}});async function R(e){const{environment:t,loginStore:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileProps:r,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:u}=e;await async function(e){const{environment:t,store:i,reverify:n,turnstileToken:a,loginOptionsToken:s,onSendTemporaryPasswordSuccess:r,onSendTemporaryPasswordFailure:l}=e,{RouterStore:u}=t,f=e.disableLoginLink||Boolean((0,c().sY)());E().QR(t);const{url:h}=v().v4(t),y=M().Sw(t),b=i.isMicrosoftLogin()||i.isMicrosoftVerification();let k={email:i.state.email,redirectURL:h,disableLoginLink:f,native:t.device.isNative,isSignup:"signup"===u.state.route.name,turnstileToken:a,shouldHidePasscode:y,loginOptionsToken:s,deviceId:await(0,I().getExperimentDeviceId)(t)};b&&(k={...k,thirdPartyToken:i.state.thirdPartyToken,microsoftEmailVerification:!0});const A=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:k});if("success"===A.type){const{csrfState:e}=A.data;if(b?i.setState({...i.state,loginType:"microsoft_verification",password:"",alert:void 0,hiddenPasscode:y,sentEmailPasscodeState:e}):i.setState({...i.state,loginType:n?"reverify":"temporary",password:"",sentEmailPasscodeState:e,alert:void 0,hiddenPasscode:y}),null==r||r(),function(e){let{environment:t,isMicrosoftLogin:i}=e;const n=t.device.isElectronAny;return n&&"en-US"===o().locale&&!i}({environment:t,isMicrosoftLogin:b})){const e=await(0,S().TZ)(t),n=g().Gm({url:`${w().A.domainBaseUrl}${d().JZ.desktopEmailConfirm}`,query:{state:btoa(JSON.stringify({email:i.state.email,deviceId:e}))}});t.device.isElectronAny&&p().P(n)}}else{null==l||l();const e=(0,N().Hu)(L().A.getIntl(),A);i.setState({...i.state,loginType:"email",password:"",alert:e})}}({environment:t,store:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileToken:await T(t,"turnstile"===i.state.challengeProvider,r,"login_temporary_password"),loginOptionsToken:i.state.loginOptionsToken,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:u})}async function W(e){const{environment:t,email:i,password:n,redirectURL:o,turnstileProps:a,loginStore:s}=e,r=await(0,P().loadCurrentUserId)(t),l=await m().callApi({eventName:"loginWithEmail",environment:t,data:{email:i,password:n,turnstileToken:await T(t,"turnstile"===s.state.challengeProvider,a,"login_password"),loginOptionsToken:s.state.loginOptionsToken,source:(0,c().dY)()}});if("success"!==l.type){await x().handleLoginFailureIfSamlRequired(t,l),function(e,t){var i;"login_options_invalid"===(null===(i=t.body.clientData)||void 0===i?void 0:i.type)&&e.setState({...e.state,loginType:"email",password:""})}(s,l);return(0,N().Hu)(L().A.getIntl(),l)}{const e=l.data.enabledMfaSettings??[],{userId:i}=l.data;e.length>0?x().handleLoginWithMfa({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password",mfaSettings:e,loginStore:s}):await x().handleLoginSuccess({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password"})}}async function C(e){const{environment:t,store:i}=e,n=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:{passwordReset:!0,email:i.state.email,native:t.device.isNative,loginOptionsToken:i.state.loginOptionsToken}});if("success"===n.type){const{csrfState:e}=n.data;i.setState({...i.state,loginType:"reset",password:"",sentPasswordResetState:e,alert:void 0})}else{const e=(0,N().Hu)(L().A.getIntl(),n);i.setState({...i.state,password:"",alert:e})}}async function B(e){const{environment:t,store:i}=e,{mobileNative:n}=t,o=await(0,P().loadCurrentUserId)(t);if(E().lt(t),n&&n.hasNativeAppleLogin())return void(await async function(e){const{environment:t,store:i,previousPersistedUserId:n}=e,{mobileNative:o}=t;if(!o)return;const a=await o.requestNativeAppleAuth();if(!a)return;if(a.error)r().log({level:"error",from:"loginActions",type:"requestNativeAppleAuth",error:(0,u().convertErrorToLog)(a.error)});else{f().m({message:U.loggingInWithApple});const{code:e,nonce:o,firstName:s,lastName:r}=a.value,l=await m().callApi({eventName:"loginWithAppleNativeAuth",environment:t,data:{code:e,nonce:o,firstName:s,lastName:r}});if("success"===l.type){const{isNewSignup:e,userId:i}=l.data;await x().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:n,loginMethod:"login-with-apple"}),f().V()}else{await x().handleLoginFailureIfSamlRequired(t,l);const e=(0,N().Hu)(L().A.getIntl(),l);i.setState({...i.state,alert:e}),f().V()}}}({environment:t,store:i,previousPersistedUserId:o}));const a=(0,b().Le)(t);let s=l().tt(w().A.domainBaseUrl,{authType:a});s=a.redirectToAuth?s:await(0,b().YN)(t,s),t.mobileNative?x().openBrowserInMobileNative(t,s):t.device.isElectronAny?p().P(s):window.location.href=s}async function O(e){const{environment:t}=e,i=M().EB()||M().Nz()?(0,c().dY)():void 0;E().P6(t);const n=(0,b().LX)(t);let o=l().LC(w().A.domainBaseUrl,{authType:n,source:i});if(o=n.redirectToAuth?o:await(0,b().YN)(t,o),t.mobileNative)x().openBrowserInMobileNative(t,o);else if("redirect"===n.callbackType)window.location.href=o;else if(t.device.isElectronAny)p().P(o);else{const e=await h().P(t,{width:610,height:700,url:o,titleMessage:U.titleMessageMicrosoftPopup});if(!e)return;const i=g().Jh({url:g().ZO(e),pathname:d().JZ.microsoftAuthCallback});y().oo({environment:t,url:i})}}const G=L().A.formatMessage(U.googleErrorMessage);async function j(e){const{environment:t,store:i,email:n,permissionsStore:o}=e,{mobileNative:a}=t,s=await(0,P().loadCurrentUserId)(t);E().s(t);const v=a&&a.hasNativeGoogleLogin()?()=>a.requestGoogleJwt():void 0;if(v){const e=await v();if(e){if(e.error)return void r().log({level:"error",from:"loginActions",type:"requestGoogleJwt",error:(0,u().convertErrorToLog)(e.error)});{f().m({message:U.loggingInWithGoogle});const{idToken:n}=e.value,{device:o}=t;let a;o.isElectronMail?a="nativemailredirect":o.isElectron?a="nativeredirect":o.isNative&&(a="native");const r=await m().callApi({eventName:"loginWithGoogleJwt",environment:t,data:{idToken:n,callbackType:a}});if("success"===r.type){const{isNewSignup:e,userId:i}=r.data;await x().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:s,loginMethod:"login-with-google"}),f().V()}else await x().handleLoginFailureIfSamlRequired(t,r),i.setState({...i.state,alert:G}),f().V()}return}}const S=M().EB()||M().Nz()?(0,c().dY)():void 0,k=(0,b().LX)(t),A=crypto.randomUUID();let T=l().g$(w().A.domainBaseUrl,{email:n,contacts:o.state.contacts,authType:k,source:S},A);if(sessionStorage.setItem("googleLoginRequestId",A),T=k.redirectToAuth?T:await(0,b().YN)(t,T,!!(t.mobileNative&&w().A.domainBaseUrl.indexOf("localhost")>=0)),t.mobileNative)x().openBrowserInMobileNative(t,T);else if("redirect"===k.callbackType)window.location.href=T;else if(t.device.isElectronAny)p().P(T);else{const e=await h().P(t,{width:610,height:700,url:T,titleMessage:U.titleMessageGooglePopup});if(!e)return;const i=g().Jh({url:g().ZO(e),pathname:d().JZ.googleAuthCallback});y().oo({environment:t,url:i})}}async function V(e){const{loginStore:t,environment:i}=e;if(!t.isEmail())return;const{email:n}=t.state,o=await m().callApi({eventName:"getLoginOptions",environment:i,data:{email:n}});if("failed"===o.type){const e=(0,N().Hu)(L().A.getIntl(),o);return t.setState({...t.state,loginType:"email",alert:e}),void function(e,t){(0,S().vd)(e,"login_invalid_email_submitted",{invalidEmail:t})}(i,n)}const s=o.data;if("required"===s.samlSignIn)return await x().showSamlRedirectMessage(2e3),t.setState({...t.state,loginType:"saml",alert:"Redirecting you to use SAML SSO"}),void q({environment:i,loginStore:t});(0,a().aq)({device:i.device,email:n,cookieService:i.cookieService}),t.setState({...t.state,loginOptionsToken:s.loginOptionsToken,challengeProvider:s.challengeProvider}),s.hasAccount?s.mustReverify?t.setState({...t.state,needsSendTemporaryPasswordReason:"reverify"}):s.passwordSignIn?t.setState({...t.state,loginType:"password",alert:void 0}):t.setState({...t.state,needsSendTemporaryPasswordReason:"login_no_password"}):t.setState({...t.state,needsSendTemporaryPasswordReason:"signup"})}async function q(e){const{environment:t,loginStore:i}=e,{device:n}=t;if(!i.isSaml())return;const{email:o}=i.state,a=L().A.getIntl();if(!o&&!i.state.forceAdminSamlLogin)return;let r;n.isElectronMail?r="nativemailredirect":n.isElectronCalendar||n.isMobileNativeCalendar?r="nativecalendarredirect":n.isElectron||(0,b().jd)(t)?r="nativeredirect":n.isNative&&(r="native");const l=await m().callApi({eventName:"getSamlRedirect",environment:t,data:{email:o,callbackType:r}});if("failed"===l.type)return void i.setState({...i.state,alert:(0,N().Hu)(a,l)});i.setState({...i.state,alert:void 0});const d=l.data.redirectUrl;if(d){const e=(0,s().iK)();if(e){const i=new URL(d);i.searchParams.set(s().sg,e),x().redirectToSaml(t,i.toString())}else x().redirectToSaml(t,d)}}function F(e){const t={callbackType:(0,b().LX)(e).callbackType},i=g().Gm({url:`${w().A.domainBaseUrl}${d().JZ.passkeyAuthVerify}`,query:t});e.mobileNative?x().openBrowserInMobileNative(e,i):e.device.isElectronAny?p().P(i):y().oo({environment:e,url:i})}async function J(e,t){const i=await H(e);if(!i)return;const{attestation:n,attemptId:o}=i,a=g().O$(d().JZ.passkeyAuthCallback,{attestation:JSON.stringify(n),attemptId:o});"nativemailredirect"===t?y().oo({environment:e,url:`/nativemail${a}`}):"nativecalendarredirect"===t?y().oo({environment:e,url:`/nativecalendar${a}`}):y().oo({environment:e,url:`/native${a}`})}async function H(e){const t=await m().callApi({eventName:"authPasskeyGenerateChallenge",environment:e,data:{}});if("success"!==t.type)return;let i;try{i=await(0,n().HS)(t.data.options,!1)}catch(o){return}return{attestation:i,attemptId:t.data.attemptId}}async function Y(e){const{environment:t,showInvitationVersion:i}=e,n=await H(t);if(!n)return!1;const{attestation:o,attemptId:a}=n;return await x().loginUserWithPasskeyVerifyChallenge({environment:t,attestation:o,attemptId:a,showInvitationVersion:i})}async function $(e){const{environment:t,state:i,password:n}=e,o=await m().callApi({eventName:"verifyEmail",environment:t,data:{state:i,password:n}});if("success"!==o.type){return(0,N().Hu)(L().A.getIntl(),o)}}async function Z(e){const{environment:t,redirectURL:i,previousPersistedUserId:n,userId:o,regenerateBackupCodes:a}=e;await x().handleLoginSuccess({environment:t,isNewSignup:!1,userId:o,redirectURL:i,previousPersistedUserId:n,loginMethod:"password-mfa"}),a&&_().A.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function z(e){e.reset()}},157763:(e,t,i)=>{function n(e){const{buttonsStore:t,buttonName:i,buttonState:n}=e;t.setState({buttons:{...t.state.buttons,[i]:n}})}i.d(t,{E:()=>n})},170991:(e,t,i)=>{i.d(t,{_C:()=>o,gQ:()=>l,gr:()=>d,jr:()=>a,pO:()=>r,v4:()=>s});var n=()=>i(137476);function o(e,t){const{name:i,...o}=t;n().vd(e,"click_link",{...o,click_name:i})}function a(e,t){n().vd(e,"scroll",t)}function s(e,t){n().vd(e,"customer_io_in_app_callout_show",t)}function r(e,t){n().vd(e,"customer_io_in_app_callout_suppress",t)}function l(e,t){n().vd(e,"customer_io_in_app_callout_dismiss",t)}function d(e,t){n().vd(e,"customer_io_in_app_callout_error",t)}},337296:(e,t,i)=>{i.d(t,{s:()=>v});i(242343);var n=()=>i(237385),o=()=>i(803290),a=()=>i(524118),s=()=>i(978941),r=()=>i(653998),l=()=>i(157763),d=()=>i(701270),c=()=>i(868325),u=()=>i(196387),g=()=>i(32985),m=()=>i(525563),p=i(163643);function v(e){const{loginStore:t,buttonsStore:i,showInvitationVersion:v,isMobile:f,themeOverride:h,isSmallScreen:y,callbackType:w}=e,S=(0,n().Y0)(),b=(0,n().v3)(),k=(0,r().tz)(),A=(0,o().K8)((()=>"loading"===(null==i?void 0:i.state.buttons.loginWithPasskeyButton)),[i]),T=(0,o().K8)((()=>(null==t?void 0:t.state.forceAdminSamlLogin)??!1),[t]),I=(0,r().YK)({message:{id:"passkey.genericError",defaultMessage:"Something went wrong; please try another sign-in option or follow the instructions on your device for passkeys"}}),N=k.formatMessage(I.message);return S.isBannedGoogleSSOUserAgent||T?null:(0,p.jsx)("div",{style:{width:"100%"},children:(0,p.jsx)(m().F,{onClick:async()=>{if(l().E({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"loading"}),S.isElectronAny||S.isMobileNativeCalendar)g().YN(b);else{if(w)return void(await g().BU(b,w));{let i;u().default.mark("login_time.passkey");try{i=await g().ho({environment:b,showInvitationVersion:v,isMobile:f})}catch(e){e instanceof a().Cdc&&(null==t||t.setState({...null==t?void 0:t.state,alert:k.formatMessage(c().Ou.cant_access_workspace_from_network)}))}"boolean"==typeof i&&(null==t||t.setState({...null==t?void 0:t.state,alert:N}))}}l().E({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"idle"})},iconFn:s().a,iconStyles:{width:y?20:16,height:y?20:16,position:"absolute",left:10},getLabel:()=>v?(0,p.jsx)(d().D,{styleName:"UIRegular-14px/Medium",children:(0,p.jsx)(r().sA,{id:"loginForm.verifyWithPasskeyButton.label",defaultMessage:"Verify with Passkey"})}):(0,p.jsx)(d().D,{styleName:"UIRegular-14px/Medium",children:(0,p.jsx)(r().sA,{id:"loginForm.loginWithPasskeyButton.label",defaultMessage:"Log in with passkey"})}),isLoading:A,themeOverride:h,isSmallScreen:y})})}},525563:(e,t,i)=>{i.d(t,{F:()=>r});i(242343);var n=()=>i(174114),o=()=>i(31448),a=()=>i(126451),s=i(163643);function r(e){let{onClick:t,getLabel:i,id:r,iconFn:l,iconStyles:d,isLoading:c,themeOverride:u,isSmallScreen:g,backgroundColor:m,hoveredBackgroundColor:p}=e;const v=(0,n().IS)((e=>{const t=u??e;return{base:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:6,color:t.text.primary,fill:t.text.primary,background:m??"none",fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:o().Wy.medium,border:`1px solid ${t.stroke.primary}`,width:"100%",boxShadow:"none",marginTop:"8px",...g&&{height:48,borderRadius:12,fontSize:16,marginTop:10,fontWeight:o().Wy.semibold},...c&&{display:"grid",gridTemplateColumns:"1fr auto 1fr"}},hovered:{background:p??t.buttonHoveredBackground}}}),[g,u,c,m,p]);return(0,s.jsx)(a().A,{id:r,onClick:t,style:v.base,hoveredStyle:v.hovered,isLoading:c,loadingSpinnerStyle:{marginLeft:"auto"},children:(0,s.jsxs)("div",{style:{display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center"},children:[" ",null==l?void 0:l(d??{width:g?28:20,height:g?28:20,marginRight:g?0:2}),i()]})})}},581804:(e,t,i)=>{i.d(t,{A:()=>o});class n extends(()=>i(129044))().default{getInitialState(){return{buttons:{}}}}const o=n},664914:(e,t,i)=>{i.d(t,{A:()=>o});i(242343);var n=i(163643);const o=function(e){const{analyticsName:t}=e,o=(0,i(237385).v3)(),a=(0,i(803290).K8)((()=>(0,i(923156).m)(o,"maxWidth","large")),[o]);return(0,n.jsx)("div",{style:{flexShrink:0},children:(0,n.jsx)(i(579494).A,{"aria-label":"Notion",href:"https://www.notion.com/product",onMouseDown:()=>i(170991)._C(o,{from:t,name:"notion_logo",href:i(758611).JZ.product}),style:{cursor:"pointer",userSelect:"auto",WebkitUserSelect:"auto"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,i(713055).S)({width:a?28:30,height:a?28:30,marginRight:10,flexShrink:0}),!e.hideNotionText&&(0,n.jsx)("div",{style:{fontWeight:i(31448).Wy.medium,fontSize:16},children:"Notion"})]})})})}},923156:(e,t,i)=>{i.d(t,{m:()=>o});const n={small:600,medium:800,large:1020,giant:1380};function o(e,t,i){const{WindowSizeStore:o}=e,a="number"==typeof i?i:n[i];return"minWidth"===t?o.state.width>=a:o.state.width<=a}}}]);