"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[55251],{16250:(e,t,n)=>{n.d(t,{m:()=>c});n(725707),n(491955),n(500234),n(113085);var o=n(242343),r=()=>n(237385),a=()=>n(803290),i=()=>n(706788),s=()=>n(485966),d=()=>n(836331),l=()=>n(773082),u=()=>n(427871);function c(){const e=(0,r().v3)(),t=(0,o.useRef)(void 0);return(0,a().K8)((()=>{if(void 0===t.current){if(!d().default.isStatsigReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};t.current=d().default.checkGate({gateName:"calendar_home_tile_caching"})}if(t.current){var n;const{currentSpaceViewStore:t}=s().default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const o=t.getSelectedCalendarBotId(),r=!l().A.state.loaded;if(o&&r)return{loading:!1,botId:o,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:a,userId:d}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},c=l().A.bots.state.filter((e=>e.integration_id===i().io)),p=null===(n=c[0])||void 0===n?void 0:n.id,v=o&&c.some((e=>e.id===o))?o:p;return v&&v!==o?(0,u().rq)({environment:e,botId:v,shouldLog:!1}):!v&&o&&(0,u().k2)({environment:e}),{loading:r,botId:v,botSpaceId:a,botUserId:d}}{var o,r,a;const e=l().A.bots.state.filter((e=>e.integration_id===i().io)),t=null===(o=s().default.state.currentSpaceViewStore)||void 0===o?void 0:o.getSelectedCalendarBotId(),n=!l().A.state.loaded||!(null!==(r=s().default.state.currentSpaceViewStore)&&void 0!==r&&r.isReady()),{spaceId:d,userId:u}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},c=null===(a=e[0])||void 0===a?void 0:a.id;if(!t)return{loading:n,botId:c,botSpaceId:d,botUserId:u};const p=e.find((e=>e.id===t));return{loading:n,botId:(null==p?void 0:p.id)??c,botSpaceId:d,botUserId:u}}}),[e])}},144656:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(662988);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){(0,o().A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},532555:(e,t,n)=>{n.d(t,{B:()=>i});var o=()=>n(803290),r=()=>n(975392),a=()=>n(707715);function i(){return(0,o().K8)((()=>{var e;const t=r().$z((null===(e=a().A.getStateForCurrentSpaceView())||void 0===e?void 0:e.accounts.getOrderedValues())??[],(e=>{let{authorized:t}=e;return String(t)}));return{connectedAccounts:t.true??[],disconnectedAccounts:t.false??[]}}),[])}},543127:(e,t,n)=>{function o(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{A:()=>o})},623103:(e,t,n)=>{n.r(t),n.d(t,{CalendarAppSwitcherButton:()=>I});var o=n(242343),r=()=>n(803290),a=()=>n(174114),i=()=>n(356813),s=()=>n(443252),d=()=>n(678671),l=()=>n(181301),u=()=>n(999408),c=()=>n(892871),p=()=>n(174977),v=()=>n(907721),g=()=>n(466321),f=()=>n(440588),b=()=>n(22681);var S=()=>n(129978);const m=new(S().O2)("CalendarAgendaView",(async()=>await Promise.all([n.e(43380),n.e(2681),n.e(32503),n.e(94841),n.e(50462)]).then(n.bind(n,97037)))),y=(0,S()._h)(m,(e=>e.CalendarAgendaView));var h=n(163643);function A(e){return(0,h.jsx)(d().y,{style:e})}function I(e){let{tooltipText:t,onClick:n,iconSize:d}=e;const S=(0,r().O$)(f().sidebarWidthStore),[m,I]=(0,o.useState)(!1),w=function(e){const{closeDelayMs:t}=e,[n,r]=(0,o.useState)(!1),a=(0,o.useRef)(null),i=()=>{a.current&&(clearTimeout(a.current),a.current=null)};return{isOpen:n,open:(0,o.useCallback)((()=>{i(),r(!0)}),[]),close:(0,o.useCallback)((()=>{i(),a.current=setTimeout((()=>{r(!1)}),t)}),[t])}}({closeDelayMs:600}),D=(0,r().K8)((()=>(0,l().mX)()),[]),{days:C,eventsLoadingState:E,displayState:M}=(0,u().O)(),_=(0,a().IS)((()=>({button:{width:"28px",height:"28px"},icon:{width:d,height:d},popup:{display:"flex",flexDirection:"column",width:S-24+"px",maxHeight:"276px",minWidth:"376px"}})),[S,d]);return D&&"rejected"!==E.status?(0,h.jsx)(c().a.Provider,{value:{panelState:(0,p().oM)(M),view:"notionAgendaView"},children:(0,h.jsx)(s().Ay,{preventCaptureEsc:!0,forceInitialInbound:!0,disableDarkOverlayBackground:!0,trapFocus:!1,preventScaleTransition:!1,preventOpacityTransition:!1,popupWrapStyle:_.popup,disableMouseCapture:m,open:w.isOpen,popupType:g().n.Popup,alignmentToOrigin:v().C.Center,placementToOrigin:v().W.Top,originGap:6,render:()=>(0,h.jsx)(y,{isLoading:"resolved"!==E.status,days:C,onMouseOver:()=>{w.open()},onMouseLeave:()=>{w.close()}}),origin:(0,h.jsx)(i().A,{style:_.button,iconStyle:_.icon,icon:A,ariaLabel:t,onClick:n,onMouseEnter:()=>{w.open(),I(!0)},onMouseLeave:()=>{w.close(),I(!1)}})})}):(0,h.jsx)(b().A,{icon:A,iconSize:d,label:t,onClick:n})}},650964:(e,t,n)=>{n.d(t,{A:()=>i});var o=()=>n(543127),r=()=>n(144656),a=()=>n(662988);function i(e,t){(0,a().A)(2,arguments);var n=(0,r().A)(e),i=(0,o().A)(t),s=n.getFullYear(),d=n.getDate(),l=new Date(0);l.setFullYear(s,i,15),l.setHours(0,0,0,0);var u=function(e){(0,a().A)(1,arguments);var t=(0,r().A)(e),n=t.getFullYear(),o=t.getMonth(),i=new Date(0);return i.setFullYear(n,o+1,0),i.setHours(0,0,0,0),i.getDate()}(l);return n.setMonth(i,Math.min(d,u)),n}},662988:(e,t,n)=>{function o(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{A:()=>o})},705653:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(144656),r=()=>n(662988);function a(e,t){(0,r().A)(2,arguments);var n=(0,o().A)(e),a=(0,o().A)(t),i=n.getTime()-a.getTime();return i<0?-1:i>0?1:i}},850265:(e,t,n)=>{n.d(t,{A:()=>d});var o=()=>n(144656),r=()=>n(650964),a=()=>n(543127),i=()=>n(662988);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function d(e,t){if((0,i().A)(2,arguments),"object"!==s(t)||null===t)throw new RangeError("values parameter must be an object");var n=(0,o().A)(e);return isNaN(n.getTime())?new Date(NaN):(null!=t.year&&n.setFullYear(t.year),null!=t.month&&(n=(0,r().A)(n,t.month)),null!=t.date&&n.setDate((0,a().A)(t.date)),null!=t.hours&&n.setHours((0,a().A)(t.hours)),null!=t.minutes&&n.setMinutes((0,a().A)(t.minutes)),null!=t.seconds&&n.setSeconds((0,a().A)(t.seconds)),null!=t.milliseconds&&n.setMilliseconds((0,a().A)(t.milliseconds)),n)}},892871:(e,t,n)=>{n.d(t,{H:()=>r,a:()=>a});var o=n(242343);const r={panelState:void 0,view:"notionHomeTile"},a=(0,o.createContext)(r);a.displayName="CalendarAnalyticsContext"},942485:(e,t,n)=>{n.d(t,{A:()=>i});var o=()=>n(543127),r=()=>n(144656),a=()=>n(662988);function i(e,t){(0,a().A)(2,arguments);var n=(0,r().A)(e),i=(0,o().A)(t);return isNaN(i)?new Date(NaN):i?(n.setDate(n.getDate()+i),n):n}},999408:(e,t,n)=>{n.d(t,{O:()=>D});n(725707),n(491955),n(113085);var o=()=>n(486826),r=n(242343),a=()=>n(237385),i=()=>n(803290),s=()=>n(162901),d=()=>n(975392),l=()=>n(76394),u=()=>n(199726),c=()=>n(533975),p=()=>n(485966),v=()=>n(427871);n(107652);function g(e){if(0===e.length)return!0;const t=e[0];return e.every((e=>void 0!==e&&e===t))}var f=()=>n(540059),b=()=>n(965170),S=()=>n(542683),m=()=>n(739536),y=()=>n(659952),h=()=>n(707715),A=()=>n(16250),I=()=>n(532555);const w=1e4;function D(){var e;const t=(0,a().v3)(),n=(0,A().m)(),{timeZone:D}=(0,u().mn)(),_=(0,c().s5)(),{connectedAccounts:x,disconnectedAccounts:N}=(0,I().B)(),[T,V]=r.useState(0),[j,k]=r.useState(!0),O=(0,r.useMemo)((()=>(0,d().sg)((()=>{V((e=>e+1)),k(!1),setTimeout((()=>k(!0)),w)}),1e3,{leading:!0,trailing:!1})),[]),{currentSpaceViewStore:R,currentSpaceStore:U}=(0,i().K8)((()=>({currentSpaceViewStore:p().default.state.currentSpaceViewStore,currentSpaceStore:p().default.state.currentSpaceStore})),[]),L=(0,i().K8)((()=>void 0!==h().A.getStateForCurrentSpaceView()),[]),F=(0,i().K8)((()=>{var e,o;const{botSpaceId:r,botUserId:a}=n,i=null==R?void 0:R.getSpaceId(),s=null==R?void 0:R.getUserId(),d=null==U?void 0:U.id,l=null===(e=p().default.state.currentUserStore)||void 0===e?void 0:e.id,u=null===(o=t.currentUser)||void 0===o?void 0:o.id;return g([r,i,d])&&g([a,s,l,u])}),[n,null==U?void 0:U.id,R,null===(e=t.currentUser)||void 0===e?void 0:e.id]),B=r.useRef(void 0),[W]=(0,s().Yb)((async()=>{const e=n.botId;if(!F||!R)return"appNotSynced";if(!e)return n.loading||(0,v().F8)(),"noConnectedBot";const o=await(0,v().qq)({environment:t,currentSpaceViewStore:R,botId:e,forceRefetch:!1,timeRange:(0,S().M)(),reason:"foreground_load"}),r=!B.current,a=B.current&&(B.current.spaceViewId!==R.id||B.current.botId!==e);switch("skipped"===o&&(r||a)&&M({environment:t,currentSpaceViewStore:R,botId:e,forceRefetch:!0,timeRange:(0,S().M)(),updateMethod:"replace",reason:"background_load"}),B.current={spaceViewId:R.id,botId:e},o){case"success":case"skipped":return"loadCompleted";case"failure":return"loadError";default:(0,l().HB)(o)}}),[F,n.botId,n.loading,R,t,T]),{days:K,numDaysWithEvents:z}=(0,i().K8)((()=>{const e=n.botId;if(!e||"resolved"!==W.status||!L||!R)return{days:[],numDaysWithEvents:0};const{timeMin:t,timeMax:r}=(0,S().iI)(),a=(0,b().g2)({events:h().A.getEvents(),calendars:h().A.getCalendarMap(),startDate:o().c9.fromMillis(t,{zone:D}),endDateInclusive:o().c9.fromMillis(r,{zone:D}),getCalendarVisibility:t=>(0,y().Pj)({spaceViewStore:R,botId:e,calendar:t}),eventFilters:{all_day_events:(0,f().E)("all_day_events"),events_without_participants:(0,f().E)("events_without_participants"),events_without_location:(0,f().E)("events_without_location")},timeZone:D});let i=0;return{days:a.filter((e=>{const t=e.allDayEvents.length>0||e.timedEvents.length>0;return t&&i++,t||(0,m().cK)(e.date,_)})),numDaysWithEvents:i}}),[n.botId,W.status,L,R,_,D]),H=function(e){let{botIdState:t,eventsLoadingState:n,isEventsDataAvailable:o,numDaysWithEvents:r,connectedAccounts:a,disconnectedAccounts:i}=e;const s=a.filter((e=>C(e)||E(e))),d=i.filter((e=>C(e)||E(e)));return t.loading||"resolved"!==n.status&&"rejected"!==n.status||"resolved"===n.status&&"noConnectedBot"===n.value&&!t.loading&&void 0!==t.botId||"resolved"===n.status&&"loadCompleted"===n.value&&!o||"resolved"===n.status&&"appNotSynced"===n.value?"loading":!t.loading&&!t.botId||0===s.length&&0===d.length?"signedOut":0===a.filter(C).length&&i.filter(C).length>0?i.filter(C).some((e=>"missingScopes"===e.authorizationStatus))?"missingScopes":"disconnectedAccount":"rejected"===n.status||"resolved"===n.status&&"loadError"===n.value?"loadError":0===r?"noEvents":"events"}({botIdState:n,eventsLoadingState:W,isEventsDataAvailable:L,numDaysWithEvents:z,connectedAccounts:x,disconnectedAccounts:N});return{isRetryEventLoadingEnabled:j,retryEventLoading:O,displayState:H,eventsLoadingState:W,days:K}}function C(e){let{provider:t}=e;return"google"===t}function E(e){let{provider:t}=e;return"icloud"===t}const M=(0,d().sg)(v().qq,1e4,{leading:!0,trailing:!0})}}]);