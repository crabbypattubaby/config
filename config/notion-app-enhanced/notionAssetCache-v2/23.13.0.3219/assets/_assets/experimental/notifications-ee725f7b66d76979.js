"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6893,70593],{33176:(e,t,n)=>{n.d(t,{lT:()=>l});n(362833);var i=()=>n(486826),o=()=>n(141666),r=()=>n(524118);const a=7;function s(e){if(void 0===e)return i().c9.utc();const t={zone:"utc"};return"number"==typeof e?i().c9.fromMillis(e,t):i().c9.fromISO(e,t)}function d(e,t){const n=t?s(t):i().c9.utc(),o=s(e??function(e){const{days:t,endDate:n,startDate:o}=e;if(t<=0)throw new(r().yI4)("Days must be greater than 0");const a=n?s(n):i().c9.utc();if(!a.isValid)throw new(r().yI4)(`endDate ${n} is in an invalid format`);const d=o?s(o).toMillis():0,l=a.minus({days:t-1}).toMillis();return Math.max(l,d)}({days:a,endDate:t}));if(!o.isValid)throw new(r().yI4)(`startDate ${e} is in an invalid format`);if(!n.isValid)throw new(r().yI4)(`endDate ${t} is in an invalid format`);if(o>n)throw new(r().yI4)(`startDate ${e} => ${o.toISO()} is after endDate ${t} => ${n.toISO()}`);return{startTimestamp:o.toMillis(),endTimestamp:n.toMillis()}}function l(e,t){const{startTimestamp:n,endTimestamp:i}=d(e,t),r=[];let a=n;for(;a<=i;)r.push(s(a).toISODate()),a+=o().nD;return r}},87607:(e,t,n)=>{n.d(t,{x:()=>l});n(242343);var i=()=>n(803290),o=()=>n(653998),r=()=>n(76394),a=()=>n(470313),s=()=>n(487893),d=n(163643);function l(){const e=(0,i().K8)((()=>(0,s().dl)()),[]);switch(e){case"unread_and_read":case"unread_only":return(0,d.jsx)(a().A,{message:(0,d.jsx)(o().sA,{defaultMessage:"You'll be notified here for @mentions, page activity, and page invites",id:"inbox.filterEmptyState.nonArchivedMessage"}),title:(0,d.jsx)(o().sA,{defaultMessage:"You're all caught up",id:"inbox.filterEmptyState.nonArchivedTitle"})});case"archived_only":return(0,d.jsx)(a().A,{message:(0,d.jsx)(o().sA,{defaultMessage:"Any Inbox updates you archived will show up here.",id:"inbox.filterEmptyState.archivedMessage"}),title:(0,d.jsx)(o().sA,{defaultMessage:"No archived updates",id:"inbox.filterEmptyState.archivedTitle"})});case"all_updates":return(0,d.jsx)(a().A,{message:(0,d.jsx)(o().sA,{defaultMessage:"Any activity in the workspace will show up here.",id:"inbox.filterEmptyState.allPagesMessage"}),title:(0,d.jsx)(o().sA,{defaultMessage:"No activity in the workspace",id:"inbox.filterEmptyState.allPagesTitle"})});default:(0,r().HB)(e)}}},112224:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>s});n(242343);var i=()=>n(779648),o=()=>n(584604),r=()=>n(982517),a=n(163643);function s(e){return(0,a.jsx)(o().L,{...e,iconGroup:i().F,children:(0,a.jsx)(r().g,{})})}},115692:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,peopleIcon:()=>o});n(242343);const i={viewBox:"0 0 20 20",svg:(0,n(163643).jsx)("path",{d:"M11.794 3.936c.57-.71 1.414-1.141 2.456-1.141s1.886.43 2.456 1.14c.558.696.823 1.618.823 2.582s-.265 1.885-.823 2.58c-.57.71-1.414 1.141-2.456 1.141s-1.886-.43-2.456-1.14c-.558-.696-.823-1.618-.823-2.581 0-.964.265-1.886.823-2.581m.975.782c-.341.426-.548 1.052-.548 1.799s.207 1.373.548 1.798c.33.41.813.673 1.481.673s1.152-.262 1.481-.673c.342-.425.548-1.051.548-1.798s-.206-1.373-.548-1.799c-.33-.41-.813-.673-1.48-.673-.67 0-1.152.263-1.482.673M5.75 3.625c-.957 0-1.734.396-2.259 1.05-.513.64-.755 1.484-.755 2.362s.242 1.723.755 2.362c.525.654 1.302 1.05 2.259 1.05s1.734-.396 2.259-1.05c.513-.64.755-1.484.755-2.362s-.242-1.723-.755-2.362c-.525-.654-1.302-1.05-2.259-1.05M3.986 7.037c0-.661.183-1.21.48-1.58.284-.354.701-.582 1.284-.582s1 .228 1.284.582c.297.37.48.919.48 1.58s-.183 1.21-.48 1.58c-.284.354-.701.582-1.284.582s-1-.228-1.284-.583c-.297-.37-.48-.918-.48-1.579m-.948 8.918h4.69c.114.467.337.894.634 1.25H3.038c-.68 0-1.327-.286-1.742-.764-.432-.498-.606-1.209-.265-1.92.823-1.72 2.636-2.896 4.719-2.896 1.13 0 2.18.346 3.035.936a6.6 6.6 0 0 0-.681 1.05 4.1 4.1 0 0 0-2.354-.736c-1.611 0-2.98.908-3.592 2.186-.1.21-.063.393.082.56.161.186.455.334.798.334M14.25 11.21c-2.334 0-4.354 1.36-5.202 3.323-.31.715-.125 1.419.308 1.912.419.476 1.065.76 1.744.76h6.3c.679 0 1.325-.284 1.743-.76.434-.493.618-1.197.309-1.912-.848-1.963-2.868-3.324-5.202-3.324m-4.055 3.818c.646-1.494 2.208-2.569 4.055-2.569s3.409 1.075 4.054 2.57a.52.52 0 0 1-.1.59c-.166.19-.461.336-.804.336h-6.3c-.343 0-.639-.146-.805-.336a.52.52 0 0 1-.1-.59"})},o=(0,n(680369).wt)("people",i)},164428:(e,t,n)=>{n.d(t,{Z:()=>x});n(725707),n(491955),n(403517);var i=n(242343),o=()=>n(174114),r=()=>n(348588),a=()=>n(727171),s=()=>n(662505),d=()=>n(477784),l=()=>n(640979),c=()=>n(907721),u=()=>n(466321),p=()=>n(535906),f=()=>n(935091),m=()=>n(858023),g=()=>n(443252),h=()=>n(88271),y=()=>n(634369),b=n(163643);function x(e){const t=(0,o().IS)((e=>({popup:{width:125,marginLeft:5},pillStyle:{display:"flex",alignItems:"center"}})),[]),{currentFilter:n,hideAllTime:x}=e,[v,S]=(0,i.useState)(!1),A=a().jf.filter((e=>!x||"all_time"!==e)).map((t=>{const n=()=>{e.onChangeFilter(t),S(!1)};return{key:t,action:()=>{},render:()=>(0,b.jsx)(p().A,{focused:!1,onClick:n,title:d().A.formatMessage(a().jy[t])})}})),j=(0,b.jsx)(s().A,{on:Boolean(n),wrapStyle:t.pillStyle,icon:(0,r().D)({width:16,marginRight:6,fill:"currentColor"}),title:d().A.formatMessage(a().jy[n]),onClick:()=>{S(!0)}}),w=[{key:"filters",items:A,render:e=>(0,b.jsx)(h().A,{...e,title:null,loading:!1})}],I=(0,b.jsx)(f().A,{menuType:l().gu.Popup,header:null,children:(0,b.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:0,sections:w})});return(0,b.jsx)(y().A,{marginAfter:!1,children:(0,b.jsx)(g().Ay,{popupType:u().n.Popup,placementToOrigin:c().W.Bottom,alignmentToOrigin:c().C.Start,open:v,render:()=>I,onDismiss:()=>S(!1),keepFocus:!0,origin:j,preventScaleTransition:!0,style:t.popup,trapFocus:!0,originGap:8})})}},433051:(e,t,n)=>{n.d(t,{S:()=>o});n(242343);var i=n(163643);const o=(0,n(680369).wt)("filter",{viewBox:"0 0 16 16",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 4C2 3.58579 2.33579 3.25 2.75 3.25H13.25C13.6642 3.25 14 3.58579 14 4C14 4.41421 13.6642 4.75 13.25 4.75H2.75C2.33579 4.75 2 4.41421 2 4Z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.75 8C3.75 7.58579 4.08579 7.25 4.5 7.25H11.5C11.9142 7.25 12.25 7.58579 12.25 8C12.25 8.41421 11.9142 8.75 11.5 8.75H4.5C4.08579 8.75 3.75 8.41421 3.75 8Z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 12C5.5 11.5858 5.83579 11.25 6.25 11.25H9.75C10.1642 11.25 10.5 11.5858 10.5 12C10.5 12.4142 10.1642 12.75 9.75 12.75H6.25C5.83579 12.75 5.5 12.4142 5.5 12Z"})]})})},443778:(e,t,n)=>{var i=n(74181),o=n(293259),r=n(422761),a=n(150590),s=n(53193),d=n(977351),l=n(465806),c=Array,u=o(d("Array","sort"));i({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&r(e);var t=a(this),n=s(c,t);return u(n,e)}}),l("toSorted")},543001:(e,t,n)=>{n.d(t,{B:()=>r});var i=()=>n(174114),o=()=>n(220413);function r(e){return(0,i().IS)((t=>({wrapper:{background:e?(0,o().qh)(e,t).color:t.surface.wash,borderRadius:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[e])}},584604:(e,t,n)=>{n.d(t,{L:()=>s});n(242343);var i=()=>n(421338),o=()=>n(543001),r=()=>n(707260),a=n(163643);function s(e){let{backgroundColor:t,children:n,...s}=e;const d=(0,o().B)(t),l={wrapper:{...d.wrapper,background:t?d.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,a.jsx)(i().Y1,{style:l.wrapper,align:"center",children:(0,a.jsx)(r().r,{...s,direction:"vertical",overrideSize:()=>48,children:n})})}},851363:(e,t,n)=>{n.d(t,{b:()=>r});var i=()=>n(129978);const o=new(i().O2)("time-series",(async()=>await Promise.resolve().then(n.bind(n,417021)))),r=(0,i()._h)(o,(e=>e.TimeSeries))},855022:(e,t,n)=>{n.r(t),n.d(t,{AnimatedEmojiBadge:()=>yt().f,GetNotifiedFor:()=>c,InboxActionsMenu:()=>ot().Ay,InboxNotificationSettingsButton:()=>Ae,MobileInboxPopup:()=>et,NotificationInboxPanelContent:()=>ht,SidebarInboxButton:()=>rt().SidebarInboxButton,TopbarUpdatesMenu:()=>h,UnreadMentionsBadge:()=>bt().A,UpdateSidebar:()=>X});var i=n(242343),o=()=>n(803290),r=()=>n(174114),a=()=>n(653998),s=()=>n(31448),d=()=>n(825750),l=n(163643);function c(e){const{navigableBlockStore:t,from:n,buttonPopupStore:i,style:c}=e,u=(0,o().K8)((()=>t.isPageBlock()),[t]),p=(0,r().IS)((e=>({label:{fontSize:s().J.UIRegular.desktop,color:e.text.primary,fontWeight:s().Wy.medium},border:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginTop:8}})),[]);return u?(0,l.jsxs)("div",{style:c,children:[(0,l.jsx)("div",{style:p.label,children:(0,l.jsx)(a().sA,{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"})}),(0,l.jsx)("div",{style:p.border,children:(0,l.jsx)(d().O,{blockStore:t,moreProminentStyling:!0,from:n,buttonPopupStore:i})})]}):null}var u=()=>n(840408),p=()=>n(935091),f=()=>n(983050),m=()=>n(640979),g=()=>n(331039);function h(e){const{blockStore:t,spaceStore:n}=e,i=function(e){const{spaceStore:t,blockStore:n}=e,i=(0,o().K8)((()=>{var e,t;return(null==n||null===(e=n.getModel())||void 0===e?void 0:e.isCollectionView())?null===(t=n.getCollectionPointer())||void 0===t?void 0:t.id:void 0}),[n]);if(!t)return;const r=n.id,a=t.id;return{navigableBlockId:r,collectionId:i,spaceId:a}}({blockStore:t,spaceStore:n});return i?(0,l.jsx)(p().A,{menuType:m().gu.Popup,className:f().sql,header:(0,l.jsx)(g().Ay,{navigableBlockStore:t,enablePageAnalytics:!1,noTopMargin:!0,inPeekView:!0}),children:(0,l.jsx)(u().A,{empty:()=>(0,l.jsx)(y,{}),source:"updates_sidebar",navigableBlockStore:t,...i},t.id)}):null}function y(){const e=(0,r().IS)((e=>({container:{marginTop:64,textAlign:"center",paddingLeft:18,paddingRight:18,marginBottom:64},content:{fontSize:14,color:e.text.secondary,marginTop:4}})),[]);return(0,l.jsx)("div",{style:e.container,children:(0,l.jsx)("div",{style:e.content,children:(0,l.jsx)("span",{children:(0,l.jsx)(a().sA,{defaultMessage:"No edits in this page yet.",id:"topbar.updatesButton.emptyState"})})})})}n(725707),n(113085);var b=()=>n(237385),x=()=>n(129808),v=()=>n(76394),S=()=>n(945792),A=()=>n(615917),j=()=>n(365060),w=()=>n(564440),I=()=>n(207762),T=()=>n(421761),k=()=>n(173736),M=()=>n(112224),C=()=>n(548694),B=()=>n(622286),R=()=>n(604284),_=()=>n(842617),z=()=>n(601178),N=()=>n(186438),E=()=>n(667801),P=()=>n(48913),H=()=>n(370557),L=()=>n(485966),U=()=>n(161718),F=()=>n(797470),K=()=>n(141122),O=()=>n(546002),D=()=>n(755587),q=()=>n(228765),V=()=>n(487800),$=()=>n(93624);function Y(e){const{currentTab:t,navigableBlockStore:n}=e,r=(0,o().K8)((()=>L().default.state.renderPhase),[]),[a,s]=(0,i.useState)(!1),d=(0,i.useMemo)((()=>Date.now()),[]),c=(0,o().K8)((()=>H().Ay.state.timeOpenedComments),[]),u=void 0!==c?Math.max(d,c):d,p=(0,B().X)("comment_sidebar_for_you");if((0,i.useEffect)((()=>{a||"rendered"!==r||s(!0)}),[n.id,a,r]),!n||!a)return(0,l.jsx)(O().J,{areaHeight:window.innerHeight});if(p)return(0,l.jsx)(V().B,{navigableBlockStore:n,timeViewed:u});switch(t){case H().tF.Comments:return(0,l.jsx)(D().R,{timeViewed:u,location:"sidebar"});case H().tF.Updates:return(0,l.jsx)(q().f,{enablePageAnalytics:e.enablePageAnalytics});case H().tF.Info:return(0,l.jsx)(T().H,{store:n,context:F().Rr.Frame,disabled:!1,shownAs:"sidebar"});default:return(0,v().ub)(t),(0,l.jsx)(D().R,{timeViewed:u,location:"sidebar"})}}function W(e){const t=(0,a().tz)(),n=(0,o().K8)((()=>({width:H().Ay.state.width,isAnimating:H().Ay.state.isAnimating,currentTab:H().Ay.state.currentTab})),[]),s=(0,_().n_)(),{shouldLoadSidebarComponents:d,isExpanded:c}=e,u=(0,i.useRef)(null),p=(0,o().K8)((()=>U().p.state.banners.some((e=>"LoggedOutAppBanner"===e.id))?U().p.state.height??0:0),[]),[f,m]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=requestAnimationFrame((()=>m(!0)));return()=>cancelAnimationFrame(e)}),[]);const g=(0,r().IS)((e=>({container:{flexGrow:0,flexShrink:0,width:n.width,zIndex:102,borderLeft:c?`1px solid ${e.regularDividerColor}`:"1px solid rgba(0,0,0,0)",alignSelf:"flex-end",position:"absolute",right:0,top:p,height:s?`calc(100vh - ${z().ls-p}px)`:`calc(100vh - ${p}px)`,pointerEvents:"none"},wrap:{height:"100%"},content:{position:"absolute",top:0,bottom:0,display:"flex",flexDirection:"column",overflow:"visible",zIndex:102,width:n.width}})),[n.width,c,s,p]);let h;return n.currentTab===H().tF.Comments?h=t.formatMessage({id:"updateSidebar.commentsAriaLabel",defaultMessage:"Page comments"}):n.currentTab===H().tF.Info?h=t.formatMessage({id:"updateSidebar.infoAriaLabel",defaultMessage:"Info"}):n.currentTab===H().tF.Updates?h=t.formatMessage({id:"updateSidebar.updatesAriaLabel",defaultMessage:"Page updates and analytics"}):(0,v().HB)(n.currentTab),d?(0,l.jsx)(A().A,{tag:"aside",visible:c,initial:{translateX:"100%"},animate:{translateX:0},exit:{translateX:"100%"},skip:!f,onAnimationStart:()=>{H().Ay.setState({...H().Ay.state,isAnimating:!0})},onAnimationEnd:()=>{H().Ay.setState({...H().Ay.state,isAnimating:!1})},ref:u,style:g.container,onMouseMove:()=>{n.isAnimating||H().Ay.setState({...H().Ay.state,mouseEntered:!0})},onMouseLeave:()=>{n.isAnimating||H().Ay.setState({...H().Ay.state,mouseEntered:!1})},"aria-hidden":!c||void 0,"aria-label":h,children:(0,l.jsx)("div",{style:g.wrap,children:(0,l.jsx)("div",{style:g.content,children:(0,l.jsx)(k().K,{from:"UpdateSidebar",fallback:e=>{let{error:t,errorId:n}=e;return(0,l.jsx)(M().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,l.jsx)(J,{...e})})})})}):null}function G(e){let{enablePageAnalytics:t,navigableBlockStore:n,onTabChange:i}=e;const a=(0,b().v3)(),s=(0,o().K8)((()=>H().Ay.state.currentTab),[]),d=(0,r().IS)((()=>({commentsHeaderStyle:{position:"relative",pointerEvents:"auto",marginTop:x().ek(a.device.isElectronMac)}})),[a]);if((0,B().X)("comment_sidebar_for_you"))return s===H().tF.Info?(0,l.jsx)("div",{style:d.commentsHeaderStyle}):(0,l.jsx)($().z,{navigableBlockStore:n});switch(s){case H().tF.Comments:return(0,l.jsx)("div",{style:d.commentsHeaderStyle});case H().tF.Updates:return(0,l.jsx)(g().Ay,{navigableBlockStore:n,enablePageAnalytics:t,onTabChange:i});case H().tF.Info:return(0,l.jsx)("div",{style:d.commentsHeaderStyle});default:return(0,v().ub)(s),(0,l.jsx)("div",{style:d.commentsHeaderStyle})}}function J(e){const{isResizerHovered:t,isResizing:n,currentTab:a,expanded:s,updatesSubTab:d}=(0,o().K8)((()=>{const{isResizerHovered:e,isResizing:t,currentTab:n,expanded:i,updatesSubTab:o}=H().Ay.state;return{isResizerHovered:e,isResizing:t,currentTab:n,expanded:i,updatesSubTab:o}}),[]),{currentBlockStore:c}=e,u=(0,b().v3)(),{currentTabToRender:p}=(0,o().K8)((()=>({currentTabToRender:c.isCollectionView()&&!c.isCollectionViewPageWithContent()?H().tF.Updates:a})),[c,a]),m=(0,o().K8)((()=>{const{currentSpaceStore:e}=L().default.state;return!(!e||(0,C().IL)(e))}),[]),h=i.useCallback((e=>{S().XI(u,{tab:e===H().VE.Updates?"updates":"analytics",origin:K().default.state.open?"peek_view":"page"}),H().Ay.setState({...H().Ay.state,updatesSubTab:e})}),[u]),y=(0,r().IS)((e=>({pane:{display:"flex",flexDirection:"column",height:"100%",position:"relative",pointerEvents:"none",maxHeight:"100%",backgroundColor:a===H().tF.Comments?void 0:"inherit"},resizerStyle:{position:"absolute",top:0,left:-3,bottom:0,right:0,height:"100vh",width:3,zIndex:-1,display:"block",transition:"box-shadow 300ms ease-in",...(t||n)&&s?{boxShadow:e.sidebarResizerBoxShadow}:{}},tabpanel:{display:"flex",flexDirection:"column",flex:"1 1 0",overflow:"hidden"}})),[a,t,n,s]),x=d?(0,H().aP)(d):(0,H().J)(p),v=(0,l.jsx)(k().K,{from:`UpdateSidebarContent.${x}`,fallback:e=>{let{error:t,errorId:n}=e;return(0,l.jsx)(M().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,l.jsx)(Y,{navigableBlockStore:c,currentTab:p,enablePageAnalytics:m})});return(0,l.jsxs)("div",{style:y.pane,className:f().YDC,children:[(0,l.jsx)("div",{style:y.resizerStyle}),(0,l.jsx)(G,{enablePageAnalytics:m,navigableBlockStore:c,onTabChange:h}),m?(0,l.jsx)("div",{style:y.tabpanel,role:"tabpanel",id:(0,I().Jy)(g().Oi,p),"aria-labelledby":(0,I().vU)(g().Oi,p),children:v}):v,s&&(0,l.jsx)(w().A,{type:"update"})]})}function X(e){const{isElectronMac:t,currentBlockStore:n}=e,r=(0,o().K8)((()=>({width:H().Ay.state.width,isAnimating:H().Ay.state.isAnimating,canRender:H().Ay.state.canRender})),[]),a=(0,o().O$)(L().AppStoreCurrentSpaceStore),s=(0,i.useMemo)((()=>null==a?void 0:a.clone()),[a]),d=(0,b().v3)(),{isExpanded:c,closeSidebar:u}=(0,o().K8)((()=>({isExpanded:(0,P().Nk)(d),closeSidebar:()=>E().setUpdateExpand({environment:d,isExpanded:!1,from:"close_for_space",saveDetailsSidebarPreference:!0})})),[d]),[p,f]=(0,i.useState)(!1),[m,g]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{(void 0===m||m===n.id)&&c&&(f(!0),g(n.id))}),[m,n,c]);const h=(0,o().K8)((()=>n.getAssociatedCollectionStore()),[n]);if(!(0,o().K8)((()=>{if(!r.canRender)return!1;if(s)return!0;if((0,N().g)())return!0;if(!h)return!1;const{count:e}=(0,R().pm)({collectionStore:h});return e>0}),[h,r.canRender,s]))return null;const y=()=>(0,l.jsx)(W,{isElectronMac:t,isFullyExpanded:!r.isAnimating,currentBlockStore:n,isExpanded:c,closeSidebar:u,shouldLoadSidebarComponents:p});return s?(0,l.jsx)(j().A,{store:s,droppable:!0,render:y},(null==s?void 0:s.id)||n.id):y()}var Z=()=>n(145322),Q=()=>n(23371),ee=()=>n(764872),te=()=>n(557067),ne=()=>n(435819),ie=()=>n(966789),oe=()=>n(168980),re=()=>n(635934),ae=()=>n(731394),se=()=>n(863969),de=()=>n(162339),le=()=>n(819788),ce=()=>n(264109),ue=()=>n(487893),pe=()=>n(175864),fe=()=>n(87607),me=()=>n(157710),ge=()=>n(851028),he=()=>n(680369),ye=()=>n(636023),be=()=>n(413240),xe=()=>n(330358),ve=()=>n(7379);function Se(e){let{location:t}=e;const o=(0,a().tz)(),s=(0,b().v3)(),d=(0,b().Y0)(),c=(0,i.useCallback)((()=>{const{device:e}=s;ee().fP(s),e.isMobile?be().A.setState({open:!0,source:be().C.Updates}):(ve().A.setState({...ve().A.state,open:!1}),xe().A.setState({...xe().A.state,currentTab:"notifications",defaultSubtab:void 0}),xe().A.setState({...xe().A.state,open:!0}))}),[s]),u=(0,ye().zg)(),p=(0,r().IS)((e=>({mobileTopBarIcon:{height:he().lD.default,width:he().lD.default,fill:e.text.primary},webUpdatesModalIcon:{width:16,height:16},button:d.isMobile?{height:30,width:30}:u.button})),[d.isMobile,u.button]);let f;switch(t){case"mobileTopBar":f=p.mobileTopBarIcon;break;case"webUpdatesModal":f=p.webUpdatesModalIcon;break;default:(0,v().HB)(t)}return(0,l.jsx)(n(103151).A,{renderTooltip:()=>(0,l.jsx)(a().sA,{defaultMessage:"Open notifications settings",id:"updatesModal.openNotifications.tooltip"}),render:e=>(0,l.jsx)(n(356813).A,{style:p.button,icon:n(389324).gearIcon,iconStyle:f,onClick:c,ariaLabel:o.formatMessage({id:"updatesModal.openNotifications.tooltipAriaLabel",defaultMessage:"Open notifications settings button"}),...e})})}const Ae=i.memo(Se);n(362833),n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(491955),n(324989),n(771702),n(403517);var je=()=>n(502140),we=()=>n(162901),Ie=()=>n(519423),Te=()=>n(927311),ke=()=>n(975392),Me=()=>n(818369),Ce=()=>n(84543),Be=()=>n(129978);const Re=new(Be().O2)("activityNotification",(async()=>await Promise.all([n.e(42838),n.e(93052),n.e(52181),n.e(14341),n.e(56409)]).then(n.bind(n,457607)))),_e=(0,Be()._h)(Re,(e=>e.ActivityNotification));var ze=()=>n(360482),Ne=()=>n(698094),Ee=()=>n(137650),Pe=()=>n(289232),He=()=>n(908589),Le=()=>n(413871),Ue=()=>n(951249),Fe=()=>n(196387);const Ke={};function Oe(e,t){e in Ke||(Ke[e]={measured:!1,startTime:performance.now(),size:t.size,type:t.type})}function De(e){const{groupName:t}=e;switch(t){case"today":return(0,l.jsx)(a().sA,{id:"InboxTimeGroupHeader.today",defaultMessage:"Today"});case"this_week":return(0,l.jsx)(a().sA,{id:"InboxTimeGroupHeader.thisWeek",defaultMessage:"This week"});case"last_week":return(0,l.jsx)(a().sA,{id:"InboxTimeGroupHeader.lastWeek",defaultMessage:"Last week"});case"older":return(0,l.jsx)(a().sA,{id:"InboxTimeGroupHeader.older",defaultMessage:"Older"});default:(0,v().HB)(t)}}function qe(e){const{groupName:t,shouldStickyHeader:n}=e,{isTablet:i}=(0,b().Y0)(),o=(0,r().IS)((e=>({headerContainer:{paddingTop:3,paddingBottom:3,paddingLeft:16,paddingRight:16,color:e.text.secondary,fontWeight:i?s().Wy.regular:s().Wy.medium,fontSize:i?"15px":"12px",...n&&{position:"sticky",top:0,backgroundColor:e.contentBackground,zIndex:2,paddingBottom:4,paddingTop:2}}})),[n,i]);return(0,l.jsx)("div",{style:o.headerContainer,children:(0,l.jsx)(De,{groupName:t})})}var Ve=()=>n(368070);const $e=new class{constructor(){this.state=new Map,this.noOpListener=()=>{}}cacheInboxPointers(e,t,n){const i=this.state.get(t);if(i)for(const o of i)e.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(o,this.noOpListener),(0,Ee().unsubscribeAfterDelay)({environment:e,pointer:o,userId:e.currentUser.id});for(const o of n)e.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(o,this.noOpListener),(0,Ee().cancelEviction)({pointer:o,userId:e.currentUser.id});this.state.set(t,n)}getNotificationIds(e){const t=this.state.get(e);if(!t)return;return t.filter((e=>e.table===Te()._p)).map((e=>e.id))}};const Ye=function(e){const[t,r]=(0,i.useState)(Math.random()),[a,s]=(0,i.useState)(20),d=(0,b().v3)(),c=(0,o().O$)(n(802955).e),u=(0,o().K8)((()=>{var e;return null===(e=L().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]);return(0,i.useEffect)((()=>{if(u){const e=ke().nF((e=>{let{value:t}=e;String(t).includes("unreadCount")||r(Math.random())}),1e3),t=(0,n(201430).dp)(u),i=Ne().Ay.addListener(t,void 0,e,void 0,d);if(i)return()=>{Ne().Ay.removeListener(i,d)}}}),[u,d]),c?(0,l.jsx)(Ze,{checkpoint:t,type:e.type,empty:e.empty,source:e.source,tab:e.tab,size:a,setSize:s,scrolledToTop:e.isScrolledToTopFromOtherSidebar}):(0,l.jsx)(Ge,{type:e.type})};function We(e){const t=(0,b().v3)(),n=(0,b().Y0)();return(0,r().IS)((i=>({placeholder:{...Qe(e,t),paddingTop:n.isMobile?64:void 0,minHeight:n.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:i.text.primary,overflow:"hidden"}})),[n.isMobile,t,e]).placeholder}function Ge(e){let{type:t}=e;const n=We(t);return(0,l.jsx)("div",{style:n,children:(0,l.jsx)("div",{children:(0,l.jsx)(a().sA,{defaultMessage:"Please go online to view your inbox.",id:"notificationInbox.offline.message"})})})}function Je(e){let{request:t,error:n,result:r,type:s,empty:d,source:c,tab:u,size:p,setSize:f,scrolledToTop:m,requestType:g}=e;const h=(0,b().v3)(),y=(0,b().Y0)(),x=(0,o().O$)(L().AppStoreCurrentSpaceStore),S=r??$e.getNotificationIds(g),A=(0,o().O$)(ce().Ay),j=(0,i.useContext)(Ve().B),w=(0,B().X)("inbox_page_grouping"),[I,T]=(0,o().K8)((()=>{if(!S)return[[],[]];const e=[],n=x?S.map((e=>Le().sk.createChildStore(x,{table:Te()._p,id:e}))):[],i=[],o=new Set,r=ke().oE(n.map((n=>{const o=n.getValue();if(!o)return null;if(o.invalid)return null;if("mentions"===t.type&&o.visited)return null;if("archive"===t.type&&!o.visited)return null;const r=ze().g5(n);if(!r||!r.isReady())return null;const a=r.getModel();if(!a||a.invalid)return i.push(o),null;const s=n.getDiscussionStore();if(null!=s&&s.isReady()&&"none"===(null==s?void 0:s.getRole()))return i.push(o),null;e.push(n.pointer),e.push(r.pointer),s&&e.push(s.pointer);const d=n.getNavigableBlockPointer();if(d&&e.push(d),j){if("inbox"===j&&"commented"!==o.type)return null;if("activity"===j&&"commented"===o.type)return null}return{activity:a,notification:o}}))).sort(((e,t)=>Number(t.notification.end_time)-Number(e.notification.end_time))).filter((e=>{let{notification:t}=e;if(!w)return!0;const n=t.navigable_block_id;if("commented"===t.type&&n){if(o.has(n))return i.push(t),!1;o.add(n)}return!0}));return $e.cacheInboxPointers(h,g,e),[r,i]}),[S,x,h,g,t.type,j,w]),k=(0,o().K8)((()=>ue().dl()),[]),M=0===(0,o().K8)((()=>ue().Yz(I,t.type)),[I,t.type]).size,C=(0,i.useCallback)((()=>{if(!x||n)return null;if(!S)return null;const e=[];let t=[];const o=ue().Ot();let r;return I.forEach(((n,a,s)=>{let{activity:d,notification:p}=n;const f=Number(p.end_time),m=o.findIndex((e=>{const{cutoffTime:t}=e;return void 0===t||t<=f}));if(m!==r){const n=o[m].name;e.push((0,l.jsx)("div",{children:t},`${n}-section-name`)),t=[(0,l.jsxs)(i.Fragment,{children:[1!==e.length&&(0,l.jsx)("div",{style:{height:8}}),(0,l.jsx)(qe,{groupName:n})]},`${n}-inbox-group-section`)],r=m}t.push((0,l.jsx)(_e,{activity:d,rootStore:x,isFirst:!1,isLast:!1,source:c,tab:u,notification:p},d.id))})),e.push((0,l.jsx)("div",{children:t},"time-grouping")),e}),[x,n,S,I,c,u]),R=(0,Be().fJ)(Re);(0,i.useEffect)((()=>{if(!x)return;!function(e,t,n){const i=e.filter((e=>!e.read));0!==i.length&&(je().log({level:"warning",from:"NotificationInbox",type:"invalidNotificationData",data:{ids:i.map((e=>e.id))}}),Ce().createAndCommit({userAction:"NotificationUpdates.unreadNotificationNotRendered",environment:n,canUndo:!0,perform:e=>{for(const n of i)te().ZB({notification:n,rootStore:t,transaction:e,read:!0})}}))}(T,x,h);const e=I.some((e=>{let{notification:t}=e;return!t.read&&!t.visited})),t=e&&I.some((e=>{let{notification:t}=e;return t.read&&!t.visited}));switch(k){case"unread_and_read":case"unread_only":ce().Ay.setState({...A,currentTab:"mentions",isCurrentTabEmpty:M,containsBothReadAndUnreadNotifications:t,containsUnreadNotifications:e,showOnlyUnreadNotifications:"unread_only"===k,unreadNotificationIds:[]});break;case"archived_only":ce().Ay.setState({...A,isCurrentTabEmpty:M,currentTab:"archive"});break;case"all_updates":break;default:(0,v().HB)(k)}}),[k,A,M,I,x,h,T]);const _=We(s);return!x||n?(0,l.jsx)("div",{style:_,children:(0,l.jsx)(a().sA,{defaultMessage:"Something went wrong.",id:"notificationUpdates.unknownErrorMessage"})}):S&&"resolved"===R.status?(0,l.jsxs)("div",{style:M?_:Qe(s,h),children:[M&&d,(0,l.jsx)("section",{role:"feed",className:"notranslate",children:C()}),(0,l.jsx)(oe().A,{onChange:e=>{if(!y.isMobile&&"closed"===ue().I6())return null;e<200&&S.length>=p&&f(S.length+20)}})]}):(0,l.jsx)("div",{style:Qe(s,h),children:(0,l.jsx)(O().J,{areaHeight:window.innerHeight})})}function Xe(e){const t=(0,b().v3)();return(0,i.useEffect)((()=>{void 0!==e.requestId&&function(e,t){if(!(e in Ke))return;const n=Ke[e];if(n.measured)return;n.measured=!0;const{startTime:i,size:o,type:r}=n;Fe().default.DO_NOT_USE_measureLegacy({metricName:"notification_render",startTime:i},{environment:t,data:{size:o,type:r}})}(e.requestId,t)}),[e.requestId,t]),(0,l.jsx)(l.Fragment,{children:e.children})}function Ze(e){const{type:t,empty:n,source:r,tab:a,size:s,setSize:d,scrolledToTop:c,checkpoint:u}=e,p=(0,b().v3)(),{currentUserStore:f,currentSpaceStore:m,currentUserRootStore:g}=(0,o().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t,currentUserRootStore:n}=L().default.state;return{currentUserStore:e,currentSpaceStore:t,currentUserRootStore:n}}),[]),h=(0,o().K8)((()=>"unread_only"===ue().dl()),[]),[y,x]=(0,i.useState)(u),S=(0,i.useMemo)((()=>function(e,t){switch(e){case"mentions":return t?"unread_only":"unread_and_read";case"archive":return"archived";default:(0,v().HB)(e)}}(t,h)),[t,h]),[A,j]=(0,we().Yb)((async()=>{if(!f||!m)return null;if((0,He().o)(m)&&g){const e=(0,Pe().f)({currentUserRootStore:g}).map((e=>e.getSpaceId()));return async function(e){const{environment:t,userId:n,spaceIds:i,size:o,type:r,requestType:a}=e,s=ce().Ay.startLoading();Oe(s,{size:o,type:r});const d=await(0,Q().lX)(i,10,(e=>Me().callApi({eventName:"getNotificationLogV2",environment:t,data:{spaceId:e,size:o,type:a,variant:"no_grouping"},userId:n,headers:(0,Ie().WS)({spaceId:e})})));ce().Ay.endLoading(s);return{notificationIds:d.flatMap((e=>"failed"===e.type?[]:e.data.notificationIds)),requestId:s}}({environment:p,userId:f.id,spaceIds:e,requestType:S,size:s,type:t})}return async function(e){const{environment:t,userId:n,spaceId:i,size:o,type:r,requestType:a}=e,s=ce().Ay.startLoading();Oe(s,{size:o,type:r});const d=await Me().callApi({eventName:"getNotificationLogV2",environment:t,data:{spaceId:i,size:o,type:a,variant:"no_grouping"},userId:n,headers:(0,Ie().WS)({spaceId:i})});if(ce().Ay.endLoading(s),"failed"===d.type)throw d.error;return{notificationIds:d.data.notificationIds,requestId:s}}({environment:p,userId:f.id,spaceId:m.id,requestType:S,size:s,type:t})}),[m,f,g,p,S,s,t],{throttle:1e3});if((0,i.useEffect)((()=>{u!==y&&(j(),x(u))}),[u,y,j]),!f||!m||!A)return null;const w=m.id,I=f.id,{value:T,error:k}=A,M={spaceId:w,userId:I,type:t};return Ue().setState({request:M,result:null==T?void 0:T.notificationIds}),(0,l.jsx)(Xe,{requestId:null==T?void 0:T.requestId,children:(0,l.jsx)(Je,{type:t,requestType:S,empty:n,source:r,tab:a,size:s,setSize:d,request:M,error:k,result:null==T?void 0:T.notificationIds,scrolledToTop:c})})}function Qe(e,t){const{device:n}=t;return{minHeight:n.isMobile||"mentions"===e?void 0:"75vh"}}function et(e){const t=(0,b().Y0)(),n=(0,b().v3)();(0,i.useEffect)((()=>()=>(ee().L_(n),void te()._V({environment:n,newTab:"mentions",shouldTrack:!1}))),[n]);const o=(0,r().IS)((e=>({chevron:{fill:e.text.primary,width:26,height:26},padding:{width:1}})),[]);let a;if(t.isMobile){const n="mobileTopBar";a={menuType:m().gu.Modal,title:(0,l.jsx)(ge().R,{}),width:e.format===ae().Cn.RenderAsPage?"100vw":void 0,renderAsPage:e.format===ae().Cn.RenderAsPage,leftRightButtonStyle:{paddingRight:14},right:[(0,l.jsx)(Ae,{location:n},"InboxNotificationSettingsButton"),(0,l.jsx)("span",{style:o.padding},"paddingSpan2"),(0,l.jsx)(me().F,{},"InboxFilterButton"),(0,l.jsx)("span",{style:o.padding},"paddingSpan1"),(0,l.jsx)(pe().C,{},"InboxEllipsisButton")],left:[(0,l.jsx)(it,{},"loading-spinner"),t.isPhone&&(0,le().T)("supportsNativeHome")&&e.format===ae().Cn.RenderAsPage&&!(0,le().T)("supportsNativeInbox")?void 0:(0,Z().Z)(o.chevron)],onClickLeft:e.onClose,whiteBackground:!0,disableHeaderShadow:!0}}else a={menuType:m().gu.Popup,height:"auto"};return(0,l.jsxs)(p().A,{...a,className:f().e3e,children:[(0,l.jsx)(oe().A,{onChange:(e,t)=>{let{offsetFromTop:n}=t;ce().gJ.setState(n<=0)}}),(0,l.jsx)(ne().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowMobileAutoScroll:!0,render:()=>e.format===ae().Cn.RenderAsPage?(0,l.jsx)(nt,{}):(0,l.jsx)(tt,{})})]})}function tt(){const e=(0,se().O)(),t=(0,o().K8)((()=>ue().dl()),[]),n={emptyState:{marginTop:100,cursor:"auto"}};return(0,l.jsx)(l.Fragment,{children:"all_updates"!==t?(0,l.jsx)(Ye,{type:"archived_only"===t?"archive":"mentions",source:"notifications_tab",tab:"inbox",empty:(0,l.jsx)("div",{style:n.emptyState,children:(0,l.jsx)(fe().x,{})})},t):e&&(0,l.jsx)(u().A,{spaceId:e,source:"notifications_tab",empty:()=>(0,l.jsx)("div",{style:n.emptyState,children:(0,l.jsx)(fe().x,{})})},t)})}function nt(){const e=(0,b().v3)();return(0,l.jsx)(re().A,{fetch:async()=>{await Q().wR(0),await L().default.waitUntil((()=>void 0!==L().default.state.currentSpaceStore))},loading:()=>(0,l.jsx)(i.Fragment,{}),willRender:()=>{var t;null===(t=e.mobileNative)||void 0===t||t.markTransitionReady({environment:e,type:"updates"})},render:()=>(0,l.jsx)(A().A,{initial:{opacity:0},animate:{opacity:1},children:(0,l.jsx)(tt,{})})})}function it(){const e=(0,o().K8)((()=>void 0!==ce().Ay.state.loadingId),[]),t=(0,de().A)(e,400,0);return(0,le().T)("supportsNativeHome")?t?(0,l.jsx)(ie().A,{style:{width:14}}):(0,l.jsx)("div",{style:{width:14}}):null}var ot=()=>n(925564),rt=()=>n(818816),at=()=>n(686752),st=()=>n(417653),dt=()=>n(142708),lt=()=>n(304566),ct=()=>n(967454),ut=()=>n(420441),pt=()=>n(271748),ft=()=>n(98508),mt=()=>n(580257);function gt(){const e=(0,r().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",gap:6,height:36,width:174,position:"absolute",left:"50%",marginLeft:-87,bottom:12,zIndex:20,borderRadius:18,background:e.blueColor,color:e.white,boxShadow:e.buttonBoxShadow,fontSize:14},hovered:{background:e.blueButtonHoveredBackground},pressed:{background:e.blueButtonPressedBackground},icon:{width:16,height:16}})),[]);return(0,l.jsxs)(st().A,{style:e.button,hoveredStyle:e.hovered,pressedStyle:e.pressed,href:"https://dev.notion.so/notion/346c06d81dbf4cf188bf44fcef6a6a62?v=fa0376c6fb2a40f0b77d68b683f73e5b&pvs=4",external:!0,children:[(0,at().pencilLineIcon)(e.icon),(0,l.jsx)("div",{children:"Provide Feedback"})]})}function ht(e){const{titleId:t}=e,n=(0,o().K8)((()=>{const{currentSpaceStore:e}=L().default.state;if(e)return e.id}),[]),a=(0,o().K8)((()=>!1),[]),s=(0,o().K8)((()=>ye().n5()),[]),d=(0,o().K8)((()=>pt().default.state.mode),[]),c=(0,o().K8)((()=>ue().dl()),[]),{isTablet:p}=(0,b().Y0)(),f=(0,r().IS)((e=>({container:{flexDirection:"column",width:"100%",display:"flex",marginTop:p?12:void 0},scroller:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",marginRight:0,pointerEvents:"auto",width:"100%",..."peek"===d?{}:{minWidth:s}},emptyState:{marginTop:100,cursor:"auto"}})),[s,d,p]),m=(0,o().uB)(void 0,mt().A),g=(0,o().K8)((()=>m.state.elementRef??{current:null}),[m]),h=0===(0,ct().yE)(g),y=(0,i.useContext)(Ve().B);return(0,l.jsxs)("div",{style:f.container,children:[(0,l.jsx)(ut().Q,{type:y??"inbox",titleId:t}),(0,l.jsx)(lt().A,{scrollerStore:m}),(0,l.jsxs)(dt().H,{type:ft().A.Y,style:f.scroller,store:m,children:[(0,l.jsx)(oe().A,{onChange:(e,t)=>{let{offsetFromTop:n}=t;ce().gJ.setState(n<=0)}}),"all_updates"!==c?(0,l.jsx)(Ye,{type:"archived_only"===c?"archive":"mentions",source:"notifications_tab",tab:"inbox",empty:(0,l.jsx)("div",{style:f.emptyState,children:(0,l.jsx)(fe().x,{})}),isScrolledToTopFromOtherSidebar:h},c):n&&(0,l.jsx)(u().A,{spaceId:n,source:"notifications_tab",empty:()=>(0,l.jsx)("div",{style:f.emptyState,children:(0,l.jsx)(fe().x,{})})},c)]}),a&&(0,l.jsx)(gt,{})]})}var yt=()=>n(590240),bt=()=>n(358716)},951249:(e,t,n)=>{n.r(t),n.d(t,{getNotificationValues:()=>l,getState:()=>d,setState:()=>s});n(403517);var i=()=>n(644353),o=()=>n(927311),r=()=>n(485966);let a={};function s(e){a={...a,...e}}function d(){return a}function l(){const e=a.result;if(!e)return null;const t=r().default.state.currentSpaceStore;return t?e.map((e=>{const n={table:o()._p,id:e,spaceId:t.getSpaceId()},r=t.getRecordValue(n),a=null==r?void 0:r.activity_id;if(a&&r){const e={table:i().kz,id:a,spaceId:t.getSpaceId()};r.activity=t.getRecordValue(e)}return r})):null}},977351:(e,t,n)=>{var i=n(745339);e.exports=function(e,t){var n=i[e],o=n&&n.prototype;return o&&o[t]}}}]);