"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[11126,62342,88552,92821,93139],{83043:(e,t,r)=>{r.d(t,{vK:()=>s,uF:()=>c,Mt:()=>p,q1:()=>u,RM:()=>l});r(516176),r(362833),r(725707),r(491955),r(113085);var n=()=>r(76394),o=()=>r(403508),a=()=>r(655353),i=()=>r(39559);const s={id:"32983546-2835-4c6b-9101-25f10781415c",name:"inference-saved-examples"};function u(e){return e.some((e=>"config"===e.type&&"workflow"===e.value.type))}function l(e,t){const r={};for(const n of e)"registered-tool-grouping"===n.type&&(r[n.toolCallId]=n);let s=[...e];if("config"===t.type||"user"===t.type||"error"===t.type||"context"===t.type||"workflow-error"===t.type||"title"===t.type||"retry"===t.type||"autocorrect"===t.type||"search-observation"===t.type||"researcher-text-observation"===t.type||"debug-inference"===t.type||"fast-researcher-plan"===t.type||"fast-researcher-search-results"===t.type||"memory-agent"===t.type||"summarize-transcript"===t.type||"summarize-transcript-record-map"===t.type||"summarize-transcript-error"===t.type||"workflow-run-investigation"===t.type||"workflow-runs"===t.type||"workflow-function-call-request"===t.type||"workflow-function-edit-request"===t.type||(0,o().P0)(t)||"researcher-agent-group"===t.type||"workflow-view-files"===t.type||"workflow-updated-metadata"===t.type||"workflow-updated-code"===t.type||"workflow-ran-tests"===t.type||"workflow-updated-modules"===t.type||"workflow-updated-views"===t.type||"workflow-updated-triggers"===t.type||"workflow-updated-functions"===t.type||"workflow-added-module-types"===t.type||"agent-debug-error"===t.type||"agent-user-action"===t.type||"attachment"===t.type||"agent-transcript-summary"===t.type||"agent-records-updated"===t.type)s.push({...t});else if("workflow-inference"===t.type||"search"===t.type||"agent-inference"===t.type||"agent-tool-result"===t.type)s=[...s.filter((e=>e.id!==t.id)),{...t}];else if("workflow-function-call-results"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"workflow-function-call-results"===s[e].type){const r=s[e];s[e]={...r,value:[...r.value,...t.value]}}else s.push({...t})}else if("markdown-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"markdown-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("search-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"search-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("fast-researcher-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"fast-researcher-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("workflow"===t.type){const e=s.findLastIndex((e=>e.id===t.id));-1!==e&&"workflow"===s[e].type?s[e]={...t}:s.push({...t})}else if("workflow-progress"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"workflow-progress"===s[e].type){const r=function(e,t){const r=[...e];for(const n of t){const e=(0,i().v1)(n),t=r.findIndex((t=>(0,i().v1)(t)===e&&!t.completed));if(-1!==t&&n.completed){r[t]=n;continue}const o=r.findIndex((t=>(0,i().v1)(t)===e));if(-1===o)r.push(n);else{const e=r[o];e.completed&&!n.completed?r.push(n):!e.completed&&n.completed&&(r[o]=n)}}return r}(s[e].items,t.items);s[e]={...s[e],items:r,completed:t.completed,durationMs:t.durationMs}}else s.push({...t})}else if("setup"===t.type){const e=s.findLastIndex((e=>e.id===t.id));-1!==e&&"setup"===s[e].type?s[e]=t:s.push({...t})}else if("researcher-report"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"researcher-report"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`,citationInfo:(0,a().Mi)(r.citationInfo,t.citationInfo)}}else s.push({...t})}else if("researcher-agent"===t.type){const e=s.findIndex((e=>e.id===t.id));-1!==e&&"researcher-agent"===s[e].type?s[e]={...s[e],value:Object.assign(s[e].value,t.value),updatedAt:t.updatedAt}:s.push({...t})}else if("researcher-next-steps"===t.type){const e=s.findIndex((e=>e.id===t.id));-1!==e?s[e]={...t}:s.push({...t})}else if("registered-tool-call"===t.type||"registered-tool-output"===t.type||"registered-tool-error"===t.type){let e=r[t.toolCallId];e||(e={id:t.toolCallId,type:"registered-tool-grouping",toolName:t.toolName,toolCallId:t.toolCallId,steps:[]},r[t.toolCallId]=e,s.push(e));const n={...t};e.steps.push(n)}else if("registered-tool-grouping"===t.type)r[t.toolCallId]||(r[t.toolCallId]=t,s.push({...t}));else if("setup-operations"===t.type){const e=s.findLastIndex((e=>e.id===t.id)),r=s[e];(null==r?void 0:r.type)===t.type?s[e]={...r,operations:[...r.operations,...t.operations]}:s.push({...t})}else(0,n().HB)(t);return s}const c="inferenceTranscript";function p(e){return"object"==typeof e&&null!==e&&"transcript"in e}},228138:(e,t,r)=>{r.d(t,{Ke:()=>y,RD:()=>f,Sw:()=>g,Vf:()=>d,_z:()=>c,cZ:()=>w,d7:()=>T,dL:()=>h,hx:()=>a,iC:()=>v,jx:()=>m,lA:()=>b,qG:()=>p,rL:()=>u,s8:()=>_,vW:()=>i});var n=()=>r(975392),o=()=>r(76394);const a=[{type:"search",scopeForNextSearch:{type:"everything"},searchSessionId:void 0},{type:"researcher",searchScope:{type:"everything"},useWebSearch:!0},{type:"setup-generator"},{type:"workflow"},{type:"markdown-chat"},{type:"fast-researcher"}],i={maxIterations:8,multiturnIterations:1,thinkingTokens:1024,filterToSpaceSharedResults:!1},s=["search","researcher","setup-generator"];function u(e){return!!(0,o().Xk)(s,e)}const l=["workflow","setup-generator","fast-researcher","tool-markdown-chat"],c=["markdown-chat","search","researcher","workflow","setup-generator"];function p(e){const{agentEnabled:t}=e,r=n().oE([...s,t?"workflow":void 0]);return a.filter((e=>r.includes(e.type)))}const d=[{type:"route-inference-transcript",configs:a.filter((e=>c.includes(e.type)))},...a.filter((e=>l.includes(e.type)))];function m(e){const{uploadedFileData:t,id:r}=e;if("application/pdf"===t.contentType){return{id:r,type:"attachment",fileUrl:t.originalFileUrl,fileName:t.fileName,contentType:t.contentType,base64EncodedFileUrl:t.base64EncodedFileUrl}}if("image/png"===t.contentType||"image/jpeg"===t.contentType||"image/gif"===t.contentType||"image/webp"===t.contentType){return{id:r,type:"attachment",fileUrl:t.originalFileUrl,fileName:t.fileName,contentType:t.contentType}}(0,o().HB)(t.contentType)}const g=["slack","google-drive","github","gmail","helpdocs","helpdoc-section","webpage","jira","microsoftTeams","notion","sharepoint","linear"],h="searchAgent",f="unifiedFindAgent",b="readingAgent",y="taskAgent",v="databaseAgent",w="databaseBulkReadContentAgent",_={originalOutput:[],feedback:"",inputSummary:"",promptFeedback:"",testInstructions:"",originalOutputPassesTest:!1,originalOutputTestResults:[],correctedOutputs:[],verified:!1},T=["Eval","Prompt"];"\n'Chat with AI':\n\nRouting Instructions:\n- If this mode is selected, the user will receive an AI response without a search being conducted.\n- Route to this mode when the user asks for general knowledge, chatting, or writing content that does not require additional information not already in the context.\n- Do NOT route to this mode when the query requires current statistics, facts, or up-to-date information.\n- Do NOT route to this mode when the query requires searching the user's workspace.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: Tell me a bedtime story about a robot who learns to dream.\nOUTPUT: 0\n</example>\n<example>\nINPUT: What are some key ideas behind design thinking?\nOUTPUT: 0\n</example>\n<example>\nINPUT: largest mammal\nOUTPUT: 0\n</example>\n<example>\nINPUT: write a haiku about the first snowfall\nOUTPUT: 0\n</example>\n<example>\nINPUT: Who was Joan of Arc?\nOUTPUT: 0\n</example>\n<example>\nINPUT: create a plan for an 80th birthday party\nOUTPUT: 0\n</example>\n".trim(),"\n'Quick search':\n\nRouting Instructions:\n- If this mode is selected, a single search will be conducted and an AI response will be provided that takes the search results into consideration.\n- Route to this mode if you need to find information across the Notion workspace, Slack, Google Drive, Github, or Jira to handle the user's request.\n- Route to this mode when the query seeks a single, specific fact, definition, or data point, or when the user needs current or time-sensitive information.\n- Route to this mode if the user seems to be searching for a specific document in their workspace.\n- Route to this mode if the user needs support: e.g. if they are mentioning getting support, requesting help, asking for customer service, reporting a problem with the product, or requesting a feature - we may be able to find some relevant content in the Notion Help Center\n- Do NOT route to this mode when the request requires synthesizing multiple pieces of information or generating a detailed research report.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: automated checkout PRD\nOUTPUT: 1\n</example>\n<example>\nINPUT: Who leads the podiatry dept?\nOUTPUT: 1\n</example>\n<example>\nINPUT: overnight parking policy\nOUTPUT: 1\n</example>\n<example>\nINPUT: When are we going to release our documentary about polar bears in the Arctic?\nOUTPUT: 1\n</example>\n<example>\nINPUT: Find my PR that enables dynamic builds.\nOUTPUT: 1\n</example>\n".trim(),"\n'Research Mode':\n\nRouting Instructions:\n- Route to this mode when the query explicitly requests research, analysis, or in-depth exploration.\n- Route to this mode when the query requires conducting multiple searches or synthesizing information from multiple sources or on multiple topics.\n- Do NOT route to this mode when the query can be answered with a single search.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: Whose work is most UX focused between Amy, Paula, and Xochitl?\nOUTPUT: 2\n</example>\n<example>\nINPUT: Write profiles for 10 of our biggest north African customers.\nOUTPUT: 2\n</example>\n<example>\nINPUT: Can you put together some recommendations for how to move forward with the Lumi deal? Check our recent Slack discussions for context. Write your recommendations in a similar style to how I have written them in the past.\nOUTPUT: 2\n</example>\n<example>\nINPUT: detailed comparison of the healthcare systems of Canada, the UK, Germany, and Singapore in terms of efficiency and accessibility\nOUTPUT: 2\n</example>\n<example>\nINPUT: What are the trends and geopolitical implications of the global semiconductor supply chain?\nOUTPUT: 2\n</example>\n\n".trim(),"\n'App builder':\n\nRouting Instructions:\n- Route to this mode when the query explicitly asks to build an app or system, or when the request involves automating processes within Notion or external tools.\n- Do NOT route to this mode when the user is seeking information rather than building a system or when the request is for creative content or general conversation.\n\nExamples:\n<example>\nINPUT: Create a task management app with deadlines and team assignments.\nOUTPUT: 3\n</example>\n<example>\nINPUT: Develop a CRM that tracks client interactions and schedules follow-ups.\nOUTPUT: 3\n</example>\n<example>\nINPUT: design an invoice system that sends payment reminders\nOUTPUT: 3\n</example>\n<example>\nINPUT: could you build a knowledge base that categorizes notes by topic automatically?\nOUTPUT: 3\n</example>\n<example>\nINPUT: Set up a content calendar for social media posts\nOUTPUT: 3\n</example>\n<example>\nINPUT: Create a recruitment pipeline for interview stages.\nOUTPUT: 3\n</example>\n<example>\nINPUT: I want a dashboard for visualizing Notion database metrics\nOUTPUT: 3\n</example>\n<example>\nINPUT: a way to process and categorize customer feedback automatically\nOUTPUT: 3\n</example>\n".trim(),"\n<example>\nINPUT: Create a database to track my job applications\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need a way to organize my project tasks and deadlines\nOUTPUT: 3\n</example>\n<example>\nINPUT: Help me keep track of my fitness progress over time\nOUTPUT: 3\n</example>\n<example>\nINPUT: I want to build a system for managing my inventory\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need something to organize all my recipes and ingredients\nOUTPUT: 3\n</example>\n<example>\nINPUT: Can you help me set up a customer relationship management system?\nOUTPUT: 3\n</example>\n<example>\nINPUT: [pasted CSV or similar structured data]\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need to organize my collection of books\nOUTPUT: 3\n</example>\n".trim()},267711:(e,t,r)=>{r.d(t,{K:()=>i});r(725707),r(500234);var n=()=>r(329979),o=()=>r(672154),a=()=>r(836331);function i(e){const{store:t}=e,r=o().A.state,i=(0,n().isAiOnboardingFlow)(r.flowName)||a().default.checkGate({gateName:"workflows_simple_mode"}),s=a().default.checkGate({gateName:"workflows_config_module_available"}),u=a().default.checkGate({gateName:"workflows_custom_view_type"}),l=null==t?void 0:t.getCollectionViewStores().find((e=>"custom"===e.getType()));return{type:"workflow",workflowBlockId:null==t?void 0:t.id,enableCustomViews:!!l||!i&&u,enableFunctions:!i,enableConfigVariables:s}}},297083:(e,t,r)=>{r.d(t,{Dp:()=>I,GW:()=>u,HQ:()=>s,LN:()=>i,N8:()=>w,Qv:()=>k,RR:()=>l,S2:()=>U,SX:()=>h,TP:()=>C,Te:()=>o,Uc:()=>x,af:()=>F,bV:()=>S,dO:()=>f,gJ:()=>p,js:()=>N,kT:()=>M,nB:()=>c,nD:()=>T,oN:()=>y,oS:()=>v,qW:()=>m,u7:()=>q,w5:()=>b,wL:()=>a,xU:()=>g,yc:()=>d,yd:()=>_});r(610931),r(403517);var n=()=>r(76394);class o extends Error{constructor(e,t,r){super(t),this.type=e,this.cause=r}getMetadata(){}}class a extends o{}class i extends a{constructor(e){let t=1===e.attributeNames.length?`Unexpected attribute for <${e.tagName}> tag: ${e.attributeNames[0]}`:`Unexpected attributes for <${e.tagName}> tag: ${e.attributeNames.join(", ")}`;e.attributeNames.includes("key")&&(t+="\n\nThe key attribute is not needed. You should omit it."),super("unexpected_attributes",t)}}class s extends a{constructor(e){super("missing_attribute",`The <${e.tagName}> tag is missing a ${e.attributeName} attribute. It should be specified as <${e.tagName} ${e.attributeName}="...">`)}}class u extends a{constructor(e){super("bad_attribute",`Attempted to set attribute ${e.attributeName} on a <${e.tagName}> tag to a value that is not allowed: ${e.receivedValue}`)}}class l extends a{constructor(e){const{tagName:t,unexpectedNode:r}=e;let n;n=r?"text"===r.type?`Plain text, whitespace, or newlines are not allowed inside a <${t}> tag. Make sure not to include any extra whitespace or newlines in your XML.`:`A <${r.tagName}> tag is not allowed inside a <${t}> tag`:`Encountered an invalid child inside a <${t}> tag.`,"set-title"===t||"set-property"===t?n+=`\nOnly inline elements and text are allowed inside <${t}>`:"insert-before"===t||"insert-after"===t||"insert-inside"===t||"chat"===t?(n+=`\nOnly block elements are allowed inside <${t}>`,"chat"===t&&(n+="\nWhen using <chat>, remember to wrap text in <text> tags.")):"create"===t&&(n+="\nWhen using <create>, remember to wrap in a <page> tag."),super("disallowed_child",n),this.tagName=void 0,this.unexpectedNode=void 0,this.tagName=t,this.unexpectedNode=r}}class c extends a{constructor(e){const{tagName:t,unexpectedNode:r,conditionName:n,cause:o}=e;super("disallowed_child_in_condition",r?"text"===r.type?`Plain text, whitespace, or newlines are not allowed inside a <${t}> tag with "${n}" condition`:`A <${r.tagName}> tag is not allowed inside a <${t}> tag with "${n}" condition`:`Encountered an invalid child inside a <${t}> tag with "${n}" condition`),this.cause=void 0,this.cause=o}}class p extends a{constructor(e){super("expected_tag_name",`Expected a <${e}> tag`)}}class d extends a{constructor(e){let t;(0,n().O9)(e.unexpectedNode)?"text"===e.unexpectedNode.type?t=`Text is not supported as a child for a ${e.nodeType} node`:"element"===e.unexpectedNode.type?t=`Unsupported ${e.nodeType} tag name: ${e.unexpectedNode.tagName}`:(0,n().HB)(e.unexpectedNode):t=`Unexpected value for a ${e.nodeType} node`,super("unsupported_node",t)}}class m extends a{constructor(e,t){super("unmapped_id",`Expected counter ID for attribute ${e}, instead received ${t}`)}}class g extends a{constructor(e){const{expectedIdType:t,receivedIdType:r,tagNameForErrorMessage:n,idValueForErrorMessage:o}=e;super("unexpected_id_type",n?`Expected ID ${o} in <${n}> to be of type '${t}', instead received ID of type '${r}'`:`Expected ID ${o} to be of type '${t}', instead received ID of type '${r}'`)}}class h extends a{constructor(e){super("out_of_order_node",`Encountered a ${e.foundNodeType} after a ${e.incorrectlyAfterType}. You should ensure that any ${e.foundNodeType}s come before ${e.incorrectlyAfterType}s.`)}}class f extends a{constructor(){super("table_row_property_name","Inside tr, the property-text name attribute must be a string which is an integer counter, starting from 1.")}}class b extends a{constructor(){super("synced_block_invalid_children","Cannot include content when writing a <synced-block-reference> tag")}}class y extends a{constructor(){super("must_provide_id","Block node is missing an id attribute")}}class v extends a{constructor(){super("cannot_provide_id","When creating new blocks, do not provide an id attribute.")}}class w extends a{constructor(){super("must_provide_unknown_block_id","When referencing unknown blocks, you must provide an id.")}}class _ extends a{constructor(){super("cannot_append_to_multiple_properties","Cannot append to multiple properties. Use multiple calls to <insert-inside> instead.")}}class T extends a{constructor(){super("cannot_remove_from_multiple_properties","Cannot remove from multiple properties. Use multiple calls to <delete> instead.")}}class k extends a{constructor(){super("move_disallowed","A <move> tag is not allowed in this context")}}class x extends a{constructor(){super("set_attribute_without_key","<set-attribute> is missing an attribute to set")}}class N extends a{constructor(e){super("invalid_query_condition",`<${e.tagName}> condition operator must be ${e.allowedOperators.map((e=>`"${e}"`)).join(" or ")}, not "${e.inputCondition}"`)}}class I extends a{constructor(e){super("children_required",`<${e.tagName}> must have children`)}}class S extends a{constructor(e){super("only_one_child_allowed",`Only one ${e} element is allowed`)}}class C extends a{constructor(e){super("unknown_api",`Unexpected API: ${e}. Make sure to use only the supported XML APIs, and ensure you are using this API in the right context.`)}}class q extends o{constructor(e,t){super("load_page_as_xml_failed",t),this.pageId=e}getMetadata(){return{pageId:this.pageId}}}class U extends o{constructor(e,t){super("load_database_as_xml_failed",t),this.databaseId=e}getMetadata(){return{databaseId:this.databaseId}}}class M extends o{constructor(){super("illegal_replace_page",'When calling <replace> on a page, you must provide a <page> tag as the single child, like this: <replace start="..." end="..."><page>...</page></replace>.')}}class F extends o{constructor(){super("out_of_order_replace","When calling <replace>, the start of the range must be AFTER the end of the range.")}}},312905:(e,t,r)=>{r.d(t,{Kd:()=>u});var n=()=>r(129044);r(725707),r(491955);const o={acceptedInferenceKeys:[],inferenceKeysToAnnotations:{},inferenceKeysToMemories:{},tags:[],abortController:void 0,stopInferencePromise:void 0,temporarySteps:[],inferences:[],traceId:void 0,requestInfo:void 0,loading:!1,stagedData:{}};class a extends n().default{getInitialState(){return o}resetState(){var e;null===(e=this.state.abortController)||void 0===e||e.abort(),this.setState(o)}getTemporaryAttachmentStagedDataOrInstantiate(){const e=this.state.stagedData;if(null!=e&&e.attachmentStagedData)return e.attachmentStagedData;const t={stagedAttachmentUploadStore:new(r(513124).G),stagedClientSteps:[],stagedEngineSteps:[],stagedInferenceTranscriptSteps:[]};return this.setState({...this.state,stagedData:{...this.state.stagedData,attachmentStagedData:t}}),t}getStagedAttachmentUploadStoreIfExists(){var e;const t=this.state.stagedData;return null==t||null===(e=t.attachmentStagedData)||void 0===e?void 0:e.stagedAttachmentUploadStore}stageAttachmentInferenceTranscriptStep(e){const{step:t}=e,r=this.getTemporaryAttachmentStagedDataOrInstantiate(),n={...r,stagedInferenceTranscriptSteps:[...r.stagedInferenceTranscriptSteps,t]};this.setState({...this.state,stagedData:{...this.state.stagedData,attachmentStagedData:n}})}unstageAttachmentInferenceTranscriptStep(e){var t;const{fileId:r}=e,n=null===(t=this.state.stagedData)||void 0===t?void 0:t.attachmentStagedData;if(!n)return;const o=n.stagedInferenceTranscriptSteps.filter((e=>"attachment"!==e.type||e.fileUrl!==r));this.setState({...this.state,stagedData:{...this.state.stagedData,attachmentStagedData:{...n,stagedInferenceTranscriptSteps:o}}})}getAndClearStagedAssistantAttachmentSteps(){var e;const t=null===(e=this.state.stagedData)||void 0===e?void 0:e.attachmentStagedData;if(!t)return;const{stagedInferenceTranscriptSteps:r}=t;return this.setState({...this.state,stagedData:{...this.state.stagedData,attachmentStagedData:void 0}}),r}}const i={type:"search",scopeForNextSearch:{type:"everything"}};class s extends n().default{getInitialState(){const e=r(470637).A.withListenerIgnored((()=>r(836331).default.checkGate({gateName:"workflows_inference_replay"})));return{showHistory:!1,showDebug:!1,loading:!1,configForNewTranscripts:i,userSelectedConfig:void 0,agentModelConfig:void 0,persistStrategy:"manual",model:void 0,debugOverrides:{usePromptCache:e?"s3":void 0},threadRegistry:{},isAIChatTranscriptSidePanelVisible:!1,threadToStagedData:{}}}getOrCreateClientAIChatThreadStore(e){if(!this.state.threadRegistry[e]){const t=new a;return this.setState({...this.state,threadRegistry:{...this.state.threadRegistry,[e]:t}}),t}return this.state.threadRegistry[e]}}const u=new s;(0,r(996094).exposeDebugValue)("clientAiChatStore",u)},329979:(e,t,r)=>{r.r(t),r.d(t,{getContextualizedOnboardingAnalyticsData:()=>d,getOnboardingFlowCreatedSpaceWithoutPlanType:()=>v,getOnboardingProgressPercentage:()=>f,getSpaceIntentOverride:()=>h,getStageName:()=>l,getStages:()=>c,isAiOnboardingFlow:()=>w,isEducationFlowState:()=>p,isPublicAccessPageRedirect:()=>g,isWorkflowTemplatesEnabledForOnboarding:()=>y,shouldRedirectToJoinSpace:()=>m,shouldShowProgressIndicatorOnStage:()=>b});r(610931);var n=()=>r(443164),o=()=>r(199164),a=()=>r(548694),i=()=>r(485966),s=()=>r(30299),u=()=>r(332305);function l(e){const{flowName:t,stageIndex:r,environment:n}=e;return c({flowName:t,environment:n})[r]}function c(e){let{flowName:t,environment:r}=e;const n=r.device.isMobile,o=u().onboardingFlowNameToFlowConfig[t];if(n){if(!o.isEnabledForMobile)throw new Error(`Mobile flow is not enabled for flow name: ${t}`);return o.getMobileStages(r)}if(!o.isEnabledForDesktop)throw new Error(`Desktop flow is not enabled for flow name: ${t}`);return o.getDesktopStages()}function p(e){var t,r;return"education_flow"===e.flowName&&void 0!==(null===(t=e.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.educationRole)&&void 0!==(null===(r=e.planTypeAndSurveyInfo)||void 0===r||null===(r=r.surveyResponses)||void 0===r?void 0:r.educationLevel)}function d(e){var t,r,n,o,u,c,p;let{onboardingState:d,spaceJoinOrCreate:m,environment:g}=e;const{currentSpaceStore:h}=i().default.state,f=(0,a().p3)(),b=(null===(t=d.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.userPersona)??f.function,y=(null===(r=d.planTypeAndSurveyInfo)||void 0===r||null===(r=r.surveyResponses)||void 0===r?void 0:r.userRole)??f.role,v=(null===(n=d.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.companySize)??f.companySize,w=(null===(o=d.planTypeAndSurveyInfo)||void 0===o?void 0:o.planType)??f.intent,_=(null===(u=d.planTypeAndSurveyInfo)||void 0===u||null===(u=u.surveyResponses)||void 0===u?void 0:u.useCases)??f.useCases,T=(null===(c=d.planTypeAndSurveyInfo)||void 0===c||null===(c=c.surveyResponses)||void 0===c?void 0:c.categories)??f.categories,k=(null===(p=d.planTypeAndSurveyInfo)||void 0===p?void 0:p.collaborativeIntent)??f.collaborativeIntent;return{flow_name:d.flowName,flow_id:d.flowId,stage:l({flowName:d.flowName,stageIndex:d.currentStageIndex,environment:g}),initial_workspace_type:m,is_new_onboarding:Boolean(d.isFirstTimeOnboarding),is_create_or_join:!0,stage_number:d.currentStageIndex,num_of_joinable_spaces:d.joinableSpaces.length,historical_stages:d.historicalStages,selectedPresets:void 0,user_persona:b,user_team_role:y,user_use_cases:_,user_categories:T,user_company_size:v,plan_selection:w,collaborative_intent:k,plan_type:null==h?void 0:h.getPlanType(),stage_duration_in_ms:void 0,onboarding_templates:void 0,trial_id:(0,s().E5)(),performance_marketing_term:d.performanceMarketingTerm,is_invalid_redirect:d.isInvalidRedirect,is_dark_mode:"dark"===g.ThemeStore.state.mode,selected_workflow_templates:d.selectedWorkflowTemplateIds}}function m(e){return"guest_redirect"===e.type||"redirect_page"===e.type||"redirect_space"===e.type}function g(e){return"public_access_page_redirect"===e.type}function h(e){if("form_response_onboarding"===e.flowName)return"string"==typeof(t=e.formSpaceIntent)&&o().ay.includes(t)?e.formSpaceIntent:"personal";var t}function f(e,t){const{currentStageIndex:r}=e;return 15+(r+1)/c({flowName:e.flowName,environment:t}).length*80}function b(e,t){const r=t.device.isMobile,{currentStageIndex:n}=e,o=c({flowName:e.flowName,environment:t}).indexOf(r?"mobile_onboarding_plan_type_choose":"onboarding_plan_type_choose");return-1!==o&&n>=o}function y(e){return!e.device.isMobile}function v(e){return w(e)}function w(e){return n().He.includes(e)}},332305:(e,t,r)=>{r.r(t),r.d(t,{onboardingFlowNameToFlowConfig:()=>b});var n=r.n(r(485359)),o=()=>r(132793),a=()=>r(560320),i=()=>r(70989),s=()=>r(927685),u=()=>r(137476),l=()=>r(362621),c=()=>r(461201),p=()=>r(485966),d=()=>r(836331),m=()=>r(493065),g=()=>r(30299);var h=()=>r(652675),f=()=>r(672154);const b={education_flow:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","education_persona_survey","education_category_picker"],onStartFlow:()=>{},shouldShowFlowToUser:e=>!1},ai_onboarding_phase_2:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","app_builder","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const t=(0,l().R)(p().default.state.currentUserRootStore);void 0===t&&(0,u().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const r=0===(t??0),n=e.device.isMobile;return r&&!n&&function(){const e=o().r9();return Boolean(e)}()&&"on"===d().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two",defaultGroup:"control"})}},ai_onboarding_phase_2_5:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout","app_builder"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const t=(0,l().R)(p().default.state.currentUserRootStore);void 0===t&&(0,u().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const n=0===(t??0),o=e.device.isMobile,a="en-US"===r(16791).locale;return n&&!o&&a&&("ai_step_in_onboarding"===d().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"})||"ai_step_in_onboarding_with_skip"===d().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"}))}},form_response_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose"],getMobileStages:()=>["mobile_profile","mobile_onboarding_workspace_choose"],onStartFlow:()=>{},onCompleteFlow:async(e,t,o)=>{n()("form_response_onboarding"===t.flowName);const{defaultOnboardingComplete:i}=await a().F.contextualizedOnboardingActions.load();await i(e,o),r(156973).V(t.formResponseId,t.secretKey,t.formSpaceId)},shouldShowFlowToUser:()=>0===(0,l().R)(p().default.state.currentUserRootStore)&&(0,r(785205).A)()},mail_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async(e,t,n)=>{const{setAndTrackContextualizedOnboardingComplete:u}=await a().F.contextualizedOnboardingActions.load(),{onboardingData:l,joinableSpaces:p}=t;if(!l)return;const{onboardingStateActions:d}=await r(58793).onboardingActionsDependency.load();if(i().m({message:d.messages.creatingWorkspace}),0===p.length&&l.canUserCreateSpace){const n=r(477784).A.getIntl(),o=l.userStore.getFullName(n),{spaceViewStore:a}=await r(783759).bz({environment:e,planType:"personal",planSelection:"personal",name:o?(0,c().JR)(o,n):(0,c().CD)(n),userRootStore:l.userRootStore,analyticsFrom:"onboarding",icon:void 0,userPersona:"unfilled"});r(13769).I$(e,a,!0),u({environment:e,onboardingState:t,userStore:l.userStore,spaceJoinOrCreate:"create",permissionLevel:"member"})}await m().transactionQueue.drain(),i().V();const g=(0,o().KB)({fileHostProtocol:s().A.secureFileConfig.protocol,fileHostName:s().A.secureFileConfig.hostname}),h=null==g?void 0:g.result,f=null==h?void 0:h.startsWith(`${s().A.mail.domainBaseUrl}/`);h&&f?r(865226).oo({environment:e,url:`${h}#activeUserID=${e.currentUser.id}`}):await(0,r(938051).Z)({environment:e,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>"mail"===(0,o().dY)()},calendar_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile"],getMobileStages:()=>["mobile_profile"],onStartFlow:()=>{},onCompleteFlow:async(e,t,n)=>{await m().transactionQueue.drain(),await(0,r(313067).J7)({environment:e,url:`${s().A.domainBaseUrl}/calendarAuth/`,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>0===(0,l().R)(p().default.state.currentUserRootStore)&&"calendar"===(0,o().dY)()},performance_marketing_term_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_invite"],onStartFlow:()=>{},onCompleteFlow:async(e,t,r)=>{const{defaultOnboardingComplete:n}=await a().F.contextualizedOnboardingActions.load();await n(e,r)},shouldShowFlowToUser:e=>!e.device.isMobile&&("gantt"===(0,g().TQ)()||"crm"===(0,g().TQ)()||"projectManagement"===(0,g().TQ)())},mobile_tutorial_onboarding:{isEnabledForDesktop:!1,isEnabledForMobile:!0,getMobileStages:e=>(0,h().getMobileTutorialStages)(e),onStartFlow:()=>{},onCompleteFlow:async(e,t,r)=>{var n,o;const i=t.onboardingData;if(!i)return;const{redirectAfterContextualizedOnboardingComplete:s}=await a().F.contextualizedOnboardingActions.load(),u=(0,c().sg)(i);await s({environment:e,spaceViewId:null===(n=p().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id,spaceId:null===(o=p().default.state.currentSpaceStore)||void 0===o?void 0:o.id,onboardingData:i,spaceJoinOrCreate:"join",redirectData:u,onboardingFlow:t.flowName,onboardingState:t,permissionLevel:(0,c().S1)(u)})},shouldShowFlowToUser:(e,t)=>Boolean(t)},default:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","onboarding_category_survey",..."on"===y({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["team_onboarding_function","team_onboarding_role","team_onboarding_company_size"]:["team_onboarding_persona_survey"],"team_onboarding_use_cases","team_onboarding_workspace_create","team_onboarding_invite","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],getMobileStages:e=>[...["mobile_profile","mobile_onboarding_workspace_choose","mobile_onboarding_plan_type_choose","mobile_onboarding_collaborative_intent_choose",..."on"===y({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["mobile_team_onboarding_function","mobile_team_onboarding_role","mobile_team_onboarding_company_size"]:["mobile_team_onboarding_persona_survey"],"mobile_onboarding_category_survey","mobile_team_onboarding_use_cases","mobile_team_onboarding_workspace_create","mobile_team_onboarding_invite"],...(0,h().getMobileTutorialStages)(e)],onStartFlow:()=>{},shouldShowFlowToUser:(e,t)=>(void 0===(0,l().R)(p().default.state.currentUserRootStore)&&(0,u().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}}),!t)},undefined:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async()=>{},shouldShowFlowToUser:()=>!1}};function y(e){const{experimentId:t,disableExposureLogging:r}=e,n=f().A.state.onboardingExperiments;if(null!=n&&n[t])return n[t];const o=d().default.getEligibleGroup({experimentId:t,defaultGroup:"control",disableExposureLogging:r});return f().A.setState({...f().A.state,onboardingExperiments:{...n,[t]:o}}),o}},362621:(e,t,r)=>{r.d(t,{R:()=>o});r(725707),r(491955),r(403517);var n=()=>r(975392);function o(e){return e&&e.isReady()?n().sb(e.getSpaceViewStores().filter((e=>e.getJoined())).map((e=>e.getSpaceId()))).length:void 0}},403508:(e,t,r)=>{r.d(t,{$A:()=>d,P0:()=>g,VB:()=>m,kI:()=>h,nh:()=>p});r(725707),r(491955),r(500234),r(403517),r(875472),r(76509),r(863754);var n=r.n(r(938762)),o=()=>r(76394),a=()=>r(627618),i=()=>r(214144),s=()=>r(905184),u=()=>r(829629),l=()=>r(963002);const c="/workflows/oauth/connect";function p(e,t){const r=Object.fromEntries(Object.entries(e).filter((e=>{let[t,r]=e;return Boolean(r)})));return`${t}${c}?${new URLSearchParams(r).toString()}`}a().object({required:{moduleType:a().literals(...Object.keys(l().Nh)),moduleKey:a().string(),spaceId:a().string()},optional:{redirectToAuth:a().literal("true"),transcriptId:a().string(),workflowId:a().string(),moduleSpecific:a().string(),callbackType:a().literals(...r(545250).Bi)}});function d(e){const t={...e};delete t.examples,delete t.memories,delete t.annotation,"transcript"in e&&Array.isArray(e.transcript)&&(t.transcript=e.transcript.map((e=>({...e,id:void 0,traceId:void 0}))));const r=(o=t,n()(o,a?{space:"  "}:void 0));var o,a;return(0,i().gB)(r)}function m(e,t){var r,n,o;const a=null==t||null===(r=t.modules)||void 0===r?void 0:r.find((t=>t.key===e.moduleKey));if(!a||null===(n=e.state)||void 0===n||!n.type)return!1;const i=null===(o=l().Nh[a.type].triggers[e.state.type])||void 0===o?void 0:o.isTriggerConfigured;return!i||i(e.state)}function g(e){return"workflow-operation"===(null==e?void 0:e.type)||"workflow-user-structured-information"===(null==e?void 0:e.type)}function h(e){const{spaceId:t,id:r,table:n}=e;return n===u().C0?{spaceId:t,workflowId:r}:n===s().To?{spaceId:t,transcriptId:r}:void(0,o().HB)(n)}},481325:(e,t,r)=>{r.d(t,{$d:()=>i,AZ:()=>s,p:()=>l});r(610931),r(362833),r(403517);var n=()=>r(975392),o=()=>r(204132);class a extends Error{constructor(e){super(e)}}function i(e,t){const r=Array.isArray(t)?t:[t],[,n]=e(r);return n.status?{value:n.value}:{error:n.error}}function s(e,t){const r=i(e,t);if(o().Q.isFail(r))throw r.error;return r.value}const u=Symbol("ManyTillEndSentinel"),l={try:e=>t=>{const[r,n]=e(t);return n.status?[r,n]:[t,n]},any:()=>e=>e.length>0?[e.slice(1),{status:!0,value:e[0]}]:[[],{status:!1,error:new a("Reached end of input")}],eof:e=>t=>0===t.length?[[],{status:!0,value:void 0}]:[t,{status:!1,error:(null==e?void 0:e(t[0]))??new a("Expected end of input")}],map:(e,t)=>r=>{const[n,o]=e(r);return[n,o.status?{status:!0,value:t(o.value)}:o]},mapResult:(e,t)=>r=>{const[n,a]=l.map(e,t)(r);return a.status?o().Q.isFail(a.value)?[n,{status:!1,error:a.value.error}]:[n,{status:!0,value:a.value.value}]:[n,a]},andThen:(e,t)=>r=>{const[n,o]=e(r);return o.status?t(o.value)(n):[n,o]},sequence:function(e){return t=>{const r=[];for(const n of e){const[e,o]=n(t);if(!o.status)return[e,o];r.push(o.value),t=e}return[t,{status:!0,value:r}]}},satisfy:function(e){return l.try((t=>{const[r,n]=l.any()(t);return n.status&&!e(n.value)?[r,{status:!1,error:new a("Failed predicate")}]:[r,n]}))},filter:function(e,t){return l.try((r=>{const[n,o]=e(r);return[n,o.status?t(o.value)?o:{status:!1,error:new a("Failed predicate")}:o]}))},literal:e=>l.describe(l.satisfy((t=>n().n4(t,e))),(()=>new a(`Expected: ${JSON.stringify(e)}.`))),describe:(e,t)=>r=>{const[n,o]=e(r);return[n,o.status?o:{status:!1,error:t()}]},constant:e=>t=>[t,{status:!0,value:e}],choice:e=>0===e.length?l.fail((()=>new a("No parsers to choose from"))):t=>{let r=e[0](t);for(const o of e.slice(1)){const[e,a]=r;if(a.status||!n().n4(e,t))return r;r=o(t)}return r},fail:e=>t=>[t,{status:!1,error:e(t)}],many:e=>t=>{const r=[];for(;;){const[n,o]=l.try(e)(t);if(!o.status)return[n,{status:!0,value:r}];r.push(o.value),t=n}},manyTill:(e,t)=>r=>{const n=[];for(;;){const[o,a]=l.choice([l.map(t,(()=>u)),l.try(e)])(r);if(!a.status)return[o,a];if(a.value===u)return[o,{status:!0,value:n}];n.push(a.value),r=o}},many1:e=>l.map(l.sequence([e,l.many(e)]),(e=>{let[t,r]=e;return[t,...r]})),sepBy:(e,t)=>l.choice([l.sepBy1(e,t),l.constant([])]),sepBy1:(e,t)=>l.andThen(e,(r=>l.map(l.many(l.map(l.sequence([t,e]),(e=>{let[,t]=e;return t}))),(e=>[r,...e])))),lazy:e=>l.andThen(l.constant(void 0),e),lookAhead:e=>t=>[t,e(t)[1]]}},501518:(e,t,r)=>{r.r(t),r.d(t,{getCurrentWorkflowNavigationState:()=>T,getDefaultClosedNavigationState:()=>y,getDefaultOpenNavigationState:()=>b,getIsWorkflowEditorOpen:()=>w,getIsWorkflowEditorStateOpen:()=>v,getIsWorkflowNavigationStateCurrent:()=>_,getMergedWorkflowNavigationState:()=>k,routeArgsGivenNavigationState:()=>x,useIsWorkflowEditorOpen:()=>I,useWorkflowNavigationState:()=>N});var n=()=>r(237385),o=()=>r(803290),a=()=>r(975392),i=()=>r(3311),s=()=>r(76394),u=()=>r(44658),l=()=>r(627618),c=()=>r(485966),p=()=>r(308265);const d=l().object({required:{isOpen:l().literal(!0)},optional:{}}),m={configure:l().intersection([d,l().object({required:{type:l().literal("configure")},optional:{prompt:l().string()}})]),function:l().intersection([d,l().object({required:{type:l().literal("function"),key:l().string()},optional:{}})]),module:l().intersection([d,l().object({required:{type:l().literal("module"),key:l().string()},optional:{}})]),database:l().intersection([d,l().object({required:{type:l().literal("database"),id:l().string()},optional:{}})]),trigger:l().intersection([d,l().object({required:{type:l().literal("trigger"),key:l().string()},optional:{}})]),debug:l().intersection([d,l().object({required:{type:l().literal("debug")},optional:{}})]),preview:l().intersection([d,l().object({required:{type:l().literal("preview")},optional:{collectionViewId:l().string()}})]),runtime_actor:l().intersection([d,l().object({required:{type:l().literal("runtime_actor")},optional:{}})]),view_settings:l().intersection([d,l().object({required:{type:l().literal("view_settings"),key:l().string()},optional:{}})]),runs:l().intersection([d,l().object({required:{type:l().literal("runs")},optional:{runId:l().string()}})]),test:l().intersection([d,l().object({required:{type:l().literal("test"),name:l().string(),functionKey:l().string()},optional:{}})])},g=l().union(Object.values(m)),h=l().object({required:{isOpen:l().literal(!1)},optional:{}}),f=l().union([g,h]);function b(){return{isOpen:!0,type:"configure"}}function y(){return{isOpen:!1}}function v(e){return(null==e?void 0:e.isOpen)??!1}function w(e){return v(T(e))}function _(e){const{currentNavigationState:t,navigationState:r}=e,n=k({defaultNavigationState:{isOpen:!1},currentNavigationState:t,newNavigationState:r});return(0,a().n4)(t,n)}function T(e){const{RouterStore:t}=e;if("page"!==t.state.route.name)return;const r=c().default.state.mainEditorCurrentBlockStore;return r&&r.isCollectionView()&&r.canEdit()&&!r.isLocked()?function(e){const{workflowViewType:t,workflowViewKey:r,workflowPrompt:n,collectionViewId:o}=e;switch(t){case"debug":case"runtime_actor":return{isOpen:!0,type:t};case"function":case"module":case"trigger":case"view_settings":if(!r)return;return{isOpen:!0,type:t,key:r};case"database":if(!r)return;return{isOpen:!0,type:t,id:(0,i().ZA)(r)??r};case"preview":return{isOpen:!0,type:"preview",collectionViewId:o};case"configure":return{isOpen:!0,type:"configure",prompt:n?decodeURIComponent(n):void 0};case"runs":return{isOpen:!0,type:"runs",runId:(0,i().ZA)(r)};case"test":if(!r)return;const[e,a]=r.split(",");if(!e||!a)return;return{isOpen:!0,type:"test",name:a,functionKey:e};default:return}}(t.state.route):void 0}function k(e){const{defaultNavigationState:t,currentNavigationState:r,newNavigationState:n}=e;if(!(0,p().sx)())return{isOpen:!1};const o={...t};if(r)for(const[i,s]of Object.entries(r))o[i]=s;if(n)for(const[i,s]of Object.entries(n))o[i]=s;const a=(0,u().tf)(f,o);if(a)throw a;return o}function x(e){if(!e.isOpen)return{workflowViewType:void 0,workflowViewKey:void 0,collectionViewId:void 0};const t=e.type,r={};switch(t){case"configure":case"debug":case"runtime_actor":return{...r,workflowViewType:t,workflowViewKey:void 0};case"function":case"module":case"trigger":case"view_settings":return{...r,workflowViewType:t,workflowViewKey:e.key};case"database":return{...r,workflowViewType:t,workflowViewKey:e.id};case"runs":return{...r,workflowViewType:t,workflowViewKey:e.runId};case"test":return{...r,workflowViewType:t,workflowViewKey:`${e.functionKey},${e.name}`};case"preview":return{...r,workflowViewType:"preview",collectionViewId:e.collectionViewId};default:(0,s().HB)(t)}}function N(){const e=(0,n().v3)();return(0,o().K8)((()=>T(e)??{isOpen:!1}),[e])}function I(){const e=(0,n().v3)();return(0,o().K8)((()=>w(e)),[e])}},513124:(e,t,r)=>{r.d(t,{G:()=>n});r(725707),r(491955);class n extends(()=>r(129044))().default{getInitialState(){return{originalFileUrlToSuccessfullyUploadedFiles:new Map,inProgressUploadFileIdsToProgress:new Map}}setValueForUploadedFile(e,t){this.setState({...this.state,originalFileUrlToSuccessfullyUploadedFiles:new Map(this.state.originalFileUrlToSuccessfullyUploadedFiles).set(e,t)})}setValueForUploadingFile(e,t){const r=new Map(this.state.inProgressUploadFileIdsToProgress);r.set(e,t),this.setState({...this.state,inProgressUploadFileIdsToProgress:r})}deleteValueForUploadingFile(e){const t=new Map(this.state.inProgressUploadFileIdsToProgress);t.delete(e),this.setState({...this.state,inProgressUploadFileIdsToProgress:t})}deleteValueForUploadedFile(e){const t=new Map(this.state.originalFileUrlToSuccessfullyUploadedFiles);t.delete(e),this.setState({...this.state,originalFileUrlToSuccessfullyUploadedFiles:t})}onFileUploadPercentageChanged(e){const{fileId:t,fileName:r,percentage:n,contentType:o}=e;this.setValueForUploadingFile(t,{type:"uploading",fileName:r,progress:n,contentType:o})}onFileUploadFailed(e){const{error:t}=e,{fileId:r,fileName:n}=t;this.setValueForUploadingFile(r,{type:"error",error:t,fileName:n})}onFileUploadCompleted(e,t){this.deleteValueForUploadingFile(e),this.setValueForUploadedFile(t.originalFileUrl,t)}setCompletedFileForRetry(e){this.setValueForUploadedFile(e.originalFileUrl,e)}onDeleteFileUpload(e){this.deleteValueForUploadedFile(e)}isUploadInProgress(){return Array.from(this.state.inProgressUploadFileIdsToProgress.values()).filter((e=>"error"!==e.type)).length>0}doesCurrentChatHaveUpload(){return this.isUploadInProgress()||this.state.originalFileUrlToSuccessfullyUploadedFiles.size>0}}},514088:(e,t,r)=>{function n(e){return"text"===e.type&&!e.value.trim()}r.d(t,{A:()=>n})},524070:(e,t,r)=>{r.d(t,{Ov:()=>m,PJ:()=>g,_o:()=>d,dK:()=>s,sD:()=>p,uS:()=>i});r(610931),r(362833),r(725707),r(324989),r(771702),r(403517);var n=()=>r(975392),o=()=>r(76394),a=()=>r(668337);const i="\x3c!--<selection>--\x3e",s="\x3c!--</selection>--\x3e";function u(e){const{node:t,selection:r,path:p,onlyAllowPropertyTypes:d,namespace:m}=e;if(p.includes(t))throw new Error("Circular reference detected!");const g=[...p,t],h=[];if("text"===t.type)for(const n of t.value)h.push(n);else{let e="";e+=`<${t.tagName}`;for(const[r,n]of Object.entries(t.attributes||{}))void 0!==n&&(e+=` ${r}="${n}"`);const p=`</${t.tagName}>`;if("block"===t.type){const a="block"===t.type&&"block"===(null==r?void 0:r.type)&&r.blockIds[0]===t.attributes.id,f="block"===t.type&&"block"===(null==r?void 0:r.type)&&r.blockIds[r.blockIds.length-1]===t.attributes.id,b="block"===t.type&&"text"===(null==r?void 0:r.type)&&(r.start.blockId===t.attributes.id||r.end.blockId===t.attributes.id);a&&h.push(i);if(0===t.text.length&&0===Object.values(t.properties).length&&0===Object.values(t.schemas).length&&0===t.children.length&&!b)h.push(`${e}/>`);else{h.push(`${e}>`);const a=[];if(t.text)for(const e of t.text){const t=u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)a.push(e)}let f,b;"text"===(null==r?void 0:r.type)&&r.start.blockId===t.attributes.id&&(f=r.start.index),"text"===(null==r?void 0:r.type)&&r.end.blockId===t.attributes.id&&(b=r.end.index);for(let e=0;e<a.length;e++){const t=a[e];let n="";(0,o().O9)(r)&&e===f&&(n+=i),(0,o().O9)(r)&&e===b&&(n+=s),n+=t,h.push(n)}if((0,o().O9)(r)&&f===a.length&&h.push(i),(0,o().O9)(r)&&b===a.length&&h.push(s),"end_to_end"!==m&&"tr"===t.tagName){n().Ul(Object.values(t.properties),(e=>Number(e.attributes.name))).forEach(((e,n)=>{const o=t.parent&&"table"===t.parent.tagName?t.parent:void 0,a=o&&o.attributes["header-row"],i=o&&"table"===o.tagName&&o.attributes["header-column"],s=o&&0===o.children.indexOf(t),l=a&&0===n||i&&s?"th":"td";h.push(`<${l}>`),h.push(...e.children.flatMap((e=>u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m})))),h.push(`</${l}>`)}))}else{const e=function(e){const{tagName:t,properties:r}=e;if("tr"===t)return r;const n=[];for(const o of r){const e=c(o),r="page"===t;("property-title"===o.tagName||!e||r&&n.length<l)&&n.push(o)}return n}({tagName:t.tagName,properties:Object.values(t.properties)});for(const t of e)d&&!d.includes(t.tagName)||h.push(...u({node:t,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m}))}for(const e of Object.values(t.schemas))h.push(...u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m}));if(t.children)for(const e of t.children){const t=u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)h.push(e)}h.push(p)}(0,o().O9)(r)&&f&&h.push(s)}else if("collection"===t.type){h.push(`${e}>`);for(const e of Object.values(t.properties))d&&!d.includes(e.tagName)||h.push(...u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m}));for(const e of Object.values(t.schemas))h.push(...u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m}));h.push(p)}else{const n=(0,o().u0)((e=>"collection"===e.type||"collectionView"===e.type?{true:e}:{false:e}));if(n(t)||0===t.children.length)h.push(`${e}/>`);else{const i=[];if(!n(t)&&t.children)for(const e of t.children){const t=u({node:e,selection:r,path:g,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)i.push(e)}if(i.length<=1||(0,o().O)(a()._S,t.tagName)&&a()._S[t.tagName].isToken)h.push(`${e}>${i.join("")}${p}`);else for(let t=0;t<i.length;t++){const r=i[t];0===t?h.push(`${e}>${r}`):t===i.length-1?h.push(r+p):h.push(r)}}}}return h}const l=20;function c(e){return"property-checkbox"!==e.tagName&&("property-number"===e.tagName?!e.attributes.number:0===e.children.length)}function p(e){const{node:t,selection:r,onlyAllowPropertyTypes:n,namespace:o}=e;return u({node:t,selection:r,path:[],onlyAllowPropertyTypes:n,namespace:o}).join("")}function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a="";if(t){a+="\n";for(let e=0;e<r;e++)a+="\t"}if("text"===e.type)a+=o?n().ih(e.value):e.value;else{a+=`<${e.tagName}`;for(const[t,r]of Object.entries(e.attributes||{}))a+=` ${t}="${r}"`;if(e.children&&e.children.length>0){a+=">";for(const n of e.children)a+=d(n,t,r+1,o);if(t){a+="\n";for(let e=0;e<r;e++)a+="\t"}a+=`</${e.tagName}>`}else a+="/>"}return a}function m(e){let t="";if("text"===e.type)t+=e.value;else if(e.children)for(const r of e.children)t+=m(r);return t}function g(e){return e.map((e=>d(e))).join("")}},590856:(e,t,r)=>{r.d(t,{Et:()=>d});r(610931),r(362833),r(725707),r(491955);var n=()=>r(204132),o=()=>r(76394),a=()=>r(481325),i=()=>r(297083),s=()=>r(668337),u=()=>r(514088),l=(r(403517),()=>r(760068));const c=a().p.map(l().W6,(e=>({type:"text",value:e.value})));function p(e){const t=(0,o().s8)(s()._S,((t,r)=>function(e,t){const r=s()._S[e],{mapCounterToKey:o}=t;return a().p.mapResult((0,l().U5)(e),(t=>{const i=(0,l().ke)({inputAttributes:t.attributes,definitions:r.attributes,tagName:e,mapCounterToKey:o});if(n().Q.isFail(i))return i;let s=t.children??[];r.text||(s=s.filter((e=>!(0,u().A)(e))));const c=(0,a().$d)(a().p.manyTill(d({inlineNodesAllowed:r.inline,textAllowed:r.text,parentTagName:e,mapCounterToKey:o}),a().p.eof()),s);if(n().Q.isFail(c))return c;const p=c.value;return{value:{type:"inline",tagName:e,attributes:i.value,children:p}}}))}(r,e)));return t}function d(e){const{inlineNodesAllowed:t,textAllowed:r,parentTagName:n,mapCounterToKey:s}=e,u=[...t],l=[];for(const[a,i]of(0,o().WP)(p({mapCounterToKey:s})))(0,o().Xk)(u,a)&&l.push(i);return a().p.choice([...l,...r?[c]:[],a().p.fail((e=>e.length>0?new(i().RR)({tagName:n,unexpectedNode:e[0]}):new Error("No inline or text node")))])}},652675:(e,t,r)=>{r.r(t),r.d(t,{getContextualizedOnboardingFlowName:()=>i,getMobileTutorialStages:()=>s});var n=()=>r(443164),o=()=>r(307542),a=()=>r(332305);function i(e,t){for(const r of n().uL){if(a().onboardingFlowNameToFlowConfig[r].shouldShowFlowToUser(e,t))return r}return n().JT}function s(e){switch((0,o().DV)({environment:e})){case"v1":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share","mobile_onboarding_multi_platform"];case"v2":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share"];case"v3":return["mobile_onboarding_skill_mab","mobile_onboarding_skill_filing","mobile_onboarding_skill_swipe"];default:return["mobile_onboarding_editor","mobile_onboarding_sidebar","mobile_onboarding_desktop","mobile_onboarding_web_clipper","mobile_onboarding_app_download"]}}},655353:(e,t,r)=>{r.d(t,{ut:()=>c,Mi:()=>u,y5:()=>s});r(362833),r(333225),r(494367),r(516262),r(573119),r(240480),r(950443),r(619601),r(725707),r(491955),r(500234),r(403517),r(113085);var n=()=>r(888694),o=()=>r(876096),a=()=>r(668337),i=()=>r(524070);function s(e){let t=1;return e.replace(/\[(.*?),(.*?),(.*?)\]/g,((e,r,n,o)=>{const a=encodeURIComponent(r),i=encodeURIComponent(n),s=encodeURIComponent(o),u=encodeURIComponent(",");return`[**[${t++}]**](#citation:${a}${u}${i}${u}${s})`}))}function u(e,t){const r={stepCitations:{...e.stepCitations}};for(const[n,o]of Object.entries(t.stepCitations)){if(!r.stepCitations[n]){r.stepCitations[n]={claims:[...o.claims],artifacts:[...o.artifacts]};continue}const e=new Set(r.stepCitations[n].claims.map((e=>e.id)));for(const a of o.claims)e.has(a.id)||r.stepCitations[n].claims.push(a);const t=new Set(r.stepCitations[n].artifacts.map((e=>e.id)));for(const a of o.artifacts)t.has(a.id)||r.stepCitations[n].artifacts.push(a)}return r}const l={"slack-result":"slack","google-drive-result":"google-drive","helpdoc-result":"helpdoc","github-result":"github","webpage-result":"webpage","jira-result":"jira","microsoft-teams-result":"microsoftTeams","sharepoint-result":"sharepoint"};function c(e,t){const r=[],s=(0,n().BD)(e.value,!1,{parseNoneClosedTags:!0})[0];if("element"!==s.type)return r;for(const n of s.children){if("element"!==n.type)continue;let e;const s=t.mapCounterToKey((0,a().VB)(n.attributes.id));if("element"!==n.type||"page"!==n.tagName&&"block"!==n.tagName){if("element"===n.type&&("slack-result"===n.tagName||"github-result"===n.tagName||"google-drive-result"===n.tagName||"jira-result"===n.tagName||"sharepoint-result"===n.tagName||"microsoft-teams-result"===n.tagName||"webpage"===n.tagName||"helpdoc"===n.tagName)){var u;const t=o().tD.parseAssistantHref(s.key),r="text"===(null===(u=n.children[0])||void 0===u?void 0:u.type)?n.children[0].value:"",a="slack-result"===n.tagName||"microsoft-teams-result"===n.tagName?n.attributes.channel:n.attributes.title;e={citationType:"universal_search",target:l[n.tagName],href:s.key,title:a,text:r,number:Number(n.attributes.id),...t}}}else{const r=t.mapCounterToKey((0,a().VB)(null==n?void 0:n.attributes.id));e={citationType:"notion",pageId:r.key,blockId:"block"===n.tagName?s.key:r.key,number:Number(n.attributes.id)}}r.push({id:n.attributes.id,artifactType:"text",content:(0,i()._o)(n),citationInfo:e})}return r}},668337:(e,t,r)=>{r.d(t,{BP:()=>u,BZ:()=>D,Bt:()=>l,F6:()=>c,Fu:()=>P,GU:()=>m,HV:()=>Q,L7:()=>E,MQ:()=>K,P8:()=>s,RD:()=>x,RI:()=>b,RW:()=>B,Su:()=>O,Tj:()=>A,U4:()=>h,VB:()=>M,Ve:()=>W,Y1:()=>L,_S:()=>d,aL:()=>H,ew:()=>q,g5:()=>Y,gc:()=>z,h5:()=>j,oK:()=>$,qI:()=>p,sA:()=>S,sW:()=>C,sk:()=>w,w3:()=>V,wn:()=>U,ye:()=>R,z5:()=>F});r(403517);var n=r.n(r(938762)),o=()=>r(3311),a=()=>r(76394),i=()=>r(214144);(0,a().u0)((e=>"element"===e.type?{true:e}:{false:e}));const s={default:"default",gray:"gray",brown:"brown",orange:"orange",yellow:"yellow",teal:"green",blue:"blue",purple:"purple",pink:"pink",red:"red",default_background:"default-background",gray_background:"gray-background",brown_background:"brown-background",orange_background:"orange-background",yellow_background:"yellow-background",teal_background:"green-background",blue_background:"blue-background",purple_background:"purple-background",pink_background:"pink-background",red_background:"red-background"},u=Object.fromEntries(Object.entries(s).map((e=>{let[t,r]=e;return[r,t]}))),l=Object.values(s),c=["mention-page","mention-database","mention-person","mention-assistant","mention-date","mention-datetime","mention-date-range","mention-datetime-range","mention-link"],p=["b","i","code","s","u","a","h","e",...c],d={b:{attributes:{},inline:p,text:!0,isToken:!1},i:{attributes:{},inline:p,text:!0,isToken:!1},code:{attributes:{},inline:p,text:!0,isToken:!1},s:{attributes:{},inline:p,text:!0,isToken:!1},u:{attributes:{},inline:p,text:!0,isToken:!1},a:{attributes:{href:{required:!0,values:!0,description:"link URL. Do not link to any URLs that are not already in the current context.",mappingMode:"href_counter"},type:{required:!1,values:r(30958).PI,description:"universal source type"},"external-id":{required:!1,values:!0,description:"ID for loadable external resource",mappingMode:"external_id_counter"}},inline:p,text:!0,isToken:!1},h:{attributes:{color:{required:!0,values:l,description:"text color"}},inline:p,text:!0,isToken:!1},e:{attributes:{equation:{required:!0,values:!0,description:"LaTeX equation string"}},inline:[],text:!0,isToken:!0},"mention-page":{attributes:{"page-id":{required:!0,values:!0,description:"ID of page",mappingMode:"block_counter"}},inline:[],text:!0,isToken:!0},"mention-link":{attributes:{href:{required:!0,values:!0,description:"link URL. Do not link to any URLs that are not already in the current context."},title:{required:!1,values:!0,description:"Linked page title"},icon_url:{required:!1,values:!0,description:"Favicon. Do not edit this field."},description:{required:!1,values:!0,description:"Linked page description. Do not edit this field."}},inline:[],text:!0,isToken:!0},"mention-database":{attributes:{"database-id":{required:!0,values:!0,description:"ID of database",mappingMode:"collection_counter"}},inline:[],text:!0,isToken:!0},"mention-person":{attributes:{"person-id":{required:!0,values:!0,description:"ID of person",mappingMode:"person_counter"},"person-name":{required:!1,values:!0,description:"Name of person"}},inline:[],text:!0,isToken:!0},"find-person":{attributes:{name:{required:!0,values:!0,description:"Name of person"}},inline:[],text:!0,isToken:!0},"mention-assistant":{attributes:{},inline:[],text:!0,isToken:!0},"mention-date":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"},time:{required:!0,values:!0,description:"Time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},"mention-date-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"},"start-time":{required:!0,values:!0,description:"Start time in ISO 8601 (HH:MM) format"},"end-time":{required:!0,values:!0,description:"End time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},option:{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:[],text:!1,isToken:!1},"schema-option":{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"schema-option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:["schema-option"],text:!1,isToken:!1}},m={"property-title":{text:!0,inline:c,attributes:{}},"property-text":{text:!0,inline:p,attributes:{}},"property-url":{text:!0,inline:[],attributes:{}},"property-email":{text:!0,inline:[],attributes:{}},"property-phone-number":{text:!0,inline:[],attributes:{}},"property-person":{text:!1,inline:["mention-person","find-person"],attributes:{}},"property-date":{text:!1,inline:["mention-date","mention-date-range","mention-datetime","mention-datetime-range"],attributes:{}},"property-created-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-last-edited-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-created-by":{text:!1,inline:["mention-person"],attributes:{}},"property-last-edited-by":{text:!1,inline:["mention-person"],attributes:{}},"property-checkbox":{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}},"property-select":{text:!1,inline:["option"],attributes:{}},"property-multi-select":{text:!1,inline:["option"],attributes:{}},"property-relation":{text:!1,inline:["mention-page"],attributes:{"database-id":{values:!0,description:"The database ID the relation points to",required:!1,mappingMode:"collection_counter"}}},"property-status":{text:!1,inline:["option"],attributes:{}},"property-number":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!1}}}},g=(0,a().uv)(m),h={"schema-property-title":{propertyTagName:"property-title",inline:[],attributes:{}},"schema-property-text":{propertyTagName:"property-text",inline:[],attributes:{}},"schema-property-url":{propertyTagName:"property-url",inline:[],attributes:{}},"schema-property-email":{propertyTagName:"property-email",inline:[],attributes:{}},"schema-property-phone-number":{propertyTagName:"property-phone-number",inline:[],attributes:{}},"schema-property-person":{propertyTagName:"property-person",inline:[],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0}}},"schema-property-date":{propertyTagName:"property-date",inline:[],attributes:{}},"schema-property-created-time":{propertyTagName:"property-created-time",inline:[],attributes:{}},"schema-property-last-edited-time":{propertyTagName:"property-last-edited-time",inline:[],attributes:{}},"schema-property-created-by":{propertyTagName:"property-created-by",inline:[],attributes:{}},"schema-property-last-edited-by":{propertyTagName:"property-last-edited-by",inline:[],attributes:{}},"schema-property-checkbox":{propertyTagName:"property-checkbox",inline:[],attributes:{}},"schema-property-select":{propertyTagName:"property-select",inline:["schema-option"],attributes:{}},"schema-property-multi-select":{propertyTagName:"property-multi-select",inline:["schema-option"],attributes:{}},"schema-property-relation":{propertyTagName:"property-relation",inline:["mention-page"],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0},"database-id":{values:!0,description:"The database ID the relation points to",required:!0,mappingMode:"collection_counter"},"synced-property-name":{required:!1,values:!0,description:"The symmetric relation property name in the database this relation points to"}}},"schema-property-status":{propertyTagName:"property-status",inline:["schema-option-category"],attributes:{}},"schema-property-number":{propertyTagName:"property-number",inline:[],attributes:{format:{values:!0,description:"Number format",required:!1}}}},f={is:{text:!1,inline:["mention-date"],attributes:{}},">":{text:!1,inline:["mention-date"],attributes:{}},"<":{text:!1,inline:["mention-date"],attributes:{}},"≥":{text:!1,inline:["mention-date"],attributes:{}},"≤":{text:!1,inline:["mention-date"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},b={"property-title":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-text":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-url":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-email":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-phone-number":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-person":{contains:{text:!1,inline:["mention-person","find-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-date":f,"property-created-time":f,"property-last-edited-time":f,"property-created-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-last-edited-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-checkbox":{is:{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}}},"property-select":{is:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-multi-select":{contains:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-relation":{contains:{text:!1,inline:["mention-page"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-status":{is:{text:!1,inline:["option","option-category"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-number":{is:{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},">":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"<":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"≥":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"≤":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"is empty":{text:!1,inline:[],attributes:{}}}},y=["Count all"],v=["Count values","Count unique values","Count empty","Count not empty","Percent empty","Percent not empty","Show unique values"],w={"Count all":"count","Count values":"count_values","Count unique values":"unique","Count empty":"empty","Count not empty":"not_empty","Percent empty":"percent_empty","Percent not empty":"percent_not_empty","Show unique values":"show_unique","Count checked":"checked","Count unchecked":"unchecked","Percent checked":"percent_checked","Percent unchecked":"percent_unchecked","Count per group":"count_per_group","Percent per group":"percent_per_group",Sum:"sum",Average:"average",Median:"median",Min:"min",Max:"max",Range:"range","Earliest date":"earliest_date","Latest date":"latest_date","Date range":"date_range"},_={basic:[...y,...v],date:[...y,...v,"Earliest date","Latest date","Date range"],status:[...y,...v,"Count per group","Percent per group"],number:[...y,...v,"Sum","Average","Median","Min","Max","Range"],checkbox:[...y,"Count checked","Count unchecked","Percent checked","Percent unchecked"]};function T(e){return`the name of the ${e} property being aggregated`}function k(e){return`the method of aggregation for the ${e} property`}const x={"aggregation-property-title":{attributes:{name:{required:!0,values:!0,description:T("title")},aggregation:{values:_.basic,required:!0,description:k("title")}}},"aggregation-property-text":{attributes:{name:{required:!0,values:!0,description:T("text")},aggregation:{values:_.basic,required:!0,description:k("text")}}},"aggregation-property-url":{attributes:{name:{required:!0,values:!0,description:T("url")},aggregation:{values:_.basic,required:!0,description:k("url")}}},"aggregation-property-email":{attributes:{name:{required:!0,values:!0,description:T("email")},aggregation:{values:_.basic,required:!0,description:k("email")}}},"aggregation-property-phone-number":{attributes:{name:{required:!0,values:!0,description:T("phone_number")},aggregation:{values:_.basic,required:!0,description:k("phone_number")}}},"aggregation-property-date":{attributes:{name:{values:!0,required:!0,description:T("date")},aggregation:{values:_.date,required:!0,description:k("date")}}},"aggregation-property-created-time":{attributes:{name:{values:!0,required:!0,description:T("created-time")},aggregation:{values:_.date,required:!0,description:k("created-time")}}},"aggregation-property-last-edited-time":{attributes:{name:{values:!0,required:!0,description:T("last-edited-time")},aggregation:{values:_.date,required:!0,description:k("last-edited-time")}}},"aggregation-property-person":{attributes:{name:{values:!0,required:!0,description:T("person")},aggregation:{values:_.basic,required:!0,description:k("person")}}},"aggregation-property-created-by":{attributes:{name:{values:!0,required:!0,description:T("created-by")},aggregation:{values:_.basic,required:!0,description:k("created-by")}}},"aggregation-property-last-edited-by":{attributes:{name:{values:!0,required:!0,description:T("last-edited-by")},aggregation:{values:_.basic,required:!0,description:k("last-edited-by")}}},"aggregation-property-checkbox":{attributes:{name:{values:!0,required:!0,description:T("checkbox")},aggregation:{values:_.checkbox,required:!0,description:k("checkbox")}}},"aggregation-property-select":{attributes:{name:{values:!0,required:!0,description:T("select")},aggregation:{values:_.basic,required:!0,description:k("select")}}},"aggregation-property-multi-select":{attributes:{name:{values:!0,required:!0,description:T("multi-select")},aggregation:{values:_.basic,required:!0,description:k("multi-select")}}},"aggregation-property-relation":{attributes:{name:{values:!0,required:!0,description:T("relation")},aggregation:{values:_.basic,required:!0,description:k("relation")}}},"aggregation-property-number":{attributes:{name:{values:!0,required:!0,description:T("number")},aggregation:{values:_.number,required:!0,description:k("number")}}},"aggregation-property-status":{attributes:{name:{values:!0,required:!0,description:T("status")},aggregation:{values:_.status,required:!0,description:k("status")},group:{values:!0,required:!0,description:"then name of the status group being aggregated when aggregation is 'Count per group' or 'Percent per group'. For other aggregations, just provide any group name."}}}},N=["hr","h1","h2","h3","database","math-block","code-block","child-page","link-page","child-database","link-database","database-views","text","page","synced-block","synced-block-reference","uli","oli","toggle","quote","callout","todo","columns","table","unknown-block"],I={required:!1,values:l,description:"color for the block"},S={hr:{title:!1,content:[],attributes:{},properties:[],schemas:[]},h1:{title:!0,content:[],attributes:{color:I},properties:[],schemas:[]},h2:{title:!0,content:[],attributes:{color:I},properties:[],schemas:[]},h3:{title:!0,content:[],attributes:{color:I},properties:[],schemas:[]},database:{title:!1,content:[],attributes:{},properties:["property-title"],schemas:g},"math-block":{title:!0,content:[],attributes:{},properties:[],schemas:[]},"code-block":{title:!0,content:[],attributes:{language:{required:!1,values:r(656491).yz,description:"language of code"}},properties:[],schemas:[]},"child-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load>",mappingMode:"block_counter"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one",mappingMode:"collection_counter"},"has-content":{required:!1,values:["true","false"],description:'"true" if the page has content, "false" otherwise'}},properties:g,schemas:[]},"link-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load>",mappingMode:"block_counter"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one",mappingMode:"collection_counter"}},properties:g,schemas:[]},"child-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database. Make sure to use the value of this attribute as the id in query-database.",mappingMode:"block_counter"}},properties:["property-title"],schemas:g},"database-views":{title:!1,content:[],attributes:{},properties:["property-title"],schemas:g},"link-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database",mappingMode:"collection_counter"}},properties:["property-title"],schemas:g},text:{title:!0,content:N,attributes:{color:I},properties:[],schemas:[]},page:{title:!1,content:N,attributes:{"database-id":{required:!1,values:!0,description:"ID of the database this page belongs to. Use this to look up the schema for the page",mappingMode:"collection_counter"},"page-font":{required:!1,values:["default","serif","mono"],description:"Font used for the page"},"page-width":{required:!1,values:["default","full-width"],description:"Width of the page"},"page-font-size":{required:!1,values:["default","small"],description:"Font size for the page"}},properties:g,schemas:[]},uli:{title:!0,content:N,attributes:{color:I},properties:[],schemas:[]},oli:{title:!0,content:N,attributes:{color:I,index:{required:!1,values:!0,description:"Specify a custom index for the list item"}},properties:[],schemas:[]},toggle:{title:!0,content:N,attributes:{color:I,size:{required:!1,values:["h1","h2","h3"],description:"size of the toggle header, if the toggle is a header"}},properties:[],schemas:[]},quote:{title:!0,content:N,attributes:{color:I},properties:[],schemas:[]},todo:{title:!0,content:N,attributes:{checked:{required:!0,values:["true","false"],description:'checked state, either "true" or "false"'},color:I},properties:[],schemas:[]},callout:{title:!0,content:N,attributes:{color:I},properties:[],schemas:[]},"synced-block":{title:!1,content:N,attributes:{},properties:[],schemas:[]},"synced-block-reference":{title:!1,content:N,attributes:{"synced-block-id":{required:!0,values:!0,description:"The ID of the <synced-block> node that this references",mappingMode:"block_counter"}},properties:[],schemas:[]},columns:{title:!1,content:["column"],attributes:{},properties:[],schemas:[]},column:{title:!1,content:N,attributes:{},properties:[],schemas:[]},table:{title:!1,content:["tr"],attributes:{"header-row":{required:!1,values:["true","false"],description:'whether first <tr> is row header, either "true" or "false"'},"header-column":{required:!1,values:["true","false"],description:'whether first <td> in every <tr> is column header, either "true" or "false"'}},properties:[],schemas:["property-text"]},tr:{title:!1,content:[],attributes:{},properties:["property-text"],schemas:[]},"ai-block":{title:!0,content:N,attributes:{},properties:["property-text"],schemas:[]},transcript:{title:!0,content:N,attributes:{},properties:[],schemas:[]},"unknown-block":{title:!0,content:N,attributes:{type:{required:!1,values:Object.values(r(762847).xd),description:"the type of the unknown block"}},properties:[],schemas:[]}},C=Object.freeze((0,a().uv)({text:!0,toggle:!0,quote:!0,callout:!0,uli:!0,oli:!0,todo:!0,h1:!0,h2:!0,h3:!0}));function q(e){return e}function U(e){return e}function M(e){return e}function F(e){return e}function O(e){return e}function K(e){return e}function D(e){return e}function P(e){return e}function A(e){return e}function $(e){return e}function R(e){return e}function E(e){return e}function j(e){return e}function V(e){return e}function B(e){return e}function W(e){return e}function L(){return i().JW()}function H(e){return(0,o().gB)(n()(e))}const z=(0,a().u0)((e=>"collectionView"===e.type?{true:e}:{false:e})),Q="search-notion-help",Y=(0,a().u0)((e=>"synced-block-reference"===e||"ai-block"===e||"database-views"===e||"transcript"===e?{true:e}:{false:e}))},760068:(e,t,r)=>{r.d(t,{RB:()=>y,U5:()=>c,W6:()=>p,ke:()=>g,nx:()=>f,t7:()=>h,x3:()=>b});r(610931),r(358848),r(362833),r(725707),r(491955),r(500234),r(403517);var n=()=>r(975392),o=()=>r(204132),a=()=>r(76394),i=()=>r(481325),s=()=>r(297083),u=()=>r(876096);const l=i().p.satisfy((0,a().u0)((e=>"element"===e.type?{true:e}:{false:e})));function c(e){return i().p.describe(i().p.filter(l,(t=>t.tagName===e)),(()=>new(s().gJ)(e)))}const p=i().p.satisfy((0,a().u0)((e=>"text"===e.type?{true:e}:{false:e}))),d=i().p.satisfy((e=>"text"===e.type&&""===e.value.trim()));function m(e){const{prefixMappingMode:t,baseHref:r}=e;return"query_database_result_counter"===t?`query_database_result_counter:/${u().tD.blockIdToHref(r)}`:"href_counter"===t?r:void(0,a().HB)(t)}function g(e){const{inputAttributes:t={},definitions:r,tagName:i,validateRequiredAttributes:l=!0,mapCounterToKey:c}=e,p=Object.keys(t),d=Object.keys(r),g=n().R9(p,d);if(g.length>0)return{error:new(s().LN)({attributeNames:g,tagName:i})};if(l)for(const[n,o]of Object.entries(r))if(o.required&&!p.includes(n))return{error:new(s().HQ)({attributeName:n,tagName:i})};const h=n().o8(t);for(const[n,f]of Object.entries(t)){const e=r[n];if((0,a().O9)(e.mappingMode)){if("href_counter"!==e.mappingMode&&!(0,u().D4)(f))return{error:new(s().qW)(n,f)};if((0,a().O9)(c)&&"href_counter"===e.mappingMode){let e;const t=["href_counter","query_database_result_counter"];for(const r of t)if(e=u().tD.mapCounterToKeyInMode({mapCounterToKey:c},f,r,i),o().Q.isSuccess(e)){h[n]=m({prefixMappingMode:r,baseHref:e.value});break}if(o().Q.isFail(e))return{error:new(s().wL)("unmapped_id",e.error.message,e.error)}}else if((0,a().O9)(c)){const t=u().tD.mapCounterToKeyInMode({mapCounterToKey:c},f,e.mappingMode,i);if(o().Q.isFail(t))return{error:new(s().wL)("unmapped_id",t.error.message,t.error)};h[n]=t.value}}if(!0!==e.values&&!e.values.includes(f))return{error:new(s().GW)({attributeName:n,receivedValue:f,tagName:i})}}return{value:h}}function h(e,t){if(0===e.length)throw new Error("Must provide at least 1 label and type guard");const r=[...e],n=[[]];for(const a of t){const[t,i]=r[0];if(!i(a)){for(;r.length>0;){r.shift();const e=r[0];if(n.push([]),e&&e[1](a))break}if(0===r.length){var o;const r=null===(o=e.find((e=>{let[,t]=e;return t(a)})))||void 0===o?void 0:o[0];if(!r)throw new Error(`Item did not match any type guards: ${JSON.stringify(a)}`);return{error:{incorrectLabel:r,lastLabel:t}}}}n.at(-1).push(a)}for(;n.length<e.length;)n.push([]);return{value:n}}function f(e,t,r){const{allowUnmatchedText:o=!1}=r??{},a=i().p.manyTill(i().p.choice([...t,...o?[i().p.map(d,(e=>{}))]:[],i().p.fail((t=>new(s().RR)({tagName:e,unexpectedNode:n().$1(t)})))]),i().p.eof());return i().p.map(a,(e=>n().oE(e)))}function b(e){return e.children&&e.children.length>0?{error:new(s().RR)({tagName:e.tagName,unexpectedNode:e.children[0]})}:{value:void 0}}function y(e){const{tagName:t,attributeDefinitions:r,mapCounterToKey:n}=e;return i().p.mapResult(c(t),(e=>{const a=g({tagName:t,inputAttributes:e.attributes,definitions:r,mapCounterToKey:n});if(o().Q.isFail(a))return a;const i=b(e);return o().Q.isFail(i)?i:{value:{attributes:a.value}}}))}},876096:(e,t,r)=>{r.d(t,{D4:()=>d,L1:()=>m,OU:()=>g,V6:()=>h,tD:()=>f});r(610931),r(362833),r(403517),r(875472),r(76509),r(863754);var n=r.n(r(938762)),o=()=>r(975392),a=()=>r(204132),i=()=>r(76394),s=()=>r(809811),u=()=>r(297083),l=()=>r(668337);function c(e){if(!(32===e.length&&/^[a-f0-9]*$/g.test(e)))return;return[e.substring(0,8),e.substring(8,12),e.substring(12,16),e.substring(16,20),e.substring(20,32)].join("-")}const p=/^\d+$/,d=(0,i().u0)((e=>p.test(e)?{true:e}:{false:e}));function m(e){try{const t=new URL(e),r=t.searchParams.get("domain")||void 0,n=t.searchParams.get("base_url")||void 0,o=t.searchParams.get("channel_id"),a=t.searchParams.get("message_id"),i=t.searchParams.get("thread_ts")||void 0;if(!r&&!n||!o||!a)return;return{domain:r,baseUrl:n,channelId:o,messageId:a,threadTs:i}}catch(t){return}}function g(e){try{const t=new URL(e).searchParams.get("url");if(!t)return;return{url:t}}catch(t){return}}class h extends Error{constructor(e){super(`Tried to use an ID that doesn't exist: ${e}`)}}class f{generateSerializedKey(e){return n()(e)}constructor(e){if(this.counter=0,this.keyToCounterMap=new Map,this.counterToKeyMap=new Map,this.mapCounterToKeyInModeOrThrow=(e,t,r)=>a().Q.unwrap(this.mapCounterToKeyInMode(e,t,r)),this.mapCounterToKeyInMode=(e,t,r)=>f.mapCounterToKeyInMode(this,e,t,r),this.utilitiesForTests={removeKey:this.removeKey.bind(this),setCounterValueForKey:this.setCounterValueForKey.bind(this)},e){const t=[];for(const{key:n,counter:o}of e.keyMap)this.keyToCounterMap.set(this.generateSerializedKey(n),o),this.counterToKeyMap.set(o,n),t.push(parseInt(o));const r=o().T9(t);this.counter="number"==typeof r?r+1:0}}serialize(){return{keyMap:Array.from(this.counterToKeyMap.entries()).map((e=>{let[t,r]=e;return{key:o().mg(r),counter:t}}))}}inheritFrom(e){for(const[t,r]of e.keyToCounterMap.entries())this.keyToCounterMap.set(t,r);for(const[t,r]of e.counterToKeyMap.entries())this.counterToKeyMap.set(t,r)}mapKeyToCounter(e){const t=this.generateSerializedKey(e);if(!this.keyToCounterMap.has(t)){const r=this.counter.toString();this.keyToCounterMap.set(t,r),this.counterToKeyMap.set(r,e),this.counter++}return this.keyToCounterMap.get(t)}mapNodeKeyToCounter(e){if("block"===e.type){const t={...e},r=this.mapNodeAttributesKeyToCounter(e.attributes);t.attributes=r;const n=e.text.map((e=>this.mapNodeKeyToCounter(e)));t.text=n;const o=e.children.map((e=>{const r=this.mapNodeKeyToCounter(e);return r.parent=t,r}));t.children=o;const a={};for(const[e,u]of Object.entries(t.properties))a[e]=this.mapNodeKeyToCounter(u);t.properties=a;const i={};for(const[e,u]of Object.entries(t.schemas))i[e]=this.mapNodeKeyToCounter(u);t.schemas=i;const s=this.mapKeyToCounter({key:e.schemaId,type:"block"});return t.schemaId=s,t}if("property"===e.type||"schema"===e.type||"inline"===e.type){const t={...e};return t.attributes=this.mapNodeAttributesKeyToCounter(t.attributes),t.children=t.children.map((e=>this.mapNodeKeyToCounter(e))),t}if("instructions"===e.type){const t={...e};return t.children=t.children.map((e=>this.mapNodeKeyToCounter(e))),t}if("text"===e.type)return{...e};if("collection"===e.type){const t={...e,schemaId:this.mapKeyToCounter({type:"block",key:e.schemaId}),attributes:{...e.attributes,id:this.mapKeyToCounter({type:"collection",key:e.attributes.id})}},r=Object.fromEntries(Object.entries(t.properties).map((e=>{let[t,r]=e;return[t,this.mapNodeKeyToCounter(r)]})));t.properties=r;const n=Object.fromEntries(Object.entries(t.schemas).map((e=>{let[t,r]=e;return[t,this.mapNodeKeyToCounter(r)]})));return t.schemas=n,t}if("collectionView"===e.type)return{...e,schemaId:this.mapKeyToCounter({type:"block",key:e.schemaId}),attributes:{...e.attributes,id:this.mapKeyToCounter({type:"collection-view",key:e.attributes.id}),"database-id":this.mapKeyToCounter({type:"collection",key:e.attributes["database-id"]})}};if("slackMessages"===e.type){return{...e,attributes:{...e.attributes,id:this.mapKeyToCounter({type:"universal",key:e.attributes.id})}}}if("attachment"===e.type){return{...e,attributes:{...e.attributes,id:this.mapKeyToCounter({type:"attachment",key:e.attributes.id,attachmentType:e.attributes.attachmentType})}}}throw new Error(`Unknown node type ${e}`)}mapNodeAttributesKeyToCounter(e){if(!e)return e;const t={...e};for(const[n,o]of Object.entries(f.attributesToMap)){if(!o)continue;const e=t[n];if(e)if("href"===n){let o;const a=s().qg(e),i=s().Jf({str:a.href,allowNoProtocol:!0});i&&(o=(0,r(7356).lX)({url:i,baseUrl:a.protocol?`${a.protocol}//${a.host}`:`https://${a.host??"www.notion.so"}`,publicDomainName:a.host??"www.notion.so"})),t[n]=o?this.mapKeyToCounter({type:"block",key:o}):e}else t[n]="person-id"===n?this.mapKeyToCounter({type:"person",key:e}):"database-id"===n?this.mapKeyToCounter({type:"collection",key:e}):this.mapKeyToCounter({type:"block",key:e})}return t}doesIdMapperContainMappedKey(e){return this.counterToKeyMap.has(e)}doesIdMapperContainKey(e){return this.keyToCounterMap.has(this.generateSerializedKey(e))}getIdForMappedKeyIfExists(e){const t=this.counterToKeyMap.get(e);return null==t?void 0:t.key}mapCounterToKey(e){const t=this.counterToKeyMap.get(e);if(!t)throw new h(e);return t}mapAssistantContextCounterToKey(e){const{"instructions-page-id":t,"current-page-id":r,"current-person-id":n,"current-background-page-id":o,...a}=e;return{...a,...e["instructions-page-id"]?{"instructions-page-id":this.mapCounterToKeyInModeOrThrow(e["instructions-page-id"],"block_counter")}:{},...e["current-page-id"]?{"current-page-id":this.mapCounterToKeyInModeOrThrow(e["current-page-id"],"block_counter")}:{},...e["current-background-page-id"]?{"current-background-page-id":this.mapCounterToKeyInModeOrThrow(e["current-background-page-id"],"block_counter")}:{},...e["current-thread-id"]?{"current-thread-id":this.mapCounterToKeyInModeOrThrow(e["current-thread-id"],"thread_counter")}:{},...e["current-person-id"]?{"current-person-id":this.mapCounterToKeyInModeOrThrow(e["current-person-id"],"person_counter")}:{}}}mapAssistantContextKeyToCounter(e){const{"instructions-page-id":t,"current-page-id":r,"current-person-id":n,"current-background-page-id":o,...a}=e;return{...a,...e["instructions-page-id"]?{"instructions-page-id":this.mapKeyToCounter({type:"block",key:e["instructions-page-id"]})}:{},...e["current-page-id"]?{"current-page-id":this.mapKeyToCounter({type:"block",key:e["current-page-id"]})}:{},...e["current-background-page-id"]?{"current-background-page-id":this.mapKeyToCounter({type:"block",key:e["current-background-page-id"]})}:{},...e["current-thread-id"]?{"current-thread-id":this.mapKeyToCounter({type:"slack-thread",key:e["current-thread-id"]})}:{},...e["current-person-id"]?{"current-person-id":this.mapKeyToCounter({type:"person",key:e["current-person-id"]})}:{}}}mapAssistantSelectionKeyToCounter(e){return"block"===e.type?{type:"block",blockIds:e.blockIds.map((e=>this.mapKeyToCounter({type:"block",key:e})))}:"text"===e.type?{type:"text",start:{...e.start,blockId:this.mapKeyToCounter({type:"block",key:e.start.blockId})},end:{...e.end,blockId:this.mapKeyToCounter({type:"block",key:e.end.blockId})}}:void(0,i().HB)(e)}static mapCounterToKeyInMode(e,t,r,n){if("block_counter"===r||"person_counter"===r||"thread_counter"===r||"collection_counter"===r||"collection_view_counter"===r||"query_database_result_counter"===r||"external_id_counter"===r||"attachment_id_counter"===r){const o=(0,a().j)((()=>e.mapCounterToKey(t)));if(a().Q.isFail(o))return o;const s=o.value;let l;return"block_counter"===r?l="block":"person_counter"===r?l="person":"thread_counter"===r?l="slack-thread":"collection_counter"===r?l="collection":"collection_view_counter"===r?l="collection-view":"query_database_result_counter"===r?l="query-database-result":"external_id_counter"===r?l="universal":"attachment_id_counter"===r?l="attachment":(0,i().HB)(r),s.type!==l?{error:new(u().xU)({receivedIdType:s.type,expectedIdType:l,tagNameForErrorMessage:n,idValueForErrorMessage:t})}:{value:s.key}}if("href_counter"===r){const r=f.getMappedTypeFromCounterIfExists(t,e);return"query-database-result"===r?{error:new(u().xU)({receivedIdType:r,expectedIdType:"href",tagNameForErrorMessage:n,idValueForErrorMessage:t})}:{value:f.mapHrefCounterToUrl(e,t)}}(0,i().HB)(r)}getTypeKeyFromCounter(e){return f.getMappedTypeFromCounterIfExists(e,this)}static getMappedTypeFromCounterIfExists(e,t){let r;try{r=t.mapCounterToKey(e)}catch(n){if(n instanceof h)return;throw n}return r.type}static blockKeyToHref(e){return`/${e.key.split("/")[0].replaceAll("-","")}`}static blockIdToHref(e){return`/${e.split("/")[0].replaceAll("-","")}`}static parseAssistantHref(e){if(e===f.EMPTY_HREF)return{type:"citation_unsupported"};if(function(e){return e.startsWith("query_database_result_counter://")}(e)){const t=f.databaseQueryHrefToDatabaseQueryResultsId(e);if(t)return{type:"database_query_results",id:t}}else if(function(e){return e.startsWith("slack://")}(e)){const t=m(e);if(t)return{type:"slack",href:(0,l().Su)(e),...t}}else if(function(e){return e.startsWith("google-drive://")}(e)){const t=g(e);if(t)return{type:"google-drive",href:(0,l().Fu)(e),...t}}else if(function(e){return e.startsWith("sharepoint://")}(e)){const t=g(e);if(t)return{type:"sharepoint",href:(0,l().L7)(e),...t}}else if(function(e){return e.startsWith("webpage://")}(e)){const t=g(e);if(t)return{type:"webpage",href:(0,l().RW)(e),...t}}else if(function(e){return e.startsWith("helpdoc://")&&!e.includes("%23")}(e)){const t=g(e);if(t)return{type:"helpdoc",href:(0,l().h5)(e),...t}}else if(function(e){return e.startsWith("helpdoc://")&&e.includes("%23")}(e)){const t=g(e);if(t){const r=(0,l().h5)(e.split("%23")[0]);return{type:"helpdoc-section",href:(0,l().w3)(e),parentPageHref:r,...t}}}else if(function(e){return e.startsWith("github://")}(e)){const t=g(e);if(t)return{type:"github",href:(0,l().Tj)(e),...t}}else if(function(e){return e.startsWith("gmail://")}(e)){const t=g(e);if(t)return{type:"gmail",href:(0,l().oK)(e),...t}}else if(function(e){return e.startsWith("jira://")}(e)){const t=g(e);if(t)return{type:"jira",href:(0,l().MQ)(e),...t}}else if(function(e){return e.startsWith("microsoftTeams://")}(e)){const t=function(e){try{const t=new URL(e).searchParams,r=t.get("url"),n=t.get("message_type"),o=t.get("message_id"),a=t.get("channel_id"),i=t.get("thread_ts")||void 0;if(!(r&&a&&o&&n))return;return{url:r,channelId:a,threadTs:i,messageId:o,messageType:n}}catch(t){return}}(e);if(t)return{type:"microsoftTeams",href:(0,l().ye)(e),...t}}else if(function(e){return e.startsWith("linear://")}(e)){const t=g(e);if(t)return{type:"linear",href:(0,l().BZ)(e),...t}}else{const t=f.blockHrefToAssistantBlockId(e);if(t)return{type:"block",blockId:t}}}static databaseQueryHrefToDatabaseQueryResultsId(e){var t;const r=null===(t=e.match(/^query_database_result_counter:\/\/(.+)$/))||void 0===t?void 0:t[1];return r&&c(r)}static blockHrefToAssistantBlockId(e){var t;const r=null===(t=e.match(/\/(.+)/))||void 0===t?void 0:t[1];return r?c(r):void 0}static mapHrefCounterToUrl(e,t){let r;try{r=e.mapCounterToKey(t)}catch(n){if(n instanceof h)return t;throw n}if("block"===r.type)return f.blockKeyToHref(r);if("url"===r.type||"slack-message"===r.type||"slack-thread"===r.type||"webpage"===r.type||"gmail"===r.type||"helpdoc"===r.type||"helpdoc-section"===r.type||"google-drive"===r.type||"github"===r.type||"microsoft-teams-message"===r.type||"microsoft-teams-thread"===r.type||"sharepoint"===r.type||"jira"===r.type||"linear"===r.type)return r.key;if("collection"===r.type||"collection-view"===r.type||"person"===r.type)return f.EMPTY_HREF;if("query-database-result"===r.type||"skill"===r.type)throw new Error(`Invalid URL type: ${r.type}`);return"universal"===r.type||"attachment"===r.type?r.key:void(0,i().HB)(r)}removeKey(e){const t=this.generateSerializedKey(e),r=this.keyToCounterMap.get(t);if(r)return this.keyToCounterMap.delete(t),this.counterToKeyMap.delete(r),r}setCounterValueForKey(e,t){const r=this.generateSerializedKey(e);this.keyToCounterMap.set(r,t),this.counterToKeyMap.set(t,e)}}f.attributesToMap={id:!0,"page-id":!0,"database-id":!0,"person-id":!0,"person-name":!1,href:!0,category:!1,option:!1,format:!1,number:!1,date:!1,time:!1,"start-date":!1,"start-time":!1,"end-date":!1,"end-time":!1,"synced-property-name":!1,"synced-block-id":!0,"external-id":!0,index:!1,title:!1,icon_url:!1,description:!1,name:!1,equation:!1},f.EMPTY_HREF="#"},888694:(e,t,r)=>{r.d(t,{BD:()=>a});r(403517);var n=()=>r(664091),o=(n(),()=>r(975392));function a(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return(0,n().parse)(e,r).childNodes.map((e=>i(e,t)))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.nodeType===n().NodeType.TEXT_NODE?{type:"text",value:t?o().x4(e.textContent):e.textContent}:{type:"element",tagName:e.tagName.toLowerCase(),attributes:e.attributes||{},children:e.childNodes.map((e=>i(e,t)))||[]}}},944577:(e,t,r)=>{r.d(t,{lM:()=>q,Lh:()=>U,GC:()=>I,dR:()=>N,zD:()=>x,w2:()=>S,aD:()=>M,XO:()=>T,yX:()=>k,Nm:()=>C,vZ:()=>_,Wg:()=>P,Or:()=>K,Dk:()=>D,Km:()=>O,Ut:()=>F});r(610931),r(725707),r(324989),r(403517);var n=()=>r(975392),o=()=>r(204132),a=()=>r(481325),i=()=>r(297083),s=()=>r(876096),u=()=>r(668337),l=()=>r(30958),c=()=>r(76394),p=()=>r(590856),d=()=>r(760068);function m(e,t){const r=`filter-${e}`;return a().p.mapResult((0,d().U5)(r),(n=>{var s;if(null===(s=n.attributes)||void 0===s||!s.condition)return{error:new(i().HQ)({tagName:r,attributeName:"condition"})};const l=u().RI[e],c=function(e){const{tagName:t,condition:r,allowedOperators:n}=e;if(r.includes("not ")){const e=r.replace("not ","").replace(/\s+/g," ").trim();return n.includes(e)?{value:{not:!0,operator:e}}:{error:new(i().js)({tagName:t,allowedOperators:n,inputCondition:r})}}return n.includes(r)?{value:{not:!1,operator:r}}:{error:new(i().js)({tagName:t,allowedOperators:n,inputCondition:r})}}({condition:n.attributes.condition,tagName:r,allowedOperators:Object.keys(l)});if(o().Q.isFail(c))return c;const m=l[c.value.operator],g=(0,d().ke)({inputAttributes:n.attributes,definitions:{name:{required:!0,values:!0},condition:{required:!0,values:!0},...m.attributes},tagName:r,mapCounterToKey:t.mapCounterToKey});if(o().Q.isFail(g))return g;const{name:h,condition:f,...b}=g.value,y=(0,a().$d)((0,d().nx)(r,[(0,p().Et)({inlineNodesAllowed:m.inline,textAllowed:m.text,parentTagName:r,mapCounterToKey:t.mapCounterToKey})],{allowUnmatchedText:!0}),n.children??[]);if(o().Q.isFail(y))return y.error instanceof i().RR?{error:new(i().nB)({tagName:y.error.tagName,unexpectedNode:y.error.unexpectedNode,conditionName:n.attributes.condition,cause:y.error})}:y;return{value:{propertyName:g.value.name,propertyTagName:e,children:y.value,attributes:b,operator:c.value.operator,not:c.value.not}}}))}function g(e){return a().p.choice([...(0,c().uv)(u().RI).map((t=>m(t,e))),a().p.fail((e=>new(i().yc)({nodeType:"database filter",unexpectedNode:n().$1(e)})))])}function h(e){return a().p.mapResult((0,d().U5)("filter-group"),(t=>{const r=(0,d().ke)({inputAttributes:t.attributes,definitions:{match:{required:!0,values:["any","all"]}},tagName:"filter-group",mapCounterToKey:e.mapCounterToKey});if(o().Q.isFail(r))return r;if(!t.children||0===t.children.length)return{error:new(i().Dp)({tagName:"filter-group"})};const n=(0,a().$d)((0,d().nx)("filter-group",[f(e)],{allowUnmatchedText:!0}),t.children??[]);return o().Q.isFail(n)?n:{value:{operator:r.value.match,filters:n.value}}}))}function f(e){return a().p.choice([g(e),h(e)])}const b=a().p.choice([...(0,c().uv)(u().GU).map((e=>function(e){const t=`sort-${e}`;return a().p.mapResult((0,d().U5)(t),(e=>{const r=(0,d().x3)(e);if(o().Q.isFail(r))return r;const n=(0,d().ke)({inputAttributes:e.attributes,definitions:{name:{required:!0,values:!0},direction:{required:!0,values:["ascending","descending"]}},tagName:t,mapCounterToKey:void 0});return o().Q.isFail(n)?n:{value:{propertyName:n.value.name,direction:n.value.direction}}}))}(e))),a().p.fail((e=>new(i().yc)({nodeType:"database sort",unexpectedNode:n().$1(e)})))]),y=a().p.map((0,d().RB)({tagName:"limit",attributeDefinitions:{number:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return parseInt(t.number)})),v=a().p.map((0,d().RB)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{question:t.question,keywords:t.keywords,questionIntl:t["question-intl"]}}));const w=a().p.choice([...(0,c().uv)(u().GU).map((e=>function(e){const t=`aggregation-${e}`,r=u().RD[t];return a().p.mapResult((0,d().U5)(t),(e=>{const n=(0,d().x3)(e);if(o().Q.isFail(n))return n;const a=(0,d().ke)({inputAttributes:e.attributes,definitions:r.attributes,tagName:t,mapCounterToKey:void 0});return o().Q.isFail(a)?a:{value:{tagName:t,attributes:a.value}}}))}(e))),a().p.fail((e=>new(i().yc)({nodeType:"database sort",unexpectedNode:n().$1(e)})))]);function _(e){return a().p.mapResult((0,d().U5)("query-database"),(t=>{const{id:r,...s}=t.attributes,u=r?function(e){const{id:t,mapCounterToKey:r}=e;if(!r)return{value:{key:t,type:"collection"}};const n=(0,o().j)((()=>r(t)));if(o().Q.isFail(n))return n;return"collection"===n.value.type||"collection-view"===n.value.type?{value:n.value}:{error:new Error(`Expected block or collection ID, got ${n.value.type}`)}}({id:r,mapCounterToKey:e.mapCounterToKey}):void 0;if(u&&o().Q.isFail(u))return u;if(!u)return{error:new Error('The <query-database> tag is missing a id attribute. It should be specified as <query-database id="...">')};if(Object.keys(s).length>0)return{error:new Error("<query-database> cannot have any attributes other than 'id'")};const l=(0,a().$d)((0,d().nx)("query-database",[a().p.map(f(e),(e=>({type:"filter",value:e}))),a().p.map(b,(e=>({type:"sort",value:e}))),a().p.map(v,(e=>({type:"search",value:e}))),a().p.map(w,(e=>({type:"aggregation",value:e}))),a().p.map(y,(e=>({type:"limit",value:e})))],{allowUnmatchedText:!0}),t.children??[]);if(o().Q.isFail(l))return l;const c=l.value.flatMap((e=>"filter"===e.type?[e.value]:[])),p=l.value.flatMap((e=>"sort"===e.type?[e.value]:[])),m=l.value.flatMap((e=>"search"===e.type?[e.value]:[])),g=l.value.flatMap((e=>"aggregation"===e.type?[e.value]:[])),h=l.value.flatMap((e=>"limit"===e.type?[e.value]:[]));if(m.length>1)return{error:new(i().bV)("<search>")};if(g.length>1)return{error:new(i().bV)("aggregation")};return{value:{tagName:"query-database",type:"observation",query:{databaseId:u.value.key,search:n().$1(m),aggregation:n().$1(g),filter:{operator:"all",filters:c},sorts:p,limit:n().$1(h)}}}}))}function T(e){return a().p.map((0,d().RB)({tagName:"load-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-page",attributes:t}}))}function k(e){return a().p.map((0,d().RB)({tagName:"load-slack",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-slack",attributes:t}}))}function x(e){return a().p.map((0,d().RB)({tagName:"load-google-drive",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-google-drive",attributes:t}}))}function N(e){return a().p.map((0,d().RB)({tagName:"load-github",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-github",attributes:t}}))}function I(e){return a().p.map((0,d().RB)({tagName:"load-github-code",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-github-code",attributes:t}}))}function S(e){return a().p.map((0,d().RB)({tagName:"load-jira",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-jira",attributes:t}}))}function C(e){return a().p.map((0,d().RB)({tagName:"load-web-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-web-page",attributes:t}}))}function q(e){return a().p.map((0,d().RB)({tagName:"load-attachment",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"attachment_id_counter"},attachmentType:{required:!0,values:["pdf"]}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-attachment",attributes:t}}))}function U(e){return a().p.map((0,d().RB)({tagName:"load-database",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"collection_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-database",attributes:t}}))}function M(e){return a().p.mapResult((0,d().U5)("load"),(t=>{const r=(0,d().x3)(t);if(o().Q.isFail(r))return r;const{id:n,...a}=t.attributes;if(void 0===n)return{error:new Error("<load> must have an 'id' attribute")};if(Object.keys(a).length>0)return{error:new Error("<load> cannot have any attributes other than 'id'")};const{mapCounterToKey:i}=e;if(!i)return{error:new Error("mapCounterToKey is required")};const u=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},n,"block_counter","load");if(!u.error)return{value:{type:"observation",tagName:"load-page",attributes:{id:u.value}}};const c=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},n,"collection_counter","load");if(!c.error)return{value:{type:"observation",tagName:"load-database",attributes:{id:c.value}}};const p=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},n,"external_id_counter","load");if(!p.error){const e=(0,l().Tq)(p.value);if("web"===e)return{value:{type:"observation",tagName:"load-web-page",attributes:{id:p.value}}};if("slack"===e)return{value:{type:"observation",tagName:"load-slack",attributes:{id:p.value}}};if("googleDrive"===e)return{value:{type:"observation",tagName:"load-google-drive",attributes:{id:p.value}}};if("github"===e)return{value:{type:"observation",tagName:"load-github",attributes:{id:p.value}}};if("githubCode"===e)return{value:{type:"observation",tagName:"load-github-code",attributes:{id:p.value}}};if("jira"===e)return{value:{type:"observation",tagName:"load-jira",attributes:{id:p.value}}}}return{error:new Error(`<load> with id ${n} could must be either a block or database ID.`)}}))}const F=["notion","slack","google-drive","github","jira","microsoft-teams","sharepoint","onedrive","linear","web"],O=["document","spreadsheets","presentation","pdf","message","pull-request","code","issue","task","ticket"],K=a().p.map((0,d().RB)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:O},repo:{required:!1,values:!0},[u().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search",attributes:t}})),D=(a().p.map((0,d().RB)({tagName:"search",attributeDefinitions:{question:{required:!1,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:O},repo:{required:!1,values:!0},[u().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search",attributes:t}})),a().p.map((0,d().RB)({tagName:"search-people",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search-people",attributes:t}}))),P=a().p.map((0,d().RB)({tagName:"search-databases",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search-databases",attributes:t}}))},993054:(e,t,r)=>{r.r(t),r.d(t,{closeWorkflowEditor:()=>d,onConfigItemClick:()=>c,showWorkflowEditor:()=>p});var n=()=>r(975392),o=()=>r(865226),a=()=>r(895085),i=()=>r(321185),s=()=>r(29869),u=()=>r(485966),l=()=>r(501518);function c(e){const{environment:t,navigationState:r,parentStore:o}=e,a=(0,l().getCurrentWorkflowNavigationState)(t);(0,n().n4)(a,r)?p({environment:t,navigationState:{isOpen:!0,type:"configure"},parentStore:o}):p({environment:t,navigationState:r,parentStore:o})}function p(e){const{environment:t,parentStore:r,redirect:n}=e,c=(0,l().getMergedWorkflowNavigationState)({defaultNavigationState:(0,l().getDefaultOpenNavigationState)(),currentNavigationState:(0,l().getCurrentWorkflowNavigationState)(t),newNavigationState:e.navigationState}),p=(0,i().getMergedChatSidebarState)({environment:t,update:e.chatSidebarState}),d=(0,l().routeArgsGivenNavigationState)(c),m=(0,i().routeArgsGivenChatSidebarState)(p);(0,a().maybeCloseNotionSidebar)({environment:t});const g=(0,s().Ef)({environment:t,updates:{...d,...m,store:r}}),h=void 0!==r&&u().default.state.mainEditorCurrentBlockStore!==r;o().oo({environment:t,url:g,redirect:n??!h})}function d(e){const{environment:t,newStore:r,redirect:n}=e,u=(0,l().routeArgsGivenNavigationState)((0,l().getDefaultClosedNavigationState)()),c=(0,i().routeArgsGivenChatSidebarState)(i().CLOSED_CHAT_SIDEBAR_STATE),p=(0,s().Ef)({environment:t,updates:{...u,...c,store:r}});(0,a().maybeOpenNotionSidebar)(),o().oo({environment:t,url:p,redirect:n??!0})}}}]);