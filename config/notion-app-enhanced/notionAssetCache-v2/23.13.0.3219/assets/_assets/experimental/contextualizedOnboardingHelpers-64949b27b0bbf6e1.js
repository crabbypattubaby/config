"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[11126,62342],{329979:(e,o,n)=>{n.r(o),n.d(o,{getContextualizedOnboardingAnalyticsData:()=>g,getOnboardingFlowCreatedSpaceWithoutPlanType:()=>w,getOnboardingProgressPercentage:()=>m,getSpaceIntentOverride:()=>p,getStageName:()=>d,getStages:()=>_,isAiOnboardingFlow:()=>S,isEducationFlowState:()=>c,isPublicAccessPageRedirect:()=>b,isWorkflowTemplatesEnabledForOnboarding:()=>v,shouldRedirectToJoinSpace:()=>u,shouldShowProgressIndicatorOnStage:()=>f});n(610931);var t=()=>n(443164),a=()=>n(199164),i=()=>n(548694),r=()=>n(485966),l=()=>n(30299),s=()=>n(332305);function d(e){const{flowName:o,stageIndex:n,environment:t}=e;return _({flowName:o,environment:t})[n]}function _(e){let{flowName:o,environment:n}=e;const t=n.device.isMobile,a=s().onboardingFlowNameToFlowConfig[o];if(t){if(!a.isEnabledForMobile)throw new Error(`Mobile flow is not enabled for flow name: ${o}`);return a.getMobileStages(n)}if(!a.isEnabledForDesktop)throw new Error(`Desktop flow is not enabled for flow name: ${o}`);return a.getDesktopStages()}function c(e){var o,n;return"education_flow"===e.flowName&&void 0!==(null===(o=e.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.educationRole)&&void 0!==(null===(n=e.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.educationLevel)}function g(e){var o,n,t,a,s,_,c;let{onboardingState:g,spaceJoinOrCreate:u,environment:b}=e;const{currentSpaceStore:p}=r().default.state,m=(0,i().p3)(),f=(null===(o=g.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.userPersona)??m.function,v=(null===(n=g.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.userRole)??m.role,w=(null===(t=g.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.companySize)??m.companySize,S=(null===(a=g.planTypeAndSurveyInfo)||void 0===a?void 0:a.planType)??m.intent,h=(null===(s=g.planTypeAndSurveyInfo)||void 0===s||null===(s=s.surveyResponses)||void 0===s?void 0:s.useCases)??m.useCases,y=(null===(_=g.planTypeAndSurveyInfo)||void 0===_||null===(_=_.surveyResponses)||void 0===_?void 0:_.categories)??m.categories,F=(null===(c=g.planTypeAndSurveyInfo)||void 0===c?void 0:c.collaborativeIntent)??m.collaborativeIntent;return{flow_name:g.flowName,flow_id:g.flowId,stage:d({flowName:g.flowName,stageIndex:g.currentStageIndex,environment:b}),initial_workspace_type:u,is_new_onboarding:Boolean(g.isFirstTimeOnboarding),is_create_or_join:!0,stage_number:g.currentStageIndex,num_of_joinable_spaces:g.joinableSpaces.length,historical_stages:g.historicalStages,selectedPresets:void 0,user_persona:f,user_team_role:v,user_use_cases:h,user_categories:y,user_company_size:w,plan_selection:S,collaborative_intent:F,plan_type:null==p?void 0:p.getPlanType(),stage_duration_in_ms:void 0,onboarding_templates:void 0,trial_id:(0,l().E5)(),performance_marketing_term:g.performanceMarketingTerm,is_invalid_redirect:g.isInvalidRedirect,is_dark_mode:"dark"===b.ThemeStore.state.mode,selected_workflow_templates:g.selectedWorkflowTemplateIds}}function u(e){return"guest_redirect"===e.type||"redirect_page"===e.type||"redirect_space"===e.type}function b(e){return"public_access_page_redirect"===e.type}function p(e){if("form_response_onboarding"===e.flowName)return"string"==typeof(o=e.formSpaceIntent)&&a().ay.includes(o)?e.formSpaceIntent:"personal";var o}function m(e,o){const{currentStageIndex:n}=e;return 15+(n+1)/_({flowName:e.flowName,environment:o}).length*80}function f(e,o){const n=o.device.isMobile,{currentStageIndex:t}=e,a=_({flowName:e.flowName,environment:o}).indexOf(n?"mobile_onboarding_plan_type_choose":"onboarding_plan_type_choose");return-1!==a&&t>=a}function v(e){return!e.device.isMobile}function w(e){return S(e)}function S(e){return t().He.includes(e)}},332305:(e,o,n)=>{n.r(o),n.d(o,{onboardingFlowNameToFlowConfig:()=>f});var t=n.n(n(485359)),a=()=>n(132793),i=()=>n(560320),r=()=>n(70989),l=()=>n(927685),s=()=>n(137476),d=()=>n(362621),_=()=>n(461201),c=()=>n(485966),g=()=>n(836331),u=()=>n(493065),b=()=>n(30299);var p=()=>n(652675),m=()=>n(672154);const f={education_flow:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","education_persona_survey","education_category_picker"],onStartFlow:()=>{},shouldShowFlowToUser:e=>!1},ai_onboarding_phase_2:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","app_builder","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const o=(0,d().R)(c().default.state.currentUserRootStore);void 0===o&&(0,s().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const n=0===(o??0),t=e.device.isMobile;return n&&!t&&function(){const e=a().r9();return Boolean(e)}()&&"on"===g().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two",defaultGroup:"control"})}},ai_onboarding_phase_2_5:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout","app_builder"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const o=(0,d().R)(c().default.state.currentUserRootStore);void 0===o&&(0,s().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const t=0===(o??0),a=e.device.isMobile,i="en-US"===n(16791).locale;return t&&!a&&i&&("ai_step_in_onboarding"===g().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"})||"ai_step_in_onboarding_with_skip"===g().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"}))}},form_response_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose"],getMobileStages:()=>["mobile_profile","mobile_onboarding_workspace_choose"],onStartFlow:()=>{},onCompleteFlow:async(e,o,a)=>{t()("form_response_onboarding"===o.flowName);const{defaultOnboardingComplete:r}=await i().F.contextualizedOnboardingActions.load();await r(e,a),n(156973).V(o.formResponseId,o.secretKey,o.formSpaceId)},shouldShowFlowToUser:()=>0===(0,d().R)(c().default.state.currentUserRootStore)&&(0,n(785205).A)()},mail_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async(e,o,t)=>{const{setAndTrackContextualizedOnboardingComplete:s}=await i().F.contextualizedOnboardingActions.load(),{onboardingData:d,joinableSpaces:c}=o;if(!d)return;const{onboardingStateActions:g}=await n(58793).onboardingActionsDependency.load();if(r().m({message:g.messages.creatingWorkspace}),0===c.length&&d.canUserCreateSpace){const t=n(477784).A.getIntl(),a=d.userStore.getFullName(t),{spaceViewStore:i}=await n(783759).bz({environment:e,planType:"personal",planSelection:"personal",name:a?(0,_().JR)(a,t):(0,_().CD)(t),userRootStore:d.userRootStore,analyticsFrom:"onboarding",icon:void 0,userPersona:"unfilled"});n(13769).I$(e,i,!0),s({environment:e,onboardingState:o,userStore:d.userStore,spaceJoinOrCreate:"create",permissionLevel:"member"})}await u().transactionQueue.drain(),r().V();const b=(0,a().KB)({fileHostProtocol:l().A.secureFileConfig.protocol,fileHostName:l().A.secureFileConfig.hostname}),p=null==b?void 0:b.result,m=null==p?void 0:p.startsWith(`${l().A.mail.domainBaseUrl}/`);p&&m?n(865226).oo({environment:e,url:`${p}#activeUserID=${e.currentUser.id}`}):await(0,n(938051).Z)({environment:e,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>"mail"===(0,a().dY)()},calendar_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile"],getMobileStages:()=>["mobile_profile"],onStartFlow:()=>{},onCompleteFlow:async(e,o,t)=>{await u().transactionQueue.drain(),await(0,n(313067).J7)({environment:e,url:`${l().A.domainBaseUrl}/calendarAuth/`,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>0===(0,d().R)(c().default.state.currentUserRootStore)&&"calendar"===(0,a().dY)()},performance_marketing_term_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_invite"],onStartFlow:()=>{},onCompleteFlow:async(e,o,n)=>{const{defaultOnboardingComplete:t}=await i().F.contextualizedOnboardingActions.load();await t(e,n)},shouldShowFlowToUser:e=>!e.device.isMobile&&("gantt"===(0,b().TQ)()||"crm"===(0,b().TQ)()||"projectManagement"===(0,b().TQ)())},mobile_tutorial_onboarding:{isEnabledForDesktop:!1,isEnabledForMobile:!0,getMobileStages:e=>(0,p().getMobileTutorialStages)(e),onStartFlow:()=>{},onCompleteFlow:async(e,o,n)=>{var t,a;const r=o.onboardingData;if(!r)return;const{redirectAfterContextualizedOnboardingComplete:l}=await i().F.contextualizedOnboardingActions.load(),s=(0,_().sg)(r);await l({environment:e,spaceViewId:null===(t=c().default.state.currentSpaceViewStore)||void 0===t?void 0:t.id,spaceId:null===(a=c().default.state.currentSpaceStore)||void 0===a?void 0:a.id,onboardingData:r,spaceJoinOrCreate:"join",redirectData:s,onboardingFlow:o.flowName,onboardingState:o,permissionLevel:(0,_().S1)(s)})},shouldShowFlowToUser:(e,o)=>Boolean(o)},default:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","onboarding_category_survey",..."on"===v({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["team_onboarding_function","team_onboarding_role","team_onboarding_company_size"]:["team_onboarding_persona_survey"],"team_onboarding_use_cases","team_onboarding_workspace_create","team_onboarding_invite","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],getMobileStages:e=>[...["mobile_profile","mobile_onboarding_workspace_choose","mobile_onboarding_plan_type_choose","mobile_onboarding_collaborative_intent_choose",..."on"===v({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["mobile_team_onboarding_function","mobile_team_onboarding_role","mobile_team_onboarding_company_size"]:["mobile_team_onboarding_persona_survey"],"mobile_onboarding_category_survey","mobile_team_onboarding_use_cases","mobile_team_onboarding_workspace_create","mobile_team_onboarding_invite"],...(0,p().getMobileTutorialStages)(e)],onStartFlow:()=>{},shouldShowFlowToUser:(e,o)=>(void 0===(0,d().R)(c().default.state.currentUserRootStore)&&(0,s().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}}),!o)},undefined:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async()=>{},shouldShowFlowToUser:()=>!1}};function v(e){const{experimentId:o,disableExposureLogging:n}=e,t=m().A.state.onboardingExperiments;if(null!=t&&t[o])return t[o];const a=g().default.getEligibleGroup({experimentId:o,defaultGroup:"control",disableExposureLogging:n});return m().A.setState({...m().A.state,onboardingExperiments:{...t,[o]:a}}),a}},362621:(e,o,n)=>{n.d(o,{R:()=>a});n(725707),n(491955),n(403517);var t=()=>n(975392);function a(e){return e&&e.isReady()?t().sb(e.getSpaceViewStores().filter((e=>e.getJoined())).map((e=>e.getSpaceId()))).length:void 0}},652675:(e,o,n)=>{n.r(o),n.d(o,{getContextualizedOnboardingFlowName:()=>r,getMobileTutorialStages:()=>l});var t=()=>n(443164),a=()=>n(307542),i=()=>n(332305);function r(e,o){for(const n of t().uL){if(i().onboardingFlowNameToFlowConfig[n].shouldShowFlowToUser(e,o))return n}return t().JT}function l(e){switch((0,a().DV)({environment:e})){case"v1":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share","mobile_onboarding_multi_platform"];case"v2":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share"];case"v3":return["mobile_onboarding_skill_mab","mobile_onboarding_skill_filing","mobile_onboarding_skill_swipe"];default:return["mobile_onboarding_editor","mobile_onboarding_sidebar","mobile_onboarding_desktop","mobile_onboarding_web_clipper","mobile_onboarding_app_download"]}}}}]);