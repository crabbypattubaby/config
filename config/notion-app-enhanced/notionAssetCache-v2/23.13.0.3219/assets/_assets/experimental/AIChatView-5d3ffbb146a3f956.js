"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[47108],{72970:(e,t,n)=>{n.d(t,{u:()=>r});const r=(0,n(680369).xh)("pencilLine",{default:{loader:()=>n.e(92668).then(n.bind(n,686752))},small:{loader:()=>n.e(92668).then(n.bind(n,89414))},fill:{loader:()=>n.e(92668).then(n.bind(n,447116))},fillSmall:{loader:()=>n.e(92668).then(n.bind(n,600413))}},["compose","edit","write","create"])},157440:(e,t,n)=>{n.d(t,{u:()=>r});const r=(0,n(680369).xh)("questionMarkCircle",{default:{loader:()=>n.e(82106).then(n.bind(n,155342))},small:{loader:()=>n.e(82106).then(n.bind(n,350492))},fill:{loader:()=>n.e(82106).then(n.bind(n,85534))},fillSmall:{loader:()=>n.e(82106).then(n.bind(n,309175))}},["question","query","inquiry","uncertain","unknown","help","circle"])},158195:(e,t,n)=>{n.d(t,{q:()=>u});var r=n(242343),o=()=>n(470637),s=()=>n(237385),a=()=>n(803290),i=()=>n(84543),c=()=>n(153100),l=()=>n(485966),d=()=>n(165786),p=()=>n(339496);function u(e){const t=(0,a().O$)(l().AppStoreCurrentSpaceStore),n=(0,a().K8)((()=>l().default.state.currentUserStore),[]),u=(0,a().O$)(l().AppStoreCurrentSpaceViewStore),g=(0,s().v3)(),{threadStore:m,clientAiChatStore:h,setThreadStore:f,aiChatFeatureController:y,config:S}=e,v=(0,r.useCallback)((e=>{f(e),o().A.withListenerIgnored((()=>{h.getOrCreateClientAIChatThreadStore(e.id)}))}),[h,f]),b=(0,a().K8)((()=>{const e=S??h.state.configForNewTranscripts;return y.shouldSupportAttachments(e.type)}),[y,h,S]),x=Boolean(m),k=(0,r.useMemo)((()=>{if(t&&n&&u&&b&&!x){const e=i().createAndCommit({userAction:"AIChatInput.useUploadAttachments",environment:g,canUndo:!1,perform:e=>(0,d().aP)({environment:g,spaceStore:t,userStore:n,transaction:e})}).performResult;return v(e),e}}),[x,g,v,b,t,u,n]),w=m??k,C=(0,a().K8)((()=>{if(w)return h.getOrCreateClientAIChatThreadStore(null==w?void 0:w.id)}),[h,w]),M=(0,c().z)({threadClientStore:C,aiChatFeatureController:y,config:S,clientChatStore:h}),{onPasteFiles:I,uploadAttachment:T}=(0,p().PF)({threadStore:w,spaceStore:t,config:S,clientAiChatStore:h,aiChatFeatureController:y}),A=(0,r.useCallback)((async()=>await T()),[T]);if(t&&n&&u&&b&&M&&w)return{onPasteFiles:I,uploadFile:A,threadStore:w,spaceStore:t,userStore:n,spaceViewStore:u}}},258015:(e,t,n)=>{n.d(t,{m:()=>o});class r extends(()=>n(129044))().default{getInitialState(){return{type:"initial"}}}const o=new r},309194:(e,t,n)=>{n.r(t),n.d(t,{AIChatView:()=>qt});n(610931),n(754309),n(362833),n(725707),n(491955),n(500234);var r=n(242343),o=()=>n(237385),s=()=>n(803290),a=()=>n(174114),i=()=>n(83043),c=()=>n(994966),l=()=>n(267521),d=()=>n(42371),p=()=>n(418699),u=()=>n(172746),g=()=>n(835029),m=()=>n(34662),h=()=>n(653998),f=()=>n(31448),y=()=>n(389546),S=()=>n(84543),v=()=>n(107640),b=()=>n(128450),x=()=>n(752401),k=()=>n(421338),w=()=>n(209684),C=()=>n(356813),M=()=>n(397791),I=()=>n(701270),T=()=>n(286404),A=()=>n(103151),j=()=>n(82842),P=()=>n(980149),K=()=>n(245388),_=()=>n(983050),F=()=>n(654548),E=()=>n(126996),B=()=>n(96297),N=()=>n(602129),W=()=>n(980042),D=()=>n(753004),R=()=>n(475426),O=()=>n(425021),z=()=>n(485966),H=()=>n(216273),U=()=>n(258015),G=()=>n(133926),L=()=>n(503780),V=()=>n(357307),q=()=>n(615705),Y=()=>n(308265),$=()=>n(670298),X=()=>n(518022),Q=()=>n(165786),Z=()=>n(275963),J=()=>n(609425),ee=()=>n(662861),te=()=>n(81322),ne=()=>n(258813),re=()=>n(615917),oe=()=>n(912258),se=()=>n(863969),ae=n(163643);function ie(e){const t=(0,a().IS)((e=>({animationWrapper:{zIndex:-1,position:"relative"},inlineUsageErrorContainer:{backgroundColor:e.fill.uiBlueSecondary,color:e.text.primary,marginTop:"-8px",borderRadius:"0 0 12px 12px",padding:"20px 9px 12px 16px",position:"relative",display:"flex",alignItems:"center",fontSize:"12px",width:"100%",border:"none",marginLeft:"-0.5px",marginRight:"-0.5px",justifyContent:"space-between"}})),[]),{shouldRender:n,setShouldRender:i,clientStore:c}=e,l=(0,h().tz)(),d=(0,se().O)(),p=(0,o().v3)().currentUser.id,u=(0,s().K8)((()=>O().d.state.inlineUsageErrorVisible&&n),[n]),g=(0,r.useCallback)((()=>{O().d.setState({...O().d.state,inlineUsageErrorVisible:!1}),i(!1)}),[i]),{pfaFeatureLoadArgs:m,upsellFromForCheckoutBanner:f}=(0,s().K8)((()=>d&&p?(0,v().L)({clientStore:c,spaceId:d,userId:p}):{pfaFeatureLoadArgs:{name:"ai_usage",spaceId:d,userId:p,amount:0},upsellFromForCheckoutBanner:"ai_limit_in_app"}),[c,d,p]),y=(0,G()._X)(m);(0,r.useEffect)((()=>{O().d.setState({...O().d.state,featureAvailability:y})}),[y]);const{actionForFeatureAvailability:S}=(0,oe().x)({featureAvailability:y,upgradeRequestAnalyticsEntrypoint:"ai_home_page",upgradeRequestEntrypoint:"ai_home_page",upsellFrom:f});return S?(0,ae.jsx)("div",{style:t.animationWrapper,children:(0,ae.jsx)(re().A,{visible:!0,initial:{opacity:0,height:0},animate:{opacity:u?1:0,height:u?50:0,visibility:u?"visible":"hidden"},exit:{opacity:0,height:0},config:{duration:500},children:(0,ae.jsxs)("div",{style:t.inlineUsageErrorContainer,children:[(0,ae.jsx)("div",{children:(0,ae.jsx)(h().sA,{id:"aiChatInlineUsageError.limitReached",defaultMessage:"Youâ€™re out of free AI responses for this feature. Request access to <bold> Unlimited AI</bold>.",values:{bold:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,ae.jsx)(ne().f,{onClick:S,children:t})}}})}),(0,ae.jsx)(C().A,{ariaLabel:l.formatMessage({id:"aiChatView.closeInlineError",defaultMessage:"Close"}),icon:te().V,onClick:g})]})})}):null}var ce=()=>n(752597),le=()=>n(353509),de=()=>n(404354),pe=()=>n(197821),ue=()=>n(76394),ge=()=>n(375589),me=()=>n(357247),he=()=>n(448316),fe=()=>n(384221),ye=()=>n(373040),Se=()=>n(636045),ve=()=>n(8519),be=()=>n(137476),xe=()=>n(868199),ke=()=>n(621641),we=()=>n(622286),Ce=()=>n(339190),Me=()=>n(205670),Ie=()=>n(477557),Te=()=>n(45524),Ae=()=>n(503691),je=()=>n(895644),Pe=()=>n(339496),Ke=()=>n(999360),_e=()=>n(222652),Fe=()=>n(757357);const Ee=(0,h().YK)({placeholder:{id:"aiInferenceTranscript.placeholder",defaultMessage:"Ask AI anything..."}});function Be(e){const t=(0,h().tz)(),{store:n,onSubmit:i,clientStore:c,threadStore:l,showInitialModePicker:d,aiChatFeatureController:p,config:u,onLoaded:g,loadAttachmentsData:f}=e,y=(0,o().v3)(),[v,b]=r.useState(!1);(0,r.useEffect)((()=>{null==g||g()}),[g]);const x=(0,s().K8)((()=>0===(0,m().AhH)(n.getValue()||[])),[n]),k=(0,s().K8)((()=>n.getValue()),[n]),w=(0,s().K8)((()=>Boolean(void 0!==(null==l?void 0:l.getCurrentInferenceId())||(null==l?void 0:l.id)&&c.getOrCreateClientAIChatThreadStore(l.id).state.loading)),[l,c]),M=(0,r.useCallback)((()=>{if(!l)return;const{serverCommitResult:e}=S().createAndCommit({userAction:"AIChatTranscript.StopInferenceButton.handleClick",environment:y,canUndo:!0,perform:e=>{(0,Q().GS)({threadStore:l,transaction:e,clientStore:c})}}),t=c.getOrCreateClientAIChatThreadStore(l.id);t.setState({...t.state,stopInferencePromise:e})}),[y,l,c]),I=(0,r.useCallback)((async()=>{const{dictationActions:e}=await ve().$O.load(),t=(0,m().q4_)(n.getValue()||[]);await e.StreamingDictationManager.start({environment:y,onTranscription:e=>{const r=t?`${t}\n${e}`:e;S().createAndCommit({userAction:"AIChatInput.handleDictation",environment:y,canUndo:!0,perform:e=>{he().R9({environment:y,store:n,value:(0,m().x9d)(r),transaction:e})}})}}),b(!0)}),[y,n]),T=(0,r.useCallback)((async()=>{const{dictationActions:e}=await ve().$O.load();await e.StreamingDictationManager.stop(),b(!1)}),[]);(0,r.useEffect)((()=>()=>{T()}),[T]);const A=(0,s().O$)(z().AppStoreCurrentSpaceStore),j=(0,s().K8)((()=>(0,Te().ak)({spaceStore:A})),[A]),P=d&&p.supportsModePicker,K=(0,we().X)("workflows_use_agent")&&u&&"workflow"===u.type;(0,Ae().M)({textValue:k,isEnabled:p.supportsAutoRouting,clientStore:c,configs:j});const F=(0,s().K8)((()=>!l||l.canEdit()),[l]),E=(0,r.useCallback)((()=>{F&&!w&&(null==i||i(n.getValue()),requestAnimationFrame((()=>{const e=Ce().n.findNodeFromStore(n);e&&e.focus()})))}),[i,n,w,F]),B=(0,s().K8)((()=>c.state.configForNewTranscripts),[c]),N=(0,r.useCallback)((async()=>{const e=Me().default.state;"editing"===e.mode&&(0,ke().KP)(e.multiSelection)&&e.multiSelection.start.store===n||(fe().setSelectionAtEnd({store:n}),await ce().default.afterNextFlush())}),[n]),W=(0,s().K8)((()=>"researcher"!==B.type||(0,Fe().a)(l)),[l,B]),D=(0,s().K8)((()=>"researcher"!==B.type||(0,Fe().a)(l)),[l,B]),R=(0,s().K8)((()=>function(e){const{config:t,threadStore:n,intl:r}=e;if(n&&!(0,Fe().a)(n)){const e=De[t.type];return e?r.formatMessage(e):r.formatMessage(Ee.placeholder)}if("markdown-chat"===t.type){const e=t.model;if(e){const t=(0,ue().O)(Ne,e)?Ne[e]:void 0;if(t)return r.formatMessage(t)}}const o=We[t.type];if(o)return r.formatMessage(o);return r.formatMessage(Ee.placeholder)}({config:B,threadStore:l,intl:t})),[B,l,t]),H=(0,s().K8)((()=>(0,Y().aj)()&&(null==l?void 0:l.getMessages().length)),[l]),U=p.supportsTranscription,G=(0,a().IS)((e=>({stagingAndInputWrap:{overflow:"inherit",flexGrow:1,flexShrink:1,borderRadius:12},wrap:{display:"flex",fontSize:12,alignItems:"center",flexWrap:"wrap",boxShadow:`0px 0px 0px 0.5px ${e.stroke.primary}, 0px 4px 12px -2px rgba(0, 0, 0, 0.08)`,backgroundColor:"dark"===e.mode?e.surface.elevated:e.contentBackground,borderRadius:12,overflow:"inherit",position:"relative"},textContainer:{flexGrow:1,padding:"8px 12px 12px 12px",minHeight:56,maxHeight:240,overflow:"auto",fontSize:16},placeholder:{opacity:1,cursor:"text",minHeight:56},rightGutter:{display:"flex",alignItems:"center",justifyContent:"center",padding:"6px 10px",gap:4},leftGutter:{display:"flex",alignItems:"flex-end",justifyContent:"flex-start",padding:"0 0 6px 6px"},sendButtonIcon:{width:28,height:28,padding:"0 0 0 4px"},microphoneIcon:{width:28},stopIcon:{width:28,height:28},inputActionsRow:{display:"flex",width:"100%",justifyContent:"space-between",overflow:"hidden",height:40}})),[]),L=(0,s().K8)((()=>{const e=p.shouldShowUsageError&&void 0===O().d.state.featureAvailability;return!x&&!e}),[p,x]),V=(0,r.useCallback)((()=>{"empty"===Me().default.state.mode&&fe().setSelectionAtEnd({store:n})}),[n]),q=(0,r.useCallback)((()=>{fe().clear({environment:y})}),[y]);return(0,ae.jsxs)("div",{style:G.stagingAndInputWrap,tabIndex:0,className:_().CCX,children:[H?(0,ae.jsx)(je()._,{clientStore:c}):null,(0,ae.jsxs)("div",{style:G.wrap,onClick:e=>{if(e.target===e.currentTarget){const t=Ce().n.findEditableWithStore(n);t&&t.handleClick(e)}},children:[(0,ae.jsx)(Se().A,{style:G.textContainer,placeholder:R,disabled:!1,store:n,placeholderStyle:G.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onPasteFiles:null==f?void 0:f.onPasteFiles,disableEnter:!1,onEnter:E,disableMobileActionBar:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestEdit:!0,inPageFind:xe().Os.none,usePopupForMentionOnMobile:!0,disableMentions:!p.shouldAllowMentions,disabledMentionTypes:Ie().md,onBlur:q,onClick:V}),p.shouldSupportAttachments(B.type)&&f&&(0,ae.jsx)(Pe().Yo,{clientStore:c,loadAttachmentsData:f}),(0,ae.jsxs)("div",{style:G.inputActionsRow,children:[P&&(0,ae.jsx)("div",{style:G.leftGutter,children:(0,ae.jsx)(ge()._,{clientStore:c,configs:j,threadStore:l})}),K&&(0,ae.jsx)("div",{style:G.leftGutter,children:(0,ae.jsx)(ge().rm,{clientStore:c})}),(0,ae.jsx)("div",{style:{flexGrow:1}}),(0,ae.jsxs)("div",{style:G.rightGutter,children:[p.supportsWebSearch(B.type)&&D&&(0,ae.jsx)(_e().l,{clientStore:c}),p.supportsSearchScopePopup(B.type)&&W&&(0,ae.jsx)(Ke().d,{clientStore:c,threadStore:l}),p.shouldSupportAttachments(B.type)&&f&&(0,ae.jsx)(Pe().Wn,{loadAttachmentsData:f,clientStore:c}),p.shouldAllowMentions&&(0,ae.jsx)(ye().q,{onClick:e=>{e.preventDefault(),e.stopPropagation(),async function(){await N(),await ce().default.afterNextFlush(),me().Gf({environment:y,mentionTypes:Ie().Ap,usePopupOnMobile:!0}),(0,be().u4)({environment:y,event:{eventName:"clicked_ai_chat_at_mention_button",eventProperties:{mode:B.type}}})}()}}),v?(0,ae.jsx)(C().A,{icon:pe().m,onClick:T,iconStyle:G.stopIcon,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.stopRecording",defaultMessage:"Stop recording"})},"stop-recording"):w?(0,ae.jsx)(C().A,{icon:pe().m,onClick:M,iconStyle:G.stopIcon,disabled:!p.supportsStopInference(B.type),ariaLabel:t.formatMessage({id:"aiInferenceTranscript.stopInference",defaultMessage:"Stop AI message"})},"stop-inference"):(0,ae.jsxs)(ae.Fragment,{children:[!v&&U&&(0,ae.jsx)(C().A,{icon:le().E,onClick:I,iconStyle:G.microphoneIcon,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.startRecording",defaultMessage:"Start recording"})},"start-recording"),(0,ae.jsx)(C().A,{icon:de().b,onClick:E,iconStyle:G.sendButtonIcon,isBlue:!x,disabled:!L,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.submitAiMessage",defaultMessage:"Submit AI message"})},"send-message")]})]})]})]})]})}const Ne=(0,h().YK)({"anthropic-sonnet-3.7":{id:"AIChatInput.placeholder.anthropicSonnet3Point7",defaultMessage:"Ask Claude 3.7 Sonnetâ€¦"},"openai-gpt-4.1":{id:"AIChatInput.placeholder.openaiGpt4Point1",defaultMessage:"Ask GPT-4.1â€¦"}}),We=(0,h().YK)({search:{id:"AIChatInput.placeholder.search",defaultMessage:"Ask or find anything from your workspaceâ€¦"},researcher:{id:"AIChatInput.placeholder.researcher",defaultMessage:"Research a topic from your workspaceâ€¦"},workflow:{id:"AIChatInput.placeholder.workflow",defaultMessage:"Ask for anythingâ€¦"},"setup-generator":{id:"AIChatInput.placeholder.setupGenerator",defaultMessage:"Create a custom databaseâ€¦"}}),De=(0,h().YK)({researcher:{id:"aiInferenceTranscript.research_mode_placeholder",defaultMessage:"Ask a follow up question..."}});n(403517);var Re=()=>n(104271),Oe=()=>n(233041),ze=()=>n(680369);const He=(0,ze().xh)("cube",{default:{loader:()=>n.e(41438).then(n.bind(n,647658))},small:{loader:()=>n.e(41438).then(n.bind(n,256304))},fill:{loader:()=>n.e(41438).then(n.bind(n,132682))},fillSmall:{loader:()=>n.e(41438).then(n.bind(n,10403))}},["cube","box","threedimensional","geometric","square"]),Ue=(0,ze().xh)("docPlainText",{default:{loader:()=>n.e(39322).then(n.bind(n,39742))},small:{loader:()=>n.e(39322).then(n.bind(n,606892))},fill:{loader:()=>n.e(39322).then(n.bind(n,798446))},fillSmall:{loader:()=>n.e(39322).then(n.bind(n,653831))}},["document","paper","lines","text","file"]),Ge=(0,ze().xh)("lightBulbBright",{default:{loader:()=>n.e(88298).then(n.bind(n,571544))},small:{loader:()=>n.e(88298).then(n.bind(n,975358))},fill:{loader:()=>n.e(88298).then(n.bind(n,179764))},fillSmall:{loader:()=>n.e(88298).then(n.bind(n,717413))}},["idea","filament","brightness","on"]),Le=(0,ze().xh)("magicWand",{default:{loader:()=>n.e(60376).then(n.bind(n,182658))},small:{loader:()=>n.e(60376).then(n.bind(n,131304))},fill:{loader:()=>n.e(60376).then(n.bind(n,871538))},fillSmall:{loader:()=>n.e(60376).then(n.bind(n,540299))}},["magic","wand","fantasy","wizard","enchantment"]);const Ve=(0,ze().xh)("quoteText",{default:{loader:()=>n.e(2678).then(n.bind(n,269164))},small:{loader:()=>n.e(2678).then(n.bind(n,59770))},fill:{loader:()=>n.e(2678).then(n.bind(n,800168))},fillSmall:{loader:()=>n.e(2678).then(n.bind(n,673273))}},["quote block","inline","quotation"]),qe=(0,ze().xh)("textShort",{default:{loader:()=>n.e(32678).then(n.bind(n,702088))},small:{loader:()=>n.e(32678).then(n.bind(n,318542))},fill:{loader:()=>n.e(32678).then(n.bind(n,373636))},fillSmall:{loader:()=>n.e(32678).then(n.bind(n,49653))}},["text","shorten","edit","summarize","make shorter","truncate","summary","ai"]);var Ye=()=>n(647242),$e=()=>n(975392),Xe=()=>n(194568),Qe=()=>n(366470),Ze=()=>n(741329),Je=()=>n(670682);const et=(0,h().YK)({painPoints:{id:"aiInferenceTranscript.promptMessages.researchMode.painPoints",defaultMessage:"Customer pain points from interviews"},keyInsights:{id:"aiInferenceTranscript.promptMessages.researchMode.keyInsights",defaultMessage:"Key insights from financial projections"},seasonalSales:{id:"aiInferenceTranscript.promptMessages.researchMode.seasonalSales",defaultMessage:"Seasonal sales trends in the last 3 years"},context:{id:"aiInferenceTranscript.promptMessages.researchMode.context",defaultMessage:"Context related to new user onboarding"},commonThemes:{id:"aiInferenceTranscript.promptMessages.researchMode.commonThemes",defaultMessage:"Extract common feedback themes from user reviews"},customerChurnInsights:{id:"aiInferenceTranscript.promptMessages.researchMode.customerChurnInsights",defaultMessage:"Insights from recent churned customer surveys"},opportunities:{id:"aiInferenceTranscript.promptMessages.researchMode.opportunities",defaultMessage:"Opportunities based on customer support tickets"}}),tt=(0,h().YK)({manageTasks:{id:"aiInferenceTranscript.promptMessages.buildMode.manageTasks",defaultMessage:"Manage tasks for a product launch"},makePlan:{id:"aiInferenceTranscript.promptMessages.buildMode.makePlan",defaultMessage:"Make a plan for a marketing campaign"},trackPlan:{id:"aiInferenceTranscript.promptMessages.buildMode.trackPlan",defaultMessage:"Track plan for sales leads"},onboardingTeamMembers:{id:"aiInferenceTranscript.promptMessages.buildMode.onboardingTeamMembers",defaultMessage:"Make a plan for onboarding team members"},runCampaign:{id:"aiInferenceTranscript.promptMessages.buildMode.runCampaign",defaultMessage:"Run a campaign for an email marketing push"}}),nt=(0,h().YK)({travelItinerary:{id:"aiInferenceTranscript.promptMessages.chatMode.travelItinerary",defaultMessage:"Travel itinerary for a day in San Francisco"},alanKayImpact:{id:"aiInferenceTranscript.promptMessages.chatMode.alanKayImpact",defaultMessage:"Alan Kayâ€™s impact on computer science"},biggestDominoEffects:{id:"aiInferenceTranscript.promptMessages.chatMode.biggestDominoEffects",defaultMessage:"Biggest domino effects in pop culture"},macroEvents:{id:"aiInferenceTranscript.promptMessages.chatMode.macroEvents",defaultMessage:"Macro events that shape architectural trends"},dailyMindfulness:{id:"aiInferenceTranscript.promptMessages.chatMode.dailyMindfulness",defaultMessage:"Daily mindfulness practices based on scientific studies"},votingSystems:{id:"aiInferenceTranscript.promptMessages.chatMode.votingSystems",defaultMessage:"How do voting systems differ around the world?"},unsolvedBiologyMysteries:{id:"aiInferenceTranscript.promptMessages.chatMode.unsolvedBiologyMysteries",defaultMessage:"What are the biggest unsolved mysteries in biology?"}}),rt=(0,h().YK)({outlineProjects:{id:"aiInferenceTranscript.promptMessages.searchMode.outlineProjects",defaultMessage:"Outline projects Iâ€™m currently working on"},readingList:{id:"aiInferenceTranscript.promptMessages.searchMode.readingList",defaultMessage:"Suggest a reading list of books, docs, or articles"},emergingTrends:{id:"aiInferenceTranscript.promptMessages.searchMode.emergingTrends",defaultMessage:"What are some emerging trends?"},summarizeNotes:{id:"aiInferenceTranscript.promptMessages.searchMode.summarizeNotes",defaultMessage:"Summarize my notes across recent meetings"},draftBio:{id:"aiInferenceTranscript.promptMessages.searchMode.draftBio",defaultMessage:"Draft a bio based on my recent work"},helpMePrioritize:{id:"aiInferenceTranscript.promptMessages.searchMode.helpMePrioritize",defaultMessage:"Help me prioritize projects for this month"}}),ot=(0,h().YK)({teamTopPriorities:{defaultMessage:"What are the teamâ€™s top priorities this quarter?",id:"aiInferenceTranscript.promptMessages.businessPrompts.teamTopPriorities"},getAnswersFromConnectedApps:{defaultMessage:"Get answers from connected apps",id:"aiInferenceTranscript.promptMessages.businessPrompts.getAnswersFromConnectedApps"},synthesizeCustomerFeedback:{defaultMessage:"Synthesize customer feedback from the last 3 months",id:"aiInferenceTranscript.promptMessages.businessPrompts.synthesizeCustomerFeedback"},trendingTopicsInCompany:{defaultMessage:"Trending topics at the company",id:"aiInferenceTranscript.promptMessages.businessPrompts.trendingTopicsInCompany"}}),st=(0,h().YK)({getAnswersFromConnectedApps:{defaultMessage:"Get answers from connected apps",id:"aiInferenceTranscript.promptMessages.personalPrompts.getAnswersFromConnectedApps"},outlineLesserKnownFactsAboutMars:{defaultMessage:"Outline lesser known facts about mars",id:"aiInferenceTranscript.promptMessages.personalPrompts.outlineLesserKnownFactsAboutMars"},mostPopularPersonalityTests:{defaultMessage:"What are the most popular personality tests?",id:"aiInferenceTranscript.promptMessages.personalPrompts.mostPopularPersonalityTests"}}),at=(0,h().YK)({studyPlan:{id:"aiInferenceTranscript.promptMessages.educationPrompts.studyPlan",defaultMessage:"Create a structured study plan"},brainstormInterestingTopicsForEssays:{id:"aiInferenceTranscript.promptMessages.educationPrompts.brainstormInterestingTopicsForEssays",defaultMessage:"Brainstorm interesting topics for essays"},emergingEconomicTrends:{defaultMessage:"Tell me about emerging economic trends",id:"aiInferenceTranscript.promptMessages.educationPrompts.emergingEconomicTrends"}}),it=(0,h().YK)({summarizeActivity:{defaultMessage:"Summarize activity from this week",id:"aiInferenceTranscript.promptMessages.slackPrompts.summarizeActivity"},overviewOutOfOffice:{defaultMessage:"Overview of what happened while I was OOO",id:"aiInferenceTranscript.promptMessages.slackPrompts.overviewOutOfOffice"},trendingTopics:{defaultMessage:"What topics are trending today?",id:"aiInferenceTranscript.promptMessages.slackPrompts.trendingTopics"},writingStyle:{defaultMessage:"What does my writing style say about me?",id:"aiInferenceTranscript.promptMessages.slackPrompts.writingStyle"},mostCommonQuestionsFromNewHires:{defaultMessage:"Most common questions from new hires",id:"aiInferenceTranscript.promptMessages.slackPrompts.mostCommonQuestionsFromNewHires"},topConcerns:{defaultMessage:"Top concerns discussed by the team this week",id:"aiInferenceTranscript.promptMessages.slackPrompts.topConcerns"},sentiment:{defaultMessage:"Sentiment trend in Slack conversations over the past month",id:"aiInferenceTranscript.promptMessages.slackPrompts.sentiment"}}),ct=(0,h().YK)({outlineBugs:{defaultMessage:"Outline bugs that were recently triaged",id:"aiInferenceTranscript.promptMessages.githubPrompts.outlineBugs"},prsWaitingForReview:{defaultMessage:"Which PRs have been waiting for review",id:"aiInferenceTranscript.promptMessages.githubPrompts.prsWaitingForReview"},highPriorityBugs:{defaultMessage:"Show me all high-priority bugs in our repo",id:"aiInferenceTranscript.promptMessages.githubPrompts.highPriorityBugs"},engineeringReport:{defaultMessage:"Generate an engineering report",id:"aiInferenceTranscript.promptMessages.githubPrompts.engineeringReport"},contributions:{defaultMessage:"Show contributions by team members this sprint",id:"aiInferenceTranscript.promptMessages.githubPrompts.contributions"},clusterIssues:{defaultMessage:"Cluster issues by product component or tag",id:"aiInferenceTranscript.promptMessages.githubPrompts.clusterIssues"}}),lt=(0,h().YK)({outlineInsights:{defaultMessage:"Outline relevant insights or updates",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.outlineInsights"},commonThemesInTeamPresentations:{defaultMessage:"Common themes in team presentations",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.commonThemesInTeamPresentations"},summarizeKeyUsage:{defaultMessage:"Summarize key usage in google drive",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.summarizeKeyUsage"},mostEditedDocuments:{defaultMessage:"List most edited docs in the past few months",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.mostEditedDocuments"},openQuestions:{defaultMessage:"What are the open questions across product specs?",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.openQuestions"},summarizeUserResearch:{defaultMessage:"Summarize user research across different slide decks",id:"aiInferenceTranscript.promptMessages.googleDrivePrompts.summarizeUserResearch"}}),dt=(0,h().YK)({makeAPlan:{id:"aiInferenceTranscript.promptMessages.setupGeneratorWorkPrompts.makeAPlan",defaultMessage:"Make a plan for a product roadmap"},manageTasks:{id:"aiInferenceTranscript.promptMessages.setupGeneratorWorkPrompts.manageTasks",defaultMessage:"Manage tasks for a website redesign"},collectFeedback:{id:"aiInferenceTranscript.promptMessages.setupGeneratorWorkPrompts.collectFeedback",defaultMessage:"Collect feedback on customer satisfaction"},trackPipeline:{id:"aiInferenceTranscript.promptMessages.setupGeneratorWorkPrompts.trackPipeline",defaultMessage:"Track pipeline for sales leads"},runCampaign:{id:"aiInferenceTranscript.promptMessages.setupGeneratorWorkPrompts.runCampaign",defaultMessage:"Run campaign for a product launch"}}),pt=(0,h().YK)({journalEntries:{id:"aiInferenceTranscript.promptMessages.setupGeneratorPersonalPrompts.journalEntries",defaultMessage:"Journal entries about daily reflections"},manageLists:{id:"aiInferenceTranscript.promptMessages.setupGeneratorPersonalPrompts.manageLists",defaultMessage:"Manage lists for grocery shopping"},trackHabits:{id:"aiInferenceTranscript.promptMessages.setupGeneratorPersonalPrompts.trackHabits",defaultMessage:"Track habits for daily workouts"},setGoals:{id:"aiInferenceTranscript.promptMessages.setupGeneratorPersonalPrompts.setGoals",defaultMessage:"Set goals for financial savings"},saveMemories:{id:"aiInferenceTranscript.promptMessages.setupGeneratorPersonalPrompts.saveMemories",defaultMessage:"Save memories from vacations and trips"}}),ut=5;function gt(e){const{clientStore:t}=e,n=(0,s().O$)(z().AppStoreCurrentSpaceStore),{isLoading:o}=(0,Qe().ts)(),a=(0,s().K8)(Ze().wd,[]),i=(0,s().K8)(Ze().uM,[]),c=(0,r.useCallback)((e=>i.includes(e)),[i]),l=(0,s().K8)((()=>{const e=[];for(const n of a)(0,ue().O)(It,n)&&e.push(n);const t=(0,$e().XM)(e);if(t)return(0,$e().XM)(It[t]({spaceStore:n,isConnectorInProgress:c(t)}))}),[a,n,c]),d=function(){const e=(0,s().O$)(z().AppStoreCurrentSpaceStore),t=(0,Je().f_)({spaceId:null==e?void 0:e.id}),n=(0,Ye().AI)(t);if("free"===n||"plus"===n)return"default";if("personal"===n)return"personal";if("business"===n||"enterprise"===n)return"business";if("student"===n)return"education";(0,ue().HB)(n)}(),p=(0,s().K8)((()=>t.state.configForNewTranscripts),[t]),u=(0,s().K8)((()=>{if("researcher"===(null==p?void 0:p.type))return(0,$e().k4)(function(e){const t={type:"researcher"},n=(0,Te().Ol)({spaceStore:e.spaceStore,config:t})??t;return[{analyticsKey:"researcher.pain_points",type:"prompt",message:et.painPoints,icon:mt,config:n},{analyticsKey:"researcher.key_insights",type:"prompt",message:et.keyInsights,icon:ht,config:n},{analyticsKey:"researcher.seasonal_sales",type:"prompt",message:et.seasonalSales,icon:ft,config:n},{analyticsKey:"researcher.context",type:"prompt",message:et.context,icon:yt,config:n},{analyticsKey:"researcher.common_themes",type:"prompt",message:et.commonThemes,icon:vt,config:n},{analyticsKey:"researcher.customer_churn_insights",type:"prompt",message:et.customerChurnInsights,icon:ht,config:n},{analyticsKey:"researcher.opportunities",type:"prompt",message:et.opportunities,icon:ft,config:n}]}({spaceStore:n}));if("workflow"===(null==p?void 0:p.type))return(0,$e().k4)(function(e){const t={type:"workflow"},n=(0,Te().Ol)({spaceStore:e.spaceStore,config:t})??t;return[{analyticsKey:"workflow.manage_tasks",type:"prompt",message:tt.manageTasks,icon:xt,config:n},{analyticsKey:"workflow.make_plan",type:"prompt",message:tt.makePlan,icon:yt,config:n},{analyticsKey:"workflow.track_plan",type:"prompt",message:tt.trackPlan,icon:St,config:n},{analyticsKey:"workflow.onboarding_team_members",type:"prompt",message:tt.onboardingTeamMembers,icon:vt,config:n},{analyticsKey:"workflow.run_campaign",type:"prompt",message:tt.runCampaign,icon:xt,config:n}]}({spaceStore:n}));if("markdown-chat"===(null==p?void 0:p.type))return(0,$e().k4)(function(e){const t={type:"markdown-chat",model:"openai-gpt-4.1"},n=(0,Te().Ol)({spaceStore:e.spaceStore,config:{type:"markdown-chat",model:"openai-gpt-4.1"}})??t,r=(0,Te().Ol)({spaceStore:e.spaceStore,config:{type:"markdown-chat",model:"anthropic-sonnet-3.7"}})??t;return[{analyticsKey:"markdown-chat.travel_itinerary",type:"prompt",message:nt.travelItinerary,icon:bt,config:n},{analyticsKey:"markdown-chat.alan_kay_impact",type:"prompt",message:nt.alanKayImpact,icon:St,config:r},{analyticsKey:"markdown-chat.biggest_domino_effects",type:"prompt",message:nt.biggestDominoEffects,icon:ht,config:r},{analyticsKey:"markdown-chat.macro_events",type:"prompt",message:nt.macroEvents,icon:ft,config:n},{analyticsKey:"markdown-chat.daily_mindfulness",type:"prompt",message:nt.dailyMindfulness,icon:ht,config:r},{analyticsKey:"markdown-chat.voting_systems",type:"prompt",message:nt.votingSystems,icon:mt,config:r},{analyticsKey:"markdown-chat.unsolved_biology_mysteries",type:"prompt",message:nt.unsolvedBiologyMysteries,icon:mt,config:r}]}({spaceStore:n}));if("setup-generator"===(null==p?void 0:p.type))return(0,$e().k4)(function(e){const{audience:t}=e,n=[{type:"action",id:"setup-generator",message:dt.makeAPlan,icon:ht,prompt:dt.makeAPlan},{type:"action",id:"setup-generator",message:dt.manageTasks,icon:yt,prompt:dt.manageTasks},{type:"action",id:"setup-generator",message:dt.collectFeedback,icon:ft,prompt:dt.collectFeedback},{type:"action",id:"setup-generator",message:dt.trackPipeline,icon:xt,prompt:dt.trackPipeline},{type:"action",id:"setup-generator",message:dt.runCampaign,icon:bt,prompt:dt.runCampaign}],r=[{type:"action",id:"setup-generator",message:pt.journalEntries,icon:yt,prompt:pt.journalEntries},{type:"action",id:"setup-generator",message:pt.manageLists,icon:St,prompt:pt.manageLists},{type:"action",id:"setup-generator",message:pt.trackHabits,icon:vt,prompt:pt.trackHabits},{type:"action",id:"setup-generator",message:pt.setGoals,icon:ht,prompt:pt.setGoals},{type:"action",id:"setup-generator",message:pt.saveMemories,icon:ft,prompt:pt.saveMemories}];return"business"===t?n:r}({audience:d}));{const e=(0,$e().k4)(function(e){const{audience:t,spaceStore:n,hasAnyConnectors:r}=e;if("business"===t)return function(e){const{spaceStore:t,includeConnectorUpsell:n}=e,r={type:"search",scopeForNextSearch:Oe().W},o=(0,Te().Ol)({spaceStore:t,config:r})??r,s=n?[{id:"connector-upsell",type:"action",message:ot.getAnswersFromConnectedApps,icon:{type:"custom",key:"connector-bubbles"}}]:[],a=kt({spaceStore:t,includeConnectorUpsell:!1}).slice(0,2);return[{analyticsKey:"search.team_top_priorities",type:"prompt",message:ot.teamTopPriorities,icon:mt,config:o},...s,{analyticsKey:"search.synthesize_customer_feedback",type:"prompt",message:ot.synthesizeCustomerFeedback,icon:vt,config:o},{analyticsKey:"search.trending_topics_in_company",type:"prompt",message:ot.trendingTopicsInCompany,icon:mt,config:o},...a]}({spaceStore:n,includeConnectorUpsell:!r});if("personal"===t)return function(e){const{spaceStore:t,includeConnectorUpsell:n}=e,r={type:"search",scopeForNextSearch:Oe().W},o=(0,Te().Ol)({spaceStore:t,config:r})??r,s=n?[{id:"connector-upsell",type:"action",message:st.getAnswersFromConnectedApps,icon:{type:"custom",key:"connector-bubbles"}}]:[],a=(0,$e().k4)(kt({spaceStore:t,includeConnectorUpsell:!1})).slice(0,3);return[...s,{analyticsKey:"search.facts_about_mars",type:"prompt",message:st.outlineLesserKnownFactsAboutMars,icon:mt,config:o},{analyticsKey:"search.personality_tests",type:"prompt",message:st.mostPopularPersonalityTests,icon:bt,config:o},...a]}({spaceStore:n,includeConnectorUpsell:!r});if("education"===t)return function(e){const{spaceStore:t}=e,n={type:"search",scopeForNextSearch:Oe().W},r=(0,Te().Ol)({spaceStore:e.spaceStore,config:n})??n,o=(0,$e().k4)(kt({spaceStore:t,includeConnectorUpsell:!1})).slice(0,2);return[{analyticsKey:"search.study_plan",type:"prompt",message:at.studyPlan,icon:vt,config:r},{analyticsKey:"search.brainstorm_interesting_topics_for_essays",type:"prompt",message:at.brainstormInterestingTopicsForEssays,icon:ht,config:r},{analyticsKey:"search.emerging_economic_trends",type:"prompt",message:at.emergingEconomicTrends,icon:mt,config:r},...o]}({spaceStore:n});if("default"===t)return kt({spaceStore:n,includeConnectorUpsell:!r});(0,ue().HB)(t)}({audience:d,spaceStore:n,hasAnyConnectors:a.length>0}));let t=Oe().W;return"search"===(null==p?void 0:p.type)&&(t=p.scopeForNextSearch),"everything"===t.type?l?[l,...e]:e:"slack"===t.type?(0,$e().k4)(It.slack({spaceStore:n,isConnectorInProgress:c("slack")})):"github"===t.type?(0,$e().k4)(It.github({spaceStore:n,isConnectorInProgress:c("github")})):"google-drive"===t.type?(0,$e().k4)(It.google_drive({spaceStore:n,isConnectorInProgress:c("google_drive")})):e}}),[p,d,l,n,a.length,c]);return u.slice(0,ut)}const mt={type:"icon",iconGroup:n(157440).u,color:"purplePrimary"},ht={type:"icon",iconGroup:Ge,color:"greenPrimary"},ft={type:"icon",iconGroup:Ve,color:"bluePrimary"},yt={type:"icon",iconGroup:Ue,color:"purplePrimary"},St={type:"icon",iconGroup:qe,color:"greenPrimary"},vt={type:"icon",iconGroup:n(72970).u,color:"purplePrimary"},bt={type:"icon",iconGroup:Le,color:"purplePrimary"},xt={type:"icon",iconGroup:He,color:"uiBluePrimary"};function kt(e){const{spaceStore:t,includeConnectorUpsell:n}=e,r={type:"search",scopeForNextSearch:Oe().W},o=(0,Te().Ol)({spaceStore:t,config:r})??r,s=n?[{id:"connector-upsell",type:"action",message:ot.getAnswersFromConnectedApps,icon:{type:"custom",key:"connector-bubbles"}}]:[];return[{analyticsKey:"search.outline_projects",type:"prompt",message:rt.outlineProjects,icon:yt,config:o},...s,{analyticsKey:"search.reading_list",type:"prompt",message:rt.readingList,icon:ft,config:o},{analyticsKey:"search.emerging_trends",type:"prompt",message:rt.emergingTrends,icon:mt,config:o},{analyticsKey:"search.summarize_notes",type:"prompt",message:rt.summarizeNotes,icon:vt,config:o},{analyticsKey:"search.draft_bio",type:"prompt",message:rt.draftBio,icon:St,config:o},{analyticsKey:"search.help_me_prioritize",type:"prompt",message:rt.helpMePrioritize,icon:ht,config:o}]}const wt={type:"logo",icon:Xe().GK.slack};const Ct={type:"logo",icon:Xe().GK.github};const Mt={type:"logo",icon:Xe().GK.google_drive};const It={slack:function(e){const{spaceStore:t,isConnectorInProgress:n}=e,r=[{analyticsKey:"slack.summarize_activity",message:it.summarizeActivity,icon:wt},{analyticsKey:"slack.overview_out_of_office",message:it.overviewOutOfOffice,icon:wt},{analyticsKey:"slack.trending_topics",message:it.trendingTopics,icon:wt},{analyticsKey:"slack.writing_style",message:it.writingStyle,icon:wt},{analyticsKey:"slack.most_common_questions_from_new_hires",message:it.mostCommonQuestionsFromNewHires,icon:wt},{analyticsKey:"slack.top_concerns",message:it.topConcerns,icon:wt},{analyticsKey:"slack.sentiment",message:it.sentiment,icon:wt}];if(n)return r.map((e=>({...e,type:"action",id:"connector-upsell"})));{const e={type:"search",scopeForNextSearch:{type:"slack"}},n=(0,Te().Ol)({spaceStore:t,config:e})??e;return r.map((e=>({...e,type:"prompt",config:n})))}},github:function(e){const{spaceStore:t,isConnectorInProgress:n}=e,r=[{analyticsKey:"github.outline_bugs",message:ct.outlineBugs,icon:Ct},{analyticsKey:"github.prs_waiting_for_review",message:ct.prsWaitingForReview,icon:Ct},{analyticsKey:"github.high_priority_bugs",message:ct.highPriorityBugs,icon:Ct},{analyticsKey:"github.prs_waiting_for_review",message:ct.prsWaitingForReview,icon:Ct},{analyticsKey:"github.contributions",message:ct.contributions,icon:Ct},{analyticsKey:"github.cluster_issues",message:ct.clusterIssues,icon:Ct}];if(n)return r.map((e=>({...e,type:"action",id:"connector-upsell"})));{const e={type:"search",scopeForNextSearch:{type:"github"}},n=(0,Te().Ol)({spaceStore:t,config:e})??e;return r.map((e=>({...e,type:"prompt",config:n})))}},google_drive:function(e){const{spaceStore:t,isConnectorInProgress:n}=e,r=[{analyticsKey:"google_drive.outline_insights",message:lt.outlineInsights,icon:Mt},{analyticsKey:"google_drive.common_themes",message:lt.commonThemesInTeamPresentations,icon:Mt},{analyticsKey:"google_drive.summarize_key_usage",message:lt.summarizeKeyUsage,icon:Mt},{analyticsKey:"google_drive.most_edited_documents",message:lt.mostEditedDocuments,icon:Mt},{analyticsKey:"google_drive.open_questions",message:lt.openQuestions,icon:Mt},{analyticsKey:"google_drive.summarize_user_research",message:lt.summarizeUserResearch,icon:Mt}];if(n)return r.map((e=>({...e,type:"action",id:"connector-upsell"})));{const e={type:"search",scopeForNextSearch:{type:"google-drive"}},n=(0,Te().Ol)({spaceStore:t,config:e})??e;return r.map((e=>({...e,type:"prompt",config:n})))}}};var Tt=()=>n(108797),At=()=>n(206799),jt=()=>n(204066),Pt=()=>n(119148),Kt=()=>n(602690);const _t=12,Ft=168;function Et(){return Ft}const Bt=108,Nt=40;function Wt(){return Bt}function Dt(e){const{suggestion:t,clientStore:n,aiChatFeatureController:i}=e,l=(0,o().v3)(),d=(0,h().tz)(),p=(0,s().O$)(z().AppStoreCurrentSpaceStore),u=(0,G()._X)({name:"ai_connectors",spaceId:null==p?void 0:p.id,userId:l.currentUser.id}),g=(0,r.useCallback)((()=>{if(n)if("prompt"===t.type)(0,Pt().Iu)({environment:l,query:[[d.formatMessage(t.message)]],clientStore:n,config:t.config,suggestedPrompt:{promptKey:t.analyticsKey,promptDescription:t.message.defaultMessage},surface:i.contextStepSurface});else if("action"===t.type)if("connector-upsell"===t.id)(0,v().p)({environment:l,connector:"generic",analyticsFrom:"ai_full_page_welcome_connector_action_card",connectorsFeatureAvailability:u});else if("in-progress-connector"===t.id)(0,Tt().openConnectorInProgressModal)({environment:l,from:"ai_chat_in_progress_connector_prompt_suggestion",connector:t.connector});else if("setup-generator"===t.id){if(!p)return;(0,X().openSelectedTemplateOnboardingModalForInAppFlows)({parentStore:p,template:c().XK,environment:l,aiPrompt:(0,m().x9d)(d.formatMessage(t.prompt)),origin:"ai_chat",version:"build_with_ai",autoSubmit:!0})}else(0,ue().HB)(t);else(0,ue().HB)(t)}),[l,n,p,d,t,u,i]),y=Wt(),S=Et(),b=y===Nt,x=(0,a().IS)((e=>({container:{width:S,height:y,display:"flex",flexDirection:"column",padding:"8px 12px",...b&&{flexDirection:"row-reverse",alignItems:"center",gap:8,width:"fit-content"}},message:{fontWeight:500,flexGrow:1,...b?{...f().RC,fontSize:"12px"}:{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}}})),[y,S,b]),k="dark"===(0,a().eP)(),w=(0,r.useMemo)((()=>{if("icon"===t.icon.type)return(0,ae.jsx)(At().Q,{iconGroup:t.icon.iconGroup,variantName:"default",colorName:t.icon.color});if("logo"===t.icon.type)return(0,ae.jsx)(At().Q,{iconGroup:t.icon.icon,variantName:k?"darkMode":"default"});if("custom"===t.icon.type){if("connector-bubbles"===t.icon.key)return(0,ae.jsx)(Kt().hC,{connectors:["slack","github","google_drive"],maxBubbles:3,iconSize:12});(0,ue().HB)(t.icon.key)}}),[t.icon,k]);return(0,ae.jsx)(jt().A,{innerStyle:x.container,href:void 0,metaHref:void 0,borderRadiusVariant:b?"rounded":"large",onClick:g,children:(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:x.message,children:(0,ae.jsx)(h().sA,{...t.message})}),w]})})}const Rt=6,Ot=18;function zt(e){const{clientStore:t,isVisible:n,aiChatFeatureController:r}=e,o=gt({clientStore:t}),s=Wt(),a=Et();return(0,ae.jsx)(re().A,{visible:!0,initial:{opacity:0,height:0},animate:{opacity:n?1:0,height:n?s:0,visibility:n?"visible":"hidden"},exit:{opacity:0,height:0},config:{duration:500},children:(0,ae.jsx)(Re().A,{cardWidth:a,gapSizeOverride:_t,containerStyle:{paddingTop:Rt,marginTop:Ot},children:o.map(((e,n)=>(0,ae.jsx)(Dt,{suggestion:e,clientStore:t,aiChatFeatureController:r},`${e.message.id}-${n}`)))})})}var Ht=()=>n(9196),Ut=()=>n(943172),Gt=()=>n(158195),Lt=()=>n(625952);const Vt="ai-chat-input-and-suggestion-container";function qt(e){const{aiChatFeature:t,threadStore:n,config:d,onAfterThreadChange:p,defaultUserMessage:u,clientStore:h,parentStore:f,onLoaded:S}=e,w=(0,J().K)(t),[C,M]=(0,r.useState)();(0,r.useEffect)((()=>{M(n)}),[n]);const I=(0,o().v3)(),T=(0,s().K8)((()=>(null==h?void 0:h.state.showDebug)??!1),[h]),{store:A,setValue:j}=(0,E().AI)({initialValue:(0,m().x9d)(u)});(0,R().i)({textStore:A,initialFocus:w.shouldHaveInitialFocusOnInput});const P=(0,r.useRef)(null),K=(0,r.useRef)(0),[W,H]=(0,r.useState)(!0),[V,Q]=(0,r.useState)(!0),te=(0,s().K8)((()=>w.isInSidebarMode||!(0,Fe().a)(C)),[w.isInSidebarMode,C]),ne=(0,s().K8)((()=>w.showWelcomeMessage&&(0,Fe().a)(C)),[w.showWelcomeMessage,C]),re=(0,s().K8)((()=>{if(!C||(0,Fe().a)(C))return;const e=C.getTranscript().reverse().find((e=>"config"===e.type));return null==e?void 0:e.value.type}),[C]),oe=(0,a().IS)((e=>({columnContainer:{minHeight:0,...!te&&{minHeight:void 0}},chatColumn:{flex:1,display:"flex",flexDirection:"column",minHeight:0,maxWidth:"100%",...!te&&{justifyContent:"center",minHeight:void 0}},contentWrapper:{flex:1,scrollbarGutter:"stable",overflowY:"auto",position:"relative",...!te&&{flex:"0 1 auto"}},contentContainer:{margin:"0 auto",width:"100%",maxWidth:710,padding:20,marginLeft:"auto"},inputWrapper:{flex:"0 0 auto",position:"relative",backgroundColor:e.contentBackground,padding:w.chatInputWrapperPadding},fullPageWelcomeContainer:{textAlign:"center",marginBottom:24,display:"flex",flexDirection:"column",alignItems:"center"},scrollToBottomButton:{position:"absolute",left:"50%",bottom:"100%",transform:"translate(-50%, -8px)",zIndex:2,padding:8,borderRadius:20,backgroundColor:"dark"===e.mode?"#fff":"#000",border:"none",cursor:"pointer",fontWeight:500,boxShadow:"dark"===e.mode?`0px 0px 0px 0.5px ${e.stroke.primary}, 0px 1px 2px 0px rgba(0, 0, 0, 0.12), 0px 4px 16px -2px rgba(0, 0, 0, 0.6)`:`0px 0px 0px 0.5px ${e.stroke.primary}, 0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 4px 16px -2px rgba(0, 0, 0, 0.1)`,transition:"opacity 150ms ease-out, transform 150ms ease-out",opacity:0,pointerEvents:"none"},scrollToBottomButtonVisible:{opacity:1,transform:"translate(-50%, -16px)",pointerEvents:"auto"},inputContainer:{margin:"0 auto",width:"100%",maxWidth:w.chatInputWidth,padding:w.chatInputPadding,marginLeft:"auto"},gradientMask:{width:"100%",height:w.isInWorkflowEditor?32:44,pointerEvents:"none",position:"absolute",bottom:"100%",background:`linear-gradient(to bottom, rgba(255, 255, 255, 0), ${e.contentBackground})`},chevronDownIcon:{width:20,height:20,fill:"dark"===e.mode?"#000":e.white,transform:"translateY(1px)"},overflowContainer:{overflowY:"auto",width:"100%",...!te&&{overflowY:void 0}}})),[te,w]),se=(0,r.useCallback)((()=>{const e=P.current;if(!e)return;const t=e.scrollTop,n=t-K.current<0,r=e.scrollHeight-e.scrollTop-e.clientHeight<50;K.current=t,H(r),n&&!r&&V&&Q(!1),"search"!==re&&r&&!V&&Q(!0)}),[V,re]);(0,r.useEffect)((()=>{const e=P.current;if(!e)return;e.addEventListener("scroll",se);const t=new MutationObserver((()=>{V&&(e.scrollTop=e.scrollHeight),setTimeout(se,100)}));return t.observe(e,{childList:!0,subtree:!0,characterData:!0}),setTimeout(se,100),()=>{e.removeEventListener("scroll",se),t.disconnect()}}),[se,V]),(0,r.useEffect)((()=>{const e=P.current;if(!e)return;if("search"===re)return void Q(!1);const t=setTimeout((()=>{e.scrollTop=e.scrollHeight,Q(!0)}),100);return()=>clearTimeout(t)}),[re]);const ce=(0,r.useCallback)((()=>{const e=P.current;e&&B().VG({element:e,environment:I,options:{top:e.scrollHeight,behavior:"smooth"}})}),[I]),le=(0,r.useCallback)((()=>{ce(),Q(!0)}),[ce]),de=(0,s().O$)(z().AppStoreMainEditorCurrentBlockStore),pe=(0,Gt().q)({threadStore:C,clientAiChatStore:h,setThreadStore:M,aiChatFeatureController:w,config:d}),ue=(0,r.useCallback)((async e=>{if(await(0,b().closeAssistantRightHandSideMenu)({environment:I}),h.setState({...h.state,userSelectedConfig:!0}),!e||0===e.length)return;if(!f)throw new Error("No parent store");const t=z().default.state.currentSpaceStore;if(!t)throw new Error("No current space");const n=z().default.state.currentSpaceViewStore;if(!n)throw new Error("No current space view");const r=z().default.state.currentUserStore;if(!r)throw new Error("No current user");j(void 0);let o=O().d.state.featureAvailability;if(!o){const{pfaFeatureLoadArgs:e}=(0,v().L)({clientStore:h,spaceId:t.id,userId:r.id});o=await(0,G().Bw)(I,e)}if(!(0,g().e2)(o))return void O().d.setState({...O().d.state,inlineUsageErrorVisible:!0});const s=(null==pe?void 0:pe.threadStore)??C,a=((null==s?void 0:s.getTranscript())||[]).find((e=>"search"===e.type));s&&a&&void 0===a.showResults&&(0,Z().V)({environment:I,threadStore:s,stepId:a.id,showResults:!1,traceId:a.traceId});const i=(0,ee().Kf)({environment:I,spaceStore:t,userStore:r,value:e}),l=null==s?void 0:s.getTranscript().findLast((e=>"context"===e.type)),u=d??h.state.configForNewTranscripts;if("setup-generator"===u.type)return void(0,X().openSelectedTemplateOnboardingModalForInAppFlows)({parentStore:t,template:c().XK,environment:I,aiPrompt:e,origin:"ai_chat",version:"build_with_ai",autoSubmit:!0});const m=n=>{if("researcher"===u.type){const r=(0,F().r4)(e,t),o=r.length,s=r.split(/\s+/).filter(Boolean).length;y().uH({environment:I,researchModeThreadId:n.id,queryLength:o,queryWords:s,searchSessionId:void 0,qnaSessionId:void 0,source:"welcome_page"})}};if(s){var S;const e=[],o=null===(S=h.getOrCreateClientAIChatThreadStore(s.id))||void 0===S?void 0:S.getAndClearStagedAssistantAttachmentSteps();if(o&&e.push(...o),(0,Fe().a)(s)){const o=(0,ee().Xd)({environment:I,spaceStore:t,userStore:r,config:u,addSteps:[...e,i],blockStore:z().default.state.mainEditorCurrentBlockStore,spaceViewStore:n,surface:w.contextStepSurface});return(0,L().addStepsToExistingThreadAndRun)({environment:I,spaceStore:t,userStore:r,threadStore:s,addSteps:o,waitForServerCommit:!0}),m(s),void p(s)}const a=[];((null==l?void 0:l.value.collectionViewBlockId)??(null==l?void 0:l.value.blockId))!==(null==de?void 0:de.id)&&a.push((0,ee().WM)({environment:I,userStore:r,spaceStore:t,spaceViewStore:n,blockStore:de,surface:w.contextStepSurface})),o&&a.push(...o),a.push(i),(0,L().addStepsToExistingThreadAndRun)({environment:I,spaceStore:t,userStore:r,threadStore:s,addSteps:a,waitForServerCommit:!0}),ce()}else if("workflow"===u.type&&null!=de&&de.isCollectionView()){const e=(0,$().Y$)({environment:I,store:de,spaceStore:t,userStore:r,addSteps:[i],spaceViewStore:n}),o=(0,L().addTranscriptToNewThreadAndRun)({environment:I,spaceStore:t,transcript:e,blockId:de.id});p(o)}else{const e=(0,ee().Xd)({environment:I,spaceStore:t,userStore:r,config:u,addSteps:[i],blockStore:z().default.state.mainEditorCurrentBlockStore,spaceViewStore:n,surface:w.contextStepSurface}),o=(0,L().addTranscriptToNewThreadAndRun)({environment:I,spaceStore:t,transcript:e});m(o),p(o)}}),[I,h,f,j,null==pe?void 0:pe.threadStore,C,de,ce,d,p,w]),ge=(0,s().K8)((()=>(0,Fe().a)(C)&&!e.config),[e.config,C]),me=(0,r.useCallback)((e=>{const{transcript:t,threadId:n}=e;return(0,D().dC)(t)?T?(0,D().BI)({transcript:t,threadId:n}):(0,D().an)({transcript:t,threadId:n,preserveNonResearcherSteps:!0}):(0,i().q1)(t)&&!T?(0,q().SU)(t):t}),[T]),[he,fe]=(0,r.useState)(!1),ye=(0,s().K8)((()=>!w.supportsExpandingSuggestions||he),[w.supportsExpandingSuggestions,he]);(0,r.useEffect)((()=>{w.supportsExpandingSuggestions&&(ye?U().m.setState({type:"hidden"}):"hidden"===U().m.state.type&&U().m.setState({type:"visible"}))}),[ye,w.supportsExpandingSuggestions]);const Se=(0,s().K8)((()=>(0,Y().Ke)()),[]);return(0,r.useEffect)((()=>{function e(e){var t;(t=e.target)instanceof Element&&t.closest(`.${Vt}`)?fe(!0):function(e){return!!(e instanceof Element&&e.closest(`.${_().H1c}`))}(e.target)||fe(!1)}return window.addEventListener("click",e,!0),()=>{window.removeEventListener("click",e,!0)}}),[]),(0,ae.jsxs)(ae.Fragment,{children:[w.supportsChatHeader&&(0,ae.jsx)(Yt,{aiChatFeatureController:w,threadStore:C,clientStore:h,onThreadChange:p,parentStore:f}),(0,ae.jsx)(k().Y1,{height:"fill",direction:"vertical",children:(0,ae.jsxs)(k().Y1,{height:"fill",direction:"horizontal",style:oe.columnContainer,children:[w.supportsCollapsiblePanel&&Se?(0,ae.jsx)(x().z,{isOpen:T,width:{size:515,speed:"animate"},isResizable:!0,anchorToSide:"left",minSize:300,maxSize:900,children:(0,ae.jsx)(Ut().m,{clientStore:h,threadStore:C})}):null,(0,ae.jsx)(k().Y1,{height:"fill",direction:"vertical",style:oe.overflowContainer,children:(0,ae.jsx)("div",{style:oe.chatColumn,children:te?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:oe.contentWrapper,ref:P,children:(0,ae.jsxs)("div",{style:oe.contentContainer,children:[(0,ae.jsx)(Ht().Lm,{clientStore:h,config:d,threadStore:C,preprocessTranscript:me,aiChatFeatureController:w}),(0,ae.jsx)(Lt().Qd,{clientStore:h,threadStore:C})]})}),(0,ae.jsxs)("div",{style:oe.inputWrapper,children:[(0,ae.jsx)("button",{onClick:le,style:{...oe.scrollToBottomButton,...!W&&oe.scrollToBottomButtonVisible},children:(0,l().arrowChevronSingleDownFillIcon)(oe.chevronDownIcon)}),(0,ae.jsx)("div",{style:oe.gradientMask}),(0,ae.jsx)("div",{style:oe.inputContainer,children:(0,ae.jsx)(Be,{onThreadChange:p,store:A,onSubmit:ue,clientStore:h,threadStore:C,showInitialModePicker:ge,aiChatFeatureController:w,config:d,loadAttachmentsData:pe,onLoaded:S})})]})]}):(0,ae.jsxs)("div",{style:oe.inputWrapper,children:[ne&&(0,ae.jsx)("div",{style:oe.fullPageWelcomeContainer,children:(0,ae.jsx)(N().L,{clientStore:h,marginTop:0,marginHorizontal:0,allPanelsLoaded:!0,showWelcomeAnimation:!1})}),(0,ae.jsxs)("div",{className:Vt,style:oe.inputContainer,children:[(0,ae.jsx)(Be,{onThreadChange:p,store:A,onSubmit:ue,clientStore:h,threadStore:C,showInitialModePicker:ge,aiChatFeatureController:w,config:d,loadAttachmentsData:pe,onLoaded:S}),(0,ae.jsx)(ie,{shouldRender:he,setShouldRender:fe,clientStore:h}),ge&&w.supportsSuggestions&&(0,ae.jsx)(zt,{clientStore:h,isVisible:ye,aiChatFeatureController:w})]})]})})})]})})]})}function Yt(e){const{aiChatFeatureController:t,onThreadChange:n,clientStore:i,threadStore:c,parentStore:l}=e,d=(0,o().v3)(),p=(0,r.useContext)(K().eh),u=(0,s().O$)(H().b),g=(0,r.useCallback)((e=>{(0,Q().Wq)({environment:d,clientStore:i}),n(e)}),[i,n,d]),m=(0,P().m)({location:"AIChat"}),y=(0,s().K8)((()=>{var e;const t=null==c||null===(e=c.getData())||void 0===e?void 0:e.title;return t&&0!==t.length?t:(0,ae.jsx)(h().sA,{id:"aiInferenceTranscript.chat.untitled",defaultMessage:"Ask AI"})}),[c]),S=(0,a().IS)((()=>({leftContainer:{display:"flex",alignItems:"center",gap:8},threadTitle:{maxWidth:280,...f().RC}})),[]),v=d.device.isElectron&&!u;return(0,ae.jsx)("div",{className:v?_().sbV:void 0,children:(0,ae.jsx)(j().W,{store:l,topbarFeatureController:m,isInvalidPage:!1,renderLeft:()=>t.supportsThreadHistoryPicker?(0,ae.jsx)(V().X,{threadStore:c,onThreadChange:g,parentStore:l}):(0,ae.jsxs)("div",{style:S.leftContainer,children:[(0,ae.jsx)(W().n,{}),(0,ae.jsx)(I().D,{style:S.threadTitle,styleName:"Body-14px/Regular",children:y})]}),renderRight:()=>(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Qt,{onNewChat:()=>g(void 0)}),(0,ae.jsx)($t,{threadStore:c}),(0,ae.jsx)(Xt,{clientStore:i}),p?(0,ae.jsx)(T().A,{size:"lg",onClick:p,children:(0,ae.jsx)(h().sA,{id:"chatSidebar.close",defaultMessage:"Close"})}):null]})})})}function $t(e){const{threadStore:t}=e,n=(0,o().v3)(),c=(0,h().tz)(),l=(0,s().K8)((()=>{var e;return(null==t||null===(e=t.getData())||void 0===e?void 0:e.shared_with_space)??!1}),[t]),d=(0,r.useCallback)((()=>{t&&!(0,Fe().a)(t)&&S().createAndCommit({userAction:"AIChatHeader.toggleShareWithSpace",environment:n,canUndo:!0,perform:e=>{(0,Q().g6)({threadStore:t,transaction:e})}})}),[t,n]),p=(0,a().IS)((e=>({iconButton:{width:28,height:28},iconButtonIcon:{width:16,height:16,fill:l?e.icon.bluePrimary:e.icon.secondary}})),[l]),g=(0,s().K8)((()=>t&&!t.canEdit()),[t]);return(0,s().K8)((()=>(0,i().q1)((null==t?void 0:t.getTranscript())??[])),[t])?(0,ae.jsx)(A().A,{renderTooltip:()=>(0,ae.jsx)("span",{children:"Share with workspace"}),render:e=>(0,ae.jsx)(C().A,{...e,icon:u().N,iconStyle:p.iconButtonIcon,style:p.iconButton,onClick:d,disabled:g,ariaLabel:c.formatMessage({id:"aiChatView.shareWithSpace",defaultMessage:"Share with workspace"})})}):null}function Xt(e){const t=(0,h().tz)(),{clientStore:n}=e,o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a().IS)((t=>({iconButton:{width:28,height:28},iconButtonIcon:{width:16,height:16,fill:e.active?t.icon.uiBluePrimary:t.icon.secondary}})),[e.active])}({active:(0,s().K8)((()=>n.state.showDebug),[n])}),i=(0,r.useCallback)((()=>{n.setState({...n.state,showDebug:!n.state.showDebug})}),[n]);return(0,s().K8)((()=>(0,Y().Ke)()),[])?(0,ae.jsx)(A().A,{renderTooltip:()=>(0,ae.jsx)("span",{children:"Debug"}),render:e=>(0,ae.jsx)(C().A,{...e,icon:p().E,iconStyle:o.iconButtonIcon,style:o.iconButton,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.debug",defaultMessage:"Debug"}),onClick:i})}):null}function Qt(e){let{onNewChat:t}=e;const n=(0,h().tz)(),r=(0,a().IS)((()=>({button:{gap:8}})),[]),o=n.formatMessage({id:"aiInferenceTranscript.newChat",defaultMessage:"New chat"});return(0,ae.jsx)(w().p,{style:r.button,icon:()=>(0,ae.jsx)(M().I,{size:"default",icon:d().i}),ariaLabel:o,onClick:t,children:o})}},357307:(e,t,n)=>{n.d(t,{X:()=>M});n(362833),n(725707),n(771702),n(403517),n(244387);var r=n(242343),o=()=>n(803290),s=()=>n(174114),a=()=>n(633427),i=()=>n(726646),c=()=>n(934889),l=()=>n(905184),d=()=>n(653998),p=()=>n(77551),u=()=>n(209684),g=()=>n(535906),m=()=>n(273520),h=()=>n(966789),f=()=>n(935091),y=()=>n(858023),S=()=>n(701270),v=()=>n(88271),b=()=>n(640979),x=()=>n(485966),k=()=>n(413871),w=n(163643);const C=(0,d().YK)({untitled_search:{id:"WorkflowEditorTranscript.historyDropdown.untitledSearchTitle",defaultMessage:"Untitled Search"},new_chat_title:{id:"WorkflowEditorTranscript.historyDropdown.newChatTitle",defaultMessage:"New chat"}});function M(e){const{threadStore:t,onThreadChange:n,parentStore:M}=e,I=(0,d().tz)(),T=(0,o().K8)((()=>{var e;const n=null==t||null===(e=t.getData())||void 0===e?void 0:e.title;return n||I.formatMessage(C.untitled_search)}),[I,t]),A=Boolean(t),j=(0,s().IS)((e=>({checkIcon:{width:14},chevronDownIcon:{width:16,marginLeft:6,fill:e.mediumIconColor,flexShrink:0},loadingStateContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",gap:8,padding:32},clockIcon:{width:24,opacity:.2},threadTitleButton:{flexShrink:1,paddingRight:6},threadTitleInDropdown:{maxWidth:"250px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",flexShrink:1}})),[]),{status:P,value:K}=(0,p().s)({parentStore:M,threadStore:t}),_=(0,r.useCallback)((()=>(0,w.jsx)("div",{style:j.loadingStateContainer,children:(0,w.jsx)(h().A,{})})),[j.loadingStateContainer]),F=(0,r.useCallback)((()=>(0,w.jsx)("div",{style:j.loadingStateContainer,children:(0,c().clockIcon)(j.clockIcon)})),[j.loadingStateContainer,j.clockIcon]),E=(0,r.useCallback)((e=>{if("pending"===P)return[{key:"loading",render:e=>(0,w.jsx)(v().A,{...e,title:"Previous chats",shouldShowBottomDivider:!1}),items:[{key:"loading-item",action:()=>{},render:()=>(0,w.jsx)(_,{})}]}];if(!K||0===K.length)return[{key:"empty",render:e=>(0,w.jsx)(v().A,{...e,title:"Previous chats"}),items:[{key:"empty-item",action:()=>{},render:()=>(0,w.jsx)(F,{})}]}];const r=[];let o=!1;null!=t&&t.id&&(o=!0,r.push({key:"new",render:e=>(0,w.jsx)(v().A,{...e,shouldShowBottomDivider:!1}),items:[{key:"new-item",action:()=>{n(void 0),e.close()},render:e=>(0,w.jsx)(g().A,{...e,title:"New chat"})}]}));const s=K.reduce(((e,t)=>{const n=new Date(t.created_at),r=new Date;r.setHours(0,0,0,0);const o=new Date(r);o.setDate(o.getDate()-1);const s=new Date(r);s.setDate(s.getDate()-7);const a=new Date(r);let i;return a.setDate(a.getDate()-30),i=n>=r?"today":n>=o?"yesterday":n>=s?"previous7days":n>=a?"previous30days":"older",e[i]||(e[i]=[]),e[i].push(t),e}),{});return[{key:"today",label:I.formatMessage({id:"aiInferenceTranscript.today",defaultMessage:"Today"})},{key:"yesterday",label:I.formatMessage({id:"aiInferenceTranscript.yesterday",defaultMessage:"Yesterday"})},{key:"previous7days",label:I.formatMessage({id:"aiInferenceTranscript.previous7days",defaultMessage:"Previous 7 days"})},{key:"previous30days",label:I.formatMessage({id:"aiInferenceTranscript.previous30days",defaultMessage:"Previous 30 days"})},{key:"older",label:I.formatMessage({id:"aiInferenceTranscript.older",defaultMessage:"Older"})}].forEach((a=>{let{key:c,label:d}=a;const p=s[c];if(null==p||!p.length)return;const u=o;o=!1,r.push({key:`history-${c}`,render:e=>(0,w.jsx)(v().A,{...e,title:d,topBorder:u}),items:p.map((r=>({key:r.id,action:()=>{const t=x().default.state.currentSpaceStore;if(!t)return;const o=k().Ei.createChildStore(t,{table:l().To,id:r.id,spaceId:t.id});n(o),e.close()},render:e=>(0,w.jsx)(g().A,{...e,title:r.title||I.formatMessage(C.untitled_search),right:(null==t?void 0:t.id)===r.id?(0,i().checkmarkFillIcon)(j.checkIcon):void 0})})))})})),r}),[P,K,t,_,F,j.checkIcon,n,I]);return(0,w.jsx)(m().Ay,{popupType:m().z7.Popup,placementToOrigin:m().sx.Bottom,alignmentToOrigin:m().yP.Start,renderOrigin:e=>(0,w.jsxs)(u().p,{"aria-label":"history",...e,size:"md",style:j.threadTitleButton,children:[(0,w.jsx)(S().D,{styleName:"UIRegular-14px/Medium",style:j.threadTitleInDropdown,children:A?T:I.formatMessage(C.new_chat_title)}),(0,w.jsx)(w.Fragment,{children:(0,a().arrowChevronSingleDownIcon)(j.chevronDownIcon)})]}),render:e=>(0,w.jsx)(f().A,{menuType:b().gu.Popup,width:300,children:(0,w.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:0,sections:E(e)})})})}},418699:(e,t,n)=>{n.d(t,{E:()=>o});n(242343);var r=n(163643);const o=(0,n(680369).wt)("bug",{viewBox:"0 0 64 64",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"m32,8c-5.55,0-9,3.83-9,10h18c0-6.17-3.45-10-9-10Z"}),(0,r.jsx)("path",{d:"m48,36h12v-4h-12v-6.01c2.74-.06,4.78-.94,6.76-2.92l4.24-4.24-2.83-2.83-4.24,4.24c-1.3,1.3-2.41,1.76-4.24,1.76h-13.69v32c6.15,0,10.63-3.12,12.7-8.47l1.54,1.54c1.3,1.3,1.76,2.41,1.76,4.24v2.69h4v-2.69c0-2.9-.88-5.02-2.93-7.07l-3.26-3.26c.12-.95.19-1.94.19-2.98v-2Z"}),(0,r.jsx)("path",{d:"m12.07,20.24l-4.24-4.24-2.83,2.83,4.24,4.24c1.98,1.98,4.02,2.85,6.76,2.92v6.01H4v4h12v2c0,1.04.07,2.03.19,2.98l-3.26,3.26c-2.05,2.05-2.93,4.17-2.93,7.07v2.69h4v-2.69c0-1.83.46-2.95,1.76-4.24l1.54-1.54c2.08,5.35,6.55,8.47,12.7,8.47V22h-13.69c-1.83,0-2.95-.46-4.24-1.76Z"})]})})},425021:(e,t,n)=>{n.d(t,{d:()=>o});class r extends(()=>n(129044))().default{getInitialState(){return{inlineUsageErrorVisible:!1,featureAvailability:void 0}}}const o=new r;n(996094).exposeDebugValue("AiChatInlineUsageErrorStore",o)},475426:(e,t,n)=>{n.d(t,{i:()=>s});var r=n(242343),o=()=>n(384221);function s(e){const{textStore:t,initialFocus:n}=e,s=(0,r.useCallback)((()=>{o().setSelectionAtEnd({store:t})}),[t]);return(0,r.useEffect)((()=>{n&&s()}),[n,s]),s}},602129:(e,t,n)=>{n.d(t,{L:()=>U});var r=()=>n(486826),o=n(242343),s=()=>n(237385),a=()=>n(803290),i=()=>n(174114),c=()=>n(34662),l=()=>n(653998),d=()=>n(76394),p=()=>n(31448);const u=n.p+"4981305213d3ccf3.gif",g=n.p+"a1ccf6d6c898434a.gif",m=n.p+"37cd1c7cdce6731b.gif";var h=n(163643);const f=(0,l().YK)({altText:{id:"aiChatModeGifFace.altText",defaultMessage:"Notion AI animated face"}}),y=40;function S(e){const{configType:t}=e,n=(0,l().tz)();let r;return r="researcher"===t?m:"setup-generator"===t?g:u,(0,h.jsx)("img",{src:r,style:{width:y,height:y},alt:n.formatMessage(f.altText)})}var v=()=>n(485966),b=()=>n(647101),x=()=>n(209684),k=()=>n(907721),w=()=>n(448316),C=()=>n(384221),M=()=>n(84543);class I extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const T=new I;function A(e){let{environment:t}=e;T.reset(),C().clear({environment:t})}var j=()=>n(935091),P=()=>n(35462),K=()=>n(636045),_=()=>n(868199),F=()=>n(640979),E=()=>n(622163),B=()=>n(466321);function N(e){let{origin:t}=e;const r=(0,s().v3)(),o=(0,a().K8)((()=>T.state.open),[]),i=(0,a().K8)((()=>v().default.state.currentUserSettingsStore),[]),c=(0,s().WS)();return i?(0,h.jsx)(n(443252).Ay,{popupType:c?B().n.SlideUp:B().n.Popup,open:o,origin:t,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,originGap:4,onDismiss:()=>A({environment:r}),render:()=>(0,h.jsx)(W,{userSettingsStore:i})}):null}function W(e){let{userSettingsStore:t}=e;const[n,r]=(0,o.useState)(!1),c=(0,s().v3)(),d=(0,l().tz)(),p=(0,a().K8)((()=>{var e;return null===(e=v().default.state.currentUserStore)||void 0===e?void 0:e.getDisplayName(d)}),[d]),u=(0,s().WS)(),g=(0,o.useCallback)((()=>r(!0)),[]),m=(0,o.useCallback)((()=>r(!1)),[]),f=(0,o.useCallback)((()=>A({environment:c})),[c]),y=(0,o.useCallback)((()=>function(e){let{environment:t}=e;const n=T.state;if(!n.open)return;const r=n.originalNickname;A({environment:t});const{currentUserSettingsStore:o}=v().default.state;if(!o)return;const s=o.getNicknameStore();M().createAndCommit({environment:t,userAction:"nicknameMenuActions.revertToOldNickname",canUndo:!0,perform:e=>{w().R9({environment:t,store:s,value:r,transaction:e})}})}({environment:c})),[c]),S=(0,i().IS)((e=>({menuContainer:{paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14},inputContainer:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:(0,E().ny)(c,"UIRegular")},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",width:"100%",borderRadius:4,boxShadow:n?e.outlineBlueInputBoxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative",marginTop:8,paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10}})),[c,n]),b=(0,a().K8)((()=>t.getSettingsStore().getKeyStore("nickname")),[t]);let x;return x=u?{menuType:F().gu.ActionSheet}:{menuType:F().gu.Popup,width:300},(0,h.jsx)(j().A,{...x,children:(0,h.jsxs)("div",{style:S.menuContainer,children:[(0,h.jsx)(P().A,{isSecondaryColor:!0,children:(0,h.jsx)(l().sA,{id:"personalHomeRenamePopup.title",defaultMessage:"Edit nickname"})}),(0,h.jsx)("div",{style:S.inputContainer,children:(0,h.jsx)(K().A,{style:S.input,store:b,disabled:!1,onEsc:y,onFocus:g,onBlur:m,onEnter:f,placeholder:p,pasteBehavior:"inline",disableEmojiCommands:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableSlashCommands:!0,disableComment:!0,disableMentions:!0,disableDrag:!0,disableEmbedMenu:!0,disableEquationInteraction:!0,disableMobileActionBar:!0,disableShiftEnter:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,inPageFind:_().Os.none})})]})})}const D=o.memo(N);function R(e){var t;let{nickname:r}=e;const d=(0,s().v3)(),u=(0,i().DP)(),g=o.useRef(null),m=o.useRef();m.current=null===(t=g.current)||void 0===t?void 0:t.getBoundingClientRect();const f=(0,a().K8)((()=>T.state.open),[]),y=(0,a().K8)((()=>{var e;return null===(e=v().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getNicknameStore()}),[]),S=(0,a().K8)((()=>{var e;const t=v().default.state.currentUserSettingsStore,o=null===(e=v().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(t&&o)return(0,n(654548).S5)({environment:d,textValue:r&&o?{value:r,spaceId:o}:void 0,parentStore:t,disableLinks:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,theme:u,emojiType:(0,n(441165).FN)(d),katex:void 0,formulaValueTypes:[],stopLinkPropagation:!0})}),[d,r,u]),w=(0,o.useMemo)((()=>({height:"100%",flexShrink:1,fontSize:"inherit",fontWeight:"inherit",display:"flow",paddingTop:2,paddingBottom:2,marginLeft:-6,marginRight:-6,marginTop:-2,marginBottom:2,paddingLeft:6,paddingRight:6,...p().RC,color:void 0,lineHeight:void 0})),[]),M=(0,i().IS)((()=>({hiddenButton:{...w,width:0,overflow:void 0,pointerEvents:"none",color:"transparent",marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0},visibleButton:{...w,textShadow:"none"}})),[w]);return y?(0,h.jsx)(D,{origin:(0,h.jsx)(n(103151).A,{originRect:m.current,placement:k().W.Bottom,render:e=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x().p,{hovered:!1,style:M.hiddenButton,children:S}),(0,h.jsx)(x().p,{...e,ref:g,hovered:f,style:M.visibleButton,onClick:()=>function(e){let{originalNicknameStore:t}=e;C().setSelection({store:t,selection:{startIndex:0,endIndex:(0,c().qAZ)(t.getValue()).length}}),T.setState({open:!0,originalNickname:t.getValue()})}({originalNicknameStore:y}),onMouseEnter:t=>{var n;null===(n=e.onMouseEnter)||void 0===n||n.call(e,t),b().A.setState({isHovered:!1})},children:S})]}),renderTooltip:()=>(0,h.jsx)(l().sA,{id:"personalHomeHeader.changeNameTooltip",defaultMessage:"Edit nickname"})})}):null}const O=o.memo(R);function z(e){let{marginTop:t,marginHorizontal:c,allPanelsLoaded:u,showWelcomeAnimation:g,clientStore:m}=e;const[f,y]=o.useState(!1),x=(0,l().tz)(),k=(0,s().WS)(),w=(0,n(456143).w)(),C=(0,a().K8)((()=>{var e;return null===(e=m.state.configForNewTranscripts)||void 0===e?void 0:e.type}),[m]),{name:M,loaded:I}=(0,a().K8)((()=>function(e){let{currentUserStore:t,currentUserSettingsStore:n,intl:r}=e;if(null==n||!n.isReady())return{name:void 0,loaded:!1};const o=n.getNickname();if(o&&H(o))return{name:o,loaded:!0};const s=null==t?void 0:t.getDisplayName(r),a=Boolean(null==t?void 0:t.isReady());return{name:s?[[s]]:void 0,loaded:a}}({currentUserStore:v().default.state.currentUserStore,currentUserSettingsStore:v().default.state.currentUserSettingsStore,intl:x})),[x]),T=(0,a().K8)((()=>{var e;return(null===(e=v().default.state.currentSpaceStore)||void 0===e?void 0:e.isReady())??!1}),[]);(0,o.useEffect)((()=>{const e=setTimeout((()=>{g&&!f&&y(!0)}),500);return()=>{clearTimeout(e)}}),[f,g]);const A=I&&T,j=function(e){let{timeOfDay:t,name:n}=e;if("morning"===t)return n?(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodMorningUserName",defaultMessage:"<NoShrink>Good morning,</NoShrink>{nbsp}{userName}",values:{nbsp:(0,h.jsx)(h.Fragment,{children:"Â "}),NoShrink:e=>(0,h.jsx)("span",{style:{flexShrink:0},children:e}),userName:n}}):(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodMorningNoUserName",defaultMessage:"Good morning"});if("afternoon"===t)return n?(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodAfternoonUserName",defaultMessage:"<NoShrink>Good afternoon,</NoShrink>{nbsp}{userName}",values:{nbsp:(0,h.jsx)(h.Fragment,{children:"Â "}),NoShrink:e=>(0,h.jsx)("span",{style:{flexShrink:0},children:e}),userName:n}}):(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodAfternoonNoUserName",defaultMessage:"Good afternoon"});if("evening"===t)return n?(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodEveningUserName",defaultMessage:"<NoShrink>Good evening,</NoShrink>{nbsp}{userName}",values:{nbsp:(0,h.jsx)(h.Fragment,{children:"Â "}),NoShrink:e=>(0,h.jsx)("span",{style:{flexShrink:0},children:e}),userName:n}}):(0,h.jsx)(l().sA,{id:"personalHomeHeader.goodEveningNoUserName",defaultMessage:"Good evening"});(0,d().HB)(t)}({timeOfDay:function(){const e=r().c9.now().hour;return e>=19||e<2?"evening":e<12?"morning":"afternoon"}(),name:H(M)?(0,h.jsx)(O,{nickname:M}):void 0}),P=(0,h.jsx)(l().sA,{id:"personalHomeHeader.initialWelcomeText",defaultMessage:"Welcome home"}),K=(0,i().IS)((e=>{const n={width:"100%",height:"100%",marginTop:t,zIndex:1,paddingLeft:2*c,paddingRight:2*c,pointerEvents:"none",transition:"all 0.5s ease-in-out 2.75s",display:"flex",alignItems:"center",justifyContent:"center"},r=g&&!u;return{container:{width:"100%",height:"100%",display:"flex",position:"relative",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:f||!g?1:0,transition:"opacity 0.5s ease-in-out"},greetingTextContainer:{...n,opacity:r?0:1,transform:r?"translateY(12px)":"translateY(0px)"},welcomeTextContainer:{...n,opacity:r?1:0,transform:r?"translateY(0px)":"translateY(-12px)",position:"absolute"},headerText:{width:"100%",height:"100%",fontSize:k||w.showAiChatModuleInHome?24:30,lineHeight:1.2,fontWeight:p().Wy.semibold,color:e.text.primary,display:"flex",alignItems:"center",justifyContent:"center"},greetingTextSpan:{display:"flex",pointerEvents:"all",maxWidth:"100%"},mobileGreetingContainer:{display:"flex",flexDirection:"column"},gifFaceContainer:{marginTop:2,marginRight:6}}}),[t,c,u,g,f,k,w]),_=(0,h.jsxs)("div",{style:K.headerText,children:[w.showAiChatModuleInHome&&(0,h.jsx)("div",{style:K.gifFaceContainer,children:(0,h.jsx)(S,{configType:C})}),(0,h.jsx)("span",{style:K.greetingTextSpan,children:j})]}),F=(0,h.jsx)("div",{style:K.mobileGreetingContainer,children:(0,h.jsx)("div",{style:K.headerText,children:(0,h.jsx)("span",{style:K.greetingTextSpan,children:j})})}),E=(0,h.jsx)("div",{style:K.greetingTextContainer,children:k?F:_}),B=(0,h.jsx)("div",{style:K.welcomeTextContainer,children:(0,h.jsx)("div",{style:K.headerText,children:P})});return A?(0,h.jsxs)("div",{style:K.container,onMouseEnter:()=>b().A.setState({isHovered:!0}),onMouseLeave:()=>b().A.setState({isHovered:!1}),children:[E,B]}):null}function H(e){return!!(0,d().O9)(e)&&0!==(0,c().qAZ)(e).length}const U=o.memo(z)},625952:(e,t,n)=>{n.d(t,{Qd:()=>M});n(362833),n(725707),n(491955),n(500234);var r=n(242343),o=()=>n(237385),s=()=>n(803290),a=()=>n(174114),i=()=>n(951592),c=()=>n(905184),l=()=>n(963002),d=()=>n(934487),p=()=>n(403508),u=()=>n(271925),g=()=>n(975392),m=()=>n(84543),h=()=>n(485966),f=()=>n(503780),y=()=>n(681814),S=()=>n(320978),v=()=>n(165786),b=()=>n(442888),x=()=>n(554840),k=n(163643);function w(e){var t;const{clientStore:n,threadStore:r}=e,o=null==r?void 0:r.getSpaceId();if(!r||!o)return;const s=(0,b().A3)({clientStore:n,threadStore:r}),a=null===(t=s.find((e=>"context"===e.type)))||void 0===t||null===(t=t.value)||void 0===t?void 0:t.collectionViewBlockId;if(!a)return;const{currentSpaceStore:i}=h().default.state;if(!i)return;const c=(0,d().rE)({transcript:s,appId:a,spaceId:o});return c?{pointer:c.workflowModel.pointer,value:c.workflow}:void 0}function C(e){var t;const{clientStore:n,threadStore:r}=e;if(!r)return;const o=null===(t=w({clientStore:n,threadStore:r}))||void 0===t?void 0:t.value;if(!o)return;return{triggers:(o.triggers??[]).filter((e=>!(0,p().VB)(e,o))),modules:(o.modules??[]).filter((e=>{const t=l().Nh[e.type].getModuleConfigurationStatus(e,o);return"database"===e.type?"invalidAndRequiredToWriteCode"===t:"ready"!==t})).sort(((e,t)=>"config"===e.type?1:"config"===t.type?-1:e.type.localeCompare(t.type)))}}function M(e){const{clientStore:t,threadStore:n}=e,a=(0,o().v3)(),c=(0,s().K8)((()=>{if(!n)return;const e=w({clientStore:t,threadStore:n});return(0,l().Eu)(null==e?void 0:e.value)}),[t,n]),d=(0,i().ZC)(c);(0,r.useEffect)((()=>{if(!c&&d&&n){const{serverCommitResult:e}=m().createAndCommit({userAction:"AIChatTranscript.StopInferenceButton.handleClick",environment:a,canUndo:!0,perform:e=>{(0,v().GS)({threadStore:n,transaction:e,clientStore:t})}});(async()=>{await e,await(0,v().WE)({environment:a,threadStore:n,clientStore:t})})()}}),[c,d,a,n,t]);return(0,s().K8)((()=>function(e){const t=C(e);return!!t&&(t.triggers.length>0||t.modules.length>0)}({clientStore:t,threadStore:n})),[t,n])?(0,k.jsx)(I,{...e}):null}function I(e){const{clientStore:t,threadStore:n}=e,i=(0,a().IS)((()=>({setupInstructionsContainer:{paddingBottom:12}})),[]),l=(0,s().K8)((()=>C({clientStore:t,threadStore:n})),[t,n]),d=(0,s().K8)((()=>{const e=null==n?void 0:n.getSpaceId();if(n&&e)return{table:c().To,id:n.id,spaceId:e}}),[n]),p=(0,s().K8)((()=>w({clientStore:t,threadStore:n})),[t,n]),h=(0,o().v3)(),v=(0,r.useCallback)((e=>{n&&null!=p&&p.pointer&&m().createAndCommit({userAction:"WorkflowSetupInstructions.saveTrigger",environment:h,canUndo:!0,perform:t=>{(0,f().appendWorkflowSetupUpdate)({environment:h,threadStore:n,operations:[u().NW({pointer:p.pointer,trigger:e})],transaction:t})}})}),[n,null==p?void 0:p.pointer,h]),b=(0,r.useCallback)((e=>{n&&null!=p&&p.pointer&&m().createAndCommit({userAction:"WorkflowSetupInstructions.saveModule",environment:h,canUndo:!0,perform:t=>{(0,f().appendWorkflowSetupUpdate)({environment:h,threadStore:n,operations:[u().xb({pointer:p.pointer,module:e})],transaction:t})}})}),[n,h,null==p?void 0:p.pointer]),M=(0,r.useCallback)((e=>{n&&null!=p&&p.pointer&&m().createAndCommit({userAction:"WorkflowSetupInstructions.saveConfigVariable",environment:h,canUndo:!0,perform:t=>{(0,f().appendWorkflowSetupUpdate)({environment:h,threadStore:n,operations:[u().bE({pointer:p.pointer,configVariable:e})],transaction:t})}})}),[n,h,null==p?void 0:p.pointer]),I=(0,r.useMemo)((()=>{if(!(l&&null!=p&&p.value&&n&&d))return[];const{modules:e,triggers:t}=l,r=[];for(const o of e)r.push((0,k.jsx)(y().A,{workflowValue:p.value,module:o,workflowDefinitionPointer:d,isInTranscript:!0,saveModule:b,saveConfigVariable:M,store:n},o.key));for(const n of t)r.push((0,k.jsx)(S().m,{workflowValue:p.value,trigger:n,workflowDefinitionPointer:d,isInTranscript:!0,saveTrigger:v},n.key));return g().oE(r)}),[l,p,n,b,M,v,d]),T=(0,x().Q)(I);return T?(0,k.jsx)("div",{style:i.setupInstructionsContainer,children:T}):null}},757357:(e,t,n)=>{function r(e){return!e||0===e.getMessages().length}n.d(t,{a:()=>r})}}]);