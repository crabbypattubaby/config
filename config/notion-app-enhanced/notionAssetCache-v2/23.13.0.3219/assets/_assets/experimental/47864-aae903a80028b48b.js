"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[47864],{55998:(e,t,o)=>{o.d(t,{A:()=>a});class s extends(()=>o(129044))().default{getInitialState(){return{boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}}}const a=new s},61096:(e,t,o)=>{o.d(t,{A:()=>s});const s=new(o(962373).A)},166744:(e,t,o)=>{o.d(t,{A:()=>i,g:()=>n});o(242343);var s=o(163643);const a={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:o(31448).Wy.semibold,borderRadius:4,color:o(220413).Ay.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};let n=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});function r(e){return!!e&&e>0}const i=function(e){let{count:t,color:i,style:c,numberStyle:d,fadeIn:p}=e;const m=i===n.Red,u=(0,o(174114).IS)((e=>({badge:{...a,...c,...(t??0)>99&&{width:void 0,padding:2},background:m?e.redBadgeBackground:e.lightIconColor,...p&&{transition:"opacity 0.1s",opacity:r(t)?1:0}}})),[t,p,m,c]);return p||r(t)?(0,s.jsx)("div",{style:u.badge,children:(0,s.jsx)(l,{count:t,numberStyle:d})}):null};function l(e){let{count:t,numberStyle:o}=e;return t?1===t?(0,s.jsx)("span",{style:{marginLeft:-.5,...o},children:"1"}):t>99?(0,s.jsx)("span",{style:{letterSpacing:-.5,...o},children:"99+"}):t>9?(0,s.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...o},children:t}):(0,s.jsx)("span",{style:{...o},children:t}):null}},171131:(e,t,o)=>{o.d(t,{s:()=>Te,A:()=>Ce});o(725707),o(107652),o(500234),o(403517),o(113085);var s=o(242343),a=()=>o(237385),n=()=>o(803290),r=()=>o(174114),i=()=>o(712437),l=()=>o(83544),c=()=>o(220959),d=()=>o(96144),p=()=>o(145017),m=()=>o(653998),u=()=>o(76394),g=()=>o(31448),f=()=>o(505381),h=()=>o(304410),y=()=>o(865226),x=()=>o(927685),v=()=>o(392608),A=()=>o(907721),S=()=>o(485966),I=()=>o(773866),j=()=>o(330358),w=()=>o(346239),b=()=>o(706412),k=()=>o(587585),T=()=>o(748267),C=()=>o(220413),M=()=>o(424339),F=()=>o(356813),P=()=>o(35462),B=()=>o(610271),R=()=>o(96365),D=o(163643);const L=function(){const e=(0,n().O$)(I().A);return e.result?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(P().A,{isMultiline:!0,children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,D.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,D.jsx)(O,{importStatus:e},e.asanaTeamId)))})]}):(0,D.jsx)(D.Fragment,{})};function O(e){let{importStatus:t}=e;const o=(0,m().tz)(),a=(0,r().DP)(),[i,l]=(0,s.useState)(!1),c=(0,n().O$)(S().AppStoreCurrentSpaceStore),d=(0,n().K8)((()=>I().A.state.teamsAndProjects),[]),p=(0,n().O$)(S().AppStoreCurrentSpaceViewStore),u=(0,n().K8)((()=>{if(!p)return;const e=p.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,D.jsx)(M().x,{disabled:!0,store:e})})));return c?(e||[]).concat({id:p.id,name:"Private",icon:(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:C().XA.light.gray[75]},children:(0,T().g)({color:a.mediumIconColor,width:12.5,height:12.5})})}):e}),[p,c,a]),{notionTeamspaceName:g,notionTeamspaceIcon:f}=(0,s.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),h=(0,s.useMemo)((()=>{const e=d.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[d,t]);return(0,D.jsxs)(B().Ye,{style:{marginTop:16},children:[(0,D.jsx)(F().A,{ariaLabel:o.formatMessage({id:"asanaImport.importsTab.collapseToggle",defaultMessage:"Collapse toggle"}),icon:w().l,onClick:()=>l((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:10,height:10}}),(0,D.jsx)(R().A,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,D.jsx)(B().Ye,{alignItems:"center",gap:2,children:(0,D.jsx)(P().A,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:h})}),style:{width:300}},{key:"importedInto",header:(0,D.jsxs)(B().Ye,{gap:4,children:[(0,D.jsxs)(B().Ye,{style:{alignItems:"center",gap:4},children:[(0,D.jsx)(P().A,{isSmall:!0,children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,b().Z)({width:12})]}),(0,D.jsxs)(B().Ye,{style:{alignItems:"center",gap:4},children:[f,g]})]}),style:{width:300}}],rows:function(e){let{collapsed:o}=e;return o?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,D.jsxs)(B().Ye,{gap:8,alignItems:"center",children:[(0,k().q)({width:12,color:C().XA.dark.green[600]}),(0,D.jsx)(P().A,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,D.jsxs)(P().A,{isSmall:!0,children:[e.numberOfTasks,(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:i})})]})}o(771702);var W=()=>o(873333),z=()=>o(403768),_=()=>o(611824);const V=function(){const e=(0,n().O$)(I().A);if(!e.result)return(0,D.jsx)(D.Fragment,{});const t=e.result;let o=0;return t.forEach((e=>{o+=e.numberOfProjects})),(0,D.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(0,D.jsx)(P().A,{isMultiline:!0,style:{font:"SF Pro",fontWeight:g().Wy.semibold,fontSize:g().J.UIRegular.mobile,paddingTop:8},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.importComplete.subtitle",defaultMessage:"Imported {projectCount} projects into Notion",values:{projectCount:o}})}),(0,D.jsx)("div",{style:{marginTop:20},children:e.result.map((e=>(0,D.jsx)(N,{importStatus:e},e.asanaTeamId)))})]})};function N(e){let{importStatus:t}=e;const o=(0,r().DP)(),l=(0,n().O$)(S().AppStoreCurrentSpaceStore),d=(0,n().K8)((()=>I().A.state.teamsAndProjects),[]),u=(0,a().v3)(),f=(0,n().O$)(S().AppStoreCurrentSpaceViewStore),h=(0,n().K8)((()=>{if(!f)return;const e=f.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,D.jsx)(M().x,{disabled:!0,store:e})})));return l?(e||[]).concat({id:f.id,name:"Private",icon:(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:C().XA.light.gray[75]},children:(0,T().g)({color:o.mediumIconColor,width:12.5,height:12.5})})}):e}),[f,l,o]),{notionTeamspaceName:y,notionTeamspaceIcon:v}=(0,s.useMemo)((()=>{const e=null==h?void 0:h.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[h,t]),A=(0,s.useMemo)((()=>{const e=d.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[d,t]);return(0,D.jsx)(B().Ye,{style:{marginTop:16},children:(0,D.jsx)(R().A,{tableStyle:{borderTop:0,gap:10},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,D.jsx)(B().Ye,{children:(0,D.jsx)(B().Ye,{alignItems:"center",gap:2,children:(0,D.jsx)(P().A,{isSmall:!0,style:{width:280,textOverflow:"ellipsis",font:"SF Pro",fontWeight:g().Wy.regular,fontSize:g().J.UIRegular.desktop},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.importComplete.importFrom",defaultMessage:"From {asanaTeamName} in Asana",values:{asanaTeamName:A}})})})}),style:{width:300}},{key:"seperator",header:(0,D.jsx)(B().Ye,{style:{alignItems:"center",gap:4},children:(0,D.jsx)(P().A,{isMultiline:!0,style:{fontWeight:g().Wy.regular,font:"SF Pro",fontSize:g().J.UIRegular.desktop,color:"rgba(172, 171, 169, 1)"},children:"â†’"})}),style:{width:13,height:18,paddingRight:20}},{key:"importedInto",header:(0,D.jsxs)(B().Ye,{style:{alignItems:"center",gap:4},children:[v,(0,D.jsx)(P().A,{style:{font:"SF Pro",fontWeight:g().Wy.medium,fontSize:g().J.UIRegular.desktop},children:y}),(0,D.jsx)(P().A,{style:{fontWeight:g().Wy.regular,fontSize:g().J.UIRegular.desktop,font:"SF Pro Text",color:"rgba(172, 171, 169, 1)"},children:"/"}),(0,D.jsx)(D.Fragment,{children:(0,W().a)({width:"16px",height:"16px",color:o.mediumIconColor})}),(0,D.jsx)(P().A,{style:{font:"SF Pro",fontWeight:g().Wy.medium,fontSize:g().J.UIRegular.desktop},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.importComplete.projectLabel",defaultMessage:"Projects"})})]}),style:{width:300}}],rows:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,D.jsxs)(B().Ye,{gap:8,alignItems:"start",flexDirection:"column",children:[(0,D.jsx)(P().A,{isMultiline:!0,style:{wordWrap:"break-word",width:300,fontWeight:g().Wy.medium,font:"SF Pro",fontSize:g().J.UIRegular.desktop},children:e.name}),(0,D.jsxs)(P().A,{isSmall:!0,children:[e.numberOfTasks,(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]},e.projectId),(0,D.jsx)(B().Ye,{},`${e.projectId}-seperator`),(0,D.jsx)(B().Ye,{children:(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{style:{display:"flex",gap:4,paddingBottom:6},children:[(0,W().a)({width:20,height:20,color:o.mediumIconColor}),(0,D.jsx)(_().A,{href:e.notionProjectId?(0,c().A)({pageId:e.notionProjectId,pageModel:u.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:p().ev,id:e.notionProjectId},userId:u.currentUser.id}),baseUrl:x().A.domainBaseUrl,pageVisitSource:i().y8.Import}):void 0,style:{wordWrap:"break-word",fontWeight:g().Wy.medium,font:"SF Pro",fontSize:g().J.UIRegular.desktop,textDecorationLine:"underline",textDecorationColor:"rgba(227, 226, 224, 1)"},disableHover:!0,children:e.name})]}),(0,D.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,z().H)({width:14,height:14,color:o.mediumIconColor}),(0,D.jsxs)(_().A,{href:e.notionProjectId?(0,c().A)({pageId:e.notionProjectId,pageModel:u.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:p().ev,id:e.notionProjectId},userId:u.currentUser.id}),baseUrl:x().A.domainBaseUrl,pageVisitSource:i().y8.Import}):void 0,style:{color:"rgba(120, 119, 116, 1)",font:"SF Pro",fontSize:g().J.UISmall.desktop,fontWeight:g().Wy.regular},disableUnderline:!0,disableHover:!0,children:[e.numberOfTasks,(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})]})},`${e.projectId}-notionProjects`)]})))})})}o(362833),o(491955);var E=()=>o(198654),U=()=>o(280704),H=()=>o(640979),q=()=>o(628854),$=()=>o(417653),Y=()=>o(209684),K=()=>o(535906),G=()=>o(273520),X=()=>o(559637),J=()=>o(966789),Z=()=>o(935091),Q=()=>o(858023),ee=()=>o(88271),te=()=>o(874413);const oe=function(){const e=(0,a().v3)(),t=(0,m().tz)(),o=(0,n().K8)((()=>I().A.getState()),[]),{isLoadingProjects:r,workspaces:i,selectedWorkspace:l,teamsAndProjects:c}=o;return(0,s.useEffect)((()=>{l&&h().D5({selectedWorkspace:l,environment:e}).catch((()=>{}))}),[l,e]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(P().A,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,D.jsx)(ae,{onSelectOption:e=>{I().A.setState({...o,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:i.map((e=>({key:e.gid,label:e.name}))),currentOption:l,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),l?(0,D.jsx)(P().A,{style:{fontWeight:g().Wy.semibold,marginTop:18},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,D.jsx)(D.Fragment,{}),r?(0,D.jsxs)(B().Ye,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,D.jsx)(J().A,{size:"sm"}),(0,D.jsx)(P().A,{isSmall:!0,style:{color:C().XA.light.gray[400]},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):c.filter((e=>0!==e.projects.length)).map((e=>(0,D.jsx)(se,{team:e,selectedWorkspace:l},`${e.gid}-table`)))]})};function se(e){var t;let{team:o,selectedWorkspace:i}=e;const c=(0,a().v3)(),d=(0,m().tz)(),p=(0,r().DP)(),[u,f]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!1),[v,A]=(0,s.useState)(),j=(0,n().K8)((()=>I().A.getState()),[]),{importCompletedTasks:k,selectedProjectsAndTeamspaces:L}=j,O=(0,n().O$)(S().AppStoreCurrentSpaceViewStore),W=(0,n().K8)((()=>{const e=null==O?void 0:O.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,D.jsx)(M().x,{disabled:!0,store:e})})))}),[O]);(0,s.useEffect)((()=>{if(!W||!O)return;if(!L[o.gid]){A("private"),h().$8({teamId:o.gid,spaceId:null==O?void 0:O.id});for(const s of W){var e,t;if((null===(e=s.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=o.name)||void 0===t?void 0:t.toLowerCase())){A(s.id),h().$8({teamId:o.gid,spaceId:s.id});break}}}}),[W,o,O,L]);const z=(0,s.useCallback)((e=>{h().$8({teamId:o.gid,spaceId:e}),A(e)}),[o.gid]),_=(0,s.useCallback)((e=>{if("create"===e)return void q().vn("asana_importer",{onClose:z});let t;if("private"===e){if(null==O||!O.id)return;t=O.id}else t=e;h().$8({teamId:o.gid,spaceId:t}),A(e)}),[null==O?void 0:O.id,o.gid,z]),V=[{key:"private",searchTerm:"private",label:(0,D.jsxs)(B().Ye,{alignItems:"center",style:{gap:8},children:[(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:C().XA.light.gray[75]},children:(0,T().g)({color:p.mediumIconColor,width:12.5,height:12.5})}),(0,D.jsx)(P().A,{style:{fontWeight:g().Wy.regular},children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return W&&V.push(...W.map((e=>({key:e.id,searchTerm:e.name,label:(0,D.jsxs)(B().Ye,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),V.push({key:"create",searchTerm:"New teamspace",label:(0,D.jsxs)(B().Ye,{alignItems:"center",style:{gap:4},children:[(0,U().b)({color:p.mediumIconColor,width:16,height:16}),(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,D.jsxs)(B().Ye,{style:{marginLeft:-18},children:[(0,D.jsx)(F().A,{ariaLabel:d.formatMessage({id:"asanaImport.importsTab.collapseToggle",defaultMessage:"Collapse toggle"}),icon:w().l,onClick:()=>f((e=>!e)),style:{transform:u?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:12,height:12}}),(0,D.jsx)(R().A,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,D.jsxs)(B().Ye,{alignItems:"center",gap:2,children:[(0,D.jsx)(ne,{onSelectOption:e=>{var t;I().A.setState({...j,selectedProjectsAndTeamspaces:{...L,[o.gid]:{notionTeamspaceId:null===(t=L[o.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=L[o.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,D.jsx)(P().A,{style:{width:280,textOverflow:"ellipsis"},children:o.name})]}),style:{width:300}},{key:"importInto",header:(0,D.jsxs)(B().Ye,{style:{alignItems:"center"},children:[(0,D.jsx)("div",{children:(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,D.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,b().Z)({width:12})}),(0,D.jsxs)(B().Ye,{style:{alignItems:"center",gap:8},children:[(0,D.jsx)("img",{src:l().A.emails.notionLogoBlackSmallPng,height:18}),(0,D.jsx)(ae,{options:V,onSelectOption:_,currentOption:null===(t=V.find((e=>e.key===v)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:d.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const s=o.projects.map((e=>({key:e.gid,columns:[(0,D.jsxs)(B().Ye,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,D.jsx)(X().A,{style:{marginRight:2},onClick:()=>{const t={...L[o.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:a}=t;let n;n="all"===a||"in_complete"===a?[]:a.includes(e.gid)?a.filter((t=>t!==e.gid)):a.concat(e.gid),I().A.setState({...j,selectedProjectsAndTeamspaces:{...L,[o.gid]:{notionTeamspaceId:s,projects:n}}})},checked:(()=>{const t={...L[o.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,D.jsx)(te().m,{color:e.color,size:6}),(0,D.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,D.jsxs)(P().A,{isMultiline:!0,style:{color:p.text.tertiary},children:[e.name,(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,D.jsx)(P().A,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,D.jsxs)(P().A,{isSmall:!0,children:[k?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${o.gid}-tasks-count`)]})));return o.nextPage&&s.push({key:"loadMore",columns:[(0,D.jsx)($().A,{disabled:y,style:{marginLeft:20,color:C().XA.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{i&&(x(!0),await h().Oh({team:o,environment:c}),x(!1))},children:y?(0,D.jsxs)(B().Ye,{alignItems:"center",gap:8,children:[(0,D.jsx)(J().A,{size:"sm"}),(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,D.jsx)(m().sA,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${o.gid}-loadmore`)]}),s}({collapsed:u})})]})}function ae(e){var t;const{onSelectOption:o,options:a,currentOption:n,placeHolder:i,narrow:l,allowSearch:c}=e,d=(0,m().tz)(),[p,u]=(0,s.useState)(""),f=null===(t=a.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,h=(0,r().IS)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,D.jsx)(G().Ay,{popupType:G().z7.Popup,placementToOrigin:G().sx.Bottom,renderOrigin:e=>(0,D.jsxs)(Y().p,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${C().XA.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:n?void 0:C().XA.light.gray[75],color:n?void 0:C().XA.light.gray[300]},disabled:!1,children:[(0,D.jsx)(P().A,{style:{textOverflow:"ellipsis"},children:f||i}),(0,E().b)(h.icon)]}),render:e=>{const t={menuType:H().gu.Popup,width:250,left:50},s=[{key:"asanaImport.dropdown.menuList",render:e=>(0,D.jsx)(ee().A,{...e}),items:(p.trim()?a.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):a).map((t=>{let{key:s,label:a}=t;return{key:s,action:()=>{o(s),e.close()},render:e=>(0,D.jsx)(K().A,{...e,title:a,shouldWrapCaption:!0,isChecked:f===a})}}))}];return(0,D.jsxs)(D.Fragment,{children:[c?(0,D.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:C().XA.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${C().XA.light.gray[100]}`,justifyContent:"space-between",background:C().XA.light.gray[75],fontSize:g().J.UIRegular.desktop,textOverflow:"ellipses"},placeholder:d.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>u(e.target.value),value:p}):(0,D.jsx)(D.Fragment,{}),(0,D.jsx)(Z().A,{...t,children:(0,D.jsx)(Q().Ay,{type:Q().Oh.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function ne(e){var t;const{onSelectOption:o,options:a,currentOption:n}=e,r=null===(t=a.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,i=(0,s.useMemo)((()=>void 0!==n&&"specific"!==n&&("all"===n||"partial")),[n]);return(0,D.jsx)(G().Ay,{popupType:G().z7.Popup,placementToOrigin:G().sx.Bottom,alignmentToOrigin:G().yP.Start,renderOrigin:e=>(0,D.jsx)(Y().p,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,D.jsx)(X().A,{checked:i,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:H().gu.Popup,width:250,left:50},s=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,D.jsx)(ee().A,{...e}),items:a.map((t=>{let{key:s,label:a}=t;return{key:s,action:()=>{o(s),e.close()},render:e=>(0,D.jsx)(K().A,{...e,title:a,shouldWrapCaption:!0,isChecked:r===a})}}))}];return(0,D.jsx)(Z().A,{...t,children:(0,D.jsx)(Q().Ay,{type:Q().Oh.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var re=()=>o(286404),ie=()=>o(951540),le=()=>o(431551),ce=()=>o(103151),de=()=>o(487966),pe=()=>o(257987),me=()=>o(916963),ue=()=>o(646498),ge=()=>o(307567);const fe=(0,m().YK)({selectProperties:{id:"asanaImport.selectProperties.subtitleForSelectPropertiesTab",defaultMessage:"By default, all Asana task properties will be imported. You can customize this for each teamspace below"},keepAllPropertiesDescription:{id:"asanaImport.selectProperties.keepAllPropertiesDescription",defaultMessage:"Add {count} properties from Asana into your Notion tasks"},customPropertiesLabel:{id:"asanaImport.selectProperties.customPropertiesLabel",defaultMessage:"Custom Properties"},defaultPropertiesLabel:{id:"asanaImport.selectProperties.defaultPropertiesLabel",defaultMessage:"Default Properties"},privateSpaceLabel:{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"}});function he(e){let{propertiesLoadStatus:t,currentTeamSpaceId:o}=e;const a=(0,m().tz)(),{selectionMode:r,properties:i}=(0,n().K8)((()=>{if("resolved"!==t||!o)return{selectionMode:"all",properties:[]};const e=I().A.state.useSectionAsStatus,{selectionMode:s,properties:a}=I().A.state.selectedTeamspacesAndProperties[o],n=a.slice(),r=n.find((e=>"Completed?"===e.asanaFieldName)),i=n.find((e=>"Section"===e.asanaFieldName));return r&&i&&(e?(r.notionFieldType="checkbox",i.notionFieldType="status"):(r.notionFieldType="status",i.notionFieldType="select")),{selectionMode:s,properties:n}}),[o,t]),l=(0,s.useCallback)((e=>{const t=I().A.state;I().A.setState({...t,selectedTeamspacesAndProperties:{...t.selectedTeamspacesAndProperties,[o]:{...t.selectedTeamspacesAndProperties[o],properties:e}}})}),[o]),c=(0,s.useCallback)((e=>{I().A.setState({...I().A.state,selectedTeamspacesAndProperties:{...I().A.state.selectedTeamspacesAndProperties,[o]:{selectionMode:e,properties:i.map((t=>({...t,isSelected:t.isDefault||"all"===e})))}}})}),[o,i]),d=(0,s.useCallback)((e=>{const t=i.map((t=>t.asanaFieldName===e.asanaFieldName?{...t,isSelected:!t.isSelected}:t));l(t)}),[i,l]),p=(0,s.useCallback)((e=>{let t=!0,o=!0;const s=i.filter((t=>t.isDefault===("default"===e)));return s.length>0&&(s.forEach((e=>{e.isSelected?o=!1:t=!1})),!!t||!o&&"partial")}),[i]),u=(0,s.useCallback)((e=>{const t=!0===p(e),o=i.map((e=>({...e,isSelected:e.isDefault||!t})));l(o)}),[p,i,l]),[g,f]=(0,s.useState)(!1),[h,y]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{"resolved"===t&&0===(null==i?void 0:i.filter((e=>!e.isDefault)).length)&&f(!0)}),[t,i]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(B().Ye,{gap:8,style:{marginTop:10,width:"100%"},children:[(0,D.jsx)(ue().a,{name:"select-all-properties",selectType:"radio",label:"Select all properties",disabled:"pending"===t,value:"all",description:a.formatMessage(fe.keepAllPropertiesDescription,{count:Object.keys(i).length||"all"}),isSelected:"all"===r,style:{flexGrow:1,maxWidth:"50%"},onChange:()=>c("all")}),(0,D.jsx)(ue().a,{name:"customise-properties",selectType:"radio",disabled:"pending"===t,label:"Customize properties",value:"custom",description:"Choose which properties you want to keep",isSelected:"custom"===r,style:{flexGrow:1,maxWidth:"50%"},onChange:()=>c("custom")})]}),(0,D.jsx)("div",{style:{marginTop:8},children:(0,D.jsx)(ge().A,{title:(0,D.jsx)(B().Ye,{gap:4,children:(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{...fe.defaultPropertiesLabel})})}),rows:i.filter((e=>e.isDefault)),loading:"pending"===t,getIdentifier:e=>e.asanaFieldName,onToggleGroup:()=>f((e=>!e)),collapsed:!g,onSelectGroup:()=>{},onSelectRow:()=>{},groupCheckedState:!0,rowCheckedState:e=>e.isSelected||!1,renderRow:e=>(0,D.jsx)(ye,{property:e}),rowsContainerStyles:{display:"grid",gap:6},disabled:!0,rowStyles:{marginTop:4,height:24}})}),(0,D.jsx)("div",{style:{marginTop:8},children:(null==i?void 0:i.filter((e=>!e.isDefault)).length)>0&&(0,D.jsx)(ge().A,{title:(0,D.jsx)(B().Ye,{gap:4,children:(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{...fe.customPropertiesLabel})})}),rows:i.filter((e=>!e.isDefault)),loading:"pending"===t,disabled:"all"===r,getIdentifier:e=>e.asanaFieldName,onToggleGroup:()=>y((e=>!e)),collapsed:!h,onSelectGroup:()=>u("custom"),onSelectRow:e=>d(e),groupCheckedState:p("custom"),rowCheckedState:e=>e.isSelected||!1,renderRow:e=>(0,D.jsx)(ye,{property:e}),rowsContainerStyles:{display:"grid",gap:6},rowStyles:{marginTop:4,height:24}})})]})}function ye(e){let{property:t,style:o}=e;const a=xe();return(0,D.jsxs)(s.Fragment,{children:[(0,D.jsx)(B().Ye,{gap:12,alignItems:"center",style:{marginLeft:2,width:"250px",padding:"6px 0px 6px 0px",...o},children:(0,D.jsx)("span",{style:a.propertyLabel,children:t.asanaFieldName})}),(0,D.jsxs)(B().Ye,{style:{padding:"6px 6px"},gap:8,alignItems:"center",children:[(0,D.jsx)(ve,{}),me().LE[t.notionFieldType]({width:14,fill:C().Ay.uiGray}),(0,D.jsx)("span",{style:a.propertyLabel,children:t.notionFieldType.split("_").map(pe().A).join(" ")})]})]},t.asanaFieldName)}function xe(){return(0,r().IS)((e=>({teamSpaceLabel:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},header:{font:"SF Pro",fontWeight:g().Wy.regular,fontSize:g().J.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingTop:4,paddingBottom:20},propertyLabel:{fontSize:g().J.UIRegular.desktop,color:e.text.primary,lineHeight:"19.6px"},lockedIcon:{color:e.mediumIconColor,width:12.5,height:12.5}})),[])}function ve(e){let{styles:t}=e;return(0,b().Z)({width:10,marginTop:2,marginRight:12,fill:C().Ay.uiLightGray,...t})}const Ae=function(){var e;const t=(0,a().v3)(),r=(0,m().tz)(),i=xe(),[l,c]=(0,s.useState)(0),[{status:d}]=(0,o(162901).Yb)((async()=>h().kV(t,I().A.state.selectedProjectsAndTeamspaces)),[t]),p=(0,n().K8)((()=>{var e,t;const s=(0,o(975392).sb)(Object.values(I().A.state.selectedProjectsAndTeamspaces).filter((e=>e.projects.length>0)).map((e=>e.notionTeamspaceId)).filter(u().O9)),a=null===(e=S().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores(),n=null===(t=S().default.state.currentSpaceViewStore)||void 0===t?void 0:t.id;return s.map((e=>{const t=null==a?void 0:a.find((t=>t.id===e));return t||e!==n?{teamSpaceId:e,name:null==t?void 0:t.getName(),icon:(0,D.jsx)(M().x,{disabled:!0,store:t})}:{teamSpaceId:n,icon:(0,T().g)(i.lockedIcon),name:r.formatMessage(fe.privateSpaceLabel)}}))}),[i.lockedIcon,r]);return(0,D.jsxs)("div",{style:{paddingBottom:20},children:[(0,D.jsx)(P().A,{style:i.header,children:(0,D.jsx)(m().sA,{...fe.selectProperties})}),(0,D.jsx)(o(207762).Ay,{style:{padding:0},tabs:p.map((e=>(0,D.jsxs)(B().Ye,{alignItems:"center",gap:8,children:[e.icon,e.name]},e.name))),selectedIndex:l,onChange:c}),(0,D.jsx)(he,{propertiesLoadStatus:d,currentTeamSpaceId:null===(e=p[l])||void 0===e?void 0:e.teamSpaceId})]})};const Se=(0,m().YK)({failed:{defaultMessage:"Some problems occurred while importing data from your Asana workspace.",id:"Asanaimport.importingData.failed.problemsOccured"},chooseWorkspaceTabLabel:{id:"asanaImport.asanaImportsTab.stepIndicator.chooseWorkspaceTab",defaultMessage:"Choose what to import"},importTabLabel:{id:"asanaImport.asanaImportsTab.stepIndicator.importTab",defaultMessage:"Import"},customizeTabLabel:{id:"asanaImport.asanaImportsTab.stepIndicator.selectPropertiesTab",defaultMessage:"Customize"},chooseWorkspaceNextButtonLabel:{id:"asanaImportsTab.chooseWorkspace.nextButtonText",defaultMessage:"Next"},chooseWorkspaceBackButtonLabel:{id:"asanaImport.chooseWorkspace.backButtonText",defaultMessage:"Back"},selectPropertiesBackButtonText:{id:"asanaImportsTab.selectProperties.backButtonText",defaultMessage:"Back"},startImportButtonText:{id:"asanaImportsTab.selectProperties.nextButtonText",defaultMessage:"Import"}});function Ie(e){switch(e){case"selectData":return(0,D.jsx)(P().A,{style:{paddingBottom:8,fontSize:18,fontWeight:g().Wy.semibold,width:"100%"},children:(0,D.jsx)(m().sA,{id:"asanaImport.asanaImportsTab.selectData.tabHeader",defaultMessage:"Select Asana workspace"})});case"chooseWorkspace":return(0,D.jsx)(P().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,D.jsx)(m().sA,{id:"asanaImport.asanaImportsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Asana workspace"})});case"selectProperties":return(0,D.jsx)(P().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,D.jsx)(m().sA,{id:"asanaImport.asanaImportsTab.selectProperties.tabTitle",defaultMessage:"Select properties"})});default:return(0,D.jsx)(D.Fragment,{})}}function je(){let{useV2Styles:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{useV2Styles:!1};return(0,r().IS)((e=>({stepIndicatorLabel:{font:"SF Pro",fontWeight:g().Wy.medium,fontSize:g().J.UIRegular.desktop},stepIndicatorContainer:{height:32,borderRadius:6,padding:"6px"},verificationCheck:{width:14,height:14,padding:"0.5px, 0px, 0px, 0px",color:e.lightIconColor},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.text.secondary},helpCenterButtonStytles:{display:"flex",alignItems:"baseline",justifyContent:"center",alignContent:"center",fontSize:g().J.UIRegular.desktop,padding:"6px, 0px, 0px, 0px",borderRadius:6,color:e.text.secondary,marginTop:2,width:298,height:28,gap:"4px",lineHeight:"18px"},externalLinkIcon:{width:"16px",height:"16px",padding:"0.5px, 0px, 0px, 0px",gap:"8px"},tabNotStarted:{color:e.text.tertiary},tabInProgress:{background:e.buttonHoveredBackground,color:e.text.primary},tabDone:{color:e.text.secondary}})),[])}const we=[["chooseWorkspace",Se.chooseWorkspaceTabLabel],["selectProperties",Se.customizeTabLabel],["importingData",Se.importTabLabel],["importComplete",null]];function be(e){let{tab:t}=e;const o=je(),a=(0,s.useCallback)((e=>{const o=we.findIndex((e=>{let[o,s]=e;return o===t})),s=we.findIndex((t=>{let[o,s]=t;return o===e}));return(0,u().O9)(o)?s<o?"done":s===o?"in-progress":"not-started":"not-started"}),[t]),n=(0,s.useCallback)((e=>{switch(e){case"done":return o.tabDone;case"in-progress":return o.tabInProgress;default:return o.tabNotStarted}}),[o]);return(0,D.jsx)(B().Ye,{gap:12,alignContent:"center",alignItems:"center",style:{marginTop:10,marginBottom:10},children:we.map((e=>{let[t,s]=e;const r=a(t);return s?(0,D.jsxs)(B().Ye,{alignContent:"center",alignItems:"center",justifyContent:"center",style:{...o.stepIndicatorContainer,...n(r)},gap:8,children:["done"===r&&(0,d().R)(o.verificationCheck),(0,D.jsx)(P().A,{style:{...o.stepIndicatorLabel},children:(0,D.jsx)(m().sA,{...s})})]},t):null}))})}function ke(){return(0,D.jsx)(de().A,{buttonStyle:{height:28,paddingLeft:4},title:(0,D.jsx)(m().sA,{id:"asanaImportsTab.confirm.helpCenter",defaultMessage:"Learn more about importing from Asana"}),href:(0,v().xS)("guides.importAsana"),analyticsFrom:"import",style:{marginLeft:-4}})}function Te(e){let{left:t,next:o,back:s,children:a}=e;return(0,D.jsxs)(B().Ye,{justifyContent:"space-between",alignItems:"center",children:[t,(0,D.jsxs)(B().Ye,{alignItems:"center",gap:12,children:[a,(0,D.jsxs)("div",{style:{gap:2},children:[(0,D.jsx)(ce().A,{placement:A().W.Top,alignment:A().C.End,render:e=>(0,D.jsx)(re().A,{size:"lg",style:{border:0},disabled:s.disabled,onClick:s.onClick,...e,children:s.message}),disableTooltip:!s.renderTooltip,renderTooltip:s.renderTooltip||(()=>(0,D.jsx)(D.Fragment,{}))}),(0,D.jsx)(ce().A,{placement:A().W.Top,alignment:A().C.End,render:e=>(0,D.jsx)(ie().A,{style:{marginLeft:16},disabled:o.disabled,onClick:o.onClick,...e,children:o.message}),disableTooltip:!o.renderTooltip,renderTooltip:o.renderTooltip||(()=>(0,D.jsx)(D.Fragment,{}))})]})]})]})}const Ce=function(e){let{tab:t,fetchActiveImportTasks:r,analyticsFrom:d}=e;const u=o(477784).A.getIntl(),g=(0,a().v3)(),v=(0,n().O$)(S().AppStoreCurrentSpaceStore),A=(0,n().O$)(S().AppStoreCurrentSpaceViewStore),w=(0,o(904697).useTeamsFromCache)(v),b=(0,n().O$)(I().A),k=(0,n().O$)(o(242333).A).flowId||o(214144).JW(),{importCompletedTasks:T,useSectionAsStatus:C,loggerPageId:M,selectedProjectsAndTeamspaces:F,selectedWorkspace:R,templateCreationInProgress:O,result:W,workspaces:z}=b,_=(0,s.useCallback)((e=>{switch(e){case"selectProperties":return!0;case"chooseWorkspace":const e=Object.values(F);return e.length&&!e.every((e=>0===e.projects.length&&void 0===e.notionTeamspaceId))&&!e.some((e=>0!==e.projects.length&&!e.notionTeamspaceId))&&!e.some((e=>e.notionTeamspaceId&&0===e.projects.length));case"selectData":return Object.values(F).some((e=>0!==e.projects.length));default:return!1}}),[F]),N=je();let E=t;return"selectData"===t?E="chooseWorkspace":"confirm"===t&&(E="importComplete"),(0,D.jsxs)(o(309461).Ay,{controlRow:(e=>"selectData"===e?(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,D.jsx)(re().A,{size:"lg",style:{border:0},disabled:!z.length,onClick:()=>{r(),I().A.resetImport()},children:(0,D.jsx)(m().sA,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,D.jsxs)(B().Ye,{alignItems:"center",gap:8,children:[R&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(le().A,{on:T,onClick:()=>I().A.setState({...b,importCompletedTasks:!T})}),(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}),(0,D.jsx)("div",{style:{gap:2},children:(0,D.jsx)(ie().A,{style:{marginLeft:16},disabled:!_(e),onClick:()=>{v&&A&&(h().Xn({environment:g,currentSpaceViewStore:A,spaceStore:v,teamsStores:w,flowId:k}).catch((()=>{})),f().eH(g,{import_source:"asana",from:d}))},children:O?(0,D.jsxs)(B().Ye,{alignItems:"center",gap:2,children:[(0,D.jsx)(J().A,{onDarkBackground:!0}),(0,D.jsx)(m().sA,{id:"asanaImportsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,D.jsx)(m().sA,{id:"asanaImportsTab.selectData.nextButtonText",defaultMessage:"Import"})})})]})]}):"chooseWorkspace"===e?(0,D.jsx)(Te,{left:(0,D.jsx)(ke,{}),next:{disabled:!_(e),onClick:h().uA,message:u.formatMessage(Se.chooseWorkspaceNextButtonLabel),renderTooltip:_(e)?void 0:()=>(0,D.jsx)(m().sA,{id:"asanaImportsTab.selectData.ImportConfirmationTooltip",defaultMessage:"Please select projects and a teamspace to import into"})},back:{disabled:!1,onClick:()=>{r(),I().A.resetImport()},message:u.formatMessage(Se.chooseWorkspaceBackButtonLabel)},children:R&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(le().A,{on:T,onClick:()=>I().A.setState({...b,importCompletedTasks:!T})}),(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.chooseWorkspace.chooseImportCompletedTasks",defaultMessage:"Import completed tasks"})})]})}):"selectProperties"===e?(0,D.jsx)(Te,{left:(0,D.jsx)(ke,{}),next:{disabled:!_(e),onClick:()=>{v&&A&&(h().Xn({environment:g,currentSpaceViewStore:A,navigateBeforeTemplateCreation:!0,spaceStore:v,teamsStores:w,flowId:k}).catch((()=>{})),f().eH(g,{import_source:"asana",from:d}))},message:u.formatMessage(Se.startImportButtonText)},back:{disabled:!1,onClick:()=>{I().A.setState({...b,currentTab:"chooseWorkspace"})},message:u.formatMessage(Se.selectPropertiesBackButtonText)},children:(0,D.jsx)(ce().A,{textWrap:!0,renderTooltip:e=>(0,D.jsx)(m().sA,{...e,id:"asanaImportsTab.selectProperties.selectPropertiesTooltip",defaultMessage:"Asana completed field is imported as status in Notion. Switch to importing sections as status and completed as checkboxes.",description:"Tooltip explaining the switcher to map completion to status."}),render:e=>(0,D.jsxs)("div",{...e,style:{display:"flex",gap:8},children:[(0,D.jsx)(le().A,{on:C,onClick:()=>I().A.setState({...b,useSectionAsStatus:!C})}),(0,D.jsx)(P().A,{children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.selectProperties.selectPropertiesStatusMapping",defaultMessage:"Import Section as Status"})})]})})}):"importingData"===e?(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,D.jsx)(ke,{}),(0,D.jsx)(re().A,{size:"lg",disabled:!z.length||O,onClick:()=>{r(),I().A.resetImport()},children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.importingData.closeButtonText",defaultMessage:"Close"})})]}):"confirm"===e?(0,D.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,D.jsx)(ie().A,{onClick:()=>{M&&y().oo({url:(0,c().A)({pageId:M,pageModel:g.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:p().ev,id:M},userId:g.currentUser.id}),baseUrl:x().A.domainBaseUrl,pageVisitSource:i().y8.Import}),environment:g}),I().A.resetImport(),j().A.reset()},children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,D.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,D.jsx)(re().A,{size:"lg",disabled:!z.length,onClick:()=>{r(),I().A.resetImport()},children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"importComplete"===e?(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:48,paddingTop:35,paddingBottom:28,border:"1px, 0px, 0px, 0px"},children:[(0,D.jsx)(ke,{}),(0,D.jsx)(ie().A,{style:{width:"181px",height:"32px",padding:"0px, 0px, 0px, 8px",borderRadius:"4px",gap:"4px"},onClick:()=>{if(null!=W&&W.length&&M){const e=W.find((e=>void 0!==e.projectCollectionPageId)),t=(null==e?void 0:e.projectCollectionPageId)||M;y().oo({url:(0,c().A)({pageId:t,pageModel:void 0===t?void 0:g.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:p().ev,id:t},userId:g.currentUser.id}),baseUrl:x().A.domainBaseUrl,pageVisitSource:i().y8.Import}),environment:g})}I().A.resetImport(),j().A.reset()},children:(0,D.jsx)(m().sA,{id:"asanaImportsTab.confirm.viewImportedProjects",defaultMessage:"View imported projects"})})]}):void 0)(E),controlRowPaddingTopBottom:"confirm"===t?0:10,removeBoxShadow:"confirm"===t,contentPaddingLeftRight:25,controlRowPaddingLeftRight:15,getPaddingTopBottom:()=>2,children:[(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,D.jsx)(be,{tab:E}),(0,D.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,D.jsx)($().A,{onClick:()=>{r(),I().A.resetImport()},style:N.closeButton,hoveredStyle:N.closeButtonHover,children:(0,o(81322).V)(N.closeButtonIcon)})})]}),Ie(E),(e=>"selectData"===e?(0,D.jsx)(oe,{}):"importingData"===e?(0,D.jsx)(o(940051).A,{assetSrc:l().A.images.import.asanaPng}):"confirm"===e?(0,D.jsx)(L,{}):"failure"===e?(0,D.jsx)(o(467800).A,{assetSrc:l().A.images.import.asanaPng,loggerPageId:M,failedMessage:u.formatMessage(Se.failed)}):"chooseWorkspace"===e?(0,D.jsx)(o(860706).Ay,{}):"selectProperties"===e?(0,D.jsx)(Ae,{}):"importComplete"===e?(0,D.jsx)(V,{}):void 0)(E)]})}},188594:(e,t,o)=>{o.d(t,{A:()=>s});const s=new(o(962373).A)},242333:(e,t,o)=>{o.d(t,{A:()=>a});class s extends(()=>o(129044))().default{getInitialState(){return{flowId:void 0}}getOrCreateFlowId(){const e=this.state.flowId||o(214144).JW();return this.state.flowId&&this.setState({flowId:e}),e}}const a=new s},298028:(e,t,o)=>{function s(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function a(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>s,e:()=>a})},304410:(e,t,o)=>{o.d(t,{x3:()=>C,bk:()=>M,D5:()=>F,uA:()=>O,xd:()=>R,kV:()=>B,Xn:()=>D,Oh:()=>P,qf:()=>W,$8:()=>L});o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(500234),o(403517);var s=()=>o(65866),a=()=>o(502140),n=()=>o(214144),r=()=>o(545250),i=()=>o(66460),l=()=>o(975392),c=()=>o(76394),d=()=>o(809811);const p=(0,o(851552).Dv)("parallelAsanaImport");var m=()=>o(283759),u=()=>o(927685),g=()=>o(452981),f=()=>o(142548),h=()=>o(485966),y=()=>o(773866),x=()=>o(242333),v=()=>o(505381),A=()=>o(818369),S=()=>o(145046),I=()=>o(437071),j=()=>o(839618),w=()=>o(581444),b=()=>o(961987),k=()=>o(84543);const T=(0,o(653998).YK)({titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function C(e){const{environment:t,flowId:o}=e;await A().callApi({eventName:"disconnectAsana",environment:t,data:{}});const s=(0,f().LX)(t);let a=(0,r().Rq)(u().A.domainBaseUrl,{authType:s,userId:t.currentUser.id});if(a=s.redirectToAuth?a:await(0,f().YN)(t,a),t.device.isElectron)return y().A.setState({...y().A.state,isAccountLinkingInProgress:!0}),void I().openExternalUrl(a);const n=await b().P(t,{width:580,height:800,url:a,titleMessage:T.titleMessage});if(!n)return;const i=d().qg(n);if(!i.query.code||!i.query.state)return;y().A.setState({...y().A.state,isAccountLinkingInProgress:!0});const l=await A().callApi({eventName:"authWithAsana",environment:t,data:{code:i.query.code,encryptedState:i.query.state}}),c=await A().callApi({eventName:"getAsanaWorkspacesNames",environment:t,data:{}});if("failed"===l.type)v()._$(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:l.error},flowId:o}),console.error(l.error),S().Qg(l);else if(v()._$(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:o}),"success"===c.type){const{data:{account:e,workspaces:t}}=c;y().A.setState({...y().A.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function M(e){const{environment:t}=e;y().A.setState({...y().A.state,isAccountDelinkingInProgress:!0});const o=await A().callApi({eventName:"disconnectAsana",environment:t,data:{}});"failed"===o.type?(console.error(o.error),S().Qg(o)):(v().kO(t,{integration_name:"asana"}),"success"===o.type&&y().A.setState({...y().A.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function F(e){const{selectedWorkspace:t,environment:o,forceReload:s=!0}=e;if(s||!y().A.state.teamsAndProjects.length){y().A.setState({...y().A.state,isLoadingProjects:!0});const e=await A().callApi({eventName:"getTeamsAndProjectsInAsanaWorkspace",environment:o,data:{workspaceId:t,size:5}});"success"===e.type&&y().A.setState({...y().A.state,teamsAndProjects:e.data,isLoadingProjects:!1})}}async function P(e){const{team:t,environment:o}=e,s=y().A.getState(),{selectedWorkspace:a,teamsAndProjects:n,loadMoreClicks:r}=s;if(!a)return;const i=await A().callApi({eventName:"getTeamsAndProjectsInAsanaWorkspace",environment:o,data:{workspaceId:a,teamId:t.gid,size:5,nextPage:t.nextPage}}),l=n.findIndex((e=>e.gid===t.gid));if(-1!==l){if("success"===i.type){const e=i.data.find((e=>e.gid===t.gid));if(!e)return;const o={...n[l],projects:[...n[l].projects,...e.projects],nextPage:e.nextPage},a=n.slice(0,l).concat(o,n.slice(l+1));y().A.setState({...s,teamsAndProjects:a,loadMoreClicks:r+1})}return i}}async function B(e,t){const o=[];for(const a of Object.keys(t)){const{notionTeamspaceId:e,projects:s}=t[a];!(0,l().Kg)(s)&&(0,c().O9)(e)&&o.push({asanaTeamId:a,projectIds:s,notionTeamSpaceId:e})}const s=await A().callApi({eventName:"getAsanaTaskProperties",environment:e,data:o});if("success"===s.type){const{selectedTeamspacesAndProperties:e}=y().A.state;for(const{notionTeamSpaceId:t,properties:o}of s.data.data)o&&(e[t]={selectionMode:"all",properties:o.map((e=>({...e,isSelected:!0})))});y().A.setState({...y().A.state,selectedTeamspacesAndProperties:e})}}async function R(e){let{environment:t}=e;y().A.setState({...y().A.state,isLoadingAsanaWorkspaces:!0});const o=await A().callApi({eventName:"getAsanaWorkspacesNames",environment:t,data:{}});var s;"success"===o.type&&y().A.setState({...y().A.state,account:o.data.account,workspaces:o.data.workspaces,selectedWorkspace:null===(s=o.data)||void 0===s||null===(s=s.workspaces[0])||void 0===s?void 0:s.gid,isLoadingAsanaWorkspaces:!1})}async function D(e){let{environment:t,spaceStore:o,currentSpaceViewStore:r,teamsStores:l,flowId:c,navigateBeforeTemplateCreation:d}=e;const{appTemplatesSetupActions:u,appConfigs:f}=await g().Aw.load(),A=y().A.state.selectedWorkspace;if(!A)return;y().A.setState({...y().A.state,...d&&{currentTab:"importingData"},templateCreationInProgress:!0});const S={},I={};try{for(const e in y().A.state.selectedProjectsAndTeamspaces){if(0===y().A.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let a;const n=y().A.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:i}=n;if(!i)continue;const c=l.find((e=>e.id===n.notionTeamspaceId));if(a=c||o,I[i])S[e]=I[i];else{const{serverCommitResult:o,performResult:n}=k().createAndCommit({environment:t,perform:e=>{var o;const n=s().tP,i=null===(o=(0,m().BL)(f(),n))||void 0===o?void 0:o.uri;if(!i)return;const l=f().find((e=>e.uri===i));if(null==l?void 0:l.presets.find((e=>e.uri===n))){const o=u.initializeApp({environment:t,spaceViewStore:r,appParentStore:a,appUri:i,presetUri:n,transaction:e,from:"asana_import"});if(2!==(null==o?void 0:o.length))return;return o}},canUndo:!0,userAction:"importActions.importAsana"});S[e]=n,I[i]=n,await o}}}catch(L){return void y().A.setState({...y().A.state,templateCreationInProgress:!1,currentTab:"failure"})}const b=[],T=h().default.state.currentSpaceViewStore;if(!T)return;const C=w().mD({environment:t,spaceStore:o,spaceViewStore:T,append:!0});await C.deferred.promise;const M=C.pageId;y().A.setState({...y().A.state,loggerPageId:M});const F=new Set,P=[],B=[];for(const s in S){const e=y().A.state.selectedProjectsAndTeamspaces[s],t=S[s];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const a="string"==typeof e.projects?[]:e.projects;P.push(...a);const n=y().A.state.selectedTeamspacesAndProperties[e.notionTeamspaceId];n&&(n.useSectionAsStatus=y().A.state.useSectionAsStatus),F.add(e.notionTeamspaceId),B.push(s),b.push({collectionViewBlocks:[{id:t[0].id,spaceId:(0,i().e)(o.id)},{id:t[1].id,spaceId:(0,i().e)(o.id)}],projectIds:a,asanaTeamId:s,notionTeamSpaceId:e.notionTeamspaceId,propertySelection:n,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}v().Pd(t,{integration_name:"asana"});const R=(0,j().UT)(t,p,{importParams:b,spaceId:(0,i().e)(o.id),asanaWorkspaceId:A,importCompletedTasks:y().A.state.importCompletedTasks,loggerPageId:M,flowId:c||n().JW()});y().A.setState({...y().A.state,templateCreationInProgress:!1,currentTab:"importingData",choosingWorkspacesCompleted:!0}),x().A.reset();const D=y().A.state.workspaces.find((e=>e.gid===A));D&&function(e,t,o){try{v().mM(e,{import_source:"asana",data:t,flowId:o})}catch(s){a().log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:s,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:D.name,teams:B,projects:P,numberOfTeamspacesUsed:F.size,completedTasks:y().A.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,i().e)(o.id)},c);for await(const s of R){if(!y().A.state.isModalOpen)break;if(s.error)return void y().A.setState({...y().A.state,currentTab:"failure"});"success"===s.taskStatus&&y().A.setState({...y().A.state,currentTab:"confirm",result:s.value.status,isComplete:!0})}}function L(e){var t;let{teamId:o,spaceId:s}=e;y().A.setState({...y().A.state,selectedProjectsAndTeamspaces:{...y().A.state.selectedProjectsAndTeamspaces,[o]:{projects:(null===(t=y().A.state.selectedProjectsAndTeamspaces[o])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:s||void 0}}})}function O(){y().A.setState({...y().A.state,currentTab:"selectProperties"})}function W(){y().A.setState({...y().A.state,isModalOpen:!0})}},307567:(e,t,o)=>{o.d(t,{A:()=>p});o(403517),o(242343);var s=()=>o(174114),a=()=>o(220413),n=()=>o(209684),r=()=>o(559637),i=()=>o(517198),l=()=>o(610271),c=()=>o(579031),d=o(163643);function p(e){let{getIdentifier:t,onSelectRow:o,rows:p,title:m,renderRow:u,onToggleGroup:g,onSelectGroup:f,collapsed:h,groupCheckedState:y,rowCheckedState:x,disabled:v,rowStyles:A={},rowsContainerStyles:S={},loadMoreButton:I,checkboxStyles:j={},loading:w}=e;const b=(0,s().IS)((e=>({row:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:40},loadingRow:{gap:6,alignItems:"center",marginTop:4,height:19.6}})),[]);if(w){const e=(null==A?void 0:A.lineHeight)||14;return(0,d.jsxs)("div",{children:[(0,d.jsxs)(l().Ye,{style:{paddingLeft:6,paddingRight:8,...b.loadingRow},children:[(0,d.jsx)(i().A,{style:{height:14,width:34}}),(0,d.jsx)(i().A,{style:{height:e,width:200}})]}),(0,d.jsxs)("div",{style:{...b.row,...A},children:[(0,d.jsx)(i().A,{style:{height:14,width:14}}),(0,d.jsx)(i().A,{style:{height:e,width:64}})]}),(0,d.jsxs)("div",{style:{...b.row,...A},children:[(0,d.jsx)(i().A,{style:{height:14,width:14}}),(0,d.jsx)(i().A,{style:{height:e,width:96}})]})]})}return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n().p,{onClick:g,style:{gap:6},pressedStyle:{background:"transparent"},iconStyle:{marginRight:0},ignoreLocalHoverState:!0,icon:e=>(0,d.jsx)(c().A,{disabled:!0,style:{...e,pointerEvents:"none"},isSidebar:!1,open:!h,fill:!1,onClick:e=>{e.stopPropagation(),g()},icon:"chevron"}),children:[(0,d.jsx)(r().A,{disabled:v,onClick:f,checked:y,style:{borderRadius:2,...j},size:14,checkSize:8,checkedColor:v?a().Ay.blueWithAlpha(.3):a().Ay.blue}),m]}),!h&&(0,d.jsxs)("div",{style:S,children:[p.map((e=>(0,d.jsxs)("div",{style:{...b.row,...A},onClick:v?void 0:()=>{o(e)},children:[(0,d.jsx)(r().A,{style:{marginRight:1,borderRadius:2,...j},onClick:t=>{t.stopPropagation(),o(e)},disabled:v,checked:x(e),size:14,checkSize:8,checkedColor:v?a().Ay.blueWithAlpha(.3):a().Ay.blue}),u(e)]},t(e)))),I&&!v&&(0,d.jsx)("div",{style:b.row,children:I})]})]})}},342981:(e,t,o)=>{o.d(t,{A:()=>dt,h:()=>ct});o(403517);var s=o(242343),a=()=>o(237385),n=()=>o(803290),r=()=>o(174114),i=()=>o(712437),l=()=>o(846581),c=()=>o(653998),d=()=>o(220413),p=()=>o(31448),m=()=>o(818369),u=()=>o(477784),g=()=>o(485966),f=()=>o(773866),h=()=>o(661584),y=()=>o(330358),x=()=>o(435819),v=()=>o(922172),A=o(163643);const S=function(e){let{fetchActiveImportTasks:t,analyticsFrom:a}=e;const r=(0,n().O$)(f().A),{isModalOpen:i}=r,l=(0,s.useCallback)((()=>{f().A.resetImport()}),[]),c=(0,s.useCallback)((()=>{const{currentTab:e}=r;return(0,A.jsx)(o(171131).A,{fetchActiveImportTasks:t,tab:e,analyticsFrom:a})}),[r,t,a]);return(0,A.jsx)(v().a,{open:i,innerStyle:{height:"calc(100vh - 100px)",overflow:"hidden",maxHeight:675,borderRadius:12,width:900},render:()=>(0,A.jsx)(x().A,{capture:!0,allowEsc:!0,render:()=>c()}),onDismiss:l})};var I=()=>o(35462),j=()=>o(76394),w=()=>o(421338),b=()=>o(539048),k=()=>o(219020),T=(o(725707),o(491955),o(500234),o(324989),o(771702),()=>o(129044)),C=()=>o(916963),M=()=>o(950136),F=()=>o(566581),P=()=>o(566232),B=()=>o(198654),R=()=>o(99949),D=()=>o(298028),L=()=>o(145017),O=()=>o(704082),W=()=>o(728373),z=()=>o(534895),_=()=>o(154956),V=()=>o(521325),N=()=>o(839618),E=()=>o(581444),U=()=>o(795394),H=()=>o(759625),q=()=>o(865226),$=()=>o(84543),Y=()=>o(966789),K=()=>o(397791),G=()=>o(431551),X=()=>o(868325),J=()=>o(29869),Z=()=>o(640979),Q=()=>o(413871),ee=()=>o(363998),te=()=>o(618464),oe=()=>o(209684),se=()=>o(535906),ae=()=>o(273520),ne=()=>o(401382),re=()=>o(935091),ie=()=>o(858023),le=()=>o(701270),ce=()=>o(286404),de=()=>o(951540),pe=()=>o(88271),me=()=>o(610271),ue=()=>o(120844),ge=()=>o(64713),fe=()=>o(142708),he=()=>o(390263),ye=()=>o(98508);const xe=24;function ve(e){let{previewCollection:t,onSetCollectionContextStore:o,validationState:a}=e;const i=(0,n().O$)(k().f),l=(0,s.useMemo)((()=>({location:"csv_import",isPreviewing:!0,disableAllPointerEvents:!0,disablePageLinks:!0,hideTableAggregationRow:!0,hideViewBlockSource:!0})),[]),d=(0,s.useCallback)((e=>{o&&o(e)}),[o]),m=(0,r().IS)((e=>({container:{position:"relative",backgroundColor:e.contentBackground,height:"100%",paddingTop:xe,overflowY:"auto",borderRadius:12,border:`1px solid ${e.stroke.primary}`},titleWrapper:{display:"flex",alignItems:"center",paddingLeft:xe+4,margin:"4px 0 12px 0",gap:12},titleText:{fontSize:20,fontWeight:600,lineHeight:"26px",whiteSpace:"pre-line",marginLeft:0},previewScroller:{height:"100%",paddingBottom:xe-8},errorPreview:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"calc(100% - 60px)",color:e.text.secondary,fontSize:16,gap:9},errorMessage:{textAlign:"center",maxWidth:"80%",color:e.text.secondary},errorTitle:{color:e.text.secondary,textAlign:"center",fontSize:14,fontWeight:p().Wy.medium,lineHeight:"20px",letterSpacing:"-0.154px"}})),[]);return i.open?a?(0,A.jsxs)(w().Y1,{height:"fill",style:m.container,children:[(0,A.jsxs)("div",{style:m.titleWrapper,children:[(0,A.jsx)(K().I,{icon:ue().T,size:"xl",color:"primary"}),(0,A.jsx)(I().A,{style:m.titleText,children:i.fileName.replace(/\.csv$/i,"")||"Preview"})]}),(0,A.jsxs)(me().wt,{style:m.errorPreview,children:[(0,A.jsx)(K().I,{icon:R().e,size:"xl",color:"lightGraySecondary"}),(0,A.jsx)(I().A,{style:m.errorTitle,children:(0,A.jsx)(c().sA,{id:"csv-import-preview.error.title",defaultMessage:"Preview Unavailable"})}),(0,A.jsx)(I().A,{style:m.errorMessage,children:a.multipleTitle?(0,A.jsx)(c().sA,{id:"csv-import-preview.error.multipleTitle",defaultMessage:"You can only have one Title property."}):a.noTitle?(0,A.jsx)(c().sA,{id:"csv-import-preview.error.noTitle",defaultMessage:"At least one column must be set as a Title property."}):(0,A.jsx)(c().sA,{id:"csv-import-preview.error.invalidPropertyConfiguration",defaultMessage:"Invalid property configuration. Please check your column mappings."})})]})]}):t?(0,A.jsxs)(w().Y1,{height:"fill",style:m.container,children:[(0,A.jsxs)("div",{style:m.titleWrapper,children:[(0,A.jsx)(K().I,{icon:ue().T,size:"xl",color:"primary"}),(0,A.jsx)(I().A,{style:m.titleText,children:i.fileName.replace(/\.csv$/i,"")||"Preview"})]}),(0,A.jsx)(fe().H,{type:ye().A.All,style:m.previewScroller,children:(0,A.jsx)(he().tx,{value:l,children:(0,A.jsx)(ge().dN,{store:t.collectionViewBlockStore,disabled:!0,forceLocalQueryCollection:!0,headerActionsBehavior:"hidden",overridePaddingLeft:xe,overridePaddingRight:xe,setCollectionContextStore:d,productUseCase:"preview_collection"})})})]}):(0,A.jsx)(w().Y1,{height:"fill",style:m.container,children:(0,A.jsxs)("div",{style:m.titleWrapper,children:[(0,A.jsx)(K().I,{icon:ue().T,size:"xl",color:"primary"}),(0,A.jsx)(I().A,{style:m.titleText,children:i.fileName.replace(/\.csv$/i,"")||"Preview"})]})}):null}o(610931),o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(107652);var Ae=()=>o(564134),Se=()=>o(21164),Ie=()=>o(289765),je=()=>o(3311),we=()=>o(551102),be=()=>o(285060),ke=()=>o(960442),Te=()=>o(468933),Ce=()=>o(246132),Me=()=>o(595922);function Fe(){const e=(0,a().v3)(),t=(0,n().O$)(k().f),[o,r]=(0,s.useState)(void 0),i=(0,Ce().S)(Te().o8,{canUndo:!0}),l=(0,s.useRef)(void 0),c=(0,s.useRef)([]),d=(0,s.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=c.current.find((e=>"title"===e.propertyType)),o=e.find((e=>"title"===e.propertyType)),s=(null==t?void 0:t.headerName)!==(null==o?void 0:o.headerName)||t&&e.find((e=>e.headerName===t.headerName&&"dont_import"===e.propertyType));return c.current=[...e],s}),[]),p=(0,s.useCallback)((()=>{l.current=void 0,i.reset(),k().f.setPreviewCollectionInfo(void 0)}),[i]);return(0,s.useEffect)((()=>{if(!t.open||!t.csvHeaders||!t.csvSampleRows||0===t.csvHeaders.length)return;const o=t.userPropertyMapping||[],s=o.filter((e=>"title"===e.propertyType)),a=0===s.length,n=s.length>1;if(a||n)return r({noTitle:a,multipleTitle:n}),void p();r(void 0);const c=!l.current||d(o);if(t.csvHeaders.every((e=>{const t=o.find((t=>t.headerName===e));return"dont_import"===(null==t?void 0:t.propertyType)})))return void p();if(l.current&&!c)return;c&&l.current&&p();const{performResult:m}=$().createAndCommit({userAction:"csvImport.previewCollection",environment:e,perform:o=>{var s;const a=H().Wv({environment:e,type:"collection_view_page",inMemoryRecordCache:i.cache,transaction:o}),n=g().default.state.currentSpaceStore;if(!n)throw new Error("No current space store");const r=n.id,{parentId:l,parentTable:c}=t,d=l||r,p=c||"space";H().zv({store:a,data:{parent_id:d,parent_table:p,space_id:r,alive:!0},transaction:o});const m={},u=t.userPropertyMapping||[],f=u.find((e=>"title"===e.propertyType));let h=null==f?void 0:f.headerName;!h&&t.csvHeaders&&t.csvHeaders.length>0&&(h=t.csvHeaders[0]),m.title={name:h||"Title",type:"title"},null===(s=t.csvHeaders)||void 0===s||s.forEach(((e,o)=>{var s;if(e===h)return;const a=u.find((t=>t.headerName===e)),n=(null==a?void 0:a.propertyType)||"text";if("dont_import"===n)return;const r=(0,W().Ay)(),i=null===(s=t.csvHeaders)||void 0===s?void 0:s.findIndex((t=>t===e));let l=[];if(t.csvSampleRows&&void 0!==i&&-1!==i&&("select"===n||"multi_select"===n)){const e=t.csvSampleRows.map((e=>e[i])).filter((e=>"string"==typeof e&&""!==e));let o;o="multi_select"===n?Array.from(new Set(e.flatMap((e=>e.split(","))).map((e=>e.trim())).filter((e=>""!==e)))):Array.from(new Set(e.map((e=>e.trim())).filter((e=>""!==e)))),l=o.map((e=>({id:(0,W().Ay)(),value:e,color:(0,Ae().Zd)(l)})))}m[r]="select"===n?{name:e,type:"select",options:l}:"multi_select"===n?{name:e,type:"multi_select",options:l}:"checkbox"===n?{name:e,type:"checkbox"}:"number"===n?{name:e,type:"number"}:"date"===n?{name:e,type:"date"}:"email"===n?{name:e,type:"email"}:"phone_number"===n?{name:e,type:"phone_number"}:"url"===n?{name:e,type:"url"}:{name:e,type:"text"}}));const y=(0,be().E)({environment:e,collectionViewBlockStore:a,transaction:o,collectionValue:{name:[["CSV Preview"]],schema:m}}),x=(0,je().Ay)(),v=Q().pS.createChildStore(a,{table:Ie().Gy,id:x});H().zv({store:v,data:{id:x,version:1,type:"table",name:"Table view",format:{table_wrap:!0,table_properties:Object.entries(m).map((e=>{let[t,o]=e;return{property:t,visible:!0,width:250}})),collection_pointer:{id:y.id,table:Se().Vl,spaceId:r}},parent_id:a.id,parent_table:"block",space_id:r,alive:!0,query2:{aggregations:[],sort:[],filter:{operator:"and",filters:[]}}},transaction:o}),we().BC({parentStore:a.getCollectionViewsStore(),appendStore:v,transaction:o});const A=[];if(new(Me().A)(e).setContext({type:"collectionView",collectionViewBlockStore:a,collectionStore:y,collectionViewStore:v,pageVisitSourceOverride:void 0}),t.csvSampleRows&&t.csvSampleRows.length>0){t.csvSampleRows.slice(0,5).forEach(((s,a)=>{const n=(0,je().Ay)();A.push(n);const l=new(Q().Bv)(e,{table:L().ev,id:n},{inMemoryRecordCache:i.cache}),c=function(e,t,o,s){const a={};return Object.entries(e).forEach(((e,s)=>{let[n,r]=e;const i=o.findIndex((e=>e===r.name));if(-1===i||i>=t.length)return;const l=t[i];if(l&&""!==l.trim())try{switch(r.type){case"title":case"text":default:a[n]=[[l]];break;case"number":const e=parseFloat(l);a[n]=isNaN(e)?[[l]]:[[e.toString()]];break;case"select":{const e=l.trim();a[n]=[[e]];break}case"multi_select":{const e=l.split(",").map((e=>e.trim())).filter((e=>""!==e));e.length>0&&(a[n]=e.map((e=>[e])));break}case"checkbox":const t=l.toLowerCase().trim(),o="true"===t||"yes"===t||"1"===t||"âœ“"===t||"checked"===t;a[n]=o?[["Yes"]]:[["No"]];break;case"url":let s=l.trim();s&&!s.match(/^[a-zA-Z]+:\/\//)&&(s=`https://${s}`),a[n]=[[s]];break;case"email":case"phone_number":a[n]=[[l.trim()]];break;case"date":try{const e=new Date(l);isNaN(e.getTime())?a[n]=[[l]]:a[n]=[[e.toISOString()]]}catch(c){a[n]=[[l]]}}}catch(d){a[n]=[[l]]}})),a}(m,s,t.csvHeaders||[],t.userPropertyMapping);H().zv({store:l,data:{id:n,version:1,type:"page",parent_id:y.id,parent_table:"collection",space_id:r,alive:!0},transaction:o}),c&&Object.keys(c).length>0&&(0,ke().L)({environment:e,store:l,properties:c,transaction:o}),U().X$({parentStore:y,childStore:l,transaction:o})}))}return{collectionStore:y,collectionViewBlockStore:a,collectionViewStore:v}},canUndo:!0});l.current=m,k().f.setPreviewCollectionInfo(m)}),[t,e,i,p,d]),{previewCollection:l.current,validationState:o}}const Pe=(0,c().YK)({searchPlaceholder:{id:"csvImport.mapFieldsStep.searchPlaceholder",defaultMessage:"Search property types..."},heading:{id:"csvImport.mapFieldsStep.heading",defaultMessage:"Setup CSV columns"},description:{id:"csvImport.mapFieldsStep.description",defaultMessage:"Select the type of property you wish to assign each column from your CSV file"},useFirstRowAsHeaders:{id:"csvImport.mapFieldsStep.useFirstRowAsHeaders",defaultMessage:"Use first row as headers"},importButton:{id:"csvImport.mapFieldsStep.importButton",defaultMessage:"Import CSV"},cancelButton:{id:"csvImport.mapFieldsStep.cancelButton",defaultMessage:"Cancel"}});function Be(e){const t=(0,n().O$)(k().f),o=(0,a().Y0)(),l=(0,a().v3)(),d=(0,s.useMemo)((()=>T().default.createValue({open:!1,stack:[],closeOnEscape:!0})),[]),[m,g]=(0,s.useState)([]),[f,h]=(0,s.useState)({}),[x,v]=(0,s.useState)(""),[S,I]=(0,s.useState)({}),[j,w]=(0,s.useState)(""),[b,ue]=(0,s.useState)(!0),[ge,fe]=(0,s.useState)(!1),he=(0,r().DP)(),ye=(0,s.useRef)(!1),xe=(0,c().tz)(),Ae=(0,s.useRef)(void 0),{previewCollection:Se,validationState:Ie}=Fe(),je=(0,s.useRef)(void 0),{pageStore:we,spaceStore:be,spaceViewStore:ke,analyticsFrom:Te}=e,Ce=t.open?t:void 0,Me=null==Ce?void 0:Ce.csvHeaders,Be=null==Ce?void 0:Ce.csvSampleRows;(0,s.useEffect)((()=>{if(t.open&&Me&&!ye.current)try{const e=(null==Ce?void 0:Ce.userPropertyMapping)||[];if(void 0!==(null==Ce?void 0:Ce.firstRowAsHeader)&&ue(Ce.firstRowAsHeader),Me&&Me.length>0){if(g(Me),!Be)return;const t=(0,M().HL)({body:Be.map((e=>e.map((e=>({text:e}))))),intl:xe,randomShortID:W().Ay,isPhoneNumber:D().W,useCsvAdaptiveSchema:!1});let o=!1;const s={};if(Me.forEach(((e,a)=>{let n=t.types[a].schema.type||"text";o||"text"!==n||(n="title",o=!0),s[e]=n})),I(s),e.length>0){const t={};Me.forEach(((o,s)=>{const a=e.find((e=>e.headerName===o));if(a){const e=Re.find((e=>e.type===a.propertyType));e&&(t[s]=e.type)}})),h(t)}else{const e={};Me.forEach(((t,o)=>{const a=s[t];a&&(k().f.updatePropertyMapping(t,a),e[o]=a)})),h(e)}ye.current=!0}}catch(j){g([]),h({}),I({})}}),[t,Me,Be,Ce,xe]);const Le=(0,r().IS)((e=>({container:{padding:8,height:"100%",overflow:"hidden"},headerContainer:{display:"flex",width:296,flexDirection:"column",alignItems:"flex-start",gap:8,overflow:"hidden",paddingLeft:24,paddingRight:24,paddingTop:40},header:{color:e.text.primary,textAlign:"center",fontSize:26,fontStyle:"normal",fontWeight:p().Wy.semibold,letterSpacing:.208},description:{alignSelf:"stretch",color:e.text.secondary,fontFeatureSettings:"case on",fontSize:14,fontStyle:"normal",fontWeight:p().Wy.regular,letterSpacing:-.154},headerToggleRow:{display:"flex",alignItems:"center",width:"100%",marginTop:8,marginBottom:8},toggleLabel:{color:e.text.secondary,fontSize:14,fontWeight:p().Wy.regular,paddingLeft:8},mappingFrame:{flex:1,overflowY:"auto",padding:11,width:"100%",paddingLeft:24,paddingRight:24},customGrid:{display:"grid",gridTemplateColumns:"1fr 16px 1fr",gap:8,width:"100%",height:28},arrowCell:{display:"flex",alignItems:"center",justifyContent:"center"},headerButton:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:32,border:`1px solid ${e.stroke.primary}`},typeButton:{width:"100%",padding:"2px 6px",border:`1px solid ${e.stroke.primary}`,borderRadius:4,justifyContent:"space-between",height:32,background:e.buttonBackground},buttonContainer:{marginTop:16,display:"flex",justifyContent:"center",gap:8,width:"100%",paddingLeft:24,paddingRight:24},leftContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,position:"relative",height:"100%",minHeight:0,paddingRight:8,width:"37%",paddingTop:10},rightContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,height:"100%",flex:1,width:"58%"},columnHeading:{width:"100%",fontSize:12,fontWeight:p().Wy.regular,color:e.text.secondary},backButton:{borderRadius:"100%",top:1,left:1,margin:7}})),[]),Oe=(0,s.useCallback)((()=>{const e=!b;ue(e),k().f.updateUseFirstRowAsHeaders(e)}),[b]),We=(0,s.useCallback)((async()=>{let e;try{fe(!0);const o=(null==Ce?void 0:Ce.userPropertyMapping)||[];let s=0;const a=m.flatMap((e=>{const t=o.find((t=>t.headerName===e)),a=(null==t?void 0:t.propertyType)||S[e]||"text";return e=b||"dont_import"===a?e:"Column "+ ++s,"dont_import"===a?[{headerName:e,doNotImport:!0}]:"geo_point"===a?[]:[{headerName:e,propertyType:a,doNotImport:!1}]})),n="slash_command"===Te,r=await E().n3(l,be,ke,"csv",1,null==Ce?void 0:Ce.fileName,we,void 0,n);e=r.createdPage;const c={fileURL:(null==Ce?void 0:Ce.fileUrl)||"",fileName:(null==Ce?void 0:Ce.fileName)||"",importType:r.importType,block:{id:r.pageId,spaceId:r.spaceId},spaceId:r.spaceId,metadata:{csv:{columnHeaders:a,useFirstRowAsHeaders:(null==Ce?void 0:Ce.firstRowAsHeader)??b}}},d=(0,N().UT)(l,z().V,c);let p=!1;for await(const e of d){var t;if(e.error)throw e.error;if(("status"in e.value&&"created_collection"===(null===(t=e.value.status)||void 0===t?void 0:t.message)||"success"===e.taskStatus)&&!p){const e=Q().Bv.createChildStore(be,{table:L().ev,id:r.pageId}),t=(0,J().Ay)({store:e,preferPublicLink:!1,pageVisitSource:i().y8.Import});q().navigateOnBaseUrl({environment:l,url:t}),p=!0,k().f.close({type:"imported"}),y().A.reset()}}}catch(j){$().createAndCommit({userAction:"importActions.importFiles",environment:l,canUndo:!0,perform:t=>{e&&U().zz({parentStore:be.getPagesStore(),childStore:e,transaction:t})}});let o=u().A.formatMessage(E().DZ.importFailed);"CsvImportError"===(0,O().A)(j).message?o=u().A.formatMessage(X().mW.csv_import_inconsistent_columns):"ImportFileSizeTooLargeError"===(0,O().A)(j).message?o=u().A.formatMessage(E().DZ.fileImportFailedSizeTooLarge):"ImportcsvTooManyColumns"===(0,O().A)(j).message?o=u().A.formatMessage(E().DZ.csvImportFailedColumnsTooLarge):"ImportcsvTooManyRows"===(0,O().A)(j).message&&(o=u().A.formatMessage(E().DZ.csvImportFailedRowsTooLarge)),w(o)}finally{fe(!1)}}),[m,S,Ce,l,we,be,ke,Te,b]),ze=(0,s.useCallback)((()=>{w(""),k().f.close({type:"canceled"})}),[]),_e=(0,s.useCallback)(((e,t)=>{if(!Se)return;const{collectionStore:o}=Se,s=o.getSchema(),a=Object.entries(s).find((t=>{let[o,s]=t;return(null==s?void 0:s.name)===e}));if(!a)return;const[n,r]=a;r&&r.type!==t&&$().createAndCommit({userAction:"csvImport.updatePropertyType",environment:l,perform:e=>{_().Hj({environment:l,collectionStore:o,property:n,type:t,transaction:e})},canUndo:!0})}),[Se,l]),Ve=(0,s.useCallback)(((e,t)=>{if(!Se)return;const{collectionStore:o,collectionViewStore:s}=Se,a=o.getSchema(),n=Object.entries(a).find((t=>{let[o,s]=t;return(null==s?void 0:s.name)===e}));if(!n||!n[1])return;const[r]=n;$().createAndCommit({userAction:"csvImport.updatePropertyVisibility",environment:l,perform:e=>{const o=s.getFormat()||{},a=o.table_properties||[],n=a.findIndex((e=>e.property===r));if(-1===n)return;const i=[...a];i[n]={...i[n],visible:t},H().zv({store:s,data:{format:{...o,table_properties:i}},transaction:e})},canUndo:!0})}),[Se,l]),Ne=(0,s.useCallback)(((e,t)=>{const o=Re.find((e=>e.name===t));if(!o)return;const s=m[e];if(!s)return;const a=f[e];h((t=>({...t,[e]:o.type}))),k().f.updatePropertyMapping(s,o.type),je.current=s,Se&&("dont_import"===o.type?Ve(s,!1):("dont_import"===a&&Ve(s,!0),_e(s,o.type))),V().os({collectionSettingsStore:d})}),[d,m,Se,_e,f,Ve]),Ee=(0,s.useCallback)((e=>{Ae.current=e}),[]);return(0,s.useEffect)((()=>{var e;const t=je.current;if(!t||!Ae.current||!Se)return;const o=null===(e=Object.entries(Se.collectionStore.getSchema()).find((e=>{let[o,s]=e;return(null==s?void 0:s.name)===t})))||void 0===e?void 0:e[0];o&&(setTimeout((()=>{(0,te().c)({propertyId:o,collectionContextStore:Ae.current,environment:l,padding:50})}),100),je.current=void 0)}),[Se,l,f]),(0,A.jsxs)(me().Ye,{style:Le.container,children:[(0,A.jsxs)(me().wt,{style:Le.leftContainer,children:[(0,A.jsx)(ee().n9,{iconFn:F().w,onClick:()=>{w(""),k().f.previousStep()},style:Le.backButton}),(0,A.jsxs)(me().wt,{style:Le.headerContainer,children:[(0,A.jsx)(le().D,{styleName:"UITitle-30px/Semibold",customStyles:Le.header,children:u().A.formatMessage(Pe.heading)}),(0,A.jsx)(le().D,{styleName:"UIRegular-14px/Medium",customStyles:Le.description,children:u().A.formatMessage(Pe.description)}),(0,A.jsxs)(me().Ye,{style:Le.headerToggleRow,children:[(0,A.jsx)(G().A,{on:b,onClick:Oe}),(0,A.jsx)(le().D,{styleName:"UIRegular-14px/Medium",customStyles:Le.toggleLabel,children:u().A.formatMessage(Pe.useFirstRowAsHeaders)})]})]}),(0,A.jsx)(me().wt,{style:Le.mappingFrame,children:(0,A.jsxs)("div",{style:Le.customGrid,children:[(0,A.jsx)("div",{style:Le.columnHeading,children:"CSV File Columns"}),(0,A.jsx)("div",{children:null}),(0,A.jsx)("div",{style:Le.columnHeading,children:"Property Type"}),m.map(((e,t)=>(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)(ce().A,{disabled:!0,style:Le.headerButton,children:(0,A.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:e})}),(0,A.jsx)("div",{style:Le.arrowCell,children:(0,P().P)({width:16,height:16})}),(0,A.jsx)(ae().Ay,{popupType:ae().z7.Popup,placementToOrigin:ae().sx.Bottom,renderOrigin:o=>(0,A.jsxs)(oe().p,{...o,style:Le.typeButton,children:[(0,A.jsxs)(me().Ye,{style:{gap:8,flex:1,overflow:"hidden"},children:["dont_import"===f[t]?(0,A.jsx)(K().I,{icon:R().e,size:16,color:"tertiary"}):(0,A.jsx)(C().zB,{type:f[t]||S[e]||"text",size:16,icon:void 0,theme:he}),(0,A.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"dont_import"===f[t]?he.text.tertiary:void 0},children:f[t]&&De(f[t])||S[e]&&De(S[e])||"Don't import"})]}),(0,B().b)({width:12,height:12,fill:he.regularIconColor})]}),render:s=>{const a={menuType:Z().gu.Popup,width:200},n=[{key:"propertyTypes",render:e=>(0,A.jsx)(pe().A,{...e}),items:(x?Re.filter((e=>{let{name:t}=e;return t.toLowerCase().includes(x.toLowerCase())})):Re).map((o=>{let{type:a,name:n}=o;return{key:a,action:()=>{Ne(t,n),s.close()},render:o=>(0,A.jsx)(se().A,{...o,title:n,titleStyle:"dont_import"===a?{color:he.text.tertiary}:void 0,icon:"dont_import"===a?(0,A.jsx)(K().I,{icon:R().e,size:16,color:"tertiary"}):(0,A.jsx)(C().zB,{type:a,size:16,icon:void 0,theme:he}),isChecked:f[t]===a||!f[t]&&S[e]===a})}}))}];return(0,A.jsxs)(re().A,{...a,children:[(0,A.jsx)(pe().A,{shouldShowBottomDivider:!1,children:(0,A.jsx)(ne().Ay,{focusInitial:!o.isMobile||void 0,focus:!o.isMobile||void 0,value:x,onChange:e=>{v(e.target.value)},placeholder:u().A.formatMessage(Pe.searchPlaceholder),showClearButton:!0})}),(0,A.jsx)(ie().Ay,{type:ie().Oh.Vertical,initialFocus:0,sections:n})]})}})]},t)))]})}),(0,A.jsxs)(me().wt,{style:Le.buttonContainer,children:[j&&(0,A.jsx)(me().wt,{children:(0,A.jsx)(le().D,{styleName:"UISmall-12px/Regular",colorName:"uiYellowPrimary",children:j})}),(0,A.jsx)(de().A,{disabled:ge||void 0!==Ie,onClick:We,style:{height:36,fontWeight:p().Wy.regular},children:ge?(0,A.jsx)(Y().A,{}):u().A.formatMessage(Pe.importButton)}),(0,A.jsx)(oe().p,{isGray:!0,style:{paddingLeft:"44%"},onClick:ze,disabled:ge,children:u().A.formatMessage(Pe.cancelButton)})]})]}),(0,A.jsx)(me().wt,{style:Le.rightContainer,children:(0,A.jsx)(ve,{previewCollection:Se,onSetCollectionContextStore:Ee,validationState:Ie})})]})}const Re=[{type:"title",name:"Title"},{type:"text",name:"Text"},{type:"number",name:"Number"},{type:"select",name:"Select"},{type:"multi_select",name:"Multi-select"},{type:"date",name:"Date"},{type:"checkbox",name:"Checkbox"},{type:"url",name:"URL"},{type:"email",name:"Email"},{type:"phone_number",name:"Phone Number"},{type:"dont_import",name:"Don't import"}];function De(e){const t=Re.find((t=>t.type===e));return(null==t?void 0:t.name)||"Text"}o(113085);var Le=()=>o(561074),Oe=()=>o(83544),We=()=>o(524118),ze=()=>o(169201),_e=()=>o(956548),Ve=()=>o(433387),Ne=()=>o(350492),Ee=()=>o(827086),Ue=()=>o(361308),He=()=>o(455831),qe=()=>o(663539),$e=()=>o(764227),Ye=()=>o(780942),Ke=()=>o(286270);const Ge=(0,c().YK)({title:{id:"csvImport.uploadStep.title",defaultMessage:"Import CSV into Notion"},description:{id:"csvImport.uploadStep.description",defaultMessage:"Create a new table with your CSV data"},uploadButton:{id:"csvImport.uploadStep.uploadButton",defaultMessage:" Choose file"},mapHeadersButton:{id:"csvImport.uploadStep.mapHeadersButton",defaultMessage:"Map CSV headers"},uploadHeader:{id:"csvImport.uploadStep.uploadHeader",defaultMessage:"Upload CSV"},uploadProgress:{id:"csvImport.uploadStep.uploadProgress",defaultMessage:"Uploading... {percentComplete}%"},learnAboutImports:{id:"csvImport.uploadStep.learnAboutImports",defaultMessage:"Learn about imports"},csvEmptyFile:{id:"csvImport.uploadStep.errors.emptyFile",defaultMessage:"CSV file is empty. Please upload a file with data."},csvHeadersOnly:{id:"csvImport.uploadStep.errors.headersOnly",defaultMessage:"CSV file contains headers but no data rows. Please upload a file with actual data."},csvInconsistentRows:{id:"csvImport.uploadStep.errors.inconsistentRows",defaultMessage:"CSV has inconsistent row lengths. Some rows have a different number of columns than the header."},csvParseError:{id:"csvImport.uploadStep.errors.parseError",defaultMessage:"Unable to parse CSV file. Please check the format and try again."},csvTooManyColumns:{id:"csvImport.uploadStep.errors.tooManyColumns",defaultMessage:"CSV has too many columns. Maximum allowed is 999 columns."}}),Xe=20480,Je=100,Ze=30,Qe=999;function et(e){return e?e.length<=Ze?e:`${e.slice(0,Ze-3)}...`:""}function tt(){const e=(0,n().O$)(k().f),t=(0,a().v3)(),[o,i]=(0,s.useState)(0),[l,d]=(0,s.useState)(!1),[m,g]=(0,s.useState)(!1),[f,h]=(0,s.useState)(!1),[y,x]=(0,s.useState)(""),v=s.useRef(!0);(0,s.useEffect)((()=>{v.current=e.open}),[e.open]),(0,s.useEffect)((()=>{e.open&&e.csvHeaders&&e.csvSampleRows&&h(!0)}),[e]);const S=(0,s.useCallback)((async()=>{try{h(!1);const e=await qe().dA({environment:t,supportsMobileNativeFileUpload:!1,multiple:!1,accept:".csv"});if(x(""),0===e.length||!(e[0]instanceof File))return;const o=e[0];d(!0);const s=(0,$e().AI)();if(o.size>(0,He().HG)(s))throw new(We().s76)("ImportFileSizeTooLargeError",{clientData:{type:"upload_file_size_exceeded",code:"fileImportError",messageValues:{maxSize:Ue().z3((0,He().HG)(s),1)}}});g(!0);const a=new FileReader,n=new Promise((e=>{a.onload=t=>{try{var o;const s=null===(o=t.target)||void 0===o?void 0:o.result;if("string"==typeof s){const t=(0,M().CO)(s);if(t.length>0){const o=t[0],s=t.slice(1,Math.min(t.length,Je+1));return void e({headers:o,sampleRows:s})}}e(null)}catch(y){e(null)}},a.onerror=()=>{e(null)}})),r=o.slice(0,Xe);a.readAsText(r);const l=await new Promise(((e,s)=>{qe().Zn({environment:t,uploadType:"csv",files:[o],bucket:"temporary",bypassFreeFileUploadLimitCheck:!0,onBatchStart:()=>{i(0)},onBatchProgress:e=>{let{progressPercent:t}=e;i(t??0)},onBatchCompleteWithToken:t=>{i(100),e(t)},onBatchError:e=>{s(e)}})})),c=await n;if(g(!1),c){if(0===c.headers.length||1===c.headers.length&&""===c.headers[0].trim())return x(u().A.formatMessage(Ge.csvEmptyFile)),void d(!1);if(0===c.sampleRows.length)return x(u().A.formatMessage(Ge.csvHeadersOnly)),void d(!1);if(c.headers.length>Qe)return x(u().A.formatMessage(Ge.csvTooManyColumns)),void d(!1);const e=c.headers.length;if(c.sampleRows.slice(0,5).some((t=>t.length!==e)))return x(u().A.formatMessage(Ge.csvInconsistentRows)),void d(!1)}else if(o.size>0)return x(u().A.formatMessage(Ge.csvParseError)),void d(!1);if(!v.current)return d(!1),void g(!1);v.current&&k().f.setFileMetadata(o.name,l[0].fileUrl,o.size),c&&(k().f.setCsvData(c.headers,c.sampleRows),h(!0)),d(!1)}catch(y){if(!v.current)return;const t=(0,O().A)(y);if(t instanceof We().s76&&"upload_file_size_exceeded"===t.body.clientData.type&&"messageValues"in t.body.clientData){const e=u().A.formatMessage(E().DZ.fileImportFailedCustomSizeTooLarge,{maxSize:t.body.clientData.messageValues.maxSize});x(e)}else{const e=u().A.formatMessage(E().DZ.importFailedWithError);x(e)}d(!1),g(!1),h(!1)}}),[t]),j=(0,s.useCallback)((()=>{k().f.nextStep()}),[]),b=(0,s.useCallback)((()=>{k().f.close({type:"canceled"})}),[]),T=(0,r().IS)((e=>({container:{display:"flex",width:"87%",flexDirection:"column",alignItems:"flex-start",gap:8,overflow:"hidden",marginLeft:24,marginRight:24},shimmerContainer:{borderRadius:12,border:`1px solid ${e.stroke.secondary}`,backgroundColor:"dark"===e.mode?e.popoverWaxPaperBackground:void 0,backgroundImage:`url(${Oe().A.images.workflowTemplates.bgDotsPng})`,backgroundRepeat:"repeat",backgroundSize:"70px 70px",backgroundPosition:"0% 0%",backgroundBlendMode:"multiply",position:"absolute",userSelect:"none",inset:0,zIndex:10,paddingTop:16,paddingBottom:16,paddingRight:16},header:{opacity:.6,paddingBottom:20,borderBottom:`1px solid ${e.stroke.primary}`},title:{color:e.text.primary,textAlign:"center",fontSize:26,fontStyle:"normal",fontWeight:p().Wy.semibold,letterSpacing:.208},description:{alignSelf:"stretch",color:e.text.secondary,fontFeatureSettings:"case on",fontStyle:"normal",fontWeight:p().Wy.regular,letterSpacing:-.154},closeButton:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:8,flexShrink:0,borderRadius:12,backdropFilter:"blur(16px)",margin:14},leftContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,paddingBottom:14,position:"relative",height:"100%",minHeight:0,overflow:"auto",width:"37%"},rightContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,height:"100%",flex:1,paddingTop:8,paddingBottom:8,paddingRight:8},subheader:{color:e.text.secondary,fontSize:12,fontStyle:"normal",fontWeight:p().Wy.regular,marginBottom:6},buttonContainer:{marginTop:16,display:"flex",justifyContent:"center",gap:8,width:"87%",position:"absolute",bottom:12,left:24,right:24},columns:{display:"grid",gridTemplateColumns:"3fr 2fr 2fr",gap:45},shimmer:{width:"50%",height:9,borderRadius:5,background:"#A6A6A6"},shimmerWide:{width:"100%",height:9,borderRadius:5,background:"#A6A6A6"}})),[]);return e.open?(0,A.jsxs)(me().Ye,{style:{height:"100%",minHeight:0,overflow:"hidden"},children:[(0,A.jsxs)(me().wt,{style:T.leftContainer,children:[(0,A.jsx)(me().Ye,{style:T.closeButton,children:(0,A.jsx)(ee().n9,{iconFn:ze().u,onClick:b,style:{left:1,top:1}})}),(0,A.jsxs)(me().Ye,{style:T.container,children:[(0,A.jsx)(le().D,{styleName:"UITitle-30px/Semibold",colorName:"primary",customStyles:T.title,children:(0,A.jsx)(c().sA,{...Ge.title})}),(0,A.jsx)(le().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",customStyles:T.description,children:(0,A.jsx)(c().sA,{...Ge.description})})]}),(0,A.jsxs)(me().Ye,{style:{width:"87%",marginLeft:24,marginRight:24,flexDirection:"column",paddingTop:24},children:[(0,A.jsx)(I().A,{style:T.subheader,children:(0,A.jsx)(c().sA,{...Ge.uploadHeader})}),(0,A.jsxs)("div",{style:{position:"relative",width:"100%"},children:[e.fileName&&!l?(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[(0,A.jsxs)(Ke().E,{style:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,height:32},children:[(0,A.jsx)(K().I,{icon:_e().pageIcon,size:"default",color:"primary"}),(0,A.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block",marginLeft:8},children:et(e.fileName)})]}),(0,A.jsx)(Ke().E,{onClick:()=>{k().f.setState({...e,fileName:"",fileUrl:"",fileSize:0,csvHeaders:void 0,csvSampleRows:void 0,userPropertyMapping:[]})},style:{flexShrink:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,height:32},children:(0,Ee().xMarkIcon)({width:16,height:16})})]}):(0,A.jsx)(Ke().E,{style:{width:"100%",height:32},onClick:S,disabled:l||m,children:l?(0,A.jsx)(c().sA,{...Ge.uploadProgress,values:{percentComplete:o}}):m?"Processing CSV...":(0,A.jsxs)(me().Ye,{children:[(0,A.jsx)(K().I,{icon:Ve().o,size:"default",color:"primary"}),(0,A.jsx)(c().sA,{...Ge.uploadButton})]})}),l&&(0,A.jsx)("div",{style:{position:"absolute",left:0,top:0,height:"100%",width:`${o}%`,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4,transition:"width 0.3s ease"}})]}),y&&(0,A.jsx)(me().wt,{style:{paddingTop:4},children:(0,A.jsx)(le().D,{styleName:"UISmall-12px/Regular",colorName:"uiYellowPrimary",children:y})})]}),(0,A.jsxs)(me().wt,{style:T.buttonContainer,children:[(0,A.jsx)(de().A,{onClick:j,disabled:!e.fileName||e.isLoading||m||!f,style:{gap:6,height:36,fontWeight:p().Wy.regular},children:(0,A.jsx)(c().sA,{...Ge.mapHeadersButton})}),(0,A.jsxs)(Ye().p,{isGray:!0,style:{paddingLeft:"27%",gap:6,height:32},onClick:()=>window.open("https://www.notion.com/help/import-data-into-notion","_blank"),children:[(0,Ne().questionMarkCircleSmallIcon)({width:16,height:16}),(0,A.jsx)(c().sA,{...Ge.learnAboutImports})]})]})]}),(0,A.jsx)(me().wt,{style:T.rightContainer,children:(0,A.jsx)(Le().P.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:ot,style:{width:"100%",height:"100%",position:"relative"},children:(0,A.jsxs)(w().Y1,{direction:"vertical",height:"fill",width:"fill",padding:"36px 38px",style:T.shimmerContainer,gap:30,children:[(0,A.jsxs)(w().Y1,{direction:"horizontal",align:"center-left",gap:12,height:50,style:T.header,children:[(0,A.jsx)(K().I,{icon:ue().T,size:"xl",color:"secondary"}),(0,A.jsx)(le().D,{styleName:"Title-24px/Bold",colorName:"secondary",customStyles:{fontWeight:p().Wy.semibold},children:et(e.fileName.replace(/\.csv$/i,"")||"New table")})]}),(0,A.jsx)("div",{style:T.columns,children:Array.from({length:3}).map(((e,t)=>(0,A.jsxs)(w().Y1,{direction:"vertical",gap:25,children:[(0,A.jsx)(Ke().E,{disabled:!0,style:T.shimmer}),Array.from({length:5}).map(((e,t)=>(0,A.jsx)(Ke().E,{disabled:!0,style:T.shimmerWide},t)))]},t)))})]})})})]}):null}const ot={type:"spring",stiffness:150,damping:20,delay:.5};function st(){return null}function at(){return null}function nt(e){const t=(0,n().O$)(k().f);(0,s.useEffect)((()=>{if(t.open){const t=g().default.state.currentSpaceStore;if(!t)return;const o=t.id;k().f.setSpaceId(o),e.pageStore?k().f.setParent(e.pageStore.id,"block"):k().f.setParent(o,"space")}}),[t.open,e.pageStore]);const o=(0,s.useCallback)((()=>{t.open&&k().f.close({type:"canceled"})}),[t]),a=(0,n().K8)((()=>t.open?k().f.getCurrentStep():void 0),[t]),r=(0,s.useCallback)((()=>{k().f.close({type:"canceled"})}),[]),i=(0,s.useMemo)((()=>({width:{type:"fixed",length:1e3},height:{type:"fixed",length:650}})),[]);return a&&t.open?(0,A.jsx)(b().s,{isOpen:!0,areaConstraint:i,onDismiss:o,onClosed:r,backgroundAppearance:"wash",render:t=>{let{sizeRange:o}=t;return(0,A.jsx)(w().Y1,{style:o,children:(0,A.jsx)(rt,{currentModalStep:a,pageStore:e.pageStore,spaceStore:e.spaceStore,spaceViewStore:e.spaceViewStore,analyticsFrom:e.analyticsFrom})})}}):null}function rt(e){let{currentModalStep:t,pageStore:o,spaceStore:s,spaceViewStore:a,analyticsFrom:r}=e;if(!(0,n().K8)((()=>k().f.state),[]).open)return null;switch(t){case"uploadFile":return(0,A.jsx)(tt,{});case"mapFieldsForImport":return(0,A.jsx)(Be,{pageStore:o,spaceStore:s,spaceViewStore:a,analyticsFrom:r});case"mapFieldsForMerge":return(0,A.jsx)(st,{});case"importing":return(0,A.jsx)(at,{});default:(0,j().HB)(t)}}var it=()=>o(239092);const lt=function(e){let{fetchActiveImportTasks:t,analyticsFrom:a}=e;const r=(0,n().O$)(it().A),i=(0,s.useCallback)((()=>{it().A.resetImport()}),[]),l=(0,n().K8)((()=>(0,o(405431).G)()),[]),d=(0,s.useCallback)((()=>{let{currentTab:e}=r;return l?"selectData"===e&&(e="chooseWorkspace"):it().A.setState({...r,selectedImportType:"ProjectsAndTasks"}),(0,A.jsx)(o(484252).A,{fetchActiveImportTasks:t,tab:e,analyticsFrom:a})}),[l,t,r,a]),p=(0,c().tz)();return(0,A.jsx)(v().a,{ariaLabel:p.formatMessage({id:"mondayImportModal.modal.ariaLabel",defaultMessage:"Monday import modal"}),open:r.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675,...l?{borderRadius:12,width:900}:{}},render:()=>(0,A.jsx)(x().A,{capture:!0,allowEsc:!0,render:()=>d()}),onDismiss:i})};const ct=(0,c().YK)({tabTitle:{id:"importsTab.title",defaultMessage:"Import data"},importOrMigrateTitle:{id:"importsTab.importOrMigrateTitle",defaultMessage:"Import or migrate"},tabSubtitle:{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"},unsupportedImportsHelperText:{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we donâ€™t support yet, you can try importing it via CSV file."},zipImportTitle:{id:"importsTab.zipImport.title",defaultMessage:"Donâ€™t see the app you use? Import a ZIP file, and Notion will convert DOCX, CSV, Text, Markdown, HTML and EPUB files into Notion pages."},activeImportsAndSyncsTitle:{id:"importsTab.activeImportsAndSyncs.title",defaultMessage:"Active imports & syncs"},activeImportsTitle:{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"},activeImportsImportTime:{id:"importsTab.activeImports.importTime",defaultMessage:"Time"},activeImportsImportFrom:{id:"importsTab.activeImports.importFrom",defaultMessage:"From"},activeImportsImportStatus:{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"},activeImportsTableNoActiveImports:{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."},activeImportsStatusInProgress:{id:"activeImports.status.inProgress",defaultMessage:"In progress"}}),dt=function(e){const t=(0,n().O$)(g().default),x=(0,n().O$)(y().A),v=(0,n().O$)(f().A),j=(0,n().O$)(h().A),w=x.openedFrom??"modal",{currentSpaceStore:b,mainEditorCurrentBlockStore:k,currentSpaceViewStore:T,currentUserSettingsStore:C}=t,M=(0,a().v3)(),{device:F}=(0,a().v3)(),P=(0,c().tz)(),B=(0,n().K8)((()=>"dark"===M.ThemeStore.state.mode),[M]),[R,D]=(0,s.useState)([]),L=(0,n().K8)((()=>(0,o(370639).pB)()),[]),O=(0,s.useCallback)((async()=>{if(null==b||!b.id)return;const e=await m().callApi({eventName:"getActiveImportTasks",environment:M,data:{spaceId:b.id}});"success"===e.type&&D(e.data)}),[b,M]);(0,s.useEffect)((()=>{O().catch((()=>{}));const e=setInterval(O,6e4);return()=>clearInterval(e)}),[b,M,O]),(0,s.useEffect)((()=>{let e;const t=async s=>{const a=await m().callApi({eventName:"getAsanaWorkspacesNames",environment:M,data:{}});if(s+=1,"success"===a.type)if(null!=a&&a.data.account){var n;f().A.setState({...f().A.state,account:a.data.account,workspaces:a.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",selectedWorkspace:(null===(n=a.data)||void 0===n||null===(n=n.workspaces[0])||void 0===n?void 0:n.gid)||void 0,isModalOpen:!0})}else{if(s>o)return;e=setTimeout((()=>t(s)),2e3)}},o=180;if(v.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[v.isAccountLinkingInProgress,M]),(0,o(162901).Yb)((async()=>{let e;const t=async a=>{var n;const r=await m().callApi({eventName:"getEvernoteAccount",environment:M,data:{}});if(a+=1,"success"===r.type)if(null!=r&&r.data&&null!==(n=r.data)&&void 0!==n&&n.userInfo){h().A.setState({...h().A.state,isFetchingNotebooks:!0,showLoader:!0,linkingAccount:!1});const e=await m().callApi({eventName:"getEvernoteNotebooks",environment:M,data:{}});"success"===e.type&&h().A.setState({...h().A.state,notebooksResponse:e.data,isFetchingNotebooks:!1,showLoader:!1}),o(61096).A.setState({open:!0})}else{if(a>s)return;e=setTimeout((async()=>await t(a)),2e3)}},s=180;if(j.linkingAccount){const e=0;await t(e).catch((()=>{}))}return()=>{clearTimeout(e)}}),[j.linkingAccount,M]);const W=(0,r().IS)((e=>({activeImportAndSyncTitle:{fontSize:p().J.UIRegular.mobile,fontWeight:p().Wy.medium,lineHeight:p().K_.UIRegular.mobile},arrowDownIcon:{width:11,height:12,gap:10,radius:3,fill:"#ACABA9"},activeImportsStatusTimeDiv:{display:"flex",alignItems:"center",flexDirection:"row",gap:4},importTabSubtitle:{display:"flex",alignItems:"center",gap:6},importLearnMoreLink:{color:e.blueColor,fontSize:14,fontWeight:500}})),[]),z=L?(0,A.jsx)(c().sA,{id:"importsTab.activeImportsAndSyncs.title",defaultMessage:"Active imports & syncs"}):(0,A.jsx)(c().sA,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"}),_=(e,t)=>{o(505381).eH(M,{from:w,import_source:t}),o(191756).uK({environment:M,store:e,pageVisitSource:i().y8.Import}),y().A.reset()},V=(0,o(738695).w)();return b&&T&&T&&C?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(o(629457).A,{large:!F.isMobile||void 0,divider:F.isMobile?void 0:"full",children:V?P.formatMessage(ct.importOrMigrateTitle):P.formatMessage(ct.tabTitle)}),(0,A.jsxs)("div",{style:W.importTabSubtitle,children:[(0,A.jsx)(I().A,{isSecondaryColor:!!V||void 0,children:P.formatMessage(ct.tabSubtitle)}),(0,A.jsx)(o(579494).A,{style:W.importLearnMoreLink,href:"https://www.notion.com/help/import-data-into-notion",metaHref:"https://www.notion.com/help/import-data-into-notion",external:!0,children:(0,A.jsx)(c().sA,{id:"importsTab.learnMoreCta",defaultMessage:"Learn more",values:{boldtext:e=>(0,A.jsx)("span",{style:{fontWeight:500},children:e})}})})]}),!V&&(0,A.jsx)(I().A,{isSmall:!0,children:e.genericImporterEnabled&&!e.zipImporterEnabled?(0,A.jsx)(c().sA,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you're using isn't listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,A.jsx)("span",{style:{fontWeight:600},children:e})}}):P.formatMessage(ct.unsupportedImportsHelperText)}),(0,A.jsxs)("div",{style:{marginTop:16,width:"100%",overflow:"hidden"},children:[(0,A.jsx)(o(403812).A,{pageStore:k,spaceStore:b,spaceViewStore:T,userSettingsStore:C,analyticsFrom:w,onComplete:_,readOnlyCreditButton:!1}),(0,A.jsx)(S,{fetchActiveImportTasks:O,analyticsFrom:w}),(0,A.jsx)(lt,{fetchActiveImportTasks:O,analyticsFrom:w}),(0,A.jsx)(nt,{pageStore:k,spaceStore:b,spaceViewStore:T,analyticsFrom:w})]}),e.zipImporterEnabled&&(0,A.jsxs)("div",{style:{marginTop:18,width:"100%",gap:10,overflow:"hidden"},children:[!V&&(0,A.jsx)(I().A,{isSecondaryColor:!0,isMultiline:!0,style:{font:"SF Pro",fontWeight:400,fontSize:14},children:P.formatMessage(ct.zipImportTitle)}),(0,A.jsx)(o(387231).A,{onComplete:_,analyticsFrom:w})]}),(null==R?void 0:R.length)>0?(0,A.jsxs)("div",{style:{marginTop:32},children:[(0,A.jsx)(I().A,{isMultiline:!0,style:W.activeImportAndSyncTitle,children:z}),(0,A.jsx)(o(96365).A,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,A.jsxs)("div",{style:W.activeImportsStatusTimeDiv,children:[P.formatMessage(ct.activeImportsImportTime),(0,o(175532).P)(W.arrowDownIcon)]})},{key:"importFrom",header:P.formatMessage(ct.activeImportsImportFrom)},{key:"importStatus",header:P.formatMessage(ct.activeImportsImportStatus)}],rows:R.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,l().W_)(e.startedAt,"long",u().A.getIntl().locale)} ${(0,l().W_)(e.startedAt,"time",u().A.getIntl().locale)}`:"",(0,o(975392).ZH)(e.source),(0,A.jsx)(o(809785).A,{isRound:!0,showRemoveButton:!1,value:(0,A.jsx)(I().A,{children:P.formatMessage(ct.activeImportsStatusInProgress)}),backgroundColor:B?d().XA.dark.blue[200]:d().XA.light.blue[200],showColoredDot:"blue",format:o(752903).NY.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),R.length?(0,A.jsx)(A.Fragment,{}):(0,A.jsx)(I().A,{isSmall:!0,style:{marginTop:16},children:P.formatMessage(ct.activeImportsTableNoActiveImports)})]}):(0,A.jsx)(A.Fragment,{})]}):null}},350492:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>a,questionMarkCircleSmallIcon:()=>n});o(242343);var s=o(163643);const a={viewBox:"0 0 16 16",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M7.98 4.456c-1.044 0-2.053.604-2.298 1.584a.575.575 0 1 0 1.116.279c.083-.334.513-.713 1.183-.713.79 0 1.204.49 1.204.85 0 .219-.134.47-.443.658l-.011.006-.67.458-.003.002a1.82 1.82 0 0 0-.803 1.488.575.575 0 1 0 1.15 0c0-.193.102-.4.306-.541l.642-.44c.554-.342.982-.92.982-1.63 0-1.22-1.179-2-2.354-2m-.118 5.688a.775.775 0 1 0 0 1.55.775.775 0 0 0 0-1.55"}),(0,s.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},n=(0,o(680369).wt)("questionMarkCircleSmall",a)},387231:(e,t,o)=>{o.d(t,{A:()=>v,Q:()=>A});o(242343);var s=()=>o(524118),a=()=>o(214144),n=()=>o(653998),r=()=>o(197881),i=()=>o(505381),l=()=>o(145046),c=()=>o(581444),d=()=>o(477784),p=()=>o(485966),m=()=>o(242333);class u extends(()=>o(129044))().default{getInitialState(){return{isDragOverActive:!1}}}const g=new u;var f=()=>o(417653),h=()=>o(35462),y=o(163643);const x=(0,n().YK)({invalidFileFormat:{id:"zipImportOptions.invalidFile",defaultMessage:"Unsupported file format, Please drag and drop a ZIP file"}});const v=function(e){const t=(0,o(237385).v3)(),a=(0,o(803290).K8)((()=>g.state.isDragOverActive),[]),m=(0,o(738695).w)(),u=(0,o(174114).IS)((e=>({buttonStyle:{display:"flex",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:2,paddingBottom:2,borderColor:e.outlineButtonBorder,border:1,borderWidth:1,borderRadius:4,height:32,gap:4,background:e.importOptionsButtonBackground},titleStyle:{fontSize:14,fontWeight:"medium",font:"SF Pro",color:e.text.primary,width:183,height:18,textAlign:"center"},divTitleStyle:{color:e.text.secondary,display:"flex",background:a?e.fill.grayPrimary:e.fill.lightGraySecondary,width:"100%",padding:"16px",justifyContent:"center",alignItems:"center",gap:12,borderRadius:8,border:a?"2px solid":"none",borderColor:a?e.stroke.uiBlueSecondary:e.fill.lightGraySecondary},divStyle:{display:"flex",alignItems:"center",marginTop:10,minWidth:0,width:"100%",gap:10},UiLabelStyle:{color:e.text.secondary,font:"SF Pro",fontWeight:400,fontSize:14},containerStyle:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",paddingLeft:12,paddingRight:12,paddingTop:18,paddingBottom:18,marginBottom:32,borderColor:e.zipImport.border,borderStyle:"dashed",borderWidth:1,borderRadius:6,gap:4,background:e.zipImport.background},iconStyle:{width:24,height:24,marginBottom:8},zipContentContainerStyle:{display:"flex",alignItems:"center",justifyContent:"center"},zipContentStyle:{display:"block",maxWidth:480,paddingLeft:4,paddingRight:4,whiteSpace:"normal",wordBreak:"break-word",textAlign:"center"},zipContentChildrenStyle:{overflow:"visible",whiteSpace:"normal",marginRight:4},zipTitleStyle:{color:e.text.primary,fontWeight:500,fontSize:14},boldTextStyle:{fontWeight:500},zipTextStyle:{color:e.text.secondary,fontSize:12,overflow:"visible"},zipButtonStyle:{display:"inline-block"},buttonContainerStyle:{display:"inline",alignItems:"center",justifyContent:"center",background:"none"},zipButtonTextStyle:{color:e.zipImport.border}})),[a]),v=e=>{g.setState({...g.state,isDragOverActive:e})},I=o=>{o.preventDefault(),v(!1);const a=o.dataTransfer.files[0];(async function(e,t,o,a){var n;if(1!==t.length)return;if("zip"!==(null===(n=t[0].name.split(".").pop())||void 0===n?void 0:n.toLowerCase())){const e=d().A.formatMessage(x.invalidFileFormat);throw l().f1(e),new(s().yI4)("Invalid file format, please upload it as a zip file")}const{mainEditorCurrentBlockStore:m,currentSpaceStore:u,currentSpaceViewStore:g}=p().default.state;if(!u||!g||!m)return;const f=S();i().fJ(e,{import_source:"genericImporter",from:a,import_type:"file",flowId:f});const h=await c().lD({environment:e,pageStore:m,spaceStore:u,spaceViewStore:g,analyticsFrom:a,uploadType:"genericImporter",flowId:S()},t);h&&(r().v(e,{from:"import",type:"page",new_page_id:h.id,creating_block_id:h.id,parent_collection_id:h.getParentCollectionIdUpToTwoLevels()}),o(h,"zip"))})(t,[a],e.onComplete,e.analyticsFrom).then((()=>{})).catch((()=>{}))},w=e=>{e.preventDefault(),e.stopPropagation(),v(!0)},b=e=>{e.preventDefault(),v(!1)};return m?(0,y.jsxs)("div",{style:u.containerStyle,onDrop:I,onDragOver:w,onDragLeave:b,children:[(0,y.jsx)("img",{style:u.iconStyle,alt:"Zip upload icon",src:o(83544).A.images.import.zipCloudPng}),(0,y.jsx)(h().A,{isSecondaryColor:!0,style:u.zipTitleStyle,children:(0,y.jsx)(n().sA,{id:"zipImport.convertZipToPages",defaultMessage:"Convert Zip to pages"})}),(0,y.jsx)("div",{style:u.zipContentContainerStyle,children:(0,y.jsxs)("div",{style:u.zipContentStyle,children:[(0,y.jsx)(h().A,{isInline:!0,isSecondaryColor:!0,style:{...u.zipTextStyle,...u.zipContentChildrenStyle},children:(0,y.jsx)(n().sA,{id:"zipImport.convertZipToPagesDescription",defaultMessage:"Import a zip file that contains DOCX, CSV, Text, Markdown, HTML and EPUB files to convert to pages"})}),(0,y.jsx)(h().A,{isInline:!0,isSecondaryColor:!0,style:{...u.zipTextStyle,...u.boldTextStyle,...u.zipContentChildrenStyle},children:(0,y.jsx)(n().sA,{id:"zipImport.dragAndDropZip",defaultMessage:"Drag and drop a Zip file"})}),(0,y.jsx)(h().A,{isInline:!0,isSecondaryColor:!0,style:{...u.zipTextStyle,...u.zipContentChildrenStyle},children:(0,y.jsx)(n().sA,{id:"zipImport.dragAndDropOr",defaultMessage:"or"})}),(0,y.jsx)(f().A,{onClick:()=>A(t,"genericImporter",e.onComplete,e.analyticsFrom),style:{...u.buttonContainerStyle,...u.zipContentChildrenStyle,...u.zipButtonStyle},hoveredStyle:u.buttonContainerStyle,pressedStyle:u.buttonContainerStyle,children:(0,y.jsx)("div",{style:{minWidth:0,width:"100%"},children:(0,y.jsx)("div",{style:{display:"flex"},children:(0,y.jsx)("div",{style:{...u.zipTextStyle,...u.boldTextStyle,...u.zipButtonTextStyle},children:(0,y.jsx)(n().sA,{id:"zipImport.chooseFile",defaultMessage:"Choose file"})})})})})]})}),(0,y.jsx)(h().A,{isSecondaryColor:!0,style:u.zipTextStyle,children:(0,y.jsx)(n().sA,{id:"zipImport.maxFileSize",defaultMessage:"Maximum file size: 25MB"})})]}):(0,y.jsx)("div",{onDrop:I,onDragOver:w,onDragLeave:b,style:u.divStyle,children:(0,y.jsxs)("div",{style:u.divTitleStyle,children:[(0,y.jsx)(j,{icon:o(633627).Y}),(0,y.jsx)(h().A,{isSecondaryColor:!0,style:u.UiLabelStyle,children:(0,y.jsx)(n().sA,{id:"zipImport.dragAndDrop",defaultMessage:"Drag and drop your ZIP files here, or"})}),(0,y.jsx)(f().A,{onClick:()=>A(t,"genericImporter",e.onComplete,e.analyticsFrom),style:u.buttonStyle,children:(0,y.jsx)("div",{style:{minWidth:0,width:"100%"},children:(0,y.jsx)("div",{style:{display:"flex"},children:(0,y.jsx)("div",{style:u.titleStyle,children:(0,y.jsx)(n().sA,{id:"zipImport.uploadFile",defaultMessage:"Upload from your computer"})})})})})]})})};async function A(e,t,o,s){const a=p().default.state,{mainEditorCurrentBlockStore:n,currentSpaceStore:l,currentSpaceViewStore:d}=a;if(!l||!d||!n)return;const m=S();i().fJ(e,{import_source:"genericImporter",from:s,import_type:"file",flowId:m});const u=await c().un({environment:e,pageStore:n,spaceStore:l,spaceViewStore:d,analyticsFrom:s,uploadType:t,flowId:m,allowMultiple:!1});u&&(r().v(e,{from:"import",type:"page",new_page_id:u.id,creating_block_id:u.id,parent_collection_id:u.getParentCollectionIdUpToTwoLevels()}),o(u,"zip"))}function S(){return m().A.state.flowId||a().JW()}const I=20;function j(e){let{icon:t}=e;return(0,y.jsx)("div",{children:t({flexShrink:0,width:I,height:I,gap:10})})}},403812:(e,t,o)=>{o.d(t,{A:()=>Io});o(403517);var s=o(242343),a=()=>o(237385),n=()=>o(803290),r=()=>o(174114),i=()=>o(83544),l=()=>o(162901),c=()=>o(711361),d=()=>o(284594),p=()=>o(858280),m=()=>o(214144),u=()=>o(409103),g=()=>o(653998),f=()=>o(197881),h=()=>o(505381),y=()=>o(304410),x=()=>o(145046),v=()=>o(129044);class A extends v().default{getInitialState(){return{}}}const S=new A;var I=()=>o(818369),j=()=>o(70989);async function w(e){const{environment:t,spaceId:o,requestStore:s}=e;if(!t.currentUser.id)return x().rG({message:"Invalid details"}),void j().V();S.setState({...S.state,[o]:{...S.state[o],showLoader:!0}});const a=await I().callApi({eventName:"getConfluenceSpaces",environment:t,data:{spaceId:o}});if(await(null==s?void 0:s.refresh()),S.setState({...S.state,[o]:{...S.state[o],showLoader:!1}}),"failed"!==a.type)return S.setState({...S.state,[o]:{...S.state[o],spacesResult:a.data}}),a.data;console.error(a.error),x().Qg(a),j().V()}var b=()=>o(219020);function k(e){const{importType:t,spaceId:o,parentId:s,parentTable:a}=e;b().f.setState({open:!0,currentStepIndex:0,importType:t,fileName:"",fileUrl:"",fileSize:0,isLoading:!1,error:void 0,firstRowAsHeader:!0,previewCollectionInfo:void 0,importLocation:"new",teamspaceId:void 0,parentId:s,parentTable:a,spaceId:o})}var T=()=>o(738674),C=()=>o(581444),M=()=>o(994395),F=()=>o(436452),P=()=>o(137476),B=()=>o(231157),R=()=>o(836331);function D(){return R().default.checkGate({gateName:"csv_import_v2_screens"})}var L=()=>o(409488),O=()=>o(284771),W=()=>o(732761),z=()=>o(370639),_=()=>o(640979),V=()=>o(405431),N=()=>o(531019);var E=()=>o(392608),U=()=>o(548694),H=()=>o(738695),q=()=>o(907721),$=()=>o(773866),Y=()=>o(802955),K=()=>o(617198),G=()=>o(61096),X=()=>o(242333),J=()=>o(188594),Z=()=>o(963768),Q=()=>o(239092),ee=()=>o(331736),te=()=>o(330358),oe=()=>o(55998),se=()=>o(220413),ae=()=>o(485966),ne=()=>o(962373);const re=new(ne().A);var ie=()=>o(331516),le=()=>o(273520),ce=()=>o(356813),de=()=>o(579494),pe=()=>o(966789),me=()=>o(935091),ue=()=>o(858023),ge=()=>o(443252),fe=()=>o(88271),he=()=>o(103151),ye=()=>o(35462),xe=()=>o(31448),ve=()=>o(126451),Ae=()=>o(695951),Se=o(163643);function Ie(e){const{style:t}=e,o=(0,r().IS)((e=>({baseBadgeStyle:{fontWeight:xe().Wy.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?se().Ay.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content",...t}})),[t]);return(0,Se.jsx)(Ae().A,{style:{...o.baseBadgeStyle,...e.style},content:(0,Se.jsx)(g().sA,{id:"syncBadgeComponent.label",defaultMessage:"Sync"})})}const je={fontSize:16,fontWeight:xe().Wy.medium},we={fontSize:14,fontWeight:xe().Wy.medium},be=28,ke=24,Te={flexShrink:0,width:be,height:be,borderRadius:4,marginRight:10,background:se().Tj.white};const Ce=function(e){let{title:t,actionButton:s,onClick:a,tooltipEvents:n,icon:i,logo:l,caption:c,shouldWrapCaption:d,showSyncBadge:p,showNewBadge:m,showBetaBadge:u,tooltip:g}=e;const f=(0,r().DP)(),h=(0,H().w)();return(0,Se.jsx)(ve().A,{...n,onClick:a,style:Fe(f,h),children:(0,Se.jsxs)("div",{style:{width:"100%",...h?{display:"flex",alignItems:"center",flexWrap:"wrap"}:{}},children:[(0,Se.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[(0,Se.jsx)(Re,{icon:i,logo:l,isImportModalRedesignEnabled:h}),(0,Se.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,Se.jsxs)("div",{style:{display:"flex"},children:[(0,Se.jsx)("div",{style:h?we:je,children:t}),p&&(0,Se.jsx)(Ie,{}),m&&(0,Se.jsx)(o(402557).A,{}),u&&(0,Se.jsx)(o(862185).A,{}),(0,Se.jsx)("div",{style:{marginLeft:"auto"},children:s})]}),!h&&(0,Se.jsx)(De,{caption:c,shouldWrapCaption:d})]})]}),h&&c&&(0,Se.jsxs)("div",{style:{flex:"1 0 100%",marginTop:6,display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[(0,Se.jsx)(De,{caption:c,shouldWrapCaption:!0}),g]})]})})};function Me(e){return{flexShrink:0,width:e?ke:be,height:e?ke:be}}function Fe(e,t){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:4,...t&&{padding:12},marginBottom:12,cursor:"pointer",boxShadow:t?e.shadowXS:e.shadowSM,transition:"background 200ms ease-out",background:e.importOptionsButtonBackground}}function Pe(e,t){return{display:"flex",alignItems:"center",justifyContent:"center",width:t?ke:be,height:t?ke:be,borderRadius:4,marginRight:8,color:e.text.secondary,background:e.importOptionsIconWrapBackground}}function Be(e,t){return{fontSize:12,color:e.text.secondary,lineHeight:"16px",wordBreak:"keep-all",...!t&&{...xe().RC}}}function Re(e){let{icon:t,logo:o,isImportModalRedesignEnabled:s}=e;const a=(0,r().DP)();return o?(0,Se.jsx)("img",{style:s?{...Te,height:ke,width:ke}:Te,src:o}):t?(0,Se.jsx)("div",{style:Pe(a,s),children:t(Me(s))}):null}function De(e){let{caption:t,shouldWrapCaption:o}=e;const s=(0,r().DP)();return t?(0,Se.jsx)("div",{style:Be(s,o),children:t}):null}const Le={whiteSpace:"pre-wrap"};function Oe(e,t){return(0,Se.jsx)(he().A,{renderTooltip:()=>(0,Se.jsx)(ye().A,{style:{color:se().Ay.white},isSmall:!0,children:(0,Se.jsx)(g().sA,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:o=>(0,Se.jsx)(de().A,{...o,external:!0,href:e,style:{marginLeft:"auto"},children:(0,Se.jsx)(ce().A,{icon:d().$,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const We=function(){const e=(0,n().O$)($().A),{account:t,isLoadingAsanaWorkspaces:o,isAccountDelinkingInProgress:r,isAccountLinkingInProgress:l}=e,d=(0,a().v3)(),p=(0,g().tz)(),{device:u}=d,f=(0,H().w)(),x=(0,n().O$)(X().A),v=x.flowId||m().JW();(0,s.useEffect)((()=>{x.flowId||X().A.setState({flowId:v})}),[v,x]);const A={title:p.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:i().A.images.import.asanaPng,caption:l?p.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):r?p.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):t??(f?p.formatMessage({id:"asanaImportOption.asanaButton.defaultCaption",defaultMessage:"Migrate your projects and tasks"}):void 0),actionButton:t?(S=[{name:p.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:p.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>y().x3({environment:d,flowId:v}).catch((()=>{}))},{name:p.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>y().bk({environment:d})}],(0,Se.jsx)(le().Ay,{popupType:ge().nl.Popup,renderOrigin:e=>o?(0,Se.jsx)(pe().A,{}):(0,Se.jsx)(ce().A,{ariaLabel:p.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:c()._,...e}),render:e=>{const t={key:"section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:S.map((t=>{let{name:o,captionText:s,action:a}=t;return{key:o,render:e=>(0,Se.jsx)(ie().A,{...e,title:o,caption:s,captionStyle:s?Le:void 0}),action:()=>{a(),e.close()}}}))};return(0,Se.jsx)(me().A,{menuType:_().gu.Popup,width:200,children:(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:[t]})})}})):f?void 0:Oe((0,E().xS)("guides.importAsana"),p),onClick:()=>{}};var S;return(0,Se.jsx)(le().Ay,{onClick:async()=>{var e;h().fJ(d,{import_source:"asana",from:"settings_modal",userId:d.currentUser.id,spaceId:null===(e=ae().default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:v}),$().A.resetImport(),o||l||r||(t?(await y().xd({environment:d}),y().qf()):y().x3({environment:d,flowId:v}).catch((()=>{})))},popupType:u.isMobile?le().z7.SlideUp:le().z7.Popup,buttonPopupStore:re,renderOrigin:e=>{let{onClick:t}=e;return(0,Se.jsx)(Ce,{...A,onClick:t})},render:()=>null})};var ze=()=>o(921637),_e=(o(725707),o(500234),()=>o(198654)),Ve=()=>o(670481),Ne=()=>o(905053),Ee=()=>o(209684),Ue=()=>o(535906),He=()=>o(884373),qe=()=>o(441292),$e=()=>o(59175),Ye=()=>o(922172),Ke=()=>o(286404),Ge=()=>o(951540),Xe=()=>o(487966),Je=(o(491955),o(771702),()=>o(269280)),Ze=()=>o(188877);o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601);class Qe extends v().default{getInitialState(){return{searchQuery:"",selection:new Set}}}const et=Qe;var tt=()=>o(401382),ot=()=>o(975515),st=()=>o(610271);const at=function(e){let{searchInputPlaceholder:t,sections:o,noSearchResultsPlaceholder:s,handleClickImportConfluenceWorkspace:a,onComplete:r}=e;const i=(0,n().uB)(void 0,et);return(0,Je().l)((()=>{const e=i.state.selection,[t]=o;if(t){const[o]=t.items;o&&e.add(o.key)}i.emit()})),(0,Se.jsx)(me().A,{menuType:_().gu.Popup,header:(0,Se.jsx)(nt,{searchInputPlaceholder:t,store:i}),width:280,maxHeight:350,children:(0,Se.jsx)(rt,{sections:o,noSearchResultsPlaceholder:s,handleClickImportConfluenceWorkspace:a,onComplete:r,store:i})})};function nt(e){let{searchInputPlaceholder:t,store:o}=e;const s=(0,n().uB)(o,et),a=(0,n().K8)((()=>s.state.searchQuery),[s]);return(0,Se.jsx)(fe().A,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,Se.jsx)(tt().Ay,{focus:!0,focusAfterAnimation:!0,value:a,onChange:e=>{s.setState({...s.state,searchQuery:e.target.value})},placeholder:t})})}function rt(e){let{sections:t,noSearchResultsPlaceholder:o,handleClickImportConfluenceWorkspace:s,onComplete:a,store:r}=e;const i=(0,g().tz)(),l=(0,n().uB)(r,et),c=(0,n().K8)((()=>l.state.searchQuery),[l]),d=t.map((e=>{const t=(0,Ze().Ay)(c,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===d.length)return(0,Se.jsx)(fe().A,{children:(0,Se.jsx)(ot().A,{title:o})});const p=d.map((e=>{const o=e.items.map((e=>e.name)),n={};return o.forEach((e=>{n[e]=n[e]?n[e]+1:1})),{key:e.name,render:o=>(0,Se.jsx)(fe().A,{...o,title:t.length>1?e.name:void 0}),items:e.items.map((e=>({key:e.key,render:t=>(0,Se.jsx)(Ue().A,{...t,title:(0,Se.jsxs)(st().Ye,{gap:2,alignItems:"center",children:[e.name,n[e.name]>1&&(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>e.key,render:t=>(0,Se.jsx)(ce().A,{ariaLabel:i.formatMessage({id:"integrationConfluenceImportPopup.associatedSpaceKey",defaultMessage:"Associated space key: {key}"},{key:e.key}),disableBackground:!0,icon:Ve().G,...t})})]}),right:void 0!==e.count&&(0,Se.jsx)(ye().A,{isSmall:!0,children:e.count})}),action:()=>{s(e.key,e.name),function(e,t){t(e)}(e,a)}})))}}));return(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:p})}const it={whiteSpace:"pre-wrap"};function lt(e){const{key:t,value:o,spaceId:s}=e;S.setState({...S.state,[s]:{...S.state[s],[t]:o}})}function ct(e){var t;const{onSelectOption:o,options:s,currentOption:a}=e,n=null===(t=s.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,i=(0,r().IS)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,Se.jsx)(le().Ay,{popupType:le().z7.Popup,placementToOrigin:le().sx.Left,renderOrigin:e=>(0,Se.jsxs)(Ee().p,{...e,size:"lg",style:{opacity:1},disabled:!1,children:[n,(0,_e().b)(i.icon)]}),render:e=>{const t={menuType:_().gu.Popup,width:250,left:50},a=[{key:"settings-item-section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:s.map((t=>{let{key:s,label:a}=t;return{key:s,action:()=>{o(s),e.close()},render:e=>(0,Se.jsx)(Ue().A,{...e,title:a,shouldWrapCaption:!0,isChecked:n===a})}}))}];return(0,Se.jsx)(me().A,{...t,children:(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,sections:a,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function dt(e){await async function(e){const{environment:t,requestStore:o,userEmail:s,site:a,access_token:n,instance:r,spaceId:i,username:l,password:c,flowId:d}=e;if(!t.currentUser.id)return x().rG({message:"Invalid details"}),void j().V();const p=await I().callApi({eventName:"authenticateConfluenceUser",environment:t,data:{userEmail:s,site:a,access_token:n,instance:r,userId:t.currentUser.id,spaceId:i,username:l,password:c}});await o.refresh(),"failed"===p.type?(h()._$(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:p.error},flowId:d}),console.error(p.error),x().Qg(p)):(h()._$(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:d}),x().rG({message:"Successfully connected confluence instance."}),await w({environment:t,requestStore:o,spaceId:i})),j().V()}(e)}function pt(e){let{environment:t,title:o,email:s,accountType:a,site:i,APIToken:l,personalAccessToken:c,confluenceVersion:d,username:p,password:m,hidePopup:u,spaceId:f,flowId:h,requestStore:y}=e;const x=(0,n().K8)((()=>S.getState()),[]),v=(0,r().IS)((e=>({title:{fontWeight:xe().Wy.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"}})),[]);return(0,Se.jsx)(qe().A,{debugName:"ConfluenceImportOption",capture:!0,children:(0,Se.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,Se.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,Se.jsxs)("div",{style:{marginBottom:24},children:[(0,Se.jsx)("div",{style:v.title,children:o}),(0,Se.jsx)(Xe().A,{title:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8,marginLeft:-4}})]}),(0,Se.jsxs)("div",{children:[(0,Se.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,Se.jsx)("label",{htmlFor:"accountType",style:{...v.inputLabels},children:a}),(0,Se.jsx)(ct,{onSelectOption:e=>{lt({key:"instanceValue",value:e,spaceId:f})},options:[{key:"Cloud",label:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:x[f].instanceValue??"Cloud"})]}),(0,Se.jsx)(He().A,{size:12,isHidden:!0}),(0,Se.jsx)("div",{children:"Server"===x[f].instanceValue?(0,Se.jsxs)("div",{children:[(0,Se.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,Se.jsx)("label",{htmlFor:"confluenceVersion",style:{...v.inputLabels},children:d}),(0,Se.jsx)(ct,{onSelectOption:e=>{lt({key:"confluenceAuthenticationTypeValue",value:e,spaceId:f})},options:[{key:"OAuth2.0",label:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:x[f].confluenceAuthenticationTypeValue??"OAuth2.0"})]}),(0,Se.jsx)(He().A,{size:12,isHidden:!0})]}):void 0}),(0,Se.jsx)("label",{htmlFor:"email",style:{...v.inputLabels},children:s}),(0,Se.jsx)($e().A,{id:"email",value:x[f].emailValue,autoComplete:"off",autoCapitalize:"off",onChange:e=>{lt({key:"emailValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"notion@acmelabs.com",inputElementAttributes:{minLength:4}}),(0,Se.jsx)(He().A,{size:12,isHidden:!0}),(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"site",style:{...v.inputLabels},children:i}),(0,Se.jsx)($e().A,{id:"site",value:x[f].siteValue,onChange:e=>lt({key:"siteValue",value:e.target.value,spaceId:f}),showClearButton:!0,placeholder:"Cloud"===x[f].instanceValue?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,Se.jsx)(He().A,{size:12,isHidden:!0}),"Cloud"===x[f].instanceValue?(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"APIToken",style:{...v.inputLabels},children:l}),(0,Se.jsx)($e().A,{id:"AccessToken",type:"password",value:x[f].tokenValue,onChange:e=>{lt({key:"tokenValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4}})]}):(0,Se.jsx)("div",{children:(0,Se.jsx)("div",{children:"Basic"===x[f].confluenceAuthenticationTypeValue?(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"username",style:{...v.inputLabels},children:p}),(0,Se.jsx)($e().A,{id:"username",value:x[f].usernameValue,onChange:e=>{lt({key:"usernameValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,Se.jsx)(He().A,{size:12,isHidden:!0}),(0,Se.jsx)("label",{htmlFor:"password",style:{...v.inputLabels},children:m}),(0,Se.jsx)($e().A,{type:"password",id:"password",value:x[f].passwordValue,onChange:e=>{lt({key:"passwordValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:c}),(0,Se.jsx)($e().A,{id:"AccessToken",type:"password",value:x[f].tokenValue,onChange:e=>{lt({key:"tokenValue",value:e.target.value,spaceId:f})},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,Se.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,Se.jsx)(He().A,{size:24}),(0,Se.jsx)(Ge().A,{size:"lg",onClick:async()=>{const e=x[f].instanceValue??"Cloud",o=x[f].confluenceAuthenticationTypeValue??"OAuth2.0";await dt({environment:t,userEmail:x[f].emailValue,site:"/"===x[f].siteValue[x[f].siteValue.length-1]?x[f].siteValue.slice(0,-1):x[f].siteValue,access_token:"Server"===e&&"Basic"===o?void 0:x[f].tokenValue,instance:x[f].instanceValue??"Cloud",username:"Basic"===o?x[f].usernameValue:void 0,password:"Basic"===o?x[f].passwordValue:void 0,spaceId:f,flowId:h,requestStore:y}),u()},children:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,Se.jsx)(Ke().A,{size:"lg",style:{marginLeft:12},onClick:()=>{u()},children:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const mt=(0,g().j4)((function(e){var t,o;const s=(0,g().tz)(),r=(0,n().K8)((()=>S.getState()),[]),{spaceStore:l,flowId:c}=e,d=[{name:s.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:s.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",c),lt({key:"open",value:!0,spaceId:l.id})}},{name:s.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:s.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",c)}],p=(0,a().v3)(),{device:u}=p,{confluenceResult:f,onComplete:y,requestStore:x,spaceViewStore:v}=e,{account:A}=f,I={spacesResult:void 0,showLoader:!1},{showLoader:j}=r[l.id]||I;function b(e,t){h().mM(p,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:c})}function k(e){return(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,Se.jsx)(g().sA,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,Se.jsx)(at,{searchInputPlaceholder:s.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:s.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:o,selectedSpace:s,spaceStore:a,spaceViewStore:n,flowId:r}=e,i=await C().Od({environment:t,spaceStore:a,spaceViewStore:n,space:s,flowId:r||m().JW()});o(i,"confluence")}({environment:p,onComplete:y,selectedSpace:e,spaceStore:l,spaceViewStore:v,flowId:c})},handleClickImportConfluenceWorkspace:b})]})}const T=(0,H().w)(),M={title:"Confluence",logo:i().A.images.import.confluencePng,caption:A??(T?s.formatMessage({id:"confluenceImportOption.actionsMenu.defaultCaption",defaultMessage:"Transfer your team's documentation"}):void 0),actionButton:A&&j?(0,Se.jsx)(pe().A,{}):A&&e.renderItemActionsButton([{name:s.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",c)},{name:s.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",c),lt({key:"open",value:!0,spaceId:l.id})}},{name:s.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:o,requestStore:s}=e;S.setState({...S.state,[o]:{...S.state[o],showLoader:!1}}),await Ne().Pz(t,s,o)}({environment:p,spaceId:l.id,requestStore:x})}]),onClick:()=>{}},F=(null===(t=r[l.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],P={key:"default",name:s.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:F.map((e=>({id:e.id,key:e.key,name:e.name})))},B={key:"section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:d.map((e=>{let{name:t,captionText:o,action:s}=e;const a={key:t,render:e=>(0,Se.jsx)(ie().A,{...e,title:t,caption:o,captionStyle:o?it:void 0}),action:s};return a}))},R=s.formatMessage({id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),D=s.formatMessage({id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),L=s.formatMessage({id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),O=s.formatMessage({id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),W=s.formatMessage({id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),z=s.formatMessage({id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),V=s.formatMessage({id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),N=s.formatMessage({id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"});return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(le().Ay,{popupType:u.isMobile?le().z7.SlideUp:le().z7.Popup,onClick:()=>{h().fJ(p,{import_source:"confluence",from:"settings_modal",userId:p.currentUser.id,spaceId:l.id,flowId:c}),A&&w({environment:p,requestStore:x,spaceId:l.id}).catch((()=>{}))},buttonPopupStore:K().A,render:e=>A?function(e){return j?(0,Se.jsx)(Se.Fragment,{}):k(e)}(P):(0,Se.jsx)(me().A,{menuType:_().gu.Popup,width:200,children:(0,Se.jsx)(ue().Ay,{onAccept:e.close,type:ue().Oh.Vertical,initialFocus:void 0,sections:[B]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,Se.jsx)(Ce,{...M,onClick:t})}}),(0,Se.jsx)(Ye().a,{open:null===(o=r[l.id])||void 0===o?void 0:o.open,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{lt({key:"open",value:!1,spaceId:l.id})},render:()=>(0,Se.jsx)(pt,{hidePopup:()=>{lt({key:"open",value:!1,spaceId:l.id})},environment:p,title:(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>R,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:R,disableBackground:!0,icon:Ve().G,...e})})]}),accountType:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,Se.jsx)(he().A,{style:{width:300,whiteSpace:"normal"},placement:q().W.Right,renderTooltip:()=>D,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:D,disableBackground:!0,icon:Ve().G,...e})})]}),site:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,Se.jsx)(he().A,{style:{width:300,whiteSpace:"normal"},placement:q().W.Right,renderTooltip:()=>L,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:L,disableBackground:!0,icon:Ve().G,...e})})]}),APIToken:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>O,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:O,onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:Ve().G,...e})})]}),personalAccessToken:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,Se.jsx)(he().A,{placement:q().W.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>W,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:W,onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:Ve().G,...e})})]}),confluenceVersion:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,Se.jsx)(he().A,{style:{width:300,whiteSpace:"normal"},placement:q().W.Right,renderTooltip:()=>z,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:z,onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:Ve().G,...e})})]}),username:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>V,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:V,disableBackground:!0,icon:Ve().G,...e})})]}),password:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>N,render:e=>(0,Se.jsx)(ce().A,{ariaLabel:N,disableBackground:!0,icon:Ve().G,...e})})]}),spaceId:l.id,flowId:c,requestStore:x})})]})}));var ut=()=>o(66460),gt=()=>o(975392),ft=()=>o(110975),ht=()=>o(661584),yt=(o(362833),()=>o(559637)),xt=()=>o(932322),vt=()=>o(154104);const At=function(e){let{analyticsName:t,sections:o,searchInputPlaceholder:s,onComplete:a,noSearchResultsPlaceholder:r}=e;const i=(0,n().uB)(void 0,et);return(0,Je().l)((()=>{const e=i.state.selection,[t]=o;if(t){const[o]=t.items;o&&e.add(o.key)}i.emit()})),(0,Se.jsx)(me().A,{menuType:_().gu.Popup,header:(0,Se.jsx)(St,{analyticsName:t,sections:o,searchInputPlaceholder:s,store:i}),footer:(0,Se.jsx)(It,{sections:o,onComplete:a,store:i}),width:280,maxHeight:350,children:(0,Se.jsx)(jt,{sections:o,noSearchResultsPlaceholder:r,analyticsName:t,store:i})})};function St(e){let{analyticsName:t,sections:o,searchInputPlaceholder:r,store:i}=e;const l=(0,a().v3)(),c=(0,s.useCallback)((()=>function(e,t,o){const{selection:s}=o.state;s.clear(),o.emit(),h().aq(e,{integration_name:t})}(l,t,i)),[l,t,i]),d=(0,s.useCallback)((()=>function(e,t,o,s){const{selection:a}=s.state;for(const n of t)for(const e of n.items)a.add(e.key);s.emit(),h().V(e,{integration_name:o})}(l,o,t,i)),[l,o,t,i]),p=(0,n().K8)((()=>i.state.searchQuery),[i]),m=Boolean(p);return(0,Se.jsxs)(fe().A,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,Se.jsx)(tt().Ay,{focus:!0,focusAfterAnimation:!0,value:p,onChange:e=>{i.setState({...i.state,searchQuery:e.target.value})},placeholder:r}),(0,Se.jsx)(xt().Ay,{isTokenTitle:!0,style:{marginTop:2},title:(0,Se.jsxs)("div",{style:{marginLeft:-3},children:[(0,Se.jsx)(Ee().p,{isGray:!0,size:"xs",onClick:d,disabled:m,disabledFeedback:!0,children:(0,Se.jsx)(g().sA,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,Se.jsx)(vt().A,{disabled:m}),(0,Se.jsx)(Ee().p,{isGray:!0,size:"xs",onClick:c,disabled:m,disabledFeedback:!0,children:(0,Se.jsx)(g().sA,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}function It(e){let{sections:t,onComplete:o,store:a}=e;const r=(0,s.useCallback)((()=>function(e,t,o){const{selection:s}=o.state,a=gt().Bq(e.map((e=>e.items))),n=[];s.forEach((e=>{const t=a.find((t=>t.key===e));t&&n.push(t)})),t(n)}(t,o,a)),[t,o,a]),i=0===(0,n().K8)((()=>a.state.selection.size),[a]);return(0,Se.jsx)(fe().A,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,Se.jsx)(xt().Ay,{title:(0,Se.jsx)(Ge().A,{disabled:i,onClick:r,children:(0,Se.jsx)(g().sA,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}function jt(e){let{sections:t,noSearchResultsPlaceholder:o,analyticsName:s,store:r}=e;const i=(0,a().v3)(),{searchQuery:l,selection:c}=(0,n().K8)((()=>{const{searchQuery:e,selection:t}=r.state;return{searchQuery:e,selection:t}}),[r]),d=t.map((e=>{const t=(0,Ze().Ay)(l,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===d.length)return(0,Se.jsx)(fe().A,{children:(0,Se.jsx)(ot().A,{title:o})});const p=d.map((e=>({key:e.name,render:o=>(0,Se.jsx)(fe().A,{...o,title:t.length>1?e.name:void 0}),items:e.items.map((e=>{const t=()=>function(e,t,o,s){const{selection:a}=s.state;a.has(e.key)?(a.delete(e.key),h().VW(t,{integration_name:o})):(a.add(e.key),h().q5(t,{integration_name:o})),s.emit()}(e,i,s,r);return{key:e.key,render:o=>(0,Se.jsx)(Ue().A,{...o,title:e.name,icon:(0,Se.jsx)(yt().A,{checked:c.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,Se.jsx)(ye().A,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:p})}const wt=function(e){let{requestStore:t,analyticsFrom:o,evernoteResult:r,renderItemActionsButton:c,defaultActionButton:d,spaceStore:p,spaceViewStore:m,userSettingsStore:u,onComplete:f}=e;const y=(0,a().v3)(),x=(0,g().tz)(),v=(0,n().K8)((()=>ht().A.getState()),[]),A=(0,s.useCallback)((()=>async function(e,t,o){const{isFetchingNotebooks:s}=o;s&&await T().p({environment:e,requestStore:t})}(y,t,v)),[y,t,v]),{device:S}=y,{userInfo:w}=r,{notebooksResponse:b,showLoader:k}=v,M=(null==b?void 0:b.notebooks)||[],F=gt().$z(M,(e=>e.stack||"")),P=(0,H().w)();(0,l().Yb)((async()=>{v.linkingAccount||(await t.refresh(),j().V())}),[v.linkingAccount,t]);const B=Object.keys(F).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(F[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),R={title:"Evernote",logo:i().A.images.import.evernotePng,shouldWrapCaption:!w,caption:w?w.name||w.username||w.email:P?x.formatMessage({id:"evernoteImportOption.actionsMenu.defaultCaption",defaultMessage:"Bring your notes and notebooks"}):void 0,actionButton:w&&k?(0,Se.jsx)(pe().A,{}):w?c([{name:x.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:()=>function(e){ft().f({environment:e,url:(0,E().xS)("guides.importEvernote")})}(y)},{name:x.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>G().A.setState({open:!0})},{name:x.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>bt(t,y)},{name:x.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await I().callApi({eventName:"disconnectEvernote",environment:t,data:{}}),ht().A.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await e.refresh(),h().kO(t,{integration_name:"evernote"})}(t,y)}]):d,onClick:()=>{}};return(0,Se.jsx)(le().Ay,{popupType:S.isMobile?le().z7.SlideUp:le().z7.Popup,buttonPopupStore:G().A,onClick:A,render:()=>k?(0,Se.jsx)(Se.Fragment,{}):(0,Se.jsx)(At,{searchInputPlaceholder:x.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebookâ€¦"}),noSearchResultsPlaceholder:x.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:B,onComplete:e=>{!async function(e,t,o,s,a,n,r){const{notebooks:i}=e,l=i.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));h().Pd(r,{integration_name:"evernote",count:t.length});const c=await C().U7({environment:r,spaceStore:o,spaceViewStore:s,userSettingsStore:a,notebooks:l});h().mM(r,{import_source:"evernote",data:{notebooks:l.map((e=>e.guid)),userId:r.currentUser.id,spaceId:(0,ut().e)(o.id)},flowId:X().A.getOrCreateFlowId()}),n(c,"evernote")}(b,e,p,m,u,f,y)}}),renderOrigin:e=>{let{onClick:o}=e;return(0,Se.jsx)(Ce,{...R,onClick:async()=>{var e;h().fJ(y,{import_source:"evernote",from:"settings_modal",userId:y.currentUser.id,spaceId:null===(e=ae().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),w?o():await bt(t,y)}})}})};async function bt(e,t){await T().J({environment:t,requestStore:e})}var kt=()=>o(700380),Tt=()=>o(722793),Ct=()=>o(575479);const Mt=new(ne().A);const Ft=function(e){let{requestStore:t,renderItemActionsButton:o,spaceStore:r,spaceViewStore:l,pageStore:c,analyticsFrom:d,onComplete:p}=e;const m=(0,a().v3)(),u=(0,g().tz)(),f=(0,H().w)(),{loading:y,areAccountsFetched:x,accountsResponse:v,selectedFileId:A}=(0,n().K8)((()=>{const{loading:e,areAccountsFetched:t,accountsResponse:o,selectedFileId:s}=Ct().A.state;return{loading:e,areAccountsFetched:t,accountsResponse:o,selectedFileId:s}}),[]),S=(0,n().K8)((()=>Mt.state.open),[]),{device:j}=m,w=v.accounts,b=(0,s.useCallback)((async()=>{await Bt({environment:m,requestStore:t,areAccountsFetched:x,analyticsFrom:d,googleDriveResponse:v,pageStore:c,spaceStore:r,spaceViewStore:l,onComplete:p,selectedFileId:A})}),[m,t,x,d,c,p,l,r,v,A]),k={title:"Google Docs",logo:i().A.images.import.googleDocsPng,actionButton:w&&w.length>0&&o([{name:u.formatMessage({id:"googleDocImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>async function(e){const{requestStore:t,spaceStore:o,spaceViewStore:s,environment:a,analyticsFrom:n,pageStore:r,onComplete:i}=e,l=await kt().W3(a);l?(h()._$(a,{import_source:"gDocs",data:{import_type:"api",status:"success"}}),await t.refresh(),te().A.setState({...te().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),await Bt({environment:a,requestStore:t,areAccountsFetched:!1,analyticsFrom:n,googleDriveResponse:void 0,spaceStore:o,spaceViewStore:s,onComplete:i,pageStore:r})):h()._$(a,{import_source:"gDocs",data:{import_type:"api",status:"failure"}})}({environment:m,requestStore:t,analyticsFrom:d,pageStore:c,spaceStore:r,spaceViewStore:l,onComplete:p})},{name:u.formatMessage({id:"googleDocImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove All Accounts"}),action:()=>async function(e,t,o){if(!o||0===o.length)return;o.forEach((async e=>{await I().callApi({eventName:"disconnectDrive",environment:t,data:{googleUserId:e.accountId}})})),Ct().A.setState({...Ct().A.state,accountsResponse:{accounts:[]},loading:!1}),await e.refresh()}(t,m,w)}]),onClick:()=>{},caption:f?u.formatMessage({id:"googleDocsImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your documents seamlessly"}):void 0},T={type:"drive",title:(0,Se.jsx)(g().sA,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>await Pt({account:e,onComplete:p,requestStore:t,spaceStore:r,spaceViewStore:l,analyticsFrom:d,pageStore:c,environment:m,selectedFileId:A})};return(0,Se.jsx)(le().Ay,{open:S,popupType:j.isMobile?le().z7.SlideUp:le().z7.Popup,buttonPopupStore:Mt,onClick:b,onClose:()=>{Ct().A.setState({...Ct().A.state,selectedFileId:void 0})},render:()=>y?(0,Se.jsx)(Se.Fragment,{}):(0,Se.jsx)(Tt().HR,{tab:T,accounts:w,type:Tt().aD.Docs}),renderOrigin:e=>{let{onClick:t}=e;return(0,Se.jsx)(Ce,{...k,onClick:t})}})};async function Pt(e){const{account:t,requestStore:o,spaceStore:s,spaceViewStore:a,environment:n,analyticsFrom:r,pageStore:i,onComplete:l,selectedFileId:c}=e;t&&t.token||await async function(e){const{requestStore:t,spaceStore:o,spaceViewStore:s,environment:a,analyticsFrom:n,pageStore:r,onComplete:i,selectedFileId:l}=e;await kt().W3(a),await t.refresh(),await Bt({environment:a,requestStore:t,areAccountsFetched:!1,analyticsFrom:n,googleDriveResponse:void 0,spaceStore:o,spaceViewStore:s,onComplete:i,pageStore:r,selectedFileId:l})}({environment:n,requestStore:o,analyticsFrom:r,spaceStore:s,spaceViewStore:a,onComplete:l,pageStore:i,selectedFileId:c}),t&&t.token&&(c?await Rt({fileId:c,token:t.token,environment:n,spaceStore:s,spaceViewStore:a,analyticsFrom:r,onComplete:l,pageStore:i}):await(0,O().openGoogleDriveFilePicker)({environment:n,accessToken:t.token.accessToken,viewType:"documents",from:"import_google_doc",callback:async e=>{await Rt({fileId:e,token:t.token,environment:n,spaceStore:s,spaceViewStore:a,analyticsFrom:r,onComplete:l,pageStore:i})}}),Mt.setState({...Mt.state,open:!1}))}async function Bt(e){var t;const{requestStore:o,spaceStore:s,spaceViewStore:a,environment:n,analyticsFrom:r,pageStore:i,onComplete:l,googleDriveResponse:c,areAccountsFetched:d,selectedFileId:p}=e;h().fJ(n,{import_source:"gdocs",from:r,userId:n.currentUser.id,spaceId:null===(t=ae().default.state.currentSpaceStore)||void 0===t?void 0:t.id});let m=c;d||(Ct().A.setState({...Ct().A.state,loading:!0}),m=await kt().QZ(n),m&&m.accounts&&Ct().A.setState({...Ct().A.state,accountsResponse:m,areAccountsFetched:!0,loading:!1}));const u=m&&1===m.accounts.length?m.accounts[0]:void 0;return u?await Pt({account:u,onComplete:l,requestStore:o,spaceStore:s,spaceViewStore:a,analyticsFrom:r,pageStore:i,environment:n,selectedFileId:p}):(Mt.setState({...Mt.state,open:!0}),await o.refresh()),m}async function Rt(e){const{fileId:t,token:o,environment:s,spaceStore:a,spaceViewStore:n,analyticsFrom:r,onComplete:i,pageStore:l}=e;l&&(Ct().A.setState({...Ct().A.state,loading:!0}),await C().ZB({environment:s,fileId:t,token:o,spaceStore:a,spaceViewStore:n,pageStore:l,analyticsFrom:r}).then((e=>{i(e,"gdocs"),e&&f().v(s,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})})).catch((()=>{})),Ct().A.setState({...Ct().A.state,loading:!1,selectedFileId:void 0}))}o(113085);var Dt=()=>o(750094);const Lt=function(e){const t=(0,a().v3)(),{device:s}=t,{jiraResult:r,spaceStore:l,requestStore:c,analyticsFrom:d}=e,p=(0,n().K8)((()=>U().p4(l)),[l]),u=(0,n().K8)((()=>U().IL(l)),[l]),{account:f,isOwner:y}=(0,n().K8)((()=>{const e=r.account;if(e){const t=o(773082).A.state;if(t.loaded){const o=e.find((e=>t.externalAuthentications.some((t=>t.id===e.id))));return o?{account:o,isOwner:Boolean(o)}:{account:e[0],isOwner:!1}}}return{}}),[r]),x=(0,g().tz)(),v=[{name:x.formatMessage({id:"jiraImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{Dt().jh({environment:t,from:"import_settings",action:"add_account"});const e=Z().Ay.createNewFlowId();(0,P().u4)({environment:t,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"imports_tab",flowId:e}}})}}];f&&y&&v.push({name:x.formatMessage({id:"jiraImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>{Ne().ml({environment:t,requestStore:c,botId:f.id})}});const A=(0,H().w)(),S=(null==f?void 0:f.site)??(A?x.formatMessage({id:"jiraImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your issues and projects"}):void 0),I={title:"Jira",logo:i().A.images.externalIntegrations.jiraIconPng,onClick:()=>{},caption:S,actionButton:p&&f?e.renderItemActionsButton(v):null,showNewBadge:e.showNewBadge,showSyncBadge:e.showSyncBadge};return u?(0,Se.jsx)(Se.Fragment,{}):(0,Se.jsx)(le().Ay,{renderOrigin:e=>{let{onClick:o}=e;return(0,Se.jsx)(Ce,{...I,onClick:()=>{var e;h().fJ(t,{import_source:"jira",from:d,userId:t.currentUser.id,spaceId:null===(e=ae().default.state.currentSpaceStore)||void 0===e?void 0:e.id});const o=m().JW();Z().Ay.setState({...Z().Ay.state,flowId:o,spaceId:l.id,botId:null==f?void 0:f.id}),Dt().jh({environment:t,from:"import_settings",action:"show_teamspaces"}),(0,P().u4)({environment:t,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"imports_tab",flowId:o}}})}})},popupType:s.isMobile?le().z7.SlideUp:le().z7.Popup,render:()=>(0,Se.jsx)(Se.Fragment,{})})};var Ot=()=>o(484252);const Wt={whiteSpace:"pre-wrap"};function zt(e){const t=(0,g().tz)(),o=(0,n().O$)(Q().A),{environment:s,spaceStore:a,flowId:r}=e,i=t.formatMessage({id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),l=t.formatMessage({id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"});return(0,Se.jsx)(Ye().a,{open:o.showAuthPopup,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{Q().A.setState({...Q().A.state,showAuthPopup:!1})},render:()=>(0,Se.jsx)(_t,{hidePopup:()=>{Q().A.setState({...Q().A.state,showAuthPopup:!1})},environment:s,title:(0,Se.jsx)(g().sA,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>i,render:e=>(0,Se.jsx)(ce().A,{...e,ariaLabel:i,disableBackground:!0,icon:Ve().G})})]}),APIToken:(0,Se.jsxs)(st().Ye,{style:{alignItems:"center",gap:2},children:[(0,Se.jsx)(g().sA,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,Se.jsx)(he().A,{placement:q().W.Right,renderTooltip:()=>l,render:e=>(0,Se.jsx)(ce().A,{...e,ariaLabel:l,onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:Ve().G})})]}),flowId:r,spaceStore:a})})}function _t(e){let{environment:t,title:o,email:s,APIToken:a,hidePopup:i,flowId:l,spaceStore:c}=e;const d=(0,n().O$)(Q().A),p=(0,r().IS)((e=>({title:{fontWeight:xe().Wy.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"}})),[]);return(0,Se.jsx)(qe().A,{debugName:"MondayImportOption",capture:!0,children:(0,Se.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,Se.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,Se.jsxs)("div",{style:{marginBottom:24},children:[(0,Se.jsx)("div",{style:p.title,children:o}),(0,Se.jsx)(Ot().W,{style:{marginLeft:-4}})]}),(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"email",style:{...p.inputLabels},children:s}),(0,Se.jsx)($e().A,{id:"email",value:d.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{Q().A.setState({...Q().A.state,email:e.target.value})},showClearButton:!0,placeholder:"notion@acmelabs.com",inputElementAttributes:{minLength:4}}),(0,Se.jsx)(He().A,{size:12,isHidden:!0}),(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"APIToken",style:{...p.inputLabels},children:a}),(0,Se.jsx)($e().A,{id:"AccessToken",type:"password",value:d.APIToken,onChange:e=>{Q().A.setState({...Q().A.state,APIToken:e.target.value})},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4}})]})]})]}),(0,Se.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,Se.jsx)(He().A,{size:24}),(0,Se.jsx)(Ge().A,{size:"lg",onClick:async()=>{await M().Sq({environment:t,userEmail:d.email,APIToken:d.APIToken,flowId:l,spaceId:c.id}),i()},children:(0,Se.jsx)(g().sA,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,Se.jsx)(Ke().A,{size:"lg",style:{marginLeft:12},onClick:()=>{i()},children:(0,Se.jsx)(g().sA,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Vt=function(e){const t=(0,n().O$)(Q().A),o=(0,n().O$)(X().A),{account:r,isLoadingMondayWorkspaces:l}=t,{spaceStore:d}=e,p=(0,a().v3)(),u=(0,g().tz)(),{device:f}=p,y=o.flowId||m().JW();(0,s.useEffect)((()=>{o.flowId||X().A.setState({flowId:y})}),[y,o]);const x=(0,H().w)(),v={title:u.formatMessage({id:"mondayImportOption.mondayButton.title",defaultMessage:"Monday.com"}),logo:i().A.images.import.mondayPng,showNewBadge:!x,caption:r??(x?u.formatMessage({id:"mondayImportOption.actionsMenu.defaultCaption",defaultMessage:"Migrate your workspaces and tasks"}):void 0),actionButton:r?(A=[{name:u.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{Q().A.setState({...Q().A.state,showAuthPopup:!0})}},{name:u.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>M().pX({environment:p,spaceId:d.id})}],(0,Se.jsx)(le().Ay,{popupType:ge().nl.Popup,renderOrigin:e=>l?(0,Se.jsx)(pe().A,{}):(0,Se.jsx)(ce().A,{ariaLabel:u.formatMessage({id:"mondayImportOption.mondayButton.ariaLabel",defaultMessage:"Import from Monday.com button"}),icon:c()._,...e}),render:e=>{const t=A.map((t=>{let{name:o,captionText:s,action:a}=t;const n={key:o,render:e=>(0,Se.jsx)(ie().A,{...e,title:o,caption:s,captionStyle:s?Wt:void 0}),action:()=>{a(),e.close()}};return n})),o={key:"section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:t};return(0,Se.jsx)(me().A,{menuType:_().gu.Popup,width:200,children:(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:[o]})})}})):void 0,onClick:()=>{}};var A;return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(le().Ay,{onClick:async()=>{h().fJ(p,{import_source:"monday.com",from:e.analyticsFrom,userId:p.currentUser.id,spaceId:d.id,flowId:y}),Q().A.resetImport(),r?(await M().Jq({environment:p,spaceId:d.id}),M().qf()):Q().A.setState({...Q().A.state,showAuthPopup:!0})},popupType:f.isMobile?le().z7.SlideUp:le().z7.Popup,buttonPopupStore:re,renderOrigin:e=>{let{onClick:t}=e;return(0,Se.jsx)(Ce,{...v,onClick:t})},render:()=>null}),(0,Se.jsx)(zt,{environment:p,spaceStore:d,flowId:y})]})};var Nt=()=>o(268974),Et=()=>o(81322),Ut=()=>o(713055),Ht=()=>o(830226),qt=(o(610931),()=>o(145017)),$t=()=>o(704082);const Yt=(0,o(851552).Dv)("importQuip");var Kt=()=>o(477784);class Gt extends v().default{getInitialState(){return{showAuthPopup:!1,email:void 0,spaceId:void 0,personalAccessToken:void 0,companyId:void 0,account:void 0,accountEmail:void 0,isFetchingAccount:!1,authResponse:void 0,invalidFields:[]}}resetImport(){const{account:e,accountEmail:t}=this.getState();this.setState({...this.getInitialState(),account:e,accountEmail:t})}}const Xt=new Gt;var Jt=()=>o(413871),Zt=()=>o(839618);const Qt=(0,g().YK)({importFailed:{id:"quipActions.importFailedError.message",defaultMessage:"Import failed"},importingFromQuipMessage:{id:"quipActions.importingFromQuip.loadingMessage",defaultMessage:"Importing from quip."}});async function eo(e){const{environment:t,spaceStore:o}=e;if(!t.currentUser.id)throw new Error("User does not exist");let s,a;j().m({message:Qt.importingFromQuipMessage}),Xt.setState({...Xt.state});try{const e=await I().callApi({eventName:"getQuipAccount",environment:t,data:{spaceId:o.id}});if("success"!==e.type)throw new Error("User account does not exist");s=e.data.email;const n=(0,Zt().UT)(t,Yt,{userId:t.currentUser.id,email:s,page:{spaceId:o.id}});for await(const t of n){if(t.error)throw t.error;t.value.isComplete||(t.value.rootPageId&&(a=t.value.rootPageId),j().m(t.value.status))}if(!a)throw new Error("No root page");j().V();return Jt().Bv.createChildStore(o,{id:a,table:qt().ev,spaceId:o.id})}catch(n){throw x().f1(Kt().A.formatMessage(Qt.importFailed)),j().V(),new Error((0,$t().A)(n).message)}}var to=()=>o(611824);const oo={whiteSpace:"pre-wrap"},so=(0,g().YK)({authenticationFailed:{id:"quipActions.authenticationFailed.message",defaultMessage:"Authentication Failed (Please check user details)"},disconnectFailed:{id:"quipActions.disconnectFailed.message",defaultMessage:"Disconnect Account Failed"},headerTitle:{id:"quipActions.header.title",defaultMessage:"Import from Quip"},importCta:{id:"quipActions.importCta",defaultMessage:"Import"}});function ao(){return(0,r().IS)((e=>({title:{fontWeight:xe().Wy.semibold},inputLabels:{fontSize:xe().J.UISmall.desktop,fontWeight:xe().Wy.semibold,font:"SF Pro",lineHeight:xe().K_.UISmall.desktop,color:e.text.tertiary},placeHolder:{font:"SF Pro",fontWeight:xe().Wy.regular,fontSize:xe().J.UIRegular.desktop,lineHeight:xe().K_.UISmall.desktop},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.text.tertiary},inputBox:{width:"100%",height:28,padding:4,gap:4,radius:"default"},captionText:{font:"SF Pro",fontWeight:xe().Wy.regular,lineHeight:xe().K_.UISmall.desktop,fontSize:xe().J.UISmall.desktop,color:e.text.tertiary},spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0},wrapper:{padding:"20px 14px 10px 14px",height:"100%",display:"flex",flexDirection:"column"},header:{fontWeight:xe().Wy.medium,fontSize:17,textAlign:"center",marginTop:8},description:{fontWeight:xe().Wy.regular,color:e.text.secondary,fontSize:xe().J.UIRegular.desktop,maxHeight:72,textAlign:"center",padding:"0px 68px",marginBottom:24},icon:{height:40,width:40},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{width:20,height:20,opacity:.4,fontWeight:xe().Wy.bold,padding:3},notionLogo:{height:40,width:40,color:e.regularIconColor},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.text.secondary},headerWrapper:{marginBottom:18},invalidInput:{boxShadow:e.outlineRedInputBoxShadow},buttonItem:{color:e.text.secondary}})),[])}function no(e){const t=(0,n().O$)(Xt),o=ao(),{isFetchingAccount:s}=t,{environment:a,spaceStore:r,onComplete:i}=e;return(0,Se.jsx)(Ye().a,{open:t.showAuthPopup,innerStyle:{width:450,height:"fit-content",overflow:"scroll",borderRadius:5,maxHeight:675,minHeight:300,padding:6},onDismiss:()=>{Xt.setState({...Xt.state,invalidFields:[],showAuthPopup:!1,personalAccessToken:"",email:""})},render:()=>s?(0,Se.jsx)(ro,{loading:t.isFetchingAccount}):(0,Se.jsxs)("div",{style:o.wrapper,children:[(0,Se.jsx)(lo,{handleModalClose:()=>{Xt.setState({...Xt.state,showAuthPopup:!1})}}),(0,Se.jsx)(io,{email:(0,Se.jsx)(st().Ye,{style:{alignItems:"center",gap:2},children:(0,Se.jsx)(g().sA,{id:"quipAuthentication.emailMessage",defaultMessage:"Email"})}),personalAccessToken:(0,Se.jsx)(st().Ye,{style:{alignItems:"center",gap:2},children:(0,Se.jsx)(g().sA,{id:"quipAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"})})}),(0,Se.jsx)(co,{children:(0,Se.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,Se.jsx)(Ge().A,{onClick:async()=>{await async function(e){const{environment:t,email:o,personalAccessToken:s,spaceStore:a,companyId:n,account:r}=e,i=function(e){const{email:t,personalAccessToken:o}=e,s=[];t&&Ht().t(t,"email")||s.push("email");o||s.push("personalAccessToken");return s}({email:o,personalAccessToken:s});if(i.length)return void Xt.setState({...Xt.state,showAuthPopup:!0,isFetchingAccount:!1,invalidFields:i});if(r){if(!(await uo({environment:t,spaceStore:a})))return}const l=await async function(e){const{environment:t,email:o,personalAccessToken:s,spaceId:a,companyId:n}=e;if(Xt.setState({...Xt.state,isFetchingAccount:!0}),!(t.currentUser.id&&o&&a&&s))return;const r=await I().callApi({eventName:"authenticateQuipUser",environment:t,data:{userId:t.currentUser.id,email:o,personalAccessToken:s,spaceId:a,companyId:n}});return r&&"failed"!==r.type?r.data:void 0}({environment:t,email:o,personalAccessToken:s,spaceId:a.id,companyId:n});void 0===l?(x().rG({message:Kt().A.formatMessage(so.authenticationFailed)}),Xt.setState({...Xt.state,showAuthPopup:!0,isFetchingAccount:!1})):Xt.setState({...Xt.state,showAuthPopup:!1,isFetchingAccount:!1})}({environment:a,email:t.email,spaceStore:r,personalAccessToken:t.personalAccessToken,companyId:t.companyId,account:t.account});const e=await eo({environment:a,spaceStore:r});i(e,"quip")},children:(0,Se.jsx)(g().sA,{...so.importCta})})})})]})})}function ro(e){const t=ao();return(0,Se.jsx)(Se.Fragment,{children:e.loading&&(0,Se.jsx)("div",{style:t.spinner,children:(0,Se.jsx)(pe().A,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function io(e){let{email:t,personalAccessToken:o}=e;const s=(0,n().O$)(Xt),a=ao();return(0,Se.jsx)(qe().A,{debugName:"QuipImportOption",capture:!0,children:(0,Se.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"},children:(0,Se.jsx)("div",{style:{overflowY:"scroll"},children:(0,Se.jsxs)("div",{style:{padding:2},children:[(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"email",style:{...a.inputLabels},children:t}),(0,Se.jsx)(He().A,{size:8,isHidden:!0}),(0,Se.jsx)($e().A,{id:"email",value:s.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{Xt.setState({...Xt.state,email:e.target.value,invalidFields:[]})},showClearButton:!0,placeholder:"notion@acmelabs.com",style:{...a.inputBox,...s.invalidFields.includes("email")&&a.invalidInput}})]}),(0,Se.jsx)(He().A,{size:14,isHidden:!0}),(0,Se.jsxs)("div",{children:[(0,Se.jsx)("label",{htmlFor:"personalAccessToken",style:{...a.inputLabels},children:o}),(0,Se.jsx)(He().A,{size:8,isHidden:!0}),(0,Se.jsx)($e().A,{id:"personalAccessToken",type:"password",value:s.personalAccessToken,showClearButton:!0,onChange:e=>{Xt.setState({...Xt.state,personalAccessToken:e.target.value,invalidFields:[]})},placeholder:"Paste your token here",inputElementAttributes:{minLength:4},style:{...a.inputBox,...s.invalidFields.includes("personalAccessToken")&&a.invalidInput}}),(0,Se.jsx)(He().A,{size:8,isHidden:!0}),(0,Se.jsx)("div",{style:{...a.captionText,marginBottom:18},children:(0,Se.jsx)(g().sA,{id:"quipAuthentication.stepsToGetPersonalAccessToken",defaultMessage:"<getapitokenlink>Get Personal Access Token</getapitokenlink>",values:{getapitokenlink:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,Se.jsx)(to().A,{external:!0,href:"https://quip.com/dev/token",onClick:()=>{},children:t})}}})})]})]})})})})}function lo(e){let{handleModalClose:t,caption:o,title:s}=e;const a=ao(),n=s||so.headerTitle;return(0,Se.jsxs)("div",{style:a.headerWrapper,children:[(0,Se.jsx)(ve().A,{onClick:t,style:a.closeButton,hoveredStyle:a.closeButtonHover,children:(0,Et().V)(a.closeButtonIcon)}),(0,Se.jsxs)("div",{style:a.iconGroup,children:[(0,Se.jsx)("img",{style:a.icon,src:i().A.images.import.quipPng,alt:"Quip Icon"}),(0,Nt().B)(a.arrowRight),(0,Ut().S)(a.notionLogo)]}),(0,Se.jsx)("div",{style:a.header,children:(0,Se.jsx)(g().sA,{...n})}),o]})}function co(e){return(0,Se.jsx)("div",{children:e.children})}const po=function(e){const t=(0,n().O$)(X().A),o=(0,n().O$)(Xt),{spaceStore:r,onComplete:l}=e,{account:d,authResponse:p,accountEmail:u}=o,f=(0,a().v3)(),h=(0,g().tz)(),{device:y}=f,x=ao(),v=(0,s.useCallback)((async()=>{await async function(e){const{environment:t,spaceStore:o,account:s,authResponse:a}=e;if(s)Xt.setState({...Xt.state,showAuthPopup:!1,personalAccessToken:void 0,email:void 0,companyId:void 0});else{Xt.setState({...Xt.state,isFetchingAccount:!0});let e=a;void 0===e&&(e=await async function(e){const{environment:t,spaceId:o}=e;let s={account:"",email:""};try{const e=await I().callApi({eventName:"getQuipAccount",environment:t,data:{spaceId:o}});"success"===e.type&&(s=e.data)}catch(a){}finally{return s}}({environment:t,spaceId:o.id})),e&&""!==e.account?Xt.setState({...Xt.state,showAuthPopup:!1,personalAccessToken:void 0,email:void 0,companyId:void 0,account:e.account,accountEmail:e.email}):Xt.setState({...Xt.state,isFetchingAccount:!1,showAuthPopup:!0})}}({environment:f,account:d,spaceStore:r,authResponse:p})}),[f,d,r,p]),A=t.flowId||m().JW();(0,s.useEffect)((()=>{t.flowId||X().A.setState({flowId:A})}),[A,t]);const S=(0,H().w)(),j={title:h.formatMessage({id:"quipImportOption.quipButton.title",defaultMessage:"Quip"}),logo:i().A.images.import.quipPng,caption:d??(S?h.formatMessage({id:"quipImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your collaborative documents"}):void 0),actionButton:d?(w=[{name:h.formatMessage({id:"quipImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{mo({})}},{name:h.formatMessage({id:"quipImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove account"}),action:async()=>{await uo({environment:f,spaceStore:r})}}],(0,Se.jsx)(le().Ay,{popupType:ge().nl.Popup,renderOrigin:e=>(0,Se.jsx)(ce().A,{ariaLabel:h.formatMessage({id:"quipImportOption.quipButton.ariaLabel",defaultMessage:"Import from Quip.com button"}),icon:c()._,...e}),render:e=>{const t=w.map((t=>{let{name:o,captionText:s,action:a}=t;const n={key:o,render:e=>(0,Se.jsx)(ie().A,{...e,title:o,caption:s,captionStyle:s?oo:void 0}),action:()=>{a(),e.close()}};return n})),o={key:"section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:t};return(0,Se.jsx)(me().A,{menuType:_().gu.Popup,width:200,children:(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:[o]})})}})):void 0,onClick:()=>{}};var w;return(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(le().Ay,{onClick:v,popupType:y.isMobile?le().z7.SlideUp:le().z7.Popup,renderOrigin:e=>{let{onClick:t}=e;return(0,Se.jsx)(Ce,{...j,onClick:t})},render:()=>d?(0,Se.jsxs)(s.Fragment,{children:[(0,Se.jsx)(fe().A,{children:(0,Se.jsx)(Ue().A,{title:(0,Se.jsx)(g().sA,{defaultMessage:"Import from {email}",id:"quipImportOption.menuItem.email.label",values:{email:u}}),onClick:async()=>{const e=await eo({environment:f,spaceStore:r});l(e,"quip")},focused:!1})}),(0,Se.jsx)(fe().A,{topBorder:!0,children:(0,Se.jsx)(Ue().A,{title:(0,Se.jsx)(g().sA,{defaultMessage:"Connect another account",id:"quipImportOption.menuItem.connectAnotherQuipAccount.label"}),onClick:()=>mo({}),style:x.buttonItem,focused:!1})})]}):null}),(0,Se.jsx)(no,{environment:f,spaceStore:r,flowId:A,onComplete:l})]})};function mo(e){Xt.setState({...Xt.state,isFetchingAccount:!1,showAuthPopup:!0,personalAccessToken:void 0,email:void 0,companyId:void 0})}async function uo(e){const{environment:t,spaceStore:o}=e,s=await async function(e){const{environment:t,spaceId:o}=e,s=await I().callApi({eventName:"disconnectQuipAccount",environment:t,data:{spaceId:o}});if(s&&"failed"!==s.type)return s.data}({environment:t,spaceId:o.id});return void 0===s?(x().rG({message:Kt().A.formatMessage(so.disconnectFailed)}),!1):(Xt.setState({...Xt.state,account:void 0,accountEmail:void 0}),!0)}const go=function(e){let{requestStore:t,analyticsFrom:o,trelloResult:r,renderItemActionsButton:l,spaceStore:c,spaceViewStore:d,onComplete:p}=e;const m=(0,a().v3)(),u=(0,g().tz)(),{boardsResponse:f,showLoader:y,isFetchingBoards:x}=(0,n().K8)((()=>{const{boardsResponse:e,showLoader:t,isFetchingBoards:o}=oe().A.state;return{boardsResponse:e,showLoader:t,isFetchingBoards:o}}),[]),v=(0,s.useCallback)((()=>async function(e,t,o,s){h().fJ(e,{import_source:"trello",from:o}),s&&await F()._(e,t)}(m,t,o,x)),[m,t,o,x]),{device:A}=m,{account:S}=r,j=f.boards,w={key:"default",name:u.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:j.map((e=>({key:e.id,name:e.name})))},b=(0,H().w)(),k={title:"Trello",logo:i().A.images.import.trelloPng,caption:S??(b?u.formatMessage({id:"trelloImportOption.actionsMenu.defaultCaption",defaultMessage:"Move over your boards and cards"}):void 0),actionButton:S&&y?(0,Se.jsx)(pe().A,{}):S&&l([{name:u.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>J().A.setState({open:!0})},{name:u.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>fo(t,m)},{name:u.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await I().callApi({eventName:"disconnectTrello",environment:t,data:{}}),oe().A.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await e.refresh(),h().kO(t,{integration_name:"trello"})}(t,m)}]),onClick:()=>{}};return(0,Se.jsx)(le().Ay,{popupType:A.isMobile?le().z7.SlideUp:le().z7.Popup,buttonPopupStore:J().A,onClick:v,render:()=>y?(0,Se.jsx)(Se.Fragment,{}):(0,Se.jsx)(At,{searchInputPlaceholder:u.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a boardâ€¦"}),noSearchResultsPlaceholder:u.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[w],onComplete:e=>async function(e,t,o,s,a,n){const{boards:r}=e,i=r.filter((e=>Boolean(t.find((t=>t.key===e.id)))));h().Pd(n,{integration_name:"trello",count:t.length});const l=await C().MW({environment:n,spaceStore:o,spaceViewStore:s,boards:i});h().mM(n,{import_source:"trello",data:{notebooks:i.map((e=>e.id)),userId:n.currentUser.id,spaceId:(0,ut().e)(o.id)}}),a(l,"trello")}(f,e,c,d,p,m)}),renderOrigin:e=>{let{onClick:o}=e;return(0,Se.jsx)(Ce,{...k,onClick:S?o:()=>fo(t,m)})}})};async function fo(e,t){await F().P({environment:t,requestStore:e})}var ho=()=>o(387231);const yo={display:"flex",alignItems:"center",justifyContent:"center",minHeight:240,width:"100%",overflow:"hidden"},xo=["csv","pdf","markdown","html","word"],vo=["asana","confluence","trello","workflowy","evernote","jira","monday","quip","googleDoc"];function Ao(e){let{analyticsFrom:t,spaceStore:o,onComplete:i,spaceViewStore:l,userSettingsStore:c,pageStore:d}=e;const p=(0,a().v3)(),m=(0,r().DP)(),[u,f]=(0,s.useState)(!1),h=(0,n().uB)(void 0,ee().A),y=(0,n().uB)(void 0,ee().A),x=(0,n().uB)(void 0,ee().A),v=(0,n().uB)(void 0,ee().A),A=(0,n().uB)(void 0,ee().A),S=(0,n().O$)(Y().e),I=(0,n().K8)((()=>te().A.getState()),[]),j=(0,s.useCallback)((e=>{y.refresh=e.confluence,x.refresh=e.evernote,A.refresh=e.googleDoc,h.refresh=e.jira,v.refresh=e.trello}),[y,x,A,h,v]),w=(0,n().K8)((()=>ko()),[]),b=(0,s.useCallback)((e=>{if(e){const{defaultSubtab:s}=I;return u||(f(!0),jo({defaultSubtab:s,pageStore:d,spaceStore:o,spaceViewStore:l,trelloRequestStore:v,evernoteRequestStore:x,confluenceRequestStore:y,googleDocRequestStore:A,result:e,environment:p,onComplete:i,analyticsFrom:t,flowId:w})),te().A.setState({...te().A.state,defaultSubtab:void 0}),(0,Se.jsx)("div",{style:yo,children:(0,Se.jsx)(Wo,{analyticsFrom:t,onComplete:i,spaceStore:o,spaceViewStore:l,userSettingsStore:c,pageStore:d,trelloRequestStore:v,evernoteRequestStore:x,confluenceRequestStore:y,jiraRequestStore:h,googleDocRequestStore:A,result:e})})}return(0,Se.jsx)("div",{style:"onboarding"===t?{}:yo,children:(0,Se.jsx)(pe().A,{})})}),[t,y,p,x,w,A,h,i,d,I,o,l,v,c,u]);return S?(0,Se.jsx)(Po,{spaceStore:o,setRefreshers:j,renderChildren:b}):(0,Se.jsx)("div",{style:{...yo,fontSize:14,color:m.text.secondary},children:(0,Se.jsx)(g().sA,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})})}function So(e){let{analyticsFrom:t,spaceStore:o,onComplete:s,spaceViewStore:i,userSettingsStore:l,pageStore:c}=e;const d=(0,a().v3)(),p=(0,r().DP)(),m=(0,n().uB)(void 0,ee().A),u=(0,n().uB)(void 0,ee().A),f=(0,n().uB)(void 0,ee().A),h=(0,n().uB)(void 0,ee().A),y=(0,n().uB)(void 0,ee().A),x=(0,n().uB)(void 0,ee().A),v=(0,n().uB)(void 0,ee().A),A=(0,n().O$)(Y().e),S=(0,n().K8)((()=>te().A.getState()),[]),I=(0,n().K8)((()=>ko()),[]);return A?(0,Se.jsx)(Bo,{spaceStore:o,trelloRequestStore:x,asanaRequestStore:y,evernoteRequestStore:h,confluenceRequestStore:f,mondayRequestStore:u,jiraRequestStore:m,googleDocRequestStore:v,renderChildren:e=>{if(e){const{defaultSubtab:a}=S;return jo({defaultSubtab:a,pageStore:c,spaceStore:o,spaceViewStore:i,trelloRequestStore:x,evernoteRequestStore:h,confluenceRequestStore:f,googleDocRequestStore:v,result:e,environment:d,onComplete:s,analyticsFrom:t,flowId:I}),te().A.setState({...te().A.state,defaultSubtab:void 0}),(0,Se.jsx)("div",{style:yo,children:(0,Se.jsx)(Wo,{analyticsFrom:t,onComplete:s,spaceStore:o,spaceViewStore:i,userSettingsStore:l,pageStore:c,trelloRequestStore:x,evernoteRequestStore:h,confluenceRequestStore:f,jiraRequestStore:m,googleDocRequestStore:v,result:e})})}return(0,Se.jsx)("div",{style:"onboarding"===t?{}:yo,children:(0,Se.jsx)(pe().A,{})})}}):(0,Se.jsx)("div",{style:{...yo,fontSize:14,color:p.text.secondary},children:(0,Se.jsx)(g().sA,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})})}const Io=function(e){return(0,o(622286).X)("use_new_import_options")?(0,Se.jsx)(Ao,{...e}):(0,Se.jsx)(So,{...e})};function jo(e){let{defaultSubtab:t,environment:o,pageStore:s,spaceStore:a,spaceViewStore:n,trelloRequestStore:r,evernoteRequestStore:i,confluenceRequestStore:l,googleDocRequestStore:c,result:d,onComplete:p,analyticsFrom:g,flowId:x}=e;if(t){if(!u().fF.includes(t)||"gdocs"===t&&d.googleDocResult.isGoogleDocImporterEnabled||"csv"===t&&D())switch(t){case"trello":!function(e,t,o,s){const a=o.account;a?F()._(e,t).then((()=>{J().A.setState({open:!0})})).catch((()=>{oe().A.setState({...oe().A.state,isFetchingBoards:!1,showLoader:!1})})):F().P({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(o,r,d.trelloResult);break;case"evernote":!function(e,t,o,s){const{userInfo:a}=o;a?T().p({environment:e,requestStore:t}).then((()=>{G().A.setState({open:!0})})).catch((()=>{})):T().J({environment:e,requestStore:t}).then((()=>{})).catch((()=>{}))}(o,i,d.evernoteResult);break;case"monday":!function(e,t,o,s){t.user?M().Jq({environment:e,spaceId:o}).then((()=>{Q().A.setState({...Q().A.state,currentTab:"selectData",isModalOpen:!0})})).catch((()=>{})):Q().A.setState({...Q().A.state,showAuthPopup:!0})}(o,d.mondayResult,a.id);break;case"confluenceApi":!function(e,t,o,s,a){const{account:n}=t;te().A.setState({...te().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),n?w({environment:e,requestStore:s,spaceId:o}).then((()=>{K().A.setState({open:!0})})).catch((()=>{S.setState({...S.state,[o]:{...S.state[o],showLoader:!1}})})):S.setState({...S.state,[o]:{...S.state[o],open:!0}})}(o,d.confluenceResult,a.id,l);break;case"asana":!function(e,t,o){const{account:s}=t;s?y().xd({environment:e}).then((()=>{$().A.setState({...$().A.state,isModalOpen:!0})})).catch((()=>{$().A.setState({...$().A.state,isAccountLinkingInProgress:!1,isModalOpen:!1})})):y().x3({environment:e,flowId:m().JW()}).then((()=>{})).catch((()=>{}))}(o,d.asanaResult);break;case"jira":!function(e,t,o){const{account:s}=t;if(!s)return;const a=Z().Ay.getState(),n=Z().Ay.createNewFlowId();s.length?(Z().Ay.setState({...a,type:"teamspace-selection",open:!0}),(0,P().u4)({environment:e,event:{eventName:"external_sync_teamspace_selection",eventProperties:{integration:"jira",actionType:"teamspace_modal_render",flowId:n}}})):(Z().Ay.setState({...a,type:"auth",open:!0}),(0,P().u4)({environment:e,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira",actionType:"admin_auth_render",flowId:n}}}));te().A.setState(te().A.getInitialState())}(o,d.jiraResult);break;case"gdocs":!function(e){const{requestStore:t,spaceStore:o,spaceViewStore:s,environment:a,analyticsFrom:n,pageStore:r,onComplete:i,areAccountsFetched:l,googleDriveResponse:c,selectedFileId:d}=e;Bt({environment:a,requestStore:t,areAccountsFetched:l,analyticsFrom:n,googleDriveResponse:c,pageStore:r,spaceStore:o,spaceViewStore:s,selectedFileId:d,onComplete:i}).then((()=>{})).catch((()=>{}))}({environment:o,requestStore:c,analyticsFrom:g,pageStore:s,onComplete:p,spaceStore:a,spaceViewStore:n,areAccountsFetched:d.googleDocResult.areAccountsFetched,googleDriveResponse:d.googleDocResult.accountsResponse,selectedFileId:d.googleDocResult.selectedFileId});break;case"csv":k({importType:"import",spaceId:a.id,parentId:(null==s?void 0:s.id)??"",parentTable:"block"})}else!function(e){let{environment:t,pageStore:o,spaceStore:s,spaceViewStore:a,uploadType:n,onComplete:r,analyticsFrom:i}=e;if(!o)return;C().un({environment:t,pageStore:o,spaceStore:s,spaceViewStore:a,analyticsFrom:i,uploadType:n,flowId:m().JW()}).then((e=>{e&&(f().v(t,{from:"import",type:"page",new_page_id:e.id,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()}),r(e,n))})).catch((()=>{}))}({pageStore:s,spaceStore:a,spaceViewStore:n,environment:o,uploadType:t,onComplete:p,analyticsFrom:g});h().fJ(o,{import_source:t,from:g,flowId:x,userId:o.currentUser.id,spaceId:a.id})}}function wo(e){let{url:t,helpButtonMessage:o,helpMessageWidth:s,disableBackground:a,marginLeft:n}=e;return(0,Se.jsx)(he().A,{renderTooltip:()=>o??(0,Se.jsx)(g().sA,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:s??"max-content"},textWrap:!0,render:e=>(0,Se.jsx)(de().A,{external:!0,href:t,style:{marginLeft:n??"auto"},...e,children:(0,Se.jsx)(ce().A,{icon:d().$,disableBackground:a??!1})})})}function bo(e){let{actions:t}=e;return(0,Se.jsx)(le().Ay,{popupType:ge().nl.Popup,renderOrigin:e=>(0,Se.jsx)(ce().A,{icon:c()._,...e}),render:e=>{const o={key:"section",render:e=>(0,Se.jsx)(fe().A,{...e}),items:t.map((t=>{let{name:o,action:s}=t;return{key:o,render:e=>(0,Se.jsx)(Ue().A,{...e,title:o}),action:()=>{s(),e.close()}}}))};return(0,Se.jsx)(me().A,{menuType:_().gu.Popup,width:200,children:(0,Se.jsx)(ue().Ay,{type:ue().Oh.Vertical,initialFocus:void 0,sections:[o]})})}})}function ko(){return X().A.state.flowId||m().JW()}async function To(e,t,o,s,a,n,r,i){h().fJ(n,{import_source:e,from:t,import_type:"file",flowId:i});const l=await C().un({environment:n,pageStore:r,spaceStore:o,spaceViewStore:s,analyticsFrom:t,uploadType:e,flowId:i});l&&(f().v(n,{from:"import",type:"page",new_page_id:l.id,creating_block_id:l.id,parent_collection_id:l.getParentCollectionIdUpToTwoLevels()}),a(l,e))}function Co(e){let{flowId:t,analyticsFrom:o,spaceStore:s,spaceViewStore:n,onComplete:r,pageStore:l}=e;const c=(0,a().v3)();return(0,Se.jsx)(Ce,{title:"Confluence",logo:i().A.images.import.confluencePng,onClick:()=>To("confluence",o,s,n,r,c,l,t),actionButton:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importConfluence")})})}function Mo(e){let{analyticsFrom:t,spaceStore:o,spaceViewStore:a,onComplete:n,pageStore:r}=e;const l=(0,s.useCallback)((()=>{k({importType:"import",spaceId:o.id,parentId:(null==r?void 0:r.id)??"",parentTable:null!=r&&r.id?"block":"space"})}),[o.id,null==r?void 0:r.id]);return(0,Se.jsx)(Ce,{title:"CSV",logo:i().A.images.import.csvPng,onClick:l})}function Fo(e){let{analyticsFrom:t,spaceStore:o,spaceViewStore:s,onComplete:n,pageStore:r}=e;const l=(0,a().v3)();return(0,Se.jsx)(he().A,{placement:q().W.Bottom,render:e=>(0,Se.jsx)(Ce,{tooltipEvents:e,title:"CSV",logo:i().A.images.import.csvPng,onClick:()=>To("csv",t,o,s,n,l,r)}),renderTooltip:()=>(0,Se.jsx)(g().sA,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}function Po(e){const{renderChildren:t,spaceStore:o,setRefreshers:r}=e,i=(0,a().v3)(),c=o.id,[d,p]=(0,l().Yb)((()=>(0,W().L)(i)),[i]),[m,u]=(0,l().Yb)((()=>(0,W().fG)(i,c)),[i,c]),[g,f]=(0,l().Yb)((()=>(0,W().PV)(i)),[i]),[h,y]=(0,l().Yb)((()=>(0,W().wc)()),[]),[x,v]=(0,l().Yb)((()=>(0,W().D1)(i,c)),[i,c]),[A,S]=(0,l().Yb)((()=>(0,W().$d)(i,c)),[i,c]),[I,j]=(0,l().Yb)((()=>(0,W().p1)(i)),[i]);(0,s.useEffect)((()=>{r({confluence:async()=>{await u()},evernote:async()=>{await f()},googleDoc:async()=>{await y()},jira:async()=>{await v()},trello:async()=>{await j()}})}),[r,p,u,f,y,v,S,j]);return(0,n().K8)((()=>t(I.value&&d.value&&g.value&&m.value&&A.value&&x.value&&h.value?{trelloResult:I.value,asanaResult:d.value,evernoteResult:g.value,confluenceResult:m.value,mondayResult:A.value,jiraResult:x.value,googleDocResult:h.value}:void 0)),[t,I,d,g,m,A,x,h])}function Bo(e){let{renderChildren:t,spaceStore:o,trelloRequestStore:s,asanaRequestStore:n,evernoteRequestStore:r,confluenceRequestStore:i,mondayRequestStore:l,jiraRequestStore:c,googleDocRequestStore:d}=e;const p=(0,a().v3)();return(0,Se.jsx)(ze().A,{request:p,performRequest:W().p1,requestStore:s,render:(e,s)=>(0,Se.jsx)(ze().A,{request:p,performRequest:W().L,requestStore:n,render:(e,a)=>(0,Se.jsx)(ze().A,{request:p,performRequest:W().PV,requestStore:r,render:(e,n)=>(0,Se.jsx)(ze().A,{request:p,performRequest:()=>(0,W().fG)(p,o.id),requestStore:i,render:(e,r)=>(0,Se.jsx)(ze().A,{request:p,performRequest:()=>(0,W().$d)(p,o.id),requestStore:l,render:(e,i)=>(0,Se.jsx)(ze().A,{request:p,performRequest:()=>(0,W().D1)(p,o.id),requestStore:c,render:(e,o)=>(0,Se.jsx)(ze().A,{request:p,performRequest:W().wc,requestStore:d,render:(e,l)=>t(s&&a&&n&&r&&i&&o&&l?{trelloResult:s,asanaResult:a,evernoteResult:n,confluenceResult:r,mondayResult:i,jiraResult:o,googleDocResult:l}:void 0)})})})})})})})}function Ro(e){let{analyticsFrom:t,onComplete:o,spaceStore:s,spaceViewStore:a,userSettingsStore:n,googleDocRequestStore:r,pageStore:i}=e;return(0,Se.jsx)(Ft,{renderItemActionsButton:e=>(0,Se.jsx)(bo,{actions:e}),onComplete:o,requestStore:r,spaceStore:s,spaceViewStore:a,userSettingsStore:n,pageStore:i,analyticsFrom:t})}function Do(e){let{trelloResult:t,analyticsFrom:o,onComplete:s,spaceStore:a,spaceViewStore:n,userSettingsStore:r,trelloRequestStore:i}=e;return(0,Se.jsx)(go,{trelloResult:t,analyticsFrom:o,renderItemActionsButton:e=>(0,Se.jsx)(bo,{actions:e}),onComplete:s,requestStore:i,spaceStore:a,spaceViewStore:n,userSettingsStore:r})}function Lo(e){let{confluenceResult:t,flowId:o,analyticsFrom:s,onComplete:n,spaceStore:r,spaceViewStore:i,userSettingsStore:l,pageStore:c,confluenceRequestStore:d}=e;const p=(0,a().v3)();return(0,Se.jsx)(mt,{confluenceResult:t,analyticsFrom:s,flowId:o,renderItemActionsButton:e=>(0,Se.jsx)(bo,{actions:e}),onComplete:n,spaceStore:r,requestStore:d,spaceViewStore:i,userSettingsStore:l,handleFileUploadClick:(e,t)=>To(e,s,r,i,n,p,c,t),handleApiImportClick:(e,t)=>function(e,t,o,s,a,n){w({environment:a,requestStore:t,spaceId:o.id}).catch((()=>{})),h().fJ(a,{import_source:e,from:s,import_type:"api",flowId:n})}(e,d,r,s,p,t)})}function Oo(e){let{evernoteResult:t,onComplete:o,spaceStore:s,spaceViewStore:a,userSettingsStore:n,evernoteRequestStore:r}=e;const i=(0,H().w)();return(0,Se.jsx)(wt,{evernoteResult:t,analyticsFrom:"onboarding",renderItemActionsButton:e=>(0,Se.jsx)(bo,{actions:e}),defaultActionButton:i?void 0:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importEvernote")}),onComplete:o,requestStore:r,spaceStore:s,spaceViewStore:a,userSettingsStore:n})}function Wo(e){let{result:t,analyticsFrom:o,onComplete:s,spaceStore:l,spaceViewStore:c,userSettingsStore:d,pageStore:m,trelloRequestStore:u,evernoteRequestStore:f,confluenceRequestStore:h,jiraRequestStore:y,googleDocRequestStore:x}=e;const v=(0,a().v3)(),A=(0,n().K8)((()=>ko()),[]),S=(0,n().K8)((()=>(0,B().n0)(v)),[v]),I=(0,n().K8)((()=>(0,V().c)()),[]),j=(0,n().K8)((()=>R().default.checkGate({gateName:"quip_importer"})),[]),w=(0,n().K8)((()=>(0,L().LB)()),[]),b=(0,n().K8)((()=>(0,L().jw)()),[]),k=(0,n().K8)((()=>(0,z().pB)()),[]),T=(0,n().K8)((()=>(0,U().p4)(l)),[l]),C=(0,n().K8)((()=>(0,z().yX)()),[])&&!T,M=(0,n().K8)((()=>(0,N().s)()),[]),F=(0,n().K8)((()=>(0,O().V)()),[]),P=(0,n().K8)((()=>D()),[]),W=(0,g().tz)(),_=(0,H().w)(),q=(0,r().IS)((e=>({importTypeSection:{marginTop:6,marginBottom:8,display:"flex",alignItems:"center"},importTypeHeader:{fontSize:12,color:e.text.secondary,lineHeight:"16px",wordBreak:"keep-all",fontWeight:400,marginRight:2}})),[]),$=(0,n().K8)((()=>({asana:(0,Se.jsx)(We,{}),confluence:S?(0,Se.jsx)(Lo,{analyticsFrom:o,onComplete:s,spaceStore:l,spaceViewStore:c,userSettingsStore:d,pageStore:m,confluenceRequestStore:h,confluenceResult:t.confluenceResult,flowId:A}):(0,Se.jsx)(Co,{analyticsFrom:o,spaceStore:l,spaceViewStore:c,onComplete:s,pageStore:m,flowId:A}),googleDoc:F?(0,Se.jsx)(Ro,{onComplete:s,spaceStore:l,spaceViewStore:c,userSettingsStore:d,googleDocRequestStore:x,pageStore:m,analyticsFrom:o}):(0,Se.jsx)(Ce,{title:"Google Docs",caption:_?W.formatMessage({id:"googleDocsImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your documents seamlessly"}):void 0,logo:i().A.images.import.googleDocsPng,actionButton:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importGoogleDocs")}),onClick:()=>To("gdocs",o,l,c,s,v,m)}),pdf:M&&(0,Se.jsx)(Ce,{title:"PDF",showBetaBadge:!_,logo:i().A.images.import.pdfSvg,onClick:()=>To("pdf",o,l,c,s,v,m)}),csv:P?(0,Se.jsx)(Mo,{analyticsFrom:o,spaceStore:l,spaceViewStore:c,onComplete:s,pageStore:m}):(0,Se.jsx)(Fo,{analyticsFrom:o,spaceStore:l,spaceViewStore:c,onComplete:s,pageStore:m}),markdown:(0,Se.jsx)(Ce,{title:(0,Se.jsx)(g().sA,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),logo:i().A.images.import.textPng,onClick:()=>To("markdown",o,l,c,s,v,m)}),html:(0,Se.jsx)(Ce,{title:"HTML",logo:i().A.images.import.htmlPng,onClick:()=>To("html",o,l,c,s,v,m)}),word:(0,Se.jsx)(Ce,{title:"Word",logo:i().A.images.import.wordPng,onClick:()=>To("docx",o,l,c,s,v,m)}),dropbox:(0,Se.jsx)(Ce,{title:"Dropbox Paper",logo:i().A.images.import.dropboxPaperPng,actionButton:_?void 0:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importDropboxPaper")}),onClick:()=>To("dropbox",o,l,c,s,v,m),caption:_?W.formatMessage({id:"dropboxImportOption.actionsMenu.defaultCaption",defaultMessage:"Bring in your stored files and docs"}):void 0}),trello:(0,Se.jsx)(Do,{analyticsFrom:o,onComplete:s,spaceStore:l,spaceViewStore:c,userSettingsStore:d,trelloRequestStore:u,trelloResult:t.trelloResult}),evernote:(0,Se.jsx)(Oo,{onComplete:s,spaceStore:l,spaceViewStore:c,userSettingsStore:d,evernoteRequestStore:f,evernoteResult:t.evernoteResult}),monday:I&&(0,Se.jsx)(Vt,{spaceStore:l,analyticsFrom:o,flowId:A}),quip:j?(0,Se.jsx)(po,{spaceStore:l,analyticsFrom:o,flowId:A,onComplete:s}):(0,Se.jsx)(Ce,{title:"Quip",logo:i().A.images.import.quipPng,actionButton:_?void 0:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importQuip")}),onClick:()=>To("quip",o,l,c,s,v,m),caption:_?W.formatMessage({id:"quipImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your collaborative documents"}):void 0}),workflowy:(0,Se.jsx)(Ce,{title:"Workflowy",logo:i().A.images.import.workflowyPng,actionButton:_?void 0:(0,Se.jsx)(wo,{url:(0,E().xS)("guides.importWorkflowy")}),caption:_?W.formatMessage({id:"workflowyImportOption.actionsMenu.defaultCaption",defaultMessage:"Import your outlines and lists"}):void 0,onClick:()=>To("workflowy",o,l,c,s,v,m)}),generic:w&&!b&&(0,Se.jsx)(Ce,{title:(0,Se.jsx)(g().sA,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:p().n,onClick:()=>To("genericImporter",o,l,c,s,v,m,A),actionButton:(0,Se.jsx)(wo,{url:"",helpButtonMessage:(0,Se.jsx)(g().sA,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),helpMessageWidth:240,disableBackground:!0})}),jira:k&&!C&&(0,Se.jsx)(Lt,{flowId:A,spaceStore:l,showNewBadge:!1,showSyncBadge:!_,requestStore:y,jiraResult:t.jiraResult,renderItemActionsButton:e=>(0,Se.jsx)(bo,{actions:e}),analyticsFrom:o}),zip:(0,Se.jsx)(Ce,{title:"Zip",logo:i().A.images.import.zipPng,onClick:()=>(0,ho().Q)(v,"genericImporter",s,o),tooltip:_?(0,Se.jsx)(wo,{url:"",helpButtonMessage:(0,Se.jsx)(g().sA,{id:"importOptions.zipImport.tooltip",defaultMessage:"Upload a zip file containing DOCX, MD, HTML, CSV, EPUB files and we will convert them into pages"}),helpMessageWidth:240,disableBackground:!0,marginLeft:"unset"}):void 0})})),[o,h,f,A,x,_,y,l,c,u,d,P,w,F,k,I,M,j,b,C,v,W,s,m,t,S]),Y=[(0,n().K8)((()=>(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{style:q.importTypeSection,children:(0,Se.jsx)("div",{style:q.importTypeHeader,children:(0,Se.jsx)(g().sA,{id:"importOptions.fileBasedImports.title",defaultMessage:"File-based imports"})})}),(0,Se.jsx)(zo,{children:xo.map((e=>{const t=$[e];return t||null}))})]})),[q,$]),(0,n().K8)((()=>(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)("div",{style:q.importTypeSection,children:(0,Se.jsx)("div",{style:q.importTypeHeader,children:(0,Se.jsx)(g().sA,{id:"importOptions.thirdPartyImports.title",defaultMessage:"3rd-party imports"})})}),(0,Se.jsx)(zo,{children:vo.map((e=>{const t=$[e];return t||null}))})]})),[$,q])];return _?(0,Se.jsx)("div",{style:{width:"100%",display:"flex",flexDirection:"column"},children:Y.map((e=>e))}):(0,Se.jsx)(zo,{children:Object.values($).map((e=>e))})}function zo(e){let{children:t}=e;const o=(0,H().w)();return(0,Se.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",overflow:"hidden",gridAutoRows:o?"auto":"1fr",gap:"4px 20px",padding:2,width:"100%"},children:t})}},407257:(e,t,o)=>{o.d(t,{E:()=>a});o(242343);var s=o(163643);const a=(0,o(680369).wt)("folder",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M2.4082 14.3672H13.7627C15.0684 14.3672 15.8271 13.6084 15.8271 12.1455V5.11816C15.8271 3.65527 15.0615 2.89648 13.585 2.89648H7.22754C6.73535 2.89648 6.44824 2.78027 6.07227 2.47266L5.67578 2.1582C5.19727 1.76172 4.8418 1.63184 4.13086 1.63184H2.19629C0.917969 1.63184 0.166016 2.37695 0.166016 3.8125V12.1455C0.166016 13.6084 0.931641 14.3672 2.4082 14.3672ZM1.50586 3.92871C1.50586 3.2998 1.84766 2.97168 2.46289 2.97168H3.77539C4.26074 2.97168 4.54102 3.08105 4.92383 3.39551L5.32031 3.7168C5.79199 4.10645 6.16113 4.23633 6.87207 4.23633H13.5098C14.1387 4.23633 14.4873 4.56445 14.4873 5.23438V5.63086H1.50586V3.92871ZM2.49023 13.0273C1.85449 13.0273 1.50586 12.6992 1.50586 12.0361V6.81348H14.4873V12.0361C14.4873 12.6992 14.1387 13.0273 13.5098 13.0273H2.49023Z"})})},409103:(e,t,o)=>{o.d(t,{fF:()=>r,k2:()=>n});const s=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],a=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],n={markdown:a,csv:["text/plain",".csv"],html:["text/html"],docx:s,gdocs:s,dropbox:s,quip:["text/html",a],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"],pdf:["application/pdf"]},r=Object.keys(n)},433387:(e,t,o)=>{o.d(t,{o:()=>a});o(242343);const s={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10.184 3.64A3.475 3.475 0 0 1 15.1 8.554l-5.374 5.374a2.05 2.05 0 1 1-2.9-2.9l2.688-2.686a.625.625 0 0 1 .884.884L7.71 11.913a.8.8 0 0 0 1.13 1.131l5.375-5.374a2.225 2.225 0 1 0-3.147-3.146L5.694 9.898a3.65 3.65 0 1 0 5.162 5.161l4.702-4.702a.625.625 0 0 1 .884.884l-4.702 4.702a4.9 4.9 0 1 1-6.93-6.93z"})},a=(0,o(680369).wt)("paperClip",s)},436452:(e,t,o)=>{o.d(t,{P:()=>y,_:()=>x});var s=()=>o(545250),a=()=>o(809811),n=()=>o(505381),r=()=>o(145046),i=()=>o(927685),l=()=>o(142548),c=()=>o(188594),d=()=>o(330358),p=()=>o(55998),m=()=>o(818369),u=()=>o(437071),g=()=>o(70989),f=()=>o(961987);const h=(0,o(653998).YK)({authenticatingWithTrello:{id:"trelloActions.authenticatingWithTrello.loadingMessage",defaultMessage:"Authenticating with Trelloâ€¦"},titleMessage:{defaultMessage:"Trello login",id:"trelloActions.loginPopupModal.title"}});async function y(e){const{environment:t,requestStore:o}=e,p=(0,l().LX)(t);let y=(0,s().bQ)(i().A.domainBaseUrl,{authType:p,userId:t.currentUser.id,isElectronDevice:t.device.isElectron});if(y=p.redirectToAuth?y:await(0,l().YN)(t,y),t.device.isElectron)return void u().openExternalUrl(y);const v=await f().P(t,{width:580,height:700,url:y,titleMessage:h.titleMessage});if(!v)return;const A=a().qg(v),S=A.query.oauth_token,I=A.query.oauth_verifier;if(!S||!I)return;g().m({message:h.authenticatingWithTrello});const j=await m().callApi({eventName:"authWithTrello",environment:t,data:{requestToken:S,verifier:I}});"failed"===j.type?(n()._$(t,{import_source:"trello",data:{import_type:"api",status:"failure",error:j.error,userId:t.currentUser.id}}),console.error(j.error),r().Qg(j),g().V()):(n()._$(t,{import_source:"trello",data:{import_type:"api",status:"success",userId:t.currentUser.id}}),n().mu(t,{integration_name:"trello"}),await o.refresh(),c().A.setState({open:!0}),d().A.setState({...d().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),await x(t,o),g().V())}async function x(e,t){p().A.setState({...p().A.state,isFetchingBoards:!0,showLoader:!0});const o=await m().callApi({eventName:"getTrelloBoards",environment:e,data:{}});return await t.refresh(),"success"===o.type?(p().A.setState({...p().A.state,boardsResponse:o.data,isFetchingBoards:!1,showLoader:!1}),o.data):(console.error(o.error),{boards:[]})}},467800:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var s=()=>o(591790),a=()=>o(653998),n=()=>o(35462),r=o(163643);const i=function(e){var t;const i=(0,o(174114).IS)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.text.tertiary}})),[]);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,r.jsxs)(o(610271).Ye,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,r.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,s().v)(i.iconStyle),(0,s().v)(i.iconStyle),(0,s().v)(i.iconStyle),(0,o(210106).J)(i.closeIconStyle),(0,s().v)(i.iconStyle),(0,s().v)(i.iconStyle),(0,s().v)(i.iconStyle),(0,r.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:o(83544).A.images.notionLogoPng})]}),(0,r.jsx)(n().A,{style:i.lightText,children:e.failedMessage}),(0,r.jsx)(n().A,{style:i.lightText,children:(0,r.jsx)(a().sA,{id:"import.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,r.jsx)("a",{style:{color:o(220413).Ay.black,cursor:"pointer"},href:`/${null===(t=e.loggerPageId)||void 0===t?void 0:t.replaceAll("-","")}`,children:(0,r.jsx)(a().sA,{id:"import.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})}},484252:(e,t,o)=>{o.d(t,{W:()=>ie,A:()=>le});o(725707),o(500234),o(113085);var s=o(242343),a=()=>o(237385),n=()=>o(803290),r=()=>o(174114),i=()=>o(83544),l=()=>o(653998),c=()=>o(31448),d=()=>o(994395),p=()=>o(485966),m=()=>o(239092),u=()=>o(966789),g=()=>o(286404),f=()=>o(951540),h=()=>o(35462),y=()=>o(487966),x=(o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(403517),()=>o(610271)),v=(o(491955),o(244387),o(163643));const A=(0,o(680369).wt)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})});var S=()=>o(407257),I=()=>o(748267),j=()=>o(280704),w=()=>o(220413),b=()=>o(628854),k=()=>o(424339),T=()=>o(209684),C=()=>o(559637),M=()=>o(731942),F=()=>o(103151),P=()=>o(860706),B=()=>o(346239),R=()=>o(706412),D=()=>o(356813),L=()=>o(198654),O=()=>o(640979),W=()=>o(535906),z=()=>o(273520),_=()=>o(935091),V=()=>o(858023),N=()=>o(88271);const E=function(){const e=(0,a().v3)(),t=(0,l().tz)(),o=(0,n().O$)(p().AppStoreCurrentSpaceStore),r=(0,n().K8)((()=>m().A.getState()),[]),{workspaces:i,selectedWorkspace:c,selectedImportType:u}=r;return(0,s.useEffect)((()=>{}),[u,c,e,null==o?void 0:o.id]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h().A,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,v.jsx)(U,{onSelectOption:e=>{m().A.setState({...r,selectedProjectsAndTeamspaces:{},selectedBoardIdsForFullImport:new Set,selectedFolderIdsForFullImport:new Set,selectedTeamspacesForFullImport:{},fetchedHierarchy:!1,mondayFoldersDetailsMap:{},mondayBoardsDetailsMap:{},selectedWorkspace:e})},options:i.map((e=>({key:e.id,label:e.name}))),currentOption:r.selectedWorkspace,placeHolder:t.formatMessage(d().$b.selectWorkSpaceV1)}),(0,v.jsx)(q,{})]})};function U(e){var t;const{onSelectOption:o,options:a,currentOption:n,placeHolder:i,narrow:p,allowSearch:m,shouldBeDisabled:u}=e,g=(0,l().tz)(),[f,y]=(0,s.useState)(""),x=null===(t=a.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,A=(0,r().IS)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,v.jsx)(z().Ay,{popupType:z().z7.Popup,placementToOrigin:z().sx.Bottom,disabled:u,renderOrigin:e=>(0,v.jsxs)(T().p,{...e,style:{paddingTop:p?2:8,paddingBottom:p?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${w().XA.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:n?void 0:w().XA.light.gray[75],color:n?void 0:w().XA.light.gray[300]},disabled:!1,children:[(0,v.jsx)(h().A,{style:{textOverflow:"ellipsis"},children:x||i}),(0,L().b)(A.icon)]}),render:e=>{const t={menuType:O().gu.Popup,width:250,left:50},s=[{key:"mondayImport.dropdown.menuList",render:e=>(0,v.jsx)(N().A,{...e}),items:(f.trim()?a.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(f.toLowerCase())})):a).map((t=>{let{key:s,label:a}=t;return{key:s,action:()=>{o(s),e.close()},render:e=>(0,v.jsx)(W().A,{...e,title:a,shouldWrapCaption:!0,isChecked:x===a})}}))}];return(0,v.jsxs)(v.Fragment,{children:[m?(0,v.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:w().XA.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${w().XA.light.gray[100]}`,justifyContent:"space-between",background:w().XA.light.gray[75],fontSize:c().J.UIRegular.desktop,textOverflow:"ellipses"},placeholder:g.formatMessage(d().$b.chooseTeamspace),onChange:e=>y(e.target.value),value:f}):(0,v.jsx)(v.Fragment,{}),(0,v.jsx)(_().A,{...t,children:(0,v.jsx)(V().Ay,{type:V().Oh.Vertical,sections:s,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}var H=()=>o(96365);const q=function(){const e=(0,a().v3)(),t=(0,n().O$)(p().AppStoreCurrentSpaceStore),o=(0,n().K8)((()=>m().A.getState()),[]),{selectedWorkspace:r,mondayFoldersAndBoards:i}=o;return(0,s.useEffect)((()=>{r&&d().g3({environment:e,spaceId:null==t?void 0:t.id,selectedWorkspace:r}).catch((()=>{}))}),[r,e,null==t?void 0:t.id]),(0,v.jsxs)(v.Fragment,{children:[o.selectedWorkspace?(0,v.jsx)(h().A,{style:{fontWeight:c().Wy.semibold,marginTop:18},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,v.jsx)(v.Fragment,{}),o.isLoadingProjects?(0,v.jsxs)(x().Ye,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,v.jsx)(u().A,{size:"sm"}),(0,v.jsx)(h().A,{isSmall:!0,style:{color:w().XA.light.gray[400]},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):null==i?void 0:i.map((e=>(0,v.jsx)($,{mondayFolderAndBoards:e},`${e.folderId}-table`)))]})};function $(e){let{mondayFolderAndBoards:t}=e;const o=(0,r().DP)(),a=(0,l().tz)(),i=(0,n().K8)((()=>m().A.getState()),[]),[u,g]=(0,s.useState)(),f=(0,n().O$)(p().AppStoreCurrentSpaceViewStore),y=(0,n().K8)((()=>{const e=null==f?void 0:f.getTeamsStores();return null==e?void 0:e.map((e=>e.canAddOrRemoveTopLevelPages()?{id:e.id,name:e.getName(),icon:(0,v.jsx)(k().x,{disabled:!0,store:e})}:null)).filter((e=>null!==e))}),[f]);(0,s.useEffect)((()=>{if(!y||!f)return;if(!i.selectedProjectsAndTeamspaces[t.folderId]){g("private"),d().No({folderId:t.folderId,spaceId:null==f?void 0:f.id});for(const s of y){var e,o;if((null===(e=s.name)||void 0===e?void 0:e.toLowerCase())===(null===(o=t.folderName)||void 0===o?void 0:o.toLowerCase())){g(s.id),d().No({folderId:t.folderId,spaceId:s.id});break}}}}),[y,t,f,i.selectedProjectsAndTeamspaces,g]);const A=[{key:"private",searchTerm:"private",label:(0,v.jsxs)(x().Ye,{alignItems:"center",style:{gap:8},children:[(0,v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:w().XA.light.gray[75]},children:(0,I().g)({color:o.mediumIconColor,width:12.5,height:12.5})}),(0,v.jsx)(h().A,{style:{fontWeight:c().Wy.regular},children:a.formatMessage(d().$b.privateSpaceLabel)})]})}];y&&A.push(...y.map((e=>({key:e.id,searchTerm:e.name,label:(0,v.jsxs)(x().Ye,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),A.push({key:"create",searchTerm:"New teamspace",label:(0,v.jsxs)(x().Ye,{alignItems:"center",style:{gap:4},children:[(0,j().b)({color:o.mediumIconColor,width:16,height:16}),(0,v.jsx)(h().A,{children:a.formatMessage(d().$b.newTeamspaceLabel)})]})});const S=!(t.projects.length||t.taskBoards.length);return(0,v.jsx)(F().A,{disableTooltip:!S,renderTooltip:()=>(0,v.jsx)(h().A,{style:{color:w().Ay.white},isSmall:!0,children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.tooltipForDisabledFolder",defaultMessage:"This folder has no boards with Item type Projects or Tasks. Other types are not supported."})}),render:e=>(0,v.jsx)("div",{...e,children:(0,v.jsx)(K,{mondayFolderAndBoards:t,teamsOptions:A,setSelectedTeam:g,selectedTeam:u,mondayImportStoreState:i})})})}function Y(e){let{collapsed:t,mondayFolderAndBoards:o,mondayImportStoreState:s,isMondayV2Flow:a}=e;if(t)return[];const n=o.projects.map((e=>({key:e.id,columns:[(0,v.jsxs)(x().Ye,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,v.jsx)(C().A,{style:{marginRight:2},onClick:()=>{const t={...s.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:a,projects:n}=t;let r;r=n.find((t=>t.mondayProjectId===e.id))?n.filter((t=>t.mondayProjectId!==e.id)):n.concat({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}),m().A.setState({...s,selectedProjectsAndTeamspaces:{...s.selectedProjectsAndTeamspaces,[o.folderId]:{notionTeamspaceId:a,projects:r}}})},checked:{...s.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,v.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,v.jsx)(h().A,{isMultiline:!0,style:a?{lineHeight:"20px",fontSize:"14px"}:{},children:e.name})})]},`${e.id}-container`)]}))),r=o.taskBoards.map((e=>({key:e.id,columns:[(0,v.jsxs)(x().Ye,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,v.jsx)(C().A,{style:{marginRight:2},onClick:()=>{const t={...s.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:a,projects:n}=t;let r;r=n.find((t=>t.mondayProjectId===e.id))?n.filter((t=>t.mondayProjectId!==e.id)):n.concat({name:e.name,mondayProjectId:e.id,collectionType:"tasks"}),m().A.setState({...s,selectedProjectsAndTeamspaces:{...s.selectedProjectsAndTeamspaces,[o.folderId]:{notionTeamspaceId:a,projects:r}}})},checked:{...s.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,v.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,v.jsx)(h().A,{isMultiline:!0,style:a?{lineHeight:"20px",fontSize:"14px"}:{},children:e.name})})]},`${e.id}-container`)]})));return[...n,...r]}function K(e){var t;let{mondayFolderAndBoards:o,selectedTeam:a,setSelectedTeam:c,teamsOptions:u,mondayImportStoreState:g}=e;const[f,y]=(0,s.useState)(!1),A=!(o.projects.length||o.taskBoards.length),S=(0,n().O$)(p().AppStoreCurrentSpaceViewStore),I=(0,r().DP)(),j=(0,l().tz)(),w=(0,s.useCallback)((e=>{d().No({folderId:o.folderId,spaceId:e}),c(e)}),[o.folderId,c]),k=(0,s.useCallback)((e=>{if("create"===e)return void b().vn("monday_importer",{onClose:w});let t;if("private"===e){if(null==S||!S.id)return;t=S.id}else t=e;d().No({folderId:o.folderId,spaceId:t}),c(e)}),[o.folderId,c,w,null==S?void 0:S.id]);return(0,v.jsxs)(x().Ye,{style:A?{color:I.text.secondary,fill:I.mediumIconColor,opacity:.4,marginLeft:-18}:{marginLeft:-18},children:[(0,v.jsx)(D().A,{ariaLabel:j.formatMessage({id:"mondayImport.importsTab.selectData.collapseToggle",defaultMessage:"Collapse toggle"}),icon:B().l,onClick:()=>y((e=>!e)),style:{transform:f?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:15,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:12,height:12}}),(0,v.jsx)(H().A,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,v.jsxs)(x().Ye,{alignItems:"center",gap:2,children:[(0,v.jsx)(C().A,{style:{marginRight:4,height:14},disabled:A,checked:(()=>{const e={...g.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...g.selectedProjectsAndTeamspaces[o.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:t,isEntireFolderSelected:s}=e;let a,n;if(s)a=[],n=!1;else{a=[...o.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...o.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],n=!0}m().A.setState({...g,selectedProjectsAndTeamspaces:{...g.selectedProjectsAndTeamspaces,[o.folderId]:{notionTeamspaceId:t,projects:a,isEntireFolderSelected:n}}})}}),(0,v.jsx)(h().A,{style:{width:280,textOverflow:"ellipsis"},children:o.folderName})]}),style:{width:300}},...u?[{key:"importInto",header:(0,v.jsxs)(x().Ye,{style:{alignItems:"center"},children:[(0,v.jsx)("div",{children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,v.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,R().Z)({width:12})}),(0,v.jsxs)(x().Ye,{style:{alignItems:"center",gap:8},children:[(0,v.jsx)("img",{src:i().A.emails.notionLogoBlackSmallPng,height:18}),(0,v.jsx)(U,{options:u,onSelectOption:k,currentOption:null===(t=u.find((e=>e.key===a)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:j.formatMessage({id:"mondayImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"}),shouldBeDisabled:A})]})]}),style:{width:"50%"}}]:[]],rows:Y({collapsed:f,mondayFolderAndBoards:o,mondayImportStoreState:g,isMondayV2Flow:!1})})]})}var G=()=>o(579031);function X(){const e=(0,n().K8)((()=>m().A.getState()),[]),t=(0,P().Ar)(),o=(0,l().tz)(),s=(0,n().K8)((()=>{var e;const s=null===(e=p().default.state.currentSpaceViewStore)||void 0===e||null===(e=e.getTeamsStores())||void 0===e?void 0:e.map((e=>e.canAddOrRemoveTopLevelPages()?{id:e.id,name:e.getName(),icon:(0,v.jsx)(k().x,{disabled:!0,store:e})}:null)).filter((e=>null!==e)),a=[];return s&&a.push(...s.map((e=>{var t;return{key:e.id,searchTerm:(null===(t=e.name)||void 0===t?void 0:t.split(" "))||void 0,icon:e.icon,name:e.name}}))),a.push({key:"private",searchTerm:["private"],icon:(0,I().g)(t.lockedIcon),name:o.formatMessage(d().$b.privateSpaceLabel)}),a.push({key:"create",searchTerm:["New"],icon:(0,j().b)(t.plusIcon),name:o.formatMessage(d().$b.newTeamspaceLabel)}),a}),[o,t.lockedIcon,t.plusIcon]),{mondayFoldersDetailsMap:a,selectedImportType:r,isLoadingHierarchy:i,mondayFoldersAndBoards:c,isLoadingProjects:g}=e;return"FullImport"===r?i?(0,v.jsxs)(x().Ye,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,v.jsx)(u().A,{size:"sm"}),(0,v.jsx)(h().A,{isSmall:!0,style:{color:w().XA.light.gray[400]},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.loadingBoardsHelperText",defaultMessage:"Loading boards in the workspace..."})})]}):(0,v.jsx)(v.Fragment,{children:Object.entries(a).filter((e=>{let[,t]=e;return!t.parent})).map((e=>{let[t,o]=e;return(0,v.jsx)(Z,{currentFolderId:o.folderId,notionTeamspaceOptions:s},`${t}-table`)}))}):"ProjectsAndTasks"===r?g?(0,v.jsxs)(x().Ye,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,v.jsx)(u().A,{size:"sm"}),(0,v.jsx)(h().A,{isSmall:!0,style:{color:w().XA.light.gray[400]},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):(0,v.jsx)(v.Fragment,{children:null==c?void 0:c.map((e=>(0,v.jsx)(Q,{mondayFolderAndBoards:e,notionTeamspaceOptions:s},e.folderId)))}):null}const J=function(){const e=(0,a().v3)(),t=(0,n().O$)(p().AppStoreCurrentSpaceStore),s=(0,n().K8)((()=>m().A.getState()),[]),{selectedWorkspace:r,fetchedHierarchy:i,selectedImportType:l,isLoadingHierarchy:c}=s;return(0,o(162901).Yb)((async()=>{if(r&&l&&t)if("FullImport"===l){if(c||i)return;await d().nM({environment:e,spaceId:t.getSpaceId(),selectedWorkspace:r})}else"ProjectsAndTasks"===l&&await d().g3({environment:e,spaceId:null==t?void 0:t.id,selectedWorkspace:r})}),[e,i,c,l,r,t]),(0,v.jsx)(X,{})};function Z(e){let{currentFolderId:t,notionTeamspaceOptions:o}=e;const a=(0,r().DP)(),i=(0,l().tz)(),[c,g]=(0,s.useState)(!1),[f,y]=(0,s.useState)(),I=(0,n().K8)((()=>m().A.getState()),[]),{mondayFoldersDetailsMap:j,mondayBoardsDetailsMap:k,excludeProjectsAndTasks:T,selectedBoardIdsForFullImport:B,selectedFolderIdsForFullImport:R,isLoadingBoards:D}=I,L=null==j?void 0:j[t],O=(0,n().O$)(p().AppStoreCurrentSpaceViewStore);(0,s.useEffect)((()=>{if(!O||!L||!O.getSpaceId())return;I.selectedFolderIdsForFullImport.has(L.folderId)||y("private")}),[L,O,I.selectedFolderIdsForFullImport]);const W=(0,s.useCallback)((e=>{L&&(d().Mi({folderId:L.folderId,notionTeamspaceId:e,notionRootTableName:"team"}),y(e))}),[L]),z=(0,s.useCallback)((e=>{if(L)if("create"!==e){if("private"===e){if(null==O||!O.getSpaceId()||!L)return;d().Mi({folderId:L.folderId,notionTeamspaceId:O.getSpaceId(),notionRootTableName:"space"})}else d().Mi({folderId:L.folderId,notionTeamspaceId:e,notionRootTableName:"team"});y(e)}else b().vn("monday_importer",{onClose:W})}),[L,W,O]),_=(0,s.useMemo)((()=>R?{boardsCount:d().Wh(t,B,j,k,T)}:{boardsCount:0}),[t,T,k,j,B,R]),V=(0,s.useMemo)((()=>({boardsCount:d().nP(t,j,k,T)})),[t,T,k,j]),N=!(L.boards.length||L.subFolders.length),E=(0,s.useMemo)((()=>d().p7({currentfolderId:t,mondayFolderDetails:j,mondayBoardDetails:k,excludeProjectsAndTasks:T})),[t,T,k,j]),U={color:a.text.secondary,fill:a.mediumIconColor,opacity:.4};function q(e){let{mondayFoldersMap:t,mondayBoardsMap:o,currentFolderId:s,excludeProjectsAndTasks:n}=e;if(c)return[];const r=t[s];return[...r.boards.map((e=>{const t=o[e];if(!t||!r)return null;const s=d().dJ({excludeProjectsAndTasks:n,board:t});return{key:e,columns:[(0,v.jsxs)(x().Ye,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,v.jsx)(C().A,{style:s?{color:a.text.secondary,fill:a.mediumIconColor,opacity:.4,marginRight:2}:{marginRight:2},onClick:()=>{d().$A(e)},checked:B.has(e),size:14,checkSize:8,disabled:s}),(0,v.jsx)(F().A,{disableTooltip:!s,renderTooltip:()=>(0,v.jsx)(h().A,{style:{color:w().Ay.white},isSmall:!0,children:i.formatMessage(d().$b.projectsAndTasksExcludedToolTip)}),render:e=>(0,v.jsx)("div",{...e,children:(0,v.jsx)("div",{style:s?{color:a.text.secondary,fill:a.mediumIconColor,opacity:.4,width:240,wordWrap:"break-word"}:{width:240,wordWrap:"break-word"},children:(0,v.jsxs)(h().A,{style:{lineHeight:"20px",fontSize:"14px"},children:[(0,v.jsx)("div",{style:{display:"inline-block",paddingRight:"4px"},children:A({display:"inline-block",color:a.mediumIconColor,width:12.5,height:12.5})}),t.name]})})})})]},`${e}-container`)]}})).filter((e=>null!==e)),...r.subFolders.map((e=>{const s=t[e];return s?{key:e,columns:[(0,v.jsx)(x().Ye,{alignItems:"center",gap:6,style:{marginLeft:20,marginTop:"4px"},children:(0,v.jsx)(H().A,{hideTopBorderForHeader:!0,tableStyle:{borderRadius:2,borderTop:void 0,borderBottom:void 0},cellStyle:{paddingTop:4,paddingBottom:4,verticalAlign:"middle"},rowStyle:{borderTop:void 0},columns:[{key:"team",header:(0,v.jsxs)(x().Ye,{alignItems:"center",gap:2,children:[(0,v.jsx)(C().A,{style:D?{...U,marginRight:4,height:14}:{marginRight:4,height:14},checked:R.has(e),size:14,checkSize:8,disabled:D,onClick:()=>d().TJ(e,t,o,n)}),(0,S().E)({display:"inline-block",color:a.mediumIconColor,width:12.5,height:12.5}),(0,v.jsx)(h().A,{style:{width:280,textOverflow:"ellipsis"},children:s.folderName})]}),style:{width:300,paddingBottom:0}}],rows:q({mondayFoldersMap:t,mondayBoardsMap:o,currentFolderId:e,excludeProjectsAndTasks:n})})},`${e}-container`)]}:null})).filter((e=>null!==e)).flat()]}return L&&k&&E?(0,v.jsx)(F().A,{disableTooltip:!N,renderTooltip:()=>(0,v.jsx)(h().A,{style:{color:w().Ay.white},isSmall:!0,children:i.formatMessage(d().$b.noBoardsTooltipMessage)}),render:e=>{var t;return(0,v.jsx)("div",{...e,children:(0,v.jsx)("div",{style:{marginBottom:10},children:(0,v.jsxs)(M().xA,{gap:8,children:[(0,v.jsx)(M().LX,{row:1,col:1,children:(0,v.jsx)(ee,{shouldBeDisabled:N,collapsed:c,onCollapse:()=>g((e=>!e)),columns:[{key:"team",header:(0,v.jsxs)(x().Ye,{alignItems:"center",gap:2,children:[(0,v.jsx)(C().A,{style:{marginRight:4,height:14},disabled:N||D,checked:I.selectedFolderIdsForFullImport.has(L.folderId),size:14,checkSize:8,onClick:()=>d().TJ(L.folderId,j,k,T)}),(0,S().E)({height:12,width:12,display:"inline-block"}),(0,v.jsxs)(x().Ye,{alignItems:"center",gap:6,children:[(0,v.jsx)(h().A,{style:D?{...U,textOverflow:"ellipsis"}:{textOverflow:"ellipsis"},children:L.folderName}),D&&(0,v.jsx)(u().A,{size:"sm"}),(0,v.jsxs)(h().A,{isSmall:!0,children:[V.boardsCount,i.formatMessage(d().$b.boardsKeyWord)]})]})]}),style:{width:300,paddingBottom:0}}],rows:q({mondayFoldersMap:j,mondayBoardsMap:k,currentFolderId:L.folderId,excludeProjectsAndTasks:T})})}),(0,v.jsx)(M().LX,{row:1,col:2,children:(0,v.jsx)(P().cz,{onSelectOption:z,options:o,currentOption:null===(t=o.find((e=>e.key===f)))||void 0===t?void 0:t.key,style:c?"compact":"full",children:(0,v.jsx)(h().A,{style:{fontSize:"14px",paddingLeft:c?"8px":0},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.chooseWorkspace.totalBoards",defaultMessage:"Import {boardsCount} boards to",values:{boardsCount:_.boardsCount}})})})})]})})})}}):null}function Q(e){let{mondayFolderAndBoards:t,notionTeamspaceOptions:o}=e;const a=(0,P().Ar)(),[r,i]=(0,s.useState)(!1),[c,u]=(0,s.useState)(),g=(0,n().K8)((()=>m().A.getState()),[]),f=(0,n().O$)(p().AppStoreCurrentSpaceViewStore),y=(0,n().K8)((()=>{const e=null==f?void 0:f.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,v.jsx)(k().x,{disabled:!0,store:e})})))}),[f]);(0,s.useEffect)((()=>{if(!y||!f)return;if(!g.selectedProjectsAndTeamspaces[t.folderId]){u("private"),d().No({folderId:t.folderId,spaceId:null==f?void 0:f.id});for(const s of y){var e,o;if((null===(e=s.name)||void 0===e?void 0:e.toLowerCase())===(null===(o=t.folderName)||void 0===o?void 0:o.toLowerCase())){u(s.id),d().No({folderId:t.folderId,spaceId:s.id});break}}}}),[t,f,g.selectedProjectsAndTeamspaces,y]);const A=!(t.projects.length||t.taskBoards.length),S=(0,s.useCallback)((e=>{d().No({folderId:t.folderId,spaceId:e}),u(e)}),[t.folderId]),I=(0,s.useCallback)((e=>{if("create"===e)return void b().vn("monday_importer",{onClose:S});let o;if("private"===e){if(null==f||!f.id)return;o=f.id}else o=e;d().No({folderId:t.folderId,spaceId:o}),u(e)}),[null==f?void 0:f.id,t.folderId,S]),j=(0,l().tz)(),T=(0,s.useMemo)((()=>({projectsCount:t.projects.length,tasksCount:t.taskBoards.length})),[t.projects.length,t.taskBoards.length]),B=(0,s.useMemo)((()=>{var e;const o=null===(e=g.selectedProjectsAndTeamspaces[t.folderId])||void 0===e?void 0:e.projects,[s,a]=o?o.reduce(((e,t)=>{let[o,s]=e;return"projects"===t.collectionType?[o+1,s]:[o,s+1]}),[0,0]):[0,0];return{projectsCount:s,tasksCount:a}}),[t.folderId,g.selectedProjectsAndTeamspaces]);return(0,v.jsx)(F().A,{disableTooltip:!A,renderTooltip:()=>(0,v.jsx)(h().A,{style:{color:w().Ay.white},isSmall:!0,children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.tooltipForDisabledFolder",defaultMessage:"This folder has no boards with Item type Projects or Tasks. Other types are not supported."})}),render:e=>{var s;return(0,v.jsx)("div",{...e,children:(0,v.jsx)("div",{style:a.asanaTeamSectionContainer,children:(0,v.jsxs)(M().xA,{gap:8,children:[(0,v.jsx)(M().LX,{row:1,col:1,children:(0,v.jsx)(ee,{shouldBeDisabled:A,collapsed:r,onCollapse:()=>i((e=>!e)),columns:[{key:"team",header:(0,v.jsxs)(x().Ye,{alignItems:"center",gap:2,children:[(0,v.jsx)(C().A,{style:{marginRight:4,height:14},disabled:A,checked:(()=>{const e={...g.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...g.selectedProjectsAndTeamspaces[t.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:o,isEntireFolderSelected:s}=e;let a,n;if(s)a=[],n=!1;else{a=[...t.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...t.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],n=!0}m().A.setState({...g,selectedProjectsAndTeamspaces:{...g.selectedProjectsAndTeamspaces,[t.folderId]:{notionTeamspaceId:o,projects:a,isEntireFolderSelected:n}}})}}),(0,v.jsxs)(x().Ye,{alignItems:"center",gap:6,children:[(0,v.jsx)(h().A,{style:{textOverflow:"ellipsis"},children:t.folderName}),(0,v.jsx)(F().A,{renderTooltip:()=>(0,v.jsx)(h().A,{style:{color:w().Ay.white},isSmall:!0,children:j.formatMessage(d().$b.projectsAndTasksCountTooltip)}),render:e=>(0,v.jsx)("div",{...e,children:(0,v.jsxs)(h().A,{isSmall:!0,children:[T.projectsCount+T.tasksCount,j.formatMessage(d().$b.projectsKeyWord)]})})})]})]}),style:{width:300,paddingBottom:0}}],rows:Y({collapsed:r,mondayFolderAndBoards:t,mondayImportStoreState:g,isMondayV2Flow:!0})})}),(0,v.jsx)(M().LX,{row:1,col:2,children:(0,v.jsx)(P().cz,{onSelectOption:I,options:o,currentOption:null===(s=o.find((e=>e.key===c)))||void 0===s?void 0:s.key,style:r?"compact":"full",children:(0,v.jsx)(h().A,{style:{fontSize:"14px",paddingLeft:r?"8px":0},children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.chooseWorkspace.totalprojectsAnsTasks",defaultMessage:"Import {projectsCount} Projects to",values:{projectsCount:B.projectsCount+B.tasksCount}})})})})]})})})}})}function ee(e){let{columns:t,rows:o,shouldBeDisabled:s,collapsed:a,onCollapse:n}=e;const i=(0,r().DP)(),l=(0,P().Ar)();return(0,v.jsx)("div",{style:l.teamAndProjectsCollapse,children:(0,v.jsxs)(x().Ye,{style:s?{color:i.text.secondary,fill:i.mediumIconColor,opacity:.4}:{},children:[(0,v.jsx)(T().p,{onClick:()=>n(),style:{gap:12},pressedStyle:{background:"transparent"},iconStyle:{marginRight:0,marginTop:10},ignoreLocalHoverState:!0,icon:e=>(0,v.jsx)(G().A,{disabled:!0,style:{...e,pointerEvents:"none"},isSidebar:!1,open:!a,fill:!1,onClick:e=>{e.stopPropagation(),n()},icon:"chevron"})}),(0,v.jsx)(H().A,{hideTopBorderForHeader:!0,tableStyle:{borderRadius:2,borderTop:void 0,borderBottom:void 0},cellStyle:{paddingTop:4,paddingBottom:4,verticalAlign:"middle"},rowStyle:{borderTop:void 0},columns:t,rows:o})]})})}const te=function(){const e=(0,l().tz)(),t=(0,P().Ar)(),s=(0,n().K8)((()=>m().A.getState()),[]),r=d().P0(),{selectedWorkspace:i,workspaces:p,selectedImportType:u,excludeProjectsAndTasks:g}=s,f=(0,a().v3)().device.isMobile,y="FullImport"===u?{on:g,title:e.formatMessage(d().$b.excludeProjectsAndTasks),focused:!0,onClick:()=>m().A.setState({...s,excludeProjectsAndTasks:!g,selectedFolderIdsForFullImport:new Set,selectedBoardIdsForFullImport:new Set,selectedTeamspacesForFullImport:{}})}:void 0,A=[];return y&&A.push({key:"monday-exclude-projects-and-asks",props:y}),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(x().Ye,{alignItems:"center",gap:8,children:(0,v.jsx)(o(804934).A,{searchThreshold:5,onSelectOption:e=>{m().A.setState({...s,selectedProjectsAndTeamspaces:{},selectedBoardIdsForFullImport:new Set,selectedFolderIdsForFullImport:new Set,selectedTeamspacesForFullImport:{},fetchedHierarchy:!1,mondayFoldersDetailsMap:{},mondayBoardsDetailsMap:{},selectedWorkspace:e})},options:p.map((e=>({key:e.id,name:e.name,searchTerm:[e.name,...e.name.split(" ")]}))),currentOption:i,placeHolder:e.formatMessage(d().$b.selectWorkspaceV2),inputProps:{placeholder:e.formatMessage(d().$b.searchWorkspaces)},buttonStyles:t.workspaceSelectorButton,iconStyles:t.menuChevonDownIcon})}),i&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:e.formatMessage(d().$b.chooseImportType)}),(0,v.jsx)(x().Ye,{alignItems:"left",gap:8,children:(0,v.jsx)(o(90760).A,{isMobile:f,type:"dropdown",currentOption:u,options:Object.entries(r).map((t=>{let[o,s]=t;return{key:o,label:e.formatMessage(s.title),caption:e.formatMessage(s.description)}})),buttonStyle:{paddingLeft:"0px",marginLeft:"0px"},menuStyle:{width:"300px"},onSelectOption:e=>{m().A.setState({...s,selectedImportType:e,selectedProjectsAndTeamspaces:{},selectedBoardIdsForFullImport:new Set,selectedFolderIdsForFullImport:new Set,selectedTeamspacesForFullImport:{},fetchedHierarchy:!1,mondayFoldersDetailsMap:{},mondayBoardsDetailsMap:{}})},switcherButtons:A})})]}),i&&u&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:e.formatMessage(d().$b.selectBoardsHeading)}),(0,v.jsx)(h().A,{style:{font:"SF Pro",fontWeight:c().Wy.regular,fontSize:c().J.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingTop:4,paddingBottom:20},children:e.formatMessage(d().$b.mapTeamspacesDescription)})]}),(0,v.jsx)(J,{})]})};var oe=()=>o(587585);const se=function(){const e=(0,n().O$)(m().A);return e.result?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h().A,{isMultiline:!0,children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,v.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,v.jsx)(ae,{importStatus:e},e.mondayFolderId)))})]}):(0,v.jsx)(v.Fragment,{})};function ae(e){let{importStatus:t}=e;const o=(0,l().tz)(),a=(0,r().DP)(),[i,c]=(0,s.useState)(!1),d=(0,n().O$)(p().AppStoreCurrentSpaceStore),u=(0,n().K8)((()=>m().A.state.mondayFoldersAndBoards),[]),g=(0,n().O$)(p().AppStoreCurrentSpaceViewStore),f=(0,n().K8)((()=>{if(!g)return;const e=g.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,v.jsx)(k().x,{disabled:!0,store:e})})));return d?(e||[]).concat({id:g.id,name:"Private",icon:(0,v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:w().XA.light.gray[75]},children:(0,I().g)({color:a.mediumIconColor,width:12.5,height:12.5})})}):e}),[g,d,a]),{notionTeamspaceName:y,notionTeamspaceIcon:A}=(0,s.useMemo)((()=>{const e=null==f?void 0:f.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[f,t]),S=(0,s.useMemo)((()=>{var e;return null==u||null===(e=u.find((e=>e.folderId===t.mondayFolderId)))||void 0===e?void 0:e.folderName}),[u,t]);return(0,v.jsxs)(x().Ye,{style:{marginTop:16},children:[(0,v.jsx)(D().A,{ariaLabel:o.formatMessage({id:"mondayImport.importsTab.confirm.collapseToggle",defaultMessage:"Collapse toggle"}),icon:B().l,onClick:()=>c((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:10,height:10}}),(0,v.jsx)(H().A,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,v.jsx)(x().Ye,{alignItems:"center",gap:2,children:(0,v.jsx)(h().A,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:S})}),style:{width:300}},{key:"importedInto",header:(0,v.jsxs)(x().Ye,{gap:4,children:[(0,v.jsxs)(x().Ye,{style:{alignItems:"center",gap:4},children:[(0,v.jsx)(h().A,{isSmall:!0,children:(0,v.jsx)(l().sA,{id:"mondayImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,R().Z)({width:12})]}),(0,v.jsxs)(x().Ye,{style:{alignItems:"center",gap:4},children:[A,y]})]}),style:{width:300}}],rows:function(e){let{collapsed:o}=e;return o?[]:t.projects.map((e=>({key:e.projectId,columns:[(0,v.jsxs)(x().Ye,{gap:8,alignItems:"center",children:[(0,oe().q)({width:12,color:w().XA.dark.green[600]}),(0,v.jsx)(h().A,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId)]})))}({collapsed:i})})]})}const ne=(0,l().YK)({failed:{defaultMessage:"Some problems occurred while importing data from your Monday workspace.",id:"Mondayimport.importingData.failed.problemsOccured"}});function re(e,t){switch(e){case"selectData":return(0,v.jsx)(h().A,{style:{paddingBottom:8,fontSize:18,width:"100%",fontWeight:c().Wy.semibold},children:t.formatMessage(d().$b.selectWorkSpaceV1)});case"chooseWorkspace":return(0,v.jsx)(h().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:t.formatMessage(d().$b.chooseWorkSpace)});default:return(0,v.jsx)(v.Fragment,{})}}function ie(e){let{style:t}=e;return(0,v.jsx)(y().A,{title:(0,v.jsx)(l().sA,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"https://www.notion.so/help/monday",analyticsFrom:"import",style:t})}const le=function(e){let{tab:t,fetchActiveImportTasks:c,analyticsFrom:h}=e;const y=o(477784).A.getIntl(),A=(0,a().v3)(),S=(0,n().O$)(p().AppStoreCurrentSpaceStore),I=(0,n().O$)(p().AppStoreCurrentSpaceViewStore),j=(0,o(904697).useTeamsFromCache)(S),w=(0,n().O$)(m().A),b=(0,n().O$)(o(242333).A).flowId||o(214144).JW(),{workspaces:k}=w,T=(0,s.useCallback)((()=>{if("FullImport"===w.selectedImportType)return w.selectedBoardIdsForFullImport.size>0||w.selectedFolderIdsForFullImport.size>0;return Object.values(w.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))}),[w.selectedProjectsAndTeamspaces,w.selectedFolderIdsForFullImport,w.selectedBoardIdsForFullImport,w.selectedImportType]),C=(0,s.useCallback)((()=>{S&&I&&("FullImport"===w.selectedImportType?(d().oz({environment:A,spaceStore:S,flowId:b,spaceViewStore:I}).catch((()=>{})),o(505381).eH(A,{import_source:"monday",from:h})):d().i_({environment:A,spaceStore:S,currentSpaceViewStore:I,teamsStores:j,flowId:b}).catch((()=>{})))}),[I,A,b,w.selectedImportType,S,j,h]),M=(0,r().IS)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.text.secondary}})),[]),F=(0,s.useMemo)((()=>"chooseWorkspace"===t),[t]);return(0,v.jsxs)(o(309461).Ay,{controlRow:(e=>"chooseWorkspace"===e?(0,v.jsx)(o(171131).s,{left:(0,v.jsx)(ie,{}),next:{disabled:!T()||w.templateCreationInProgress,onClick:C,message:y.formatMessage(d().$b.nextButton)},back:{disabled:!k.length,onClick:()=>{c(),m().A.resetImport()},message:y.formatMessage(d().$b.backButton)}}):"selectData"===e?(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,v.jsx)(g().A,{size:"lg",style:{border:0},disabled:!k.length,onClick:()=>{c(),m().A.resetImport()},children:y.formatMessage(d().$b.backButton)}),(0,v.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,v.jsx)(x().Ye,{alignItems:"center",gap:8,children:(0,v.jsx)(f().A,{style:{marginLeft:16},disabled:!T()||w.templateCreationInProgress,onClick:()=>{C()},children:w.templateCreationInProgress?(0,v.jsxs)(x().Ye,{alignItems:"center",gap:2,children:[(0,v.jsx)(u().A,{onDarkBackground:!0}),y.formatMessage(d().$b.creatingTemplate)]}):(0,v.jsx)(v.Fragment,{children:y.formatMessage(d().$b.nextButton)})})})})]}):"importingData"===e?(0,v.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,v.jsx)(g().A,{size:"lg",disabled:!k.length,onClick:()=>{c(),m().A.resetImport()},children:(0,v.jsx)(l().sA,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,v.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,v.jsx)(f().A,{onClick:()=>{var e;if(null!==(e=w.result)&&void 0!==e&&e.length&&w.loggerPageId){const e=w.result.find((e=>void 0!==e.projectCollectionPageId)),t=(null==e?void 0:e.projectCollectionPageId)||w.loggerPageId;o(865226).oo({url:(0,o(220959).A)({pageId:t,pageModel:void 0===t?void 0:A.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:o(145017).ev,id:t},userId:A.currentUser.id}),baseUrl:o(927685).A.domainBaseUrl,pageVisitSource:o(712437).y8.Import}),environment:A})}m().A.resetImport(),o(330358).A.reset()},children:(0,v.jsx)(l().sA,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,v.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,v.jsx)(g().A,{size:"lg",disabled:!k.length,onClick:()=>{c(),m().A.resetImport()},children:(0,v.jsx)(l().sA,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:F?10:20,contentPaddingLeftRight:F?25:void 0,controlRowPaddingLeftRight:F?15:void 0,getPaddingTopBottom:F?()=>2:void 0,children:[(0,v.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:(0,v.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,v.jsx)(o(417653).A,{onClick:()=>{c(),m().A.resetImport()},style:M.closeButton,hoveredStyle:M.closeButtonHover,children:(0,o(81322).V)(M.closeButtonIcon)})})}),re(t,y),(e=>"selectData"===e?(0,v.jsx)(E,{}):"chooseWorkspace"===e?(0,v.jsx)(te,{}):"importingData"===e?(0,v.jsx)(o(940051).A,{assetSrc:i().A.images.import.mondayPng}):"confirm"===e?(0,v.jsx)(se,{}):"failure"===e?(0,v.jsx)(o(467800).A,{assetSrc:i().A.images.import.mondayPng,loggerPageId:w.loggerPageId,failedMessage:y.formatMessage(ne.failed)}):void 0)(t)]})}},534895:(e,t,o)=>{o.d(t,{V:()=>s});const s=(0,o(851552).Dv)("importFile")},581444:(e,t,o)=>{o.d(t,{mD:()=>ie,n3:()=>ne,Od:()=>de,U7:()=>ce,lD:()=>ae,ZB:()=>re,MW:()=>le,un:()=>se,DZ:()=>te});o(610931),o(362833),o(725707),o(491955),o(771702),o(403517);var s=()=>o(16791),a=()=>o(712437),n=()=>o(762847),r=()=>o(846581),i=()=>o(502140),l=()=>o(427091),c=()=>o(524118),d=()=>o(214144),p=()=>o(409103),m=()=>o(361308),u=()=>o(145017),g=()=>o(66460),f=()=>o(704082),h=()=>o(975392),y=()=>o(450475),x=()=>o(23371),v=()=>o(686449),A=()=>o(534895),S=()=>o(851552);const I=(0,S().Dv)("importGoogleDoc"),j=(0,S().Dv)("importTrello"),w=(0,S().Dv)("parallelImportConfluenceExport"),b=(0,S().Dv)("parallelImportConfluenceViaApi"),k=(0,S().Dv)("parallelImportConfluenceViaApiMigrations"),T=(0,S().Dv)("partitionedUniversalImport");var C=()=>o(865226),M=()=>o(137476),F=()=>o(231157),P=()=>o(868325),B=()=>o(409488),R=()=>o(29869),D=()=>o(814370),L=()=>o(836331);const O=1073741824;var W=()=>o(477784),z=()=>o(244698),_=()=>o(617198),V=()=>o(61096),N=()=>o(188594),E=()=>o(141122),U=()=>o(413871),H=()=>o(330358),q=()=>o(505381),$=()=>o(818369),Y=()=>o(145046),K=()=>o(839618),G=()=>o(551102),X=()=>o(70989),J=()=>o(759625),Z=()=>o(163875),Q=()=>o(84543),ee=()=>o(663539);const te=(0,o(653998).YK)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploadingâ€¦ ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importingâ€¦"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed"},importFailedWithError:{id:"importActions.importFailedWithError.message",defaultMessage:"Import failed: {error}"},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},fileImportFailedCustomSizeTooLarge:{id:"importActions.fileImportFailedError.customSizeTooLarge.message",defaultMessage:"We couldnâ€™t process your file. Ensure the file size is under {maxSize}."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleWithImportName:{id:"importActions.importTitleWithImportName",defaultMessage:"{name}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"},importTitleForMondayV2:{id:"importActions.importTitleForMondayV2",defaultMessage:"Import from Monday - {date}"},onlyDocxExtensionSupported:{id:"importErrors.onlyDocxExtensionSupported.message",defaultMessage:"Import failed: file type not supported."},csvImportFailedColumnsTooLarge:{id:"importActions.csvImportFailedColumnsTooLargeError.message",defaultMessage:"Import failed: CSV file has too many columns."},csvImportFailedRowsTooLarge:{id:"importActions.csvImportFailedRowsTooLargeError.message",defaultMessage:"Import failed: CSV file has too many rows."},xlsxImportFailedColumnsTooLarge:{id:"importActions.xlsxImportFailedColumnsTooLargeError.message",defaultMessage:"Import failed: XLSX file has too many columns."},xlsxImportFailedRowsTooLarge:{id:"importActions.xlsxImportFailedRowsTooLargeError.message",defaultMessage:"Import failed: XLSX file has too many rows."}}),oe=1073741824;async function se(e){const{uploadType:t,allowMultiple:o}=e;return ae(e,await ee().dA({environment:e.environment,supportsMobileNativeFileUpload:!1,multiple:o??!0,accept:p().k2[t].join(",")}))}async function ae(e,t){const{environment:o,pageStore:s,spaceStore:n,isTeamPage:r,spaceViewStore:p,uploadType:g,flowId:h,analyticsFrom:x}=e;let v;try{if(0===t.length)return;const f=1===t.length,y=performance.now(),S={};if("confluence"===g){const s=(Number((0,F().xc)(o))||15)*oe;if(t[0].size>s)throw q()._$(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:h}),new(c().ico)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:m().z3(s,1)}}})}else if("genericImporter"===g){const s=(0,B().qr)(o)||15,a=s*oe;if(t[0].size>a)throw q()._$(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:h}),new(c().yI4)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}else if("pdf"===g){const o=Number(L().default.getEligibleGroup({experimentId:"special_case_pdf_file_size",defaultGroup:O.toString()})),s=o;for(const a of t)if(a.size>s)throw q()._$(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:a.size},flowId:h}),new(c().yI4)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${o} GB}`}}})}const I=await new Promise(((e,s)=>{ee().Zn({environment:o,uploadType:g,files:t,bucket:"temporary",bypassFreeFileUploadLimitCheck:!0,flowId:h,spaceId:n.id,onBatchStart:()=>{X().m({message:f?te.uploadingOneFile:te.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:o,progressPercent:s}=e;X().m({message:f?te.uploadingOneFile:te.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:o,totalNumberOfFiles:t.length,percentComplete:s}})},onBatchCompleteWithToken:o=>{X().m({message:f?te.uploadingOneFile:te.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:100}}),e(o)},onBatchError:s})})),j=performance.now();S.uploadTimeTaken=j-y;const b="slash_command"===x&&!["gdocs","confluence","genericImporter"].includes(g),k=await ne(o,n,p,g,(null==t?void 0:t.length)??0,null==t?void 0:t[0].name,s,r,b);v=k.createdPage;const P=k.importType,D=k.pageId,W=I.map(((e,o)=>({fileURL:e.fileUrl,fileName:t[o].name,signedToken:e.signedToken}))),z=L().default.checkGate({gateName:"csvimport_faster_navigate_to_page_enabled"});let _=0;X().m({message:f?te.importingOneFile:te.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:_,totalNumberOfFiles:t.length}});const V=(0,l().P)();if(z&&("ReplaceBlock"===P||"AppendToBlock"===P)&&"csv"===g){const e=U().Bv.createChildStore(n,{table:u().ev,id:D}),t=(0,R().Ay)({store:e,preferPublicLink:!1,pageVisitSource:a().y8.Import});C().navigateOnBaseUrl({environment:o,url:t})}for(const{fileURL:e,fileName:s,signedToken:a}of W){if("confluence"===g){q()._$(o,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:t[0].size},flowId:h});const r=ie({environment:o,spaceStore:n,spaceViewStore:p});await r.deferred.promise;const i=r.pageId;q().Pd(o,{integration_name:"confluence"});const l=K().UT(o,w,{fileURL:e,fileName:s,page:{id:D,spaceId:n.id},loggerPageId:i,flowId:h||d().JW(),signedToken:a});for await(const e of l){if(e.error)throw e.error;e.value.isComplete||X().m(e.value.status)}}else if("AppendToBlock"===P){const t={fileURL:e,fileName:s,importType:P,block:{id:D,spaceId:k.spaceId},spaceId:k.spaceId,flowId:h,userTimeZone:V,signedToken:a,importEntryPoint:x};q().mM(o,{import_source:"file",data:t,flowId:h});const n=L().default.checkGate({gateName:"partitioned_universal_importer"}),r={fileURL:e,fileName:s,importType:"ReplaceBlock",spaceId:k.spaceId,rootId:D,userTimeZone:V,signedToken:a};q().Pd(o,{integration_name:"genericImporter"===g?"universal":g});const i="genericImporter"===g&&n?K().UT(o,T,r):K().UT(o,A().V,t);let l=!1;for await(const e of i){if(e.error)throw e.error;z&&"csv"===g&&"status"in e.value&&"created_collection"===e.value.status.message&&!l&&(l=!0,X().V(),H().A.reset(),S.importingSpinnerSpan||=performance.now()-j)}}else if("ReplaceBlock"===P){const t={fileURL:e,fileName:s,importType:P,block:{id:D,spaceId:k.spaceId},flowId:h,spaceId:k.spaceId,userTimeZone:V,signedToken:a,importEntryPoint:x};q().mM(o,{import_source:"file",data:t,flowId:h}),q().Pd(o,{integration_name:"genericImporter"===g?"universal":"file"});const n=L().default.checkGate({gateName:"partitioned_universal_importer"}),r={fileURL:e,fileName:s,importType:"ReplaceBlock",spaceId:k.spaceId,rootId:D,userTimeZone:V,signedToken:a},i="genericImporter"===g&&n?K().UT(o,T,r):K().UT(o,A().V,t);let l=!1;for await(const e of i){if(e.error)throw e.error;z&&"csv"===g&&"status"in e.value&&"created_collection"===e.value.status.message&&(l||(l=!0,X().V(),H().A.reset(),S.importingSpinnerSpan||=performance.now()-j))}}_++,z&&"csv"===g||X().m({message:f?te.importingOneFile:te.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:_,totalNumberOfFiles:t.length}})}return X().V(),S.overallTimeTaken=performance.now()-y,function(e,t){const{uploadType:o,importType:s,importLatencies:a,fileNames:n}=t;if(("ReplaceBlock"===s||"AppendToBlock"===s)&&"csv"===o){const e=a.uploadTimeTaken,t=a.importingSpinnerSpan,o=t&&e?t+e:a.overallTimeTaken;a.firstTimeNavigateToCollection=o}i().log({level:"info",from:"importActions",type:"importFiles",data:{miscDataToConvertToString:{fileNames:n,importLatencies:a,uploadType:o,importType:s},message:"Finished importing file"}});for(const[r,i]of Object.entries(a))(0,M().u4)({environment:e,event:{eventName:"import_file_finished",eventProperties:{importUploadType:o,importType:s,importLatency:i,importSource:"file",importLatencyType:r,importFileCount:n.length}}})}(o,{uploadType:g,importType:P,importLatencies:S,fileNames:t.map((e=>e.name))}),U().Bv.createChildStore(n,{table:u().ev,id:D})}catch(j){var S,I;let e;i().log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,y().convertErrorToLog)(j),data:{spaceId:n.id}}),X().V(),Q().createAndCommit({userAction:"importActions.importFiles",environment:o,canUndo:!0,perform:e=>{v&&G().TF({parentStore:n.getPagesStore(),childToRemoveStore:v,transaction:e})}});let t=null,s=null;if(j instanceof c().mvP&&j.clientData?(t=j.clientData,P().yC[j.clientData.type]&&"ImportFileSizeTooLargeError"===(0,f().A)(j).message?s=P().yC[j.clientData.type]:P().mW[j.clientData.type]&&"CsvImportError"===(0,f().A)(j).message?s=P().mW[j.clientData.type]:P().Ep[j.clientData.type]?s=P().Ep[j.clientData.type]:P()._j[j.clientData.type]&&(s=P()._j[j.clientData.type])):j instanceof c().ico&&"upload_file_size_exceeded"===(null===(S=j.body)||void 0===S||null===(S=S.clientData)||void 0===S?void 0:S.type)&&P().Ep[j.body.clientData.type]?(t=j.body.clientData,s=P().Ep[t.type]):j instanceof D().C?(t={messageValues:{error:"You've reached the maximum number of file uploads for a 12-hour period. We suggest uploading a ZIP file that includes all your files."}},s=te.importFailedWithError):j instanceof c().yI4&&"upload_file_size_exceeded"===(null===(I=j.body)||void 0===I||null===(I=I.clientData)||void 0===I?void 0:I.type)&&(t=j.body.clientData,s=P()._j[j.body.clientData.type]),t&&s){const o="messageValues"in t?t.messageValues:void 0;e=W().A.formatMessage(s,o)}else e=t&&"code"in t&&("fileImportError"===t.code||"confluenceImportError"===t.code)?W().A.formatMessage(te.importFailedWithError,{error:(0,f().A)(j).message}):"ImportFileSizeTooLargeError"===(0,f().A)(j).message?W().A.formatMessage(te.fileImportFailedSizeTooLarge):"ImportcsvTooManyColumns"===(0,f().A)(j).message?W().A.formatMessage(te.csvImportFailedColumnsTooLarge):"ImportcsvTooManyRows"===(0,f().A)(j).message?W().A.formatMessage(te.csvImportFailedRowsTooLarge):"ImportxlsxTooManyColumns"===(0,f().A)(j).message?W().A.formatMessage(te.xlsxImportFailedColumnsTooLarge):"ImportxlsxTooManyRows"===(0,f().A)(j).message?W().A.formatMessage(te.xlsxImportFailedRowsTooLarge):W().A.formatMessage(te.importFailed);throw Y().f1(e),j}}async function ne(e,t,o,a,n,i,l,c,d){var p;let m,u,g,f=t.id;if(E().default.isSidePeekOpen()&&E().default.peekTargetStore.state&&d)u=E().default.peekTargetStore.state.id,g="AppendToBlock";else if(E().default.isSidePeekOpen()&&null!==(p=E().default.peekTargetStore.state)&&void 0!==p&&p.isEmptyPage())u=E().default.peekTargetStore.state.id,g="ReplaceBlock";else if(l&&(l.isEmptyPage()||d))n>1||l.isInsideCollection()||d?(u=l.id,g="AppendToBlock"):(u=l.id,g="ReplaceBlock");else{const l={date:(0,r().W_)(Date.now(),"medium",s().locale)};"genericImporter"===a&&(l.fileName=i?i.replace(".zip",""):"Universal File");const{performResult:d}=Q().createAndCommit({userAction:"importActions.result",environment:e,canUndo:!0,perform:s=>{const r=W().A.formatMessage("genericImporter"===a?te.importTitleForGenericFileImporter:te.importTitle,l),i=Z().IT({environment:e,spaceStore:t,spaceViewStore:o,isPrivate:!c,prepend:!c,title:r,transaction:s}),d=n>1?"AppendToBlock":"ReplaceBlock",p=x().yX();return s.postSubmitCallbacks.push((e=>{e?p.reject(e):p.resolve(void 0)})),{deferred:p,createdPage:i,pageId:i.id,importType:d,spaceId:i.getSpaceId()}}});m=d.createdPage,u=d.pageId,g=d.importType,f=d.spaceId,await d.deferred.promise}return{createdPage:m,pageId:u,importType:g,spaceId:f}}async function re(e){const{environment:t,fileId:o,token:s,spaceStore:a,spaceViewStore:n,pageStore:r,analyticsFrom:i}=e;let l;try{X().m({message:te.importingOneFile});const e="link_paste"===i||"slash_command"===i,c=await ne(t,a,n,"gdocs",1,void 0,r,void 0,e);l=c.createdPage;const d=c.importType,p=c.pageId,m={fileId:o,tokenId:s.id,importType:d,block:{id:p,spaceId:a.id}};q().mM(t,{import_source:"gDocs",data:m}),q().Pd(t,{integration_name:"gDocs"});const{value:g}=await K().UT(t,I,m).next();if(g.error)throw g.error;return X().V(),U().Bv.createChildStore(a,{table:u().ev,id:p})}catch(d){Q().createAndCommit({userAction:"importActions.importFiles",environment:t,canUndo:!0,perform:e=>{l&&G().TF({parentStore:a.getPagesStore(),childToRemoveStore:l,transaction:e})}});let e=W().A.formatMessage(te.importFailed);throw d instanceof c().mvP&&d.clientData&&("only_docx_extension_supported"===d.clientData.type?e=W().A.formatMessage(te.onlyDocxExtensionSupported):"file_size_exceeded"===d.clientData.type&&(e=W().A.formatMessage(te.fileImportFailedCustomSizeTooLarge,{maxSize:d.clientData.messageValues.maxSize}))),Y().f1(e),X().V(),new Error((0,f().A)(d).message)}}function ie(e){const{environment:t,spaceStore:o,spaceViewStore:a,append:n,mondayV2:i}=e,{performResult:l}=Q().createAndCommit({userAction:"importActions.result",environment:t,canUndo:!0,perform:e=>{const l=i?W().A.formatMessage(te.importTitleForMondayV2,{date:(0,r().W_)(Date.now(),"medium",s().locale)}):W().A.formatMessage(te.importTitle,{date:(0,r().W_)(Date.now(),"medium",s().locale)}),c=Z().IT({environment:t,spaceStore:o,spaceViewStore:a,isPrivate:!0,prepend:!n,title:i?l:`${l} Logs`,transaction:e}),d=x().yX();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve(void 0)})),{deferred:d,pageId:c.id}}});return l}async function le(e){const{environment:t,boards:o,spaceStore:s,spaceViewStore:a}=e;X().m({message:te.importingFromTrelloMessage,interpolatedValues:{importingCount:o.length}}),N().A.setState({open:!1});const{performResult:{deferred:n,pages:r}}=Q().createAndCommit({userAction:"importActions.importTrello",environment:t,canUndo:!0,perform:e=>{const n=o.map((o=>Z().IT({environment:t,spaceStore:s,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!0,title:o.name,transaction:e}))),r=x().yX();return e.postSubmitCallbacks.push((e=>{e?r.reject(e):r.resolve(void 0)})),{deferred:r,pages:n}}});await n.promise;try{return await Promise.all(r.map((async(e,s)=>{const a=o[s],{value:n}=await K().UT(t,j,{boardId:a.id,block:{id:e.id,spaceId:(0,g().e)(e.pointer.spaceId)}}).next();if(n.error)throw n.error}))),X().V(),r[0]}catch(i){Q().createAndCommit({userAction:"importActions.importTrello",environment:t,canUndo:!0,perform:e=>{for(const t of r)G().TF({parentStore:s.getPagesStore(),childToRemoveStore:t,transaction:e})}});let e=W().A.formatMessage(te.trelloImportFailed);const o=i instanceof c().lV7?i.body.clientData:void 0;throw o&&"code"in o&&"trelloImportError"===o.code&&(e=W().A.formatMessage(te.importFailedWithError,{error:(0,f().A)(i).message})),Y().f1(e),X().V(),new Error((0,f().A)(i).message)}}async function ce(e){const{environment:t,spaceStore:o,spaceViewStore:s,notebooks:a,userSettingsStore:r}=e;if(0===a.length)throw new Error("Expected at least one notebook");X().m({message:te.importingFromEvernoteMessage,interpolatedValues:{importingCount:a.length}}),V().A.setState({open:!1});const i=await async function(e){const{environment:t,spaceStore:o,spaceViewStore:s,notebooks:a}=e,{serverCommitResult:r,performResult:{blockStores:i}}=Q().createAndCommit({userAction:"importActions.createStacks",environment:t,canUndo:!0,perform:e=>{const r=h().sb(h().oE(a.map((e=>e.stack)))).sort().reverse(),i={};let l=e=>!0;return a.length>1&&r.length>0&&(r.forEach((r=>{const l=Z().IT({environment:t,spaceStore:o,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!1,title:r,transaction:e}),c=l.getContentStore();a.filter((e=>e.stack===r)).forEach((o=>{const s=J().Wv({environment:t,type:n().xd.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:c.pointer.spaceId});G().BC({parentStore:c,appendStore:s,transaction:e}),i[o.guid]=s}))})),l=e=>!Boolean(e.stack)),a.filter(l).reverse().forEach((a=>{const n=Z().IT({environment:t,spaceStore:o,spaceViewStore:s,isPrivate:!0,prepend:!0,loading:!0,title:a.title,transaction:e});i[a.guid]=n})),{blockStores:i}}});return await r,i}({environment:t,spaceStore:o,spaceViewStore:s,notebooks:a}),l=i[a[0].guid];try{return await async function(e){const{environment:t,spaceStore:o,spaceViewStore:s,notebooks:a,waitForNotebookStore:n,notebookMapping:r,userSettingsStore:i}=e;let l;if(x().vA(a,pe,(async e=>{await Promise.all(e.map((async e=>{const o=r[e.guid];if(!o)throw new Error(`Missing notebook page ${e.guid}`);const s=x().yX();o===n&&(l=s),await async function(e){const{environment:t,notebookStore:o,notebook:s,firstCompleted:a}=e,n=K().UT(t,v().r,{notebookId:s.guid,block:{id:o.id,spaceId:(0,g().e)(o.pointer.spaceId)},timestamp:Date.now(),parentTable:u().ev}),{value:r}=await n.next();if(r.error){console.error(r.error),Q().createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,canUndo:!0,perform:e=>{const t=o.getParentBlockStore();if(t){const s=t.getContentStore();G().TF({parentStore:s,childToRemoveStore:o,transaction:e})}}});let e=W().A.formatMessage(te.evernoteImportFailed);const s=r.error instanceof c().DfQ?r.error.body.clientData:void 0;s&&"code"in s&&"evernoteImportError"===s.code&&(e=W().A.formatMessage(te.importFailedWithError,{error:(0,f().A)(r.error).message})),Y().f1(e),a.resolve(void 0)}a.resolve(void 0)}({environment:t,notebookStore:o,notebook:e,firstCompleted:s})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=i.getSettings();null!=d&&d.created_evernote_getting_started||await z().createGettingStartedPageInSpace({environment:t,type:"evernote",spaceStore:o,spaceViewStore:s,userSettingsStore:i});await l.promise}({environment:t,waitForNotebookStore:l,notebookMapping:i,notebooks:a,spaceStore:o,spaceViewStore:s,userSettingsStore:r}),X().V(),l}catch(d){throw X().V(),Y().f1(W().A.formatMessage(te.evernoteImportFailed)),d}}async function de(e){const{environment:t,spaceStore:o,spaceViewStore:s,space:a,flowId:n}=e;if(!t.currentUser.id)throw new Error("User does not exist.");X().m({message:te.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:a.name}}),_().A.setState({open:!1});const r=ie({environment:t,spaceStore:o,spaceViewStore:s});await r.deferred.promise;const l=r.pageId;let d;if((0,F().vY)(t)){const e=await $().callApi({eventName:"createTeam",environment:t,data:{spaceId:o.id,name:a.name,accessLevel:"closed"}});if("failed"===e.type)throw new Error("Cannot create teamspace");d=e.data.teamId}const{performResult:p}=Q().createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,canUndo:!0,perform:e=>{const n=W().A.formatMessage(te.importTitleWithImportName,{name:a.name}),r=Z().IT({environment:t,spaceStore:o,spaceViewStore:s,isPrivate:!0,prepend:!0,title:n,transaction:e}),i=x().yX();return e.postSubmitCallbacks.push((e=>{e?i.reject(e):i.resolve(void 0)})),{deferred:i,createdPage:r,pageId:r.id}}});await p.deferred.promise;const m=p.createdPage;try{if(!m)throw new Error("No root page");q().Pd(t,{integration_name:"confluence"});const e=L().default.checkGate({gateName:"use_import_migration_service"})?k:b,s=K().UT(t,e,{userId:t.currentUser.id,confluenceSpaceKey:a.key,confluenceSpaceId:a.id,confluenceSpaceName:a.name,page:{id:p.pageId,spaceId:o.id},loggerPageId:l,flowId:n,teamId:d});for await(const t of s){if(t.error)throw t.error;t.value.isComplete||X().m(t.value.status)}return X().V(),m}catch(u){i().log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,y().convertErrorToLog)(u),data:{spaceId:o.id}}),Q().createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,canUndo:!0,perform:e=>{m&&G().TF({parentStore:o.getPagesStore(),childToRemoveStore:m,transaction:e})}});let e=W().A.formatMessage(te.confluenceImportViaAPIFailed);const s=u instanceof c().ico?u.body.clientData:void 0;throw s&&"code"in s&&"confluenceImportError"===s.code&&(e=W().A.formatMessage(te.importFailedWithError,{error:(0,f().A)(u).message})),Y().f1(e),X().V(),new Error((0,f().A)(u).message)}}const pe=2},587585:(e,t,o)=>{o.d(t,{q:()=>a});o(242343);var s=o(163643);const a=(0,o(680369).wt)("circleCheckFilled",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M8 16c4.377 0 8-3.631 8-8 0-4.376-3.631-8-8.008-8C3.624 0 0 3.624 0 8c0 4.369 3.631 8 8 8zm-.886-4.165c-.267 0-.487-.11-.69-.384l-1.97-2.416a.852.852 0 01-.187-.51c0-.352.274-.643.627-.643.228 0 .4.07.596.33l1.592 2.055 3.35-5.38c.148-.236.352-.362.556-.362.345 0 .667.236.667.604 0 .173-.102.353-.196.518l-3.686 5.804c-.165.259-.393.384-.66.384z"})})},617198:(e,t,o)=>{o.d(t,{A:()=>s});const s=new(o(962373).A)},633627:(e,t,o)=>{o.d(t,{Y:()=>n});o(242343);var s=o(163643);const a={viewBox:"0 0 20 20",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M9.533.62a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408V11a.625.625 0 1 1-1.25 0V2.546L7.917 4.004a.625.625 0 1 1-.884-.883z"}),(0,s.jsx)("path",{d:"M8.125 5.125H5.5A2.125 2.125 0 0 0 3.375 7.25v7.5c0 1.174.951 2.125 2.125 2.125h9a2.125 2.125 0 0 0 2.125-2.125v-7.5A2.125 2.125 0 0 0 14.5 5.125h-2.625v1.25H14.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-9a.875.875 0 0 1-.875-.875v-7.5c0-.483.392-.875.875-.875h2.625z"})]})},n=(0,o(680369).wt)("squareAndArrowUp",a)},661584:(e,t,o)=>{o.d(t,{A:()=>a});class s extends(()=>o(129044))().default{getInitialState(){return{notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1,linkingAccount:!1}}}const a=new s},738674:(e,t,o)=>{o.d(t,{J:()=>x,p:()=>v});var s=()=>o(545250),a=()=>o(809811),n=()=>o(505381),r=()=>o(145046),i=()=>o(927685),l=()=>o(142548),c=()=>o(661584),d=()=>o(61096),p=()=>o(242333),m=()=>o(330358),u=()=>o(818369),g=()=>o(437071),f=()=>o(70989),h=()=>o(961987);const y=(0,o(653998).YK)({authenticatingWithEvernote:{id:"evernoteActions.authenticatingWithEvernote.loadingMessage",defaultMessage:"Authenticating with Evernoteâ€¦"},titleMessage:{defaultMessage:"Evernote login",id:"evernoteActions.loginPopupModal.title"}});async function x(e){const{environment:t,requestStore:o}=e,x=(0,l().LX)(t);let A=(0,s().TD)(i().A.domainBaseUrl,{authType:x,userId:t.currentUser.id,isElectronDevice:t.device.isElectron});if(A=x.redirectToAuth?A:await(0,l().YN)(t,A),t.device.isElectron)return f().m({message:y.authenticatingWithEvernote}),c().A.setState({...c().A.state,linkingAccount:!0,showLoader:!0}),void g().openExternalUrl(A);const S=await h().P(t,{width:580,height:700,url:A,titleMessage:y.titleMessage});if(!S)return;const I=a().qg(S),j=I.query.oauth_token,w=I.query.oauth_verifier;if(!j||!w)return;f().m({message:y.authenticatingWithEvernote});const b=await u().callApi({eventName:"authWithEvernote",environment:t,data:{requestToken:j,verifier:w}}),k=p().A.getOrCreateFlowId();if("failed"===b.type)return n()._$(t,{import_source:"evernote",data:{import_type:"api",status:"failure",error:b.error,userId:t.currentUser.id},flowId:k}),console.error(b.error),r().Qg(b),void f().V();n()._$(t,{import_source:"evernote",data:{import_type:"api",status:"success",userId:t.currentUser.id},flowId:k}),n().mu(t,{integration_name:"evernote"}),await o.refresh(),d().A.setState({open:!0}),m().A.setState({...m().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),await v({environment:t,requestStore:o}),f().V()}async function v(e){const{environment:t,requestStore:o}=e;try{c().A.setState({...c().A.state,isFetchingNotebooks:!0,showLoader:!0});const e=await u().callApi({eventName:"getEvernoteNotebooks",environment:t,data:{}});if(await o.refresh(),"success"===e.type){c().A.setState({...c().A.state,notebooksResponse:e.data,isFetchingNotebooks:!1,showLoader:!1});const{userInfo:t,notebooks:o}=e.data;return{userInfo:t,notebooks:o}}return console.error(e.error),{notebooks:[],userInfo:void 0}}catch(s){return console.error(s),{notebooks:[],userInfo:void 0}}}},738695:(e,t,o)=>{o.d(t,{w:()=>n});var s=()=>o(803290),a=()=>o(836331);function n(){return(0,s().K8)((()=>a().default.checkGate({gateName:"import_modal_redesign"})),[])}},777010:(e,t,o)=>{o.d(t,{j:()=>l});o(725707),o(491955),o(500234),o(403517);var s=o.n(o(567012)),a=o(242343),n=()=>o(76394),r=()=>o(858023),i=o(163643);function l(e){const{filterQuery:t,sections:o,...l}=e,c=(0,a.useMemo)((()=>o.map((e=>function(e,t){const{items:o,...a}=e;if(!t)return e;const n=o.filter((e=>e.keywords.find((e=>s().match(t,e)))));return n.length>0?{...a,items:n}:void 0}(e,t))).filter(n().O9)),[t,o]);return(0,i.jsx)(r().Ay,{...l,sections:c})}},804934:(e,t,o)=>{o.d(t,{A:()=>v});o(725707),o(500234),o(403517);var s=o(242343),a=()=>o(198654),n=()=>o(220413),r=()=>o(76394),i=()=>o(640979),l=()=>o(209684),c=()=>o(535906),d=()=>o(273520),p=()=>o(777010),m=()=>o(401382),u=()=>o(935091),g=()=>o(858023),f=()=>o(88271),h=()=>o(35462),y=()=>o(610271),x=o(163643);function v(e){const{onSelectOption:t,options:o,currentOption:v,placeHolder:A,buttonStyles:S,initialFocus:I,menuProps:j,iconOnly:w,inputProps:b,iconStyles:k,searchThreshold:T}=e,[C,M]=(0,s.useState)(""),F=o.find((e=>{let{key:t}=e;return t===v}));function P(e){return(0,x.jsxs)(y().Ye,{alignItems:"center",style:{gap:4},children:[e.icon,(0,x.jsx)(h().A,{children:e.name})]})}return(0,x.jsx)(d().Ay,{popupType:d().z7.Popup,placementToOrigin:d().sx.Bottom,renderOrigin:e=>(0,x.jsxs)(l().p,{...e,style:{color:v?void 0:n().XA.light.gray[300],...S},children:[(0,x.jsx)(h().A,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:v?void 0:"#ACABA9",lineHeight:"19.6px"},children:(w?null==F?void 0:F.icon:F&&P(F))??A}),(0,a().b)(k)]}),render:e=>{const s=(0,x.jsx)(m().Ay,{style:{width:"100%",paddingTop:8,paddingBottom:2},onChange:e=>M(e.target.value),value:C,...b}),a={menuType:i().gu.Popup,width:376,left:50,header:(0,r().O9)(T)&&o.length>T?s:null,...j},n=o.map((o=>{let{key:s,name:a,icon:n,searchTerm:r}=o;return{key:s,keywords:r??[],action:()=>{t(s),e.close()},render:e=>(0,x.jsx)(c().A,{...e,title:P({name:a,icon:n}),shouldWrapCaption:!0,isChecked:v===s})}}));return(0,x.jsx)(u().A,{...a,children:(0,x.jsx)(p().j,{type:g().Oh.Vertical,filterQuery:C,sections:[{key:"asanaImport.dropdown.menuList",render:e=>(0,x.jsx)(f().A,{...e}),items:n}],initialFocus:I,style:{position:"relative",alignItems:"flex-end"}})})}})}},858280:(e,t,o)=>{o.d(t,{n:()=>a});o(242343);var s=o(163643);const a=(0,o(680369).wt)("import",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},860706:(e,t,o)=>{o.d(t,{Ar:()=>R,Ay:()=>L,cz:()=>B});o(362833),o(725707),o(491955),o(403517),o(244387),o(567012);var s=o(242343),a=()=>o(237385),n=()=>o(803290),r=()=>o(174114),i=()=>o(175532),l=()=>o(706412),c=()=>o(748267),d=()=>o(280704),p=()=>o(653998),m=()=>o(220413),u=()=>o(76394),g=()=>o(31448),f=()=>o(304410),h=()=>o(485966),y=()=>o(773866),x=()=>o(628854),v=()=>o(424339),A=()=>o(209684),S=()=>o(731942),I=()=>o(517198),j=()=>o(35462),w=()=>o(610271),b=()=>o(874413),k=()=>o(307567),T=()=>o(804934),C=o(163643);const M=(0,p().YK)({selectWorkspace:{id:"asanaImporter.chooseWorkspace.chooseWorkspacePlaceholder",defaultMessage:"Choose a workspace"},selectProjectHeading:{id:"asanaImport.importsTab.chooseWorkspace.selectProjects",defaultMessage:"Choose projects to import"},mapTeamspacesDescription:{id:"asanaImport.importsTab.chooseWorkspace.tabDescription",defaultMessage:"You can give each Asana team a Notion teamspace to collaborate in. Each teamspace has a Projects database, where your imported projects will live."},chooseTeamspaceOption:{id:"asanaImport.importsTab.chooseWorkspace.selectTeamspace",defaultMessage:"Choose a teamspace"},filterTeams:{id:"asanaImport.importsTab.chooseWorkspace.filterTeams",defaultMessage:"Filter teamspaces..."},filterWorkspaces:{id:"asanaImport.importsTab.chooseWorkspace.searchAsanaWorkspaces",defaultMessage:"Filter workspaces..."},newTeamspaceLabel:{id:"asanaImport.importsTab.chooseWorkspace.newTeamspace",defaultMessage:"New teamspace"},privateSpaceLabel:{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"},completedProjectLabel:{id:"asanaImport.importsTab.chooseWorkspace.completedHelperText",defaultMessage:" (Completed)"}});function F(e){let{asanaTeam:t}=e;const o=R(),a=(0,p().tz)(),r=(0,n().K8)((()=>y().A.getState()),[]),i=(0,n().K8)((()=>{var e;const t=null===(e=h().default.state.currentSpaceViewStore)||void 0===e||null===(e=e.getTeamsStores())||void 0===e?void 0:e.map((e=>e.canAddOrRemoveTopLevelPages()?{id:e.id,name:e.getName(),icon:(0,C.jsx)(v().x,{disabled:!0,store:e})}:null)).filter((e=>null!==e)),s=[];return t&&s.push(...t.map((e=>{var t;return{key:e.id,searchTerm:(null===(t=e.name)||void 0===t?void 0:t.split(" "))||void 0,icon:e.icon,name:e.name}}))),s.push({key:"private",searchTerm:["private"],icon:(0,c().g)(o.lockedIcon),name:a.formatMessage(M.privateSpaceLabel)}),s.push({key:"create",searchTerm:["New"],icon:(0,d().b)(o.plusIcon),name:a.formatMessage(M.newTeamspaceLabel)}),s}),[a,o.lockedIcon,o.plusIcon]),{importCompletedTasks:l,selectedProjectsAndTeamspaces:m}=r,u=(0,s.useMemo)((()=>m[t.gid]||{projects:[],notionTeamspaceId:void 0}),[m,t.gid]),[g,A]=(0,s.useState)(u.notionTeamspaceId),I=(0,n().O$)(h().AppStoreCurrentSpaceViewStore),w=(0,s.useCallback)((e=>{if(g===e)return f().$8({teamId:t.gid,spaceId:null}),void A(void 0);if("create"===e)return void x().vn("asana_importer",{onClose:e=>{f().$8({teamId:t.gid,spaceId:e}),A(e)}});let o;if("private"===e){if(null==I||!I.id)return;o=I.id}else o=e;f().$8({teamId:t.gid,spaceId:o}),A(e)}),[null==I?void 0:I.id,t.gid,g]),b=(0,s.useCallback)((e=>{const o={...m[t.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:s,projects:a}=o;let n=a;"all"===n&&(n=t.projects.map((e=>e.gid))),"in_complete"===n&&(n=t.projects.filter((e=>!e.completed)).map((e=>e.gid))),n=n.includes(e.gid)?n.filter((t=>t!==e.gid)):n.concat(e.gid),y().A.setState({...r,selectedProjectsAndTeamspaces:{...m,[t.gid]:{notionTeamspaceId:s,projects:n}}})}),[t.gid,t.projects,r,m]),k=(0,s.useMemo)((()=>{const{projects:e}=u;return 0!==e.length&&(e.length===t.projects.length||"partial")}),[u,t.projects]),T=(0,s.useCallback)((()=>{var e;let o=[];0===u.projects.length?(o=t.projects.filter((e=>!e.completed)).map((e=>e.gid)),0===o.length&&(o=t.projects.map((e=>e.gid)))):o=u.projects.length===t.projects.length?[]:t.projects.map((e=>e.gid)),y().A.setState({...r,selectedProjectsAndTeamspaces:{...m,[t.gid]:{notionTeamspaceId:null===(e=m[t.gid])||void 0===e?void 0:e.notionTeamspaceId,projects:o}}})}),[u.projects,t.projects,t.gid,r,m]),F=(0,s.useMemo)((()=>{const e=r.importCompletedTasks;let o=t.projects;return"in_complete"===u.projects?o=o.filter((e=>!e.completed)):"all"!==u.projects&&u.projects.length!==o.length&&(o=o.filter((e=>u.projects.includes(e.gid)))),{projects:o.length,tasks:o.reduce(((t,o)=>t+(e?o.task_counts.num_tasks:o.task_counts.num_incomplete_tasks)),0)}}),[u.projects,t.projects,r.importCompletedTasks]),[D,L]=(0,s.useState)(!1);return(0,C.jsx)("div",{style:o.asanaTeamSectionContainer,children:(0,C.jsxs)(S().xA,{gap:8,children:[(0,C.jsx)(S().LX,{row:1,col:1,children:(0,C.jsx)("div",{style:o.teamAndProjectsCollapse,children:(0,C.jsx)(P,{team:t,importCompletedTasks:l,collapsed:D,onToggle:()=>L((e=>!e)),checked:e=>"all"===u.projects||"in_complete"===u.projects&&!1===e.completed||u.projects.includes(e.gid),onSelectProject:b,onSelectGroup:T,groupCheckState:k})})}),(0,C.jsx)(S().LX,{row:1,col:2,children:(0,C.jsx)(B,{onSelectOption:w,options:i,currentOption:g,style:D?"compact":"full",children:(0,C.jsx)(j().A,{style:{fontSize:"14px",paddingLeft:D?"8px":0},children:(0,C.jsx)(p().sA,{id:"asanaImport.importsTab.chooseWorkspace.totalProjectsAndTasks",defaultMessage:"Import {nProjects} projects, {nTasks} tasks to",values:{nProjects:F.projects,nTasks:F.tasks}})})})})]})})}function P(e){let{team:t,collapsed:o,onToggle:n,importCompletedTasks:r,onSelectProject:l,onSelectGroup:c,groupCheckState:d,checked:g}=e;const h=R(),y=(0,p().tz)(),x=(0,a().v3)(),[v,S]=(0,s.useState)(!1);return(0,C.jsx)(k().A,{getIdentifier:e=>e.gid,onSelectRow:l,rows:t.projects,loadMoreButton:(0,u().O9)(t.nextPage)&&(0,C.jsx)(A().p,{style:{padding:0,width:"60%",height:20},hoveredStyle:{background:"transparent"},onClick:async()=>{S(!0),await f().Oh({team:t,environment:x}),S(!1)},children:v?(0,C.jsx)(I().A,{style:{height:14,width:"100%"}}):(0,C.jsxs)(C.Fragment,{children:[(0,i().P)(h.loadMoreArrowStyles),(0,C.jsx)(j().A,{style:h.loadMoreLabel,children:(0,C.jsx)(p().sA,{id:"asanaImport.importsTab.chooseWorkspace.loadMoreProjects",defaultMessage:"Load more projects"})})]})}),title:(0,C.jsx)("div",{style:{lineHeight:"20px",fontSize:"14px"},children:t.name}),renderRow:e=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b().m,{color:e.color,size:14,style:{borderRadius:"15%"}}),(0,C.jsxs)(j().A,{style:{...e.completed?h.projectNameCompleted:{},maxWidth:220},children:[e.name,e.completed&&y.formatMessage(M.completedProjectLabel)]}),(0,C.jsxs)(j().A,{isSmall:!0,style:{color:m().XA.light.gray[400]},children:[r?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,C.jsx)(p().sA,{id:"asanaImport.importsTab.chooseWorkspace.tasksHelperText",defaultMessage:" tasks"})]})]}),onToggleGroup:n,onSelectGroup:c,collapsed:o,groupCheckedState:d,rowCheckedState:g})}function B(e){let{onSelectOption:t,options:o,currentOption:s,children:a,style:n}=e;const r=(0,p().tz)(),i=R();return(0,C.jsxs)(w().Ye,{flexDirection:"compact"===n?"row":"column",alignItems:"center",justifyContent:"center",style:i.teamSpaceContainer,children:[(0,l().Z)(i.arrowIconStyles),a,(0,C.jsx)(T().A,{onSelectOption:t,options:o,iconOnly:"compact"===n,currentOption:s,placeHolder:r.formatMessage(M.chooseTeamspaceOption),searchThreshold:5,buttonStyles:{maxWidth:300},iconStyles:i.menuChevonDownIcon,menuProps:{maxWidth:300,maxHeight:400,left:50},inputProps:{placeholder:r.formatMessage(M.filterTeams)}})]})}function R(){return(0,r().IS)((e=>({loadingRow:{gap:6,alignItems:"center",marginTop:4,height:19.6},workspaceSelectorButton:{paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,opacity:1,width:376,border:`1px solid ${m().XA.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8},projectNameCompleted:{color:e.text.tertiary},menuChevonDownIcon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor},plusIcon:{color:e.mediumIconColor,width:16,height:16},lockedIcon:{color:e.mediumIconColor,width:12.5,height:12.5},asanaTeamSectionContainer:{marginBottom:20},teamAndProjectsCollapse:{paddingTop:8,paddingBottom:8},teamSpaceContainer:{height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:"8px 2px",gap:8,position:"relative"},arrowIconStyles:{position:"absolute",top:"50%",left:0,transform:"translate(-64%, -50%)",width:12,height:28,color:e.selectLightGray[700],backgroundColor:e.modalBackground},loadMoreLabel:{color:e.selectLightGray[700]},loadMoreArrowStyles:{width:12,color:e.selectLightGray[700],marginRight:8,marginLeft:1},teamSpaceLabel:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:m().XA.light.gray[75]}})),[])}function D(){const e=R();return(0,C.jsxs)(S().xA,{gap:8,children:[(0,C.jsxs)(S().LX,{row:1,col:1,children:[(0,C.jsxs)(w().Ye,{style:{paddingLeft:6,paddingRight:8,...e.loadingRow},children:[(0,C.jsx)(I().A,{style:{height:14,width:34}}),(0,C.jsx)(I().A,{style:{height:14,width:200}})]}),(0,C.jsx)(I().A,{style:{marginLeft:40,marginTop:10,height:14,width:180}}),(0,C.jsx)(I().A,{style:{marginLeft:40,marginTop:12,height:14,width:240}})]}),(0,C.jsx)(S().LX,{row:1,col:2,children:(0,C.jsxs)(w().Ye,{flexDirection:"column",alignItems:"center",children:[(0,C.jsx)(I().A,{style:{marginLeft:40,marginTop:12,height:14,width:200}}),(0,C.jsx)(I().A,{style:{marginLeft:40,marginTop:12,height:14,width:140}})]})})]})}const L=function(){const e=(0,a().v3)(),t=(0,p().tz)(),r=R(),i=(0,n().K8)((()=>y().A.getState()),[]),{isLoadingProjects:l,selectedWorkspace:c,teamsAndProjects:d,workspaces:m}=i;return(0,s.useEffect)((()=>{c&&f().D5({selectedWorkspace:c,environment:e}).catch((()=>{}))}),[c,e]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(w().Ye,{alignItems:"center",gap:8,children:[(0,C.jsx)("img",{src:o(83544).A.images.import.asanaPng,width:16,height:16}),(0,C.jsx)(T().A,{searchThreshold:5,onSelectOption:e=>{y().A.setState({...i,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:m.map((e=>({key:e.gid,name:e.name,searchTerm:e.name.split(" ")}))),currentOption:c,placeHolder:t.formatMessage(M.selectWorkspace),inputProps:{placeholder:t.formatMessage(M.filterWorkspaces)},buttonStyles:r.workspaceSelectorButton,iconStyles:r.menuChevonDownIcon})]}),c&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(j().A,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",marginTop:"12px",lineHeight:"22px"},children:(0,C.jsx)(p().sA,{...M.selectProjectHeading})}),(0,C.jsx)(j().A,{style:{font:"SF Pro",fontWeight:g().Wy.regular,fontSize:g().J.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingTop:4,paddingBottom:20},children:(0,C.jsx)(p().sA,{...M.mapTeamspacesDescription})})]}),l?(0,C.jsx)(D,{}):d.filter((e=>0!==e.projects.length)).map((e=>(0,C.jsx)(F,{asanaTeam:e},`${e.gid}-table`)))]})}},874413:(e,t,o)=>{o.d(t,{m:()=>i});o(242343);var s=()=>o(174114),a=()=>o(653998),n=o(163643);const r=8;function i(e){let{color:t,size:o,style:i}=e;const l=(0,a().tz)(),c=(0,s().IS)((e=>({dot:{height:o||r,width:o||r,background:t||e.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...i}})),[o,t,i]);return(0,n.jsx)("div",{role:"img","aria-label":l.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:c.dot})}},905053:(e,t,o)=>{o.d(t,{HC:()=>c,Pz:()=>p,_s:()=>i,ml:()=>m,rA:()=>d,x_:()=>l});var s=()=>o(505381),a=()=>o(963768),n=()=>o(818369),r=()=>o(129243);async function i(e,t){const o=await n().callApi({eventName:"getConnectedAppsStatus",environment:e,data:{spaceId:t}});if("failed"===o.type){const e=o.error;return console.error(e),{drive:[],evernote:void 0,trello:void 0,asana:void 0,confluence:void 0}}return o.data}async function l(e,t){await n().callApi({eventName:"disconnectTrello",environment:e,data:{}}),await t.refresh(),s().kO(e,{integration_name:"trello"})}async function c(e,t){await n().callApi({eventName:"disconnectAsana",environment:e,data:{}}),await t.refresh(),s().kO(e,{integration_name:"asana"})}async function d(e,t){await n().callApi({eventName:"disconnectEvernote",environment:e,data:{}}),await t.refresh(),s().kO(e,{integration_name:"evernote"})}async function p(e,t,o){await n().callApi({eventName:"disconnectConfluence",environment:e,data:{spaceId:o}}),await t.refresh(),s().kO(e,{integration_name:"confluence"})}async function m(e){const{environment:t,requestStore:o,botId:n}=e;await r().KA({environment:t,botId:n,onSuccess:()=>{!async function(e){const{environment:t,requestStore:o}=e;await o.refresh();const n=a().Ay.getInitialState();a().Ay.setState(n),s().kO(t,{integration_name:"jira"})}({environment:t,requestStore:o})}})}},940051:(e,t,o)=>{o.d(t,{A:()=>d});var s=o(242343),a=()=>o(174114),n=()=>o(653998),r=()=>o(35462),i=()=>o(610271),l=(o(403517),o(163643));const c=function(e){const{dotCount:t=6,speed:n=800}=e,[r,c]=(0,s.useState)(1),d=(0,a().IS)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,s.useEffect)((()=>{const e=setInterval((()=>c((e=>e<t?e+1:1))),n);return()=>clearInterval(e)}),[t,n]),(0,l.jsx)(i().Ye,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,l.jsx)("div",{children:(0,o(591790).v)(r===e?d.iconStyleBold:d.iconStyle)},e)))})};const d=function(e){const t=(0,o(803290).K8)((()=>o(773866).A.state.templateCreationInProgress),[]),s=(0,a().IS)((e=>({lightText:{color:e.text.tertiary}})),[]);return(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,l.jsxs)(i().Ye,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,l.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,l.jsx)(c,{}),(0,l.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:o(83544).A.images.notionLogoPng})]}),t?(0,l.jsx)(r().A,{style:s.lightText,children:(0,l.jsx)(n().sA,{id:"import.importingData.settingUpWorkspace",defaultMessage:"Creating templates for your projects and tasks."})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i().Ye,{children:(0,l.jsx)(r().A,{style:s.lightText,children:(0,l.jsx)(n().sA,{id:"import.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,l.jsx)(i().Ye,{children:(0,l.jsx)(r().A,{style:s.lightText,children:(0,l.jsx)(n().sA,{id:"import.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})]})}},994395:(e,t,o)=>{o.d(t,{Sq:()=>L,pX:()=>O,g3:()=>z,nM:()=>N,P0:()=>R,Jq:()=>W,Wh:()=>K,nP:()=>Y,$A:()=>J,TJ:()=>Z,i_:()=>V,oz:()=>G,$b:()=>B,qf:()=>D,dJ:()=>q,p7:()=>Q,No:()=>_,Mi:()=>U});o(610931),o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(500234),o(324989),o(771702),o(403517);var s=()=>o(712437),a=()=>o(65866),n=()=>o(220959),r=()=>o(502140),i=()=>o(524118),l=()=>o(145017),c=()=>o(66460),d=()=>o(528762),p=()=>o(704082),m=()=>o(851552);const u=(0,m().Dv)("mondayFullImport"),g=(0,m().Dv)("parallelMondayImport");var f=()=>o(145046),h=()=>o(865226),y=()=>o(283759),x=()=>o(927685),v=()=>o(452981),A=()=>o(477784),S=()=>o(405431),I=()=>o(485966),j=()=>o(242333),w=()=>o(239092),b=()=>o(330358),k=()=>o(505381),T=()=>o(818369),C=()=>o(839618),M=()=>o(581444),F=()=>o(70989),P=()=>o(84543);const B=(0,o(653998).YK)({projectsAndTasksCountTooltip:{id:"mondayImport.importsTab.selectData.tooltipForProjectsAndTasksCount",defaultMessage:"Counts each item in the project board and each task board as a separate project"},boardsKeyWord:{id:"mondayImport.importsTab.selectData.boardsKeyWord",defaultMessage:" boards"},projectsKeyWord:{id:"mondayImport.importsTab.selectData.projectsKeyWord",defaultMessage:" projects"},projectsAndTasksExcludedToolTip:{id:"mondayImport.importsTab.selectData.tooltipForDisabledProjectsAndTasks",defaultMessage:"Project and task boards are excluded."},noBoardsTooltipMessage:{id:"mondayImport.importsTab.selectData.tooltipForDisabledFolderV2",defaultMessage:"This folder has no boards."},successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."},fullImport:{defaultMessage:"Full Import",id:"mondayImport.importsTab.chooseWorkspace.chooseImportType.fullImport"},fullImportDescription:{defaultMessage:"Import all Monday board types as Notion databases. Recommended for a full migration.",id:"mondayImport.importsTab.chooseWorkspace.chooseImportType.fullImport.description"},projectsAndTasks:{defaultMessage:"Projects & Tasks only",id:"mondayImport.importsTab.chooseWorkspace.chooseImportType.projectsAndTasks"},projectsAndTasksDescription:{defaultMessage:"Import project and task boards from Monday into Notion Projects. Recommended for Project management only.",id:"mondayImport.importsTab.chooseWorkspace.chooseImportType.projectsAndTasks.description"},newTeamspaceLabel:{id:"mondayImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"},privateSpaceLabel:{id:"mondayImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"},selectBoardsHeading:{id:"mondayImport.importsTab.chooseWorkspace.selectBoards",defaultMessage:"Choose boards to import"},selectWorkspaceV2:{id:"mondayImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"},chooseImportType:{id:"mondayImport.importsTab.chooseWorkspace.chooseImportType",defaultMessage:"Choose Import Type"},mapTeamspacesDescription:{id:"mondayImport.importsTab.chooseWorkspace.tabDescription",defaultMessage:"You can give each Monday folder a Notion teamspace to collaborate in."},searchWorkspaces:{id:"mondayImport.importsTab.chooseWorkspace.searchWorkspaces",defaultMessage:"Search workspaces..."},chooseWorkSpace:{id:"mondayImport.importsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Monday workspace"},chooseTeamspace:{id:"mondayImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"},excludeProjectsAndTasks:{id:"mondayImport.importsTab.selectData.excludeProjectsAndTasks",defaultMessage:"Exclude projects & tasks boards"},selectWorkSpaceV1:{id:"MondayImport.importsTab.selectData.tabTitle",defaultMessage:"Select Monday.com workspace"},backButton:{id:"mondayImport.selectData.backButtonText",defaultMessage:"Back"},creatingTemplate:{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"},nextButton:{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"}});function R(){return{ProjectsAndTasks:{title:B.projectsAndTasks,description:B.projectsAndTasksDescription},FullImport:{title:B.fullImport,description:B.fullImportDescription}}}function D(){w().A.setState({...w().A.state,isModalOpen:!0})}async function L(e){const{environment:t,userEmail:o,APIToken:s,flowId:a,spaceId:n}=e;if(!t.currentUser.id||!o||!s)return f().rG({message:"Invalid details"}),void F().V();const r=await T().callApi({eventName:"authenticateMondayUser",environment:t,data:{userId:t.currentUser.id,spaceId:n,userEmail:o,APIToken:s}});"failed"===r.type?(k()._$(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:r.error},flowId:a}),console.error(r.error),f().Qg(r)):(k()._$(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:a}),w().A.setState({...w().A.state,account:o}),f().rG({message:A().A.formatMessage(B.successfullyConnected)})),F().V()}async function O(e){const{environment:t,spaceId:o}=e,s=await T().callApi({eventName:"disconnectMonday",environment:t,data:{spaceId:o}});"failed"===s.type?f().Qg(s):(k().kO(t,{integration_name:"monday.com"}),"success"===s.type&&w().A.setState({...w().A.state,account:void 0,workspaces:[]}))}async function W(e){const{environment:t,spaceId:o}=e;w().A.setState({...w().A.state,isLoadingMondayWorkspaces:!0});const s=await T().callApi({eventName:"getMondayWorkspaces",environment:t,data:{spaceId:o}});"success"===s.type&&w().A.setState({...w().A.state,workspaces:s.data.workspaces,isLoadingMondayWorkspaces:!1})}async function z(e){const{environment:t,spaceId:o,selectedWorkspace:s}=e;if(!o)return;w().A.setState({...w().A.state,isLoadingProjects:!0});const a=await T().callApi({eventName:"getMondayFoldersAndBoards",environment:t,data:{spaceId:o,selectedWorkspace:s}});"success"===a.type&&w().A.setState({...w().A.state,mondayFoldersAndBoards:a.data.mondayFoldersAndBoards,isLoadingProjects:!1})}function _(e){var t,o;let{folderId:s,spaceId:a}=e;const n=w().A.state.selectedProjectsAndTeamspaces;w().A.setState({...w().A.state,selectedProjectsAndTeamspaces:{...n,[s]:{projects:(null===(t=n[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:a,isEntireFolderSelected:null===(o=n[s])||void 0===o?void 0:o.isEntireFolderSelected}}})}async function V(e){const{environment:t,spaceStore:o,currentSpaceViewStore:s,teamsStores:n,flowId:i}=e,{appTemplatesSetupActions:l,appConfigs:d}=await v().Aw.load(),p=w().A.state.selectedWorkspace;if(!p)return;w().A.setState({...w().A.state,templateCreationInProgress:!0});const m={},u={},f=[],h=new Set;try{for(const e in w().A.state.selectedProjectsAndTeamspaces){const r=w().A.state.selectedProjectsAndTeamspaces[e].projects;if(0===r.length)continue;let i;f.push(...r.map((e=>e.mondayProjectId)));const c=w().A.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:p}=c;if(!p)continue;h.add(p);const g=n.find((e=>e.id===c.notionTeamspaceId));if(i=g||o,!m[p]){const{serverCommitResult:e,performResult:o}=P().createAndCommit({environment:t,perform:e=>{var o;const n=a().tP,r=null===(o=(0,y().BL)(d(),n))||void 0===o?void 0:o.uri;if(!r)return;const c=d().find((e=>e.uri===r));if(null==c?void 0:c.presets.find((e=>e.uri===n))){return l.initializeApp({environment:t,spaceViewStore:s,appParentStore:i,appUri:r,presetUri:n,transaction:e,from:"monday_import"})}return[]},canUndo:!0,userAction:"importActions.importMonday"});m[p]=o,await e}u.hasOwnProperty(p)?u[p]=[...u[p],{mondayFolderId:e,projects:r}]:u[p]=[{mondayFolderId:e,projects:r}]}}catch(B){return void w().A.setState({...w().A.state,templateCreationInProgress:!1,currentTab:"failure"})}const x=[],A=I().default.state.currentSpaceViewStore;if(!A)return;const b=M().mD({environment:t,spaceStore:o,spaceViewStore:A,append:!0,mondayV2:(0,S().G)()});await b.deferred.promise;const T=b.pageId;w().A.setState({...w().A.state,loggerPageId:T});for(const[a,r]of Object.entries(u)){const e=m[a];e&&x.push({collectionViewBlocks:e.map((e=>({id:e.id,spaceId:(0,c().e)(o.id)}))),notionTeamSpaceId:a,mondayProjectsAndFolders:r})}k().Pd(t,{integration_name:"monday.com"});const F=(0,C().UT)(t,g,{importParams:x,loggerPageId:T,spaceId:o.id,flowId:i});w().A.setState({...w().A.state,templateCreationInProgress:!1,currentTab:"importingData"}),j().A.reset(),p&&function(e,t,o){try{k().mM(e,{import_source:"monday.com",data:t,flowId:o})}catch(s){r().log({level:"error",from:"mondayActions",type:"parallelMondayImport",error:{miscDataString:JSON.stringify({error:s,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceId:p,projects:f,numberOfTeamspacesUsed:h.size,userId:t.currentUser.id,spaceId:(0,c().e)(o.id)},i);for await(const a of F){if(!w().A.state.isModalOpen)break;if(a.error)return void w().A.setState({...w().A.state,currentTab:"failure"});"success"===a.taskStatus&&w().A.setState({...w().A.state,currentTab:"confirm",result:a.value.status,isComplete:!0})}}async function N(e){const{environment:t,spaceId:o,selectedWorkspace:s}=e;w().A.setState({...w().A.state,isLoadingHierarchy:!0,isLoadingBoards:!0});try{const e=await T().callApi({eventName:"getMondayFoldersWithHierarchy",environment:t,data:{spaceId:o,selectedWorkspace:s},headers:{}});if("success"===e.type){const a=e.data.mondayFoldersDetailsMap;let n,r={},i=1,l=!0,c=w().A.getState();for(;l&&c.selectedWorkspace===s&&"FullImport"===c.selectedImportType&&!c.templateCreationInProgress;){const e=await T().callApi({eventName:"getMondayBoards",environment:t,data:{spaceId:o,selectedWorkspace:s,page:i},headers:{}});if("success"!==e.type){E();break}n=e.data.mondayBoardsDetailsMap,r={...r,...n},l=e.data.hasMoreBoards;for(const[t,o]of Object.entries(n))a[o.folderId].boards.push(t);w().A.setState({...w().A.state,isLoadingHierarchy:!1,fetchedHierarchy:!0,mondayBoardsDetailsMap:r,mondayFoldersDetailsMap:a}),i++,c=w().A.getState()}w().A.setState({...w().A.state,isLoadingBoards:!1})}else E()}catch(a){E()}}function E(){w().A.setState({...w().A.state,isLoadingHierarchy:!1,isLoadingBoards:!1,fetchedHierarchy:!1})}function U(e){let{folderId:t,notionTeamspaceId:o,notionRootTableName:s}=e;w().A.setState({...w().A.state,selectedTeamspacesForFullImport:{...w().A.state.selectedTeamspacesForFullImport,[t]:{notionTeamspaceId:o,notionRootTableName:s}}})}function H(e){const{mondayFolderDetails:t,currentfolderId:o}=e,s=[],a=[o];for(;a.length>0;){const e=a.pop();if(!e)continue;const o=t[e];if(o&&o.subFolders)for(const t of o.subFolders)s.push(t),a.push(t)}return s}function q(e){const{excludeProjectsAndTasks:t,board:o}=e;return t&&("task"===o.boardType||"project"===o.boardType)}function $(e){const{mondayFolderDetails:t,folderIds:o,excludeProjectsAndTasks:s,mondayBoardDetails:a}=e,n=[];for(;o.length>0;){const e=o.pop();if(!e)continue;const r=t[e];if(r&&r.boards)for(const t of r.boards)q({excludeProjectsAndTasks:s,board:a[t]})||n.push(t)}return n}function Y(e,t,o,s){return $({folderIds:[e,...H({currentfolderId:e,mondayFolderDetails:t})],mondayFolderDetails:t,mondayBoardDetails:o,excludeProjectsAndTasks:s}).length}function K(e,t,o,s,a){const n=$({folderIds:[e,...H({currentfolderId:e,mondayFolderDetails:o})],mondayFolderDetails:o,mondayBoardDetails:s,excludeProjectsAndTasks:a});let r=0;return n.forEach((e=>{t.has(e)&&(r+=1)})),r}async function G(e){const{environment:t,spaceStore:o,flowId:a,spaceViewStore:r}=e,c=w().A.state;if(!c.selectedWorkspace||!c.mondayFoldersDetailsMap)return;w().A.setState({...w().A.state,templateCreationInProgress:!0});const{selectedFolderIdsForFullImport:m,selectedBoardIdsForFullImport:g,mondayFoldersDetailsMap:y,mondayBoardsDetailsMap:v,excludeProjectsAndTasks:S}=c,I=Object.entries(c.mondayFoldersDetailsMap).flatMap((e=>{let[t,o]=e;return o.parent?[]:[t]})),T=new Map,F={notionTeamspaceId:o.getSpaceId(),notionRootTableName:d().NX},P=(e,t,o)=>{o.forEach((t=>{const o=m.has(t),s=y[t];if(o){const o={id:t,name:s.folderName,boards:[],folders:[]};P(o,s.boards,s.subFolders),e.folders.push(o)}else P(e,s.boards,s.subFolders)})),t.forEach((t=>{if(!g.has(t))return;const o=v[t];e.boards.push({id:t,name:o.name})}))};try{for(;I.length;){const e=I.pop();if(!e)break;const t=y[e];if(m.has(e)&&"null"!==e){const t=y[e],o={id:e,name:t.folderName,boards:[],folders:[]};P(o,t.boards,t.subFolders);const s=X(e,F),a=T.get(s)??{boards:new Array,folders:new Array};a.folders.push(o),T.set(s,a)}else{for(const e of t.boards){if(!g.has(e))continue;const o=v[e],s=X(t.folderId,F),a=T.get(s)??{boards:new Array,folders:new Array},n={id:e,name:o.name};a.boards.push(n),T.set(s,a)}I.push(...t.subFolders)}}}catch(L){return void w().A.setState({...w().A.state,templateCreationInProgress:!1,currentTab:"failure"})}const B=Array.from(T.entries(),(e=>{let[t,o]=e;return{notionRootTableId:t.notionTeamspaceId,notionRootTableName:t.notionRootTableName,mondayBoards:o.boards,mondayFolders:o.folders}})),R=M().mD({environment:t,spaceStore:o,spaceViewStore:r,append:!0,mondayV2:!0});await R.deferred.promise;const D=R.pageId;w().A.setState({...w().A.state,loggerPageId:D}),k().Pd(t,{integration_name:"monday.com"});try{const e=(0,C().UT)(t,u,{importParams:B,loggerPageId:D,spaceId:o.id,flowId:a,excludeProjectsAndTasks:S});w().A.setState({...w().A.state,templateCreationInProgress:!1,currentTab:"importingData"}),j().A.reset();for await(const t of e){if(!w().A.state.isModalOpen)break;if(t.error)throw w().A.setState({...w().A.state,currentTab:"failure",loggerPageId:D}),t.error}}catch(O){const e=O instanceof i().X5e?O.body.clientData:void 0;if(e&&"code"in e&&"mondayImportError"===e.code){const e=A().A.formatMessage(M().DZ.importFailedWithError,{error:(0,p().A)(O).message});f().f1(e)}throw new Error((0,p().A)(O).message)}h().oo({url:(0,n().A)({pageId:D,pageModel:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:{table:l().ev,id:D},userId:t.currentUser.id}),baseUrl:x().A.domainBaseUrl,pageVisitSource:s().y8.Import}),environment:t}),w().A.resetImport(),b().A.reset()}function X(e,t){const{selectedTeamspacesForFullImport:o,mondayFoldersDetailsMap:s}=w().A.state;let a=e;for(;a;){var n;if(a in o)return o[a];a=null===(n=s[a])||void 0===n?void 0:n.parent}return t}function J(e){const t=new Set(w().A.state.selectedBoardIdsForFullImport);t.has(e)?t.delete(e):t.add(e),w().A.setState({...w().A.state,selectedBoardIdsForFullImport:t})}function Z(e,t,o,s){const a=w().A.state.selectedFolderIdsForFullImport.has(e);!function(e){const{mondayFolderDetails:t,currentfolderId:o,select:s,mondayBoardDetails:a,excludeProjectsAndTasks:n}=e,r=H({currentfolderId:o,mondayFolderDetails:t}),i=$({folderIds:[o,...r],mondayFolderDetails:t,mondayBoardDetails:a,excludeProjectsAndTasks:n}),{selectedFolderIdsForFullImport:l,selectedBoardIdsForFullImport:c}=w().A.state,d=(e,t)=>{t.forEach((t=>{s?e.add(t):e.delete(t)}))};d(l,r),d(c,i),w().A.setState({...w().A.state,selectedBoardIdsForFullImport:c,selectedFolderIdsForFullImport:l})}({currentfolderId:e,mondayFolderDetails:t,mondayBoardDetails:o,select:!a,excludeProjectsAndTasks:s});const n=new Set(w().A.state.selectedFolderIdsForFullImport);a?n.delete(e):n.add(e),w().A.setState({...w().A.state,selectedFolderIdsForFullImport:n})}function Q(e){const{currentfolderId:t,mondayFolderDetails:o,mondayBoardDetails:s,excludeProjectsAndTasks:a}=e,n=$({folderIds:[t,...H({currentfolderId:t,mondayFolderDetails:o})],mondayFolderDetails:o,mondayBoardDetails:s,excludeProjectsAndTasks:a});let r=!1;return n.forEach((e=>{q({excludeProjectsAndTasks:a,board:s[e]})||(r=!0)})),r}}}]);