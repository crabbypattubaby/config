"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[4876,5834,63137,90871,99171],{41429:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>C,transformBlocks:()=>h,transformIntoColumnList:()=>T});n(403517);var o=()=>n(752597),r=()=>n(762847),i=()=>n(145017),a=()=>n(975392),c=()=>n(551102),s=()=>n(795394),l=()=>n(900635),d=()=>n(759625),m=()=>n(164186),p=()=>n(360378),u=()=>n(384221),v=()=>n(84543),f=()=>n(868068),S=()=>n(189170),k=()=>n(754697),b=()=>n(360482),g=()=>n(836331),I=()=>n(413871),y=()=>n(837694);function h(e){const{environment:t,blocks:n,blockType:y,transaction:h}=e;if(y!==r().xd.transclusionContainer)if(y===r().xd.callout&&g().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const c=a.getRecordStoreUIParent();if(!c||!(0,b().iU)(c))return;const m=c.getRecordStoreUIParent();if(!(m&&m instanceof I().Bv))return;const v=(0,k().Z1)({environment:t,table:i().ev,spaceId:m.getSpaceId()}),f=d().Wv({environment:t,id:v,type:r().xd.callout,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:m.getSpaceId(),format:{callout_version:2}});s().NI({parentStore:c,childStore:f,after:a.id,transaction:o});w({newParentStore:f.getContentStore(),blocks:n,transaction:o}),l().s4({store:f,transaction:o}),u().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:h});else if(y!==r().xd.columnList)if(y!==r().xd.slide)if((0,r().ZK)(y)){const e=parseInt(y.replace("column","").replace("block","")),r=a().oE(a().Hn(e-1,(()=>S().insertTextBelow({environment:t,blocks:n,transaction:h})))),i=[...n,...r],c=T({environment:t,blocks:i,transaction:h});o().default.afterNextFlush((()=>{u().setSelectionAtStart({store:c[0].getBlockTitleStore()})}))}else for(const r of n)if(r.isCalloutV2()){const e=r.getParentBlockStore();if(e){const i=r.getContentStores();v().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:i.map((e=>e.id)),after:r.id}},transaction:h}),s().zz({parentStore:e.getContentStore(),childStore:r,transaction:h});for(const e of i)f().pd({environment:t,block:e,blockType:y,transaction:h,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{m().dL(t,i.map((e=>e.id)))}))}}else f().pd({environment:t,block:r,blockType:y,transaction:h,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const c=a.getRecordStoreUIParent();if(!c||!(0,b().iU)(c))return;const l=c.getRecordStoreUIParent();if(!(l&&l instanceof I().Bv))return;const m=(0,k().Z1)({environment:t,table:i().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.slide,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});s().NI({parentStore:c,childStore:v,after:a.id,transaction:o});w({newParentStore:v.getContentStore(),blocks:n,transaction:o}),u().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:h});else T({environment:t,blocks:n,transaction:h});else!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const s=a.getRecordStoreUIParent();if(!s||!(0,b().iU)(s))return;const l=s.getRecordStoreUIParent();if(!l||!(0,b()._p)(l))return;if(!l.isDefined())return;const m=(0,k().Z1)({environment:t,table:i().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:m,type:r().xd.transclusionContainer,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});c().WH({parentStore:s,insertStore:v,afterStore:a,transaction:o});w({newParentStore:v.getContentStore(),blocks:n,transaction:o}),u().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:h})}function C(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&h({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}function T(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return[];const s=a.recordStoreUIParentStore;if(null==s||!s.valueIs(y()._))return[];const l=(0,k().Z1)({environment:t,table:i().ev,spaceId:a.getSpaceId()}),m=d().Wv({environment:t,id:l,type:r().xd.columnList,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:a.getSpaceId()}),{childStore:p}=c().nc({parentStore:s,insertStore:m,beforeStore:a,transaction:o});return n.map((e=>{const n=(0,k().Z1)({environment:t,table:i().ev,spaceId:a.getSpaceId()}),l=d().Wv({environment:t,id:n,type:r().xd.column,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:a.getSpaceId()}),{childStore:m}=c().TF({parentStore:s,childToRemoveStore:e,transaction:o}),{childStore:u}=c().WH({parentStore:p.getContentStore(),insertStore:l,transaction:o}),{childStore:v}=c().WH({parentStore:u.getContentStore(),insertStore:m,transaction:o});return v}))}function w(e){const{newParentStore:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(y()._)&&(c().TF({parentStore:e,childToRemoveStore:r,transaction:o}),c().BC({parentStore:t,appendStore:r,transaction:o}))}}},44250:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function r(e){if(!e||!("askUserToPick"in e))return e}function i(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>r,K$:()=>o,j6:()=>i})},189170:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>x,duplicateBlocksWithMaybeConfirmation:()=>B,insertBlockAbove:()=>_,insertBlockAndEdit:()=>P,insertBlockBelow:()=>R,insertTextAbove:()=>F,insertTextBelow:()=>U});n(358848),n(362833),n(91270);var o=()=>n(752597),r=()=>n(214144),i=()=>n(66460),a=()=>n(975392),c=()=>n(303298),s=()=>n(577701),l=()=>n(983048),d=()=>n(415029),m=()=>n(145046),p=()=>n(111066),u=()=>n(164186),v=()=>n(84543),f=()=>n(732491),S=()=>n(190717),k=()=>n(486963),b=()=>n(590057),g=()=>n(981810),I=()=>n(459742),y=()=>n(816763),h=()=>n(112892),C=()=>n(615661),T=()=>n(182613),w=()=>n(937968);async function B(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:r,callback:i}=e;if(!(0,w().EF)(t))return;const a=await c().VI.duplicateActions.load();let s=n;if(1===n.length){const e=await S().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==i||i());s=e}const d=s.at(0);if(!d)return;const m=(0,k().U)(d);if(m&&(0,g().ls)(d,m))await l().un({blocks:s,environment:t,analyticsFrom:"subitem_duplication",callback:i,collectionContextStore:m});else{const{serverCommitResult:e}=v().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{x({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:r,duplicateActions:a})},transactionTooBigFallback:e=>{x({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:r,duplicateActions:a})}});e.then(i)}o().default.afterNextFlush((()=>{p().BM({environment:t})}))}function x(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:r,lastTopLevelBlockStore:c,preventSetSelection:l,duplicateOnlyCollectionSchema:d,duplicateActions:p}=e,v=a().$z(n,(e=>e.getFormat().app_id??e.id)),f=[];return a().jJ(v,(e=>{const n=e[0],a=!n.isTransclusionType(),{blockStores:c,onComplete:l}=p.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:(0,i().e)(n.pointer.spaceId),preferDuplicateLocation:r,options:{addCopyName:(0,y().A)(n),deepCopyTransclusionContainers:a,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),duplicateOnlyCollectionSchema:d}});f.push(...c),l.then((e=>{if("error"===e.status){const n=e.error;s().Rk(n)?s().UK(t,{product:n.clientData.metadata.product}):m().f1(e.errorMessage)}}))})),u().LE({blocksToInsert:f,target:c?[c]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:l}),f}function R(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:i,preventSetSelection:a}=e,c=T().default.getCurrentRecordCache(),s=new(f().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let l;if((0,w().EF)(t)&&n&&c){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:c,from:i,selection:o});s.track(e.pointer,r),l=u().LE({environment:t,blocksToInsert:[e],target:o,transaction:r,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else s.fail("invalid_state");return l}function _(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:i,preventSetSelection:a}=e,c=T().default.getCurrentRecordCache();let s;if((0,w().EF)(t)&&n&&c){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:c,from:i,selection:o});s=u().t1({environment:t,blocks:[e],selection:o,transaction:r,preventSetSelection:a})[0]}return s}function P(e){const{environment:t,selection:n,transaction:o}=e,i=R({...e,preventSetSelection:!0});if(i){var a;u().x5({environment:t,insertedStores:[i],isCreated:!0});const e=C().Uv.getMode(i);if("suggest"===e){const e=b().RR(t,o,i);b().tM(o,i,{id:r().JW(),type:"insert",discussionId:e.id}),b().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[i.id]})}"suggest"===e&&null!==(a=i.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==a&&a.isCommentOnly()||u().um({transaction:o,blocks:n})}return i}function U(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:i}=e,a=i?void 0:"text_insert_below",c=R({environment:r,selection:t,createBlockItem:I().ry.text,analyticsFrom:a,transaction:n});return c&&o().default.afterNextFlush((()=>{h().zz({environment:r,blockStore:c,insertedTextBlockLocation:"below"})})),c}function F(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:i}=e,a=i?void 0:"text_insert_below",c=_({environment:r,selection:t,createBlockItem:I().ry.text,analyticsFrom:a,transaction:n});return c&&o().default.afterNextFlush((()=>{h().zz({environment:r,blockStore:c,insertedTextBlockLocation:"above"})})),c}},533639:(e,t,n)=>{n.d(t,{p:()=>o});class o extends(()=>n(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},746180:(e,t,n)=>{n.r(t),n.d(t,{createPageInTeamSyncImpl:()=>d});n(610931);var o=()=>n(218357),r=()=>n(197881),i=()=>n(919536),a=()=>n(163875),c=()=>n(431789),s=()=>n(4822),l=()=>n(802789);function d(e){const{environment:t,spaceStore:n,spaceViewStore:d,teamStore:m,from:p,title:u,loading:v,appendOrPrepend:f,transaction:S}=e;if(!(0,s().dp)({teamStore:m,environment:t}))throw new Error("User is not eligible to create top-level page in team");const k=a().IT({environment:t,spaceStore:n,spaceViewStore:d,isPrivate:!1,prepend:!1,title:u,loading:v,transaction:S});r().X(t,{teamStore:m,from:p,pageId:k.id,transaction:S}),i().wy({store:k,transaction:S});const b=(0,c().sZ)({type:"team",id:m.id});if(b.table!==o().yK)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return(0,l().moveToTeamImpl)({environment:t,transaction:S,action:"add",teamStore:b,currentSpaceViewStore:d,targets:[k],value:{type:"team",id:m.id},location:{type:f}}),k}},802789:(e,t,n)=>{n.r(t),n.d(t,{moveToTeamImpl:()=>s});var o=()=>n(975392),r=()=>n(76394),i=()=>n(795394),a=()=>n(578553),c=()=>n(41429);function s(e){let{transaction:t,currentSpaceViewStore:n,teamStore:s,targets:l,location:d,environment:m}=e;const p=n.getTeamsStores(),u=s.getTeamPagesStore();c().maybeTurnCollectionViewIntoCollectionViewPage({environment:m,blocks:l,transaction:t});for(const c of l){const e=o().I6(p,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(c.id)}));(null==e?void 0:e.id)!==s.id&&("append"===d.type?i().NI({parentStore:u,childStore:c,after:d.after,transaction:t}):"prepend"===d.type?i().Ti({parentStore:u,childStore:c,before:d.before,transaction:t}):(0,r().HB)(d),e&&a().Ex({teamStore:e,store:c,transaction:t}))}return s}},994488:(e,t,n)=>{n.d(t,{o:()=>o});n(362833),n(403517);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return e.map((e=>[e]));const i=[];for(const a of e)i.push(...o(n[0],...n.slice(1)).map((e=>[a,...e])));return i}}}]);