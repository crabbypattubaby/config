"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[19167],{100688:(e,t,o)=>{o.d(t,{A:()=>l});o(242343);var n=()=>o(653998),i=()=>o(220413),r=()=>o(35462),a=o(163643);function l(e){return(0,a.jsx)(r().A,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:i().Ay.red,...e.styles},children:(0,a.jsx)(n().sA,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},113915:(e,t,o)=>{o.d(t,{A:()=>c});o(403517),o(242343);var n=()=>o(174114),i=()=>o(31448),r=()=>o(622163),a=()=>o(126451),l=o(163643);const s={tall:80,short:50};function c(e){const{disabled:t,options:o,selectedOption:c,onOptionSelected:d,height:p}=e,u=(0,n().IS)((e=>({cardContainer:{paddingLeft:8,paddingRight:8,display:"flex",justifyContent:"space-between",alignItems:"center",columnGap:8},cardUnselected:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexBasis:82,minWidth:0,color:e.accentColors.gray[500]},cardSelected:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexBasis:82,minWidth:0,color:e.accentColors.gray[500]},cardButtonBase:{height:s[p],width:"100%",borderRadius:6,borderStyle:"solid",transition:"border-color 0.3s, box-shadow 0.3s",display:"flex",justifyContent:"center",alignItems:"center",color:t?e.icon.tertiary:void 0,background:e.surface.elevated},cardButtonHovered:{background:e.surface.elevated,...(0,r().nl)({width:2,color:e.stroke.uiBlueSecondary})},cardButtonSelected:(0,r().nl)({width:2,color:e.blueColor}),cardButtonUnselected:(0,r().nl)({width:1,color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[100]}),cardLabelBase:{...i().RC,marginTop:6,fontSize:12,lineHeight:"14px",maxWidth:"100%",color:t?e.icon.tertiary:void 0},cardLabelSelected:{fontWeight:i().Wy.semibold,color:e.accentColors.gray[900]},iconBase:{height:24,width:24,color:t?void 0:e.icon.secondary},iconSelected:{color:e.blueColor,fill:e.blueColor},imageBase:{maxHeight:s[p],opacity:t?.5:1},imageSelected:{opacity:1}})),[t,p]),m=o.available.map((e=>{const n=o.appearance[e],i=e===c;return(0,l.jsxs)("div",{style:i?u.cardSelected:u.cardUnselected,children:[(0,l.jsx)(a().A,{style:{...u.cardButtonBase,...i?u.cardButtonSelected:u.cardButtonUnselected},hoveredStyle:u.cardButtonHovered,pressedStyle:u.cardButtonHovered,ignoreLocalHoverState:i,disabled:t,onClick:()=>{d(e)},children:n.icon?n.icon.function({...u.iconBase,height:n.icon.size,width:n.icon.size,...i?u.iconSelected:{}}):(0,l.jsx)("img",{src:n.image.src,style:{width:n.image.width,height:n.image.height,...u.imageBase,...i?u.imageSelected:{}}})}),(0,l.jsx)("div",{style:{...u.cardLabelBase,...i?u.cardLabelSelected:{}},children:n.label})]},e)}));return(0,l.jsx)("div",{style:u.cardContainer,children:m})}},116548:(e,t,o)=>{o.d(t,{u:()=>i});var n=()=>o(401548);function i(e,t){const{r:o,g:i,b:r}=(null==e?void 0:e.info.accent_color)||{r:0,g:0,b:0},a=`rgba(${o},${i},${r},${"dark"===t?.6:1})`;return{background:a,hoveredBackground:(0,n().e$)(a,.4),pressedBackground:(0,n().e$)(a,.9)}}},189919:(e,t,o)=>{o.d(t,{A:()=>d});o(242343);var n=()=>o(237385),i=()=>o(174114),r=()=>o(83544),a=()=>o(653998),l=()=>o(31448),s=()=>o(279150),c=o(163643);function d(e){const t=(0,a().tz)(),o=function(e){const{isMobile:t}=(0,n().Y0)(),o=t?18:14,r=1,a=6,s=20;return(0,i().IS)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:s,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:a,borderBottomRightRadius:6,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${s}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...l().RC},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.text.tertiary,...l().RC},githubPrInfoMain:{padding:"0px 4px",fontFamily:l().Tf.githubMono,background:t.cardPressedBackground,borderRadius:a,color:t.text.primary,verticalAlign:"text-bottom",...l().RC}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(s().A,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(p.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(s().A,{size:2}),t.formatMessage(p.prTitle)]})}),u=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r().A.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(s().A,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(p.open)})]}),(0,c.jsx)(s().A,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(p.mergeInto),(0,c.jsx)(s().A,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(p.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(s().A,{size:12}),u]})}const p=(0,a().YK)({idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},193867:(e,t,o)=>{o.d(t,{A:()=>I});var n=o(242343),i=()=>o(660714),r=()=>o(237385),a=()=>o(803290),l=()=>o(174114),s=()=>o(185968),c=()=>o(162901),d=()=>o(339189),p=()=>o(21164),u=()=>o(653998),m=()=>o(220413),g=()=>o(31448),y=()=>o(696987),f=()=>o(818369),h=()=>o(154956),S=()=>o(145046),x=()=>o(84543),v=()=>o(401382),b=()=>o(966789),C=()=>o(951540),A=()=>o(709237),j=()=>o(279150),w=()=>o(35462),M=()=>o(477784),_=()=>o(802955),T=o(163643);const k=(0,u().YK)({autoIncrementIdPrefixPlaceholder:{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{defaultMessage:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function I(e){const{uniqueIdProperty:t,prefixValue:o,collectionContextStore:m}=e,b=(0,r().v3)(),I=(0,a().K8)((()=>m.collectionStore()),[m]),[R,B]=(0,n.useState)(o??""),[K,D]=(0,n.useState)(!0),[F,V]=(0,n.useState)(),O=!(0,a().O$)(_().e),L=(0,n.useCallback)((()=>{D(!0),V(void 0)}),[D,V]),z=(0,n.useCallback)((e=>{D(!0),V(M().A.formatMessage(k.duplicatePrefixNameError,{prefixName:`"${e}"`}))}),[]),H=(0,n.useCallback)(((e,t,o)=>{const n=o.collectionStore();n&&(D(!1),f().callApi({eventName:"setRecordKey",environment:b,data:{spaceId:n.getSpaceId(),table:n.table,key:e,id:n.id}}).then((n=>{D(!0),200!==n.status?z(e):(0,y().V)({environment:b,collectionContextStore:o,property:t,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>z(e))))}),[b,z]),N=(0,n.useCallback)((async e=>{if(!I)return!1;const t=await f().callApi({eventName:"isRecordKeyAvailable",environment:b,data:{spaceId:I.getSpaceId(),table:I.table,key:e.trim()}});return"success"===t.type&&t.data.isAvailable}),[I,b]),W=(0,i().U)((e=>{N(e).then((t=>{t||z(e),D(!0)})).catch((()=>z(e)))}),500),[q]=(0,c().Yb)((async()=>{if(I)return f().callApi({eventName:"suggestRecordKey",environment:b,data:{spaceId:I.getSpaceId(),table:p().Vl,id:I.id,shouldSetSuccessfullySuggestedRecord:!1}})}),[I,b]);(0,n.useEffect)((()=>{var e;if(!o&&"resolved"===q.status)return"success"===(null===(e=q.value)||void 0===e?void 0:e.type)&&q.value.data?(V(void 0),void B(q.value.data.key)):void 0}),[o,q]),(0,n.useEffect)((()=>()=>{W.cancel()}),[W]);const Y=(0,n.useCallback)((e=>{const t=e.target.value.toUpperCase();B(t),L(),t&&t!==o&&((0,s().n4)(t)||V(M().A.formatMessage(s().DZ.prefixInvalidError)),D(!1),W(t))}),[L,o,W]),E=(0,n.useCallback)((()=>{W.flush()}),[W]),U=(0,n.useCallback)((e=>{const n=null==I?void 0:I.getRecordKeyStore();e!==o&&!F&&n&&I&&null!=t&&t.propertySchema?H(e,null==t?void 0:t.propertyId,m):D(!0)}),[I,o,F,t,H,m]),G=(0,n.useCallback)((()=>{const e=m.collectionStore();e&&x().createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:b,canUndo:!0,perform:t=>{const o=h().IL({environment:b,collectionStore:e,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:t});H(R,o,m)}})}),[m,b,R,H]),$=(0,n.useCallback)((e=>{if(!I)return;const t=[{label:(0,T.jsx)(u().sA,{id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit",defaultMessage:"Update ID Prefix"}),color:"red",onAccept:()=>U(e)}];S().ui({message:(0,T.jsx)("span",{children:(0,T.jsx)(u().sA,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",defaultMessage:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{databaseName:(0,T.jsx)(A().A,{style:{display:"inline",fontWeight:g().Wy.medium},shouldWrap:!0,store:I})}})}),showCancel:!0,keepFocus:!0,items:t})}),[I,U]),X=(0,n.useCallback)((e=>{o?$(e):U(e)}),[o,U,$]),J=(0,n.useCallback)((()=>t?t&&!o?(0,T.jsxs)(T.Fragment,{children:[(0,d().W)({width:14,height:14}),(0,T.jsx)(j().A,{size:4}),(0,T.jsx)(u().sA,{defaultMessage:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})]}):(0,T.jsx)(u().sA,{defaultMessage:"Update ID Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit"}):(0,T.jsxs)(T.Fragment,{children:[(0,d().W)({width:14,height:14}),(0,T.jsx)(j().A,{size:4}),(0,T.jsx)(u().sA,{defaultMessage:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"})]})),[o,t]),Z=(0,l().IS)((e=>({prefixInputOuterStyle:{color:void 0===o?e.text.tertiary:e.text.primary}})),[o]);return(0,T.jsxs)(T.Fragment,{children:[!O&&(0,T.jsx)(v().Ay,{left:(0,T.jsx)(w().A,{style:{marginLeft:4,marginRight:7},children:(0,T.jsx)(u().sA,{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})}),value:R,inputOuterStyle:Z.prefixInputOuterStyle,onChange:Y,onBlur:E,placeholder:k.autoIncrementIdPrefixPlaceholder.defaultMessage,onSubmit:()=>X(R.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),F||!K?(0,T.jsx)(P,{prefixName:R,hasRequestCompleted:K,errorMessage:F}):O?(0,T.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,T.jsx)(u().sA,{defaultMessage:"Prefix is not available offline.",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixOffline"})}):(0,T.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,T.jsx)(u().sA,{defaultMessage:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:R?`${R}-`:""}})}),(0,T.jsx)(C().A,{size:"lg",style:{margin:"8px 16px",width:"90%"},onClick:()=>{t?X(R.trim()):G()},disabled:R===o||Boolean(F)||!K||O,children:J()})]})}function P(e){const{errorMessage:t,hasRequestCompleted:o}=e;return(0,T.jsx)(w().A,{isMultiline:!0,style:{paddingTop:12,marginLeft:16,marginRight:16,...o?{color:m().Ay.red}:{},...e.styles},isSecondaryColor:!o,children:o&&t?t:(0,T.jsx)("div",{style:{paddingTop:3,paddingBottom:3},children:(0,T.jsx)(b().A,{legacySize:14})})})}},214e3:(e,t,o)=>{o.d(t,{EB:()=>P,Ay:()=>I,DZ:()=>B});var n=o(242343),i=()=>o(237385),r=()=>o(803290),a=()=>o(174114),l=()=>o(284594),s=()=>o(446588),c=()=>o(653998),d=()=>o(975392),p=()=>o(696987),u=()=>o(273520),m=()=>o(511952),g=()=>o(401382),y=()=>o(951540),f=()=>o(709237),h=()=>o(88271),S=()=>o(725599),x=()=>o(103151),v=()=>o(35462),b=()=>o(502852),C=()=>o(755786),A=()=>o(260682),j=()=>o(907721),w=()=>o(962373),M=()=>o(738894),_=o(163643);function T(e){const{temporaryAutoRelateState:t,handleAutoRelateToggle:o,collectionStore:n,targetCollectionStore:s,autoRelate:d}=e,p=(0,i().Y0)(),u=(0,r().K8)((()=>(null==n?void 0:n.getFormat().bot_id)||s.getFormat().bot_id),[n,s]),m=(0,r().K8)((()=>!!u),[u]),g=(0,a().IS)((e=>({helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6}})),[]),y=(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[(0,_.jsx)(c().sA,{defaultMessage:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),!p.isMobile&&(0,_.jsx)(x().A,{render:e=>(0,_.jsx)("div",{...e,children:(0,l().$)(g.helpIcon)}),style:{width:200},placement:j().W.Bottom,textWrap:!0,renderTooltip:()=>(0,_.jsx)(c().sA,{defaultMessage:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})})]});return m?(0,_.jsx)(S().A,{title:y,on:t?t.enabled:!!d&&(null==d?void 0:d.enabled),focused:!1,onClick:()=>o(u),textWrapperStyle:{opacity:1}}):null}var k=()=>o(44405);function I(e){const{collectionContextStore:t,property:o,targetCollectionStore:d,temporaryInverseState:g,setTemporaryInverseState:h,mode:I="edit",onSubmit:K,shouldEnforceTwoWayRelation:D}=e,F=(0,i().v3)(),V=(0,i().Y0)(),O=(0,c().tz)(),L=(0,r().uB)(void 0,w().A),z=(0,r().K8)((()=>o?C().Jq(t,o):void 0),[t,o]),H=(0,A().D)(z),N=(0,r().K8)((()=>t.collectionStore()),[t]),W=(0,r().K8)((()=>t.contextType),[t]),q=Boolean((null==N?void 0:N.id)===d.id),Y=(0,r().K8)((()=>Boolean(o?C().D5(t,o,d):void 0)),[t,o,d]),E=(0,r().K8)((()=>{if("relation"!==(null==z?void 0:z.type))return"";const e=z.property;if(!e||e===o)return"";const t=d.getRole();if(!t||!s().Tt(t))return"";const n=d.getSchema()[e];return(null==n?void 0:n.name)||""}),[d,o,z]),U=(0,r().K8)((()=>"relation"===(null==z?void 0:z.type)&&z.autoRelate?z.autoRelate:{enabled:!1}),[z]),G=(0,r().K8)((()=>Boolean(C().uf(d))),[d]),$=(0,r().K8)((()=>Boolean((null==N?void 0:N.getDatabaseType())&&o&&(null==N?void 0:N.isTypedProperty(o)))),[N,o]),X=(0,n.useMemo)((()=>g?g.hasInverseRelation:Y),[g,Y]),J=(0,n.useMemo)((()=>g?g.inverseName:E),[g,E]),Z=(0,n.useMemo)((()=>g?g.autoRelate:U),[g,U]),Q=(0,n.useCallback)((()=>{o&&(0,p().V)({environment:F,collectionContextStore:t,property:o,from:"collectionPage"===W?"page_properties":"view_settings",action:X?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:q})}),[o,t,F,W,q,X]),ee=(0,n.useCallback)((()=>null!=N&&N.isSyncedCollection()?Z:X?{enabled:!1}:Z),[N,Z,X]),te=(0,n.useCallback)((()=>{h({hasInverseRelation:!0,inverseName:J,autoRelate:ee()}),Q()}),[h,J,Q,ee]),oe=(0,n.useCallback)((()=>{h({hasInverseRelation:!1,inverseName:void 0,autoRelate:ee()}),Q()}),[h,Q,ee]),ne=Boolean(H||!G||$||D),ie=(0,n.useCallback)((e=>{h({hasInverseRelation:!0,inverseName:e.target.value,autoRelate:Z})}),[h,Z]),re=(0,n.useCallback)((e=>{const n=null!=Z&&Z.enabled?{enabled:!1}:{enabled:!0,bot_id:e};h({hasInverseRelation:X,inverseName:J,autoRelate:n}),o&&(0,p().V)({environment:F,collectionContextStore:t,property:o,from:"collectionPage"===W?"page_properties":"view_settings",action:n.enabled?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[o,h,t,W,J,X,Z,F]),ae=(0,n.useCallback)((e=>{(0,b().SQ)({event:e,context:b().y$.CollectionSettingsClick,callback:K})}),[K]),le=(0,a().IS)((e=>({container:{width:V.isMobile?"100%":250,paddingBottom:V.isMobile?16:8,paddingLeft:V.isMobile?8:4,paddingRight:V.isMobile?8:4,marginTop:8},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6},disabled:{opacity:.5,pointerEvents:"none"}})),[V]),se=(0,r().uB)(void 0,M().A),ce=(0,r().K8)((()=>se.state.hovered||se.state.focused),[se]),de=(0,n.useMemo)((()=>!G||$?O.formatMessage(B.errors.cannotEditTargetDatabase):q?O.formatMessage(B.tooltips.selfRelationInverseTooltip):O.formatMessage(B.tooltips.inverseRelationTooltip,{databaseName:(0,_.jsx)(f().A,{shouldWrap:!0,style:{display:"inline"},store:d})})),[G,$,O,q,d]),pe=(0,n.useMemo)((()=>(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[O.formatMessage(B.generic.title),!V.isMobile&&(0,_.jsx)(x().A,{placement:j().W.Bottom,textWrap:!0,style:{width:200},store:se,render:e=>(0,_.jsx)("div",{...e,children:(0,l().$)(le.helpIcon)}),renderTooltip:()=>de})]})),[O,V.isMobile,le.helpIcon,de,se]);return N?(0,_.jsxs)(_.Fragment,{children:["create"===I&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(P,{currentInverseState:X,disableInverseRelation:oe,enableInverseRelation:te,handleAutoRelateToggle:re,temporaryInverseState:g,collectionStore:N,targetCollectionStore:d,isTwoWayToggleDisabled:ne,isNameDisabled:ne,menuTitle:pe,autoRelate:U,isSelfRelation:q,inverseRelationName:E,handleInverseNameChange:ie}),(0,_.jsx)(y().A,{style:{display:"flex",margin:"6px 12px 0px 12px"},onClick:ae,children:O.formatMessage(B.create.addRelation)})]}),"edit"===I&&(0,_.jsx)(m().A,{focused:!1,disabled:ne,popupType:V.isMobile?u().z7.SlideUp:u().z7.Popup,alignmentToOrigin:u().yP.End,placementToOrigin:u().sx.Bottom,isFullWidthOnMobile:!0,buttonPopupStore:L,onClose:K,renderOrigin:e=>(0,_.jsx)(x().A,{placement:j().W.Bottom,textWrap:!0,style:{width:200},forceVisibleState:!ce&&void 0,disableTooltip:!H,render:t=>(0,_.jsx)("div",{...t,children:(0,_.jsx)(k().A,{...e,showChevron:!0,rotateChevron:L.state.open,title:pe,disabled:ne,right:X?O.formatMessage(B.generic.on):O.formatMessage(B.generic.off)})}),renderTooltip:()=>H&&O.formatMessage(B.tooltips.disabledTwoWayRelationTooltip)}),render:e=>(0,_.jsxs)("div",{style:le.container,children:[(0,_.jsx)(S().A,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,disabled:ne,on:X,title:O.formatMessage(B.edit.enable),titleStyle:{display:"inline-flex"},onClick:e=>{X?oe():te()}}),(0,_.jsxs)("div",{style:X?void 0:le.disabled,children:[(0,_.jsx)(T,{handleAutoRelateToggle:re,temporaryAutoRelateState:null==g?void 0:g.autoRelate,collectionStore:N,autoRelate:U,targetCollectionStore:d}),(0,_.jsx)(R,{collectionStore:N,targetCollectionStore:d,isSelfRelation:q,temporaryInverseState:g,inverseRelationName:E,disabled:ne,onChange:ie,title:(0,_.jsx)(v().A,{isSecondaryColor:!0,isSmall:!0,children:O.formatMessage(B.edit.propertyNameLabel)})})]})]})})]}):null}function P(e){const{currentInverseState:t,disableInverseRelation:o,enableInverseRelation:n,handleAutoRelateToggle:i,temporaryInverseState:r,collectionStore:a,targetCollectionStore:l,isTwoWayToggleDisabled:s,isNameDisabled:d,menuTitle:p,autoRelate:u,isSelfRelation:m,inverseRelationName:g,handleInverseNameChange:y}=e,f=(0,c().tz)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S().A,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,on:t,disabled:s,title:p,titleStyle:{display:"inline-flex"},onClick:()=>{t?o():n()}}),t&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(T,{handleAutoRelateToggle:i,temporaryAutoRelateState:null==r?void 0:r.autoRelate,collectionStore:a,autoRelate:u,targetCollectionStore:l}),(0,_.jsx)(R,{collectionStore:a,targetCollectionStore:l,isSelfRelation:m,temporaryInverseState:r,inverseRelationName:g,disabled:d,onChange:y,title:(0,_.jsx)(v().A,{isSmall:!0,isSecondaryColor:!0,children:m?f.formatMessage(B.create.selfRelationPropertyNameHeader):f.formatMessage(B.create.relationPropertyNameHeader)})})]})]})}function R(e){const{collectionStore:t,targetCollectionStore:o,isSelfRelation:n,temporaryInverseState:i,inverseRelationName:a,disabled:l,onChange:s,title:p}=e,u=(0,c().tz)(),m=(0,r().K8)((()=>null!=t&&t.isDefined()?C().zF(u,{sourceCollection:t.getModel(),isSelfRelation:n,targetCollectionStore:o,createUnique:!0}):u.formatMessage(B.placeholders.relatedToTarget)),[t,u,n,o]);return(0,_.jsx)(h().A,{title:p,noTextOverflow:!0,children:(0,_.jsx)(g().Ay,{value:(null==i?void 0:i.inverseName)||a,placeholder:m,onChange:s,onBlur:d().D_,onSubmit:d().D_,focusInitial:!0,selectAll:!1,disabled:l})})}const B={generic:(0,c().YK)({on:{id:"database.viewSettings.setupRelationTab.generic.on",defaultMessage:"On"},off:{id:"database.viewSettings.setupRelationTab.generic.off",defaultMessage:"Off"},title:{id:"database.viewSettings.setupRelationTab.generic.title",defaultMessage:"Two-way relation"}}),create:(0,c().YK)({addRelation:{id:"database.viewSettings.setupRelationTab.create.relation.add",defaultMessage:"Add relation"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.add",defaultMessage:"Show on {databaseName}"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.addSelfRelationInverse",defaultMessage:"Separate directions {icon}"},relationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.propertyNameHeader",defaultMessage:"Related property name"},selfRelationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.selfRelation.inverse.propertyNameHeader",defaultMessage:"Inverse related property name"}}),edit:(0,c().YK)({modalTitle:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.modalTitle",defaultMessage:"Related property settings"},enable:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.enable",defaultMessage:"Enable"},propertyNameLabel:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.propertyNameLabel",defaultMessage:"Related property name"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.add",defaultMessage:"Show on {databaseName}"},editRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.edit",defaultMessage:"Edit relation on {databaseName}"},saveRelationInverse:{id:"database.viewSettings.setupRelationTab.relation.inverse.save",defaultMessage:"Save"},removeRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.remove",defaultMessage:"Remove property"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.add",defaultMessage:"Add inverse property"},editSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.edit",defaultMessage:"Edit inverse property"},renameSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.rename",defaultMessage:"Rename"},saveSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.save",defaultMessage:"Save"},removeSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.remove",defaultMessage:"Remove property"}}),tooltips:(0,c().YK)({inverseRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.tooltip",defaultMessage:"Manage property on {databaseName} showing backlinks to the current database"},selfRelationInverseTooltip:{id:"database.viewSettings.setupRelationTab.selfRelation.inverse.tooltip",defaultMessage:"Manage separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more."},disabledTwoWayRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.disabled.tooltip",defaultMessage:"Two-way relations cannot be enabled when share settings are inherited through this relation."}}),errors:(0,c().YK)({cannotEditTargetDatabase:{id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title",defaultMessage:"Cannot edit target database."}}),placeholders:(0,c().YK)({relatedToTarget:{id:"database.viewSettings.setupRelationTab.relation.inverse.placeholder",defaultMessage:"Related to target"}})}},236089:(e,t,o)=>{o.d(t,{s:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M9.792 2.41a.6.6 0 0 0-.234.148l-5.4 5.4a.625.625 0 1 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 1 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},i=(0,o(680369).wt)("arrowStraightUp",n)},372818:(e,t,o)=>{o.d(t,{V:()=>p});o(242343);var n=()=>o(237385),i=()=>o(209662),r=()=>o(653998),a=()=>o(696987),l=()=>o(84543),s=()=>o(745859),c=()=>o(948120),d=o(163643);function p(e){let{collectionContextStore:t,property:o,propertySchema:p}=e;const u=(0,n().v3)();return(0,d.jsx)(c().A,{title:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,d.jsx)(r().sA,{defaultMessage:"Show full URL",id:"database.viewSettings.propertyTab.toggleShowFullUrl"})}),icon:i().l,showChevron:!1,switcherProps:{on:Boolean(p.show_full_url),noColor:!1},onClick:()=>function(e,t,o,n){const i=t.collectionStore();if(!n||!i||"url"!==n.type)return;const r=!Boolean(n.show_full_url);l().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:e,canUndo:!0,perform:t=>{(0,s().F)({environment:e,collectionStore:i,update:{[o]:{...n,show_full_url:r}},transaction:t})}}),(0,a().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:r?"url_toggle_show_full_on":"url_toggle_show_full_off"})}(u,t,o,p)})}},419171:(e,t,o)=>{o.d(t,{Fc:()=>p,Jq:()=>c,k7:()=>d});var n=()=>o(154956),i=()=>o(84543),r=()=>o(206183),a=()=>o(468933),l=()=>o(838572),s=()=>o(413871);function c(e){let{collectionContextStore:t,property:o}=e;return(0,r().Kc)(t)[o]}function d(e,t){var o;if("relation"!==(null==t?void 0:t.type))return;const n=null===(o=l().A.state.caches[a().oB])||void 0===o?void 0:o.inMemoryRecordCache,i=null==t?void 0:t.collection_pointer,r=i&&e?s().md.createChildStore(e,i):void 0;return n?null==r?void 0:r.clone(n):r}function p(e){const{name:t,environment:o,property:a,collectionContextStore:l,inputValue:s}=e;if((0,r().fE)({property:a,collectionContextStore:l,newValue:s}))return;const c=l.collectionStore();if(!c)return;const d=c.getSchema()[a];d&&d.name!==t&&i().createAndCommit({userAction:"ButtonBuilderModal.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{n().YO({collectionStore:c,property:a,name:t,transaction:e})}})}},475598:(e,t,o)=>{o.d(t,{A:()=>f});o(242343);var n=()=>o(237385),i=()=>o(803290),r=()=>o(174114),a=()=>o(712437),l=()=>o(653998),s=()=>o(31448),c=()=>o(931085),d=()=>o(28210),p=()=>o(709237),u=()=>o(29869),m=()=>o(521972),g=()=>o(44405),y=o(163643);function f(e){const{isSelfRelation:t,collectionStore:o,showAs:f,disabled:h,onClick:S}=e,x=(0,i().K8)((()=>Boolean(o)),[o]),v=(0,i().K8)((()=>null==o?void 0:o.getIcon()),[o]),b=(0,i().K8)((()=>{if(t)return;const e=null==o?void 0:o.getParentBlockStore();return e&&(0,u().Ay)({store:e,pageVisitSource:a().y8.LinkInPage})}),[o,t]),C=(0,n().Y0)(),A=(0,r().IS)((e=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:e.text.primary,fontWeight:s().Wy.semibold,fontSize:14,marginLeft:4*(C.isRetina?.5:1),wordBreak:"break-word",...s().RC},chevronTitle:{display:"inline",wordBreak:"break-word",...s().RC}})),[C]),j=(0,i().K8)((()=>m().g.state.isOpen&&"layout-editor"===m().g.state.mode),[]),w=(0,y.jsx)(d().B,{icon:v,isEmptyPage:!1,size:20,disabled:!0});return(0,y.jsx)(g().A,{title:(0,y.jsx)(l().sA,{defaultMessage:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===f,onClick:S,disabled:h,right:t?(0,y.jsx)(l().sA,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===f&&b?(0,y.jsxs)(c().A,{external:j,href:b,innerStyle:A.linkBox,children:[w,(0,y.jsx)(p().A,{store:o,underline:!0,style:A.linkTitle,maxLength:15})]}):x?(0,y.jsxs)(y.Fragment,{children:[w,(0,y.jsx)(p().A,{store:o,style:A.chevronTitle})]}):(0,y.jsx)(l().sA,{defaultMessage:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}})}},487971:(e,t,o)=>{o.d(t,{$:()=>$,D:()=>Z});o(725707),o(500234),o(403517);var n=o(242343),i=()=>o(237385),r=()=>o(803290),a=()=>o(174114),l=()=>o(61014),s=()=>o(351892),c=()=>o(465546),d=()=>o(198654),p=()=>o(361308),u=()=>o(653998),m=()=>o(220413),g=()=>o(76394),y=()=>o(31448),f=()=>o(696987),h=()=>o(84543),S=()=>o(745859),x=()=>o(126451),v=()=>o(273520),b=()=>o(59175),C=()=>o(443252),A=()=>o(805886),j=()=>o(427385),w=()=>o(88271),M=()=>o(431551),_=()=>o(103151),T=()=>o(329911),k=()=>o(188877),I=()=>o(477784),P=()=>o(640979),R=()=>o(210466),B=()=>o(535906),K=()=>o(401382),D=()=>o(935091),F=()=>o(858023),V=o(163643);const O="LastUsedCurrency",L=o(129044).default.createClass("",{name:"NumberFormatFilterStore"});function z(e){const{collectionContextStore:t,collectionStore:o,property:a,schema:l,onClose:s}=e,c=(0,i().v3)(),d=(0,u().tz)(),m=(0,r().uB)(void 0,R().A),g=(0,r().uB)(void 0,L),y=(0,n.useCallback)((e=>{g.setState(e.target.value),m.setState({...m.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[g,m]),x=(0,r().O$)(g),v=(0,r().K8)((()=>function(e){const{environment:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,numberFormatFilterStore:a,onClose:l}=e,s=T().K.get({userId:t.currentUser.id,key:O}),c=(0,k().Ay)(a.state,(0,p().RQ)(s),(e=>e));return c.map((e=>{const a=(0,p().gL)(I().A.getIntl(),e),s=(0,p().D9)(e),c=s?`${a} (${s})`:a,d={key:e,render:e=>(0,V.jsx)(B().A,{...e,title:c}),action:()=>function(e){const{newFormat:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:a,onClose:l}=e,s=r[i];if(!s)return;if("number"!==s.type&&"formula"!==s.type)return;const c={...s,number_format:t,..."percent"===t&&void 0!==(null==s?void 0:s.show_as)?{show_as:{...null==s?void 0:s.show_as,maxValue:1}}:{}};"number"===s.type&&(0,p().SL)(t)&&T().K.set({userId:a.currentUser.id,key:O,value:t});h().createAndCommit({userAction:"NumberFormatMenu.handleNumberFormatChange",environment:a,canUndo:!0,perform:e=>{(0,S().F)({environment:a,collectionStore:n,update:{[i]:c},transaction:e})}}),(0,f().V)({environment:a,collectionContextStore:o,property:i,from:"view_settings",action:"number_change_format",number_format:t}),null==l||l()}({newFormat:e,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:t,onClose:l})};return d}))}({environment:c,collectionStore:o,collectionContextStore:t,property:a,schema:l,numberFormatFilterStore:g,onClose:s})),[t,c,o,a,l,g,s]),{device:b}=c;let C;C=b.isMobile?{menuType:P().gu.ActionSheet}:{menuType:P().gu.Popup};const A=!b.isMobile&&(0,V.jsx)(w().A,{isInput:!0,children:(0,V.jsx)(K().Ay,{value:x,onChange:y,focus:!0,focusAfterAnimation:!0,placeholder:d.formatMessage({defaultMessage:"Filter formats…",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0})});return(0,V.jsx)(D().A,{...C,header:A,children:(0,V.jsx)(F().Ay,{type:F().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,V.jsx)(w().A,{...e}),items:v}],store:m})})}var H=()=>o(278107),N=()=>o(749975),W=()=>o(86607),q=()=>o(639659),Y=()=>o(907721),E=()=>o(962373),U=()=>o(44405),G=()=>o(637558);function $(e){const{collectionContextStore:t,property:o}=e,{propertySchema:i,numberFormat:a,numberPrecision:d}=(0,r().K8)((()=>{const e=t.collectionStore();if(!e)return{};const n=t.normalizedSchemaStore.state[o];if(!n)return{};if("number"===n.type)return{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:n.number_precision??p().pS};if("formula"===n.type)return"number"===(0,l().getFormulaPropertySchemaResultType)(n)?{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:n.number_precision??p().pS}:n.formula2&&"number"===(0,c().pg)(n.formula2.result_type).type?{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:p().pS}:{};if("rollup"===n.type){var i;if(n.aggregation&&"show_unique"!==n.aggregation){var r;const i=null===(r=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===r?void 0:r.targetPropertySchema;if(void 0===(null==i?void 0:i.type))return{};const a=(0,W().o_)(n.aggregation,(0,W().o_)(n.aggregation,"number_format"in i?i.number_format:void 0));return a?{propertySchema:n,numberFormat:a,numberPrecision:p().pS}:{}}const a=null===(i=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===i?void 0:i.targetPropertySchema;if("number"===(null==a?void 0:a.type)||"formula"===(null==a?void 0:a.type)&&"number"===(0,l().getFormulaPropertySchemaBaseResultType)(a))return{propertySchema:n,numberFormat:a.number_format??p().C4,numberPrecision:p().pS}}return{}}),[t,o]),u="rollup"!==(null==i?void 0:i.type),m=(0,n.useMemo)((()=>"formula"===(null==i?void 0:i.type)&&"number"!==(0,l().getFormulaPropertySchemaResultType)(i)),[i]),g="rollup"!==(null==i?void 0:i.type)&&!m;return i?(0,V.jsxs)(V.Fragment,{children:[u&&(0,V.jsx)(X,{numberFormat:a,property:o}),g&&(0,V.jsx)(J,{numberPrecision:d,property:o}),(0,V.jsx)(Q,{property:o,propertySchema:i,numberFormat:a})]}):null}function X(e){const{numberFormat:t,property:o}=e,a=(0,u().tz)(),{isMobile:l}=(0,i().Y0)(),s=(0,N().ET)(),c=(0,r().uB)(void 0,E().A),d=(0,r().K8)((()=>s.collectionStore()),[s]),m=(0,r().O$)(s.normalizedSchemaStore),g=(0,n.useCallback)((e=>(0,V.jsx)(U().A,{title:(0,V.jsx)(u().sA,{defaultMessage:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:(0,V.jsx)("span",{style:{...y().RC},children:(0,p().gL)(a,p().PA.find((e=>e===t))??p().C4)}),showChevron:!0,rotateChevron:c.state.open,...e})),[c,a,t]),f=(0,n.useCallback)((e=>d?(0,V.jsx)(z,{collectionContextStore:s,collectionStore:d,property:o,schema:m,onClose:e.close}):null),[s,d,o,m]);return(0,V.jsx)(v().Ay,{popupType:l?C().nl.SlideUp:C().nl.Popup,alignmentToOrigin:v().yP.End,renderOrigin:g,render:f,buttonPopupStore:c})}function J(e){const{numberPrecision:t,property:o}=e,a=(0,u().tz)(),s=(0,i().v3)(),c=(0,N().ET)(),d=(0,r().K8)((()=>c.collectionStore()),[c]),m=(0,r().O$)(c.normalizedSchemaStore),g=(0,n.useMemo)((()=>{const e=m[o];if(!e)return;const t="formula"===e.type&&"number"===(0,l().getFormulaPropertySchemaResultType)(e);return"number"===e.type||t?e:void 0}),[o,m]),y=(0,n.useMemo)((()=>p().iv.map((e=>({key:e,type:"button",title:Z(a,e)})))),[a]),x=(0,n.useCallback)((e=>{if(!d||!g)return;const t={...g,number_precision:e};h().createAndCommit({userAction:"NumberFormatMenu.handleNumberPrecisionChange",environment:s,canUndo:!0,perform:e=>{(0,S().F)({environment:s,collectionStore:d,update:{[o]:t},transaction:e})}}),(0,f().V)({environment:s,collectionContextStore:c,property:o,from:"view_settings",action:"number_change_precision",number_precision:e})}),[c,d,s,o,g]),v=(0,n.useCallback)((()=>(0,V.jsx)(u().sA,{defaultMessage:"Round to a specified number of decimal places. The underlying remains unchanged.",id:"database.viewSettings.numberOptions.numberPrecision.tooltip"})),[]),b=(0,n.useCallback)((e=>(0,V.jsx)(G().A,{...e,title:(0,V.jsx)(u().sA,{defaultMessage:"Decimal places",id:"database.viewSettings.numberOptions.numberPrecision"}),selectedKey:t,options:y,onChange:x})),[x,t,y]);return(0,V.jsx)(_().A,{placement:Y().W.Right,textWrap:!0,renderTooltip:v,render:b})}function Z(e,t){switch(t){case"precision_uncapped":return e.formatMessage({id:"collection.numberFormat.precisionUncapped",defaultMessage:"Default"});case"precision_0":return e.formatMessage({id:"collection.numberFormat.precision0",defaultMessage:"0"});case"precision_1":return e.formatMessage({id:"collection.numberFormat.precision1",defaultMessage:"1"});case"precision_2":return e.formatMessage({id:"collection.numberFormat.precision2",defaultMessage:"2"});case"precision_3":return e.formatMessage({id:"collection.numberFormat.precision3",defaultMessage:"3"});case"precision_4":return e.formatMessage({id:"collection.numberFormat.precision4",defaultMessage:"4"});case"precision_5":return e.formatMessage({id:"collection.numberFormat.precision5",defaultMessage:"5"});default:(0,g().HB)(t)}}function Q(e){const{property:t,propertySchema:o,numberFormat:r}=e,{show_as:l}=o,s=(0,i().v3)(),c=(0,a().DP)(),p=(0,N().ET)(),g=(0,n.useRef)({color:(null==l?void 0:l.color)??"green",maxValue:(null==l?void 0:l.maxValue)??100,showValue:(null==l?void 0:l.showValue)??!0}),C=(0,q().a)(),_={type:(null==l?void 0:l.type)??"number",color:(null==l?void 0:l.color)??g.current.color,maxValue:(null==l?void 0:l.maxValue)??g.current.maxValue,showValue:(null==l?void 0:l.showValue)??g.current.showValue},T=(0,a().IS)((e=>({card:{boxSizing:"content-box",height:36,flex:1,margin:1,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.text.secondary,borderRadius:6,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:6,paddingBottom:6,cursor:"pointer",background:C?e.cardContentBackground:void 0},cardHoveredStyle:{background:C?e.cardContentBackground:void 0},cardPressedStyle:{background:C?e.cardContentBackground:void 0},selectedCard:{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor},cardVisual:{height:20,marginBottom:4,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},cardText:{lineHeight:1,fontSize:12},showAsTypeOption:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginLeft:C?12:16,marginRight:16,marginTop:6,gap:12},extraOptionStyle:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:16,paddingRight:16,gap:16,height:28,width:"100%"}})),[C]),k=(0,n.useCallback)((e=>{const n=p.collectionStore();o&&n&&(h().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:s,canUndo:!0,perform:i=>{(0,S().F)({environment:s,collectionStore:n,update:{[t]:{...o,show_as:e}},transaction:i})}}),(0,f().V)({environment:s,collectionContextStore:p,property:t,from:"view_settings",action:"number_change_show_as",number_show_as:(null==e?void 0:e.type)??"number"}))}),[p,s,t,o]),I=(0,n.useMemo)((()=>[{key:"number",visual:(0,V.jsx)("div",{style:{fontSize:16,fontWeight:y().Wy.medium},children:"42"}),text:(0,V.jsx)(u().sA,{defaultMessage:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:(0,V.jsx)(A().z,{percentage:50,filledColor:"bar"===_.type?c.blueColor:c.accentColors.translucentGray[500],unfilledColor:"bar"===_.type?c.accentColors.uiBlue[300]:c.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,V.jsx)(u().sA,{defaultMessage:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:(0,V.jsx)(j().C,{size:20,percentage:40,filledColor:"ring"===_.type?c.blueColor:c.accentColors.translucentGray[500],unfilledColor:"ring"===_.type?c.accentColors.uiBlue[300]:c.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,V.jsx)(u().sA,{defaultMessage:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}]),[_.type,c.blueColor,c.accentColors]),P=(0,V.jsx)("div",{style:T.showAsTypeOption,children:I.map((e=>{const t=_.type===e.key;return(0,V.jsxs)(x().A,{onClick:()=>{const t="number"===e.key?void 0:{type:e.key,color:_.color,maxValue:"percent"===r?1:_.maxValue,showValue:_.showValue};void 0!==t&&(g.current=t),k(t)},style:{...T.card,...t?T.selectedCard:{}},hoveredStyle:T.cardHoveredStyle,pressedStyle:T.cardPressedStyle,children:[(0,V.jsx)("div",{style:T.cardVisual,children:e.visual}),(0,V.jsx)("div",{style:T.cardText,children:e.text})]},e.key)}))}),R=e=>{const t="number"!==_.type?{..._,type:_.type,...e}:void 0;void 0!==t&&(g.current=t),k(t)},B="number"!==_.type?(0,V.jsxs)("div",{style:T.extraOptionStyle,children:[(0,V.jsx)("div",{style:{flex:6,fontSize:14},children:(0,V.jsx)(u().sA,{defaultMessage:"Color",id:"database.viewSettings.numberOptions.color"})}),(0,V.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:6,gap:7},children:(0,V.jsx)(v().Ay,{popupType:s.device.isMobile?v().z7.SlideUp:v().z7.Popup,renderOrigin:e=>(0,V.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},...e,children:(0,V.jsx)(H().A,{color:_.color,focused:!1,buttonStyle:{width:"auto",marginLeft:0,marginRight:0,borderRadius:6,color:c.text.tertiary},style:{minHeight:36},right:(0,d().b)({width:12,height:12})})}),render:e=>{const t=m().tS.map((t=>(0,V.jsx)(H().A,{color:t,isChecked:t===_.color,focused:!1,style:{width:"100%"},onClick:()=>{R({color:t}),e.close()}},t)));return(0,V.jsx)("div",{style:{minWidth:150,paddingTop:8,paddingBottom:8},children:t})}})})]}):null,K="number"!==_.type?"percent"!==r&&(0,V.jsxs)("div",{style:T.extraOptionStyle,children:[(0,V.jsx)("div",{style:{flex:6,fontSize:14},children:(0,V.jsx)(u().sA,{defaultMessage:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})}),(0,V.jsx)("div",{style:{flex:6},children:(0,V.jsx)(b().A,{value:_.maxValue.toString(),onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,""),o=parseFloat(t);!isNaN(o)&&o>0&&R({maxValue:o})},inputStyle:{textAlign:"right"}})})]}):null,D="number"!==_.type?(0,V.jsxs)("div",{style:T.extraOptionStyle,children:[(0,V.jsx)("div",{style:{flex:6,fontSize:14},children:(0,V.jsx)(u().sA,{defaultMessage:"Show number",id:"database.viewSettings.numberOptions.showValue"})}),(0,V.jsx)("div",{style:{flex:6,display:"flex",justifyContent:"flex-end"},children:(0,V.jsx)(M().A,{on:_.showValue,onClick:()=>{R({showValue:!_.showValue})},disabled:!1})})]}):null,F=Boolean(B||K||D)?(0,V.jsxs)("div",{style:{backgroundColor:C?c.cardContentBackground:c.accentColors.gray[30],boxShadow:C?`0 0 0 1px ${c.regularDividerColor}`:void 0,borderRadius:5,marginTop:12,marginLeft:C?12:16,marginRight:16,paddingTop:12,paddingBottom:12,maxHeight:1e3,transition:"max-height 0.5s ease-in-out",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[B,K,D]}):null;return(0,V.jsxs)(w().A,{title:(0,V.jsx)(u().sA,{defaultMessage:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0,children:[P,F,!C&&(0,V.jsx)("div",{style:{marginTop:12,marginLeft:18,marginRight:18,fontSize:12,color:c.text.tertiary},children:(0,V.jsx)(u().sA,{id:"database.CollectionSettings.NumberOptions.applyAllViews",defaultMessage:"Changes apply to all views showing this property."})})]})}},496794:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=function(e){const{title:t,href:i,analyticsFrom:r}=e,a=(0,o(237385).v3)();return(0,n.jsx)(o(579494).A,{href:i,onClick:()=>o(598995).FH(a,{from:r}),external:!0,children:(0,n.jsx)(o(44405).A,{icon:o(155342).questionMarkCircleIcon,title:t,isGray:!0})})}},542004:(e,t,o)=>{o.d(t,{Ay:()=>_,GI:()=>w,Ve:()=>k,am:()=>M,jD:()=>T});var n=o(242343),i=()=>o(803290),r=()=>o(174114),a=()=>o(810111),l=()=>o(182658),s=()=>o(680369),c=()=>o(361308),d=()=>o(653998),p=()=>o(76394),u=()=>o(32901),m=()=>o(900135),g=()=>o(44405),y=()=>o(740645),f=()=>o(654548),h=()=>o(802955),S=()=>o(836331),x=()=>o(613313),v=()=>o(133926),b=()=>o(345022),C=()=>o(397791),A=()=>o(103151),j=o(163643);function w(e){let{collectionStore:t,propertySchema:o,autofillFeatureAvailability:n}=e;const r=(0,i().K8)((()=>(0,x().Le)()),[]),a=(0,i().K8)((()=>(0,f().r4)(t.getName(),t)),[t]),l=r?(0,j.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesAddAiMessage}):(0,j.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesAddOnMessage});return(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,j.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(a)&&Boolean(o.name),collectionName:a,propertyName:o.name}})}),!(0,v().e2)(n)&&(0,j.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:l})]})}function M(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;return(0,y().getIsAutofillCurrentlyRunning)({taskRunningState:t})?(0,j.jsx)("div",{style:n,children:(0,j.jsx)(b().A,{})}):(0,j.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:(0,j.jsx)(C().I,{icon:l().magicWandIcon,color:"purplePrimary",style:o})})}function _(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,d().tz)(),a=(0,i().K8)((()=>S().default.checkGate({gateName:"autofill_all_pages_use_new_endpoint"})?(0,j.jsx)(d().sA,{defaultMessage:"Autofill this view",id:"aiAutofill.fillAllPagesInView.buttonTitle"}):(0,j.jsx)(d().sA,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})),[]),l=(0,n.useMemo)((()=>{switch(t.status){case"requested":return(0,j.jsx)(d().sA,{defaultMessage:"Requested Autofill",id:"AiAutofill.fillAllPages.requested"});case"notRunning":case"error":return a;case"running":return t.numPagesFilled===t.numPagesRequested?a:(0,j.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:(0,j.jsx)(d().sA,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,c().ZV)(t.numPagesFilled,"compact",o),numPagesRequested:(0,c().ZV)(t.numPagesRequested,"compact",o)}})});default:(0,p().HB)(t)}}),[a,o,t]),s=(0,r().IS)((()=>({textWrapper:{display:"flex",alignItems:"center",overflow:"hidden"}})),[]);return(0,j.jsx)("div",{style:s.textWrapper,children:l})}function T(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,r().IS)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);switch(t.status){case"notRunning":case"requested":case"error":return null;case"running":break;default:(0,p().HB)(t)}const{numPagesFilled:n,numPagesRequested:i}=t;return 0===i||n===i?null:(0,j.jsx)("div",{style:o.outer,role:"progressbar",children:(0,j.jsx)("div",{style:{...o.inner,width:100*Math.min(n/i,1)+"%"}})})}function k(e){const{environment:t,collectionContextStore:o,collectionStore:r,property:l,propertySchema:c,autofillFeatureAvailability:p,isAutofillSetupEnabled:f}=e,S=!(0,i().O$)(h().e),x=(0,i().K8)((()=>{const e=o.collectionStore();return e?(0,a().Ts)(e.getFormat(),l):{status:"notRunning"}}),[o,l]),b=(0,n.useCallback)((async e=>{const n=o.collectionStore(),i=o.collectionViewStore();n&&c&&i&&((0,v().e2)(e)?await m().autofillPropertyForCollection({environment:t,collectionStore:n,propertySchema:c,property:l,collectionViewStore:i}):m().triggerAiAutofillUpsell({environment:t,from:"ai_autofill_fill_all_pages",upsell:e.upsell}))}),[t,c,l,o]),C=(0,y().getIsAutofillCurrentlyRunning)({taskRunningState:x});return(0,j.jsx)(A().A,{disableTooltip:(0,v().e2)(p),renderTooltip:()=>S?(0,j.jsx)(d().sA,{...u().AY.aiUnavailableOfflineTooltip}):(0,j.jsx)(w,{collectionStore:r,propertySchema:c,autofillFeatureAvailability:p}),render:e=>(0,j.jsx)(g().A,{icon:e=>(0,j.jsx)(M,{updateAiInferencesTaskStatus:x,iconStyle:e,progressIconStyle:{width:s().Ev.sm,marginTop:4,marginLeft:4,marginRight:2}}),title:(0,j.jsx)(_,{updateAiInferencesTaskStatus:x}),caption:C&&"requested"!==x.status&&(0,j.jsx)(T,{updateAiInferencesTaskStatus:x}),focused:!1,onClick:()=>b(p),disabled:C||!f||S,...e})})}},542606:(e,t,o)=>{o.d(t,{l:()=>xo,A:()=>Yt});o(610931),o(362833),o(725707),o(491955),o(500234),o(403517);var n=o(242343),i=()=>o(237385),r=()=>o(803290),a=()=>o(174114),l=()=>o(564134),s=()=>o(716605),c=()=>o(855470),d=()=>o(127436),p=()=>o(836693),u=()=>o(409211),m=()=>o(653998),g=()=>o(220413),y=()=>o(76394),f=()=>o(261603),h=()=>o(469880),S=()=>o(696987),x=()=>o(236339),v=()=>o(963644),b=()=>o(154956),C=()=>o(521325),A=()=>o(445322),j=()=>o(927999),w=()=>o(196916),M=()=>o(84543),_=()=>o(283759),T=()=>o(982415),k=()=>o(56432),I=()=>o(810813),P=()=>o(361972),R=()=>o(745859),B=()=>o(107805),K=()=>o(314164),D=()=>o(542004),F=()=>o(849626),V=()=>o(397791),O=()=>o(402557),L=()=>o(88271),z=()=>o(103151),H=()=>o(619789),N=()=>o(206183),W=()=>o(663073),q=()=>o(562188),Y=()=>o(88442),E=()=>o(477784),U=()=>o(640979),G=()=>o(392608),$=()=>o(622286),X=()=>o(83544),J=()=>o(680369),Z=o(163643);const Q=(0,J().wt)("numbers",{viewBox:"0 0 22 12",svg:(0,Z.jsx)("path",{d:"M2.91732 11V2.50293H2.80795L0.299156 4.32129V3.02246L2.92416 1.13574H4.14779V11H2.91732ZM6.73438 11V10.1523L10.0703 6.54297C10.4896 6.08724 10.8177 5.71126 11.0547 5.41504C11.2917 5.11426 11.458 4.8431 11.5537 4.60156C11.6494 4.36003 11.6973 4.0957 11.6973 3.80859V3.79492C11.6973 3.44857 11.6221 3.13867 11.4717 2.86523C11.3213 2.5918 11.1071 2.37533 10.8291 2.21582C10.5511 2.05632 10.2184 1.97656 9.83105 1.97656C9.43913 1.97656 9.09505 2.05859 8.79883 2.22266C8.5026 2.38216 8.27246 2.60775 8.1084 2.89941C7.94434 3.18652 7.8623 3.52376 7.8623 3.91113L7.85547 3.9248L6.67969 3.91797L6.66602 3.91113C6.67057 3.3278 6.81185 2.81055 7.08984 2.35938C7.36784 1.90365 7.75065 1.54818 8.23828 1.29297C8.72591 1.0332 9.28418 0.90332 9.91309 0.90332C10.4873 0.90332 11.0046 1.02409 11.4648 1.26562C11.9251 1.5026 12.2874 1.82845 12.5518 2.24316C12.8206 2.65788 12.9551 3.13184 12.9551 3.66504V3.67871C12.9551 4.05241 12.889 4.41243 12.7568 4.75879C12.6292 5.10514 12.4014 5.49023 12.0732 5.91406C11.7451 6.33333 11.2826 6.85059 10.6855 7.46582L8.13574 10.0977L8.44336 9.53027V10.0977L8.14258 9.89258H13.1191V11H6.73438ZM18.276 11.1641C17.597 11.1641 17.0046 11.0479 16.4987 10.8154C15.9928 10.583 15.5918 10.264 15.2956 9.8584C15.0039 9.4528 14.8353 8.99023 14.7897 8.4707L14.7829 8.38867H15.9655L15.9723 8.45703C16.0042 8.7806 16.1182 9.06543 16.3141 9.31152C16.5146 9.55762 16.7812 9.7513 17.1139 9.89258C17.4512 10.0293 17.8385 10.0977 18.276 10.0977C18.709 10.0977 19.0872 10.0225 19.4108 9.87207C19.7389 9.72168 19.9941 9.51432 20.1764 9.25C20.3587 8.98112 20.4499 8.6735 20.4499 8.32715V8.31348C20.4499 7.70736 20.2471 7.24251 19.8415 6.91895C19.4404 6.59082 18.8936 6.42676 18.2008 6.42676H16.9635V5.3877H18.1462C18.5381 5.3877 18.8844 5.31478 19.1852 5.16895C19.486 5.01855 19.7207 4.81576 19.8893 4.56055C20.0579 4.30078 20.1423 4.00684 20.1423 3.67871V3.66504C20.1423 3.31868 20.0693 3.02474 19.9235 2.7832C19.7777 2.54167 19.5635 2.3571 19.2809 2.22949C19.0029 2.10189 18.6634 2.03809 18.2624 2.03809C17.875 2.03809 17.5286 2.10417 17.2233 2.23633C16.9225 2.36393 16.681 2.5485 16.4987 2.79004C16.3164 3.03158 16.207 3.31868 16.1706 3.65137L16.1637 3.71973H14.9811L14.988 3.65137C15.0426 3.11361 15.2113 2.64421 15.4938 2.24316C15.7809 1.84212 16.1592 1.52995 16.6286 1.30664C17.1025 1.08333 17.6471 0.97168 18.2624 0.97168C18.8913 0.97168 19.4381 1.08105 19.903 1.2998C20.3724 1.514 20.7347 1.8125 20.9899 2.19531C21.2497 2.57357 21.3796 3.01335 21.3796 3.51465V3.52832C21.3796 3.93392 21.2907 4.29395 21.113 4.6084C20.9352 4.92285 20.6891 5.1849 20.3747 5.39453C20.0602 5.60417 19.6979 5.75228 19.2878 5.83887V5.86621C20.0078 5.92546 20.5889 6.16927 21.0309 6.59766C21.4775 7.02148 21.7008 7.58431 21.7008 8.28613V8.2998C21.7008 8.84668 21.5527 9.33659 21.2565 9.76953C20.9603 10.2025 20.5547 10.5443 20.0397 10.7949C19.5247 11.041 18.9368 11.1641 18.276 11.1641Z"})}),ee=(0,J().wt)("numbersBold",{viewBox:"0 0 39 19",svg:(0,Z.jsx)("path",{d:"M5.05697 18V3.98438H4.96322L0.627281 6.97266V4.19531L5.04525 1.08984H8.03353V18H5.05697ZM11.8711 18V15.9375L17.7656 10.1484C18.5156 9.41406 19.0859 8.80859 19.4766 8.33203C19.8672 7.84766 20.1367 7.41406 20.2852 7.03125C20.4336 6.64844 20.5078 6.25 20.5078 5.83594V5.80078C20.5078 5.29297 20.3906 4.84375 20.1562 4.45312C19.9219 4.0625 19.5938 3.75781 19.1719 3.53906C18.7578 3.3125 18.2734 3.19922 17.7188 3.19922C17.1016 3.19922 16.5547 3.32812 16.0781 3.58594C15.6016 3.83594 15.2266 4.17969 14.9531 4.61719C14.6875 5.04688 14.5508 5.53906 14.543 6.09375L14.5312 6.16406H11.7188L11.707 6.09375C11.707 5.05469 11.9688 4.13672 12.4922 3.33984C13.0234 2.53516 13.7422 1.90625 14.6484 1.45312C15.5547 1 16.582 0.773438 17.7305 0.773438C18.8555 0.773438 19.8477 0.984375 20.707 1.40625C21.5742 1.82031 22.25 2.39453 22.7344 3.12891C23.2266 3.85547 23.4727 4.68359 23.4727 5.61328V5.64844C23.4727 6.30469 23.3516 6.92578 23.1094 7.51172C22.875 8.08984 22.4727 8.72266 21.9023 9.41016C21.332 10.0898 20.5469 10.9141 19.5469 11.8828L14.8477 16.3594L15.8789 14.4961V16.3594L14.8594 15.5273H23.7305V18H11.8711ZM32.0094 18.293C30.7751 18.293 29.6969 18.0898 28.7751 17.6836C27.8532 17.2695 27.1227 16.6992 26.5837 15.9727C26.0446 15.2461 25.736 14.4102 25.6579 13.4648L25.6462 13.3242H28.529L28.5407 13.4414C28.6032 13.9023 28.779 14.3125 29.068 14.6719C29.3649 15.0312 29.7633 15.3164 30.2633 15.5273C30.7633 15.7305 31.3454 15.832 32.0094 15.832C32.6657 15.832 33.236 15.7227 33.7204 15.5039C34.2126 15.2773 34.5915 14.9688 34.8571 14.5781C35.1305 14.1797 35.2673 13.7227 35.2673 13.207V13.1836C35.2673 12.293 34.9587 11.6094 34.3415 11.1328C33.7243 10.6562 32.8766 10.418 31.7985 10.418H29.7946V8.16797H31.7282C32.3532 8.16797 32.8962 8.05859 33.3571 7.83984C33.8258 7.62109 34.1891 7.32422 34.4469 6.94922C34.7048 6.56641 34.8337 6.12891 34.8337 5.63672V5.61328C34.8337 5.09766 34.7204 4.66016 34.4938 4.30078C34.2751 3.94141 33.9508 3.66797 33.5212 3.48047C33.0993 3.28516 32.5876 3.1875 31.986 3.1875C31.3923 3.1875 30.8649 3.28516 30.404 3.48047C29.9508 3.67578 29.5876 3.95312 29.3141 4.3125C29.0407 4.67188 28.8766 5.09766 28.8219 5.58984L28.8102 5.69531H26.0094L26.0212 5.56641C26.1071 4.60547 26.404 3.76953 26.9118 3.05859C27.4274 2.33984 28.1149 1.78516 28.9743 1.39453C29.8415 0.996094 30.8454 0.796875 31.986 0.796875C33.1501 0.796875 34.1618 0.984375 35.0212 1.35938C35.8805 1.72656 36.5446 2.24219 37.0133 2.90625C37.4899 3.5625 37.7282 4.33203 37.7282 5.21484V5.23828C37.7282 5.93359 37.5719 6.55078 37.2594 7.08984C36.9548 7.62109 36.5329 8.0625 35.9938 8.41406C35.4626 8.76562 34.8571 9.01172 34.1774 9.15234V9.21094C35.4274 9.32812 36.4313 9.74219 37.1891 10.4531C37.9469 11.1562 38.3258 12.0938 38.3258 13.2656V13.2891C38.3258 14.2656 38.0602 15.1328 37.529 15.8906C36.9977 16.6484 36.2555 17.2383 35.3024 17.6602C34.3571 18.082 33.2594 18.293 32.0094 18.293Z"})});var te=()=>o(31448),oe=()=>o(113915),ne=()=>o(130081),ie=()=>o(546820);function re(){const{layoutStore:e,currentModuleSelection:t,collectionStore:n}=(0,ie().LH)(),i=(0,r().K8)((()=>{if("existing_module"===(null==t?void 0:t.type))return e.getModuleById(t.moduleId)}),[t,e]),a=(0,r().K8)((()=>{if((0,o(946854).gx)(i))return null==n?void 0:n.getSchemaStore().getKeyStore(i.propertyId).getValue()}),[n,i]);if(!i||!a)return null;switch(i.type){case"property_person":case"property_created_by":case"property_last_edited_by":return(0,Z.jsx)(ce,{module:i,options:ae,heightVariant:"tall"});case"property_formula":return(0,o(61014).isNumberFormulaPropertySchema)(a)?(0,Z.jsx)(ce,{module:i,options:se,heightVariant:"short"}):null;case"property_number":return(0,Z.jsx)(ce,{module:i,options:se,heightVariant:"short"});case"property_file":return(0,Z.jsx)(ce,{module:i,options:le,heightVariant:"short"});default:return null}}const ae={available:["large","compact"],appearance:{compact:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.compact",defaultMessage:"Compact"}),image:{src:X().A.images.layouts.configuration.personCompactPng,width:100,height:41}},large:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.large",defaultMessage:"Large"}),image:{src:X().A.images.layouts.configuration.personMediumPng,width:82,height:56}}}},le={available:["landscape","portrait","square"],appearance:{landscape:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.landscape",defaultMessage:"Landscape"}),image:{src:X().A.images.layouts.configuration.fileLandscapePng,width:192,height:128}},portrait:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.portrait",defaultMessage:"Portrait"}),image:{src:X().A.images.layouts.configuration.filePortraitPng,width:192,height:128}},square:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.square",defaultMessage:"Square"}),image:{src:X().A.images.layouts.configuration.fileSquarePng,width:192,height:128}}}},se={available:["large","small"],appearance:{large:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.large",defaultMessage:"Large"}),icon:{function:ee,size:42}},small:{label:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.small",defaultMessage:"Small"}),icon:{function:Q,size:22}}}};function ce(e){let{module:t,options:o,heightVariant:r}=e;const l=(0,i().v3)(),{layoutStore:s}=(0,ie().LH)(),c=(0,n.useCallback)((e=>{const o=s.getModel(),n=null==o?void 0:o.getPageModuleAreaById(t.id);if(!n||!o)return;const i={...t,style:e};M().createAndCommit({environment:l,perform(e){(0,ne().UQ)({environment:l,transaction:e,layoutStore:s,position:{area:n,moduleId:i.id},updatedModule:i})},canUndo:!0,userAction:"BuilderLayoutModules.setDisplayStyle"})}),[l,s,t]),d=(0,a().IS)((e=>({container:{margin:"10px 8px"},label:{fontSize:te().J.UISmall.desktop,fontWeight:te().Wy.medium,margin:"0px 8px 6px 8px",color:e.text.secondary}})),[]);return(0,Z.jsxs)("div",{style:d.container,children:[(0,Z.jsx)("p",{style:d.label,children:(0,Z.jsx)(m().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.title",defaultMessage:"Style"})}),(0,Z.jsx)(oe().A,{disabled:!1,options:o,selectedOption:t.style,onOptionSelected:c,height:r})]})}var de=()=>o(639659),pe=()=>o(907721),ue=()=>o(962373),me=()=>o(802955),ge=()=>o(795756),ye=()=>o(413871),fe=()=>o(133926),he=()=>o(419171),Se=()=>o(273520),xe=()=>o(443252),ve=()=>o(44405);const be=n.memo((function(e){let{collectionContextStore:t,collectionSettingsStore:a,property:l}=e;const s=(0,i().v3)(),{isMobile:c}=(0,i().Y0)(),d=(0,r().uB)(void 0,ue().A),p=(0,n.useCallback)((e=>{const n=t.collectionStore();if(!n)return null;const i=t.normalizedSchemaStore.state[l];if("formula"!==(null==i?void 0:i.type))return;const r=Boolean(n.getDatabaseType()&&n.isTypedProperty(l)),c=null==a?void 0:a.getState().fromBlockStore;return(0,Z.jsx)(o(129978).u2,{dependency:o(73631).T.formulas,children:t=>(0,Z.jsx)(o(694627).A,{handleClose:e.close,property:l,getRecordModel:n.getRecordModel,propertySchema:i,collectionStore:n,handleSave:e=>function(e,t){const{newValue:o,newType:n,propertySchema:i,property:r,collectionStore:a}=e,l=o?{...i,formula2:{code:o,result_type:n},version:"v2"}:{...i,formula2:void 0,version:"v2"};M().createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,R().F)({environment:t,collectionStore:a,update:{[r]:l},transaction:e})}})}(e,s),formulas:t,disabled:r,blockStore:c,analyticsFrom:"view_settings"})})}),[t,a,s,l]);return(0,Z.jsx)(Se().Ay,{popupType:c?xe().nl.BottomSheet:xe().nl.Popup,alignmentToOrigin:Se().yP.End,renderOrigin:e=>(0,Z.jsx)(ve().A,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Edit formula",id:"database.viewSettings.formulaOptions.title"}),showChevron:!0,icon:o(686752).pencilLineIcon,rotateChevron:d.state.open,...e}),render:p,buttonPopupStore:d})}));var Ce=()=>o(193867),Ae=()=>o(475105),je=()=>o(16791),we=()=>o(871002),Me=()=>o(972375),_e=()=>o(637558);function Te(e){let{collectionContextStore:t,property:o}=e;const n=(0,m().tz)(),a=(0,i().v3)(),l=(0,r().K8)((()=>ke(t,o)),[t,o]),s=(0,r().K8)((()=>t.getPropertyFormat(o)),[t,o]);if(!l)return null;const c=(null==s?void 0:s.date_format)||l.date_format||we().vz,d=function(e){const t=Ie();for(const o in t)if(t[o]===e)return o;return"12h"}((null==s?void 0:s.time_format)||l.time_format||we().CE);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(_e().A,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),selectedKey:c,popupStyle:{minWidth:190},options:we().wJ.map((e=>({key:e,type:"button",title:n.formatMessage(we().xz[e])}))),onChange:e=>function(e,t,o,n){const i="collectionTypedView"===o.contextType;if(i){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;M().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvDateFormatChange",environment:t,canUndo:!0,perform:t=>{b().a5({formatStore:i,formatKey:r,property:n,update:{date_format:e},transaction:t})}})}else{const i=o.collectionStore(),r=ke(o,n);if(!i||!r)return;const a={...r,date_format:e};M().createAndCommit({userAction:"CollectionSettingsDateOptions.handleDateFormatChange",environment:t,canUndo:!0,perform:e=>{(0,R().F)({environment:t,collectionStore:i,update:{[n]:a},transaction:e})}})}(0,S().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_format"})}(e,a,t,o)}),(0,Z.jsx)(_e().A,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),selectedKey:d,popupStyle:{minWidth:190},options:we().ZD.map((e=>({key:e,type:"button",title:n.formatMessage(we().px[e])}))),onChange:e=>function(e,t,o,n){const i=Ie()[e],r="collectionTypedView"===o.contextType;if(r){const e=o.formatStore();if(!e)return;const r=o.getPropertyFormatKey();if(!r)return;M().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvClockFormatChange",environment:t,canUndo:!0,perform:t=>{b().a5({formatStore:e,formatKey:r,property:n,update:{time_format:i},transaction:t})}})}else{const e=o.collectionStore(),r=ke(o,n);if(!e||!r)return;const a={...r,time_format:i};M().createAndCommit({userAction:"CollectionSettingsDateOptions.handleClockFormatChange",environment:t,canUndo:!0,perform:o=>{(0,R().F)({environment:t,collectionStore:e,update:{[n]:a},transaction:o})}})}(0,S().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_time_format"})}(e,a,t,o)})]})}function ke(e,t){const o=e.normalizedSchemaStore.state[t];if(o)return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?o:void 0}function Ie(){return(0,Me().X)(je().locale).time}var Pe=()=>o(446656);function Re(e){const{collectionContextStore:t,property:o,propertySchema:r}=e,a=(0,i().v3)(),l=(0,n.useCallback)((e=>{const n={...r,default:"created_by"===e?"created_by":void 0},i=t.collectionStore();i&&((0,I().p)({environment:a,collectionStore:i,performTransaction:t=>{M().applyOperation({store:(0,ye().Oo)(i,i.pointer),operation:{pointer:i.pointer,command:"update",path:["schema",o],args:{default:e}},transaction:t})}}),M().createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",environment:a,canUndo:!0,perform:e=>{(0,R().F)({environment:a,collectionStore:i,update:{[o]:n},transaction:e})}}))}),[t,a,o,r]);return(0,Z.jsx)(_e().A,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:r.default?"created_by":"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",type:"button",title:(0,Z.jsx)(m().sA,{defaultMessage:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:"created_by",type:"button",title:(0,Z.jsx)(m().sA,{defaultMessage:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:(0,Pe().z)({width:16})}],onChange:l})}var Be=()=>o(985174),Ke=()=>o(496794),De=()=>o(976026),Fe=()=>o(487971),Ve=()=>o(853100),Oe=()=>o(946670),Le=()=>o(755786),ze=()=>o(908568),He=()=>o(873624),Ne=()=>o(884373),We=()=>o(137476);const qe=(0,m().YK)({linkPreviewDescription:{defaultMessage:"Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.linkPreviewDescription"}});function Ye(e){const{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a}=e,l=Ge();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Ee,{}),(0,Z.jsx)(Ne().A,{size:"100%",innerStyle:{borderColor:l.addDivider.borderColor}}),(0,Z.jsx)(Ue,{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a})]})}function Ee(){const e=Ge(),t=(0,m().tz)();return(0,Z.jsxs)(L().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:e.previewContentContainer,children:[(0,Z.jsxs)("div",{style:e.tabDescription,children:[" ","Preview"]}),(0,Z.jsx)("div",{children:(0,Z.jsx)("img",{src:X().A.images.externalIntegrations.salesforceLinkpreviewPng,style:e.previewContentContainer,alt:"Paste Salesforce URLs to create a Salesforce property."})}),(0,Z.jsx)("div",{style:e.tabDescription,children:t.formatMessage(qe.linkPreviewDescription)})]})}function Ue(e){let{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:a}=e;const l=Ge(),s=t.settingsStore;return(0,Z.jsxs)(L().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:l.previewContentContainer,children:[(0,Z.jsxs)("div",{style:l.tabDescription,children:[" ","Database actions"]}),(0,Z.jsx)(ve().A,{showChevron:!0,title:"Add properties",icon:He().j,onClick:()=>{const e=t.collectionStore();(0,We().u4)({environment:a,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",collectionId:null==e?void 0:e.id,integrationId:i}}}),C().a2({collectionSettingsStore:s,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}}),(0,Z.jsx)(ve().A,{showChevron:!0,title:"Copy URL",icon:ze().n,onClick:()=>{C().a2({collectionSettingsStore:s,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationCopyUrl",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}})]})}function Ge(){const{isMobile:e}=(0,i().Y0)();return(0,a().IS)((t=>({addDivider:{borderColor:t.tableDividerColor},previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:e?18:10,fontSize:e?16:12,color:t.text.tertiary}})),[e])}var $e=()=>o(485966),Xe=()=>o(836331),Je=()=>o(626911),Ze=()=>o(214e3);function Qe(e){const{collectionContextStore:t,property:o,targetCollectionStore:a}=e,l=(0,i().v3)(),s=(0,m().tz)(),c=(0,r().K8)((()=>t.collectionStore()),[t]),d=(0,r().K8)((()=>t.contextType),[t]),[p,u]=(0,n.useState)(void 0),g=Boolean(a&&(null==c?void 0:c.id)===a.id),y=(0,n.useCallback)((()=>{if(!p)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=p;M().createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",environment:l,canUndo:!0,perform:r=>{Je().Go({environment:l,collectionContextStore:t,property:o,hasInverseRelation:e,inverseName:n,autoRelate:i,intl:s,transaction:r})}}),(0,S().V)({environment:l,collectionContextStore:t,property:o,from:"collectionPage"===d?"page_properties":"view_settings",action:"relation_edit",is_self_relation:g,has_inverse:e,auto_relate:null==i?void 0:i.enabled}),u(void 0)}),[p,l,t,o,d,g,s]);return(0,Z.jsx)(Ze().Ay,{collectionContextStore:t,targetCollectionStore:a,property:o,temporaryInverseState:p,setTemporaryInverseState:u,onSubmit:y})}const et=(0,J().wt)("linkedRelationDark",{viewBox:"0 0 36 32",svg:(0,Z.jsxs)("g",{children:[(0,Z.jsx)("path",{fill:"#fff",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM8 3a.5.5 0 000 1h6.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H8z",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#fff",opacity:"0.5"}),(0,Z.jsx)("path",{fill:"#564328",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,Z.jsx)("path",{fill:"#CA984D",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),tt=(0,J().wt)("linkedRelationLight",{viewBox:"0 0 36 32",svg:(0,Z.jsxs)("g",{children:[(0,Z.jsx)("path",{fill:"#91918E",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM9 3a.5.5 0 000 1h5.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H9z",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#91918E",opacity:"0.5"}),(0,Z.jsx)("path",{fill:"#FBF3DB",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,Z.jsx)("path",{fill:"#CB912F",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),ot=(0,J().wt)("unlinkedRelationDark",{viewBox:"0 0 36 32",svg:(0,Z.jsxs)("g",{children:[(0,Z.jsx)("path",{fill:"#fff",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#fff",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#fff",opacity:"0.5"})]})}),nt=(0,J().wt)("unlinkedRelationLight",{viewBox:"0 0 36 32",svg:(0,Z.jsxs)("g",{children:[(0,Z.jsx)("path",{fill:"#91918E",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#91918E",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Z.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"})]})});var it=()=>o(145046),rt=()=>o(209684),at=()=>o(535906),lt=()=>o(951540),st=()=>o(539048),ct=()=>o(35462),dt=()=>o(868325),pt=()=>o(50903);function ut(e){const{collectionContextStore:t,property:o,propertySchema:l}=e,s=(0,m().tz)(),c=(0,i().v3)(),d=(0,i().Y0)(),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,he().k7)(e,l)}),[t,l]),g=(0,r().K8)((()=>{var e;return Boolean(null===(e=l.permissions_data)||void 0===e?void 0:e.shared_by_enabled)}),[l]),y="dark"===(0,a().eP)(),f=(0,r().K8)((()=>y?ot:nt),[y]),h=(0,r().K8)((()=>y?et:tt),[y]),S=(0,r().K8)((()=>null==p?void 0:p.getName()),[p]),x=(0,r().K8)((()=>null==u?void 0:u.getName()),[u]),v=p&&u&&p.id===u.id,b=(0,r().K8)((()=>{const e=p&&p.getSharingEnabledRelationId();return Boolean(e&&e!==o)}),[p,o]);let C;b?C="hasAnotherSharingEnabledProperty":v&&(C="isSelfRelation");const[A,j]=(0,n.useState)(!1),[w,_]=(0,n.useState)(!1),T=(0,r().K8)((()=>{const e={limit:!1,twoWayRelation:!1};if(!p)return e;if(1!==l.limit&&(e.limit=!0),u){Le().D5(t,o,u)&&(e.twoWayRelation=!0)}return e}),[p,l,t,o,u]),[k,I]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(!w){const e=[];T.limit&&e.push("limit"),T.twoWayRelation&&e.push("twoWayRelation"),I(e)}}),[T,w]);const P=(0,n.useCallback)((async e=>{if(!p)return;const t=l.property,n=(null==l?void 0:l.permissions_data)??{},i={...l,limit:1,autoRelate:void 0,permissions_data:{...n,shared_by_enabled:e}},{serverCommitResult:r}=M().createAndCommit({userAction:"CollectionSettingsShareBy.handleShareByChange",environment:c,canUndo:!0,perform:e=>{(0,R().F)({environment:c,collectionStore:p,update:{[o]:i},transaction:e}),u&&t&&Je().t$({environment:c,collectionStore:u,property:t,transaction:e})}});try{await r}catch(a){if(a instanceof pt().rS&&a.clientData){const e=(0,dt().Yu)(a.clientData),t=(0,dt().t4)(s,e);t&&it().f1(t)}}}),[p,l,c,o,u,s]),B=(0,n.useCallback)((e=>{p&&(e&&k.length>0?j(!0):P(e))}),[p,k,P]),K=(0,n.useCallback)((()=>{j(!1)}),[]),D=(0,n.useCallback)((async()=>{_(!0);try{await P(!0)}finally{_(!1),j(!1)}}),[P]),F=(0,a().IS)((e=>({disabled:{opacity:.5,pointerEvents:"none"},container:{marginLeft:14,marginRight:16,marginBottom:12},buttonTitle:{fontSize:d.isMobile?17:14,fontWeight:400,lineHeight:d.isMobile?"24px":"20px",textWrap:"wrap",overflow:"auto"},buttonDefault:{marginTop:12,paddingTop:d.isMobile?16:12,paddingBottom:d.isMobile?16:12,borderRadius:8,boxShadow:`0 0 0 1px ${e.selectLightGray[200]}`,gap:6},buttonSelected:{boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:d.isMobile?54:36,height:d.isMobile?48:32},disabledReasonContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,borderRadius:10,backgroundColor:e.tint.uiYellow,color:e.text.uiYellowPrimary,fontSize:12,textWrap:"pretty"},modalContainer:{padding:20,paddingBottom:12,width:d.isMobile?void 0:400},modalHeader:{display:"flex",flexDirection:"column"},modalHeaderIconContainer:{display:"flex",justifyContent:"center"},modalHeaderTitle:{display:"flex",justifyContent:"center",marginTop:8,fontSize:17,fontWeight:590,lineHeight:"22px",textAlign:"center",color:e.text.primary},modalHeaderDescription:{display:"flex",justifyContent:"center",marginTop:8,fontSize:14,lineHeight:"20px",color:e.text.secondary,textAlign:"center",textWrap:"pretty"},modalList:{display:"flex",marginTop:24,flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",fontSize:14,boxShadow:`0 0 0 1px ${e.selectLightGray[100]}`,borderRadius:10},modalListItem:{borderBottom:`1px solid ${e.selectLightGray[100]}`},modalListItemContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12}})),[d.isMobile]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(L().A,{topBorder:!0,disableMobileBorders:!0,disableDesktopPadding:!0,disableMobilePadding:!0,mobileTitleStyle:{marginTop:12},mobileStyle:{paddingBottom:6},title:(0,Z.jsx)(ct().A,{isSmall:!0,isSecondaryColor:!0,isMobile:d.isMobile,children:(0,Z.jsx)(m().sA,{id:"collectionSettings.relationSharingSwitcher.header",defaultMessage:"Share settings through relation"})}),children:[C&&(0,Z.jsx)("div",{style:F.container,children:(0,Z.jsx)("div",{style:F.disabledReasonContent,children:s.formatMessage(mt.disabledReasons[C])})}),(0,Z.jsxs)("div",{style:{...F.container,...v&&F.disabled,...b&&F.disabled},children:[(0,Z.jsx)(at().A,{focused:!1,left:f(F.icon),title:(0,Z.jsx)(m().sA,{id:"collectionSettings.relationSharingSwitcher.unlinkedTitle",defaultMessage:"{collectionName} and {relationName} have separate share settings",values:{collectionName:S,relationName:x}}),titleStyle:F.buttonTitle,style:{...F.buttonDefault,...!g&&F.buttonSelected},onClick:()=>B(!1)}),(0,Z.jsx)(at().A,{focused:!1,left:h(F.icon),title:(0,Z.jsx)(m().sA,{id:"collectionSettings.relationSharingSwitcher.linkedTitle",defaultMessage:"{collectionName} inherit share settings from related {relationName}",values:{collectionName:S,relationName:x}}),titleStyle:F.buttonTitle,style:{...F.buttonDefault,...g&&F.buttonSelected},onClick:()=>B(!0)})]})]}),(0,Z.jsx)(st().s,{showCloseIcon:!0,isOpen:A,onDismiss:()=>{j(!1)},render:()=>(0,Z.jsxs)("div",{style:F.modalContainer,children:[(0,Z.jsxs)("div",{style:F.modalHeader,children:[(0,Z.jsx)("div",{style:F.modalHeaderIconContainer,children:h({width:36,height:32,marginLeft:4})}),(0,Z.jsx)("div",{style:F.modalHeaderTitle,children:s.formatMessage(mt.header.title)}),(0,Z.jsx)("div",{style:F.modalHeaderDescription,children:s.formatMessage(mt.header.description)})]}),(0,Z.jsx)("div",{style:F.modalList,children:k.map(((e,t,o)=>(0,Z.jsx)("div",{style:{...F.modalListItem,borderBottom:t+1===o.length?"none":F.modalListItem.borderBottom},children:(0,Z.jsx)("div",{style:F.modalListItemContent,children:s.formatMessage(mt.issues[e],{title:e=>(0,Z.jsx)("span",{style:{fontWeight:590},children:e}),description:e=>(0,Z.jsx)("div",{style:{marginTop:4},children:e})})})},e)))}),(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",marginTop:24,gap:8},children:[(0,Z.jsx)(lt().A,{size:"lg",onClick:D,isLoading:w,disabled:w,children:(0,Z.jsx)(m().sA,{id:"collectionSettings.relationSharingSwitcher.changes.applyChanges",defaultMessage:"Apply changes"})}),(0,Z.jsx)(rt().p,{onClick:K,size:"lg",isGray:!0,disabled:w,style:{justifyContent:"center"},children:(0,Z.jsx)(m().sA,{id:"collectionSettings.relationSharingSwitcher.changes.cancel",defaultMessage:"Cancel"})})]})]})})]})}const mt={header:(0,m().YK)({title:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderTitle",defaultMessage:"Turn on permission sharing"},description:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderDescription",defaultMessage:"To enable permission sharing through a relation, the following changes are required."}}),issues:(0,m().YK)({limit:{id:"collectionSettings.relationSharingSwitcher.changes.setLimitToOne",defaultMessage:"<title>Limit to one page</title><description>Permissions can only be inherited from one related page. For existing pages that have more than one related page, only the first page will be kept.</description>"},twoWayRelation:{id:"collectionSettings.relationSharingSwitcher.changes.removeTwoWayRelation",defaultMessage:"<title>Remove the two-way relation</title><description>Only one-way relations are supported at this time.</description>"}}),disabledReasons:(0,m().YK)({hasAnotherSharingEnabledProperty:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.hasAnotherSharingEnabledProperty",defaultMessage:"Sharing is already enabled through another relation."},isSelfRelation:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.isSelfRelation",defaultMessage:"Can't change share settings for a self-relation."}})};var gt=()=>o(475598);function yt(e){const{collectionContextStore:t,property:o}=e,n=(0,i().v3)(),a=(0,r().K8)((()=>t.collectionStore()),[t]),c=(0,r().K8)((()=>Le().Jq(t,o)),[t,o]),d=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,he().k7)(e,c)}),[t,c]),p=Boolean(d&&(null==a?void 0:a.id)===d.id),m=(0,r().K8)((()=>{var e;return(0,Oe().Sf)({experimentService:Xe().default,actor:{table:u().oo,id:n.currentUser.id??""},spaceId:(null===(e=$e().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??""})}),[n.currentUser]),g=c&&(0,l().UU)(c)?c.connectedRelation:void 0,{isConnectedRelationDatabaseActionsSupported:y,connectedRelationPatternName:f,integrationId:h}=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o],n=null==e?void 0:e.name,i=(0,s().Dz)(e);return{isConnectedRelationDatabaseActionsSupported:(0,s().Mn)(i)&&Xe().default.checkGate({gateName:"connected_relations_database_actions_enabled"}),connectedRelationPatternName:n,integrationId:i}}),[t,o]);if(!d)return null;const S=c&&!(0,s().H6)(c)&&!(0,s().KF)(c)&&!(0,s().V5)(c);return(0,Z.jsxs)(Z.Fragment,{children:[S&&(0,Z.jsx)(gt().A,{isSelfRelation:p,collectionStore:d,showAs:"link",disabled:!0}),y&&f&&h&&(0,Z.jsx)(Ye,{collectionContextStore:t,property:o,connectedRelationPatternName:f,integrationId:h,propertySchema:c,environment:n}),S&&(0,Z.jsx)(De().Z,{collectionContextStore:t,propertySchema:c,property:o}),!Boolean(g)&&(0,Z.jsx)(Qe,{collectionContextStore:t,property:o,targetCollectionStore:d}),m&&c&&(0,l().nC)(c)&&(0,Z.jsx)(ut,{collectionContextStore:t,property:o,propertySchema:c})]})}var ft=()=>o(339189),ht=()=>o(378524),St=()=>o(724217),xt=()=>o(97787),vt=()=>o(356813),bt=()=>o(401382),Ct=()=>o(655830),At=()=>o(502852),jt=()=>o(752903),wt=()=>o(264898),Mt=()=>o(837809),_t=()=>o(749975);function Tt(e){var t;const o=(0,i().v3)(),l=(0,a().DP)(),{isMobile:s}=(0,i().Y0)(),{property:c,option:d,statusGroup:p,propertySchema:u,isDefault:g,disabled:y}=e,f=(0,_t().ET)(),h=(0,r().K8)((()=>{var e;return null===(e=f.collectionStore())||void 0===e?void 0:e.id}),[f]),S=(0,r().uB)(void 0,ue().A),x=(0,r().K8)((()=>S.state.open),[S]),v=(0,n.useCallback)((()=>{S.setState({open:!0})}),[S]),b=(0,n.useCallback)((()=>{S.setState({open:!1})}),[S]),C=(0,n.useCallback)((e=>{const t=f.collectionStore();t&&(0,I().p)({environment:o,collectionStore:t,performTransaction:o=>{for(const n of e)M().applyOperation({store:(0,ye().Oo)(t,n.pointer),operation:n,transaction:o})}})}),[f,o]),A=(0,a().IS)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return h?(0,Z.jsx)(wt().h,{open:x,origin:(0,Z.jsx)(z().A,{renderTooltip:e=>(0,Z.jsxs)("div",{...e,style:W().Q$,children:[(0,Z.jsx)("div",{children:d.value}),(0,Z.jsx)("div",{style:{color:l.text.contrastSecondary},children:d.description})]}),placement:pe().W.Left,disableTooltip:!(null!==(t=d.description)&&void 0!==t&&t.length),render:e=>{var t,o;return(0,Z.jsx)(ve().A,{...e,showDragHandle:!s,showChevron:!0,disabled:y,rotateChevron:x,title:"status"===u.type?(0,Z.jsx)(Mt().q,{format:s?jt().NY.Large:jt().NY.Medium,value:d.value,color:d.color,hideTooltip:Boolean(null===(t=d.description)||void 0===t?void 0:t.length),tooltipPlacement:pe().W.Left,showRemoveButton:!1,isSingle:!0,groupColor:null==p?void 0:p.color}):(0,Z.jsx)(Mt().O,{format:s?jt().NY.Large:jt().NY.Medium,value:d.value,color:d.color,hideTooltip:Boolean(null===(o=d.description)||void 0===o?void 0:o.length),tooltipPlacement:pe().W.Left,showRemoveButton:!1,isSingle:!0}),right:g?(0,Z.jsx)("span",{style:A.defaultText,children:(0,Z.jsx)(m().sA,{id:"database.statusProperty.default",defaultMessage:"Default"})}):void 0,onClick:v})}}),option:d,property:c,propertySchema:u,statusGroup:p,collectionId:h,analyticsFrom:"view_settings",alignmentToOrigin:pe().C.End,onChange:C,onClose:b}):null}const kt=o(129044).default.createClass(void 0,{name:"InputGroupIndexStore"});const It=function(e){let{collectionContextStore:t,property:o,disabled:a,aIAutofillOption:s}=e;const c=(0,i().v3)(),d=(0,r().uB)(void 0,kt),p=(0,$().X)("collections_status_missing_options_fix"),[u,g]=(0,n.useState)({inputValue:"",focus:!1}),y=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),f=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().app_config_uri}),[t]),h=(0,r().K8)((()=>Rt(t,o)),[t,o]),x=(0,r().O$)(d);if(!y||!h)return null;if("status"===h.type){const e=h.groups??[];if(0===e.length)return null;const n=h.options??[],i=e.map((e=>{const t=n.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}})),r=h.defaultOption,l=[...i[0].groupOptions.map((e=>e.value))];for(const{group:t,groupOptions:o}of i.slice(1))l.push({key:`group-header-${t.name}`,draggable:!1}),l.push(...o.map((e=>e.value)));const s=(0,_().s6)(f,y,o)?{tooltipCaption:(0,Z.jsx)(m().sA,{defaultMessage:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,S=(l,c)=>{if(l.startsWith("group-header-")){const e=l.substring(13),n=i.findIndex((t=>{let{group:o}=t;return o.name===e})),{group:r,groupOptions:c}=i[n];return(0,Z.jsxs)(Pt,{title:(0,Z.jsx)(St().RS,{disableGroup:s,group:r,showIcon:!1}),right:!u.focus&&(0,Z.jsx)(Bt,{collectionContextStore:t,property:o,onClick:e=>(0,At().SQ)({event:e,context:At().y$.CollectionSettingsClick,callback:()=>Dt(g,d,n)})}),disabled:a,children:[x===n&&(0,Z.jsx)(Ft,{collectionContextStore:t,property:o,input:u,setInput:g,inputGroupIndexStore:d}),!u.focus&&0===c.length&&(0,Z.jsx)(Vt,{setInput:g,inputGroupIndexStore:d,groupIndex:n})]})}{const t=n.find((e=>e.value===l));if(!t)return null;const i=e.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,Z.jsx)(Tt,{option:t,statusGroup:i,propertySchema:h,property:o,isDefault:t.value===r,disabled:a},t.value)}};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(Pt,{title:(0,Z.jsx)(St().RS,{disableGroup:s,group:i[0].group}),right:!u.focus&&(0,Z.jsx)(Bt,{collectionContextStore:t,property:o,onClick:e=>(0,At().SQ)({event:e,context:At().y$.CollectionSettingsClick,callback:()=>Dt(g,d,0)})}),disabled:a,children:[0===x&&(0,Z.jsx)(Ft,{collectionContextStore:t,property:o,input:u,setInput:g,inputGroupIndexStore:d}),!u.focus&&0===i[0].groupOptions.length&&(0,Z.jsx)(Vt,{setInput:g,inputGroupIndexStore:d,groupIndex:0})]}),(0,Z.jsx)(xt().Ay,{direction:"vertical",keys:l,renderKey:S,onDrop:e=>Kt(e,c,o,t,p),disabled:a})]})}{const e=h.options??[],n=e.map((e=>e.value)),i=h.auto_sort_options||"manual";return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(_e().A,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:i,options:[{key:"manual",type:"button",title:(0,Z.jsx)(m().sA,{defaultMessage:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",type:"button",title:(0,Z.jsx)(m().sA,{defaultMessage:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",type:"button",title:(0,Z.jsx)(m().sA,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:e=>function(e,t,o,n){const i=o.collectionStore(),r=o.normalizedSchemaStore.state,a=Rt(o,n);if(!i||!a)return;if(!(0,l().lx)(a))return;const s=[{pointer:i.pointer,command:"update",path:["schema",n],args:{auto_sort_options:e}}];"alphabetical"!==e&&"reverse_alphabetical"!==e||s.push(...(0,K().d4)({collectionId:i.id,property:n,propertySchema:a,schema:r,isAscending:"alphabetical"===e})||[]);(0,I().p)({environment:t,collectionStore:i,performTransaction:e=>{for(const t of s)M().applyOperation({store:(0,ye().Oo)(i,t.pointer),operation:t,transaction:e})}}),(0,S().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"select_change_auto_sort_options"})}(e,c,t,o),popupStyle:{minWidth:190}},"autoSortMenuItem"),s,(0,Z.jsxs)(Pt,{title:(0,Z.jsx)(m().sA,{defaultMessage:"Options",id:"database.viewSettings.selectOptions.title"}),right:!u.focus&&n.length>0&&(0,Z.jsx)(Bt,{collectionContextStore:t,property:o,onClick:e=>(0,At().SQ)({event:e,context:At().y$.CollectionSettingsClick,callback:()=>Dt(g,d)})}),disabled:a,children:[(0,Z.jsx)(Ft,{collectionContextStore:t,property:o,input:u,setInput:g,inputGroupIndexStore:d}),!u.focus&&0===n.length&&(0,Z.jsx)(Vt,{setInput:g,inputGroupIndexStore:d})]},"sectionHeader"),n.length>0&&(0,Z.jsx)(xt().Ay,{direction:"vertical",keys:n,renderKey:t=>{const n=e.find((e=>e.value===t));return n?(0,Z.jsx)(Tt,{option:n,property:o,propertySchema:h,isDefault:!1,statusGroup:void 0,disabled:a},n.value):null},onDrop:e=>Kt(e,c,o,t)})]})}};function Pt(e){let{title:t,right:o,children:n,disabled:i,overrideStyle:r}=e;const a=(0,U().Tf)()?{mobileStyle:{borderRadius:0},disableMobilePadding:!0,mobileTitleStyle:{paddingTop:12,paddingBottom:4,minHeight:44}}:{};return(0,Z.jsx)(L().A,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!i&&o,style:{width:"100%",paddingBottom:0,...r},...a,children:!i&&n})}function Rt(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&((0,l().lx)(o)||"status"===o.type))return o}function Bt(e){let{onClick:t,collectionContextStore:o,property:n}=e;const i=(0,m().tz)();return(0,r().K8)((()=>Rt(o,n)),[o,n])?(0,Z.jsx)(vt().A,{icon:ft().W,onClick:t,style:{width:20,height:20},ariaLabel:i.formatMessage({defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.addOption"})}):null}function Kt(e,t,o,n,i){const r=n.normalizedSchemaStore.state,a=n.collectionStore();a&&(ht().gc({newValues:e,property:o,schema:r,collectionStore:a,environment:t,isCollectionsStatusMissingOptionsFixEnabled:i}),(0,S().V)({environment:t,collectionContextStore:n,property:o,from:"view_settings",action:"select_options_reorder"}))}function Dt(e,t,o){e({focus:!0,inputValue:""}),void 0!==o&&t.setState(o)}function Ft(e){let{collectionContextStore:t,property:o,input:r,setInput:s,inputGroupIndexStore:c}=e;const d=(0,i().v3)(),p=(0,m().tz)(),u=(0,$().X)("collections_status_missing_options_fix"),g=(0,n.useCallback)((()=>function(e,t,o,n,i,r,a){const s=t.collectionStore(),c=Rt(t,o);if(!c||!s)return;const d=c.options||[],p=n.inputValue.trim();if(p)if("status"===c.type){const t=r.state;let n;if(void 0!==t&&(n=d.find((e=>{var o;return null===(o=c.groups)||void 0===o||null===(o=o[t].optionIds)||void 0===o?void 0:o.includes(e.id)}))),void 0===t||void 0!==n)ht().Uk({modification:{type:"keyedObjectListBefore",beforeOption:n,newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s,groupIndex:t,isCollectionsStatusMissingOptionsFixEnabled:a});else{let n;for(let e=t-1;e>=0;e--){var u;const t=null===(u=c.groups)||void 0===u?void 0:u[e];if(t&&(n=d.find((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})),void 0!==n))break}ht().Uk({modification:{type:"keyedObjectListAfter",afterOption:n,newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s,groupIndex:t,isCollectionsStatusMissingOptionsFixEnabled:a})}}else!(0,l().lx)(c)||"alphabetical"!==c.auto_sort_options&&"reverse_alphabetical"!==c.auto_sort_options?ht().Uk({modification:{type:"keyedObjectListBefore",newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s}):ht().Uk({modification:{type:"autoSortInsert",newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s});i({focus:!0,inputValue:""}),(0,S().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:"select_add_option",option_value_char_count:p.length})}(d,t,o,r,s,c,u)),[d,t,o,r,s,c,u]),y=(0,n.useCallback)((e=>function(e,t){t({focus:!0,inputValue:e.target.value.replace(/,/g,"")})}(e,s)),[s]),f=(0,n.useCallback)((()=>function(e,t,o){o({focus:!1,inputValue:e.device.isPhone?t.inputValue:""})}(d,r,s)),[d,r,s]),h=(0,de().a)(),x=(0,a().IS)((e=>({inputOuterStyle:h?{backgroundColor:e.white}:{},inputMenuItem:{marginTop:2,marginBottom:8}})),[h]);return r.focus?(0,Z.jsx)(Ct().A,{debugName:"CollectionSettingsSelectOptions",capture:!0,onEsc:f,children:(0,Z.jsx)(bt().Ay,{value:r.inputValue,focus:!0,placeholder:p.formatMessage({defaultMessage:"Type a new option…",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:x.inputMenuItem,inputOuterStyle:x.inputOuterStyle,onChange:y,onBlur:f,onSubmit:g,mobileKeyboardOnDismiss:g})}):null}function Vt(e){let{groupIndex:t,setInput:o,inputGroupIndexStore:n}=e;return(0,Z.jsx)(at().A,{icon:(0,ft().W)({width:14}),focused:!1,title:(0,Z.jsx)(m().sA,{defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:e=>(0,At().SQ)({event:e,context:At().y$.CollectionSettingsClick,callback:()=>Dt(o,n,t)})})}var Ot=()=>o(277993),Lt=()=>o(244812);const zt=(0,m().YK)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",defaultMessage:"Show as"},displayAsLabel:{id:"database.viewSettings.statusOptions.displayAs",defaultMessage:"Display as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",defaultMessage:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.selectOptionLabel",defaultMessage:"Select"}});function Ht(e){let{collectionContextStore:t,property:o,disabled:n}=e;const l=(0,i().v3)(),s=(0,$().X)("db_ux_properties"),c=(0,a().IS)((e=>({icon:{width:16,height:16,fill:e.mediumIconColor}})),[]),[d,p]=(0,r().K8)((()=>{var e;return[Nt(t,o),(null===(e=t.getPropertyFormat(o))||void 0===e?void 0:e.statusShowAs)??"select"]}),[t,o]);if(!d)return null;const u=[{key:"checkbox",type:"button",title:E().A.formatMessage(zt.statusCheckboxLabel),icon:(0,Ot().S)(c.icon)},{key:"select",type:"button",title:E().A.formatMessage(zt.statusSelectLabel),icon:(0,Lt().n)(c.icon)}];return(0,Z.jsx)(_e().A,{title:s?E().A.formatMessage(zt.displayAsLabel):E().A.formatMessage(zt.statusShowAsLabel),selectedKey:p,popupStyle:{minWidth:190},options:u,onChange:e=>function(e,t,o,n){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;M().createAndCommit({userAction:"CollectionSettingsStatusOptions.handleShowAsChange",environment:t,canUndo:!0,perform:t=>{b().a5({formatStore:i,formatKey:r,property:n,update:{statusShowAs:e,visible:!0},transaction:t})}}),(0,S().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"status_change_format"})}(e,l,t,o),disabled:n})}function Nt(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&"status"===o.type)return o}var Wt=()=>o(948120),qt=()=>o(372818);const Yt=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:l,formatKey:c,property:d,selectNameInitial:p,titleOverride:u}=e,[g,y]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),v=(0,i().v3)(),C=(0,n.useRef)(null),A=(0,m().tz)(),j=(0,a().DP)(),w=(0,$().X)("nds_default_property_noticon"),T=(0,$().X)("collection_settings_reorganization"),{collectionStore:k,isMultiSourceView:I}=(0,r().K8)((()=>({collectionStore:t.collectionStore(),isMultiSourceView:"collectionTypedView"===t.contextType})),[t]),P=(0,r().K8)((()=>t.normalizedSchemaStore.state),[t.normalizedSchemaStore]),{isTypedProperty:B,databaseType:K}=(0,r().K8)((()=>k?{isTypedProperty:k.isTypedProperty(d),databaseType:k.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[k,d]),D=(0,r().K8)((()=>(0,s()._g)({schema:P,property:d})),[d,P]),F=(0,r().K8)((()=>Xt({property:d,formatKey:c,collectionContextStore:t})),[t,c,d]),V=(0,r().K8)((()=>(0,N().fE)({property:d,collectionContextStore:t,newValue:h})),[t,h,d]),O=(0,r().K8)((()=>{var e;const n=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!n&&(0,o(520969).Nh)(n)}),[t]),z=(0,r().K8)((()=>Boolean(k&&K&&_().jP((0,o(414997).appConfigs)(),K,d,k))),[k,K,d]),H=(0,r().K8)((()=>{var e;const o=t.collectionViewStore();return!!o&&(Boolean((null===(e=Xt({property:d,formatKey:c,collectionContextStore:t}))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())}),[t,c,d]),q=(0,r().uB)(void 0,ue().A),Y=(0,de().a)();(0,n.useEffect)((()=>{!function(e,t,n){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const r=o(471745).A.findTableHeaderCell(t,e);if(!r)return;const a=r.getNode();if(!a||!n)return;const l=(0,o(96297).T8)(a);if(!l)return;const s=n.getBoundingClientRect(),c=a.getBoundingClientRect().right+20-s.left;l.scrollLeft=l.scrollLeft+c}(d,t,C.current),D&&x(D.name||"")}),[t,d,D]);const U=(0,n.useCallback)((e=>{(0,he().Fc)({collectionContextStore:t,environment:v,inputValue:h,name:e,property:d})}),[t,v,h,d]),G=(0,n.useCallback)((e=>{y(!g),e.stopPropagation()}),[g]),X=(0,n.useCallback)((e=>{!function(e){var t;const{description:o,environment:n,collectionContextStore:i,property:r}=e,a=i.collectionStore(),l=null==a||null===(t=a.getSchema())||void 0===t?void 0:t[r];if(!a||void 0===l||o===l.description)return;M().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:n,canUndo:!0,perform:e=>{(0,R().F)({environment:n,collectionStore:a,update:{[r]:{...l,description:o}},transaction:e})}}),(0,S().V)({environment:n,collectionContextStore:i,property:r,from:"view_properties",action:"set_description"})}({collectionContextStore:t,description:e,environment:v,property:d})}),[t,v,d]),J=(0,n.useCallback)((e=>{x(e)}),[]);if(!D)return null;const Q=!(0,s().di)(D),ee=I,te=I||(0,s().Jf)({property:d,propertySchema:D,isTypedProperty:B}),oe=D.description;return(0,Z.jsxs)(o(3364).Ay,{...e,title:u||(k?(0,Z.jsx)(m().sA,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,Z.jsx)(m().sA,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"})),footer:(0,Z.jsx)(So,{collectionContextStore:t,formatKey:c,property:d,collectionSettingsStore:l,wrapProperty:H,propertySchema:D,propertyFormat:F,isRequiredTypedProperty:z,databaseType:K}),ref:C,children:[(0,Z.jsxs)(L().A,{isInput:!0,style:Y?{margin:"0 2px"}:void 0,children:[(0,Z.jsx)(o(843180).B,{disabled:ee,initialValue:D.name||"",placeholder:E().A.formatMessage(Ve().A.inputPlaceholder),onBlur:U,onSubmit:U,focusInitial:p,selectAll:p,iconButton:{icon:e=>(0,Z.jsx)(o(916963).zB,{type:D.type,icon:D.icon,size:16,theme:j,style:e,isDefaultNoticonEnabled:w}),iconStyle:{fill:o(758989).l8[j.mode].gray},...Y?{backgroundColor:j.white}:void 0,enforceIconColor:"gray",onSubmit:e=>function(e,t,o,n){const i=o.collectionStore();if(!i)return;M().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyIconSubmit",environment:e,canUndo:!0,perform:e=>{b().yC({collectionStore:i,property:t,icon:n,transaction:e})}}),(0,S().V)({environment:e,collectionContextStore:o,property:t,icon:n,from:"view_settings",action:"change_icon"})}(v,d,t,e)},inputOuterStyle:Y?{backgroundColor:j.white}:void 0,inputRightButton:O?null:(0,Z.jsx)(o(35927).S,{description:oe,showTooltip:!g,onClick:G,addDescriptionText:A.formatMessage(W().Mo.addPropertyDescriptionTooltip),editDescriptionText:A.formatMessage(W().Mo.editPropertyDescriptionTooltip)}),onChange:J}),V&&(0,Z.jsx)(o(100688).A,{propertyName:h})]}),g&&(0,Z.jsx)(o(467233).y,{initialDescription:oe,handleSaveDescription:X}),(0,Z.jsxs)(L().A,{extraPadding:T,children:[Q&&(0,Z.jsx)(f().Dy,{disabled:te,isTypedProperty:B,collectionUri:K,collectionContextStore:t,formatKey:c,propertyTypeButtonPopupStore:q,property:d}),"button"===D.type&&(0,Z.jsx)(f().nR,{collectionSettingsStore:l,collectionContextStore:t,property:d,source:"collectionSettingsMenu"}),I?(0,Z.jsxs)(Z.Fragment,{children:["status"===D.type&&(0,Z.jsx)(Zt,{collectionSettingsStore:l,collectionContextStore:t,property:d}),("date"===D.type||"created_time"===D.type||"last_edited_time"===D.type)&&(0,Z.jsx)(eo,{collectionContextStore:t,property:d})]}):(0,Z.jsx)(xo,{collectionContextStore:t,property:d,propertySchema:D})]}),Y&&(0,Z.jsx)(re,{})]})}));function Et(e,t,o,n){const i=Xt({property:n,formatKey:o,collectionContextStore:t}),r=t.collectionViewStore(),a=t.normalizedFormatStore.state,l=(0,he().Jq)({collectionContextStore:t,property:n});if(!l)return;if(!(i&&r&&o&&l))return;const s=Gt({formatKey:o,collectionContextStore:t}).map((e=>e.property===i.property?{...i,visible:!i.visible}:e)),c={...a,[o]:s};M().createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,canUndo:!0,perform:a=>{(0,B().F)({collectionViewStore:r,update:{format:c},transaction:a});const l=Jt({property:n,formatKey:o,collectionContextStore:t});w().sp({environment:e,collectionContextStore:t,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:a,propertyAction:i.visible?"hide":"show"})}}),(0,x().X)({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:l.type})}async function Ut(e,t,o,n,i,r){await A().q({environment:e,collectionContextStore:o,property:n,handleDeleteAccept:()=>function(e,t,o,n,i){const r=o.normalizedSchemaStore.state,a=o.collectionStore(),l=(0,s()._g)({schema:r,property:t});l&&(a&&M().createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async n=>{await b().PF({environment:e,collectionStore:a,schema:r,property:t,transaction:n});const l=Jt({property:t,formatKey:i,collectionContextStore:o});w().sp({environment:e,collectionContextStore:o,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"delete"})}}),C().yl({collectionSettingsStore:n}),(0,x().X)({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==l?void 0:l.type}),(0,v().i)({environment:e,collectionContextStore:o,property_type:l.type,from:"view_settings",property:t}))}(e,n,o,i,r),theme:t,from:"view_settings"})}function Gt(e){const{formatKey:t,collectionContextStore:o}=e;if(!t)return[];var n;if("collection_page_properties"===t)return(null===(n=o.collectionStore())||void 0===n?void 0:n.getFormat().collection_page_properties)??[];return o.normalizedFormatStore.state[t]||[]}function $t(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function Xt(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Gt({formatKey:o,collectionContextStore:t});return null==i?void 0:i.find((e=>e.property===n))}function Jt(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Gt({formatKey:o,collectionContextStore:t});if(0===i.length)return-1;return i.filter((e=>e.visible)).findIndex((e=>e.property===n))}function Zt(e){let{collectionSettingsStore:t,collectionContextStore:o,property:n}=e;const i=(0,r().K8)((()=>{var e;return _().s6(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,n)}),[o,n]);return(0,Z.jsxs)(Z.Fragment,{children:[i?null:(0,Z.jsx)(Ht,{collectionContextStore:o,property:n,disabled:i}),(0,Z.jsx)(It,{collectionSettingsStore:t,collectionContextStore:o,property:n,disabled:i,aIAutofillOption:null})]})}function Qt(e){let{collectionContextStore:t,collectionSettingsStore:o,property:n}=e;return(0,Z.jsx)(be,{collectionContextStore:t,collectionSettingsStore:o,property:n})}function eo(e){let{collectionContextStore:t,property:o}=e;return(0,Z.jsx)(Te,{collectionContextStore:t,property:o})}function to(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,s().di)(e)}),[t,o])?(0,Z.jsx)(Be().A,{collectionContextStore:t,property:o}):(0,Z.jsx)(yt,{collectionContextStore:t,property:o}),i=(0,Z.jsx)(Ae().kM,{collectionContextStore:t,property:o});return(0,Z.jsxs)(Z.Fragment,{children:[n,i]})}function oo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&("number"===n.type||"formula"===n.type||"rollup"===n.type)?(0,Z.jsx)(Fe().$,{collectionContextStore:t,property:o}):null}function no(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>t.collectionStore()),[t]);return n&&"url"===n.type&&i?(0,Z.jsx)(qt().V,{collectionContextStore:t,property:o,propertySchema:n}):null}function io(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"person"===n.type?(0,Z.jsx)(Re,{collectionContextStore:t,propertySchema:n,property:o}):null}function ro(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"button"===n.type?(0,Z.jsx)(f().m4,{collectionContextStore:t,propertySchema:n,propertyId:o}):null}function ao(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]);return n?(0,Z.jsx)(De().Z,{collectionContextStore:t,propertySchema:n,property:o}):null}function lo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return n&&"auto_increment_id"===n.type?(0,Z.jsx)(Ce().A,{uniqueIdProperty:{propertyId:o,propertySchema:n},prefixValue:i,collectionContextStore:t}):null}function so(e){let{collectionContextStore:t,property:o}=e;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ao,{collectionContextStore:t,property:o}),(0,Z.jsx)(io,{collectionContextStore:t,property:o})]})}function co(e){const{environment:t,property:o,propertySchema:i,collectionSettingsStore:a,collectionContextStore:s,collectionStore:d}=e,p=(0,r().K8)((()=>(0,l().om)(i)),[i]),u=(0,r().K8)((()=>(0,Y().jq)(t,ge().A.getMode(t,d),d)),[t,d]),y=(0,n.useMemo)((()=>{const e=i.name.trim(),t=N().dC[i.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[i.name,i.type]),f=(0,n.useCallback)((()=>{if(!d||!i||!(0,l().lx)(i))return;const e=(0,l().RM)(i);if(!e)return;const n=[];if(p)h().Nj(t,{type:"remove_ai_inference",ai_inference_type:p.type,collection_id:d.id}),n.push({pointer:d.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:i.type,auto_update_on_edit:!1,add_options:!1};h().Nj(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:d.id}),n.push({pointer:d.pointer,command:"set",path:["schema",o,e],args:r})}(0,I().p)({environment:t,collectionStore:d,performTransaction:e=>{for(const t of n)M().applyOperation({store:(0,ye().Oo)(d,t.pointer),operation:t,transaction:e})}})}),[p,d,t,o,i]),S=(0,n.useCallback)((e=>{if(!i||!d||!(0,l().$M)(i))return;const n=(0,l().RM)(i);if(!n)return;const r={pointer:d.pointer,command:"set",path:["schema",o,n],args:e};(0,I().p)({environment:t,collectionStore:d,performTransaction:e=>{M().applyOperation({store:(0,ye().Oo)(d,r.pointer),operation:r,transaction:e})}})}),[d,t,o,i]),x=(0,r().K8)((()=>$t(s)),[s]);return(0,r().K8)((()=>u&&"form_editor"!==x),[u,x])?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Pt,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,Z.jsx)(z().A,{disableTooltip:!y,placement:pe().W.Left,renderTooltip:e=>(0,Z.jsx)(m().sA,{...e,defaultMessage:"Update the property name to use AI autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,Z.jsx)(Wt().A,{...e,title:(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,Z.jsx)(m().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,Z.jsx)(O().A,{style:{display:"inline-block"}})]}),showChevron:!1,switcherProps:{on:Boolean(p),noColor:!1},onClick:f,disabled:!u||y}),style:{whiteSpace:"break-spaces"}}),p&&!y&&("select"===p.type||"multi_select"===p.type)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(F().A,{setAiInference:S,aiInference:p,disabled:!u}),(0,Z.jsx)(ve().A,{title:(0,Z.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:g().Ay.uiGray},children:[(0,Z.jsx)(m().sA,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,c().V)({fill:g().Ay.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{C().a2({collectionSettingsStore:a,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}})]})]}):null}function po(e){const{environment:t,property:o,propertySchema:n,collectionContextStore:i,collectionStore:a}=e,s=(0,r().K8)((()=>null==a?void 0:a.getSpaceId()),[a]),c=(0,fe()._X)({name:"collection_property_autofill",spaceId:s,userId:t.currentUser.id,amount:"unknown"}),d=(0,r().K8)((()=>{const e=i.collectionStore();return e&&(0,Y().jq)(t,ge().A.getMode(t,e),e)}),[t,i]);return(0,r().K8)((()=>(0,l().lx)(n)&&n.select_ai_inference),[n])&&c?(0,Z.jsx)(D().Ve,{environment:t,collectionContextStore:i,collectionStore:a,property:o,propertySchema:n,autofillFeatureAvailability:c,isAutofillSetupEnabled:Boolean(d)}):null}function uo(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:n,property:a}=e;const l=(0,i().v3)(),s=(0,r().K8)((()=>n.collectionStore()),[n]);return s?(0,Z.jsx)(It,{collectionSettingsStore:o,collectionContextStore:n,property:a,disabled:!1,aIAutofillOption:(0,Z.jsx)(co,{environment:l,collectionStore:s,collectionSettingsStore:o,collectionContextStore:n,property:a,propertySchema:t})}):null}function mo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().O$)(t.normalizedSchemaStore)[o];let i;return i=(0,s().di)(n)?(0,Z.jsx)(Ke().A,{href:(0,G().xS)("guides.githubRelation"),title:(0,Z.jsx)(m().sA,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,Z.jsx)(Ke().A,{href:(0,G().xS)("guides.relations"),title:(0,Z.jsx)(m().sA,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,Z.jsx)(L().A,{topBorder:!0,children:i})}function go(e){let{collectionContextStore:t,property:o,collectionSettingsStore:n}=e;const i=(0,r().K8)((()=>(0,he().Jq)({collectionContextStore:t,property:o})),[t,o]),a=(0,r().K8)((()=>$t(t)),[t]),s=!(0,r().O$)(me().e);if(!i||"text"!==i.type||"form_editor"===a)return null;const c=(0,l().om)(i);let d;return c&&(0,l().UH)(c.type)?"summarize"===c.type?d=q().VT.autofillSummary:"extract"===c.type?d=q().VT.autofillExtract:"custom"===c.type?d=q().VT.autofillCustom:"translate"===c.type?d=q().VT.autofillTranslate:(0,y().HB)(c):d=Ve().A.autofillOffLabel,(0,Z.jsx)(ve().A,{title:(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,Z.jsx)(m().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,Z.jsx)(O().A,{style:{display:"inline-block"}})]}),showChevron:!0,right:E().A.formatMessage(d),onClick:()=>function(e,t,o){const n=(0,he().Jq)({collectionContextStore:t,property:o});t.collectionStore()&&n&&C().a2({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}(n,t,o),disabled:s})}function yo(e){let{property:t,collectionContextStore:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>o.collectionStore()),[o]),l=(0,r().K8)((()=>(0,N().Kc)(o)),[o]),s=(0,r().K8)((()=>Boolean((null==a?void 0:a.getDatabaseType())&&(null==a?void 0:a.isTypedProperty(t)))),[a,t]);return a?(0,Z.jsx)(H().A,{disabled:s,context:H().C.ViewSettings,property:t,schema:l,analyticsFrom:"view_settings",parentStore:a,onChange:e=>function(e,t,o,n){const i=n.collectionStore();i&&M().createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,canUndo:!0,perform:n=>{(0,R().F)({environment:t,collectionStore:i,update:{[o]:e.propertySchema},transaction:n})}})}(e,n,t,o)}):null}function fo(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:n,property:r,collectionSettingsStore:l,formatKey:s}=e;const c=(0,a().DP)(),u=(0,i().v3)();return(0,Z.jsx)(z().A,{disableTooltip:!t,placement:pe().W.Left,renderTooltip:e=>(0,T().eF)(o,e),render:e=>(0,Z.jsx)(ve().A,{...e,isRed:!0,disabled:t,onClick:()=>Ut(u,c,n,r,l,s),icon:()=>t?(0,Z.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,Z.jsx)(V().I,{icon:d().i})}):(0,Z.jsx)(V().I,{icon:p().trashIcon}),title:(0,Z.jsx)(m().sA,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:u.device.isMobile&&t?(0,T().eF)(o):null})})}function ho(e){let{}=e;return(0,Z.jsx)(Ke().A,{href:(0,G().xS)("guides.databaseProperties"),title:(0,Z.jsx)(m().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})}function So(e){let{propertySchema:t,propertyFormat:a,isRequiredTypedProperty:c,databaseType:d,collectionContextStore:p,formatKey:g,property:f,collectionSettingsStore:h,wrapProperty:S}=e;const v=(0,i().v3)(),b=(0,U().Tf)(),A=(0,n.useCallback)((()=>function(e,t,o,n,i){const r=Xt({property:n,formatKey:o,collectionContextStore:t}),a=t.collectionViewStore(),l=t.normalizedFormatStore.state,s=(0,he().Jq)({collectionContextStore:t,property:n});s&&r&&a&&o&&s&&(w().Nv({currentValue:i,environment:e,property:n,collectionViewStore:a,format:l,formatKey:o}),(0,x().X)({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:a.getType(),property_type:s.type}))}(v,p,g,f,S)),[v,p,g,f,S]),_=(0,r().K8)((()=>p.collectionStore()),[p]),T=(0,r().K8)((()=>$t(p)),[p]),I=(0,de().a)(),R=(0,$().X)("db_ux_customize_views"),B=(0,$().X)("collection_settings_reorganization"),D=(0,r().K8)((()=>!B&&g&&("title"!==f||(0,K().O)({viewType:T,format:p.normalizedFormatStore.state}))&&"page"!==T),[g,f,T,p,B]),F=(0,r().K8)((()=>(!B||!R)&&(g&&(0,K().hc)({viewType:T,property:f}))),[g,f,T,B,R]),V=(0,r().K8)((()=>h.state.hideDuplicatePropertyOption),[h]),O=(0,l().vB)(t)&&Boolean(_)&&!I&&"form_editor"!==T&&!V,z=l().cN.includes(t.type)&&_&&!I&&"form_editor"!==T,H="form_editor"===T;return F||O||z||H?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(L().A,{topBorder:!0,disableMobilePadding:!b,extraPadding:B,children:[F&&a&&(0,Z.jsx)(Wt().A,{icon:o(997353).o,title:(0,Z.jsx)(m().sA,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:S,disallowTabbing:!0},onClick:A}),_&&(0,Z.jsx)(po,{environment:v,collectionStore:_,collectionContextStore:p,property:f,propertySchema:t}),D&&a&&(null!=a&&a.visible?(0,Z.jsx)(ve().A,{icon:o(99949).e,title:(0,Z.jsx)(m().sA,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>Et(v,p,g,f)}):(0,Z.jsx)(ve().A,{icon:o(434626).eyeIcon,title:(0,Z.jsx)(m().sA,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>Et(v,p,g,f)})),O&&(0,Z.jsx)(ve().A,{icon:o(507190).V,title:(0,Z.jsx)(m().sA,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,n,i){const r=Gt({formatKey:i,collectionContextStore:o}),a=o.normalizedSchemaStore.state,l=o.collectionStore(),c=null==l?void 0:l.getSpaceId();if(!l||!c)return;const d=(0,s()._g)({schema:a,property:t});if(!d)return;const p=l.getNormalizedPropertyGroups(),m=await(0,K().W4)({environment:e,schema:a,property:t,properties:r,propertyGroups:p,parentStore:l,spaceId:c});if(!m)return;const g=e.currentUser.id,f=g?{id:g,table:u().oo}:void 0,h=o.collectionViewStore();M().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,canUndo:!0,perform:n=>{(0,y().O9)(m.automationUpdate)&&k().duplicateAutomation({actorPointer:f,environment:e,sourceAutomationStore:m.automationUpdate.sourceAutomationStore,targetAutomationId:m.automationUpdate.targetAutomationId,transaction:n});const r={...a,[m.newProperty]:m.newPropertySchema},s={...l.getFormat(),collection_page_properties:m.newProperties,property_groups:m.newPropertyGroups};(0,P().I)({environment:e,collectionStore:l,update:{schema:r,format:s},transaction:n});const c=Jt({property:t,formatKey:i,collectionContextStore:o});w().sp({environment:e,collectionContextStore:o,currentIndex:c,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"duplicate"}),i&&h&&j().zA({stores:[h],update:{[i]:m.newProperties},transaction:n})}}),C().os({collectionSettingsStore:n}),(0,x().X)({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==h?void 0:h.getType(),property_type:d.type})}(v,f,p,h,g)}),z&&(0,Z.jsx)(fo,{collectionContextStore:p,property:f,collectionSettingsStore:h,formatKey:g,isRequiredTypedProperty:c,databaseType:d}),H&&(0,Z.jsx)(ho,{})]}),"formula"===t.type&&(0,Z.jsx)(L().A,{topBorder:!0,children:(0,Z.jsx)(Ke().A,{href:(0,G().xS)("guides.formulas"),title:(0,Z.jsx)(m().sA,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,Z.jsx)(mo,{collectionContextStore:p,property:f}),"rollup"===t.type&&(0,Z.jsx)(L().A,{topBorder:!0,children:(0,Z.jsx)(Ke().A,{href:(0,G().xS)("guides.relations"),title:(0,Z.jsx)(m().sA,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]}):null}function xo(e){let{property:t,propertySchema:o,collectionContextStore:a}=e;const s=(0,i().v3)(),c=a.settingsStore,d=(0,r().K8)((()=>(0,Y().O0)(s)),[s]);return(0,n.useMemo)((()=>"button"===o.type),[o.type])?null:(0,Z.jsxs)(Z.Fragment,{children:[d&&"text"===o.type&&(0,Z.jsx)(go,{collectionContextStore:a,property:t,collectionSettingsStore:c}),(0,l().lx)(o)&&(0,Z.jsx)(uo,{collectionSettingsStore:c,collectionContextStore:a,property:t,propertySchema:o}),"status"===o.type&&(0,Z.jsx)(Zt,{collectionSettingsStore:c,collectionContextStore:a,property:t}),"formula"===o.type&&(0,Z.jsx)(Qt,{collectionContextStore:a,collectionSettingsStore:c,property:t}),"rollup"===o.type&&(0,Z.jsx)(yo,{property:t,collectionContextStore:a}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,Z.jsx)(eo,{collectionContextStore:a,property:t}),"relation"===o.type&&(0,Z.jsx)(to,{collectionContextStore:a,property:t}),"person"===o.type&&(0,Z.jsx)(so,{collectionContextStore:a,property:t}),(0,Z.jsx)(oo,{collectionContextStore:a,property:t}),(0,Z.jsx)(no,{collectionContextStore:a,property:t}),"auto_increment_id"===o.type&&(0,Z.jsx)(lo,{collectionContextStore:a,property:t}),"button"===o.type&&(0,Z.jsx)(ro,{collectionContextStore:a,property:t})]})}},740645:(e,t,o)=>{o.r(t),o.d(t,{TableHeaderCellMenu:()=>$,getIsAutofillCurrentlyRunning:()=>G});o(362833),o(725707),o(500234),o(403517);var n=o(242343),i=()=>o(237385),r=()=>o(803290),a=()=>o(564134),l=()=>o(716605),s=()=>o(680369),c=o(163643);const d={viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"M16.975 3.525c.345 0 .625.28.625.625v11.7a.625.625 0 1 1-1.25 0V4.15c0-.345.28-.625.625-.625M9.658 5.158a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884l-4.4 4.4a.625.625 0 1 1-.884-.884l3.333-3.333H3.025a.625.625 0 1 1 0-1.25h9.966L9.658 6.042a.625.625 0 0 1 0-.884"})},p=(0,s().wt)("arrowLineRight",d);var u=()=>o(555296);const m={viewBox:"0 0 20 20",svg:(0,c.jsx)("path",{d:"m4.897 3.085-.122-.142a.625.625 0 0 0-.95.814l3.56 4.152-.013.131a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08h1.453l2.941 3.432a.625.625 0 0 0 1.042-.67L4.989 3.228a.6.6 0 0 1-.093-.144m3.258 6.007a.6.6 0 0 0 .169-.088l2.889 3.371H5.625v-.006c0-1.447.922-2.733 2.293-3.197zm7.259 4.379a.62.62 0 0 0 .212-.47v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625H6.653a.62.62 0 0 0-.516.272l1.216 1.419a2.4 2.4 0 0 1-.07-.441h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.291 3.084z"})},g=(0,s().wt)("pinSlash",m);var y=()=>o(954397),f=()=>o(409211),h=()=>o(653998),S=()=>o(975392),x=()=>o(76394),v=()=>o(32901),b=()=>o(696987),C=()=>o(236339),A=()=>o(786944),j=()=>o(154956),w=()=>o(521325),M=()=>o(196916),_=()=>o(84543),T=()=>o(261603),k=()=>o(246545),I=()=>o(89335),P=()=>o(542004),R=()=>o(535906),B=()=>o(935091),K=()=>o(858023),D=()=>o(397791),F=()=>o(88271),V=()=>o(103151),O=()=>o(350208),L=()=>o(663073),z=()=>o(88442),H=()=>o(640979),N=()=>o(906230),W=()=>o(622286),q=()=>o(907721),Y=()=>o(802955);function E(e){const{menuListProps:t,menuListParent:a,property:l,propertySchema:s,collectionContextStore:d}=e,{isMobile:p}=(0,i().Y0)(),m=d.settingsStore,{disabled:g,icon:f,tooltipMessage:S}=function(e){let{propertySchema:t,collectionContextStore:o}=e;const n=(0,r().O$)(o.permissionScopesStore),i=!(0,r().O$)(Y().e)&&(0,k().$S)({propertyType:t.type,propertySchema:t}),a=!n.canConfigureCollection||i,l=n.canConfigureCollection?(0,c.jsx)(D().I,{icon:y().slidersIcon}):(0,c.jsx)(D().I,{icon:u().h}),s=i?(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"}):(0,c.jsx)(h().sA,{defaultMessage:"You don’t have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"});return{disabled:a,icon:l,tooltipMessage:s}}({propertySchema:s,collectionContextStore:d}),x=(0,n.useMemo)((()=>{if(g)return(0,c.jsx)(V().A,{placement:q().W.Left,render:e=>(0,c.jsx)(R().A,{disabled:!0,disabledFeedback:!0,title:(0,c.jsx)(h().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:f,...(0,N().A)(t,e)}),renderTooltip:()=>S});switch(s.type){case"url":return(0,c.jsx)(o(372818).V,{collectionContextStore:d,property:l,propertySchema:s});case"button":return(0,c.jsx)(T().nR,{collectionSettingsStore:m,collectionContextStore:d,property:l,source:"tableHeaderMenu"});default:return(0,c.jsx)(O().A,{...t,disableDefaultClick:!0,alignmentToOrigin:q().C.Start,renderOrigin:(e,t)=>(0,c.jsx)(R().A,{...e,ref:t,title:(0,c.jsx)(h().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,c.jsx)(D().I,{icon:y().slidersIcon})}),renderExtension:()=>{const e=p?{menuType:H().gu.Modal}:{menuType:H().gu.Popup,width:250},t=[{key:"property-settings",render:e=>(0,c.jsx)(o(542606).l,{property:l,propertySchema:s,collectionContextStore:d}),action:()=>{}}];return(0,c.jsx)(B().A,{...e,children:(0,c.jsx)(K().Ay,{type:K().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,c.jsx)(F().A,{...e}),items:t}],onAccept:()=>{}})})},onFocus:a.onFocus})}}),[d,p,m,a,t,l,s,g,f,S]);return x}function U(e){const{property:t,propertySchema:a,extensionPopupButtonEvents:l,parent:s}=e,{isMobile:d}=(0,i().Y0)(),p=(0,h().tz)(),u=(0,o(749975).ET)(),m=(0,i().v3)(),g=(0,r().K8)((()=>u.collectionStore()),[u]),y=(0,n.useCallback)((e=>{g&&_().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:m,canUndo:!0,perform:o=>{j().Hj({environment:m,collectionStore:g,property:t,type:e,transaction:o})}})}),[g,m,t]),f=(0,k().Re)({environment:m,collectionContextStore:u,propertySchema:a,onAccept:y,intl:p,section:["basic","metadata"]});let S;return S=d?{menuType:H().gu.ActionSheet}:{menuType:H().gu.Popup,width:200,height:350},(0,c.jsx)(B().A,{...S,...l,children:(0,c.jsx)(K().Ay,{type:K().Oh.Vertical,initialFocus:0,sections:[{key:"standard",render:e=>(0,c.jsx)(F().A,{...e}),items:Object.values(f)}],onAccept:s.close})})}function G(e){const{taskRunningState:t}=e;switch(t.status){case"requested":return!0;case"running":return t.numPagesFilled<t.numPagesRequested;case"error":case"notRunning":return!1;default:(0,x().HB)(t)}}const $=n.memo((function(e){const{allowHidingTitle:t,collectionContextStore:s,columnIndex:d,format:m,formatKey:$,parent:Q,property:ee,schema:te}=e,oe=(0,h().tz)(),ne=(0,i().v3)(),{isPhone:ie,isMobile:re}=(0,i().Y0)(),ae=(0,W().X)("db_ux_empty_states"),le=(0,W().X)("db_ux_properties"),se=(0,W().X)("nds_default_property_noticon"),ce=(0,o(174114).DP)(),{collectionStore:de,collectionViewStore:pe,collectionSettingsStore:ue,query:me,isNonEditableState:ge,collectionStoreFormat:ye}=(0,r().K8)((()=>{const e=s.collectionStore(),t=s.collectionViewStore(),o=s.settingsStore,n=s.normalizedQueryStore.state,i=null==e?void 0:e.isNonEditableState(),r=null==e?void 0:e.getFormat();return{collectionStore:e,collectionViewStore:t,collectionSettingsStore:o,query:n,isNonEditableState:i,collectionStoreFormat:r}}),[s]),fe=(0,r().O$)(s.permissionScopesStore),he=(0,r().O$)(s.isInHomeWidgetStore),Se=(0,r().K8)((()=>null==pe?void 0:pe.getType()),[pe]),xe=(0,r().K8)((()=>"collectionTypedView"===s.contextType),[s]),ve=!(0,r().O$)(Y().e),be=(0,r().K8)((()=>{const{frozenIndex:e}=s.frozoneStore.state;return Boolean(d===e)}),[s,d]),Ce=(0,r().K8)((()=>{const{frozenIndex:e,scrollerWidth:t}=s.frozoneStore.state;if(void 0===e)return!1;const o=(null==pe?void 0:pe.getTableMaxFrozenColumnIndex(t,s.normalizedFormatStore.state))??-1;return d>o}),[s,pe,d]),Ae=(0,r().K8)((()=>{var e;return!(!pe||"timeline"===Se)&&Boolean(pe.getFormat().table_wrap||(null===(e=J({format:m,formatKey:$,property:ee}))||void 0===e?void 0:e.wrap))}),[pe,m,$,ee,Se]),je=(0,n.useMemo)((()=>o(810111).Ts(ye,ee)),[ye,ee]),we=(0,r().K8)((()=>null==de?void 0:de.getSpaceId()),[de]),Me=(0,o(133926)._X)({name:"collection_property_autofill",spaceId:we,userId:ne.currentUser.id,amount:"unknown"}),_e=(0,r().K8)((()=>!de||(!!ve||(!(0,z().jq)(ne,o(795756).A.getMode(ne,de),de)||!!je&&G({taskRunningState:je})))),[de,ne,je,ve]),Te=(0,r().K8)((()=>(0,z().O0)(ne)),[ne]),{isTypedProperty:ke,databaseType:Ie}=(0,r().K8)((()=>de?{isTypedProperty:de.isTypedProperty(ee),databaseType:de.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[de,ee]),Pe=(0,r().uB)(void 0,o(962373).A),Re=(0,r().K8)((()=>{const e=te[ee];return o(755786).pg(s,e)}),[s,ee,te]),[Be,Ke]=(0,n.useState)(!1),[De,Fe]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=te[ee];e&&Fe(e.name||"")}),[ee,te]),(0,n.useEffect)((()=>{const e=te[ee];e&&"relation"===e.type&&(null==Re||Re.load())}),[ee,te,Re]);const Ve=(0,n.useCallback)((e=>{!function(e){const{collectionContextStore:t,environment:o,inputValue:n,name:i,property:r,schema:a}=e;if(Z({property:r,schema:a,inputValue:n}))return;const l=t.collectionStore();if(!l)return;const s=l.getSchema(),c=s[r];if((null==c?void 0:c.name)===i)return;_().createAndCommit({userAction:"TableHeaderCell.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{j().YO({collectionStore:l,property:r,name:i,transaction:e})}}),(0,b().V)({environment:o,collectionContextStore:t,property:r,from:"view_settings",action:"rename"})}({collectionContextStore:s,environment:ne,inputValue:De,name:e,property:ee,schema:te})}),[s,ne,De,ee,te]),Oe=(0,n.useCallback)((e=>{Fe(e)}),[]),Le=(0,r().K8)((()=>{const e=te[ee];if(!pe||!e)return[];const n=(0,o(594876).u)(ee),i="title"===e.type,r=ve&&(0,k().$S)({propertyType:e.type,propertySchema:e}),z=[];if(n&&"person"===e.type){const t=[];z.push(t),t.push({key:"synced_person",render:t=>(0,c.jsx)(o(932322).Ay,{...t,title:e.name||"",icon:(0,c.jsx)(D().I,{icon:o(213255).A}),caption:(0,c.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minWidth:300,maxWidth:350},children:(0,c.jsx)(h().sA,{defaultMessage:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.jsx)(o(611824).A,{href:(0,o(392608).xS)("guides.syncedContent"),children:t})}}})})}),action:()=>{}})}const W=[];z.push(W),!fe.canConfigureCollection||n||fe.isExternallyImportedAndSyncedCollection||(W.push({key:"rename",render:t=>(0,c.jsx)("div",{style:re?{}:{paddingTop:4},children:(0,c.jsx)(o(843180).B,{...t,initialValue:e.name||"",placeholder:o(477784).A.formatMessage(o(853100).A.inputPlaceholder),focusInitial:!re,onChange:Oe,onBlur:Ve,onSubmit:Ve,iconButton:{icon:t=>(0,c.jsx)(o(916963).zB,{type:e.type,icon:e.icon,size:16,theme:ce,style:t,isDefaultNoticonEnabled:se}),iconStyle:{fill:o(758989).l8[ce.mode].gray},enforceIconColor:"gray",onSubmit:(e,t)=>function(e,t,o,n,i){const r=t.collectionStore();if(!r)return;_().createAndCommit({userAction:"TableHeaderCell.handlePropertyIconSubmit",environment:o,canUndo:!0,perform:t=>{j().yC({collectionStore:r,property:e,icon:n,transaction:t})}}),(0,b().V)({environment:o,collectionContextStore:t,property:e,icon:n,from:"table",action:"change_icon"})}(ee,s,ne,e)},inputRightButton:(0,c.jsx)(o(35927).S,{description:e.description,showTooltip:!Be,onClick:()=>Ke(!Be),addDescriptionText:oe.formatMessage(L().Mo.addPropertyDescriptionTooltip),editDescriptionText:oe.formatMessage(L().Mo.editPropertyDescriptionTooltip)})})}),action:()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_rename"}),(0,I().j)({collectionContextStore:s,environment:ne,fit:"settings"}),Q.close()}}),Be&&W.push({key:"description",render:t=>(0,c.jsx)(o(467233).y,{...t,initialDescription:e.description,handleSaveDescription:e=>function(e){var t;const{collectionContextStore:n,description:i,environment:r,property:a}=e,l=n.collectionStore(),s=null==l||null===(t=l.getSchema())||void 0===t?void 0:t[a];if(!l||void 0===s||i===s.description)return;_().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:r,canUndo:!0,perform:e=>{(0,o(745859).F)({environment:r,collectionStore:l,update:{[a]:{...s,description:i}},transaction:e})}}),(0,b().V)({environment:r,collectionContextStore:n,property:a,from:"view_properties",action:"set_description"})}({collectionContextStore:s,description:e,environment:ne,property:ee}),disableAutoSection:!0}),action:S().lQ}),Z({property:ee,schema:te,inputValue:De})&&W.push({key:"duplicate_error",render:e=>(0,c.jsx)(o(100688).A,{...e,propertyName:De,styles:re?{paddingBottom:5,paddingLeft:16,paddingRight:16,margin:0,boxShadow:`inset 0 -1px 0 ${ce.regularDividerColor}`}:{}}),action:S().lQ}));const Y=[];z.push(Y);if((0,o(755989).kg)(e)&&Y.push({key:"connected_property_upsell",render:()=>(0,c.jsx)(o(475105).kM,{collectionContextStore:s,property:ee,compact:!0}),action:()=>{Q.close()}}),fe.canConfigureBlock&&!n&&!ge&&!fe.isExternallyImportedAndSyncedCollection)if((0,a().nu)(e)&&!le){const t=xe||(0,l().Jf)({property:ee,propertySchema:e,isTypedProperty:ke});Y.push({key:"button_property_change_type",render:e=>(0,c.jsx)(V().A,{placement:q().W.Left,render:o=>(0,c.jsx)("div",{...(0,N().A)(e,o),role:"button",children:(0,c.jsx)(T().Dy,{disabled:t,isTypedProperty:ke,collectionUri:Ie,collectionContextStore:s,formatKey:$,propertyTypeButtonPopupStore:Pe,property:ee})}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,c.jsx)(h().sA,{defaultMessage:"Change property type",id:"database.tableHeaderCell.buttonPropertyChangeTypeTooltip"})}),action:()=>{Q.close()}}),Y.push({key:"button_property_edit_automation",render:e=>(0,c.jsx)(V().A,{placement:q().W.Left,render:t=>(0,c.jsx)(R().A,{title:(0,c.jsx)(h().sA,{defaultMessage:"Edit automation",id:"database.tableHeaderCell.buttonPropertyEditAutomationLeft"}),right:(0,c.jsx)(D().I,{icon:o(650199).x,size:"sm",color:"secondary"}),disabled:ve,disabledFeedback:!0,...(0,N().A)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>ve?(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.buttonPropertyEditAutomation.offlineTooltip",defaultMessage:"Go online to edit automation"}):(0,c.jsx)(h().sA,{defaultMessage:"Edit button automation",id:"database.tableHeaderCell.buttonPropertyTooltip"})}),action:()=>{Q.close(),o(165601).h({environment:ne,mode:"edit_button_property",collectionSettingsStore:ue,collectionContextStore:s,propertyId:ee,propertySchema:e})}})}else{if(le)(0,l().HB)(e)&&Y.push({key:"edit_property",render:(t,o)=>(0,c.jsx)(E,{menuListProps:t,menuListParent:o,property:ee,propertySchema:e,collectionContextStore:s}),action:()=>{}});else{const e=!fe.canConfigureCollection||r;Y.push({key:"edit_property",render:t=>(0,c.jsx)(V().A,{placement:q().W.Left,render:o=>(0,c.jsx)(R().A,{title:(0,c.jsx)(h().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:fe.canConfigureCollection?(0,c.jsx)(D().I,{icon:y().slidersIcon}):(0,c.jsx)(D().I,{icon:u().h}),disabled:e,disabledFeedback:!0,...(0,N().A)(t,o)}),style:{whiteSpace:"normal"},renderTooltip:()=>r?(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"}):fe.canConfigureCollection?(0,c.jsx)(h().sA,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"}):(0,c.jsx)(h().sA,{defaultMessage:"You don’t have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"})}),action:()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_edit"}),(0,I().j)({collectionContextStore:s,environment:ne,fit:"settings"}),Q.close(),w().Ow({collectionContextStore:s,collectionSettingsStore:ue,initialStack:[{type:"properties",timelineViewTab:"table"},{type:"property",formatKey:$,property:ee}]})}})}const t=xe||(0,l().Jf)({property:ee,propertySchema:e,isTypedProperty:ke});!le||!fe.canConfigureCollection||n||ge||fe.isExternallyImportedAndSyncedCollection||t||Y.push({key:"change_property_type",render:(t,n)=>(0,c.jsx)(O().A,{...t,renderOrigin:(e,t)=>(0,c.jsx)(R().A,{...e,ref:t,title:(0,c.jsx)(h().sA,{defaultMessage:"Change type",id:"database.tableHeaderCell.changePropertyType"}),icon:(0,c.jsx)(D().I,{icon:o(284703).arrowSquarePathUpDownIcon})}),renderExtension:t=>(0,c.jsx)(U,{property:ee,propertySchema:e,extensionPopupButtonEvents:t,parent:Q}),onFocus:n.onFocus}),action:()=>{Q.close()}})}if(fe.canConfigureCollection&&!n&&!fe.isExternallyImportedAndSyncedCollection&&de&&je&&Te&&(0,a().$M)(e)){const t=(0,a().om)(e),n=G({taskRunningState:je});t?Y.push({key:"fill_all_pages",render:t=>(0,c.jsx)(V().A,{placement:q().W.Left,renderTooltip:()=>ve?(0,c.jsx)(h().sA,{...v().AY.aiUnavailableOfflineTooltip}):(0,c.jsx)(P().GI,{collectionStore:de,propertySchema:e,autofillFeatureAvailability:Me}),render:e=>(0,c.jsx)(R().A,{titleStyle:{color:_e?ce.text.tertiary:void 0},disabled:_e,icon:(0,c.jsx)(P().am,{updateAiInferencesTaskStatus:je,progressIconStyle:{marginTop:1,marginLeft:0,marginRight:-3}}),title:(0,c.jsx)(P().Ay,{updateAiInferencesTaskStatus:je}),caption:n&&"requested"!==je.status&&(0,c.jsx)(P().jD,{updateAiInferencesTaskStatus:je}),...(0,N().A)(t,e)})}),action:async()=>{await o(900135).autofillPropertyForCollection({environment:ne,collectionStore:de,propertySchema:e,property:ee,collectionViewStore:pe})}}):Y.push({key:"autofill_with_ai",render:e=>(0,c.jsx)(V().A,{placement:q().W.Left,renderTooltip:()=>{if(ve)return(0,c.jsx)(h().sA,{...v().AY.aiUnavailableOfflineTooltip})},disableTooltip:!ve,render:t=>(0,c.jsx)(R().A,{disabled:void 0===de||ve,disabledFeedback:void 0===de||ve,title:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)(h().sA,{defaultMessage:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"}),(0,c.jsx)(o(402557).A,{style:{display:"inline-block"}})]}),icon:(0,c.jsx)(D().I,{icon:o(182658).magicWandIcon,color:"purplePrimary"}),...e,...t})}),action:()=>{de&&(Q.close(),w().Ow({collectionContextStore:s,collectionSettingsStore:ue}),w().a2({collectionSettingsStore:ue,item:{type:"properties",timelineViewTab:"table"}}),w().a2({collectionSettingsStore:ue,item:{type:"property",formatKey:$,property:ee}}),"text"===e.type&&w().a2({collectionSettingsStore:ue,item:{type:"propertyAiAutofill",propertySchema:e,property:ee}}))}})}const ye=[];if(z.push(ye),fe.canConfigureBlock&&((0,l().oH)(e)||(0,l().ah)(e))){(0,l().ah)(e)&&ye.push({key:"filter",render:e=>(0,c.jsx)(R().A,{...e,title:(0,c.jsx)(h().sA,{defaultMessage:"Filter",id:"database.tableHeaderCell.filter"}),icon:(0,c.jsx)(D().I,{icon:o(418077).S})}),action:()=>{"collectionSystemView"!==s.contextType&&((0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_filter"}),Q.close(),function(e){const{collectionContextStore:t,environment:o,property:n,schema:i}=e,r=A().m({property:n,collectionContextStore:t,environment:o,schema:i});if(!r)return;const a=t.isInHomeWidgetStore.state;if(a)return void w().R8({collectionSettingsStore:t.settingsStore,item:{type:"filters"}});t.filtersBarOpenStore.setState(!0);const l=t.getFilterBarItemSettingsStore(r);w().R8({collectionSettingsStore:l,item:{type:"filter"}}),(0,I().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}({collectionContextStore:s,environment:ne,property:ee,schema:te}))}});const t={key:"sort_asc",render:e=>(0,c.jsx)(R().A,{...e,title:(0,c.jsx)(h().sA,{defaultMessage:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:(0,c.jsx)(D().I,{icon:o(236089).s})}),action:()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_sort_asc"}),Q.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:i}=e;X({collectionContextStore:o,environment:i,isAscending:!0,property:t,schema:n})}({collectionContextStore:s,environment:ne,property:ee,schema:te})}},n={key:"sort_desc",render:e=>(0,c.jsx)(R().A,{...e,title:(0,c.jsx)(h().sA,{defaultMessage:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:(0,c.jsx)(D().I,{icon:o(715768).v})}),action:()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_sort_desc"}),Q.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:i}=e;X({collectionContextStore:o,environment:i,isAscending:!1,property:t,schema:n})}({collectionContextStore:s,environment:ne,property:ee,schema:te})}};(0,l().oH)(e)&&(le?ye.push({key:"sort",render:(e,i)=>(0,c.jsx)(O().A,{...e,renderOrigin:(e,t)=>(0,c.jsx)(R().A,{...e,ref:t,title:(0,c.jsx)(h().sA,{defaultMessage:"Sort",id:"database.tableHeaderCell.sort"}),icon:(0,c.jsx)(D().I,{icon:o(17127).C})}),renderExtension:e=>{let o;return o=ne.device.isMobile?{menuType:H().gu.ActionSheet}:{menuType:H().gu.Popup,width:200},(0,c.jsx)(B().A,{...o,...e,children:(0,c.jsx)(K().Ay,{type:K().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,c.jsx)(F().A,{...e}),items:[t,n]}],onAccept:Q.close})})},onFocus:i.onFocus}),action:()=>{}}):(ye.push(t),ye.push(n))),ae&&me&&ye.push({key:"calculate",render:(e,t)=>(0,c.jsx)(O().A,{...e,renderOrigin:(e,t)=>(0,c.jsx)(V().A,{placement:q().W.Left,disableTooltip:!ve,renderTooltip:()=>(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.calculate.offlineTooltip",defaultMessage:"Unavailable while offline"}),render:n=>(0,c.jsx)(R().A,{...(0,N().A)(n,e),ref:t,title:(0,c.jsx)(h().sA,{defaultMessage:"Calculate",id:"database.tableHeaderCell.calculate"}),icon:(0,c.jsx)(D().I,{icon:o(642053).K}),disabled:ve,disabledFeedback:!0})}),renderExtension:(e,t)=>{var n;return ve?null:(0,c.jsx)(o(808532).A,{property:ee,schema:te,currentAggregation:null===(n=me.aggregations)||void 0===n?void 0:n.find((e=>e.property===ee)),onChange:(e,t)=>{const n=e?{aggregator:e,property:ee,enforceMaxAggregationLimit:t}:void 0;(0,o(68486).I)({collectionContextStore:s,environment:ne,query:me,property:ee,newAggregation:n})},onClose:Q.close,source:"tableAggregation"})},onFocus:t.onFocus}),action:()=>{}})}!fe.canConfigureBlock||he||ie||ye.push({key:"freeze_column",render:e=>(0,c.jsx)(V().A,{placement:q().W.Left,disableTooltip:!Ce,renderTooltip:e=>(0,c.jsx)(h().sA,{...e,defaultMessage:"Insufficient space to freeze columns",id:"database.tableHeaderCell.freezePropertyTooltip",description:"If the width of the frozen columns is wider than the screen, show the user this tooltip warning."}),render:t=>(0,c.jsx)(R().A,{...e,...t,disabled:Ce,buttonStyle:{color:Ce?ce.text.quaternary:void 0},title:be?(0,c.jsx)(h().sA,{defaultMessage:"{numberFrozenColumns, plural, one {Unfreeze column} other {Unfreeze columns}}",values:{numberFrozenColumns:d+1},id:"database.tableHeaderCell.unfreezeColumns"}):le?(0,c.jsx)(h().sA,{defaultMessage:"Freeze",id:"database.tableHeaderCell.freeze"}):(0,c.jsx)(h().sA,{defaultMessage:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:be?(0,c.jsx)(D().I,{icon:g}):(0,c.jsx)(D().I,{icon:o(988360).N})})}),action:()=>{!function(e){const{collectionContextStore:t,columnIndex:o,environment:n}=e;_().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:n,canUndo:!0,perform:e=>{M().sp({environment:n,collectionContextStore:t,currentIndex:o,transaction:e,entrypoint:"TableHeaderCell",propertyAction:"toggle"})}})}({collectionContextStore:s,columnIndex:d,environment:ne})}}),(t||"title"!==e.type)&&fe.canConfigureBlock&&ye.push({key:"hide",render:e=>(0,c.jsx)(R().A,{...e,title:le?(0,c.jsx)(h().sA,{defaultMessage:"Hide",id:"database.tableHeaderCell.hide"}):(0,c.jsx)(h().sA,{defaultMessage:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:(0,c.jsx)(D().I,{icon:o(99949).e})}),action:()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_hide"}),Q.close(),function(e){const{collectionContextStore:t,columnIndex:n,environment:i,format:r,formatKey:a,property:l}=e,s=t.collectionViewStore();if(!s)return;const c=r[a]||[],d=c.map((e=>e.property===l?{...e,visible:!1}:e)),p={...r,[a]:d};_().createAndCommit({userAction:"TableHeaderCell.updatePropertyFormat",environment:i,canUndo:!0,perform:e=>{(0,o(107805).F)({collectionViewStore:s,update:{format:p},transaction:e}),M().sp({environment:i,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"hide"})}})}({collectionContextStore:s,columnIndex:d,environment:ne,format:m,formatKey:$,property:ee})}}),fe.canConfigureBlock&&"timeline"!==Se&&ye.push({key:"wrap_cell",render:e=>(0,c.jsx)(R().A,{...e,title:Ae?(0,c.jsx)(h().sA,{defaultMessage:"Unwrap text",id:"database.tableHeaderCell.unwrapText"}):(0,c.jsx)(h().sA,{defaultMessage:"Wrap text",id:"database.tableHeaderCell.wrapText"}),icon:(0,c.jsx)(D().I,{icon:Ae?p:o(997353).o})}),action:()=>{M().Nv({currentValue:Ae,environment:ne,property:ee,collectionViewStore:pe,format:m,formatKey:$}),Q.close(),(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_wrap_column"})}});const we=[];if(z.push(we),(0,a().vB)(e)&&fe.canConfigureCollection&&!n&&!i&&!fe.isExternallyImportedAndSyncedCollection){const e=r;we.push({key:"duplicate",render:t=>(0,c.jsx)(V().A,{disableTooltip:!e,placement:q().W.Left,render:n=>(0,c.jsx)(R().A,{...(0,N().A)(t,n),title:(0,c.jsx)(h().sA,{defaultMessage:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:(0,c.jsx)(D().I,{icon:o(507190).V}),disabled:e,disabledFeedback:!0}),renderTooltip:()=>(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.duplicateProperty.offlineTooltip",defaultMessage:"Unavailable while offline"})}),action:async()=>{(0,C().X)({environment:ne,collectionContextStore:s,action:"table_header_duplicate"}),Q.close(),await async function(e){const{collectionContextStore:t,columnIndex:n,environment:i,format:r,formatKey:a,property:l}=e,s=J({format:r,formatKey:a,property:l}),c=t.collectionStore(),d=t.collectionViewStore(),p=t.normalizedFormatStore.state[a]||[],u=null==c?void 0:c.getSpaceId();if(!(c&&d&&u&&s))return;const m=c.getSchema(),g=m[l];if(!g)return;const y=c.getNormalizedPropertyGroups(),h=await(0,o(314164).W4)({environment:i,schema:m,property:l,properties:p,propertyGroups:y,parentStore:c,spaceId:u});if(!h)return;const S=i.currentUser.id,v=S?{id:S,table:f().oo}:void 0,{automationActions:b}=await o(337658).QV.automations.load(),A={...m,[h.newProperty]:h.newPropertySchema},j=c.getFormat(),w={...j,collection_page_properties:h.newProperties,property_groups:h.newPropertyGroups};_().createAndCommit({userAction:"TableHeaderCell.handleDuplicate",environment:i,canUndo:!0,perform:e=>{(0,o(361972).I)({environment:i,collectionStore:c,update:{schema:A,format:w},transaction:e}),M().sp({environment:i,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"duplicate"}),(0,x().O9)(h.automationUpdate)&&b.duplicateAutomation({actorPointer:v,environment:i,sourceAutomationStore:h.automationUpdate.sourceAutomationStore,targetAutomationId:h.automationUpdate.targetAutomationId,transaction:e}),a&&o(927999).zA({stores:[d],update:{[a]:h.newProperties},transaction:e})}}),(0,C().X)({environment:i,collectionContextStore:t,action:"duplicate_property",original_view_type:null==d?void 0:d.getType(),property_type:g.type})}({collectionContextStore:s,columnIndex:d,environment:ne,format:m,formatKey:$,property:ee})}})}return!a().cN.includes(e.type)||!fe.canConfigureCollection||n||i||fe.isExternallyImportedAndSyncedCollection||we.push({key:"delete",render:e=>(0,c.jsx)(o(935889).$,{...e,property:ee,collectionContextStore:s}),action:async()=>{Q.close(),await(0,o(432945).I)({collectionContextStore:s,columnIndex:d,updateFrozenColumnEntrypoint:"TableHeaderCell",updateFrozenColumn:!0,environment:ne,property:ee,schema:te,theme:ce,from:"table_column"})}}),z}),[ae,le,se,me,t,Me,Pe,Ce,s,ue,de,pe,d,Ie,ne,m,$,Oe,Ve,De,oe,_e,Te,he,re,xe,ge,ve,ie,be,ke,Q,fe.canConfigureBlock,fe.canConfigureCollection,fe.isExternallyImportedAndSyncedCollection,ee,te,Be,je,ce,Se,Ae]),ze=(0,n.useMemo)((()=>S().oE(Le.map(((e,t)=>{if(e.length>0){const o=t>0&&0===Le[t-1].length;return{key:t,render:e=>(0,c.jsx)(F().A,{...e,topBorder:0!==t&&1!==t&&!o,style:0===t?{padding:0}:{}}),items:e}}})))),[Le]),He=re?{menuType:H().gu.Modal,minWidth:void 0,title:(0,c.jsx)(h().sA,{id:"database.tableHeaderCell.title",defaultMessage:"Edit property"})}:{menuType:H().gu.Popup,minWidth:220};return(0,c.jsx)(B().A,{...He,children:(0,c.jsx)(K().Ay,{type:K().Oh.Vertical,initialFocus:void 0,sections:ze})})}));function X(e){const{collectionContextStore:t,environment:o,isAscending:n,property:i,schema:r}=e;if(!r[i])return;const a=[{property:i,direction:n?"ascending":"descending"}];t.filtersBarOpenStore.setState(!0),A().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:a}}}),(0,I().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}function J(e){var t;const{format:o,formatKey:n,property:i}=e;return null===(t=o[n])||void 0===t?void 0:t.find((e=>e.property===i))}function Z(e){const{inputValue:t,property:o,schema:n}=e,i=Object.keys(n).find((e=>{var i;return e!==o&&(null===(i=n[e])||void 0===i?void 0:i.name)===t}));return Boolean(i)}},843180:(e,t,o)=>{o.d(t,{B:()=>d});var n=o(242343),i=()=>o(803290),r=()=>o(791497),a=()=>o(401382),l=()=>o(723817),s=o(163643);const c=o(129044).default.createClass("",{name:"InputStore"}),d=n.forwardRef((function(e,t){const{placeholder:d,focusInitial:p,selectAll:u,disabled:m,inputOuterStyle:g,iconButton:y,inputRightButton:f,initialValue:h,onBlur:S,onSubmit:x,onChange:v,maxLength:b,textWrapperStyle:C,textarea:A}=e,j=(0,o(237385).v3)(),w=(0,o(653998).tz)(),[M,_]=(0,n.useState)(h||""),T=(0,i().uB)(e.inputStore,c),k=(0,i().O$)(T)||M,I=(0,n.useCallback)((()=>{S(k)}),[k,S]),P=(0,n.useCallback)((()=>{x(k)}),[k,x]),R=(0,n.useCallback)((e=>{const t=e.target.value;_(t),T&&T.setState(t),v&&v(t)}),[T,v]),B=(0,n.useCallback)((e=>{if(!(y&&e.target instanceof Element))return;const{onSubmit:t,enforceIconColor:o,includeEmojiTab:n}=y;r().W(j,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:l().GF,popupWidth:l().jv,showArrow:!0,title:w.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:n?[{type:"emoji",onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}},{type:"icon",enforceIconColor:o,onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}}]:[{type:"icon",enforceIconColor:o,onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}}],onDelete:()=>{t(),r().I()}})}),[j,y,w]),K=(0,o(192048).O)();(0,n.useEffect)((()=>{e.inputStore&&T.setState(h)}),[]),(0,n.useEffect)((()=>()=>{K.current&&h!==k&&S(k)}),[h,k,K,S]);const D=(0,o(174114).IS)((()=>({iconButton:{opacity:m?.4:void 0},textWrapper:{opacity:m?.4:void 0,...C}})),[m,C]);return(0,s.jsx)(a().Ay,{ref:t,focusInitial:p,autoFocus:!!p||void 0,selectAll:u,value:k,onChange:R,onBlur:I,onSubmit:P,placeholder:d,disabled:m,textWrapperStyle:D.textWrapper,maxlength:b,inputOuterStyle:g,left:y?(0,s.jsx)(a().KF,{icon:y.icon,iconStyle:y.iconStyle,onClick:B,disabled:m,style:D.iconButton,backgroundColor:y.backgroundColor}):null,showClearButton:!1,inputRight:f,textarea:A})}))},849626:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(242343),i=()=>o(653998),r=o(163643);function a(e){let{setAiInference:t,aiInference:a,disabled:l}=e;const s=(0,n.useRef)(o(214144).JW()),c=()=>{if(!a)return;const e={...a,add_options:!a.add_options};t(e)};return(0,r.jsx)(o(103151).A,{renderTooltip:()=>(0,r.jsx)(i().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.description",defaultMessage:"New options are created based on property name & page details"}),placement:o(907721).W.Bottom,render:e=>(0,r.jsx)(o(44405).A,{title:(0,r.jsx)(i().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.text",defaultMessage:"Generate new options"}),showChevron:!1,right:(0,r.jsx)(o(431551).A,{inputId:s.current,on:Boolean(null==a?void 0:a.add_options),onClick:c,disabled:!1,noColor:!1}),onClick:c,disabled:Boolean(l),textWrapperStyle:{minWidth:"auto"},...e})})}const l=n.memo(a)},873624:(e,t,o)=>{o.d(t,{j:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("properties",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})},972375:(e,t,o)=>{o.d(t,{V:()=>r,X:()=>a});var n=()=>o(871002);const i={"de-DE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[년] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[年]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[年]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"YYYY[年]MMM"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"}},r=["de-DE","fr-FR"];function a(e){return i[e]}},976026:(e,t,o)=>{o.d(t,{Z:()=>y,o:()=>f});var n=o(242343),i=()=>o(237385),r=()=>o(564134),a=()=>o(653998),l=()=>o(696987),s=()=>o(84543),c=()=>o(745859),d=()=>o(206183),p=o(163643);function u(e,t,o){return"1"===e?"relation"===t?o&&!0===o?(0,p.jsx)(a().sA,{defaultMessage:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}):(0,p.jsx)(a().sA,{defaultMessage:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}):(0,p.jsx)(a().sA,{defaultMessage:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:d().dC[t]}}):"no_limit"===e?(0,p.jsx)(a().sA,{defaultMessage:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function m(e,t,o){return{key:e,type:"button",title:u(e,t,o)}}var g=()=>o(637558);function y(e){const{property:t,propertySchema:o,collectionContextStore:a}=e,d=(0,i().v3)(),u=(0,n.useCallback)((e=>{const n=a.collectionStore();if(!n||!(0,r().sO)(o))return;const i={...o,limit:Number(e)?1:void 0};s().createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",environment:d,canUndo:!0,perform:e=>{(0,c().F)({environment:d,collectionStore:n,update:{[t]:i},transaction:e})}});const p=Number(e)?`${o.type}_toggle_limit_on`:`${o.type}_toggle_limit_off`;(0,l().V)({environment:d,collectionContextStore:a,property:t,from:"view_settings",action:p})}),[a,d,t,o]);return(0,r().sO)(o)?"relation"===o.type&&o.connectedRelation?(0,p.jsx)(f,{propertyType:o.type,connectedRelation:!0,selectedKey:o.limit?"1":"no_limit",onChange:u}):(0,p.jsx)(f,{propertyType:o.type,selectedKey:o.limit?"1":"no_limit",onChange:u}):null}function f(e){const{propertyType:t,selectedKey:o,connectedRelation:n,onChange:i}=e;return(0,p.jsx)(g().A,{title:(0,p.jsx)(a().sA,{defaultMessage:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),selectedKey:o,popupStyle:{minWidth:190},options:[m("1",t,n),m("no_limit",t)],onChange:i})}},985174:(e,t,o)=>{o.d(t,{A:()=>be});o(725707),o(500234);var n=o(242343),i=()=>o(237385),r=()=>o(803290),a=()=>o(174114),l=()=>o(706788),s=()=>o(116548),c=()=>o(653998),d=()=>o(76394),p=()=>o(145046),u=()=>o(423392),m=()=>o(159809),g=()=>o(982415),y=()=>o(209684),f=()=>o(88271),h=()=>o(279150),S=()=>o(167532),x=()=>o(773082),v=()=>o(193867),b=(o(362833),o(491955),o(324989),o(771702),o(403517),()=>o(564134)),C=()=>o(916963),A=()=>o(752903),j=()=>o(627618);const w={pull_request_review_edited:!0,pull_request_review_submitted:!0,pull_request_review_requested:!0,pull_request_review_request_removed:!0,pull_request_closed:!0,pull_request_opened:!0,pull_request_reopened:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0,pull_request_labeled:!0,pull_request_unlabeled:!0},M={pull_request_review_comment_created:!0,issue_comment_created:!0},_={installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,...w,...M},T={pull_request_opened:!0,pull_request_review_requested:!0,pull_request_review_submitted:!0,pull_request_closed:!0};(0,d().u0)((e=>{const t=(0,d().uv)(_);return(0,d().Xk)(t,e)?{true:e}:{false:e}}));j().literals(...(0,d().uv)({pull_request:!0,pull_request_review:!0,pull_request_review_comment:!0,installation:!0,issue_comment:!0})),j().literals(...(0,d().uv)(_)),j().literals(...(0,d().uv)(M));var k=()=>o(706412),I=()=>o(339189),P=()=>o(52531),R=()=>o(696987),B=()=>o(154956),K=()=>o(84543),D=()=>o(745859),F=()=>o(535906),V=()=>o(273520),O=()=>o(511952),L=()=>o(884373),z=()=>o(935091),H=()=>o(858023),N=()=>o(743668),W=()=>o(951540),q=()=>o(103151),Y=()=>o(837809),E=()=>o(749975),U=()=>o(477784),G=()=>o(640979),$=()=>o(755786),X=()=>o(44405),J=()=>o(948120),Z=o(163643);const Q=14,ee=(0,c().YK)({autoUpdate:{defaultMessage:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{defaultMessage:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},addStatusDescription:{defaultMessage:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{defaultMessage:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{defaultMessage:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},pull_request_opened:{defaultMessage:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},pull_request_review_requested:{defaultMessage:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},pull_request_review_submitted:{defaultMessage:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},pull_request_closed:{defaultMessage:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{defaultMessage:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{defaultMessage:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"},linkbackAndActivitySectionHeader:{defaultMessage:"Linkbacks & Activity",id:"collectionSettingsGithubAutomationConfig.linkbacksAndActivityHeading"},linkBacksToggle:{defaultMessage:"Linkbacks in GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggle"},linkBacksToggleDescription:{defaultMessage:"Enable linkback comments to the linked page on GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggleDescription"},activityCommentsToggle:{defaultMessage:"Activity Comments",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggle"},activityCommentsToggleDescription:{defaultMessage:"Show GitHub activity as comments on the linked page",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggleDescription"}}),te={pull_request_opened:U().A.formatMessage(ee.pull_request_opened),pull_request_review_requested:U().A.formatMessage(ee.pull_request_review_requested),pull_request_review_submitted:U().A.formatMessage(ee.pull_request_review_submitted),pull_request_closed:U().A.formatMessage(ee.pull_request_closed)},oe=U().A.formatMessage(ee.noAutomations),ne={pull_request_opened:null,pull_request_review_requested:null,pull_request_review_submitted:null,pull_request_closed:null},ie={github_linkbacks:!0,activity_comments:!1};function re(e){const{gitHubProperty:t,selectedStatusProperty:o,setSelectedStatusProperty:a,intl:l}=e,s=(0,i().v3)(),c=(0,E().ET)(),p=(0,i().Y0)(),u=ce(),m=(0,r().K8)((()=>{const e=(0,$().Jq)(c,t);if(e&&(0,b().UU)(e))return e}),[c,t]),g=(0,r().K8)((()=>{const e=c.normalizedSchemaStore.state;return(0,d().WP)(e).flatMap((e=>{let[t,o]=e;return o&&(0,b().DD)(o)?[{id:t,schema:o}]:[]}))}),[c.normalizedSchemaStore]),y=(0,r().K8)((()=>m&&(0,b().UU)(m)&&(0,d().O9)(m.connectedRelation.automationSettings)?m.connectedRelation.automationSettings:ie),[m]);(0,n.useEffect)((()=>{C(y)}),[y]),(0,n.useEffect)((()=>{if(!o&&g.length>0){if(null!=m&&m.connectedRelation.automation)for(const t of g)if(m.connectedRelation.automation[t.id])return void a(t);const e=g[0];a(e)}}),[g,m,o,a]);const[S,x]=(0,n.useState)(ne),[v,C]=(0,n.useState)(ie),j=(0,n.useCallback)((e=>{const o=c.collectionStore();if(!o||!m||!(0,b().nC)(m))return;const n=m.connectedRelation;n.automationSettings=e;const i={...m,connectedRelation:{...n}};K().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,D().F)({environment:s,collectionStore:o,update:{[t]:i},transaction:e})}}),C(e)}),[c,s,t,m]);(0,n.useEffect)((()=>{var e,t;o&&m&&(0,b().UU)(m)&&null!==(e=m.connectedRelation.automation)&&void 0!==e&&e[o.id]?x(null===(t=m.connectedRelation.automation)||void 0===t?void 0:t[o.id]):x(ne)}),[m,o]);const w=(0,n.useCallback)((e=>{const n=c.collectionStore();if(!(n&&o&&m&&(0,b().nC)(m)))return;const i=m.connectedRelation;if(!i||!o.id)return;i.automation={...i.automation,...e};const r={...m,connectedRelation:{...i}};(0,R().V)({environment:s,collectionContextStore:c,property:o.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:e}),K().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,D().F)({environment:s,collectionStore:n,update:{[t]:r},transaction:e})}})}),[c,o,m,s,t]),M=(0,r().K8)((()=>o&&o.schema.options?o.schema.options:[]),[o]),_=(0,r().K8)((()=>{const e={};return M.forEach((t=>{e[t.id]=t})),e}),[M]),I=(0,r().K8)((()=>{var e,t;const n=null==o||null===(e=o.schema)||void 0===e?void 0:e.groups,i=null==o||null===(t=o.schema)||void 0===t?void 0:t.options;return n&&i?n.map((e=>{const t=i.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(d().O9):[]}),[o]);function B(e,t){const n=I.map((t=>{let{group:n,groupOptions:i}=t;const r=i.map((t=>({key:t.id,render:e=>(0,Z.jsx)(F().A,{...e,focused:e.focused,isTokenTitle:!0,title:(0,Z.jsx)(Y().q,{format:A().NY.Small,value:t.value,color:t.color,showRemoveButton:!1,groupColor:n.color,isSingle:!0})}),action:()=>{const n={...S,[e]:t.id};o&&(w({[o.id]:n}),x(n))}}))).filter(d().O9);return{key:n.name,render:e=>(0,Z.jsx)(f().A,{...e,title:n.name,topBorder:e.index>0}),items:r}}));if(S[e]){function i(){const n={...S,[e]:null};o&&(w({[o.id]:n}),x(n)),t.close()}const r={key:"removeOptionSection",render:e=>(0,Z.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"removeOptionButton",render:e=>(0,Z.jsx)(F().A,{...e,focused:!1,title:l.formatMessage(ee.removeStatusOption),left:(0,P().I)({width:12}),onClick:i}),action:e=>{i()}}]};n.push(r)}return n}return(0,Z.jsxs)(Z.Fragment,{children:[o?(0,Z.jsx)(f().A,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:(0,Z.jsx)(le,{selectedStatusProperty:o,setSelectedStatusProperty:a,existingStatusProperties:g,intl:l}),children:(0,d().uv)(T).map((e=>(0,Z.jsx)(O().A,{focused:!1,placementToOrigin:V().sx.Top,alignmentToOrigin:V().yP.End,popupType:p.isMobile?V().z7.SlideUp:V().z7.Popup,render:t=>{const o=p.isMobile?{menuType:G().gu.Modal,right:(0,Z.jsx)(N().DoneMenuText,{}),onClickRight:t.close}:{menuType:G().gu.Popup,width:150};return(0,Z.jsx)(z().A,{...o,children:(0,Z.jsx)(H().Ay,{type:H().Oh.Vertical,sections:B(e,t),initialFocus:void 0,onAccept:t.close})})},renderOrigin:t=>{const n=S[e];let i=(0,Z.jsx)("div",{style:u.noneText,children:oe});if(n){const e=_[n];if(e){var r;const t=null==o||null===(r=o.schema)||void 0===r||null===(r=r.groups)||void 0===r||null===(r=r.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n)})))||void 0===r?void 0:r.color;i=(0,Z.jsx)(Y().q,{format:A().NY.Small,showRemoveButton:!1,isSingle:!0,value:e.value,color:e.color,groupColor:t})}}return(0,Z.jsx)(X().A,{...t,focused:!1,icon:()=>(0,Z.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap"},children:[te[e],(0,Z.jsx)(h().A,{size:8}),(0,k().Z)(u.automationMenuItemArrow)]}),title:(0,Z.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:i}),showChevron:!0,chevronStyle:{margin:0}})}},e)))}):(0,Z.jsx)(ae,{setSelectedStatusProperty:a,intl:l}),(0,Z.jsx)(f().A,{topBorder:!0,disableDesktopPadding:!0,disableMobilePadding:!0,title:l.formatMessage(ee.linkbackAndActivitySectionHeader),children:[(0,Z.jsx)(q().A,{renderTooltip:()=>l.formatMessage(ee.linkBacksToggleDescription),render:e=>(0,Z.jsx)(J().A,{...e,title:l.formatMessage(ee.linkBacksToggle),onClick:()=>{j({...v,github_linkbacks:!v.github_linkbacks})},switcherProps:{on:v.github_linkbacks}})},"github_linkbacks"),(0,Z.jsx)(q().A,{renderTooltip:()=>l.formatMessage(ee.activityCommentsToggleDescription),render:e=>(0,Z.jsx)(J().A,{...e,title:l.formatMessage(ee.activityCommentsToggle),onClick:()=>{j({...v,activity_comments:!v.activity_comments})},switcherProps:{on:v.activity_comments}})},"activity_comments")]})]})}function ae(e){const{setSelectedStatusProperty:t,intl:o}=e,n=(0,i().v3)(),r=(0,E().ET)(),a=ce();return(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,Z.jsx)(L().A,{size:"100%",innerStyle:a.addStatusDivider}),(0,Z.jsx)("div",{style:a.addStatusDescription,children:o.formatMessage(ee.addStatusDescription)}),(0,Z.jsxs)(W().A,{style:a.addStatusButton,onClick:e=>{e.stopPropagation(),se(n,r,t)},children:[(0,I().W)({width:14}),(0,Z.jsx)(h().A,{size:4}),o.formatMessage(ee.addStatusButton)]}),(0,Z.jsx)(h().A,{size:4})]})}function le(e){const{selectedStatusProperty:t,setSelectedStatusProperty:o,existingStatusProperties:n,intl:r}=e,l=(0,i().v3)(),s=(0,E().ET)(),c=(0,i().Y0)(),p=ce(),u=(0,a().DP)(),m=n.map((e=>{const{id:t,schema:n}=e;return{key:t,action:()=>{o(e)},render:t=>(0,Z.jsx)(F().A,{...t,icon:(0,Z.jsx)(C().zB,{size:Q,theme:u,icon:e&&e.schema.icon,type:"status"}),title:n.name})}})).filter(d().O9),g={key:"newStatusProperty",action:()=>{se(l,s,o)},render:e=>(0,Z.jsx)(F().A,{...e,icon:(0,I().W)(p.statusPickerIcon),title:r.formatMessage(ee.newStatusPropertyButton)})};return(0,Z.jsxs)("div",{style:p.statusPickerWrapper,children:[(0,Z.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[r.formatMessage(ee.autoUpdate),c.isMobile&&(0,Z.jsx)(h().A,{size:4}),(0,Z.jsx)(V().Ay,{placementToOrigin:V().sx.Bottom,alignmentToOrigin:V().yP.Start,popupType:c.isMobile?V().z7.SlideUp:V().z7.Popup,renderOrigin:e=>(0,Z.jsx)(F().A,{...e,title:t.schema.name,focused:!1,style:p.statusPickerButtonCore,textWrapperStyle:p.statusPickerButtonTextWrapper,left:(0,Z.jsx)(C().zB,{size:Q,theme:u,icon:t.schema.icon,type:"status"}),leftStyle:{marginLeft:2},showExtensionArrow:!0,extensionArrowStyle:p.statusPickerExtensionArrow}),render:e=>{const t=c.isMobile?{menuType:G().gu.ActionSheet}:{menuType:G().gu.Popup,width:150};return(0,Z.jsx)(z().A,{...t,children:(0,Z.jsx)(H().Ay,{type:H().Oh.Vertical,sections:[{key:0,render:e=>(0,Z.jsx)(f().A,{...e}),items:[...m,g]}],initialFocus:0,onAccept:e.close})})}})]}),c.isMobile&&(0,Z.jsx)(h().A,{size:4}),r.formatMessage(ee.when)]})}function se(e,t,o){const n=t.collectionStore();n&&K().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",environment:e,canUndo:!0,perform:i=>{const r=B().IL({environment:e,collectionStore:n,collectionViewArgs:void 0,propertyType:"status",transaction:i}),a=(0,$().Jq)(t,r);a&&(0,b().DD)(a)&&o({id:r,schema:a})}})}function ce(){const e=(0,i().Y0)().isMobile;return(0,a().IS)((t=>({addStatusDivider:{borderColor:t.tableDividerColor},addStatusDescription:{width:"calc(100% - 24px)",padding:e?"16px 8px":"14px 0px",fontSize:e?16:12,color:t.text.tertiary},addStatusButton:{width:"calc(100% - 24px)",display:"inline-flex",alignItems:"center",justifyContent:"center"},noneText:{color:t.text.tertiary},automationMenuItemArrow:{width:12,fill:t.lightIconColor,stroke:t.lightIconColor,strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{display:"inline-flex",alignItems:"center",flexWrap:"wrap",rowGap:2,marginBottom:e?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:e?28:20,borderRadius:5,maxWidth:e?150:100},statusPickerIcon:{width:Q,height:Q},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2}})),[e])}var de=()=>o(189919);const pe=(0,c().YK)({connect:{defaultMessage:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{defaultMessage:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},tabDescription:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function ue(e){let{collectionContextStore:t,intl:o}=e;const n=ve(),{hoveredBackground:a,pressedBackground:l}=xe(),s=(0,S().J)(),c=(0,i().v3)(),d=Se(),g=function(e){return(0,r().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e])}(t);return(0,Z.jsxs)(f().A,{disableMobileBorders:!0,mobileStyle:n.previewContentContainer,style:n.previewContentContainer,children:[(0,Z.jsx)("img",{src:"/images/external_integrations/github-icon.png",style:{width:36,height:36}}),(0,Z.jsx)("p",{style:n.connectDescription,children:s?(0,m().Jb)().description:o.formatMessage(pe.connectDescriptionAdmin)}),(0,Z.jsx)(y().p,{style:n.connectButton,hoveredStyle:{background:a},pressedStyle:{background:l},disabled:!s,disabledFeedback:!s,onClick:async e=>{if(e.preventDefault(),g&&d)try{await u().Jq({environment:c,spaceId:g,integration:d,from:"connected_relation_property_menu"})}catch(t){const e=o.formatMessage(pe.authError);p().f1(e)}},children:o.formatMessage(pe.connect)}),(0,Z.jsx)(h().A,{size:4})]})}function me(e){let{collectionContextStore:t}=e;const o=ve(),{isMobile:n}=(0,i().Y0)(),r=he(t);return(0,Z.jsxs)(f().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,style:o.previewContentContainer,children:[(0,Z.jsx)(h().A,{size:n?16:8}),(0,Z.jsx)(de().A,{width:"calc(100% - 24px)",uniqueIdPrefix:null==r?void 0:r.prefix})]})}function ge(e){let{collectionContextStore:t,intl:o,selectedStatusProperty:n}=e;const i=(0,r().K8)((()=>t.databaseType),[t]),a=he(t),l=ve(),s=(0,g().$O)(i),c=(0,g().oj)(i);let d;return d=a&&a.prefix?n?o.formatMessage(pe.tabDescription,{singleItemName:s}):o.formatMessage(pe.tabDescriptionNoStatus,{singleItemName:s}):o.formatMessage(pe.tabDescriptionNoIdPrefix,{pluralItemName:c}),(0,Z.jsx)(f().A,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:l.tabDescription,style:l.tabDescription,children:d})}function ye(e){let{collectionContextStore:t}=e;const o=he(t);return o&&o.prefix?null:(0,Z.jsx)(v().A,{collectionContextStore:t,uniqueIdProperty:o&&{propertyId:o.id,propertySchema:o.schema},prefixValue:null==o?void 0:o.prefix})}function fe(e){let{collectionContextStore:t,selectedStatusProperty:o,setSelectedStatusProperty:n,property:i,intl:r}=e;const a=he(t);return a&&a.prefix?(0,Z.jsx)(re,{selectedStatusProperty:o,setSelectedStatusProperty:n,gitHubProperty:i,intl:r}):null}function he(e){return(0,r().K8)((()=>{var t,o;const n=null===(t=e.collectionStore())||void 0===t||null===(t=t.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema(),r=i&&(0,d().WP)(i).find((e=>{let[,t]=e;return t&&"auto_increment_id"===t.type}));if(r){const[e,t]=r;if(t&&"auto_increment_id"===t.type)return{id:e,schema:t,prefix:n}}}),[e])}function Se(){return(0,r().K8)((()=>x().A.integrations.state.find((e=>e.id===l().ob))),[])}function xe(){const e=Se(),t=(0,a().DP)();return(0,r().K8)((()=>(0,s().u)(e,t.mode)),[e,t.mode])}function ve(){const{isMobile:e}=(0,i().Y0)(),{background:t}=xe();return(0,a().IS)((o=>({previewContentContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},connectButton:{fontSize:14,maxWidth:"calc(100% - 24px)",height:void 0,color:o.text.contrastPrimary,background:t,whiteSpace:"normal",padding:8,textAlign:"center"},connectDescription:{maxWidth:"calc(100% - 24px)",color:o.text.tertiary,fontSize:14,textAlign:"center"},tabDescription:{padding:e?18:14,fontSize:e?16:12,color:o.text.tertiary}})),[e,t])}const be=(0,c().j4)((function(e){const{collectionContextStore:t,property:o,intl:i}=e,[a,s]=(0,n.useState)(void 0);return(0,r().K8)((()=>{const e=x().A.bots.state.find((e=>e.integration_id===l().ob));return Boolean(e)}),[])?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(me,{collectionContextStore:t}),(0,Z.jsx)(ge,{collectionContextStore:t,intl:i,selectedStatusProperty:a}),(0,Z.jsx)(ye,{collectionContextStore:t}),(0,Z.jsx)(fe,{collectionContextStore:t,selectedStatusProperty:a,setSelectedStatusProperty:s,property:o,intl:i})]}):(0,Z.jsx)(ue,{collectionContextStore:t,intl:i})}))},997353:(e,t,o)=>{o.d(t,{o:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M16.625 8A2.625 2.625 0 0 0 14 5.375h-1.42a.625.625 0 1 1 0-1.25H14a3.875 3.875 0 0 1 0 7.75H4.259l3.333 3.333a.625.625 0 0 1-.884.884l-4.4-4.4a.625.625 0 0 1 0-.884l4.4-4.4a.625.625 0 0 1 .884.884l-3.333 3.333H14A2.625 2.625 0 0 0 16.625 8"})},i=(0,o(680369).wt)("arrowUTurnDownLeft",n)}}]);