"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[42283],{56066:(e,t,o)=>{o.d(t,{a:()=>i});var n=()=>o(129978);const r=new(n().O2)("PropertyModulePersonProperty",(async()=>await Promise.all([o.e(74562),o.e(28866),o.e(59794),o.e(6463),o.e(82120)]).then(o.bind(o,493804)))),i=(0,n()._h)(r,(e=>e.PersonPropertyModule))},75770:(e,t,o)=>{o.d(t,{B:()=>i});var n=()=>o(812815);const r={};function i(e){const{throttleSeconds:t,...o}=e,i=`${e.from}:${e.type}`,l=r[i],a=Date.now();(!l||a-l>1e3*t)&&(r[i]=a,function(e){const{error:t,...o}=e;(0,n().O8)(t,o)}(o))}},120445:(e,t,o)=>{o.d(t,{P:()=>r});var n=()=>o(777277);function r(e){const{store:t}=e;"new"===n().A.state.editMode&&n().A.state.store.id===t.id&&n().A.reset()}},122009:(e,t,o)=>{o.d(t,{z:()=>Q});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(500234),o(403517),o(113085);var n=o(242343),r=()=>o(752597),i=()=>o(237385),l=()=>o(269280),a=()=>o(803290),s=()=>o(174114),c=()=>o(564134),d=()=>o(716605),p=()=>o(808971),u=()=>o(836693),m=()=>o(846287),g=()=>o(653998),y=()=>o(975392),f=()=>o(696987),v=()=>o(378524),h=()=>o(575015),S=()=>o(384221),b=()=>o(84543),x=()=>o(658388),C=()=>o(303330),w=()=>o(546172),I=()=>o(629443),k=()=>o(201562),P=()=>o(956070),M=()=>o(502852),R=()=>o(477784),_=()=>o(863969),A=()=>o(622286),j=()=>o(167532),B=()=>o(689248),T=()=>o(546820),V=()=>o(907721),L=()=>o(485966),O=()=>o(943066),D=()=>o(133926),K=()=>o(105886),F=()=>o(356813),W=()=>o(441292),z=()=>o(59175),E=()=>o(823519),N=()=>o(103151),H=()=>o(751436),U=o(163643);const Q=(0,n.forwardRef)((function(e,t){const{property:r,propertySchema:l,format:s}=(0,n.useContext)(H().L8),{collectionStore:p,disabled:u,locked:m,store:g,formQuestionStore:y,formDataStore:f}=e,{isMobile:v}=(0,i().Y0)(),h=(0,a().K8)((()=>{var e;return"multi_select"===(null==l?void 0:l.type)?null==y||null===(e=y.getPropertyTypeSpecificConfig("multi_select"))||void 0===e?void 0:e.maxSelectionCount:void 0}),[y,l]),S=(0,o(659030).Vm)({formQuestionStore:y,propertySchema:l}),b=(0,a().K8)((()=>l&&(0,c().lx)(l)?l.options??[]:[]),[l]),x=(0,a().K8)((()=>{var e;const t=null==f||null===(e=f.getFormState())||void 0===e?void 0:e.draftFormBlockStore;if(!r||!t)return new Set;const o=null==t?void 0:t.getPropertyValue(r),n=(0,d().J4)(o,b);return new Set(n.map((e=>e.id)))}),[f,b,r]),C=(0,a().K8)((()=>`form-question-${null==y?void 0:y.id}`),[y]);return"form_editor"!==s||m?(0,U.jsx)("div",{style:{marginTop:8,marginLeft:v?void 0:-8,display:"flex",gap:v?4:0,flexDirection:"column"},children:b.map((e=>{let t=u;return h&&x.size>=h&&!S&&(x.has(e.id)||(t=!0)),(0,U.jsx)(q,{store:g,disabled:t,option:e,allOptions:b,showRadioButtonSelector:S,questionName:C},e.id)}))}):(0,U.jsx)(G,{options:b,collectionStore:p,showRadioButtonSelector:S,formQuestionStore:y})}));function G(e){const t=(0,i().v3)(),[r,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[p,u]=(0,n.useState)(!1),{options:m,collectionStore:f,showRadioButtonSelector:h,formQuestionStore:S}=e,{property:b}=(0,n.useContext)(H().L8),x=(0,a().K8)((()=>f.getSchema()),[f]),C=(0,s().IS)((e=>({addOptionButtonStyle:{color:e.text.tertiary,fill:e.text.tertiary},selectOptionList:{marginTop:m.length>0?4:0},newSelectOption:{marginTop:m.length>0?0:4}})),[m]);return b?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(o(97787).Ay,{direction:"vertical",style:C.selectOptionList,keys:null==m?void 0:m.map((e=>e.value)),disabled:c,onDragStart:()=>u(!0),onDragEnd:()=>u(!1),renderKey:e=>{const t=m.find((t=>t.value===e));return t?(0,U.jsx)(Y,{type:"persisted",option:t,options:m,showRadioButtonSelector:h,isDragging:p,collectionStore:f,setNewOptionInput:l,setDisableDragging:d,formQuestionStore:S},t.id):null},onDrop:e=>{v().gc({newValues:e,property:b,schema:x,collectionStore:f,environment:t})}}),r?(0,U.jsx)("div",{style:C.newSelectOption,children:(0,U.jsx)(Y,{type:"temporary",collectionStore:f,options:m,showRadioButtonSelector:h,isDragging:p,setNewOptionInput:l,setDisableDragging:d,formQuestionStore:S})}):null,(0,U.jsx)(o(209684).p,{onMouseDown:e=>{(0,M().SQ)({event:e,context:M().y$.EditorMouseDown,callback:y().D_})},icon:e=>(0,o(339189).W)({...e,width:18,marginLeft:1,marginRight:11,fill:C.addOptionButtonStyle.fill}),style:{color:C.addOptionButtonStyle.color,marginLeft:6,marginTop:4},onClick:e=>{l(!0)},children:(0,U.jsx)(g().sA,{id:"questionModule.formSelectMultiSelectProperty.addOption",defaultMessage:"Add option"})})]}):null}const $=6;function q(e){const{option:t,allOptions:r,store:l,disabled:p,showRadioButtonSelector:u,questionName:m}=e,g=(0,i().v3)(),{isMobile:y}=(0,i().Y0)(),{format:f,property:v,propertySchema:h}=(0,n.useContext)(H().L8),S=(0,a().K8)((()=>null==h?void 0:h.type),[h]),x=(0,a().K8)((()=>{if(!v||!h||!(0,c().lx)(h))return!1;const e=l.getPropertyValue(v);let o=[];if("select"===h.type){const t=(0,d().fF)(e,r);o=t?[t]:[]}else o=(0,d().J4)(e,r);return o.some((e=>e.value===t.value))}),[l,t,r,h,v]),C=(0,s().IS)((e=>({selectorButton:{width:"calc(100% + 16px)",borderRadius:$},selectorButtonInner:{border:"none",padding:"4px 8px",borderRadius:$,...y?{backgroundColor:"light"===e.mode?e.accentColors.gray[30]:e.accentColors.gray[100]}:{}},selectorButtonPressed:{backgroundColor:e.buttonPressedBackground},selectorButtonHovered:{backgroundColor:e.buttonHoveredBackground},rowPadding:{padding:"form_editor"===f?"0px 0px 0px 16px":void 0}})),[f,y]),w=(0,n.useCallback)((()=>{v&&h&&(0,c().lx)(h)&&("multi_select"!==h.type||u?b().createAndCommit({userAction:"FormSelectProperty.handleSelectQuestionSelectOption",environment:g,canUndo:!0,perform:e=>{t&&o(448316).R9({environment:g,store:l.getPropertyStore(v),value:(0,o(34662).x9d)(t.value),transaction:e})}}):b().createAndCommit({userAction:"FormSelectProperty.handleMultiSelectQuestionSelectOption",environment:g,canUndo:!0,perform:e=>{x?b().applyOperation({transaction:e,store:l.getPropertyStore(v),operation:{path:["properties",v],pointer:l.pointer,command:"removeSelectOption",args:{option:t.value}}}):b().applyOperation({transaction:e,store:l.getPropertyStore(v),operation:{path:["properties",v],pointer:l.pointer,command:"addSelectOptionAfter",args:{option:t.value}}})}}))}),[g,t,x,h,v,l,u]);return h&&(0,c().lx)(h)?(0,U.jsx)("div",{style:{display:"flex",alignItems:"center",wordBreak:"break-word"},children:(0,U.jsx)(o(421338).Y1,{direction:"horizontal",padding:C.rowPadding.padding,children:(0,U.jsx)(o(126451).A,{hoveredStyle:C.selectorButtonHovered,pressedStyle:C.selectorButtonPressed,style:C.selectorButton,disallowTabbing:!0,children:(0,U.jsx)(E().a,{style:C.selectorButtonInner,name:m,isDisabled:p,label:t.value,onChange:w,selectorSize:"large",isSelected:"form_viewer"===f&&x,value:"select_option",selectType:"select"===S||u?"radio":"checkbox",selectAlignYAxis:"center"})})})}):null}function Y(e){var t;const o=(0,i().v3)(),d=(0,g().tz)(),{type:b,collectionStore:M,formQuestionStore:Q,option:G,options:$,isDragging:q,setNewOptionInput:Y,setDisableDragging:X,showRadioButtonSelector:J}=e,[ee,te]=n.useState((null==G?void 0:G.value)??""),[oe,ne]=(0,n.useState)(!1),[re,ie]=(0,n.useState)(!1),[le,ae]=(0,n.useState)(!1),se=(0,A().X)("forms_conditional_logic"),ce=(0,T().v$)(),de=(0,_().O)(),pe=(0,k().Q1)(),{currentUserSettingsStore:ue}=(0,a().K8)((()=>L().default.state),[]);(0,l().l)((()=>{"temporary"===b&&(ae(!0),ie(!0))}));const{property:me,propertySchema:ge,collectionContextStore:ye}=(0,n.useContext)(H().L8),fe=(0,a().K8)((()=>null==Q?void 0:Q.getParentStore()),[Q]),{currentQuestionModuleAndArea:ve,modulesByArea:he}=(0,a().K8)((()=>{const e=null==fe?void 0:fe.getModules();if(!e||!Q)return{undefined:void 0,normalizedModulesByArea:e};return{currentQuestionModuleAndArea:(0,m().Ib)({modulesByArea:e,find:e=>"formQuestion"===e.type&&e.formQuestionId===Q.id}),modulesByArea:e}}),[Q,fe]),Se=(0,n.useMemo)((()=>{if(null==G||!G.value||!ge)return!1;const e=null==ve?void 0:ve.module.conditionalGroups,t="select"===ge.type?{property:me,filter:{operator:"enum_is",value:{type:"exact",value:G.value}}}:{property:me,filter:{operator:"enum_contains",value:{type:"exact",value:G.value}}},o=null==e?void 0:e.some((e=>y().n4(e.trigger,t)));return Boolean(o)}),[ve,G,me,ge]),be=(0,n.useCallback)((()=>{if(!me||!ge||!(0,c().lx)(ge))return;const e=ee.trim();if(e){"alphabetical"===ge.auto_sort_options||"reverse_alphabetical"===ge.auto_sort_options?v().Uk({modification:{type:"autoSortInsert",newValue:e},property:me,propertySchema:ge,options:$,environment:o,collectionStore:M}):v().Uk({modification:{type:"keyedObjectListAfter",newValue:e},property:me,propertySchema:ge,options:$,environment:o,collectionStore:M}),Y(!1);const t=null==ue?void 0:ue.getSettingsStore().getKeyStore("seen_forms_add_conditional_logic_tooltip").getValue(),n=null==ve?void 0:ve.module.formQuestionId;se&&n&&!t&&(null==pe||pe.formAddConditionalLogicTooltipStore.setState({openTooltip:(0,P().fY)({formQuestionId:n,optionValue:e})}),B().HH(o,P().wG)),ye&&(0,f().V)({environment:o,collectionContextStore:ye,property:me,from:"form_editor",action:"select_add_option"})}else Y(!1);ae(!1)}),[me,Y,ye,ge,$,o,ee,M,null==ve?void 0:ve.module.formQuestionId,se,ue,pe]),xe=(0,n.useCallback)((e=>{me&&G&&ge&&(0,c().lx)(ge)?(e?v().r$({environment:o,option:G,property:me,propertySchema:ge,collectionStore:M,deleteMessage:Se?R().A.formatMessage(Z.deleteModalWithConditionalLogic):void 0}):v().Uk({modification:{type:"keyedObjectListRemove",id:G.id},property:me,propertySchema:ge,environment:o,collectionStore:M}),ye&&(0,f().V)({environment:o,collectionContextStore:ye,property:me,from:"form_editor",action:"select_delete_option"}),Y&&Y(!1),ae(!1),ie(!1),X(!1),x().p$({environment:o}),B().a(o,P().wG)):Y&&Y(!1)}),[me,Y,ye,Se,ge,G,ie,X,o,M]),Ce=(0,n.useCallback)((()=>{if(!(me&&G&&ge&&(0,c().lx)(ge)))return;const e=ee.trim();e?(e&&e!==(null==G?void 0:G.value)&&(v().Uk({modification:{type:"keyedObjectListUpdate",option:G,newValue:e},property:me,propertySchema:ge,options:$,environment:o,collectionStore:M}),ye&&(0,f().V)({environment:o,collectionContextStore:ye,property:me,from:"form_editor",action:"select_rename_option"})),ae(!1),ie(!1),X(!1)):xe()}),[me,ye,xe,ge,o,ie,X,G,$,ee,M]),we=(0,n.useCallback)((()=>{me&&ge&&(0,c().lx)(ge)&&ve&&fe&&G&&(C().lF({environment:o,layoutStore:fe,currentQuestionModule:ve.module,area:ve.area,property:me,filterValue:{type:ge.type,value:G},setModuleSelection:null==ce?void 0:ce.setModuleSelection,sessionId:(null==ce?void 0:ce.sessionId)??""}),x().p$({environment:o}),B().a(o,P().wG))}),[me,o,ve,fe,G,ce,ge]),Ie=y().sg((()=>ne(!0)),5),ke=Ie,Pe=(0,n.useCallback)((()=>{ne(!1),Ie.cancel()}),[Ie]),Me=(0,n.useMemo)((()=>oe&&!re),[oe,re]),Re=(0,a().K8)((()=>(0,P().Yx)({type:"multi_select",formQuestionId:null==ve?void 0:ve.module.formQuestionId,optionValue:null==G?void 0:G.value,isConditionalLogicEnabled:se,formAddConditionalLogicTooltipStore:null==pe?void 0:pe.formAddConditionalLogicTooltipStore})),[G,null==ve?void 0:ve.module.formQuestionId,se,pe]),_e=(0,j().J)(),Ae=(0,D()._X)({name:"forms_conditional_logic",spaceId:de,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id}),je=null==Ae?void 0:Ae.upsell,Be=(0,n.useMemo)((()=>(0,P().DG)({isConditionalLogicEnabled:se,mouseEntered:oe,currentQuestionModule:null==ve?void 0:ve.module,modulesByArea:he,featureAvailable:"available"===(null==Ae?void 0:Ae.type),isDragging:q,inputFocused:re,showTutorialTooltip:Re})),[se,oe,null==ve?void 0:ve.module,he,null==Ae?void 0:Ae.type,Re,q,re]),Te=(0,n.useMemo)((()=>(oe||Re&&Be)&&!re&&!q),[re,q,oe,Re,Be]),Ve=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center",width:"calc(100% + 16px)",marginLeft:-8,padding:"2px 4px",borderRadius:6,backgroundColor:oe?e.buttonHoveredBackground:void 0,cursor:"grab"},dragHandle:{position:"absolute",zIndex:2,marginLeft:"-2px"},innerContainer:{display:"flex",alignItems:"center",padding:"0px 0px 0px 16px",width:"100%"},conditionalButtonBorder:{outlineStyle:"solid",outlineWidth:2,outlineColor:e.icon.uiBlueTertiary,borderRadius:4}})),[oe]),Le=(0,n.useRef)(null);return me&&ge&&(0,c().lx)(ge)?(0,U.jsxs)("div",{style:Ve.container,onMouseMove:ke,onMouseLeave:Pe,children:[Me&&(0,U.jsx)(K().A,{width:16,height:24,disallowTabbing:!0,disableDrag:re,tooltipPlacement:V().W.Left,hideClickMessage:!0,style:Ve.dragHandle}),(0,U.jsxs)("div",{style:Ve.innerContainer,children:[(0,U.jsx)(E().a,{style:{border:"none",padding:0,cursor:"grab",flexGrow:0},isDisabled:!0,label:null,isSelected:!1,selectorSize:"large",value:"select_option",selectType:"select"===ge.type||J?"radio":"checkbox"}),(0,U.jsx)(W().A,{debugName:"Form question option",capture:re,allowMenuList:!0,allowEsc:!0,allowCopyPaste:!0,allowUndo:!0,children:(0,U.jsx)(z().A,{value:ee,style:{padding:"2px 0px",paddingRight:3,maxWidth:Te?"calc(100% - 50px)":"100%",flexGrow:1,overflowX:"hidden"},focus:re,format:z().C.Transparent,onMouseDown:e=>e.stopPropagation(),onFocus:()=>{X(!1),le||S().clear({environment:o})},onClick:()=>ie(!0),onChange:e=>{ae(!1);const t=/,/g;t.test(e.target.value)&&h().D6({label:(0,U.jsx)(g().sA,{id:"questionModule.formSelectMultiSelectProperty.commaWarning",defaultMessage:"Commas are currently not supported."})});const o=e.target.value.replace(t,"").trim();te(o)},onKeyDown:e=>{"Backspace"===e.key&&""===ee&&xe()},onBlur:"temporary"===b?be:Ce,onSubmit:e=>{"temporary"===b?be():Ce(),r().default.afterNextFlush((()=>{Y(!0)}))}})}),Be&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(N().A,{placement:V().W.Top,textWrap:!0,renderTooltip:()=>(0,U.jsx)(w().ML,{featureAvailability:Ae,isAdmin:_e}),disableTooltip:Re,render:e=>(0,U.jsx)(F().A,{ref:Le,style:{width:24,height:24,flexGrow:0,marginRight:3,...Re&&Ve.conditionalButtonBorder},onClick:()=>{if("unavailable"===(null==Ae?void 0:Ae.type)&&"product"===(null==je?void 0:je.type))O().K(o,{upsell:je,from:"forms_conditional_logic"});else if("available"===(null==Ae?void 0:Ae.type))return we()},icon:p().C,iconStyle:{width:16,height:16},ariaLabel:d.formatMessage({defaultMessage:"Add conditional logic",id:"FormMultiSelectProperty.ConditionalLogicIcon.title"}),...e})}),Re&&(0,U.jsx)(I().O,{buttonRef:Le})]}),Te&&(0,U.jsx)(F().A,{style:{width:24,height:24,flexGrow:0},iconStyle:{width:18,height:18},onClick:()=>xe(!0),icon:u().trashIcon,ariaLabel:d.formatMessage({defaultMessage:"Delete option",id:"BlockPropertyRouter.FormSelectProperty.TrashIcon.title"})})]})]}):null}const Z=(0,g().YK)({deleteModalWithConditionalLogic:{id:"FormMultiSelectProperty.deleteModalWithConditionalLogic.prompt",defaultMessage:"Are you sure you want to delete this option? The conditional logic that depends on this option will also be removed."}})},125334:(e,t,o)=>{o.d(t,{A:()=>y});o(242343);var n=()=>o(237385),r=()=>o(803290),i=()=>o(850313),l=()=>o(518797),a=()=>o(409211),s=()=>o(326259),c=()=>o(653998),d=()=>o(76394),p=()=>o(413871),u=()=>o(888575),m=()=>o(732165),g=o(163643);function y(e){const{isMobile:t}=(0,n().Y0)();return(0,g.jsx)("div",{style:t?{padding:"12px 20px",fontSize:14}:{fontSize:12,display:"flex",alignItems:"center"},children:(0,g.jsx)(f,{...e})})}function f(e){const{verificationState:t,blockStore:o}=e,n=(0,c().tz)();switch(t.type){case"none":return null;case"verified":return t.isIndefinite?(0,g.jsx)(c().sA,{defaultMessage:"Verified by {user} on {date}",id:"VerificationSummary.verifiedIndefinitely",values:{user:(0,g.jsx)(v,{actorPointer:t.actorPointer,blockStore:o}),date:(0,s().OH)({dateTime:t.startDateTime,intl:n})}}):(0,g.jsx)(c().sA,{defaultMessage:"Verified by {user} from {dateTimeRange}",id:"VerificationSummary.verified",values:{user:(0,g.jsx)(v,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,s().do)({luxonRange:t.dateTimeRange,intl:n})}});case"expired":return(0,g.jsx)(c().sA,{defaultMessage:"Last verified by {user} from {dateTimeRange}",id:"VerificationSummary.verificationExpired",values:{user:(0,g.jsx)(v,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,s().do)({luxonRange:t.dateTimeRange,intl:n})}});default:(0,d().HB)(t)}}function v(e){const{actorPointer:t,blockStore:o}=e,n=(0,r().K8)((()=>p().sk.createChildStore(o,t)),[o,t]),s={display:"flex",marginLeft:4,marginRight:4};return n.table===a().oo?(0,g.jsx)(m().A,{userStore:n,inline:!0,style:s,avatarSize:16,avatarMarginRight:4}):n.table===l().GP?(0,g.jsx)(u().A,{botStore:n,style:s,avatarSize:16}):n.table===i().yj?(0,g.jsx)(m().A,{userStore:void 0,inline:!0,style:s,avatarSize:16,avatarMarginRight:4}):void(0,d().HB)(n)}},167464:(e,t,o)=>{o.d(t,{q:()=>i});var n=()=>o(129978);const r=new(n().O2)("RelationMenuRow",(async()=>{const{RelationMenuRow:e}=await Promise.all([o.e(43380),o.e(18766)]).then(o.bind(o,692645));return{RelationMenuRow:e}})),i=(0,n()._h)(r,(e=>e.RelationMenuRow))},261200:(e,t,o)=>{o.d(t,{C:()=>r});var n=()=>o(684092);function r(e){const{store:t,transient:o}=e;n().A.setState({isActive:!0,store:t,transient:Boolean(o)})}},354769:(e,t,o)=>{o.d(t,{N:()=>y,k:()=>g});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(500234);var n=()=>o(712437),r=()=>o(564134),i=()=>o(716605),l=()=>o(220959),a=()=>o(112907),s=()=>o(485966),c=()=>o(836331),d=()=>o(141122),p=()=>o(413871),u=()=>o(357608),m=()=>o(865226);function g(e){let{relationPointers:t,relatedPageStore:o,environment:r,from:i,peekMode:c,openInNew:g}=e;const{mainEditorCurrentBlockStore:y}=s().default.state;if(!y)return;const f=t.find((e=>e.id===o.id));if(!f)return;let v;if(g){const e=p().Bv.createChildStore(y,f),t=e.getModel(),o=a().E2(r,e);v=(0,l().A)({pageId:f.id,pageModel:t,baseUrl:o,pageVisitSource:n().y8.MentionInPage})}else{const e=y.getModel(),t=a().E2(r,y);v=(0,l().A)({pageId:y.id,pageModel:e,baseUrl:t,peekViewBlockId:f.id,peekMode:(0,d().getUrlParamFromPeekMode)("full_page"===c?void 0:c??d().default.state.mode),pageVisitSource:n().y8.MentionInPage}),(0,u()._)(r,{from:i,meta_click:Boolean(g)})}m().oo({environment:r,url:v,openInNew:g})}async function y(e){var t,o;const{update:n,environment:l,store:a,collectionStore:d,propertySchema:u}=e,m=a.state.isOpen?a.state:null,g=new Set(n.oldValues),y=n.newValues.filter((e=>!g.has(e)));if(!c().default.checkGate({gateName:"relation_two_way_limit_of_1_add_relation_confirmation_dialog"}))return!1;const f=s().default.state.currentUserSettingsStore;if(Boolean(null==f?void 0:f.getSettingsStore().getKeyStore("relation_limit_confirmation_dialog_dismissed_at").getValue()))return!1;if(1!==y.length||!m)return!1;const v=m.property,h=(null===(t=m.collectionContextStore)||void 0===t?void 0:t.collectionViewStore())||(null==d||null===(o=d.getParentBlockStore())||void 0===o?void 0:o.getCollectionViewStores()[0]);if(!d||!h||!u)return!1;const S=await async function(e){const{collectionStore:t,property:o,environment:n,targetCollectionStore:i}=e,l=t.getSchema()[o];if(!l||"relation"!==l.type)return!1;const a=r().Nv(l),s=l.property;if(!a||!s)return!1;const c=i??new(p().md)(n,a);await c.load();const d=c.getSchema();if(!(0,r().rd)({propertySchema:l,property:o,sourceCollectionId:t.id,targetCollectionSchema:d}))return!1;const u=d[s];return!(!u||"relation"!==u.type)&&Boolean(u.limit)}({collectionStore:d,property:v,environment:l});if(!S)return!1;const b=await async function(e){const{collectionStore:t,relationPointer:o,environment:n,property:r}=e,l=new(p().Bv)(n,o);await l.load();const a=t.getSchema()[r];if(!a||"relation"!==a.type)return;const s=a.property;if(!s)return;const c=l.getPropertyValue(s);if(!c)return;const[d]=i().n(c);return d}({collectionStore:d,relationPointer:y[0],property:v,environment:l});if(!b)return!1;const x=new(p().Bv)(l,b);await x.load();return{blockWithExistingRelationTitle:x.getPropertyValue("title"),currentBlockTitle:m.store.getPropertyValue("title"),update:n,canAccessBlockWithExistingRelation:x.canRead()}}},357608:(e,t,o)=>{o.d(t,{_:()=>r});var n=()=>o(137476);function r(e,t){n().vd(e,"relation_navigate_block",t)}},379171:(e,t,o)=>{o.d(t,{A:()=>w,O:()=>b});o(403517),o(242343);var n=()=>o(803290),r=()=>o(174114),i=()=>o(712437),l=()=>o(791976),a=()=>o(748267),s=()=>o(167089),c=()=>o(653998),d=()=>o(220413),p=()=>o(757172),u=()=>o(802370),m=()=>o(378219),g=()=>o(413871),y=()=>o(424339),f=()=>o(28210),v=o(163643);const h=(0,c().YK)({shared:{defaultMessage:"Shared",id:"CollectionLocation.SidebarTitle.sectionShared"},private:{defaultMessage:"Private",id:"CollectionLocation.SidebarTitle.sectionPrivate"},noAccess:{defaultMessage:"No access",id:"CollectionLocation.noAccess"},emptyCollectionName:{id:"CollectionLocation.EmptyCollectionName",defaultMessage:"Untitled"}});function S(e){return(0,v.jsx)("span",{style:{paddingTop:4,paddingLeft:4,...e.style},children:"/"})}function b(e){const{collectionForLocationStore:t,collectionContextStore:o}=e,i=(0,c().tz)(),p=(0,n().K8)((()=>{const e=m().fU(t);return e.reverse(),e}),[t]),{collectionIsInPrivate:u,collectionIsInRestricted:g,collectionIsInShared:y}=(0,n().K8)((()=>{const e=o.groupsForTypedDatabasesStore.state;return{collectionIsInPrivate:Boolean(null==e?void 0:e.privateDatabases[t.id]),collectionIsInRestricted:Boolean(null==e?void 0:e.restrictedDatabases[t.id]),collectionIsInShared:Boolean(null==e?void 0:e.sharedDatabases[t.id])}}),[o.groupsForTypedDatabasesStore,t.id],{useDeepEqual:!0}),f=(0,n().K8)((()=>(0,d().O4)({theme:"light"})),[]),b=(0,r().IS)((e=>({textStyle:{color:f.popoverWaxPaperBackground,fontWeight:"normal"},shareTypeIndicatorIcon:{width:20,height:20,marginRight:2,color:e.mediumIconColor,padding:2,backgroundColor:f.accentColors.gray[100],borderRadius:3}})),[f]),C=u||g||y;let w=null;return u?w=(0,v.jsxs)(v.Fragment,{children:[(0,a().g)(b.shareTypeIndicatorIcon),(0,v.jsx)("span",{children:i.formatMessage(h.private)})]}):g?w=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{...b.shareTypeIndicatorIcon,padding:0,paddingLeft:1,margin:0},children:(0,l().T)({...b.shareTypeIndicatorIcon,margin:0,background:void 0})}),(0,v.jsx)("span",{children:i.formatMessage(h.noAccess)})]}):y&&(w=(0,v.jsxs)(v.Fragment,{children:[(0,s().M)(b.shareTypeIndicatorIcon),(0,v.jsx)("span",{children:i.formatMessage(h.shared)})]})),(0,v.jsxs)("div",{style:{display:"flex"},children:[C&&(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4,...b.textStyle},children:[w,!g&&(0,v.jsx)(S,{style:{marginTop:-4,...b.textStyle}})]}),p.length>3?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(x,{ancestorStore:p[0],showDivider:!0}),(0,v.jsx)("span",{style:{paddingLeft:2,paddingTop:4,...b.textStyle},children:"..."}),(0,v.jsx)(S,{style:b.textStyle}),!(u||y)&&(0,v.jsx)(x,{ancestorStore:p[p.length-2],showDivider:!0}),(0,v.jsx)(x,{ancestorStore:p[p.length-1],showDivider:!1})]}):p.map(((e,t)=>(0,v.jsx)(x,{ancestorStore:e,showDivider:t<p.length-1},e.id)))]})}function x(e){const{ancestorStore:t,showDivider:o}=e,i=(0,n().K8)((()=>(0,d().O4)({theme:"light"})),[]),l=(0,r().IS)((e=>({teamIconStyle:{background:e.popoverWaxPaperBackground},textStyle:{color:i.popoverWaxPaperBackground,fontWeigth:"normal"}})),[i]);return t instanceof g().h4?(0,v.jsxs)("div",{style:{display:"flex"},children:[(0,v.jsx)(u().A,{store:t,showDivider:!1,maxWidth:160,iconSize:16,iconStyle:l.teamIconStyle,titleStyle:l.textStyle}),o&&(0,v.jsx)(S,{style:l.textStyle})]}):(0,v.jsxs)("div",{style:{display:"flex"},children:[(0,v.jsx)(p().A,{store:t,showDivider:!1,emojiSize:18,maxWidth:160,titleStyle:l.textStyle},t.id),o&&(0,v.jsx)(S,{style:l.textStyle})]})}function C(e){const{teamStore:t,collectionStore:o}=e,i=(0,n().K8)((()=>o.getIcon()),[o]),l=(0,r().IS)((e=>({miniTeamSpaceIcon:{background:e.home.tile.background,position:"absolute",bottom:-3,right:-3,borderRadius:2},teamSpaceIcon:{borderRadius:2,marginRight:2}})),[]);return i?(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",marginRight:2},children:[(0,v.jsx)(f().B,{icon:i,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),(0,v.jsx)(y().x,{store:t,disabled:!0,size:12,style:l.miniTeamSpaceIcon},"icon")]}):(0,v.jsx)(y().x,{store:t,disabled:!0,size:20,style:l.teamSpaceIcon},"icon")}const w=function(e){const{collectionContextStore:t,collectionForLocationStore:d}=e,p=(0,o(237385).v3)(),u=(0,c().tz)(),{collectionIsInPrivate:g,collectionIsInRestricted:y,collectionIsInShared:S}=(0,n().K8)((()=>{const e=t.groupsForTypedDatabasesStore.state;return{collectionIsInPrivate:Boolean(null==e?void 0:e.privateDatabases[d.id]),collectionIsInRestricted:Boolean(null==e?void 0:e.restrictedDatabases[d.id]),collectionIsInShared:Boolean(null==e?void 0:e.sharedDatabases[d.id])}}),[t.groupsForTypedDatabasesStore,d.id],{useDeepEqual:!0}),b=(0,n().K8)((()=>m().Uo(d)),[d]),x=(0,n().K8)((()=>(0,o(654548).r4)(d.getName(),d)??u.formatMessage(h.emptyCollectionName)),[d,u]),w=(0,n().K8)((()=>d.getIcon()),[d]),I=(0,n().K8)((()=>{var e;return null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id}),[t]),k=(0,n().K8)((()=>{let e=i().y8.LocationProperty;return I?((0,o(782422).sj)(I)&&(e=t.isInHomeWidgetStore.state?i().y8.PersonalHomeTileTasks:i().y8.PersonalHomePageTasks),e):e}),[I,t]),P=(0,r().IS)((e=>({button:{color:e.accentColors.gray[800],cursor:"pointer"},inner:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4},shareTypeIndicatorIcon:{width:20,height:20,marginRight:2,color:e.mediumIconColor,padding:2,backgroundColor:e.fill.lightGraySecondary,borderRadius:3},miniShareTypeIndicatorIcon:{position:"absolute",bottom:-3,right:-3,width:12,height:12,color:e.mediumIconColor,backgroundColor:e.fill.grayPrimary,borderRadius:3,paddingTop:1,paddingBottom:1},collectionTitleTextStyle:{lineHeight:1,fontWeight:o(31448).Wy.medium,marginTop:2,marginLeft:2,whiteSpace:"nowrap",...(0,o(361837).w_)(e)}})),[]);if(!(b||g||y||S))return null;const M=g||y||S;let R=(0,s().M)(P.shareTypeIndicatorIcon);return w?R=(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative"},children:[(0,v.jsx)(f().B,{icon:w,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),g?(0,a().g)(P.miniShareTypeIndicatorIcon):(0,s().M)(P.miniShareTypeIndicatorIcon)]}):y?R=(0,v.jsx)("div",{style:{...P.shareTypeIndicatorIcon,padding:0,paddingLeft:1,margin:0},children:(0,l().T)({...P.shareTypeIndicatorIcon,margin:0,background:void 0})}):g&&(R=(0,a().g)(P.shareTypeIndicatorIcon)),(0,v.jsx)(o(126451).A,{hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},style:P.button,onClick:e=>{const t=d.getParentBlockStore();if(t){const n=(0,o(302376).Vr)(e);o(191756).uK({environment:p,store:t,pageVisitSource:k,openInNew:n})}},children:(0,v.jsxs)("div",{style:P.inner,children:[b&&(0,v.jsx)(C,{teamStore:b,collectionStore:d}),M&&R,(0,v.jsx)("div",{style:P.collectionTitleTextStyle,children:x})]})})}},379481:(e,t,o)=>{o.d(t,{A:()=>r});o(725707),o(500234);class n extends(()=>o(151255))().A{findRow(e,t,o){return this.find((n=>n.relatedPageStoreId===e&&n.rowType===t&&n.property===o))}}const r=new n},424048:(e,t,o)=>{o.d(t,{n:()=>C});o(242343);var n=()=>o(237385),r=()=>o(803290),i=()=>o(174114),l=()=>o(564134),a=()=>o(427091),s=()=>o(981814),c=()=>o(653998),d=()=>o(31448),p=()=>o(354769),u=()=>o(981810),m=()=>o(907721),g=()=>o(638907),y=()=>o(308265),f=()=>o(126451),v=()=>o(103151),h=o(163643);const S=200,b=75,x=75;function C(e){let{blockStore:t,collectionContextStore:o,columnWidth:C}=e;const w=(0,n().v3)(),I=(0,y().BG)(),k=(0,r().O$)(o.currentSubitemFormatStoreForCollectionStore),P=(0,r().K8)((()=>t.getAssociatedCollectionStore()),[t]),M=(0,r().K8)((()=>{var e;return null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType()}),[o]),R=(0,r().K8)((()=>{if(!k||!P)return;const e=P.getSchema()[k.property];return void 0!==e&&(0,l().nC)(e)?e:void 0}),[P,k]),_="table"===M||"list"===M||"timeline"===M,A=(0,c().tz)(),j=w.device.isMobile?b:S,B=(0,i().IS)((e=>({parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:2},button:{height:20,display:"flex",alignItems:"center",color:e.text.tertiary,borderRadius:6,padding:"0 6px"},parentTitle:{..._?{maxWidth:C?Math.min(j,C-x):j}:{},fontWeight:d().Wy.medium,fontSize:d().J.UISmall.desktop,...d().RC}})),[C,_,j]),T=(0,r().K8)((()=>k&&R?(0,u().eO)({store:t,subitemFormat:k,propertySchema:R}):[]),[t,k,R]),V=(0,r().K8)((()=>{if(0===T.length)return;const e=T[0];return g().B.createChildStore(t,e)}),[t,T]),L=(0,r().K8)((()=>{var e;return null==V||null===(e=V.getModel())||void 0===e?void 0:e.getRenderTitleWithPlaceholder({getRecordModel:V.getRecordModel,userTimeZone:(0,a().P)(),intl:A,isWorkflowsAppContainerEnabled:I})}),[V,A,I]);return(0,r().K8)((()=>(0,u().xC)({collectionContextStore:o,blockStore:t})),[o,t])&&V?(0,h.jsx)(v().A,{renderTooltip:()=>(0,h.jsx)("div",{children:L}),alignment:m().C.Start,delayThreshold:300,render:e=>(0,h.jsxs)(f().A,{ariaLabel:A.formatMessage({id:"parentItemIndicator.button.openParentSidePeek.ariaLabel",defaultMessage:"Open parent in side peek"}),onClick:()=>{p().k({relationPointers:T,relatedPageStore:V,environment:w,from:"relation_property",peekMode:"side_peek"})},style:B.button,...e,children:[(0,s().j)(B.parentItemIcon),(0,h.jsx)("div",{style:B.parentTitle,children:L})]})}):null}},424714:(e,t,o)=>{o.d(t,{F:()=>r,n:()=>a});var n=()=>o(622286);const r=Symbol("loading"),i=Object.freeze({recomputeSchedule:{type:"debounce",debounceMs:250,maxWaitMs:500,initialValue:r}}),l=Object.freeze({});function a(){return(0,n().X)("experimental_computed_store_defer_debounce")?i:l}},473321:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkTriangleSmallIcon:()=>i,iconDefinition:()=>r});o(242343);var n=o(163643);const r={viewBox:"0 0 16 16",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.9 5.281a.625.625 0 0 0-.625.625v2.5a.625.625 0 0 0 1.25 0v-2.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,n.jsx)("path",{d:"M9.58 2.788c-.702-1.217-2.458-1.217-3.16 0l-4.677 8.1c-.702 1.216.176 2.737 1.58 2.737h9.354c1.405 0 2.283-1.52 1.58-2.738zm-2.078.625a.575.575 0 0 1 .996 0l4.677 8.1a.575.575 0 0 1-.498.862H3.324a.575.575 0 0 1-.498-.863z"})]})},i=(0,o(680369).wt)("exclamationMarkTriangleSmall",r)},508845:(e,t,o)=>{o.d(t,{C:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("arrowUpDown",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M10 16.8662C9.89518 16.8662 9.79492 16.848 9.69922 16.8115C9.60807 16.7751 9.52604 16.7181 9.45312 16.6406L5.90527 13.0244C5.75488 12.874 5.67969 12.6986 5.67969 12.498C5.67969 12.2839 5.74577 12.1107 5.87793 11.9785C6.01009 11.8464 6.18099 11.7803 6.39062 11.7803C6.49544 11.7803 6.58887 11.8008 6.6709 11.8418C6.75293 11.8828 6.82585 11.9352 6.88965 11.999L8.33203 13.4756L9.33008 14.6514L9.26855 13.1133V7.01562L9.33008 5.47754L8.33203 6.64648L6.88965 8.12988C6.82585 8.19368 6.75293 8.24609 6.6709 8.28711C6.58887 8.32357 6.49544 8.3418 6.39062 8.3418C6.18099 8.3418 6.01009 8.27799 5.87793 8.15039C5.74577 8.01823 5.67969 7.84277 5.67969 7.62402C5.67969 7.42806 5.75488 7.25488 5.90527 7.10449L9.45312 3.48828C9.52604 3.41081 9.60807 3.35384 9.69922 3.31738C9.79492 3.28092 9.89518 3.2627 10 3.2627C10.0957 3.2627 10.1891 3.28092 10.2803 3.31738C10.376 3.35384 10.4626 3.41081 10.54 3.48828L14.0879 7.10449C14.2383 7.25488 14.3135 7.42806 14.3135 7.62402C14.3135 7.84277 14.2451 8.01823 14.1084 8.15039C13.9762 8.27799 13.8076 8.3418 13.6025 8.3418C13.4977 8.3418 13.4043 8.32357 13.3223 8.28711C13.2402 8.24609 13.165 8.19368 13.0967 8.12988L11.6611 6.64648L10.6562 5.47754L10.7246 7.01562V13.1133L10.6562 14.6514L11.6611 13.4756L13.0967 11.999C13.165 11.9352 13.2402 11.8828 13.3223 11.8418C13.4043 11.8008 13.4977 11.7803 13.6025 11.7803C13.8076 11.7803 13.9762 11.8464 14.1084 11.9785C14.2451 12.1107 14.3135 12.2839 14.3135 12.498C14.3135 12.6986 14.2383 12.874 14.0879 13.0244L10.54 16.6406C10.4626 16.7181 10.376 16.7751 10.2803 16.8115C10.1891 16.848 10.0957 16.8662 10 16.8662Z"})})},514858:(e,t,o)=>{o.d(t,{u:()=>r});var n=()=>o(137476);function r(e,t,o){n().vd(e,t,o)}},519463:(e,t,o)=>{o.d(t,{W:()=>p});o(242343);var n=()=>o(803290),r=()=>o(174114),i=()=>o(564134),l=()=>o(762732),a=()=>o(31448),s=()=>o(314164),c=()=>o(981810),d=o(163643);function p(e){let{blockStore:t,collectionContextStore:o,wrapperStyle:p}=e;const u=(0,n().O$)(o.currentSubitemFormatStoreForCollectionStore),m=(0,n().K8)((()=>(0,s().Dj)({store:t,collectionContextStore:o})),[o,t]),g=(0,n().K8)((()=>{if(!u||!m)return;const e=m.getSchema()[u.property];return void 0!==e&&(0,i().nC)(e)?e:void 0}),[m,u]),y=(0,r().IS)((e=>({subItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:2},wrapper:{display:"inline-flex",alignItems:"center",verticalAlign:" text-top",paddingRight:8,...p},numSubitemsSpan:{fontSize:a().J.UISmall.desktop,fontWeight:a().Wy.medium,color:e.text.tertiary}})),[p]),f=(0,n().K8)((()=>u&&g?(0,c().rt)({store:t,subitemFormat:u,propertySchema:g}):[]),[t,u,g]);return(0,n().K8)((()=>(0,c().Kk)({collectionContextStore:o,blockStore:t})),[o,t])&&0!==f.length?(0,d.jsxs)("span",{style:y.wrapper,children:[(0,l().V)(y.subItemIcon),(0,d.jsx)("span",{style:y.numSubitemsSpan,children:f.length})]}):null}},546172:(e,t,o)=>{o.d(t,{ML:()=>a,Pe:()=>i});var n=()=>o(129978);const r=new(n().O2)("formEditorActionButtons",(()=>Promise.all([o.e(96159),o.e(75134),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(45620),o.e(62922),o.e(29616),o.e(69095)]).then(o.bind(o,30942)))),i=(0,n().jQ)(r,(e=>e.default)),l=new(n().O2)("conditionalLogicTooltip",(()=>o.e(16130).then(o.bind(o,630237)))),a=(0,n()._h)(l,(e=>e.ConditionalLogicTooltip))},618126:(e,t,o)=>{o.d(t,{E:()=>l});var n=()=>o(76394),r=()=>o(137476),i=()=>o(876695);function l(e,t,o){var l,a,s;let c="page_properties";const d=(0,i().sl)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;case"chart":case"form_editor":case"feed":case"map":case"chat":case"custom":break;default:(0,n().HB)(d.view_type)}const p={...o,collection_id:null==t||null===(l=t.collectionStore())||void 0===l?void 0:l.id,collection_view_id:null==t||null===(a=t.collectionViewStore())||void 0===a?void 0:a.id,collection_view_block_id:null==t||null===(s=t.collectionViewBlockStore())||void 0===s?void 0:s.id,from:c};r().vd(e,"copy_property",p)}},624153:(e,t,o)=>{o.d(t,{E:()=>F,V:()=>N});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(500234);var n=()=>o(752597),r=()=>o(819851),i=()=>o(577097),l=()=>o(564134),a=()=>o(716605),s=()=>o(871002),c=()=>o(846581),d=()=>o(16456),p=()=>o(465546),u=()=>o(427091),m=()=>o(361308),g=()=>o(34662),y=()=>o(123047),f=()=>o(975392),v=()=>o(76394),h=()=>o(141666),S=()=>o(448316),b=()=>o(144395),x=()=>o(443252),C=()=>o(927685),w=()=>o(284320),I=()=>o(73631),k=()=>o(137476),P=()=>o(361837),M=()=>o(654548),R=()=>o(876695),_=()=>o(213517),A=()=>o(909659),j=()=>o(477784),B=()=>o(836331),T=()=>o(618126),V=()=>o(396806),L=()=>o(665865),O=()=>o(91472),D=()=>o(111066),K=()=>o(84543);async function F(e){const{environment:t,theme:o,store:n,schema:l,property:c,collectionContextStore:m}=e,f=t.device,S=l[c],b=await O().R.clipboardActions.load();if(S){switch(S.type){case"formula":{const e=await I().T.formulas.load();"v2"===S.version?function(e){const{clipboardActions:t,environment:o,store:n,propertySchema:r,property:i,formulasModule:l}=e,a=n.getModel();if(!r.formula2||!a)return;const s=j().A.getIntl(),c=(0,u().P)(),d=l.evaluateCollectionFormula2({block:a,property:i,formulaCode:r.formula2.code,getRecordModel:n.getRecordModel,intl:s,userTimeZone:c,depth:0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,experimentService:B().default,collectionFeatureGates:(0,_().i)()});if(!d)return;const m=(0,p().Ht)(d),g=(0,M().r4)(m,n);t.copyString({stringValue:g,environment:o,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}({clipboardActions:b,environment:t,store:n,propertySchema:S,property:c,formulasModule:e}):function(e){var t;const{clipboardActions:o,environment:n,store:r,schema:i,property:l,propertySchema:a,formulasModule:c}=e,d=r.getValue();if(!d)return;const p=c.evaluateFormulaProperty({property:l,schema:i,block:d,getRecordValue:r.getRecordValue,collectionRequestContext:{userId:void 0,userTimeZone:(0,u().P)(),depth:0,intl:j().A.getIntl(),resultCache:new Map,regExpCache:new Map,visitedProperties:new Set,experimentService:B().default,collectionFeatureGates:(0,_().i)()}}),m=null==a||null===(t=a.formula)||void 0===t?void 0:t.result_type;switch(m){case"number":h().Et(p)&&z({clipboardActions:o,value:p,propertySchema:a,environment:n});break;case"date":p&&s().kC(p)&&E({clipboardActions:o,date:p,environment:n});break;case"text":p&&o.copyString({stringValue:p.toString(),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard});break;case"checkbox":case void 0:return;default:(0,v().HB)(m)}}({clipboardActions:b,environment:t,store:n,schema:l,property:c,propertySchema:S,formulasModule:e});break}case"person":{const e=n.getPropertyValue(c);W({actors:a().e5({textValue:e,propertySchema:S,blockCreatorPointer:n.getCreatedByPointer()}),clipboardActions:b,environment:t,store:n});break}case"created_by":{const e=n.getCreatedByPointer();e&&W({actors:[e],clipboardActions:b,environment:t,store:n});break}case"last_edited_by":{const e=n.getLastEditedByPointer();e&&W({actors:[e],clipboardActions:b,environment:t,store:n});break}case"number":z({clipboardActions:b,environment:t,propertySchema:S,value:a().Me(n.getPropertyValue(c))});break;case"text":{const e=n.getPropertyValue(c);if(!e)return;const r=y().$e({textValue:{value:e,spaceId:n.getSpaceId()},getRecordModel:n.getRecordModel,getRecordRole:n.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!1,disableLinks:!1,disabled:!1,userTimeZone:(0,u().P)(),isClient:!0,isAndroid:f.isAndroid,isSafariOrIOS:f.isSafari||f.isIOS,isWindows:f.isWindows,showEmojiInline:f.isWindows,emojiType:"raw",theme:o,baseUrl:C().A.domainBaseUrl,publicDomainName:C().A.publicDomainName,currentUserId:t.currentUser.id,intl:j().A.getIntl(),katex:void 0,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:w().A.state,isMobileNative:f.isMobileNative,isMobileNativeExternalLinkFixEnabled:B().default.checkGate({gateName:"mobile_native_external_link_fix"})}),i=(0,M().r4)(n.getPropertyValue(c),n);b.copyHtml({stringValue:i,htmlValue:r,environment:t,copiedMessage:b.clipboardMessages.copiedPropertyToClipboard});break}case"url":case"email":case"phone_number":{const e=g().k4p(n.getPropertyValue(c));b.copyString({stringValue:e,environment:t,copiedMessage:b.clipboardMessages.copiedPropertyToClipboard});break}case"date":{const e=n.getPropertyValue(c),o=(0,i().b)(e);o&&E({clipboardActions:b,date:o,environment:t,dateFormat:S.date_format,timeFormat:S.time_format});break}case"last_edited_time":case"created_time":{const e=n.getKeyStore(S.type).getValue();if(e){E({clipboardActions:b,date:d().KQ(e,(0,u().P)()),environment:t,dateFormat:S.date_format,timeFormat:S.time_format})}break}case"auto_increment_id":{const e=n.getPropertyValue(c);!function(e){const{clipboardActions:t,value:o,environment:n,collectionContextStore:i}=e;if(o&&i){var l;const e=(null===(l=i.collectionStore())||void 0===l||null===(l=l.getRecordKeyStore())||void 0===l?void 0:l.getRecordKey())??"";t.copyString({stringValue:(0,r().H4)(e,o),environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}({clipboardActions:b,value:a().On(e),environment:t,collectionContextStore:m});break}}(0,T().E)(t,m,{block_id:n.id,property:c,property_type:S.type})}}function W(e){const{actors:t,clipboardActions:o,environment:n,store:r}=e,i=a().AH(t);o.copyString({stringValue:(0,M().r4)(i,r),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard})}function z(e){const{clipboardActions:t,value:o,propertySchema:n,environment:r}=e;if(!f().yr(o)&&!h().pN(o)){const e=(null==n?void 0:n.number_format)||m().C4,i=m().ZV(o,e,j().A.getIntl());t.copyString({stringValue:i,environment:r,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}function E(e){const{clipboardActions:t,date:o,environment:n,dateFormat:r,timeFormat:i}=e,l=(0,c().ZF)({value:o,date_format:r??s().vz,time_format:i??s().CE,allowRelativeDates:!0,intl:j().A.getIntl()});t.copyString({stringValue:l,environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}async function N(e){const{element:t,rect:o,environment:r,onClick:i,store:s,additionalStores:c=[],property:d,format:p,collectionStore:u,blockPropertyValueOverlayStore:m,disableHorizontalEdgeScroll:g,collectionContextStore:y,collectionSchema:f,mouseStore:v,setMouseEntered:h,statusSetCheckbox:C,preventClearSelection:w,collectionsBulkActionsToolbarStore:I,scrollerContext:M,sizing:_,formQuestionStore:B,onClose:T,isDBUXMobileEnabled:O}=e,{device:F,WindowSizeStore:W}=r,z=y&&P().br({store:s,additionalStores:c,collectionContextStore:y});let E=u.getSchema();z&&(E=y.normalizedSchemaStore.state),f&&(E=f);const N=(0,A().L)({collectionStore:u,collectionContextStore:y,property:d}),H=E[N],U=null==H?void 0:H.type;if(!U)return;if(P().F1({property:d,collectionStore:u}))return;const Q=s.getPropertyStore(N);if("checkbox"===U)Q&&K().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{L().qS({stores:[s,...c],property:N,transaction:e})}}),y&&(0,V().E)({environment:r,collectionContextStore:y,block_id:Q.id,property:N,property_type:U,from:P().zP(p),isFromBulkActionsToolbar:Boolean(I)});else if("status"===U&&"status"===H.type&&C){const e=s.getPropertyValue(N),t=a().MC(e,H,j().A.getIntl());Q&&K().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{const o=H.groups??[],n=!0===t?o[0]:o[o.length-1],i=(H.options??[]).find((e=>{var t;return e.id===(null==n||null===(t=n.optionIds)||void 0===t?void 0:t[0])}));if(i)for(const t of[s,...c])S().R9({environment:r,store:t.getPropertyStore(N),value:a().wb(i.value),transaction:e})}})}else{if(-1===l().dA.indexOf(U)){null==h||h(!1),v&&v.setState({...v.state,mouseEntered:!1});const e=O?b().w1:b().Hp;if(t&&M&&F.isMobileNative&&e[U]===x().nl.Popup&&(D().hT({element:t,environment:r,scrollerContext:M,vertical:{reveal:"bottom",paddingToTopEdge:4,paddingToBottomEdge:W.getSafePaddingBottomPx(320)},horizontal:{reveal:"closest"}}),await n().default.afterNextFlush()),L().ho({environment:r,blockPropertyValueOverlayStore:m,store:s,additionalStores:c,property:N,format:p,rect:o,disableHorizontalEdgeScroll:g,collectionContextStore:y,collectionSchema:f,preventClearSelection:w,collectionsBulkActionsToolbarStore:I,sizing:_,formQuestionStore:B,onClose:T}),y){const e=(0,R().sl)(y)||{};k().vd(r,"collection_open_block_property_overlay",{property:N,property_type:U,property_context:void 0,from:P().zP(p),isFromBulkActionsToolbar:Boolean(I),...e})}}}i&&i()}},629443:(e,t,o)=>{o.d(t,{O:()=>h});var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(174114),a=()=>o(951592),s=()=>o(658388),c=()=>o(402557),d=()=>o(822493),p=()=>o(477784),u=()=>o(689248),m=()=>o(266963),g=()=>o(907721),y=()=>o(956070),f=o(163643);const v=(0,o(653998).YK)({tryConditionalLogicTooltip:{defaultMessage:"Try conditional logic",id:"ConditionalLogicIcon.tutorialTooltip.title"}});function h(e){const t=(0,r().v3)(),o=(0,i().K8)((()=>m().default.isVisible(y().wG)),[]),h=(0,a().ZC)(o),S=(0,n.useCallback)((()=>{h&&(s().p$({environment:t}),(0,u().a)(t,y().wG))}),[t,h]),b=(0,l().IS)((e=>({badge:{color:"rgba(102, 179, 255, 1)",background:"rgba(35, 131, 226, 0.3)",whiteSpace:"nowrap",display:"inline"},tutorialTooltipContent:{whiteSpace:"nowrap",margin:0,color:e.text.contrastPrimary},tutorialTooltip:{padding:"0 2px 4px 8px",borderRadius:8,marginBottom:4}})),[]),{buttonRef:x}=e,C=(0,f.jsxs)("div",{style:b.tutorialTooltipContent,children:[p().A.formatMessage(v.tryConditionalLogicTooltip),(0,f.jsx)("span",{children:(0,f.jsx)(c().A,{style:b.badge})})]});return(0,f.jsx)(d().k,{origin:x,hideCloseButton:!0,style:b.tutorialTooltip,hideActions:!0,placementToOrigin:"top",alignmentToOrigin:g().C.Center,showPointer:!1,content:C,onCloseClick:S,shouldDismissUponOutsideClick:!0})}},665831:(e,t,o)=>{function n(e){switch(null==e?void 0:e.type){case"url":case"email":case"phone_number":return e;default:return}}o.d(t,{z:()=>n})},675100:(e,t,o)=>{o.d(t,{H:()=>i});var n=o(242343),r=o(163643);const i=n.forwardRef((function(e,t){const{children:n,property:i,store:l}=e,a=(0,o(943977).y)({propertyId:i,store:l})||[];return(0,r.jsx)("div",{ref:t,className:a.length?a.join(" "):void 0,children:n})}))},689685:(e,t,o)=>{o.d(t,{V:()=>r});var n=()=>o(803290);function r(e){let{collectionContextStore:t,blockId:o,property:r,featureEnabled:i=!1}=e;return(0,n().K8)((()=>{if(!(i&&o&&r&&t))return!1;const e=t.virtualizedModule.getBlockHeightsCache();return e&&e.propertyCanExpandStore(o,r).state}),[t,o,r,i])}},719395:(e,t,o)=>{o.d(t,{DV:()=>s,PD:()=>a,Pr:()=>r,UB:()=>c,Wm:()=>l,Z6:()=>i});var n=o(242343);const r=n.createContext(void 0);r.displayName="ColumnVirtualizerContext";const i=n.createContext(!1);i.displayName="ColumnVirtualizerExistenceContext";const l=n.createContext({propertiesInRange:[],propertiesInRangeIndices:[],beforeWidth:0,afterWidth:0});function a(){return(0,n.useContext)(r)}function s(){return(0,n.useContext)(i)}function c(){return(0,n.useContext)(l)}l.displayName="ColumnVirtualizerVisiblePropertiesContext"},729687:(e,t,o)=>{o.d(t,{T:()=>i,m:()=>r});var n=()=>o(129978);const r=new(n().O2)("formPropertyRenderer",(()=>o.e(59111).then(o.bind(o,294245)))),i=(0,n().jQ)(r,(e=>e.default))},769687:(e,t,o)=>{o.d(t,{F:()=>r});var n=()=>o(137476);function r(e,t){n().vd(e,"relation_reorder",t)}},777277:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(129044))().default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return o(975392).o8(this.state)}}const r=new n},808971:(e,t,o)=>{o.d(t,{C:()=>r});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M16.837 5.797a.625.625 0 0 0 0-.884l-2.475-2.475a.625.625 0 0 0-.883.884l1.41 1.41h-2.917A4.63 4.63 0 0 0 8.7 6.089L6.404 8.386c-.63.63-1.485.986-2.377.99H2.595a.625.625 0 0 0 0 1.25h1.432a3.38 3.38 0 0 1 2.377.988L8.7 13.912a4.63 4.63 0 0 0 3.272 1.355h2.917l-1.41 1.411a.625.625 0 1 0 .883.884l2.475-2.475a.625.625 0 0 0 0-.884l-2.475-2.475a.625.625 0 1 0-.883.884l1.405 1.405h-2.912a3.38 3.38 0 0 1-2.388-.989L7.288 10.73a4.6 4.6 0 0 0-.95-.73c.344-.2.664-.444.95-.73l2.296-2.298a3.38 3.38 0 0 1 2.388-.99h2.912l-1.405 1.406a.625.625 0 1 0 .883.884z"})},r=(0,o(680369).wt)("arrowsDivergeRight",n)},872388:(e,t,o)=>{o.d(t,{_:()=>i});var n=()=>o(129978);const r=new(n().O2)("FilePropertyModule",(async()=>await o.e(5938).then(o.bind(o,540811)))),i=(0,n()._h)(r,(e=>e.FilePropertyModule))},887561:(e,t,o)=>{o.d(t,{r:()=>g});var n=o(242343),r=()=>o(174114),i=()=>o(822619),l=()=>o(96144),a=()=>o(326259),s=()=>o(86280),c=()=>o(653998),d=()=>o(76394),p=()=>o(31448),u=()=>o(342943),m=o(163643);function g(e){const{verificationValue:t,fontSize:o=u().Mi}=e,g=(0,c().tz)(),y=(0,n.useMemo)((()=>s().B2(t)),[t]),f=y.type,v=(0,r().IS)((e=>({icon:{width:"expired"===f?8:14,height:"expired"===f?9:14,fill:"verified"===f?e.blueColor:e.mediumIconColor},caption:{fontVariantNumeric:"normal",fontWeight:p().Wy.regular,color:e.text.primary,textTransform:"none",letterSpacing:0,marginLeft:6,marginRight:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:o,lineHeight:u().$g},expiredIconContainer:{width:14,height:14,borderRadius:6,border:"1px dashed",borderColor:e.mediumIconColor,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0}})),[f,o]);if("none"===f)return null;let h=null,S=null;const b=v.caption;switch(f){case"verified":h=(0,i().E)({...v.icon}),S=y.isIndefinite?(0,m.jsx)(c().sA,{defaultMessage:"Verified",id:"VerificationPropertyButton.verifiedIndefinitely"}):(0,m.jsx)(c().sA,{defaultMessage:"Until {date}",id:"VerificationPropertyButton.verifiedUntil",values:{date:a().OH({dateTime:y.dateTimeRange.end,intl:g})}});break;case"expired":h=(0,m.jsx)("div",{style:v.expiredIconContainer,children:(0,l().R)({...v.icon})}),S=(0,m.jsx)(c().sA,{defaultMessage:"Expired {timeFromMoment}",id:"VerificationPropertyButton.expired.text",values:{timeFromMoment:s().F7(y.dateTimeRange.end.setLocale(g.locale))}});break;default:(0,d().HB)(f)}return(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[h,(0,m.jsx)("div",{style:b,children:S})]})}},909659:(e,t,o)=>{o.d(t,{L:()=>i,y:()=>l});var n=()=>o(803290),r=()=>o(749975);function i(e){let{collectionStore:t,collectionContextStore:o,property:n}=e;return null!=o&&o.isMultiSourceView?t.getMappedProperty(n):n}function l(e){let{collectionStore:t,property:o}=e;const l=(0,r().Ks)();return(0,n().K8)((()=>i({collectionStore:t,collectionContextStore:l,property:o})),[t,l,o])}},918323:(e,t,o)=>{o.d(t,{M:()=>se});o(362833),o(725707),o(491955),o(403517),o(244387);var n=o(242343),r=()=>o(752597),i=()=>o(237385),l=()=>o(803290),a=()=>o(174114),s=()=>o(65866),c=()=>o(762847),d=()=>o(564134),p=()=>o(716605),u=()=>o(916963),m=()=>o(752903),g=()=>o(575185),y=()=>o(339189),f=o(163643);const v=(0,o(680369).wt)("replace",{viewBox:"0 0 16 16",svg:(0,f.jsx)("path",{d:"M3.26465 3.96094C2.95996 4.26562 2.979 4.66553 3.23291 4.8877C3.49316 5.12256 3.86133 5.12256 4.16602 4.83057C5.11182 3.80225 6.48291 3.15479 8 3.15479C10.6851 3.15479 12.856 5.12891 13.2051 7.66162H12.2466C11.7642 7.66162 11.6309 8.01709 11.9102 8.41064L13.4209 10.5435C13.6494 10.8608 13.9985 10.8608 14.2334 10.5435L15.7441 8.41699C16.0298 8.02344 15.8965 7.66162 15.4077 7.66162H14.519C14.1445 4.44336 11.3516 1.85986 8 1.85986C6.13379 1.85986 4.43262 2.68506 3.26465 3.96094ZM0.249512 8.42334C-0.0297852 8.81689 0.097168 9.17871 0.585938 9.17871H1.4873C1.85547 12.397 4.64844 14.9805 8 14.9805C9.87256 14.9805 11.5737 14.1553 12.748 12.873C13.0464 12.5684 13.0273 12.1685 12.7734 11.9399C12.5132 11.7051 12.1514 11.7114 11.8403 12.0034C10.9009 13.0381 9.52979 13.6855 8 13.6855C5.32129 13.6855 3.14404 11.7178 2.79492 9.17871H3.74707C4.22949 9.17871 4.36279 8.82324 4.0835 8.42969L2.57275 6.29688C2.34424 5.97949 1.99512 5.97949 1.7666 6.29688L0.249512 8.42334Z"})});var h=()=>o(668657),S=()=>o(145017),b=()=>o(34662),x=()=>o(653998),C=()=>o(31448),w=()=>o(197881),I=()=>o(137476);var k=()=>o(769687);var P=()=>o(665865),M=()=>o(626911),R=()=>o(373122),_=()=>o(865891),A=()=>o(795394),j=()=>o(759625),B=()=>o(564230),T=()=>o(354769),V=()=>o(448316),L=()=>o(384221),O=()=>o(84543),D=()=>o(982415),K=()=>o(749975),F=()=>o(167464),W=()=>o(129978);const z=new(W().O2)("RelationPropertyCustomizeLayoutMenu",(async()=>{const{default:e}=await Promise.all([o.e(43380),o.e(92222)]).then(o.bind(o,902496));return{RelationPropertyCustomizeLayoutMenu:e}})),E=(0,W()._h)(z,(e=>e.RelationPropertyCustomizeLayoutMenu));var N=()=>o(361837),H=()=>o(876695),U=()=>o(754697),Q=()=>o(400885),G=()=>o(360482),$=()=>o(755786),q=()=>o(696088),Y=()=>o(379481),Z=()=>o(121686),X=()=>o(210466),J=()=>o(413871),ee=()=>o(418293),te=()=>o(126451),oe=()=>o(97787),ne=()=>o(858023),re=()=>o(88271),ie=()=>o(103151),le=()=>o(743661);const ae={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0};function se(e){const t=(0,n.useContext)(K().p2),o=(0,l().uB)(void 0,X().A),r=(0,l().uB)(void 0,Z().A),[c,u]=(0,n.useState)(10),{schema:h,format:b,locked:C,property:w,collectionStore:P,store:R,disabled:A,visibility:j,isInPeekRenderer:V,topBorder:D,pagePropertiesStore:W,blockPropertyValueOverlayStore:z}=e,E=(0,i().v3)(),H=(0,l().K8)((()=>{const e=h[w];if(!e||"relation"!==e.type)return[];const t=R.getPropertyValue(w);return p().bG({relationValue:p().n(t),propertySchema:e,getRecordModel:R.getRecordModel,includeNoAccess:!0})}),[h,w,R],{useDeepEqual:!0}),U=(0,l().K8)((()=>H.length),[H.length]),$=(0,n.useCallback)(((e,t)=>function(e,t,o,n,r,i,l,a){const s=r[i];if(!s||"relation"!==s.type)return;const c=d().Nv(s);if(!c)return;const u=J().md.createChildStore(l,c);if(!(0,G()._p)(l)||!i)return;const m=l.getPropertyValue(i),g=p().n(m),y=[...e.map((e=>({id:e,spaceId:n.pointer.spaceId,table:S().ev}))),...g.slice(e.length)];ye({newValues:y,oldValues:g},u,l,i,o),(0,k().F)(o,{from:"relation_section"}),_().pl({store:a,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition,footerFocused:!1}})}(e,t,E,P,h,w,R,o)),[E,P,h,w,R,o]),Y=(0,n.useCallback)(((o,n,r)=>he(o,n,r,E,e.blockPropertyValueOverlayStore,R,w,t,ie)),[t,E,w,e.blockPropertyValueOverlayStore,R]),ie=(0,n.useRef)(null),se=(0,i().Y0)(),ue=h[w],Se=(0,l().K8)((()=>null==t?void 0:t.permissionScopesStore.state),[t]),be=(0,l().K8)((()=>{if("relation"===(null==ue?void 0:ue.type)&&t)return ue}),[t,ue]),xe=(0,l().K8)((()=>{if(!be)return;const e=d().Nv(be);return e?J().md.createChildStore(R,e):void 0}),[be,R]),Ce=(0,l().K8)((()=>(null==xe?void 0:xe.canEdit())??!1),[xe]),we=(0,l().K8)((()=>{const e=P.getSchema()[w];return Boolean(e&&d().UU(e))}),[P,w]),Ie=(0,l().K8)((()=>R.canEdit()),[R]),ke=(0,l().K8)((()=>(0,Q().fc)(R)),[R]),Pe=(0,a().IS)((e=>({addNewRelationButtonWrapper:me(e),addNewRelationButtonIcon:ge(e,se.isMobile),replacePageSprint:{color:e.text.secondary}})),[se.isMobile]),Me=(0,n.useMemo)((()=>H.slice(0,c)),[H,c]),Re=(0,l().K8)((()=>(null==xe?void 0:xe.getFormatStore().getKeyStore("app_config_uri").getValue())===s().av),[xe]),_e=1===(null==be?void 0:be.limit),Ae=!(se.isMobile||A||C||_e),je=(0,q().l)(R),Be=(0,l().K8)((()=>{var e;return"hide"===(null==je||null===(e=je.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[je]),Te=(0,n.useCallback)((()=>{xe&&be&&(Re?fe(xe,e.store,e.property,H,E):we||_e?Y(!0):ve(H.length>=c?c:H.length+1,xe,"relation_section_footer",E,R,w,P,c,u,t,be))}),[t,P,c,E,Y,_e,we,Re,w,e.property,e.store,be,H,R,xe]),Ve=(0,l().K8)((()=>{if(!xe||!be||!P)return[];const e=xe.getFormatStore().getKeyStore("app_config_uri").getValue()===s().av;return Me.reduce(((n,r,i)=>{const l=J().Bv.createChildStore(R,r),a=l.getAssociatedCollectionStore(),s=!l.canRead();if((null==a?void 0:a.id)===d().zO(be)||s){const r={key:l.id,render:n=>{let{ref:r,...a}=n;return(0,f.jsx)(F().q,{...a,canDrag:Ae&&1!==be.limit&&R.canEdit(),schema:h,propertySchema:be,collectionStore:P,collectionId:P.id,targetCollectionStore:xe,relatedPageStore:l,disabled:A,locked:C,isSelected:!0,pageStore:R,property:w,rowType:"section",onActionButtonClick:()=>function(e,t,o,n,r,i,l,a,s,c){const d=i[l];if("relation"!==(null==d?void 0:d.type)||!c)return;if((0,Q().fc)(r))return;const p=d.limit,u=p?[]:e.filter((e=>e.id!==t.id));O().createAndCommit({userAction:"RelationSection.handleRemoveRelationClick",environment:n,canUndo:!0,perform:e=>{M().Iq({store:r,propertyId:l,value:u,environment:n,relatedPageId:t.id,propertySchema:d,transaction:e,collectionContextStore:c,analyticsData:{isFromBulkActionsToolbar:N().pi(a),analyticsFrom:N().zP("page")},isUnthrottled:!1})}}),function(e,t){I().vd(e,"relation_remove_block",t)}(n,{from:"relation_section",collection_id:null==s?void 0:s.id,target_collection_id:null==o?void 0:o.id})}(H,l,xe,E,R,h,w,z,P,t),onMouseLeave:()=>o.unsetFocus(),onSecondaryButtonClick:()=>ve(i+1,xe,"relation_section_inline",E,R,w,P,c,u,t,be),onInsertInline:e?()=>{L().clear({environment:E})}:()=>ve(i+1,xe,"relation_section_inline",E,R,w,P,c,u,t,be),onTitleEsc:()=>{var e;!Boolean(null===(e=l.getTitleStore())||void 0===e||null===(e=e.getValue())||void 0===e?void 0:e.length)&&"relation"===be.type?function(e){const{relatedPageStore:t,environment:o,store:n,property:r}=e;if((0,Q().fc)(n))return;O().createAndCommit({userAction:"RelationSection.handleDeleteRelatedPage",environment:o,canUndo:!0,perform:e=>{const i={pointer:t.pointer,command:"update",path:[],args:{alive:!1}};O().applyOperation({store:t,operation:i,transaction:e}),B().zB({environment:o,store:n,propertyId:r,id:t.id,transaction:e})}})}({relatedPageStore:l,environment:E,store:R,property:w}):L().clear({environment:E})},onOpenPageButtonClick:s?void 0:()=>{T().k({relationPointers:H,relatedPageStore:l,environment:E,from:"relation_section_inline"})},index:i+1,propertyLimit:be.limit})},action:e=>{}};n.push(r)}return n}),[])}),[xe,be,P,Me,R,Ae,h,A,C,w,H,E,z,t,o,c]);if(!("section_hide"!==j&&be&&xe&&t&&Se))return null;if("minimal"===j)return(0,f.jsx)(de,{property:w,propertySchema:be,numberOfRelations:U,onHandleOpenProperty:Y,onHandleRelationPropertyPageSectionRefMount:e=>{e&&(ie.current=e)},schema:h,format:b,disabled:A,locked:C,canConfigureCollection:Se.canConfigureCollection,blockStore:R,collectionStore:P,collectionContextStore:t,isInPeekRenderer:V,targetCollectionStore:xe,pagePropertiesStore:W,shouldHideIcon:Be});const Le=Ve.map((e=>e.key.toString())),Oe=(0,f.jsx)(ne().Ay,{type:ne().Oh.Vertical,store:o,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"section",render:e=>(0,f.jsx)(re().A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:Ae?(0,f.jsx)(oe().Ay,{direction:"vertical",keys:Le,renderKey:t=>e.children[Le.indexOf(t)],onDrop:$,store:r}):e.children}),items:Ve}]});return(0,f.jsx)(pe,{collectionContextStore:t,isConnectedRelation:we,title:e.propertyRowName??(0,f.jsx)(le().I,{schema:h,format:b,property:w,blockStore:R,collectionStore:P,disabled:A,locked:C,canConfigureCollection:Se.canConfigureCollection,styleVariants:ce,isInPeekRenderer:V,pagePropertiesStore:W,hideIcon:Be}),collectionStore:P,targetCollectionStore:xe,property:w,showRight:!0,disabled:A,schema:h,format:b,locked:C,canEditTargetCollection:Ce,canConfigureCollection:Se.canConfigureCollection,canEditCurrentPage:Ie,handleMouseMove:e.handleMouseMove,onHandleOpenProperty:()=>{he(!1,void 0,void 0,E,z,R,w,t,ie)},onHandleRelationPropertyPageSectionRefMount:e=>{e&&(ie.current=e)},onTitleEnter:()=>ve(void 0,xe,"relation_section_inline",E,R,w,P,c,u,t,be),handleClearProperty:()=>fe(xe,R,w,H,E),topBorder:D,children:(0,f.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexWrap:"wrap",flexDirection:"column",width:"100%",...se.isMobile&&{paddingLeft:"none"}},onMouseMove:e.handleMouseMove,onMouseLeave:e.handleMouseLeave,children:[Oe,H.length>c&&(0,f.jsx)(te().A,{style:{width:"100%",display:"flex",alignItems:"center",borderRadius:3,fontSize:14,minHeight:30,margin:0,padding:"6px 8px 7px 8px"},onClick:()=>u(c+10),children:(0,f.jsx)(ee().A,{count:H.length-c,format:m().NY.Medium,style:{margin:void 0},fixedHeight:!1,isCompact:!1})}),Ce&&Ie&&!C&&!ke&&(0,f.jsx)(te().A,{style:Pe.addNewRelationButtonWrapper,onClick:Te,disabled:A||C,children:0===U?(0,f.jsxs)(f.Fragment,{children:[(0,y().W)({...Pe.addNewRelationButtonIcon,marginLeft:6,marginRight:6}),(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.button.addPage",defaultMessage:"New"})]}):(0,f.jsxs)(f.Fragment,{children:[Re?(0,g().M)({width:16,height:16,marginRight:11,marginTop:1,marginLeft:4,fill:"#868682"}):1===be.limit?v(Pe.addNewRelationButtonIcon):(0,y().W)(Pe.addNewRelationButtonIcon),(0,f.jsxs)("div",{style:ae,children:[Re&&(0,f.jsx)("span",{style:Pe.replacePageSprint,children:(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.button.replacePageSprint",defaultMessage:"Move to backlog"})}),!Re&&(1===be.limit?(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.button.replacePage",defaultMessage:"Replace"}):(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.button.addPage",defaultMessage:"New"}))]})]})})]})},w)}const ce={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"};function de(e){const{property:t,propertySchema:o,numberOfRelations:r,schema:i,format:c,disabled:d,locked:p,canConfigureCollection:m,blockStore:g,collectionStore:y,onHandleOpenProperty:v,onHandleRelationPropertyPageSectionRefMount:h,isInPeekRenderer:S,targetCollectionStore:b,pagePropertiesStore:w,shouldHideIcon:I}=e,k=(0,a().IS)((e=>({hoverButton:{display:"flex",alignItems:"baseline",justifyContent:"normal",color:e.text.secondary,width:"100%"},minimalButton:{display:"flex",alignItems:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:4,fontSize:14,lineHeight:1.2,minWidth:0,paddingLeft:6,paddingRight:8,fontWeight:C().Wy.regular,color:e.text.tertiary},minimalButtonWrapper:{width:"100%",maxWidth:"100%",fontWeight:C().Wy.regular,color:e.text.tertiary},iconStyle:{width:14,height:14,fill:e.lightIconColor,marginRight:6,alignItems:"baseline"},minmalButtonLabelStyle:{...C().RC}})),[]),P=(0,a().DP)(),M=(0,n.useCallback)((e=>{d||p||!m||(e.preventDefault(),w.setState({...w.state,openProperty:{property:t,isInPeekRenderer:S}}))}),[d,p,m,w,t,S]),R=(0,n.useCallback)((e=>{v(!0)}),[v]),_=(0,n.useMemo)((()=>({size:"medium",fontWeight:"regular",width:{variant:"hug-content",maxWidthDesktop:300,maxWidthMobile:300}})),[]),A=(0,n.useCallback)((()=>{w.setState({...w.state,hoveredProperty:t})}),[t,w]),j=(0,n.useCallback)((()=>{w.setState({...w.state,hoveredProperty:void 0})}),[w]),B=(0,l().K8)((()=>b.getFormatStore().getKeyStore("app_config_uri").getValue()),[b]),T=(0,D().$O)(s().av),V=(0,D().oj)(s().av);return(0,f.jsx)("div",{style:k.hoverButton,onMouseMove:A,onMouseLeave:j,children:(0,f.jsx)(le().I,{schema:i,format:c,property:t,blockStore:g,collectionStore:y,disabled:d,locked:p,canConfigureCollection:m,styleVariants:_,pagePropertiesStore:w,labelComponent:(0,f.jsx)("div",{ref:h,style:k.minimalButtonWrapper,children:(0,f.jsxs)(te().A,{style:k.minimalButton,onClick:R,onContextMenu:M,children:[(0,f.jsx)(u().zB,{size:14,style:k.iconStyle,theme:P,type:o.type??"relation",icon:o.icon}),(0,f.jsx)("div",{style:k.minmalButtonLabelStyle,children:B===s().av?(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.sprints.showSprintRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {singleTypedItemName}} other {{numberOfRelations} {pluralTypedItemName}}}",values:{numberOfRelations:r,propertyName:o.name,singleTypedItemName:T,pluralTypedItemName:V}}):(0,f.jsx)(x().sA,{id:"RelationPropertyPageSection.showRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {propertyName}} other {{numberOfRelations} {propertyName}}}",values:{numberOfRelations:r,propertyName:o.name}})})]},`minimal-section-${t}`)}),hideDragHandle:!0,isInPeekRenderer:S,hideIcon:I})})}function pe(e){const{collectionStore:t,targetCollectionStore:o,property:r,showRight:a,disabled:c,style:d,children:p,canConfigureCollection:u,isConnectedRelation:m,canEditCurrentPage:g,handleMouseMove:y,onHandleOpenProperty:v,onHandleRelationPropertyPageSectionRefMount:S,topBorder:b,collectionContextStore:C}=e,w=(0,l().K8)((()=>o.isSyncedCollection()),[o]),I=(0,l().K8)((()=>o.getFormatStore().getKeyStore("app_config_uri").getValue()===s().av),[o]),k=(0,l().K8)((()=>C.permissionScopesStore.state),[C]),P=(0,i().v3)(),[M,R]=(0,n.useState)(!1),_=P.device.isMobile?a:a&&M;return(0,f.jsx)("div",{style:{width:"100%"},ref:S,onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),children:(0,f.jsx)(re().A,{...e,topBorder:b,children:p,noTextOverflow:!1,disableMobilePadding:!0,right:_&&!w&&!k.isExternallyImportedAndSyncedCollection&&!m&&(0,f.jsxs)("div",{style:{height:"100%",display:"flex",alignItems:"center",width:"100%"},children:[g&&(0,f.jsx)(ue,{disabled:c,handleMouseMove:y,onClick:v,icon:h().q,tooltipMessage:I?(0,f.jsx)(x().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButtonSprints.message",defaultMessage:"Search for a sprint"}):(0,f.jsx)(x().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButton.message",defaultMessage:"Link a page"})},`searchIcon-${r}`),(0,f.jsx)(E,{collectionStore:t,targetCollectionStore:o,property:r,disabled:c||!u,rowType:"section"})]}),style:{paddingTop:0,paddingBottom:0,width:"100%",...d},mobileStyle:{boxShadow:"none"},desktopTitleStyle:{marginTop:0,marginBottom:4,paddingLeft:0,paddingRight:8,fontWeight:"normal"},mobileTitleStyle:{paddingLeft:0,alignItems:"center",fontWeight:"normal"}})})}function ue(e){const{disabled:t,handleMouseMove:o,onClick:n,icon:r,tooltipMessage:i}=e,l=(0,a().IS)((e=>({buttonStyle:{width:24,height:24,borderRadius:4,display:"inline-flex",alignItems:"center",justifyContent:"center",marginRight:4},iconStyle:{width:14,height:14,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]);return(0,f.jsx)(ie().A,{renderTooltip:()=>i,render:e=>(0,f.jsx)(te().A,{style:l.buttonStyle,onMouseMove:o,onClick:n,disabled:t,...e,children:r(l.iconStyle)})})}function me(e){return{display:"flex",alignItems:"center",color:e.text.tertiary,borderRadius:4,paddingRight:4,height:32,width:"100%",fontSize:14}}function ge(e,t){return{width:16,height:16,marginRight:t?7:11,marginTop:1,marginLeft:5,fill:e.lightIconColor}}function ye(e,t,o,n,i){if(!(0,G()._p)(o)||!n)return;let l;O().createAndCommit({userAction:"RelationToken.handleRelationPropertyMenuUpdate",environment:i,canUndo:!0,perform:r=>{const a=t.id;if(e.newPage&&a){const a=b().x9d(e.newPage.name);l=j().Wv({environment:i,id:e.newPage.id,type:c().xd.page,properties:{title:a},spaceId:e.newPage.spaceId,inMemoryRecordCache:t.inMemoryRecordCache,transaction:r}),A().X$({childStore:l,parentStore:t,transaction:r});const s=J().Bv.createChildStore(o,l.pointer),d=t.getDefaultTemplatePageStore();return d&&R().n5({title:{text:a},environment:i,store:s,templateStore:d,isKeyboard:!1,isCreateIn:!1,transaction:r,from:"relation_property_page_section"}),void B().K6({store:o,propertyId:n,id:l.id,environment:i,transaction:r,position:{type:"after"}})}if(e.newValues){const t=p().Ap(e.newValues),l=o.getPropertyStore(n);V().R9({environment:i,store:l,value:t,transaction:r})}}}),r().default.afterNextFlush((()=>{if(!l)return;const e=Y().A.findRow(l.id,"section",n);if(!e)return;const t=e.relationTokenBlockStoreRef.current;if(!t)return;const o=t.getBlockTitleStore(),r={start:{index:0,store:o},end:{index:0,store:o}};L().setMultiSelection({multiSelection:r})}))}function fe(e,t,o,n,r){ye({newValues:[],oldValues:n},e,t,o,r)}function ve(e,t,o,n,r,i,l,a,s,c,d){if(!d||"relation"!==d.type)return;if(!r.canEdit())return;if((0,Q().fc)(r))return;const u=l.pointer.spaceId,m=d.limit,g=(0,U().zP)({environment:n,table:S().ev,spaceId:u}),y=g.id;if(!(0,G()._p)(r)||!i)return;const f=r.getPropertyValue(i),v=p().n(f);e&&e+1>a&&s(e+1);ye({newPage:{id:y,spaceId:u,name:""},newValues:m?[g]:e?[...v.slice(0,e),g,...v.slice(e)]:[g,...v],oldValues:v},t,r,i,n),w().v(n,{...(0,H().sl)(c),from:o,type:"page",target_collection_id:null==t?void 0:t.id,new_page_id:y,creating_block_id:y})}function he(e,t,o,n,r,i,l,a,s){const c=s.current;if(!(c&&c instanceof Element))return;if((0,Q().fc)(i))return;const d=o?null==o?void 0:o.getBoundingClientRect():c.getBoundingClientRect(),p=e?d.top+$().d0:d.top+5,u=new DOMRect(d.left,p,d.width,d.height);P().ho({environment:n,blockPropertyValueOverlayStore:r,store:i,property:l,rect:u,format:"page",mode:t,collectionContextStore:a}),function(e,t){I().vd(e,"relation_section_link_pages",t)}(n,{from:"relation_section"})}},931177:(e,t,o)=>{o.d(t,{x:()=>r});var n=()=>o(137476);function r(e,t){n().vd(e,"click_block_property_url",t)}},964968:(e,t,o)=>{o.d(t,{W:()=>y,w:()=>g});o(362833);var n=()=>o(935664),r=()=>o(891186),i=()=>o(66460),l=()=>o(896910),a=()=>o(23371),s=()=>o(927685),c=()=>o(170745),d=()=>o(449596),p=()=>o(802955),u=()=>o(836331),m=()=>o(273541);async function g(e){const{environment:t}=e;return(await a().lX(Object.keys(d().A.state.offlinePages||{}),100,(e=>async function(e){const{environment:t,pageId:o}=e,a={page:{id:o,spaceId:(0,i().e)(void 0)},baseUrl:s().A.domainBaseUrl,publicDomainName:s().A.publicDomainName,shouldTraverseToggleBlocks:!0,limit:1/0,cursor:{stack:[]},verticalColumns:!1},d=[];return await n().T(a,r().h.sideEffect((e=>((0,l().u)(e)&&d.push(e.id),Promise.resolve())),r().h.fromMonomorphicFunctionUnsafe((async e=>{const o=await c().h7({environment:t,pointer:e,useInMemoryCacheOnly:!1,skipAccessWrites:!0});return null==o?void 0:o.model})))),d}({environment:t,pageId:e})))).flat()}function y(e,t){return!p().A.state.online&&(e.device.isElectron||e.device.isMobileNative)&&u().default.checkGate({gateName:"download_for_offline"})&&!(0,m().Bd)(t)}}}]);