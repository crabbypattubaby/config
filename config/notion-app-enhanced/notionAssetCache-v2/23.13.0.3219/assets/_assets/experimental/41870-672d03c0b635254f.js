"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[41870],{21355:(e,t,n)=>{n.d(t,{j:()=>s});const s=(0,n(680369).xh)("slack",{default:{loader:()=>n.e(15891).then(n.bind(n,35885))},darkMode:{loader:()=>n.e(15891).then(n.bind(n,530469))}})},30958:(e,t,n)=>{n.d(t,{$B:()=>g,Fl:()=>r,KI:()=>l,PI:()=>a,S:()=>c,Tq:()=>m,_u:()=>o,e5:()=>i,fK:()=>u,fl:()=>s,lF:()=>d});n(725707),n(500234);const s=["slack","google_drive","github","jira","sharepoint","microsoftTeams","gmail","linear"],a=["slack","googleDrive","github","jira","microsoftTeams","sharepoint","gmail","linear","web","githubCode"],o="7c57d10c-00cc-48bc-a552-fb3911dd7745",i="1031cb6c-4935-4cc1-9c08-c9a4ecaae323",r="65683ef9-c923-4a14-8c5b-bfcf591cf5a1",c="c1f230b1-6635-4ab0-a3f5-f7eb105a87c3",d="c91548d4-25d0-44a2-ab2e-19f6f0b11d96",l="1724f2a1-f543-43a7-82af-8a0f85bda112",u="07351274-83bb-4118-9f5b-9d75f0453999",g="6694bee1-9451-4484-a972-f56741db481e",p=[{regex:/https:\/\/(?<workspace>[\w-]+)\.slack\.com\/archives\/(?<channel>[^\/]+)\/p(?<timestamp>\d+)(\?thread_ts=(?<thread_ts>\d+\.\d+)&cid=(?<cid>[^\/]+))?/,type:"slack"},{regex:/https:\/\/docs\.google\.com\/(?<fileType>document|spreadsheets|presentation)\/d\/(?<fileId>[a-zA-Z0-9_-]+)(?:\/\S*)?/,type:"googleDrive"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?:blob|tree|blame)\/(?<branchName>[^\/]+)\/(?<codePath>[^#]+)(#(?<lineNumber>L\d+(?:C\d+)?(?:-L\d+)?))?/,type:"githubCode"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/pull\/(?<prNumber>\d+)(\/(files|commits|checks)?)?/,type:"github"},{regex:/https:\/\/app\.graphite\.dev\/github\/pr\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?<prNumber>\d+)(?:\/\S*)?/,type:"github"},{regex:/https:\/\/(?:[^\.]+)\.sourcegraphcloud\.com\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/@]+)(?:@(?<branchName>[a-f0-9]+))?\/-\/blob\/(?<codePath>[^?]+)\?(?<lineNumbers>L\d+|l\d+)?/,type:"githubCode"},{regex:/https:\/\/(?<site>[^/]+\.atlassian\.net).*?(?:browse\/|[?&]selectedIssue=)(?<issueKey>[A-Z0-9]+-\d+).*?/,type:"jira"}];function m(e){const t=p.find((t=>t.regex.test(e)));return(null==t?void 0:t.type)??"web"}},65062:(e,t,n)=>{n.d(t,{$t:()=>f,G9:()=>m,HF:()=>h,LT:()=>S,_1:()=>p});n(358848),n(362833),n(91270);var s=()=>n(76394),a=()=>n(366470),o=()=>n(688522),i=()=>n(980936),r=()=>n(216842),c=()=>n(873573),d=()=>n(145652),l=()=>n(836331),u=()=>n(14944),g=()=>n(330469);const p=["slack_select_channels","slack_re_auth","github_re_auth","jira_connection_pending","sharepoint_select_sites"];function m(e,t){const n=[];if("slack"===e){const{noChannelsSelected:e,ingestionProgress:s,canQuery:a,isSyncCompleted:i,isSlackGridAiConnectorEnabled:r}=o().R.state;e&&void 0===s&&t&&n.push({type:"slack_select_channels"}),r||!i||void 0!==s||a||n.push({type:"slack_re_auth"})}else if("google_drive"===e);else if("jira"===e){const{jiraSyncState:e}=g().y.state;l().default.checkGate({gateName:"install_from_jira_marketplace"})&&"pending_connection"===e&&n.push({type:"jira_connection_pending"})}else if("sharepoint"===e){const{connectionDetails:e}=d().E.state;"pending_selection"===(null==e?void 0:e.status)&&n.push({type:"sharepoint_select_sites"})}else if("microsoftTeams"===e);else if("gmail"===e);else if("linear"===e);else{if("github"!==e)return(0,s().HB)(e);{const{githubOrg:e,isPersonalAuthComplete:t,isDisconnecting:s,forceShowGithubAuthNotificationTriggeredAt:a}=i().o.state;(a||null!=e&&e.isSyncComplete&&!t&&!s)&&n.push({type:"github_re_auth"})}}return n}function S(e){if("slack"===e){const{inProgress:e,ingestionProgress:t,isSlackGridAiConnectorEnabled:n}=o().R.state;return n?{isInProgress:!1}:e?{isInProgress:!0,ingestionProgress:t??0}:{isInProgress:!1}}if("google_drive"===e){const{ingestionProgress:e}=u().d.state;return void 0!==e?{isInProgress:!0,ingestionProgress:e}:{isInProgress:!1}}if("github"===e){const{status:e}=i().o.state;return"in_progress"===e?{isInProgress:!0,ingestionProgress:void 0}:{isInProgress:!1}}if("jira"===e){const{jiraSyncState:e,jiraSyncProgress:t}=g().y.state;return"in_progress"===e||"editing"===e?{isInProgress:!0,ingestionProgress:t}:{isInProgress:!1}}if("sharepoint"===e){const{connectionDetails:e}=d().E.state;return"in_progress"===(null==e?void 0:e.status)?{isInProgress:!0,ingestionProgress:null==e?void 0:e.progress}:{isInProgress:!1}}if("microsoftTeams"===e){const{connectionStatus:e,syncProgressPercentage:t}=c().F.state;return"in_progress"===e?{isInProgress:!0,ingestionProgress:t}:{isInProgress:!1}}if("gmail"===e)return{isInProgress:!1};if("linear"===e){const{status:e,ingestionProgress:t}=r().W.state;return"in_progress"===e?{isInProgress:!0,ingestionProgress:t}:{isInProgress:!1}}return(0,s().HB)(e)}function f(e){if("sharepoint"===e){const{connectionDetails:e}=d().E.state;return"disconnecting"===(null==e?void 0:e.status)}return Boolean(a().NT[e].state.isDisconnecting)}function h(e,t){const n=m(e,t).at(0);if(n)return{type:"action_required",action:n.type};const s=S(e);return s.isInProgress?{type:"in_progress",ingestionProgress:s.ingestionProgress}:f(e)?{type:"disconnecting"}:{type:"connected"}}},108797:(e,t,n)=>{n.r(t),n.d(t,{connectSpaceToJiraSite:()=>me,disconnectConnector:()=>pe,getGithubStatus:()=>z,getJiraAIConnectionStatusAction:()=>$,getJiraSyncControlAction:()=>q,getLinearConnectorStatus:()=>ge,getMicrosoftTeamsAIConnectorStatusAction:()=>se,getMicrosoftTeamsSyncControlsAction:()=>ae,getMicrosoftTeamsTeamsAction:()=>oe,getSharepointConnectorStatus:()=>le,navigateToAIConnectorOnboarding:()=>L,navigateToAIConnectorSettingsScreen:()=>x,navigateToGithubAIConnectorOnboarding:()=>G,navigateToGmailAIConnectorOnboarding:()=>O,navigateToGoogleDriveUniversalScreen:()=>F,navigateToJiraUniversalScreen:()=>M,navigateToLinearAIConnectorOnboarding:()=>W,navigateToLinearUniversalScreen:()=>ue,navigateToMicrosoftTeamsUniversalScreen:()=>U,navigateToSharepointAIConnectorOnboarding:()=>E,navigateToSharepointUniversalScreen:()=>de,navigateToSlackUniversalQnAOnboarding:()=>N,openConnectorInProgressModal:()=>te,resetAiConnectorStatus:()=>B,resetAllAiConnectors:()=>R,setAssistantOnboardingPhase:()=>k,setLastExposedToQnaAtToCurrentTimestamp:()=>w,setLastUsedAIWriterAtToCurrentTimestamp:()=>j,setMicrosoftTeamsSyncControlsAction:()=>ie,setQnaOnboardingPhase:()=>P,startJiraBulkIngestionAction:()=>Y,startJiraEditFlow:()=>Z,startMicrosoftTeamsBulkIngestionAction:()=>re,updateGithubAIConnectorStatus:()=>X,updateGmailAIConnectorStatus:()=>H,updateGoogleDriveQnAConnectionState:()=>ee,updateJiraAIConnectionStatus:()=>V,updateLinearAIConnectorStatus:()=>K,updateMicrosoftTeamsAIConnectorStatusAction:()=>ne,updateSharepointAiConnectorStatus:()=>ce,updateSlackQnAConnectionState:()=>Q});n(725707),n(491955),n(500234),n(771702),n(403517);var s=()=>n(30958),a=()=>n(214144),o=()=>n(519423),i=()=>n(76394),r=()=>n(818369),c=()=>n(575015),d=()=>n(84543),l=()=>n(658388),u=()=>n(894309),g=()=>n(741329),p=()=>n(113920),m=()=>n(688522),S=()=>n(477784),f=()=>n(980936),h=()=>n(892355),v=()=>n(216842),y=()=>n(873573),_=()=>n(145652),I=()=>n(485966),A=()=>n(489905),b=()=>n(14944),C=()=>n(330469),T=()=>n(194568),D=()=>n(366470);function P(e,t){const{phase:n,transactionUserAction:s,userSettingsStore:a}=t;d().createAndCommit({environment:e,userAction:s,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:a,transaction:e,data:{ai_qna_intro_onboarding_phase:n}})}})}function k(e,t){const{phase:n,transactionUserAction:s,userSettingsStore:a}=t;d().createAndCommit({environment:e,userAction:s,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:a,transaction:e,data:{ai_assistant_onboarding_phase:n,ai_assistant_onboarding_phase_last_set_at:Date.now()}})}})}function w(e,t){const{userSettingsStore:n}=t;d().createAndCommit({environment:e,userAction:"aiQnaActions.setLastExposedToQnaAtToCurrentTimestamp",canUndo:!0,perform:e=>{l().mJ({userSettingsStore:n,transaction:e,data:{last_exposed_to_ai_qna_at:Date.now()}})}})}function j(e,t){const{userSettingsStore:n}=t;d().createAndCommit({environment:e,userAction:"aiQnaActions.setLastUsedAIWriterAtToCurrentTimestamp",canUndo:!0,perform:e=>{l().mJ({userSettingsStore:n,transaction:e,data:{last_used_ai_writer_at:Date.now()}})}})}function N(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();m().R.setState({...m().R.state,currentScreen:"introduction",analyticsFrom:t,sessionId:n})}function F(e){const{screenToShow:t,analyticsFrom:n}=e,s=e.sessionId??a().JW();b().d.setState({...b().d.state,analyticsFrom:n,sessionId:s,currentScreen:t})}function M(e){const{analyticsFrom:t,screenToShow:n}=e,s=e.sessionId??a().JW();C().y.setState({...C().y.state,analyticsFrom:t,currentScreen:n,sessionId:s})}function U(e){const{currentScreen:t,analyticsFrom:n,sessionId:s}=e;y().F.setState({...y().F.state,currentScreen:t,analyticsFrom:n??y().F.state.analyticsFrom,sessionId:s??y().F.state.sessionId})}function x(e){const{connector:t,...n}=e;"slack"===t?m().R.setState({...m().R.state,...n,currentScreen:"settings"}):"jira"===t?M({...n,screenToShow:"settings_screen"}):"google_drive"===t?F({...n,screenToShow:"settings_screen"}):"github"===t?f().o.setState({...f().o.state,...n,currentScreen:"settings"}):"gmail"===t?h().X.setState({...h().X.state,...n,currentScreen:"settings_screen"}):"sharepoint"===t?_().E.setState({..._().E.state,...n,currentScreen:"settings"}):"microsoftTeams"===t?y().F.setState({...y().F.state,...n,currentScreen:"settings_screen"}):"linear"===t?v().W.setState({...v().W.state,...n,currentScreen:"settings"}):(0,i().HB)(t)}function L(e){const{connector:t,...n}=e;if("slack"===t)N(n);else if("jira"===t){const e=C().y.state;if("not_started"===e.jiraSyncState)M({...n,screenToShow:"info_screen"});else if("pending_connection"===e.jiraSyncState)M({...n,screenToShow:"connection_pending_screen"});else{if("pending_selection"!==e.jiraSyncState)return;M({...n,screenToShow:"connection_complete_screen"})}}else if("google_drive"===t){"not_started"===b().d.state.initialSyncState&&F({...n,screenToShow:"info_screen"})}else if("github"===t)G(n);else if("gmail"===t)O(n);else if("sharepoint"===t)E(n);else if("microsoftTeams"===t){if(["not_started","pending_selection"].includes(y().F.state.connectionStatus))return void U({...n,currentScreen:"not_started"===y().F.state.connectionStatus?"info_screen":"connection_complete_screen"})}else{if("linear"===t)return void W(n);(0,i().HB)(t)}}function E(e){_().E.setState({..._().E.state,currentScreen:"introduction"})}function W(e){v().W.setState({...v().W.state,currentScreen:"introduction"})}function O(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();h().X.setState({...h().X.state,currentScreen:"info_screen",analyticsFrom:t,sessionId:n})}function G(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();f().o.setState({...f().o.state,currentScreen:"introduction",analyticsFrom:t,sessionId:n})}const J={slack:()=>m().R.reset(),google_drive:()=>b().d.reset(),jira:()=>C().y.reset(),github:()=>f().o.reset(),sharepoint:()=>_().E.reset(),microsoftTeams:()=>y().F.reset(),gmail:()=>h().X.reset(),linear:()=>v().W.reset()};function B(e){(0,J[e])()}function R(){Object.values(J).forEach((e=>e()))}async function Q(e){const{environment:t,spaceId:n}=e;let s=!1;const a=await r().callApi({eventName:"getSlackBulkIngestionStatus",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});"success"===a.type?m().R.setState({...m().R.state,...a.data,ingestionProgress:a.data.isPublicSync?a.data.ingestionProgress||1:void 0}):s=!0;const i=await r().callApi({eventName:"canUserQuerySlack",environment:t,data:{spaceId:n}});"success"===i.type?m().R.setState({...m().R.state,canQuery:i.data.canQuery}):s=!0;const c=await r().callApi({eventName:"getConnectedAppsForUniversalQna",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});return"success"===c.type?(m().R.setState({...m().R.state,connectedApps:c.data.connectedApps,isLoaded:!0}),p().A.updateAppsConnectionData(c.data.appsData??[])):s=!0,{status:s?"failed":"success"}}function z(e){var t;return null!==(t=e.githubOrg)&&void 0!==t&&t.isSyncComplete?"completed":e.isConnected?"in_progress":"not_started"}async function X(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getGithubAIConnectorStatus",environment:t,data:{spaceId:n}});return"success"!==s.type?{status:"failed"}:(f().o.setState({...f().o.state,status:z(s.data),isConnected:s.data.isConnected,githubOrg:s.data.githubOrg,isPersonalAuthComplete:s.data.isPersonalAuthComplete,isDisconnecting:s.data.isDisconnecting,isLoaded:!0}),{status:"success"})}async function H(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getConnectedAppsForUniversalQna",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedApps.includes("gmail-individual")||s.data.connectedApps.includes("gmail-workspace");return h().X.setState({...h().X.state,status:a?"authenticated":"not_started",isConnected:a,isPersonalAuthComplete:a,isLoaded:!0}),{status:"success"}}async function K(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedConnectors.find((e=>"linear"===e.id));if(!a)return v().W.setState({...v().W.state,isConnected:!1,isLoaded:!0}),{status:"success"};const o=null==a?void 0:a.details.connectionDetails;return v().W.setState({...v().W.state,isConnected:void 0!==a,isLoaded:!0,ingestionProgress:null==o?void 0:o.progress,status:null==o?void 0:o.status}),{status:"success"}}async function V(e){return $(e).then((e=>e?{status:"success"}:{status:"failed"}))}async function $(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getJiraAIConnectionStatus",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"===s.type)return C().y.setState({...C().y.state,jiraSiteId:s.data.jiraSiteId??"",jiraSyncState:s.data.connectionState.status,jiraSyncProgress:s.data.connectionState.percentageComplete,jiraSiteUrl:s.data.jiraSiteUrl??"",isDisconnecting:"disconnecting"===s.data.connectionState.status,isLoaded:!0}),s.data}async function q(e){const{environment:t,spaceId:n,jiraSiteId:s}=e,a=await r().callApi({eventName:"getSyncControlsForJiraConnector",environment:t,data:{spaceId:n,jiraSiteId:s}});if("success"===a.type)return C().y.setState({...C().y.state,syncControl:a.data.syncControl}),a}async function Y(e){const{environment:t,spaceId:n,jiraSiteId:s,sessionId:a,exclusionList:o,inclusionList:i}=e,d=await r().callApi({eventName:"startJiraBulkIngestion",environment:t,data:{spaceId:n,jiraSiteId:s,sessionId:a,exclusionList:o,inclusionList:i}});if("success"===d.type)return c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started"}),position:"bottom"}),C().y.setState({...C().y.state,jiraSyncState:"in_progress",jiraSyncProgress:1}),d;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"jira.sync.failed"}),position:"bottom"})}async function Z(e){const{environment:t,spaceId:n,jiraSiteId:s,exclusionList:a,inclusionList:o}=e,i=await r().callApi({eventName:"startJiraEditBulkIngestion",environment:t,data:{spaceId:n,jiraSiteId:s,inclusionList:o,exclusionList:a}});if("success"===i.type)return i.data.patchSuccess?(C().y.setState({...C().y.state,jiraSyncState:"editing",jiraSyncProgress:100}),c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Project sync list updated, sync started in background.",id:"jira.edit.success"}),position:"bottom"})):c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"No changes were detected.",id:"jira.edit.noChanges"}),position:"bottom"}),i;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"jira.edit.failed"}),position:"bottom"})}async function ee(e){const{environment:t,spaceId:n,showSnackbarOnError:s}=e,a=await r().callApi({eventName:"getGoogleDriveSyncProgress",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});return"success"!==a.type?s?a.status>=400&&a.status<500?((0,D().Rl)(),{status:"failed"}):((0,D().NK)(),{status:"failed"}):{status:"failed"}:(b().d.setState({...b().d.state,initialSyncState:(0,g().HB)(a.data.status),isDisconnecting:"disconnecting"===a.data.status,isEditing:"editing"===a.data.status,syncProgress:a.data.status,syncCurrent:a.data.current,syncTotal:a.data.total,ingestionProgress:a.data.ingestionProgress,isLoaded:!0}),{status:"success"})}function te(e){const{environment:t,connector:n,from:s}=e;A().O.setState({...A().O.state,open:!0,modal:"progress",connector:n}),(0,u().trackConnectorInProgressModalOpened)({environment:t,connector:n,from:s})}async function ne(e){return se(e).then((e=>e?{status:"success"}:{status:"failed"}))}async function se(e){const{environment:t,spaceId:n,sessionId:s=y().F.state.sessionId}=e,a=await r().callApi({eventName:"getMicrosoftTeamsAIConnectorStatus",environment:t,data:{spaceId:n,sessionId:s},headers:(0,o().WS)({spaceId:n})});if("success"!==a.type)return;const i=a.data;if("error"===i.status)return y().F.setState({...y().F.state,error:i}),y().F.getState();const{microsoftTenantId:c,connectionDetails:d}=i;return y().F.setState({...y().F.state,microsoftTenantId:c,connectionStatus:(null==d?void 0:d.status)??"not_started",syncProgressPercentage:(null==d?void 0:d.progress_percentage)??0,isLoaded:!0,isDisconnecting:"disconnecting"===(null==d?void 0:d.status),error:void 0}),y().F.getState()}async function ae(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getMicrosoftTeamsSyncControls",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"===s.type)return s.data}async function oe(e){const{environment:t,spaceId:n,cursor:s}=e,a=await r().callApi({eventName:"getMicrosoftTeamsTeams",environment:t,data:{spaceId:n,cursor:s}});if("success"===a.type)return a.data}async function ie(e){const{environment:t,spaceId:n,syncControls:s}=e,a=await r().callApi({eventName:"setMicrosoftTeamsSyncControls",environment:t,data:{spaceId:n,syncControls:s},headers:(0,o().WS)({spaceId:n})});if("success"===a.type)return a.data}async function re(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"startMicrosoftTeamsBulkIngestion",environment:t,data:{spaceId:n}});if("success"===s.type)return c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Microsoft Teams sync started. This can take up to 36 hours.",id:"microsoftTeams.sync.started"}),position:"bottom"}),await se({environment:t,spaceId:n}),s;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"microsoftTeams.sync.failed"}),position:"bottom"})}async function ce(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedConnectors.find((e=>"sharepoint"===e.id));if(!a)return _().E.setState({..._().E.state,isConnected:!1,isLoaded:!0,connectionDetails:void 0}),{status:"success"};const o=null==a?void 0:a.details.connectionDetails;return _().E.setState({..._().E.state,isConnected:void 0!==a,isLoaded:!0,connectionDetails:{status:null==o?void 0:o.status,progress:null==o?void 0:o.progress}}),{status:"success"}}function de(e){const{currentScreen:t}=e;_().E.setState({..._().E.state,currentScreen:t})}async function le(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return"not_started";const a=s.data.connectedConnectors.find((e=>"sharepoint"===e.id));if(!a)return"not_started";return a.details.connectionDetails.status}function ue(e){const{currentScreen:t}=e;v().W.setState({...v().W.state,currentScreen:t})}async function ge(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return"not_started";const a=s.data.connectedConnectors.find((e=>"linear"===e.id));if(!a)return"not_started";return a.details.connectionDetails.status}async function pe(e){const{connector:t,spaceId:n,environment:a,disconnectReason:o,showToast:d}=e;let l,u,g;"google_drive"===t?(l=await r().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:a,data:{spaceId:n,disconnectReason:o}}),u=s()._u,g=["google-drive"]):"github"===t?(l=await r().callApi({eventName:"disconnectGithub",environment:a,data:{spaceId:n}}),u=s().Fl,g=["github"]):"gmail"===t?(l=await r().callApi({eventName:"disconnectAiConnector",environment:a,data:{spaceId:n,connector:"gmail"}}),l={type:"success"},u=s().KI,g=["gmail-workspace"]):"jira"===t?(l=await r().callApi({eventName:"disconnectJiraConnector",environment:a,data:{spaceId:n,jiraSiteId:C().y.state.jiraSiteId}}),u=s().S,g=["jira"]):"sharepoint"===t?(l=await r().callApi({eventName:"disconnectAiConnector",environment:a,data:{spaceId:n,connector:"sharepoint"}}),u=s().fK,g=[]):"microsoftTeams"===t?(l=await r().callApi({eventName:"disconnectMicrosoftTeams",environment:a,data:{spaceId:n,microsoftTenantId:y().F.state.microsoftTenantId??""}}),u=s().lF,g=["microsoftTeams"]):"slack"===t?(l=await r().callApi({eventName:"disconnectSlackIngestion",environment:a,data:{spaceId:n,disconnectForWorkspace:!1}}),u=s().e5,g=["slack-admin"]):"linear"===t?(l=await r().callApi({eventName:"disconnectAiConnector",environment:a,data:{spaceId:n,connector:"linear"}}),u=s().$B,g=["linear"]):(0,i().HB)(t);const m=D().NT[t];m.setState({...m.state,isDisconnecting:!0});const f=p().A.state.appsConnectionData.filter((e=>e.id!==u));p().A.setState({...p().A.state,appsConnectionData:[...f,...g.map((e=>{var t,n;return{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:e,connectorEmail:(null===(t=I().default.state.currentUserStore)||void 0===t?void 0:t.getEmail())||"",id:u,connectorNotionId:null===(n=I().default.state.currentUserStore)||void 0===n||null===(n=n.getModel())||void 0===n?void 0:n.id}}))]});const h=T().w0[t];if(d){const t=e.hoursOverride??"3",n={position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"}};"success"===l.type?c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"{displayName} disconnected. This can take up to {hours} hours.",id:"aiConnector.confirmation.disconnected"},{displayName:h,hours:t}),...n}):c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Failed to disconnect {displayName}. Please try again later.",id:"aiConnector.confirmation.disconnectError"},{displayName:h}),...n})}return l}async function me(e){const{environment:t,spaceId:n}=e,{currentSpaceViewStore:s}=I().default.getState();if(void 0===s)return!1;const a=await r().callApi({eventName:"connectJiraSiteToSpace",environment:t,data:{spaceId:n,siteId:C().y.state.jiraSiteId}});return!("success"!==a.type||!a.data.connectionSuccess)&&(C().y.setState({...C().y.state,currentScreen:"connection_complete_screen",jiraSiteId:a.data.siteData.siteId,jiraSiteUrl:a.data.siteData.siteUrl,jiraSyncState:"pending_selection"}),d().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:t,canUndo:!0,perform:e=>{d().applyOperation({store:s,operation:{pointer:s.pointer,path:["settings"],command:"update",args:{...s.getSettings(),dismissed_jira_installation_pending_prompt:null}},transaction:e})}}),!0)}},113920:(e,t,n)=>{n.d(t,{A:()=>o});class s extends(()=>n(129044))().default{getInitialState(){return{connectorTriggeringUpsell:void 0,upsellTriggeredAt:void 0,appsConnectionData:[]}}updateAppsConnectionData(e){this.setState({...this.state,appsConnectionData:e})}}const a=new s;(0,n(996094).exposeDebugValue)("aiConnectorsStore",a);const o=a},145652:(e,t,n)=>{n.d(t,{E:()=>i,F:()=>a});var s=()=>n(214144);function a(){return{currentScreen:"none",selection:{allSelected:!0,selectedDrives:[],excludedDrives:[],ingestNewDrives:!0},status:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",authUrl:void 0,isConnected:!1,isPersonalAuthComplete:!1,isDisconnecting:!1,isSyncComplete:!1,isLoaded:!1,connectionDetails:void 0}}class o extends(()=>n(129044))().default{getInitialState(){return a()}}const i=new o;(0,n(996094).exposeDebugValue)("sharepointAiConnectorStore",i)},194568:(e,t,n)=>{n.d(t,{DE:()=>a,FJ:()=>i,GK:()=>s,Nv:()=>c,l$:()=>r,w0:()=>o});const s={slack:n(21355).j,github:n(341376).A,google_drive:n(353526).s,jira:n(463335).N,microsoftTeams:n(473069).z,sharepoint:n(924852).i,gmail:n(672805).l,linear:n(715190).u},a={slack:!1,github:!1,google_drive:!1,jira:!0,sharepoint:!0,gmail:!0,linear:!0,microsoftTeams:!0},o={slack:"Slack",github:"GitHub",google_drive:"Google Drive",jira:"Jira",microsoftTeams:"Microsoft Teams",sharepoint:"SharePoint",gmail:"Gmail",linear:"Linear"},i={slack:{name:o.slack,icon:s.slack},github:{name:o.github,icon:s.github},google_drive:{name:o.google_drive,icon:s.google_drive},jira:{name:o.jira,icon:s.jira},microsoftTeams:{name:o.microsoftTeams,icon:s.microsoftTeams},sharepoint:{name:o.sharepoint,icon:s.sharepoint},gmail:{name:o.gmail,icon:s.gmail},linear:{name:o.linear,icon:s.linear}},r="Microsoft",c=(0,n(653998).YK)({sharePointAndOneDrive:{id:"universalQna.connector.sharepointAndOneDriveVariantName",defaultMessage:"SharePoint and OneDrive"}}).sharePointAndOneDrive},341376:(e,t,n)=>{n.d(t,{A:()=>s});const s=(0,n(680369).xh)("gitHub",{default:{loader:()=>Promise.resolve().then(n.bind(n,965646))},darkMode:{loader:()=>Promise.resolve().then(n.bind(n,491392))}})},353526:(e,t,n)=>{n.d(t,{s:()=>s});const s=(0,n(680369).xh)("googleDrive",{default:{loader:()=>n.e(33168).then(n.bind(n,482604))},darkMode:{loader:()=>n.e(33168).then(n.bind(n,589346))}})},366470:(e,t,n)=>{n.d(t,{NK:()=>C,NT:()=>_,Rl:()=>b,Vn:()=>y,hP:()=>I,ts:()=>A});n(725707),n(491955),n(403517),n(113085);var s=n(242343),a=()=>n(237385),o=()=>n(803290),i=()=>n(162901),r=()=>n(653998),c=()=>n(23371),d=()=>n(76394),l=()=>n(463549),u=()=>n(575015),g=()=>n(741329),p=()=>n(126451),m=()=>n(863969),S=()=>n(836331),f=()=>n(108797),h=n(163643);const v={slack:f().updateSlackQnAConnectionState,google_drive:f().updateGoogleDriveQnAConnectionState,jira:f().updateJiraAIConnectionStatus,github:f().updateGithubAIConnectorStatus,sharepoint:f().updateSharepointAiConnectorStatus,microsoftTeams:f().updateMicrosoftTeamsAIConnectorStatusAction,gmail:f().updateGmailAIConnectorStatus,linear:f().updateLinearAIConnectorStatus};function y(e){return async t=>l().ZC.state?{status:"success"}:v[e](t)}const _={slack:n(688522).R,google_drive:n(14944).d,jira:n(330469).y,github:n(980936).o,sharepoint:n(145652).E,microsoftTeams:n(873573).F,gmail:n(892355).X,linear:n(216842).W};function I(e){return(0,o().K8)((()=>S().default.getConfigKey("ingestion",e)),[e])}function A(e){const t=(0,a().v3)(),n=(0,m().O)(),r=(0,o().K8)(g().kB,[]),l=(0,s.useRef)(!1),u=(0,o().K8)((()=>r.filter((e=>!(0,g().A7)(e))).filter((t=>!(0,d().O9)(e)||e.includes(t)))),[r,e]);(0,i().Yb)((async()=>{if(!n||l.current||0===u.length)return;const e=u.map((e=>y(e)));l.current=!0,await(0,c().lX)(e,10,(e=>e({environment:t,spaceId:n}))),l.current=!1}),[t,n,u]);return{isLoading:(0,o().K8)((()=>u.some((e=>!(0,g().A7)(e)))),[u])}}function b(){u().D6({label:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.accessDeniedSnackbar",defaultMessage:"You do not have access to Google Drive Universal QnA."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,h.jsx)(p().A,{onClick:u().N2,children:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.closeErrorSnackbar",defaultMessage:"Close"})})})}function C(){u().D6({label:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.showTryAgainSnackbar",defaultMessage:"There was problem processing your request. Please try again."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,h.jsx)(p().A,{onClick:u().N2,children:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.closeErrorSnackbar",defaultMessage:"Close"})})})}},463335:(e,t,n)=>{n.d(t,{N:()=>s});const s=(0,n(680369).xh)("jira",{default:{loader:()=>n.e(39953).then(n.bind(n,587593))},darkMode:{loader:()=>n.e(39953).then(n.bind(n,255425))}})},463549:(e,t,n)=>{n.d(t,{Wh:()=>f,ZC:()=>S,jx:()=>h});n(610931);var s=()=>n(30958),a=()=>n(23371),o=()=>n(76394),i=()=>n(688522),r=()=>n(980936),c=()=>n(892355),d=()=>n(873573),l=()=>n(145652),u=()=>n(485966),g=()=>n(14944),p=()=>n(330469),m=()=>n(84543);const S=new(n(380123).R)({key:"use_mock_connector_status",namespace:n(146325).cd,important:!1,trackingType:"preference"});function f(e,t,n){const s=u().default.state.currentSpaceViewStore;s&&m().createAndCommit({userAction:"mockConnectorStatusActions.setDebuggingConnectorStatus",environment:e,canUndo:!1,perform:e=>{s&&m().applyOperation({store:s,operation:{pointer:s.pointer,path:["settings"],command:"update",args:{...s.getSettings(),dismissed_slack_personal_auth_prompt:!1,dismissed_github_personal_auth_prompt:!1}},transaction:e})}}),"slack"===t?M(t,n)&&i().R.setState(y[n]):"google_drive"===t?M(t,n)&&g().d.setState(I[n]):"github"===t?M(t,n)&&r().o.setState(b[n]):"jira"===t?M(t,n)&&p().y.setState(T[n]):"sharepoint"===t?M(t,n)&&l().E.setState(w[n]):"microsoftTeams"===t?M(t,n)&&d().F.setState(P[n]):"gmail"===t?M(t,n)&&c().X.setState(j[n]):"linear"===t||(0,o().HB)(t)}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;for(const n of Object.values(s().fl))for(const s of Object.keys(F[n]))console.log("Setting mock connector status for",n,s),f(e,n,s),await(0,a().wR)(t)}const v=(0,i().Q)(),y={not_connected:v,no_channels_selected:{...v,noChannelsSelected:!0},cant_query_connection:{...v,canQuery:!1,isSyncCompleted:!0},in_progress:{...v,inProgress:!0,isSyncCompleted:!1,ingestionProgress:50},disconnecting:{...v,isSyncCompleted:!0,inProgress:!1,connectedApps:["slack-admin"],isDisconnecting:!0},connected:{...v,isSyncCompleted:!0,inProgress:!1,connectedApps:["slack-admin"]}},_=(0,g().s)(),I={not_connected:{..._},in_progress:{..._,initialSyncState:"in_progress",syncProgress:"initial_file_sync_in_progress",syncCurrent:50,syncTotal:100,ingestionProgress:50},disconnecting:{..._,syncProgress:"completed",initialSyncState:"completed",isDisconnecting:!0},connected:{..._,syncProgress:"completed",initialSyncState:"completed"}},A=(0,r().F)(),b={not_started:A,not_authenticated:{...A,isConnected:!0,isPersonalAuthComplete:!1,githubOrg:{id:1,installationId:1,isSyncComplete:!0,lastSyncedAt:1,name:"Test Org"}},in_progress:{...A,status:"in_progress"},disconnecting:{...A,isPersonalAuthComplete:!0,isConnected:!0,isDisconnecting:!0},connected:{...A,isPersonalAuthComplete:!0,isConnected:!0}},C=(0,p().L)(),T={not_started:{...C},in_progress:{...C,jiraSyncState:"in_progress",jiraSyncProgress:50},disconnecting:{...C,jiraSyncState:"completed",isDisconnecting:!0},connected:{...C,jiraSyncState:"completed"}},D=(0,d().G)(),P={not_started:D,in_progress:{...D,connectionStatus:"in_progress",syncProgressPercentage:50},disconnecting:{...D,connectionStatus:"completed",isDisconnecting:!0},connected:{...D,connectionStatus:"completed"}},k=(0,l().F)(),w={not_started:k,in_progress:{...k,connectionDetails:{status:"in_progress",progress:50}},disconnecting:{...k,isConnected:!0,connectionDetails:{status:"completed",progress:100},isDisconnecting:!0},connected:{...k,isConnected:!0,connectionDetails:{status:"completed",progress:100}}},j={not_started:(0,c().A)()},N=n(216842).W.getInitialState(),F={slack:y,google_drive:I,github:b,jira:T,sharepoint:w,microsoftTeams:P,gmail:j,linear:{not_started:N}};function M(e,t){const n=F[e];if(!(0,o().O)(n,t))throw new Error(`Invalid status: ${t}, valid statuses are: ${Object.keys(n).join(", ")}`);return t}},473069:(e,t,n)=>{n.d(t,{z:()=>s});const s=(0,n(680369).xh)("teams",{default:{loader:()=>n.e(21437).then(n.bind(n,15607))},darkMode:{loader:()=>n.e(21437).then(n.bind(n,765859))}})},489905:(e,t,n)=>{n.d(t,{O:()=>a});class s extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const a=new s;(0,n(996094).exposeDebugValue)("AssistantConnectorProgressModalStore",a)},672805:(e,t,n)=>{n.d(t,{l:()=>s});const s=(0,n(680369).xh)("gmail",{default:{loader:()=>n.e(78389).then(n.bind(n,409951))},darkMode:{loader:()=>n.e(78389).then(n.bind(n,527515))}})},715190:(e,t,n)=>{n.d(t,{u:()=>s});const s=(0,n(680369).xh)("linear",{default:{loader:()=>Promise.resolve().then(n.bind(n,60780))},darkMode:{loader:()=>Promise.resolve().then(n.bind(n,155298))}})},741329:(e,t,n)=>{n.d(t,{A7:()=>T,HB:()=>y,Nr:()=>I,XY:()=>_,bp:()=>D,kB:()=>A,uM:()=>C,wd:()=>b});n(725707),n(491955);var s=()=>n(237385),a=()=>n(803290),o=()=>n(30958),i=()=>n(76394),r=()=>n(65062),c=()=>n(980936),d=()=>n(892355),l=()=>n(216842),u=()=>n(873573),g=()=>n(145652),p=()=>n(485966),m=()=>n(840024),S=()=>n(14944),f=()=>n(330469),h=()=>n(133926),v=()=>n(688522);function y(e){return"completed"===e?"completed":"not_started"===e||"pending_selection"===e?"not_started":"in_progress"}function _(e){if("google_drive"===e)return S().d.state.initialSyncState;if("jira"===e){const e=f().y.state.jiraSyncState;return"not_started"===e||"pending_connection"===e?"not_started":"in_progress"===e||"pending_selection"===e?"in_progress":"completed"}if("github"===e)return"authenticated"===c().o.state.status?"in_progress":c().o.state.status;if("gmail"===e)return"authenticated"===d().X.state.status?"completed":"not_started";if("microsoftTeams"===e){const e=u().F.state.connectionStatus;return"not_started"===e?"not_started":"in_progress"===e||"pending_selection"===e?"in_progress":"completed"}if("slack"===e)return v().R.state.noChannelsSelected?"not_started":v().R.state.isSyncCompleted?"completed":"in_progress";var t;if("sharepoint"===e)switch(null===(t=g().E.state.connectionDetails)||void 0===t?void 0:t.status){case"completed":return"completed";case"in_progress":return"in_progress";default:return"not_started"}if("linear"===e)switch(l().W.state.status){case"completed":return"completed";case"in_progress":return"in_progress";default:return"not_started"}return(0,i().HB)(e)}function I(){return A().filter((e=>{if("slack"===e){return!(v().R.state.connectedApps||[]).includes("slack-admin")}return"google_drive"===e?"none"===S().d.state.initialSyncState||"not_started"===S().d.state.initialSyncState:"github"===e?"not_started"===c().o.state.status:"jira"===e?"not_started"===f().y.state.jiraSyncState:"sharepoint"===e?!g().E.state.connectionDetails:"gmail"===e?"not_started"===d().X.state.status:"microsoftTeams"===e?"not_started"===u().F.state.connectionStatus:"linear"===e?"not_started"===l().W.state.status:(0,i().HB)(e)}))}function A(){return o().fl.filter((e=>"slack"===e?m().zD.canUseUniversalSlackSearchScope():"google_drive"===e?m().zD.canUseUniversalGoogleDriveSearchScope():"github"===e?m().zD.canUseUniversalGithubSearchScope():"jira"===e?m().zD.canUseUniversalJiraSearchScope():"sharepoint"===e?m().zD.canUseUniversalSharepointSearchScope():"microsoftTeams"===e?m().zD.canUseUniversalMicrosoftTeamsSearchScope():"gmail"===e?m().zD.canUseUniversalGmailSearchScope():"linear"===e?m().zD.canUseUniversalLinearSearchScope():(0,i().HB)(e)))}function b(){return o().fl.filter((e=>"slack"===e?m().zD.isConnectedToSlackUniversalQnA(v().R.state):"google_drive"===e?m().zD.isConnectedToGoogleDriveUniversalQnA(v().R.state):"github"===e?m().zD.isConnectedToGithubUniversalQnA(c().o.state):"jira"===e?m().zD.isConnectedToJiraUniversalQnA(f().y.state):"gmail"===e?m().zD.isConnectedToGmailUniversalQnA(d().X.state):"sharepoint"===e?m().zD.isConnectedIsSharepointAiConnector(g().E.state):"microsoftTeams"===e?m().zD.isConnectedToMicrosoftTeamsUniversalQnA(u().F.state):"linear"===e?m().zD.isConnectedToLinearUniversalQnA(l().W.state):(0,i().HB)(e)))}function C(){return b().filter((e=>(0,r().LT)(e).isInProgress))}function T(e){return{slack:v().R,google_drive:S().d,jira:f().y,github:c().o,sharepoint:g().E,microsoftTeams:u().F,gmail:d().X,linear:l().W}[e].state.isLoaded}function D(){const e=(0,s().v3)(),t=(0,a().O$)(p().AppStoreCurrentSpaceStore),n=(0,h().P9)({name:"ai_connectors",spaceId:null==t?void 0:t.id,userId:e.currentUser.id})??!1;return(0,a().K8)((()=>{var e;return!(!t||!n)&&!Boolean(null===(e=t.getSettings())||void 0===e?void 0:e.embedding_index_is_live)}),[t,n])}},873573:(e,t,n)=>{n.d(t,{F:()=>i,G:()=>a});var s=()=>n(214144);function a(){return{currentScreen:"none",connectionStatus:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",microsoftTenantId:void 0,syncProgressPercentage:0,isLoaded:!1,isDisconnecting:!1,error:void 0}}class o extends(()=>n(129044))().default{getInitialState(){return a()}}const i=new o},892355:(e,t,n)=>{n.d(t,{A:()=>a,X:()=>i});var s=()=>n(214144);function a(){return{currentScreen:"none",status:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",isConnected:!1,isPersonalAuthComplete:!1,isDisconnecting:!1,isLoaded:!1}}class o extends(()=>n(129044))().default{getInitialState(){return a()}}const i=new o;(0,n(996094).exposeDebugValue)("gmailAIConnectorStore",i)},924852:(e,t,n)=>{n.d(t,{i:()=>s});const s=(0,n(680369).xh)("sharePoint",{default:{loader:()=>n.e(9280).then(n.bind(n,529890))},darkMode:{loader:()=>n.e(9280).then(n.bind(n,928612))}})}}]);