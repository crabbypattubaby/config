"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[73738],{28923:(e,t,o)=>{o.d(t,{A:()=>ge,c:()=>ue});o(610931),o(362833),o(725707),o(491955),o(500234),o(403517);var n=o(242343),i=()=>o(237385),r=()=>o(803290),l=()=>o(174114),a=()=>o(712437),s=()=>o(564134),c=()=>o(916963),d=()=>o(16456),p=()=>o(810111),u=()=>o(680369),g=()=>o(653998),S=()=>o(975392),m=()=>o(3311),y=()=>o(31448),f=()=>o(236339),v=()=>o(948548),b=()=>o(521325),x=()=>o(927999),h=()=>o(865226),w=()=>o(196916),C=()=>o(84543),_=()=>o(840038),A=()=>o(791503),j=()=>o(432175),T=()=>o(255013),k=()=>o(759625),M=()=>o(787404),B=()=>o(702422);var V=()=>o(314164),K=()=>o(126451),P=()=>o(273520),I=()=>o(59175),O=()=>o(935091),z=()=>o(443252),F=()=>o(88271),E=()=>o(725599),L=()=>o(137476),D=()=>o(782422),$=()=>o(876695),R=()=>o(477784);const X=(0,g().YK)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),W=(0,g().YK)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}});function U(e){return e?"page_content"===e.type?R().A.formatMessage(X.page_content):"page_cover"===e.type?R().A.formatMessage(X.page_cover):void 0:R().A.formatMessage(X.none)}function H(e){switch(e){case"small":return R().A.formatMessage(W.small);case"medium":return R().A.formatMessage(W.medium);case"large":return R().A.formatMessage(W.large)}}var G=()=>o(401857),N=()=>o(206183),Q=()=>o(137490),Y=()=>o(29869),Z=()=>o(640979),J=()=>o(772074),q=()=>o(392608),ee=()=>o(622286),te=()=>o(300659),oe=()=>o(485966),ne=()=>o(33541),ie=()=>o(141122),re=()=>o(496794),le=()=>o(44405),ae=()=>o(637558),se=()=>o(573951),ce=()=>o(948120),de=o(163643);const pe=(0,g().YK)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}});function ue(e){const{currentViewType:t,theme:o}=e,n=t?Q().C9[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,type:"button",title:(0,Q().LA)(e),body:(0,de.jsxs)(de.Fragment,{children:[(0,Q()._t)(e),n&&t&&e===n&&(0,de.jsx)("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor},children:(0,de.jsx)(g().sA,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:N().to[t]}})})]}),icon:(0,Q().qg)(e)({width:u().Ev.default,height:u().Ev.default,fill:o.text.secondary})})))}const ge=(0,g().j4)((function(e){let{collectionContextStore:t,showDoneButton:a,collectionSettingsStore:c,onDoneClick:d,menuType:p}=e;const u=(0,l().DP)(),S=(0,i().v3)(),m=(0,i().Y0)(),y=(0,ee().X)("db_ux_chrome"),v=(0,o(308265).BG)(),h=(0,n.useCallback)((e=>(0,de.jsx)(Pe,{collectionContextStore:t,viewType:e},`view-type-button-${e}`)),[t]),w=(0,r().O$)(t.normalizedQueryStore),_=(0,r().O$)(t.normalizedSchemaStore),A=(0,r().O$)(t.normalizedFormatStore),j=(0,r().O$)(t.isFullScreenStore),T=(0,r().O$)(t.isRootChildStore),k=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),M=(0,r().K8)((()=>Se(t)),[t]),B=(0,r().K8)((()=>Boolean(me(t))),[t]),V="table"===M||"board"===M||"gallery"===M||"calendar"===M,K="table"===M,P=Object.keys(_).filter((e=>{const t=_[e];return t&&(0,s().$L)(t)})),I="timeline"===M&&P.length>0,O=(0,r().K8)((()=>"timeline"===M&&P.length>1&&k&&!(0,D().sj)(k.id)),[M,P,k]),z="timeline"===M&&Boolean(null==w?void 0:w.timeline_by_end),L="calendar"===M&&P.length>0,$=(0,r().K8)((()=>"calendar"===M),[M]),R="calendar"===M,X="board"===M,W=(0,r().K8)((()=>(0,o(635900).DG)({environment:S,isFullScreen:j,isRootChild:T})),[S,j,T]),U="timeline"===M&&Boolean(A.timeline_show_table)&&W,H="timeline"===M&&W,G=(0,r().K8)((()=>null==k?void 0:k.hasSingleSourceAndNoLinkedCollections()),[k]),N=(0,r().K8)((()=>!("collectionTypedView"===t.contextType||t.isInHomeWidgetStore.state||j&&G)),[t,j,G]),Q=(0,r().K8)((()=>!t.isInHomeWidgetStore.state&&"chart"!==M),[t.isInHomeWidgetStore,M]),Y=(0,r().K8)((()=>"chart"!==M),[M]),Z=(0,r().O$)(t.permissionScopesStore),oe=(0,r().O$)(t.shouldShowSourceStore),ne=(0,r().K8)((()=>"chart"===M),[M]),ie=(0,r().K8)((()=>"chart"===M),[M]),{isPostsEnabled:le,isFeedOutsidePostsEnabled:ae}=(0,r().K8)((()=>({isPostsEnabled:(0,te().D)({isMobileNative:m.isMobileNative,disableExposureLogging:!0}),isFeedOutsidePostsEnabled:(0,te().X)({disableExposureLogging:!0})})),[m]),se=(0,ee().X)("geo_point_property"),ce=(0,ee().X)("collection_settings_reorganization"),pe=(0,l().IS)((e=>({sourcePickerButton:{paddingTop:2,paddingBottom:2},sourcePickerSection:{marginTop:4},doneButtonSection:{paddingTop:0,marginBottom:v||y?J().Qm:0}})),[v,y]);if(!k)return null;const ue="page"===M,ge=N||B||K||V||ue||I||z||O||L||R||$||H||U||X||Q||Y,ye=["table","board","timeline","calendar","list","gallery","chart"];return le&&ae&&ye.push("feed"),se&&ye.push("map"),(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(F().A,{topBorder:!1,shouldShowBottomDivider:m.isMobile,children:(0,de.jsx)("div",{style:{...m.isMobile?{background:u.contentBackground,width:"100%",padding:J().X1}:{width:"100%",paddingLeft:J().Qm,paddingRight:J().Qm,paddingTop:J().Qm}},children:(0,de.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:ye.map(h)})})}),ge&&(0,de.jsxs)(F().A,{extraPadding:!0,children:[N&&(0,de.jsx)(E().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:oe,onClick:()=>function(e,t,o){const n=t.collectionViewStore();if(!n)return;const i=!t.shouldShowSourceStore.state;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:e,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{hide_linked_collection_name:!i},transaction:e});const r=t.collectionViewBlockStore();o&&r&&x().zA({stores:[r],update:{hide_inline_collection_name:!i},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_show_collection_title"})}(S,t,y),disabled:!Z.canConfigureBlock,textWrapperStyle:{opacity:1}}),B&&(0,de.jsx)(Ke,{collectionContextStore:t}),K&&(0,de.jsx)(Ae,{collectionContextStore:t}),Y&&(0,de.jsx)(Ve,{collectionContextStore:t}),V&&(0,de.jsx)(je,{collectionContextStore:t}),ue&&(0,de.jsx)(ve,{collectionContextStore:t}),I&&(0,de.jsx)(be,{collectionContextStore:t}),z&&(0,de.jsx)(xe,{collectionContextStore:t}),O&&(0,de.jsx)(Te,{collectionContextStore:t}),L&&(0,de.jsx)(he,{collectionContextStore:t}),R&&(0,de.jsx)(ke,{collectionContextStore:t}),$&&(0,de.jsx)(Me,{collectionContextStore:t}),H&&(0,de.jsx)(o(96989).u,{collectionContextStore:t}),U&&(0,de.jsx)(we,{collectionContextStore:t,collectionSettingsStore:c}),X&&(0,de.jsx)(Ce,{collectionContextStore:t,collectionSettingsStore:c}),Q&&(0,de.jsx)(Be,{collectionContextStore:t}),ce&&(0,de.jsx)(o(555714).A,{collectionContextStore:t})]}),v&&"createView"===p&&(0,de.jsx)(F().A,{extraPadding:!0,disableMobileBorders:!0,topBorder:!0,style:pe.sourcePickerSection,children:(0,de.jsx)(o(742807).A,{forceShow:!0,buttonStyle:pe.sourcePickerButton,overrideOnClickBehavior:()=>{b().a2({collectionSettingsStore:c,item:{type:"linkToDatabase",existingCollectionStore:void 0}})},collectionContextStore:t,collectionSettingsStore:c})}),a&&(0,de.jsx)(F().A,{extraPadding:!0,disableMobileBorders:!0,style:pe.doneButtonSection,children:(0,de.jsx)(o(951540).A,{style:{display:"flex",margin:`0 ${J().Qm}px`},onClick:()=>{null==d||d(),function(e,t,o){b().R8({collectionSettingsStore:t,item:{type:"main"}}),(0,f().X)({environment:e,collectionContextStore:o,action:"click_create_view_done"})}(S,c,t)},children:ie?(0,de.jsx)(g().sA,{defaultMessage:"Edit chart",id:"database.viewSettings.createViewTab.editChartButton.title"}):(0,de.jsx)(g().sA,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"})})}),ne?(0,de.jsx)(F().A,{extraPadding:!0,topBorder:!1,style:{paddingTop:0},children:(0,de.jsx)(re().A,{href:(0,q().xS)("guides.charts"),title:(0,de.jsx)(g().sA,{defaultMessage:"Learn about charts",id:"database.viewSettings.layoutTab.learnAboutCharts.title"}),analyticsFrom:"view_settings_layout"})}):y?void 0:(0,de.jsx)(F().A,{extraPadding:!0,topBorder:!a,style:{...a&&{paddingTop:0}},children:(0,de.jsx)(re().A,{href:(0,q().xS)("guides.databaseView"),title:(0,de.jsx)(g().sA,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})})]})}));function Se(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function me(e){return N().Jx[Se(e)]}function ye(e){return N().wm[Se(e)]}function fe(e){return N().dD[Se(e)]}function ve(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().K8)((()=>t.collectionViewStore()),[t]);return n?(0,de.jsx)("div",{style:{padding:5},children:(0,de.jsx)(I().A,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{ne().A.setState({pageId:e.target.value})},onSubmit:e=>{const t=ne().A.state.pageId;t&&C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:o,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{page_pointer:{id:(0,m().G2)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})}):null}function be(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by}),[t]),a=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),c=(0,r().O$)(t.permissionScopesStore),d=(0,r().O$)(t.normalizedSchemaStore),p=(0,r().K8)((()=>t.collectionViewStore()),[t]),u=(0,r().K8)((()=>t.collectionStore()),[t]),S=(0,r().K8)((()=>null==u?void 0:u.getSchema()),[u]),m=(0,r().K8)((()=>null==u?void 0:u.getFormat()),[u]);if(!(l&&p&&u&&m&&S))return null;const v=d[l];return v?(0,de.jsx)(P().Ay,{popupType:n?z().nl.SlideUp:z().nl.Popup,alignmentToOrigin:P().yP.End,placementToOrigin:P().sx.Bottom,originGap:0,renderOrigin:e=>(0,de.jsx)(le().A,{title:a?(0,de.jsx)(g().sA,{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}):(0,de.jsx)(g().sA,{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!c.canConfigureBlock,showChevron:!0,right:(0,de.jsx)("div",{style:y().RC,children:v.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:Z().gu.ActionSheet}:{menuType:Z().gu.Popup,width:300},(0,de.jsx)(O().A,{...i,children:(0,de.jsx)(se().A,{schema:S,format:m,currentProperty:l,getProperties:()=>Object.keys(d).filter((e=>{const t=d[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:o,canUndo:!0,perform:e=>{(0,j().f)({collectionViewStore:p,update:{timeline_by:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_timeline_by",original_view_type:void 0,property_type:v.type}))}})})}}):null}function xe(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),a=(0,r().O$)(t.permissionScopesStore),c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().K8)((()=>t.collectionViewStore()),[t]),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>null==p?void 0:p.getSchema()),[p]),S=(0,r().K8)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&S&&u))return null;const m=c[l];return m?(0,de.jsx)(P().Ay,{popupType:n?z().nl.SlideUp:z().nl.Popup,alignmentToOrigin:P().yP.End,placementToOrigin:P().sx.Bottom,originGap:0,renderOrigin:e=>(0,de.jsx)(le().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:m.name,disabled:!a.canConfigureBlock,...e}),render:e=>{let i;return i=n?{menuType:Z().gu.ActionSheet}:{menuType:Z().gu.Popup,width:300},(0,de.jsx)(O().A,{...i,children:(0,de.jsx)(se().A,{schema:u,format:S,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:o,canUndo:!0,perform:e=>{(0,j().f)({collectionViewStore:d,update:{timeline_by_end:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_timeline_by_end",original_view_type:void 0,property_type:m.type}))}})})}}):null}function he(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by}),[t]),a=(0,r().O$)(t.permissionScopesStore),c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().K8)((()=>t.collectionViewStore()),[t]),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>null==p?void 0:p.getSchema()),[p]),S=(0,r().K8)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&S&&u))return null;const m=c[l];return m?(0,de.jsx)(P().Ay,{popupType:n?z().nl.SlideUp:z().nl.Popup,alignmentToOrigin:P().yP.End,placementToOrigin:P().sx.Bottom,originGap:0,renderOrigin:e=>(0,de.jsx)(le().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,de.jsx)("div",{style:y().RC,children:m.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:Z().gu.ActionSheet}:{menuType:Z().gu.Popup,width:300},(0,de.jsx)(O().A,{...i,children:(0,de.jsx)(se().A,{schema:u,format:S,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:o,canUndo:!0,perform:e=>{(0,j().f)({collectionViewStore:d,update:{calendar_by:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_calendar_by",original_view_type:void 0,property_type:m.type}))}})})}}):null}function we(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),l=((0,r().O$)(t.normalizedFormatStore).timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,a=(0,r().O$)(t.permissionScopesStore);return(0,de.jsx)(le().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:(0,de.jsx)(g().sA,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:l}}),onClick:()=>{b().a2({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"table"}}),(0,f().X)({environment:n,collectionContextStore:t,action:"click_timeline_table_properties"})},disabled:!a.canConfigureBlock})}function Ce(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,a=(0,i().v3)(),s=(0,r().O$)(t.normalizedFormatStore),c=s.board_columns_by,d=(0,r().K8)((()=>(0,G().FS)(s)),[s]),p=(0,r().O$)(t.normalizedSchemaStore),{canConfigureBlock:u}=(0,r().O$)(t.permissionScopesStore),S=(0,n.useCallback)((()=>{if(!c)return null;const e=p[c.property];if(!e)return null;b().a2({collectionSettingsStore:o,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),(0,f().X)({environment:a,collectionContextStore:t,action:"click_board_group_by",original_view_type:void 0,property_type:e.type})}),[t,o,a,c,p]),m=(0,n.useCallback)((()=>b().ut({environment:a,collectionContextStore:t})),[t,a]),y=(0,l().IS)((()=>({textWrapper:{opacity:1}})),[]);if(!c)return null;const v=p[c.property];return v?(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(le().A,{title:(0,de.jsx)(g().sA,{id:"database.viewSettings.layoutTab.boardGroupByButton.title",defaultMessage:"Group by"}),showChevron:!0,right:v.name,onClick:S,disabled:!u}),(0,de.jsx)(E().A,{title:(0,de.jsx)(g().sA,{id:"database.viewSettings.groupTab.colorColumns",defaultMessage:"Color columns"}),on:!d,focused:!1,onClick:m,disabled:!u,textWrapperStyle:y.textWrapper})]}):null}function _e(e,t,o){const n=o.collectionViewStore();if(!n)return;const{serverCommitResult:i}=C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[n],update:{calendar_view_range:e},transaction:t})}}),r=D().XX.state,l=o.dateRangeStartStore.state,a=o.dateRangeEndStore.state,{newDateRangeStart:s,newDateRangeEnd:c}=function(e){const{newViewRange:t,oldCalendarStart:o,startOfWeekSetting:n}=e;if("month"===t){const e=(0,d().mK)(new Date((0,d().to)(o,n)).getDate()>7?(0,d().Mw)(o):o,n);return{newDateRangeStart:e,newDateRangeEnd:(0,d().to)((0,d().AQ)({date:e,monthsToAdd:1}),n)}}return{newDateRangeStart:(0,d().mK)(Date.now(),n),newDateRangeEnd:(0,d().to)(Date.now(),n)}}({oldCalendarStart:l,newViewRange:e,startOfWeekSetting:r});(0,A().r)({dateRangeStart:s,dateRangeEnd:c,collectionContextStore:o}),i.then((()=>{(0,f().X)({environment:t,collectionContextStore:o,action:"update_calendar_view_range"}),(0,_().LQ)({newCalendarStart:s,newCalendarEnd:c,collectionViewId:n.id,currentUserId:t.currentUser.id})})).catch((()=>{(0,A().r)({dateRangeStart:l,dateRangeEnd:a,collectionContextStore:o})}))}function Ae(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().O$)(t.permissionScopesStore),l=(0,r().K8)((()=>!Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines)),[t]);return(0,de.jsx)(E().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:l,focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines);w().au({environment:e,collectionViewStore:o,currentValue:n}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_table_vertical_lines"})}(o,t),disabled:!n.canConfigureBlock,textWrapperStyle:{opacity:1}})}function je(e){var t;let{collectionContextStore:o}=e;const l=(0,i().v3)(),a=(0,r().O$)(o.normalizedFormatStore),s=(0,r().O$)(o.permissionScopesStore),c=(0,r().K8)((()=>Se(o)),[o]),d=a.table_wrap||"calendar"===c&&!0===(null==a||null===(t=a.calendar_properties)||void 0===t||null===(t=t.find((e=>"title"===e.property)))||void 0===t?void 0:t.wrap),p=(0,n.useMemo)((()=>{switch(c){case"table":return(0,de.jsx)(g().sA,{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"});case"calendar":return(0,de.jsx)(g().sA,{defaultMessage:"Wrap page titles",id:"database.viewSettings.layoutTab.calendarWrapTitle"});default:return(0,de.jsx)(g().sA,{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"})}}),[c]),u=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(w().g({environment:l,collectionViewStore:e,currentValue:Boolean(d)}),(0,f().X)({environment:l,collectionContextStore:o,action:"set_first_load_limit"}),(0,f().X)({environment:l,collectionContextStore:o,action:"toggle_table_wrap_cells"}))}),[o,l,d]);return(0,de.jsx)(E().A,{title:p,on:Boolean(d),focused:!1,onClick:u,disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Te(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().O$)(t.normalizedQueryStore),l=null==n?void 0:n.timeline_by_end,a=(0,r().O$)(t.permissionScopesStore);return(0,de.jsx)(E().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(l),onClick:()=>function(e,t){const o=t.normalizedQueryStore.state,n=t.collectionViewStore(),i=null==o?void 0:o.timeline_by,r=null==o?void 0:o.timeline_by_end;if(!i||!n)return;const l=r?void 0:i;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:e,canUndo:!0,perform:e=>{(0,j().f)({collectionViewStore:n,update:{timeline_by_end:l??null},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_timeline_separate_dates"})}(o,t),disabled:!a.canConfigureBlock,textWrapperStyle:{opacity:1}})}function ke(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().O$)(t.permissionScopesStore),a=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}(t)),[t]),s=(0,r().K8)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),c=(0,n.useMemo)((()=>["month","week"].map((e=>({key:e,type:"button",title:R().A.formatMessage(pe[e])})))),[]);return(0,de.jsx)(ae().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:t,openButtonPopup:s,selectedKey:a,popupStyle:{minWidth:190},options:c,onChange:e=>_e(e,o,t),disabled:!l.canConfigureBlock})}function Me(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().K8)((()=>{var e;return Boolean((null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("calendar_show_weekends").getValue())??!0)}),[t]),a=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleToggleShowWeekends",environment:o,canUndo:!0,perform:t=>{x().zA({stores:[e],update:{calendar_show_weekends:!l},transaction:t})}}),(0,f().X)({environment:o,collectionContextStore:t,action:"toggle_calendar_show_weekends"}))}),[t,o,l]);return(0,de.jsx)(ce().A,{title:(0,de.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,de.jsx)(g().sA,{defaultMessage:"Show weekends",id:"database.viewSettings.layoutTab.showWeekends.title"})}),showChevron:!1,switcherProps:{on:l,noColor:!1},onClick:a})}function Be(e){let{collectionContextStore:t}=e;const o=(0,l().DP)(),n=(0,i().v3)(),s=(0,r().O$)(t.permissionScopesStore),c=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=Se(e);return(null==t?void 0:t.collection_peek_mode)||Q().C9[o]}(t)),[t]),d=(0,r().K8)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),p=(0,r().K8)((()=>Se(t)),[t]);return(0,de.jsx)(ae().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:t,openButtonPopup:d,selectedKey:c,popupStyle:{minWidth:190},options:ue({currentViewType:p,theme:o}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:()=>function(e,t){(0,v().m)({environment:e,collectionContextStore:t,from:"collection_view_settings"})}(n,t),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n||!e)return;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[n],update:{collection_peek_mode:e},transaction:t})}});const i=(0,$().sl)(o);if(i&&i.view_type&&(i&&i.view_type&&L().vd(t,"update_peek_mode_format",{peek_mode:e,from:"collection_view_settings",...i}),ie().default.state.open&&ie().default.state.collectionContextStore===o)){const{mainEditorCurrentBlockStore:o}=oe().default.state,n="full_page"===e?(0,Y().Ay)({store:ie().default.state.targetStore,fullyQualified:!1,pageVisitSource:a().y8.Expand}):(0,V().wy)({environment:t,store:ie().default.state.targetStore,mainEditorCurrentBlockStore:o,collectionContextStore:ie().default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,ie().getPeekModeFromCollectionPeekModeFormat)(e)});n&&h().oo({environment:t,url:n})}}(e,n,t),disabled:!s.canConfigureBlock})}function Ve(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().O$)(t.permissionScopesStore),a=(0,r().K8)((()=>t.shouldShowPageIcon()??!0),[t]),s=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(C().createAndCommit({userAction:"CollectionSettingsProperty.TitleOptions.handleToggleShowIcon",environment:o,canUndo:!0,perform:t=>{x().zA({stores:[e],update:{show_page_icon:!a},transaction:t})}}),(0,f().X)({environment:o,collectionContextStore:t,action:"toggle_show_page_icon"}))}),[t,o,a]);return(0,de.jsx)(E().A,{title:(0,de.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,de.jsx)(g().sA,{defaultMessage:"Show page icon",id:"database.viewSettings.layoutTab.showPageIcon.title"})}),focused:!1,on:a,onClick:s,disabled:!l.canConfigureBlock})}function Ke(e){let{collectionContextStore:t}=e;const o=(0,l().DP)(),n=(0,i().v3)(),{device:a}=n,s=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=me(e);if(o&&t)return t[o]}(t)),[t]),d=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=ye(e);if(o&&t){const e=t[o];if(e)return e}return p().fi}(t)),[t]),u=(0,r().K8)((()=>!a.isMobile||"board"===Se(t)),[a,t]),m=(0,r().O$)(t.permissionScopesStore),y=(0,r().K8)((()=>function(e,t,o){const n=o.normalizedSchemaStore.state;let i=Object.keys(n);i=S().Ul(i,(e=>{const t=n[e];return t?t.name:""}));const r=S().oE(i.map((o=>{const i=n[o];if(i&&"file"===i.type)return{key:{type:"property",property:o},type:"button",title:i.name,icon:(0,de.jsx)(c().zB,{type:i.type,icon:i.icon,size:e.device.isMobile?16:14,theme:t,style:{fill:t.regularIconColor}})}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,type:"button",title:U(e)}))),...r]}(n,o,t)),[n,o,t]),v=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=fe(e);if(o&&t)return t[o]}(t)),[t]);return(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(ae().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:s,popupStyle:{minWidth:190},options:y,onChange:e=>function(e,t,o){const n=me(o),i=o.collectionViewStore();n&&i&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[i],update:{[n]:e},transaction:t})}}),(0,f().X)({environment:t,collectionContextStore:o,action:"update_cover_format"}))}(e,n,t),disabled:!m.canConfigureBlock}),u&&(0,de.jsx)(ae().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:d,popupStyle:{minWidth:190},options:["small","medium","large"].map((e=>({key:e,type:"button",title:H(e)}))),onChange:e=>function(e,t,o){const n=ye(o),i=o.collectionViewStore();n&&i&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[i],update:{[n]:e},transaction:t})}}),(0,f().X)({environment:t,collectionContextStore:o,action:"toggle_cover_size_format"}))}(e,n,t),disabled:!m.canConfigureBlock}),s&&(0,de.jsx)(E().A,{title:(0,de.jsx)(g().sA,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===v,focused:!1,onClick:()=>function(e,t){const o=fe(t),n=t.collectionViewStore(),i=t.normalizedFormatStore.state;o&&n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:e,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{[o]:"contain"===i[o]?"cover":"contain"},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_cover_aspect_format"}))}(n,t),disabled:!m.canConfigureBlock,textWrapperStyle:{opacity:1}})]})}function Pe(e){let{viewType:t,collectionContextStore:o}=e;const n=(0,l().DP)(),a=(0,i().v3)(),s=(0,r().K8)((()=>Se(o)),[o]),c=(0,r().O$)(o.permissionScopesStore),d=s===t,p=d||!c.canConfigureBlock;return(0,de.jsxs)(K().A,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:6,padding:6,boxShadow:`inset 0 0 0 1px ${n.regularDividerColor}`,color:n.text.secondary,fill:n.text.secondary,...d&&{boxShadow:`inset 0 0 0 2px ${n.stroke.uiBluePrimary}`,color:n.text.uiBluePrimary,fill:n.icon.uiBluePrimary,fontWeight:500}},disabled:p,onClick:()=>{C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:a,canUndo:!0,perform:e=>{!function(e){const{environment:t,collectionContextStore:o,newViewType:n,transaction:i}=e,r=o.collectionViewStore(),l=o.collectionViewBlockStore(),a=o.collectionStore();if(!r||!l)return;if(n===r.getType()||"page"===n||"form_editor"===n)return;"chart"===n&&T().Z({environment:t,collectionContextStore:o,collectionViewId:r.id,from:"collection_view_type_change"});const s=r.getType();k().zv({store:r,data:{type:n},transaction:i}),(0,B().W)({environment:t,collectionContextStore:o,collectionViewStore:r,collectionStore:a,oldViewType:s,newViewType:n,transaction:i}),(0,M().S)({collectionContextStore:o})}({environment:a,collectionContextStore:o,newViewType:t,transaction:e})}}),(0,f().X)({environment:a,collectionContextStore:o,action:"change_type",original_view_type:s,new_view_type:t})},children:[N().ZU[t]({width:void 0,height:20,marginBottom:4,marginTop:4}),(0,de.jsx)("div",{children:N().to[t]})]},t)}},33541:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(129044))().default{getInitialState(){return{pageId:void 0}}}const i=new n},96989:(e,t,o)=>{o.d(t,{A:()=>le,u:()=>re});o(725707),o(491955),o(500234),o(403517);var n=o.n(o(567012)),i=o(242343),r=()=>o(237385),l=()=>o(803290),a=()=>o(174114),s=()=>o(594876),c=()=>o(564134),d=()=>o(716605),p=()=>o(916963),u=()=>o(810111),g=()=>o(650199),S=()=>o(42635),m=()=>o(235112),y=()=>o(178063),f=()=>o(836693),v=()=>o(680369),b=()=>o(653998),x=()=>o(975392),h=()=>o(76394),w=()=>o(31448),C=()=>o(236339),_=()=>o(521325),A=()=>o(927999),j=()=>o(84543),T=()=>o(107805),k=()=>o(725460),M=()=>o(895721),B=()=>o(209684),V=()=>o(535906),K=()=>o(97787),P=()=>o(369515),I=()=>o(105886),O=()=>o(356813),z=()=>o(858023),F=()=>o(397791),E=()=>o(88271),L=()=>o(725599),D=()=>o(103151),$=()=>o(207762),R=()=>o(475923),X=()=>o(663073),W=()=>o(906230),U=()=>o(392608),H=()=>o(622286),G=()=>o(520969),N=()=>o(907721),Q=()=>o(802955),Y=()=>o(380512),Z=()=>o(417925),J=()=>o(496794),q=()=>o(44405),ee=()=>o(246545),te=o(163643);const oe=(0,b().YK)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertiesTab.inputPlaceholder"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}}),ne=o(129044).default.createClass("",{name:"InputStore"});function ie(e){switch(e){case"editPropertiesAndVisibility":return{disableDatabaseEditing:!1,disableViewEditing:!1};case"editPropertiesOnly":return{disableDatabaseEditing:!1,disableViewEditing:!0};case"propertyVisibilityOnly":return{disableDatabaseEditing:!0,disableViewEditing:!1};default:(0,h().HB)(e)}}function re(e){const{collectionContextStore:t,onClick:o}=e,n=(0,r().v3)(),i=(0,l().O$)(t.normalizedFormatStore),a=Boolean(i.timeline_show_table),s=(0,l().O$)(t.permissionScopesStore);return(0,te.jsx)(L().A,{title:(0,te.jsx)(b().sA,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:a,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(j().createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:n,canUndo:!0,perform:t=>{A().zA({stores:[e],update:{timeline_show_table:!a,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),(0,C().X)({environment:n,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}const le=function(e){let{collectionContextStore:t,timelineViewTab:n,collectionSettingsStore:i,propertiesMenuType:a}=e;const s=(0,r().v3)(),c=(0,l().uB)(void 0,o(210466).A),d=(0,l().uB)(void 0,ne),p=(0,r().Y0)(),u=(0,l().O$)(d),g=(0,l().K8)((()=>(0,R().jx)({collectionContextStore:t})),[t]),S=(0,l().K8)((()=>(0,R().ZI)({timelineViewTab:n,collectionContextStore:t})),[n,t]),m=(0,l().K8)((()=>(0,o(635900).DG)({environment:s,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state})),[s,t]),y=(0,l().K8)((()=>t.isInHomeWidgetStore.state),[t]),f=(0,H().X)("collection_settings_reorganization"),{disableDatabaseEditing:v,disableViewEditing:x}=ie(a);return(0,te.jsxs)(o(3364).Ay,{collectionSettingsStore:i,title:(0,te.jsx)(b().sA,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:(0,te.jsx)(E().A,{children:(0,te.jsx)(o(401382).Ay,{focusInitial:!p.isMobile,value:u,showClearButton:!0,onChange:e=>{d.setState(e.target.value),c.setState({...c.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:o(477784).A.formatMessage(oe.inputPlaceholder)})}),footer:!v&&(0,te.jsx)(de,{collectionContextStore:t,collectionSettingsStore:i,propertiesMenuType:a,timelineViewTab:n}),children:[!x&&"timeline"===g&&m&&(0,te.jsx)(be,{collectionSettingsStore:i,collectionContextStore:t,timelineViewTab:n,inputStore:d,propertiesMenuType:a}),S&&(0,te.jsx)(we,{collectionContextStore:t,collectionSettingsStore:i,inputStore:d,menuListStore:c,formatKey:S,propertiesMenuType:a}),!f&&!y&&!v&&(0,te.jsx)(E().A,{children:(0,te.jsx)(pe,{collectionContextStore:t,collectionSettingsStore:i,timelineViewTab:n})})]})};function ae(e){let{viewType:t}=e;return"table"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===t?(0,te.jsx)(b().sA,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"map"===t||"chat"===t||"custom"===t?null:void(0,h().HB)(t)}function se(e){let{viewType:t}=e;return"table"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===t?(0,te.jsx)(b().sA,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"map"===t||"chat"===t||"custom"===t?null:void(0,h().HB)(t)}function ce(e,t,o){const{formatKey:n,visibility:i}=e,r=t.collectionViewStore();if(!r)return;const l=t.normalizedFormatStore.state[n]||[];let a=l.filter((e=>Boolean(e.visible))),s=l.filter((e=>!e.visible));Se.includes(n)&&(a=me(a),s=me(s));const c=[...a.map((e=>({...e,visible:i}))),...s.map((e=>({...e,visible:i})))];j().createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:o,canUndo:!0,perform:e=>{A().zA({stores:[r],update:{[n]:c},transaction:e})}})}function de(e){let{collectionContextStore:t,collectionSettingsStore:o,propertiesMenuType:n,timelineViewTab:a}=e;const s=(0,r().v3)(),c=(0,l().O$)(t.permissionScopesStore),d=(0,l().K8)((()=>"timeline"===(0,R().jx)({collectionContextStore:t})&&"table"===a&&!(0,R().ZF)({collectionContextStore:t})),[t,a]),p=(0,l().K8)((()=>{const e=t.collectionViewBlockStore();return e&&(0,G().Nh)(e.id)}),[t]),u=c.canConfigureCollection&&!d&&!c.isExternallyImportedAndSyncedCollection&&!p,g=(0,i.useCallback)((()=>{(0,Y().c)({environment:s,collectionContextStore:t})}),[s,t]),S=(0,H().X)("collection_settings_reorganization"),m=(0,l().K8)((()=>t.isInHomeWidgetStore.state),[t]),{disableDatabaseEditing:f}=ie(n);return(0,te.jsxs)(E().A,{topBorder:!0,extraPadding:S,children:[u&&(0,te.jsx)(q().A,{icon:y().plusIcon,title:(0,te.jsx)(b().sA,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:g}),S&&!m&&!f&&(0,te.jsx)(pe,{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:a}),(0,te.jsx)(J().A,{href:(0,U().xS)("guides.databaseProperties"),title:(0,te.jsx)(b().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})]})}function pe(e){let{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:n}=e;const i=(0,r().v3)(),a=(0,l().O$)(t.normalizedDeletedSchemaStore),s=Object.keys(a).length,c=(0,l().O$)(t.permissionScopesStore),d=(0,H().X)("collection_settings_reorganization");return c.canConfigureCollection&&s>0?(0,te.jsx)(q().A,{icon:f().trashIcon,title:d?(0,te.jsx)(b().sA,{id:"database.viewSettings.propertiesTab.recentlyDeleted",defaultMessage:"Recently deleted"}):(0,te.jsx)(b().sA,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:()=>function(e,t,o,n){o.collectionStore()&&((0,C().X)({environment:e,collectionContextStore:o,action:"click_deleted_properties"}),_().a2({collectionSettingsStore:t,item:{type:"deletedProperties",timelineViewTab:n}}))}(i,o,t,n),right:s,showChevron:!0}):null}function ue(e,t,o,n){const i=o.state,r=t.permissionScopesStore.state,{disableViewEditing:l}=ie(n);return!l&&!e.device.isMobile&&r.canConfigureBlock&&!i}function ge(e){e.reset()}const Se=["board_properties","gallery_properties","calendar_properties"];function me(e){const t=e.find((e=>"title"===e.property));return t?[t,...e.filter((e=>"title"!==e.property))]:e}const ye=12;function fe(e,t,o,n,i,r,l,a,y,f){var x;const{formatKey:h,propertyFormat:A}=e,k=n.permissionScopesStore.state,B=!A.visible,K=n.normalizedSchemaStore.state,z=(0,d()._g)({schema:K,property:A.property}),{disableDatabaseEditing:E,disableViewEditing:L}=ie(y),$=ue(t,n,l,y)&&("title"!==A.property||!Se.includes(h)),U=!L&&("title"!==A.property||function(e,t){const o=t.normalizedFormatStore.state,n=(0,R().jx)({collectionContextStore:t});return"board"===n?(0,u().zl)(o.board_cover):"gallery"===n?(0,u().zl)(o.gallery_cover):"timeline"===n&&("timeline_table_properties"===e||(0,u().w3)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}(h,n));let H=!E&&(0,Z().K)({collectionContextStore:n,permissionScopes:k})&&!k.isExternallyImportedAndSyncedCollection;if(k.isSyncedCollection&&((0,s().u)(A.property)||(0,c().cC)(A.property))&&(H=!1),!z)return;const G=!(f&&(0,ee().$S)({propertyType:null==z?void 0:z.type,propertySchema:z})),Q=!G||(null===(x=z.description)||void 0===x?void 0:x.length);return{key:A.property,render:e=>(0,te.jsx)(D().A,{disableTooltip:!Q,renderTooltip:e=>(0,te.jsx)("div",{...e,style:X().Q$,children:G?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{children:z.name}),(0,te.jsx)("div",{style:{color:o.text.contrastSecondary},children:z.description})]}):(0,te.jsx)(b().sA,{id:"collectionSettings.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"})}),placement:N().W.Left,render:r=>(0,te.jsx)(V().A,{...(0,W().A)(e,r),titleStyle:$&&E?{marginLeft:-4}:void 0,title:(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[$&&(E?(0,te.jsx)(I().A,{iconStyle:{width:ye,height:ye},style:{marginRight:6},disableTooltip:!0}):(0,te.jsx)(P().A,{iconSize:ye,style:{marginRight:6}})),(0,te.jsx)(p().zB,{type:z.type,icon:z.icon,size:16,theme:o,style:{fill:o.regularIconColor,marginLeft:2},isDefaultNoticonEnabled:a}),(0,te.jsx)("span",{style:{marginLeft:$?8:10,...w().RC},children:z.name}),(0,c().$M)(z)&&(0,c().om)(z)&&(0,te.jsx)(M().A,{})]}),right:(0,te.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!L&&(0,te.jsx)(O().A,{icon:B?m().M:S().eyeFillSmallIcon,iconStyle:{width:v().Ev.sm,height:v().Ev.sm},isDarkIconColor:!B,onClick:()=>{!function(e,t,o,n){var i;const{formatKey:r,propertyFormat:l}=e,a=o.collectionViewStore();if(!a)return;const s=o.normalizedFormatStore.state,c=(s[r]||[]).filter((e=>e.property!==l.property)),d={...l,visible:!l.visible},p=c.filter((e=>e.visible)),u=c.filter((e=>!e.visible));let g=[];g=Se.includes(r)?!0===d.visible?[...me([...p,d]),...me(u)]:[...me(p),...me([d,...u])]:[...p,d,...u];const S={...s,[r]:g};j().createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:t,canUndo:!0,perform:e=>{(0,T().F)({collectionViewStore:a,update:{format:S},transaction:e})}}),(0,C().X)({environment:t,collectionContextStore:o,action:"toggle_property_visibility",original_view_type:a.getType(),property_type:null===(i=a.getCollectionStore())||void 0===i||null===(i=i.getSchema()[d.property])||void 0===i?void 0:i.type}),ge(n)}({formatKey:h,propertyFormat:A},t,n,l)},ariaLabel:i.formatMessage(oe.togglePropertyVisibilityAriaLabel),disabled:!U||!k.canConfigureBlock}),H&&(0,te.jsx)(F().I,{icon:g().x,size:"xs",color:"tertiary",style:{marginLeft:5}})]}),disabled:!(H&&G),disabledFeedback:!G})}),action:()=>{H&&G&&function(e,t,o,n){var i,r,l;const a=(null===(i=n.collectionStore())||void 0===i?void 0:i.getSchema())||n.normalizedSchemaStore.state||{},{formatKey:s,propertyFormat:c}=e;(0,C().X)({environment:t,collectionContextStore:n,action:"click_property",original_view_type:null==n||null===(r=n.collectionViewStore())||void 0===r?void 0:r.getType(),property_type:null===(l=a[c.property])||void 0===l?void 0:l.type}),_().a2({collectionSettingsStore:o,item:{type:"property",formatKey:s,property:c.property}})}({formatKey:h,propertyFormat:A},t,r,n)}}}function ve(e,t,o,n,i,r,l,a,s,c){const{formatKey:d,properties:p}=e;return x().oE(p.map((e=>fe({formatKey:d,propertyFormat:e},t,o,n,i,r,l,a,s,c))))}function be(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:n,inputStore:l,propertiesMenuType:a}=e;const s=(0,r().v3)(),c=(0,i.useCallback)((()=>function(e){ge(e)}(l)),[l]),d=(0,i.useCallback)((e=>function(e,t,o,n,i,r){(0,C().X)({environment:t,collectionContextStore:n,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),_().dP({collectionSettingsStore:o,item:{type:"propertyVisibilityOnly"===r?"propertyVisibility":"properties",timelineViewTab:0===e?"timeline":"table"}}),ge(i)}(e,s,t,o,l,a)),[s,t,o,l,a]),p=(0,H().X)("collection_settings_reorganization"),u="timeline"===n?0:1;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($().Ay,{tabs:[(0,te.jsx)(b().sA,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),(0,te.jsx)(b().sA,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:u,onChange:d}),"table"===n&&(0,te.jsx)(E().A,{extraPadding:p,children:(0,te.jsx)(re,{collectionContextStore:o,onClick:c})})]})}function xe(e){const t=(0,r().v3)(),{props:o,formatKey:n,children:i,collectionContextStore:a,inputStore:s}=e,c=(0,l().O$)(a.permissionScopesStore),d=(0,l().O$)(s),p=(0,l().K8)((()=>"timeline_table_properties"===n?"table":(0,R().jx)({collectionContextStore:a})),[a,n]);return(0,te.jsx)(E().A,{...o,noTextOverflow:!0,title:(0,te.jsx)(se,{viewType:p}),desktopTitleStyle:{height:19,padding:"0 4px"},mobileTitleStyle:{fontSize:14,paddingLeft:0,paddingRight:0},right:!d&&c.canConfigureBlock&&(0,te.jsx)(B().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){(0,C().X)({environment:t,collectionContextStore:o,action:"click_show_all_properties"}),ce({formatKey:e,visibility:!0},o,t)}(n,t,a),children:(0,te.jsx)(b().sA,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})}),style:{width:"100%",paddingBottom:0},children:i})}function he(e){const t=(0,r().v3)(),{formatKey:o,visibleProperties:n,hiddenProperties:i,children:a,collectionContextStore:s,inputStore:c,menuListStore:d,propertiesMenuType:p}=e,u=x().oE([...n.map((e=>"title"===e.property&&Se.includes(o)?{key:e.property,draggable:!1}:e.property)),n.length>0&&i.length>0&&{key:"group-header-hidden-property",draggable:!1},...i.map((e=>"title"===e.property&&Se.includes(o)?{key:e.property,draggable:!1}:e.property))]);return(0,l().K8)((()=>ue(t,s,c,p)),[t,s,c,p])?(0,te.jsx)(K().Ay,{direction:"vertical",keys:u,renderKey:(e,t)=>a[t],onDrop:(e,n)=>{!function(e,t,o,n){const{formatKey:i,newPropertyKeys:r}=e,l=o.collectionViewStore();if(!l)return;const a=o.normalizedFormatStore.state[i]||[],s=r.indexOf("group-header-hidden-property");let c=x().oE(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));if(o)return s>=0?{...o,visible:Boolean(t<s)}:o}))),d=a.filter((e=>!r.includes(e.property)));Se.includes(i)&&(c=me(c),d=me(d));const p=[...c,...d];j().createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{A().zA({stores:[l],update:{[i]:p},transaction:e})}}),(0,C().X)({environment:t,collectionContextStore:o,action:"reorder_properties",original_view_type:l.getType()}),n.reset()}({formatKey:o,newPropertyKeys:e},t,s,d)}}):(0,te.jsx)(te.Fragment,{children:a})}function we(e){let{formatKey:t,collectionContextStore:o,collectionSettingsStore:i,inputStore:s,menuListStore:c,propertiesMenuType:p}=e;const u=(0,a().DP)(),g=(0,r().v3)(),S=(0,b().tz)(),m=(0,H().X)("nds_default_property_noticon"),y=(0,l().O$)(o.permissionScopesStore),f=(0,l().O$)(o.normalizedFormatStore),v=(0,l().O$)(o.normalizedSchemaStore),h=(0,l().O$)(s),w=!(0,l().O$)(Q().e);let _=f[t]||[];if(h){let e=_.map((e=>{const t=(0,d()._g)({schema:v,property:e.property});return null==t?void 0:t.name}));e=n().filter(h,e).map((e=>{let{original:t}=e;return t})),_=_.filter((t=>{const o=v[t.property];return o&&o.name&&e.includes(o.name)}))}const A=_.filter((e=>Boolean(e.visible))),j=_.filter((e=>!e.visible)),T=(0,l().K8)((()=>"timeline_table_properties"===t?"table":(0,R().jx)({collectionContextStore:o})),[o,t]),{disableViewEditing:M}=ie(p),V=(0,l().K8)((()=>ve({formatKey:t,properties:A},g,u,o,S,i,s,m,p,w)),[t,A,p,g,u,o,S,i,s,m,w]),K=(0,l().K8)((()=>ve({formatKey:t,properties:j},g,u,o,S,i,s,m,p,w)),[t,j,p,g,u,o,S,i,s,m,w]),P=(0,H().X)("collection_settings_reorganization");return 0===_.length?(0,te.jsx)(E().A,{extraPadding:P,children:(0,te.jsx)(k().A,{caption:(0,te.jsx)(b().sA,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})}):(0,te.jsx)(z().Ay,{type:z().Oh.Vertical,store:c,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:x().oE([A.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,te.jsx)(E().A,{...e,extraPadding:P,noTextOverflow:!0,title:!M&&(0,te.jsx)(ae,{viewType:T}),desktopTitleStyle:{height:19},mobileTitleStyle:{fontSize:14},right:!h&&y.canConfigureBlock&&(0,te.jsx)(B().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){(0,C().X)({environment:t,collectionContextStore:o,action:"click_hide_all_properties"}),ce({formatKey:e,visibility:!1},o,t)}(t,g,o),children:(0,te.jsx)(b().sA,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})}),children:(0,te.jsx)(he,{collectionContextStore:o,inputStore:s,menuListStore:c,formatKey:t,visibleProperties:A,hiddenProperties:j,children:e.children,propertiesMenuType:p})}),items:x().oE([...V,M?void 0:j.length>0&&{key:"group-header-hidden-property",render:e=>(0,te.jsx)(xe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,te.jsx)(te.Fragment,{})}),action:()=>{}},...K])},0===A.length&&j.length>0&&{key:"hidden_properties",render:e=>(0,te.jsx)(xe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,te.jsx)(he,{formatKey:t,visibleProperties:A,hiddenProperties:j,children:e.children,collectionContextStore:o,inputStore:s,menuListStore:c,propertiesMenuType:p})}),items:K}])})}},129932:(e,t,o)=>{o.d(t,{h:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M12.718 4.625H6.313a3 3 0 0 0 0 6h7.562a1.75 1.75 0 1 1 0 3.5H7.282a2.126 2.126 0 1 0 0 1.25h6.593a3 3 0 1 0 0-6H6.313a1.75 1.75 0 1 1 0-3.5h6.405a2.126 2.126 0 1 0 0-1.25m1.157.625a.875.875 0 1 1 1.75 0 .875.875 0 0 1-1.75 0"})},i=(0,o(680369).wt)("pathRoundEnds",n)},263873:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,plusSmallIcon:()=>i});o(242343);const n={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"M8 2.74a.66.66 0 0 1 .66.66v3.94h3.94a.66.66 0 0 1 0 1.32H8.66v3.94a.66.66 0 0 1-1.32 0V8.66H3.4a.66.66 0 0 1 0-1.32h3.94V3.4A.66.66 0 0 1 8 2.74"})},i=(0,o(680369).wt)("plusSmall",n)},296315:(e,t,o)=>{o.d(t,{o:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M4.375 4.75a.625.625 0 1 0-1.25 0v5c0 1.174.951 2.125 2.125 2.125h10.491l-3.333 3.333a.625.625 0 0 0 .884.884l4.4-4.4a.625.625 0 0 0 0-.884l-4.4-4.4a.625.625 0 0 0-.884.884l3.333 3.333H5.25a.875.875 0 0 1-.875-.875z"})},i=(0,o(680369).wt)("arrowTurnDownRight",n)},380512:(e,t,o)=>{o.d(t,{c:()=>a});var n=()=>o(236339),i=()=>o(521325),r=()=>o(487454),l=()=>o(836331);function a(e){const{environment:t,collectionContextStore:o}=e,a=l().default.checkGate({gateName:"db_ux_properties"});o.collectionStore()&&((0,n().X)({environment:t,collectionContextStore:o,action:"click_new_property"}),i().a2({collectionSettingsStore:o.settingsStore,item:{type:"propertyType",onAccept:(e,n,l,s)=>{r().nZ({environment:t,propertyType:e,isSuggestedProperty:n,propertyName:l,selectOptions:s,collectionContextStore:o,from:"view_settings"}),a&&i().os({collectionSettingsStore:o.settingsStore})}}}))}},417925:(e,t,o)=>{o.d(t,{K:()=>y,d:()=>m});o(725707),o(491955),o(500234),o(403517);var n=()=>o(371807),i=()=>o(769884),r=()=>o(21164),l=()=>o(289765),a=()=>o(905184),s=()=>o(44250),c=()=>o(975392),d=()=>o(321185),p=()=>o(654548),u=()=>o(413871),g=()=>o(842541),S=()=>o(235600);function m(e){const{environment:t,collectionStore:o,collectionViewBlockStore:m,freezeTitle:y}=e,f=t.currentUser.id;if(!f)return;const{propertyFilters:v,combinatorFilter:b}=function(e){var t,o,n,i;let{environment:l,collectionStore:c,collectionViewBlockStore:p}=e;const S=null==p||null===(t=p.getFormat())||void 0===t?void 0:t.workflow_id;if(!S)return;const m=(0,d().getChatSidebarState)(l);if(!0!==(null==m?void 0:m.isOpen)||!0===m.isNewThread)return;const y=null===(o=(0,g().H)({threadStore:u().Ei.createChildStore(p,{table:a().To,id:m.threadId,spaceId:p.getSpaceId()}),blockStore:p}))||void 0===o?void 0:o.workflowValue;if(!y)return;const f=null===(n=y.modules)||void 0===n?void 0:n.filter((e=>"database"===e.type)).find((e=>{var t;const o=null===(t=(0,s().DK)(e.state))||void 0===t?void 0:t.pointer;return(null==o?void 0:o.table)===r().Vl&&(null==o?void 0:o.id)===c.id})),v=null===(i=(0,s().DK)(null==f?void 0:f.state))||void 0===i?void 0:i.filter;if(!v)return;return{propertyFilters:v.propertyFilters,combinatorFilter:v.combinatorFilter}}({environment:t,collectionStore:o,collectionViewBlockStore:m})??{},x=function(e){var t,o;const{collectionStore:n,userId:i,spaceId:l,idCreator:a,propertyFilters:s,combinatorFilter:d,freezeTitle:u=!0}=e,g=n.getSchema(),m=Object.keys(g),y=null===(t=n.getModel())||void 0===t?void 0:t.parent_id;if(!y)return;const f=(0,c().Ul)(m,((e,t)=>"title"===e?-1:t)).map((e=>({property:e,visible:!0})));return{id:(0,S().D)(a,l,n.id),version:1,parent_id:y,parent_table:"block",alive:!0,space_id:l,created_by_id:i,created_by_table:"notion_user",last_edited_by_id:i,last_edited_by_table:"notion_user",type:"table",name:(0,p().r4)(null===(o=n.getModel())||void 0===o?void 0:o.getName(),n),format:{table_properties:f,table_wrap:!0,table_frozen_column_index:u?0:void 0,collection_pointer:{table:r().Vl,id:n.id,spaceId:l},collection_view_source:{type:"collection",id:n.id,spaceId:l},hide_linked_collection_name:!0,property_filters:s},query2:{sort:[],aggregations:[],filter:d},page_sort:[]}}({collectionStore:o,userId:t.currentUser.id,spaceId:o.getSpaceId(),idCreator:t.idCreator,propertyFilters:v,combinatorFilter:b,freezeTitle:y});if(!x)return;const h={table:l().Gy,id:x.id,spaceId:o.getSpaceId()},w=new(n().A)({name:"temporaryCache",isTemporaryData:!0});w.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),w.setModelAndRole({pointer:h,userId:f},i().Bj6.fromCollectionView(x),"editor");return new(u().pS)(t,{table:l().Gy,id:h.id},{inMemoryRecordCache:w})}function y(e){let{collectionContextStore:t,permissionScopes:o}=e;return!("collectionTypedView"!==t.contextType||!o.canConfigureBlock)||o.canConfigureCollection}},555714:(e,t,o)=>{o.d(t,{A:()=>c});o(610931),o(403517),o(242343);var n=()=>o(803290),i=()=>o(810111),r=()=>o(236339),l=()=>o(927999),a=()=>o(84543),s=o(163643);const c=function(e){let{collectionContextStore:t}=e;const c=(0,o(237385).v3)(),d=(0,n().O$)(t.normalizedFormatStore),p=(0,n().O$)(t.isFullScreenStore),u=(0,n().K8)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),g=(0,n().K8)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,i().i3)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),S=(0,n().O$)(t.permissionScopesStore),m=(0,o(622286).X)("collection_settings_reorganization");return d.collection_group_by||"feed"===u||!p&&"calendar"!==u?(0,s.jsx)(o(637558).A,{title:(0,s.jsx)(o(653998).sA,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:g,popupStyle:{minWidth:190},options:i().X9.map((e=>({key:e,type:"button",title:e.limit}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;a().createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,canUndo:!0,perform:t=>{l().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),(0,r().X)({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,c,t),disabled:!S.canConfigureBlock,icon:m?void 0:o(715768).v}):null}},598793:(e,t,o)=>{o.d(t,{Q:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M15.85 3.65a.625.625 0 1 0 0-1.25H4.15a.625.625 0 1 0 0 1.25zm-1.008 6.692a.625.625 0 0 1-.884 0l-3.333-3.333v9.966a.625.625 0 1 1-1.25 0V7.009l-3.333 3.333a.625.625 0 1 1-.884-.884l4.4-4.4a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884"})},i=(0,o(680369).wt)("arrowLineUp",n)},703143:(e,t,o)=>{o.d(t,{l:()=>r});var n=()=>o(83544),i=()=>o(810111);const r={[i().uO.Jira]:n().A.images.externalIntegrations.jiraPng,[i().uO.Salesforce]:n().A.images.externalIntegrations.salesforcePng}},713921:(e,t,o)=>{o.d(t,{i:()=>f});o(242343);var n=()=>o(237385),i=()=>o(174114),r=()=>o(969338),l=()=>o(653998),a=()=>o(76394),s=()=>o(655830),c=()=>o(935091),d=()=>o(743668),p=()=>o(539048),u=()=>o(983050),g=()=>o(640979),S=o(163643);const m=(0,l().YK)({createTitle:{id:"automations.builderModal.createTitle",defaultMessage:"Create automation"},updateTitle:{id:"automations.builderModal.updateTitle",defaultMessage:"Edit automation"},saveButton:{id:"automations.builderModal.saveButton",defaultMessage:"Save"}}),y=88;function f(e){const{children:t,handleOnDismiss:o,canSave:f,handleOnSave:v,mode:b}=e,x=(0,l().tz)(),{isMobile:h}=(0,n().Y0)(),w=(0,i().IS)((e=>({container:{padding:h?0:"12px 16px",display:"flex",flexDirection:"column",overflow:"hidden",...h?{}:{flexGrow:1}},mobileBackIcon:{width:14,height:14,fill:e.mediumIconColor,margin:"0 6px"}})),[h]);if(h){let e;return"create"===b?e=x.formatMessage(m.createTitle):"update"===b||"button_property"===b?e=x.formatMessage(m.updateTitle):"loading"===b?e=null:(0,a().HB)(b),(0,S.jsx)(c().A,{menuType:g().gu.Modal,whiteBackground:!0,title:e,left:(0,S.jsx)(S.Fragment,{children:(0,r().L)(w.mobileBackIcon)}),onClickLeft:o,rightDisabled:!f,right:"button_property"===b?(0,S.jsx)(d().DoneMenuText,{}):(0,S.jsx)(l().sA,{...m.saveButton}),onClickRight:v,children:(0,S.jsx)("div",{style:w.container,className:u().sux,children:t})})}return(0,S.jsx)(p().s,{anchor:"top",minimumOutsideSpacing:{type:"axes",vertical:y},areaConstraint:{width:{type:"fixed",length:500},height:{type:"min",length:600,scroll:"disallow"}},allowDismissByEscape:!1,isOpen:!0,render:()=>(0,S.jsxs)("div",{style:w.container,className:u().sux,children:[t,(0,S.jsx)(s().A,{debugName:"AutomationBuilderModal",capture:!0,onEsc:e=>{o()}})]})})}},742807:(e,t,o)=>{o.d(t,{A:()=>_});var n=o(242343),i=()=>o(803290),r=o(163643);const l={viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M3.5 3.099c-.621 0-1.125.504-1.125 1.125v9.026A2.625 2.625 0 0 0 5 15.875h9.944a2.625 2.625 0 0 0 2.625-2.625V7.495a2.625 2.625 0 0 0-2.625-2.625H9.067L7.962 3.513A1.13 1.13 0 0 0 7.09 3.1zm.125 4.465V4.349H7.03l1.105 1.356c.214.263.534.415.872.415h5.937c.76 0 1.375.616 1.375 1.375v.069zm0 1.1h12.694v4.586c0 .76-.616 1.375-1.375 1.375H5c-.76 0-1.375-.616-1.375-1.375z"})},a=(0,o(680369).wt)("folder",l);var s=()=>o(653998),c=()=>o(521325),d=()=>o(370639),p=(o(725707),o(500234),()=>o(810111)),u=()=>o(975392),g=()=>o(730950),S=()=>o(44405),m=()=>o(229419),y=()=>o(610271),f=()=>o(137476),v=()=>o(703143),b=()=>o(485966),x=()=>o(773082),h=()=>o(963768);function w(e){let{environment:t,collectionSettingsStore:o,flowId:n,externalCollectionType:i,integrationIconUrl:l,site:d,botId:p,isSyncOwner:g}=e;return(0,r.jsx)(S().A,{icon:a,onClick:()=>{(0,f().u4)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:i,actionType:"source_option_click",flowId:n,identifier:d,botId:p,isSyncOwner:g}}}),c().a2({collectionSettingsStore:o,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,r.jsxs)(y().Ye,{alignItems:"center",children:[(0,r.jsx)("img",{style:{height:12,width:12,marginRight:6},src:l,alt:"External integration icon"}),(0,r.jsx)(s().sA,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,u().ZH)(i||"")}})]}),showChevron:!0,title:(0,r.jsx)(s().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}function C(e){let{environment:t,collectionStore:o,collectionSettingsStore:l}=e;const a=function(e,t){const{botId:o,site:n,externalCollectionType:r,syncState:l}=(0,i().K8)((()=>{const e=null==t?void 0:t.getFormat();return{botId:null==e?void 0:e.bot_id,site:null==e?void 0:e.synced_collection_external_url,externalCollectionType:null==e?void 0:e.external_collection_type,syncState:null==e?void 0:e.sync_state}}),[t]),a=(0,i().K8)((()=>{var e;return null===(e=b().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()}),[]),s=(0,i().K8)((()=>h().Ay.getFlowId()),[]),c=(0,i().K8)((()=>(0,d().Sd)()),[]),u=(0,i().K8)((()=>Boolean(x().A.externalAuthentications.state.find((t=>t.id===o&&t.user_id===e.currentUser.id)))),[o,e.currentUser.id]);if(!r)return;const g={externalCollectionType:r,botId:o,site:n,integrationIconUrl:v().l[r],isSyncOwner:u,flowId:s};switch(r){case p().uO.Jira:return{...g,shouldShowTooltip:c&&!(!0===(null==a?void 0:a.seen_jira_sync_source_tooltip))&&l};case p().uO.Salesforce:default:return{...g,shouldShowTooltip:!1}}}(t,o),s=(0,n.useRef)(null);if(!a)return null;const{botId:c,site:u,integrationIconUrl:S,isSyncOwner:y,shouldShowTooltip:f,externalCollectionType:C,flowId:_}=a;return f?(0,r.jsxs)("div",{ref:s,style:{boxShadow:g().p.outlineBlueInputBoxShadow.light,borderRadius:6},children:[(0,r.jsx)(w,{environment:t,collectionSettingsStore:l,flowId:_,externalCollectionType:C,integrationIconUrl:S,site:u,botId:c,isSyncOwner:y}),(0,r.jsx)(m().C8,{origin:s})]}):(0,r.jsx)(w,{environment:t,collectionSettingsStore:l,flowId:_,externalCollectionType:C,integrationIconUrl:S,site:u,botId:c,isSyncOwner:y})}const _=function(e){let{collectionContextStore:t,collectionSettingsStore:n,disabled:l,overrideOnClickBehavior:p,buttonStyle:u,forceShow:g}=e;const m=(0,o(237385).v3)(),y=(0,i().K8)((()=>t.collectionStore()),[t]),f=(0,i().K8)((()=>null==y?void 0:y.isExternalSyncedCollection()),[y]),v=(0,i().O$)(t.permissionScopesStore),b=(0,i().K8)((()=>(0,d().pB)()),[]),x=(0,i().K8)((()=>t.collectionViewBlockStore()),[t]),h=(0,o(622286).X)("collection_settings_reorganization"),w=(0,i().K8)((()=>g||function(e){const t=e.collectionStore(),o=e.collectionViewBlockStore(),n=e.collectionViewStore();if(!t||!o||!n)return!1;if(o.getAllSourceCollectionStores().length>1||o.getAllLinkedCollectionStores().length>0)return!0;if(t.isSyncedCollection())return!0;if(t.isSystemCollection())return!1;return!o.hasSingleSourceAndNoLinkedCollections()}(t)),[g,t]),_=(0,i().K8)((()=>null==y?void 0:y.getIcon()),[y]);return b&&f&&y&&v.canConfigureBlock?(0,r.jsx)(C,{environment:m,collectionStore:y,collectionSettingsStore:n}):y&&x&&w?(0,r.jsx)(S().A,{icon:h?o(129932).h:a,title:(0,r.jsx)(s().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,r.jsxs)(r.Fragment,{children:[_&&(0,r.jsx)(o(28210).B,{icon:_,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,r.jsx)(o(709237).A,{store:y})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},disabled:!v.canConfigureBlock||l,buttonStyle:u,onClick:()=>{p?p():((0,o(236339).X)({environment:m,collectionContextStore:t,action:"click_source"}),c().a2({collectionSettingsStore:n,item:{type:"source"}}))}}):null}},948548:(e,t,o)=>{o.d(t,{m:()=>r});var n=()=>o(876695),i=()=>o(780965);function r(e){const t=(0,n().sl)(e.collectionContextStore);t&&t.view_type&&i().jE(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}}}]);