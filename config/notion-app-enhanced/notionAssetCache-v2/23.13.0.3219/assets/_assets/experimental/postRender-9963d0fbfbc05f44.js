"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[209,21088,61660,70593,75681],{4637:(e,t,n)=>{n.d(t,{P:()=>o});const o=(0,n(680369).xh)("openAi",{default:{loader:()=>n.e(77375).then(n.bind(n,793831))},darkMode:{loader:()=>n.e(77375).then(n.bind(n,746963))}})},5413:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const i=new o},18179:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>Ti});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(653998),l=()=>n(360378),d=()=>n(384221),c=()=>n(441292),u=()=>n(935091),m=()=>n(743668),p=()=>n(35462),g=()=>n(442958),f=()=>n(983050),h=()=>n(640979),v=()=>n(392608),y=()=>n(129978),b=()=>n(997310),x=()=>n(931371),S=()=>n(266963),M=()=>n(522105),A=()=>n(31448),w=()=>n(207762),k=()=>n(622163),j=()=>n(391431),C=()=>n(53857),I=()=>n(962373),T=n(163643);function _(e){const{store:t,calculatedPermissions:n,permissionItemArgs:o,onClose:l}=e,d=(0,i().Y0)(),g=(v=d.isMobile,(0,r().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:v?e.surface.page:void 0}})),[v]));var v;const y=(0,s().uB)(void 0,I().A),b=d.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:(0,T.jsx)(p().A,{isMobile:d.isMobile,style:g.title,children:(0,T.jsx)(a().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:g.topbarStyle,right:(0,T.jsx)(m().DoneMenuText,{}),onClickRight:l,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return(0,T.jsx)(u().A,{...b,className:f().NXe,children:(0,T.jsx)(c().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(P,{store:t,isMobile:d.isMobile,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:y})})})}function P(e){let{store:t,isMobile:n,calculatedPermissions:s,permissionItemArgs:c,buttonPopupStore:u}=e;const m=(0,i().v3)(),p=function(e){const t=(0,i().v3)();return(0,r().IS)((n=>({tabStyle:{color:n.text.tertiary,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:A().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:(0,k().ny)(t,"UIRegular"),fontWeight:A().Wy.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[t,e])}(n),g=[(0,T.jsx)(o.Fragment,{children:(0,T.jsx)(a().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:m}),d().clear({preventDismissMobileKeyboard:!0,environment:m})}),[m]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(w().Ay,{...p,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,T.jsx)(C().GeneralAccessPermissionSection,{store:t,calculatedPermissions:s,permissionItemArgs:c}),(0,T.jsx)(j().A,{store:t,buttonPopupStore:u,calculatedPermissions:s,permissionItemArgs:c})]})}var B=()=>n(186438),R=()=>n(688266),L=()=>n(138385),D=()=>n(299097),N=()=>n(423411),O=()=>n(268117),E=()=>n(432809),U=()=>n(422340),F=()=>n(528643),K=()=>n(64256),V=()=>n(548694),z=()=>n(76394),W=()=>n(127776);async function H(e,t,n,o,i){if(i.state.inviteStage===L().d5.closed||i.state.inviteStage===L().d5.share_page)return;const{selection:s}=i.state;switch(s){case L().NJ.request_workspace_member:F().RH(e,{...K().nE(e,i),from:"share_menu"}),await K().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:o});break;case L().NJ.workspace_member:F()._u(e,K().nE(e,i));const r=i.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&r){i.setState({...i.state,inviteStage:L().d5.closed});if(!(await W().oH({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await K().Lg({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:o});break;case L().NJ.page_guest:case L().NJ.unselected:case L().NJ.closed:F().l8(e,K().nE(e,i)),i.reset();break;default:(0,z().HB)(s)}}n(403517);var G=()=>n(39742),Y=()=>n(555296),q=()=>n(115692),$=()=>n(769884),Q=()=>n(409211),Z=()=>n(421338),X=()=>n(397791),J=()=>n(701270),ee=()=>n(286404),te=()=>n(245388),ne=()=>n(209718),oe=()=>n(482570);function ie(e){let{users:t}=e;const n=(0,r().IS)((e=>({avatarsContainer:{marginLeft:"16px",display:"flex"},avatarWrapper:{marginLeft:"-16px"},upgradeWrapper:{alignSelf:"end",marginLeft:"-14px",borderRadius:"50%",background:e.surface.wash},upgradeIcon:{height:16,width:16,fill:e.icon.uiBluePrimary}})),[]);return(0,T.jsxs)("div",{style:n.avatarsContainer,children:[t.slice(0,10).map(((e,t)=>(0,T.jsx)("div",{style:n.avatarWrapper,children:(0,T.jsx)(oe().A,{userValue:e,size:40})},t))),(0,T.jsx)("div",{style:n.upgradeWrapper,children:(0,ne().H)(n.upgradeIcon)})]})}function se(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:o,blockStore:l,paysPerSeat:d}=e,c=(0,i().v3)(),u=(0,a().tz)(),m=(0,s().K8)((()=>o.state.inviteStage===L().d5.request_workspace),[o]),p=(0,s().K8)((()=>t.map((e=>{const t=o.state.invitedEmailToUserIdMap[e];return $().Bj6.fromValue(Q().oo,{id:t,email:e,version:1})}))),[o,t]),g=(0,r().IS)((e=>({cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,T.jsxs)("div",{className:f().NXe,children:[(0,T.jsx)(te().Rz,{onClick:()=>o.reset()}),(0,T.jsxs)(Z().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,T.jsxs)(Z().Y1,{gap:20,children:[(0,T.jsx)("div",{style:g.facepileContainer,children:(0,T.jsx)(ie,{users:p})}),(0,T.jsxs)(Z().Y1,{gap:8,children:[(0,T.jsx)(J().D,{styleName:"Heading-17px/Semibold",children:(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,T.jsxs)(Z().Y1,{gap:20,children:[(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:d?m?(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,T.jsxs)(Z().Y1,{gap:14,children:[(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:Y().h,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:G().docPlainTextIcon,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:q().peopleIcon,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:10,children:[(0,T.jsx)(ee().A,{size:"lg",style:g.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:L().NJ.page_guest})}(o),await H(c,n,l,u,o)},children:(0,T.jsx)(a().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,T.jsx)(ee().A,{size:"lg",style:g.cta,onClick:async()=>{o.state.inviteStage===L().d5.share_workspace&&function(e){e.setState({...e.state,selection:L().NJ.workspace_member})}(o),o.state.inviteStage===L().d5.request_workspace&&function(e){e.setState({...e.state,selection:L().NJ.request_workspace_member})}(o),await H(c,n,l,u,o)},children:m?(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,T.jsx)(a().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function re(e){const{spaceStore:t,blockStore:o}=e,r=(0,i().v3)(),a=(0,n(898055).l)({spaceId:t.id}),l=(0,s().K8)((()=>(0,n(904697).shouldShowZeroTeamsExperience)(r,a)),[r,a]),d=(0,s().uB)(e.contextualInviteStore,L().Ay),c=n(647242).OK(a),u=(0,s().K8)((()=>d.getGuestEmails()),[d]),m=(0,s().K8)((()=>(0,V().hN)(t)),[t]);return(0,n(269280).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:L().NJ.page_guest})}(d,l),F().bT(r,K().nE(r,d))})),u.length?(0,T.jsx)(se,{contextualInviteStore:d,spaceStore:t,blockStore:o,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:m}):null}const ae=o.memo(re);var le=()=>n(680369);const de=(0,le().wt)("wifiSlash",{viewBox:"0 0 32 32",svg:(0,T.jsx)("path",{d:"M5.33984 5.32812L8.04688 8.04688C6.17969 8.8125 4.50781 9.97656 3.03125 11.5391C2.90625 11.6719 2.75781 11.7422 2.58594 11.75C2.42188 11.75 2.27734 11.6836 2.15234 11.5508L0.5 9.89844C0.390625 9.78125 0.332031 9.65625 0.324219 9.52344C0.324219 9.38281 0.371094 9.25391 0.464844 9.13672C1.08984 8.39453 1.8125 7.70312 2.63281 7.0625C3.46094 6.41406 4.36328 5.83594 5.33984 5.32812ZM13.6719 6.91016L10.3203 3.54688C10.9688 3.42187 11.5938 3.32812 12.1953 3.26562C12.8047 3.20313 13.4023 3.17188 13.9883 3.17188C15.8086 3.17188 17.5703 3.42969 19.2734 3.94531C20.9844 4.46094 22.5469 5.17188 23.9609 6.07812C25.375 6.97656 26.5625 7.99609 27.5234 9.13672C27.6172 9.25391 27.6641 9.38281 27.6641 9.52344C27.6641 9.65625 27.6016 9.78125 27.4766 9.89844L25.8359 11.5391C25.7109 11.6719 25.5664 11.7422 25.4023 11.75C25.2383 11.75 25.0977 11.6914 24.9805 11.5742C23.543 10.0898 21.9141 8.94531 20.0938 8.14062C18.2812 7.33594 16.2852 6.91016 14.1055 6.86328C14.0352 6.86328 13.9609 6.86719 13.8828 6.875C13.8125 6.88281 13.7422 6.89453 13.6719 6.91016ZM10.6016 10.5781L13.7773 13.7656C13.0273 13.7812 12.2969 13.9023 11.5859 14.1289C10.875 14.3555 10.207 14.6641 9.58203 15.0547C8.96484 15.4375 8.42188 15.8828 7.95312 16.3906C7.82031 16.5312 7.67188 16.6094 7.50781 16.625C7.34375 16.6328 7.19141 16.5703 7.05078 16.4375L5.21094 14.6328C5.10156 14.5234 5.03906 14.4023 5.02344 14.2695C5.01562 14.1367 5.0625 14.0117 5.16406 13.8945C5.78906 13.1602 6.56641 12.5039 7.49609 11.9258C8.43359 11.3398 9.46875 10.8906 10.6016 10.5781ZM22.0859 15.3242L17.3398 10.5781C18.4492 10.8594 19.4922 11.2969 20.4688 11.8906C21.4453 12.4844 22.2344 13.1523 22.8359 13.8945C22.9219 14.0117 22.9609 14.1367 22.9531 14.2695C22.9531 14.4023 22.8945 14.5234 22.7773 14.6328L22.0859 15.3242ZM14 16.9531C14.8281 16.9531 15.5898 17.1367 16.2852 17.5039C16.9805 17.8711 17.5312 18.3125 17.9375 18.8281C18.0312 18.9453 18.0703 19.0742 18.0547 19.2148C18.0391 19.3555 17.9766 19.4766 17.8672 19.5781L15.0078 22.3438C14.7734 22.5703 14.582 22.7227 14.4336 22.8008C14.293 22.8867 14.1484 22.9297 14 22.9297C13.8594 22.9297 13.7188 22.8867 13.5781 22.8008C13.4375 22.7227 13.2461 22.5703 13.0039 22.3438L10.1328 19.5781C10.0312 19.4844 9.96484 19.3789 9.93359 19.2617C9.91016 19.1367 9.93359 19.0234 10.0039 18.9219C10.4102 18.375 10.9688 17.9102 11.6797 17.5273C12.3906 17.1445 13.1641 16.9531 14 16.9531ZM23.8906 21.7812L4.09766 2C3.91797 1.82812 3.82812 1.60938 3.82812 1.34375C3.82812 1.07812 3.91797 0.855469 4.09766 0.675781C4.26953 0.496094 4.48828 0.410156 4.75391 0.417969C5.01953 0.417969 5.24219 0.507813 5.42188 0.6875L25.2031 20.4688C25.3906 20.6484 25.4844 20.8672 25.4844 21.125C25.4844 21.3828 25.3906 21.6016 25.2031 21.7812C25.0312 21.9609 24.8164 22.0508 24.5586 22.0508C24.3008 22.0508 24.0781 21.9609 23.8906 21.7812Z"})});var ce=()=>n(60020),ue=()=>n(305043),me=()=>n(741848),pe=()=>n(609454);function ge(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:o}=e,{permissionItem:i}=n;return(0,s().K8)((()=>(0,pe().W)(i)),[i])?(0,T.jsx)(R().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,T.jsx)(R().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location})}n(725707),n(491955);var fe=()=>n(599932),he=()=>n(365928),ve=()=>n(835029),ye=()=>n(655830),be=()=>n(304372),xe=()=>n(501673),Se=()=>n(657412),Me=()=>n(378219),Ae=()=>n(622286),we=()=>n(210466),ke=()=>n(836331);function je(e){const{featureGateId:t,whenEnabled:n,whenDisabled:o,disableExposureLogging:i}=e,r=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,s().K8)((()=>ke().default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:i});return r?n:o}var Ce=()=>n(262887),Ie=()=>n(133926);function Te(e){const{currentMembersAndGuests:t,inviteTarget:n}=e,o=_e(n);if(!o)return;const i=function(e){const{email:t,currentMembersAndGuests:n}=e;return n.memberEmails.has(t)?"member":n.guestEmails.has(t)?"guest":void 0}({email:o,currentMembersAndGuests:t});return{email:o,currentRole:i}}function _e(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,z().HB)(t)}}var Pe=()=>n(636208),Be=()=>n(639246);var Re=()=>n(731556),Le=()=>n(29578),De=()=>n(216376),Ne=()=>n(401548),Oe=()=>n(780942),Ee=()=>n(206799),Ue=()=>n(526936),Fe=()=>n(330358),Ke=()=>n(481596);function Ve(e){const{spaceId:t,userId:n,spaceModel:o,spaceUserModel:i,teamModel:l,domains:d,blockStore:c}=e,u=(0,a().tz)(),m=(0,Ie()._X)({name:"internal_guests",spaceId:t,userId:n,amount:1}),p=(0,Ue().o)({store:c}),g=(0,Ie().P9)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,r().IS)((e=>{const t=m&&!(0,ve().e2)(m),n=t?20:5,o=t?e.accentColors.orange[100]:"transparent",i=t?e.accentColors.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${o}, ${o} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Ne().X4)(e.accentColors.orange[400],.15):(0,Ne().X4)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[m]),h=(0,s().K8)((()=>{var e;const t=(0,De()._y)((null===(e=ue().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Ke().qY[t].label}),[]),v=(0,s().K8)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),y=(0,s().K8)((()=>null==i?void 0:i.isMember()),[i]);let b;b=v?"You are a workspace owner":y?"You are a member":"You are a guest";const x=(0,s().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!o&&o.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==o?void 0:o.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=o&&o.getSettings().disable_membership_requests)}]),[o]),S=(0,s().K8)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),M=(0,s().K8)((()=>{if(!o||!d||!i)return;const{autojoinDomains:e}=(0,Le().SJ)({space:o,spaceUser:i,domains:d});return e}),[o,i,d]),A=(0,s().K8)((()=>{if(!o||!i)return;const{type:e}=(0,Le().yQ)({space:o,spaceUser:i,team:l,publicPageDataGuestSetting:p});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,z().HB)(e)}}),[o,i,l,p]),w=(0,s().K8)((()=>{if(!o||!d||!i)return;const{type:e}=(0,Le().SJ)({space:o,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,z().HB)(e)}}),[o,i,d]),k=(0,s().K8)((()=>{if(!o||!i||!d)return!1;return"can_add"===(0,Le().SJ)({space:o,spaceUser:i,domains:d}).type}),[o,i,d]),j=(0,s().K8)((()=>{if(!m)return;const e=m.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return k?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,z().HB)(e)}}),[m,g,k]),C=(0,s().K8)((()=>{if(!m)return"Guest limit data is unavailable";if("cumulative"===m.limit.type){const{current:e,total:t}=m.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[m]),I=e=>{Fe().A.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,T.jsxs)(Z().Y1,{gap:10,style:f.container,children:[(0,T.jsxs)(Z().Y1,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)(Oe().p,{onClick:()=>I("security"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),x.map(((e,t)=>(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,T.jsx)(ze,{isEnabled:e.isEnabled}),(0,T.jsx)(J().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),S.map(((e,t)=>(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,T.jsx)(ze,{isEnabled:e.isEnabled}),(0,T.jsx)(J().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,T.jsx)(Oe().p,{onClick:()=>I("billing"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${u.formatMessage(h)} plan`}),(0,T.jsx)(J().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:C})]})}),(0,T.jsx)(Oe().p,{onClick:()=>I("settings"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==M?void 0:M.map((e=>(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==M?void 0:M.length)&&(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,T.jsxs)(Z().Y1,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:b}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:w}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:A}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:j})]})]})}function ze(e){const{isEnabled:t}=e,n=(0,r().IS)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,T.jsx)(Ee().Q,{iconGroup:Re().d,variantName:"mini",colorName:"secondary"}):(0,T.jsx)(Z().Y1,{width:14,height:14,align:"center",children:(0,T.jsx)("div",{style:n.circle})})}var We=()=>n(706788),He=()=>n(818369),Ge=()=>n(142708),Ye=()=>n(307542),qe=()=>n(226518),$e=()=>n(98508),Qe=()=>n(485966),Ze=()=>n(773082),Xe=()=>n(480415),Je=()=>n(771619),et=()=>n(59175);function tt(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:o,maxLength:i}=e,s=(0,r().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,T.jsx)("div",{style:s.container,children:(0,T.jsxs)("div",{style:s.warning,children:[t&&(0,T.jsx)(a().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,T.jsx)(a().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const nt=100;function ot(e){const{open:t,focus:n,value:o,maxLength:i,onFocus:s,onChange:l,onCancel:d}=e,c=(0,a().tz)(),u=o.length/i>=.8,m=(0,Je().BS)(o),p=u||m,g=(0,r().IS)((e=>({container:{maxHeight:t?nt:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,T.jsxs)("div",{style:g.container,children:[p&&(0,T.jsx)(tt,{value:o,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,T.jsx)(et().A,{textarea:!0,focusInitial:!1,format:et().C.Transparent,placeholder:f,maxlength:i,focus:n,value:o,onFocus:s,onChange:l,inputStyle:g.input,onCancel:d})]})}var it=()=>n(277011),st=(n(362833),n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(500234),n(771702),n(244387),n(113085),()=>n(162901));const rt={viewBox:"0 0 16 16",svg:(0,T.jsx)("path",{d:"M4.288 3.663a.625.625 0 0 0-.625.625v6.109a.625.625 0 1 0 1.25 0v-4.6l6.368 6.368c.24.24.63.232.873-.01a.62.62 0 0 0 .01-.874L5.797 4.913h4.601a.625.625 0 1 0 0-1.25z"})},at=(0,le().wt)("arrowDiagonalUpLeftSmall",rt);var lt=()=>n(457774),dt=()=>n(688322),ct=()=>n(407152),ut=()=>n(21857),mt=()=>n(446588),pt=()=>n(145017),gt=()=>n(242297),ft=()=>n(218357),ht=()=>n(188877),vt=()=>n(836880),yt=()=>n(441288),bt=()=>n(235843),xt=()=>n(286270),St=()=>n(535906),Mt=()=>n(273520),At=()=>n(858023),wt=()=>n(975515),kt=()=>n(443252),jt=()=>n(28210),Ct=()=>n(709237),It=()=>n(88271),Tt=()=>n(103151),_t=()=>n(758103),Pt=()=>n(625880),Bt=()=>n(673411);(0,le().xh)("abstract",{default:{loader:()=>n.e(40471).then(n.bind(n,556895))},darkMode:{loader:()=>n.e(40471).then(n.bind(n,181211))}}),(0,le().xh)("adobeXd",{default:{loader:()=>n.e(79254).then(n.bind(n,635938))},darkMode:{loader:()=>n.e(79254).then(n.bind(n,312164))}}),(0,le().xh)("airtable",{default:{loader:()=>n.e(73865).then(n.bind(n,31989))},darkMode:{loader:()=>n.e(73865).then(n.bind(n,923325))}}),(0,le().xh)("amplitude",{default:{loader:()=>n.e(36448).then(n.bind(n,460292))},darkMode:{loader:()=>n.e(36448).then(n.bind(n,157386))}}),(0,le().xh)("apple",{default:{loader:()=>n.e(5815).then(n.bind(n,600881))},darkMode:{loader:()=>n.e(5815).then(n.bind(n,928288))}}),(0,le().xh)("asana",{default:{loader:()=>n.e(44225).then(n.bind(n,773759))},darkMode:{loader:()=>n.e(44225).then(n.bind(n,450171))}}),(0,le().xh)("basecamp",{default:{loader:()=>n.e(67601).then(n.bind(n,455285))},darkMode:{loader:()=>n.e(67601).then(n.bind(n,880957))}}),(0,le().xh)("box",{default:{loader:()=>n.e(88472).then(n.bind(n,42208))},darkMode:{loader:()=>n.e(88472).then(n.bind(n,785846))}}),(0,le().xh)("calendar",{default:{loader:()=>n.e(80319).then(n.bind(n,565467))},darkMode:{loader:()=>n.e(80319).then(n.bind(n,424023))}});(0,le().xh)("clickUp",{default:{loader:()=>n.e(52084).then(n.bind(n,820376))},darkMode:{loader:()=>n.e(52084).then(n.bind(n,888702))}}),(0,le().xh)("coda",{default:{loader:()=>n.e(59430).then(n.bind(n,335700))},darkMode:{loader:()=>n.e(59430).then(n.bind(n,440858))}}),(0,le().xh)("codepen",{default:{loader:()=>n.e(32179).then(n.bind(n,731285))},darkMode:{loader:()=>n.e(32179).then(n.bind(n,504029))}}),(0,le().xh)("confluence",{default:{loader:()=>n.e(16999).then(n.bind(n,134383))},darkMode:{loader:()=>n.e(16999).then(n.bind(n,871531))}}),(0,le().xh)("deepnote",{default:{loader:()=>n.e(2147).then(n.bind(n,963531))},darkMode:{loader:()=>n.e(2147).then(n.bind(n,651015))}}),(0,le().xh)("docs",{default:{loader:()=>n.e(88240).then(n.bind(n,494906))},darkMode:{loader:()=>n.e(88240).then(n.bind(n,71468))}}),(0,le().xh)("dropbox",{default:{loader:()=>n.e(30737).then(n.bind(n,225903))},darkMode:{loader:()=>n.e(30737).then(n.bind(n,341163))}}),(0,le().xh)("evernote",{default:{loader:()=>n.e(89253).then(n.bind(n,518265))},darkMode:{loader:()=>n.e(89253).then(n.bind(n,799473))}}),(0,le().xh)("excalidraw",{default:{loader:()=>n.e(23873).then(n.bind(n,534045))},darkMode:{loader:()=>n.e(23873).then(n.bind(n,998037))}}),(0,le().xh)("figma",{default:{loader:()=>n.e(44539).then(n.bind(n,419869))},darkMode:{loader:()=>n.e(44539).then(n.bind(n,730389))}}),(0,le().xh)("framer",{default:{loader:()=>n.e(87102).then(n.bind(n,329004))},darkMode:{loader:()=>n.e(87102).then(n.bind(n,906274))}});(0,le().xh)("gitLab",{default:{loader:()=>n.e(70916).then(n.bind(n,143214))},darkMode:{loader:()=>n.e(70916).then(n.bind(n,420640))}});(0,le().xh)("googleCalendar",{default:{loader:()=>n.e(17546).then(n.bind(n,576724))},darkMode:{loader:()=>n.e(17546).then(n.bind(n,53978))}});var Rt=()=>n(978968);(0,le().xh)("grid",{default:{loader:()=>n.e(21697).then(n.bind(n,689981))},darkMode:{loader:()=>n.e(21697).then(n.bind(n,683573))}}),(0,le().xh)("hex",{default:{loader:()=>n.e(20512).then(n.bind(n,560460))},darkMode:{loader:()=>n.e(20512).then(n.bind(n,814786))}}),(0,le().xh)("hubSpot",{default:{loader:()=>n.e(21914).then(n.bind(n,391566))},darkMode:{loader:()=>n.e(21914).then(n.bind(n,8192))}}),(0,le().xh)("instagram",{default:{loader:()=>n.e(77355).then(n.bind(n,300805))},darkMode:{loader:()=>n.e(77355).then(n.bind(n,123789))}}),(0,le().xh)("inVision",{default:{loader:()=>n.e(35364).then(n.bind(n,711902))},darkMode:{loader:()=>n.e(35364).then(n.bind(n,872208))}});(0,le().xh)("linkedin",{default:{loader:()=>n.e(58319).then(n.bind(n,638439))},darkMode:{loader:()=>n.e(58319).then(n.bind(n,461139))}}),(0,le().xh)("loom",{default:{loader:()=>n.e(68642).then(n.bind(n,955608))},darkMode:{loader:()=>n.e(68642).then(n.bind(n,682558))}}),(0,le().xh)("lucidchart",{default:{loader:()=>n.e(30512).then(n.bind(n,157630))},darkMode:{loader:()=>n.e(30512).then(n.bind(n,462128))}}),(0,le().xh)("lucidspark",{default:{loader:()=>n.e(7391).then(n.bind(n,21987))},darkMode:{loader:()=>n.e(7391).then(n.bind(n,151183))}}),(0,le().xh)("make",{default:{loader:()=>n.e(14079).then(n.bind(n,141679))},darkMode:{loader:()=>n.e(14079).then(n.bind(n,891051))}}),(0,le().xh)("maps",{default:{loader:()=>n.e(78724).then(n.bind(n,753522))},darkMode:{loader:()=>n.e(78724).then(n.bind(n,714932))}}),(0,le().xh)("miro",{default:{loader:()=>n.e(6122).then(n.bind(n,953440))},darkMode:{loader:()=>n.e(6122).then(n.bind(n,694070))}}),(0,le().xh)("mixpanel",{default:{loader:()=>n.e(41837).then(n.bind(n,419677))},darkMode:{loader:()=>n.e(41837).then(n.bind(n,471317))}}),(0,le().xh)("monday",{default:{loader:()=>n.e(98713).then(n.bind(n,835093))},darkMode:{loader:()=>n.e(98713).then(n.bind(n,704477))}});(0,le().xh)("office365",{default:{loader:()=>n.e(59287).then(n.bind(n,65785))},darkMode:{loader:()=>n.e(59287).then(n.bind(n,330929))}}),(0,le().xh)("oneDrive",{default:{loader:()=>n.e(77957).then(n.bind(n,435377))},darkMode:{loader:()=>n.e(77957).then(n.bind(n,65625))}}),(0,le().xh)("oneNote",{default:{loader:()=>n.e(54871).then(n.bind(n,703769))},darkMode:{loader:()=>n.e(54871).then(n.bind(n,69393))}});(0,le().xh)("pagerDuty",{default:{loader:()=>n.e(19314).then(n.bind(n,374770))},darkMode:{loader:()=>n.e(19314).then(n.bind(n,772724))}}),(0,le().xh)("pitch",{default:{loader:()=>n.e(39689).then(n.bind(n,7415))},darkMode:{loader:()=>n.e(39689).then(n.bind(n,567651))}}),(0,le().xh)("polymer",{default:{loader:()=>n.e(38949).then(n.bind(n,537815))},darkMode:{loader:()=>n.e(38949).then(n.bind(n,432579))}}),(0,le().xh)("quip",{default:{loader:()=>n.e(61492).then(n.bind(n,240362))},darkMode:{loader:()=>n.e(61492).then(n.bind(n,54044))}}),(0,le().xh)("replit",{default:{loader:()=>n.e(49229).then(n.bind(n,995273))},darkMode:{loader:()=>n.e(49229).then(n.bind(n,753601))}});(0,le().xh)("sketch",{default:{loader:()=>n.e(64557).then(n.bind(n,567493))},darkMode:{loader:()=>n.e(64557).then(n.bind(n,809101))}});var Lt=()=>n(21355);(0,le().xh)("smartSheet",{default:{loader:()=>n.e(87153).then(n.bind(n,591765))},darkMode:{loader:()=>n.e(87153).then(n.bind(n,217117))}});(0,le().xh)("tiktok",{default:{loader:()=>n.e(80931).then(n.bind(n,603271))},darkMode:{loader:()=>n.e(80931).then(n.bind(n,644275))}}),(0,le().xh)("trello",{default:{loader:()=>n.e(9555).then(n.bind(n,367439))},darkMode:{loader:()=>n.e(9555).then(n.bind(n,121163))}}),(0,le().xh)("twitter",{default:{loader:()=>n.e(53974).then(n.bind(n,535330))},darkMode:{loader:()=>n.e(53974).then(n.bind(n,171556))}}),(0,le().xh)("typeform",{default:{loader:()=>n.e(61487).then(n.bind(n,183443))},darkMode:{loader:()=>n.e(61487).then(n.bind(n,228479))}}),(0,le().xh)("whimsical",{default:{loader:()=>n.e(43862).then(n.bind(n,628634))},darkMode:{loader:()=>n.e(43862).then(n.bind(n,15756))}}),(0,le().xh)("word",{default:{loader:()=>n.e(72001).then(n.bind(n,958785))},darkMode:{loader:()=>n.e(72001).then(n.bind(n,230633))}}),(0,le().xh)("workflowy",{default:{loader:()=>n.e(15135).then(n.bind(n,639625))},darkMode:{loader:()=>n.e(15135).then(n.bind(n,835073))}}),(0,le().xh)("youTube",{default:{loader:()=>n.e(55724).then(n.bind(n,850856))},darkMode:{loader:()=>n.e(55724).then(n.bind(n,22670))}}),(0,le().xh)("zapier",{default:{loader:()=>n.e(70074).then(n.bind(n,592456))},darkMode:{loader:()=>n.e(70074).then(n.bind(n,433134))}}),(0,le().xh)("zendesk",{default:{loader:()=>n.e(11235).then(n.bind(n,880425))},darkMode:{loader:()=>n.e(11235).then(n.bind(n,116008))}}),(0,le().xh)("zoom",{default:{loader:()=>n.e(9832).then(n.bind(n,460206))},darkMode:{loader:()=>n.e(9832).then(n.bind(n,1696))}}),(0,le().xh)("salesforce",{default:{loader:()=>n.e(81764).then(n.bind(n,769666))},darkMode:{loader:()=>n.e(81764).then(n.bind(n,75844))}});var Dt=()=>n(2921),Nt=()=>n(906230),Ot=()=>n(861095),Et=()=>n(556338),Ut=()=>n(284551),Ft=()=>n(785061),Kt=()=>n(546002),Vt=()=>n(907721),zt=()=>n(985532),Wt=()=>n(413871),Ht=()=>n(765787),Gt=()=>n(111826),Yt=()=>n(764227),qt=()=>n(22097),$t=()=>n(519423);var Qt=()=>n(204507),Zt=()=>n(328207),Xt=()=>n(10456),Jt=()=>n(536505),en=()=>n(209684),tn=()=>n(466321);function nn(e){const{emailMessage:t,inviteTargetsStore:n,flowId:o,googleContacts:s=[],slackContacts:l=[]}=e,d=(0,i().v3)(),c=(0,r().IS)((e=>({importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:4,color:e.text.secondary,borderRadius:"6px"},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary},icon:{color:e.icon.tertiary}})),[]),u=(0,Ft().Hc)(),m=(0,Ae().X)("disconnect_contact_import"),p=s.length>0||l.length>0,g=(0,Ut().C)({onClickAuthenticated:e=>{m?Qt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:t}),n.setState({...n.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:u.importListButtonContainer,buttonStyle:u.importListButton,flowId:o});return(0,T.jsx)(Mt().Ay,{popupType:tn().n.Popup,alignmentToOrigin:Mt().yP.Center,placementToOrigin:Mt().sx.Bottom,render:()=>(0,T.jsx)(Bt().A,{importListItems:g}),originGap:12,renderOrigin:e=>(0,T.jsxs)(en().p,{style:{...c.importContactsButton},onClick:()=>{e.onClick(),vt().V(d,{source:"share_menu_inline_dropdown"})},children:[p?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.numContacts",defaultMessage:"{numContacts} contacts",values:{numContacts:s.length+l.length}}):(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.noContacts",defaultMessage:"None"}),(0,T.jsx)(Ee().Q,{iconGroup:Jt().l,variantName:"fillSmall",style:c.icon})]})})}var on=()=>n(870122);function sn(e){const{publicPermission:t}=e,n=(0,r().IS)((e=>({banner:{...(0,Pe().kJ)({theme:e,inheritanceBannerEnabled:!1}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.text.uiBluePrimary,fontWeight:A().Wy.medium}})),[]),o=t.permissionItem.role;if(!mt().Tt(o))return null;const i=(0,mt().W8)(t.permissionItem);return(0,T.jsxs)("div",{style:n.banner,children:[(0,T.jsxs)("div",{style:n.content,children:[(0,T.jsx)("div",{style:n.iconContainer,children:(0,T.jsx)(X().I,{icon:on().globeIcon,color:"secondary"})}),(0,T.jsx)(p().A,{style:n.label,isMultiline:!0,children:(0,T.jsx)(rn,{role:o,hasSitePublicPermission:i})})]}),(0,T.jsx)(en().p,{size:"sm",style:n.manageButton,onClick:()=>{i?U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish}):U().Ay.setState({...U().Ay.state,display:U().pP.MainShareMenu,tab:U().QC.Share,source:U().mc.PublicPermissionLevelBanner})},children:(0,T.jsx)(a().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]})}function rn(e){const{role:t,hasSitePublicPermission:n}=e;switch(t){case"read_and_write":return(0,T.jsx)(a().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,T.jsx)(a().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return n?(0,T.jsx)(a().sA,{id:"shareMenu.publicPermissionBanner.canReadSite",defaultMessage:"This site can be viewed by anyone on the web"}):(0,T.jsx)(a().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,z().HB)(t)}}var an=()=>n(150957),ln=()=>n(591130);function dn(e){let{inviteTarget:t,isRedesignEnabled:o,isMobile:i,captionOverride:l}=e;const d=(0,a().tz)(),c=(0,s().O$)(Qe().AppStoreCurrentSpaceStore),u=(0,s().K8)((()=>(0,ln().Pf)({groupName:t.value.name,intl:d})),[t,d]),m=(0,s().K8)((()=>{if(c&&t.value.icon)return{pointer:{table:c.table,id:c.id},icon:t.value.icon}}),[c,t]),g=(0,s().K8)((()=>(0,ln().xQ)({groupId:t.value.group_id})),[t]),f=(0,r().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:o?void 0:8,paddingBottom:o?void 0:8,marginLeft:o?void 0:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[o]);return(0,T.jsxs)("div",{style:f.titleContainer,children:[(0,T.jsx)(n(332126).A,{groupIcon:null==m?void 0:m.icon,isRedesignEnabled:o,spaceId:t.value.space_id}),(0,T.jsxs)("div",{style:f.groupInfoContainer,children:[(0,T.jsxs)("div",{style:f.nameAndIconContainer,children:[(0,T.jsx)(p().A,{style:f.groupNameLabel,children:u}),!o&&Boolean(null==m?void 0:m.icon)&&(0,T.jsx)(jt().B,{disabled:!0,bucket:"public",title:u,icon:m,size:18,isEmptyPage:!1})]}),(0,T.jsx)(p().A,{isSmall:!0,style:f.groupMembersLabel,children:l||(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(a().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,T.jsx)(a().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:g}})]})})]})]})}const cn=o.memo(dn);var un=()=>n(83544),mn=()=>n(539645),pn=()=>n(220413),gn=()=>n(126451),fn=()=>n(516267),hn=()=>n(797588),vn=()=>n(14679);function yn(e,t){let{store:n,isInvited:o,isRedesignEnabled:i,disabled:s,spaceVisibleUserMap:a,inviteTarget:l,id:d,focused:c,onClick:u,onAuxClick:m,onMouseEnter:p,role:g,disallowTabbing:f,ignoreLocalHoverState:h,isMobile:v}=e;const y=(0,r().IS)((()=>({container:(0,Pe().sH)({isRedesignEnabled:i,isMobile:v})})),[v,i]);return(0,T.jsx)(St().A,{ref:t,buttonStyle:y.container,title:"group"===l.type?(0,T.jsx)(cn,{inviteTarget:l,isRedesignEnabled:i,isMobile:v}):(0,T.jsx)(bn,{store:n,inviteTarget:l,isRedesignEnabled:i,spaceVisibleUserMap:a,isMobile:v}),disabled:s,right:!s&&(0,T.jsx)(xn,{onClick:u,checked:o,isRedesignEnabled:i}),id:d,focused:c,onClick:u,onAuxClick:m,onMouseEnter:p,role:g,disallowTabbing:f,ignoreLocalHoverState:h})}function bn(e){let{store:t,inviteTarget:n,isRedesignEnabled:i,isMobile:a,spaceVisibleUserMap:l}=e;const d=(0,s().K8)((()=>"existingUser"===n.type?(0,Dt().p)({spaceVisibleUserMap:l,userId:n.value.id,store:t}):void 0),[n,l,t]),c=(0,o.useMemo)((()=>"existingUser"===n.type?{actorStore:vn().L.createChildStore(t,{table:Q().oo,id:n.value.id}),avatar:void 0}:"newUser"===n.type?{actorStore:void 0,avatar:{email:n.value.email,..."slack"===n.source||"google"===n.source?{name:n.value.name,avatarUrl:n.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,z().HB)(n)),[n,t]),u=(0,r().IS)((()=>({cellMemberAvatarContainer:i?{}:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[i]),m="on"===(0,s().K8)((()=>ke().default.getEligibleGroup({experimentId:"contact_import_notion_account",parameter:"variant",defaultGroup:"control"})),[])&&"newUser"===n.type&&("google"===n.source||"slack"===n.source)&&n.value.user_id;return(0,T.jsx)(an().A,{isLarge:!0,...c,containerStyle:u.cellMemberAvatarContainer,avatarBadge:(()=>{const e=(()=>{if("newUser"!==n.type)return null;switch(n.source){case"slack":return un().A.images.externalIntegrations.slackIconPng;case"google":return un().A.images.externalIntegrations.googleGIconPng;default:return null}})();return e?(0,T.jsx)(fn().A,{type:"image_url",imageURL:e,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):null})(),spaceRole:d,caption:m&&(0,T.jsx)(hn().N,{inviteTarget:n})})}function xn(e){const{checked:t,isRedesignEnabled:n}=e,o=(0,r().IS)((e=>{const o=o=>{if(!n)return t?{background:pn().Ay.blue,borderColor:pn().Ay.blue}:{background:"transparent",borderColor:e.buttonPressedBackground};switch(o){case"default":return{background:t?e.checkboxBackground:"transparent",borderColor:t?e.checkboxBackground:e.icon.tertiary};case"hovered":return{background:t?e.checkboxHoveredBackground:e.uncheckedCheckboxHoveredBackground,borderColor:t?e.checkboxHoveredBackground:e.icon.tertiary};case"pressed":return{background:t?e.checkboxPressedBackground:e.uncheckedCheckboxPressedBackground,borderColor:t?e.checkboxPressedBackground:e.icon.tertiary};default:return(0,z().ub)(o),{}}};return{circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:n?18:22,height:n?18:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,...o("default"),marginRight:6},hovered:o("hovered"),pressed:o("pressed"),checkIcon:{height:n?9:12,width:n?9:12,color:"white"}}}),[t,n]);return(0,T.jsx)(gn().A,{onClick:e.onClick,style:o.circleCheckmark,hoveredStyle:o.hovered,pressedStyle:o.pressed,children:t&&(0,mn().o)(o.checkIcon)})}const Sn=o.memo(o.forwardRef(yn));var Mn=()=>n(874039),An=()=>n(477988),wn=()=>n(232376),kn=()=>n(439510),jn=()=>n(496505);function Cn(e){var t,n;const{store:o,shouldShowSlackOnly:l,shouldShowGoogleOnly:d,calculatedPermissions:c,permissionItemArgs:u,tokenQuery:m,showShimmer:g,error:f,ready:h,result:v}=e,y=(0,i().v3)(),b=(0,s().uB)(e.inviteTargetsStore,ce().Ay),x=(0,s().K8)((()=>U().Ay.state.display===U().pP.Invite&&U().Ay.state.focus&&"message"===U().Ay.state.focus),[]),S=(0,s().uB)(e.menuListStore,we().A),M=(0,qt().x)(),A=(0,s().K8)((()=>Ye().YA()),[]),w=(0,s().K8)((()=>(0,O().FI)()),[]),k=(0,r().IS)((e=>({googleSlackIcons:{position:"relative",width:32,height:32},icons:{width:20,height:20,borderRadius:"50%",padding:2,border:`1px solid ${e.stroke.secondary}`,backgroundColor:e.accentColors.gray[0],position:"absolute"},sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingLeft:8,paddingRight:8,paddingBottom:8},keepTypingMessage:{paddingLeft:Pe().rL,paddingRight:Pe().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.text.secondary,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:le().Ev.sm,height:le().Ev.sm,marginTop:2,color:e.icon.tertiary}})),[]),j=function(e,t){const n=(0,i().v3)(),o=(0,s().K8)((()=>{if(0!==t.length)return{spaceId:e,userIds:t}}),[e,t],{useDeepEqual:!0}),[{value:r}]=(0,st().Yb)((async()=>{if(void 0===o)return{};const t=await He().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:n,data:o,headers:(0,$t().WS)({cellId:void 0,spaceId:e})});return"success"===t.type?t.data.userToGroupMap:{}}),[n,o,e],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3});return r}((0,s().K8)((()=>o.getSpaceId()),[o]),(null==v?void 0:v.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)))??[]),C=c.pagePermissionUIModel,{inPageTargets:I,notInPageTargets:_,filteredImportedContacts:P}=(0,s().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[]}=v??{inviteUsers:[],inviteGroups:[],importedContacts:[]},i=[...e,...t],s=[],r=[],a=new Set;i.forEach((e=>{"group"!==e.type&&a.add(e.value.email.toLowerCase());const t=Boolean(Ot().wF({store:o,target:e}));if("existingUser"===e.type&&!Boolean(e.spaceRole)){let t;if(zt().A.state.shouldUseEdgeCache){var n;const i=null===(n=Ht().W.getData(y,{userId:e.value.id,spaceId:o.getSpaceId()}))||void 0===n?void 0:n.membership_type;t=i?(0,gt().$N)(i):void 0}else{var i;t=null===(i=M.get(e.value.id))||void 0===i?void 0:i.role}e.spaceRole=t||"not_in_space"}const l=(0,E().NV)({inviteTarget:e,store:o,calculatedPermissions:c,isRedesignEnabled:w,userToGroupMap:j});void 0!==l&&(t||mt().Tt(l.permissionItem.role??"none"))&&"newUser"!==e.type?l&&s.push({inviteTarget:e,...l}):"newUser"!==e.type&&r.push(e)}));const l=n.filter((e=>!a.has(e.value.email.toLowerCase())));return{inPageTargets:s,notInPageTargets:r,filteredImportedContacts:l}}),[v,o,c,j,w,y,M]),{isValidEmail:B,isEmailInTargets:R}=(0,s().K8)((()=>{const e=(0,fe().qh)(m);return{isValidEmail:(0,fe().DT)(e),isEmailInTargets:[...I.map((e=>{let{inviteTarget:t}=e;return t})),..._].some((t=>"group"!==t.type&&t.value.email===e))}}),[m,I,_]),L=(0,s().K8)((()=>b.state.inviteTargets.length>0),[b]),D=(0,qe().J)(),N=(0,s().K8)((()=>!(!D||l||d)&&"empty_state"===ke().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[D,l,d]),F=B&&!R,K=c.showRestrictedPermissionBanner,V=!l&&!d&&_.length>0&&(0===m.length||0===(null==v?void 0:v.tokenQuery.length)),W=!l&&!d&&m.length>0&&Boolean(null==v||null===(t=v.tokenQuery)||void 0===t?void 0:t.length)&&I.length>0,H=!l&&!d&&_.length>0&&m.length>0&&Boolean(null==v||null===(n=v.tokenQuery)||void 0===n?void 0:n.length),G=P.filter((e=>"slack"===e.source)),Y=P.filter((e=>"google"===e.source)),q=A&&G.length>0&&!N,$=Y.length>0&&!N,Z=N&&(G.length>0||Y.length>0),X={key:"imported slack contacts",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!h}),items:In({filteredContacts:G,isRedesignEnabled:w,environment:y,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:m,menuListStore:S})},J={key:"imported google contacts",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!h}),items:In({filteredContacts:Y,isRedesignEnabled:w,environment:y,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:m,menuListStore:S})},ee={key:"mixed contacts",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,loading:!h}),items:In({filteredContacts:[...Y,...G].sort(((e,t)=>(e.value.name??"").localeCompare(t.value.name??""))),isRedesignEnabled:w,environment:y,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:m,menuListStore:S})},te=F||!V&&!W&&!H&&!q&&!$&&!l&&!d&&m.length>0,ne=(0,s().K8)((()=>{const e=ue().subscriptionDataStoreInstance.state,{currentSpaceStore:t}=Qe().default.state;return t&&e?Gt().Ye(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Wt().LU.createChildStore(t,{table:Q().oo,id:n.userId}).getEmail();return e&&(0,fe().zN)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),oe=(0,Et().A)(o);if(f)return(0,T.jsx)(Pt().z,{loading:!h,children:(0,T.jsx)(wt().A,{title:(0,T.jsx)(a().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!h&&g)return(0,T.jsx)(Kt().J,{areaHeight:window.innerHeight});const ie={key:"user results",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,loading:!h,title:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:Fn({tokenQuery:m,possibleDomains:ne,shouldShowAutoFillEmail:te,isGuestInviteRequestRequired:oe.isGuestRequestRequired,environment:y,inviteTargetsStore:b,menuListStore:S,styles:k})},se={key:"import contacts",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,loading:!h}),items:[{key:"import contacts",render:()=>(0,T.jsx)(St().A,{focused:!1,style:{cursor:"default"},caption:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importContacts.caption",defaultMessage:"Add contacts from Google, Slack"}),icon:(0,T.jsxs)("div",{style:k.googleSlackIcons,children:[(0,T.jsx)(Ee().Q,{iconGroup:Rt().m,variantName:"default",style:{...k.icons,top:0,left:0}}),(0,T.jsx)(Ee().Q,{iconGroup:Lt().j,variantName:"default",style:{...k.icons,bottom:0,right:0}})]}),right:(0,T.jsx)(nn,{emailMessage:e.emailMessage??"",inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId,googleContacts:Y,slackContacts:G}),title:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.importContacts.title",defaultMessage:"Import contacts"})}),action:()=>{}}]},re={key:"suggested",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h}),items:_.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const n=Se().P4({target:e,inviteTargetsStore:b});return(0,T.jsx)(Sn,{...t,isRedesignEnabled:w,isMobile:y.device.isMobile,disabled:!1,inviteTarget:e,isInvited:n,spaceVisibleUserMap:M,store:o})},action:()=>_n({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:m,environment:y,type:"suggested"})})))},ae={key:"in page",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,title:w?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}):(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!h}),items:I.map(((e,t)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:s}=e,{type:r}=n;if("existingUser"===r){if(!!s&&s.length>1)return{key:n.value.id,render:e=>(0,T.jsx)(Rn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:s,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:K}),action:()=>{}};{const e=C.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:s=>w?(0,T.jsx)(Rn,{...s,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:K}):(0,T.jsx)(St().A,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)(Xt().A,{store:o,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:M,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(Rn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:K}),action:()=>_n({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:m,environment:y,type:"in_page"})}}}if("group"===r){if(!!s&&s.length>1)return{key:n.value.id,render:s=>(0,T.jsx)(Rn,{...s,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:K}),action:()=>{}};{const e=C.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));return e?{key:n.value.id,render:t=>(0,T.jsx)(St().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)(Zt().A,{store:o,groupPermission:e,spaceId:o.getSpaceId(),showInherited:!0,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(Rn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:K}),action:()=>_n({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:m,environment:y,type:"in_page"})}}}(0,z().HB)(r)}))},de={key:"not in page",render:e=>(0,T.jsx)(It().A,{...e,style:k.sectionMenuItem,title:m.length>0&&(w?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}):(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"})),loading:!h}),items:_.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>(0,T.jsx)(Sn,{...t,disabled:!1,isRedesignEnabled:w,isMobile:y.device.isMobile,inviteTarget:e,isInvited:Se().P4({target:e,inviteTargetsStore:b}),spaceVisibleUserMap:M,store:o}),action:()=>_n({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:m,environment:y,type:"not_in_page"})})))};let me=[];if(F&&me.push(ie),V&&me.push(re),W&&me.push(ae),H&&me.push(de),q&&me.push(X),$&&me.push(J),Z&&me.push(ee),l&&(me=[X],0===X.items.length))return(0,T.jsx)(Nn,{styles:k,importContactType:"slack"});if(d&&(me=[J],0===J.items.length))return(0,T.jsx)(Nn,{styles:k,importContactType:"google"});if(0===me.length){if(me=[ie],0===m.length&&!L)return N?(0,T.jsx)(En,{emailMessage:e.emailMessage,inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId}):(0,T.jsx)(On,{styles:k});if(0===m.length&&L)return(0,T.jsx)("div",{style:k.keepTypingMessage,children:(0,T.jsx)(p().A,{isSecondaryColor:!0,isSmall:!0,children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}else N&&me.unshift(se);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(sn,{publicPermission:c.mostPermissivePublicItem}),(0,T.jsx)(At().Ay,{type:At().Oh.Vertical,initialFocus:m.length>0?0:void 0,sections:me,store:S,disableKeyboard:x})]})}function In(e){const{filteredContacts:t,isRedesignEnabled:n,environment:o,inviteTargetsStore:i,blockStore:s,spaceVisibleUserMap:r,tokenQuery:a,menuListStore:l}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,T.jsx)(Sn,{...t,isRedesignEnabled:n,isMobile:o.device.isMobile,disabled:!1,inviteTarget:e,isInvited:Se().P4({target:e,inviteTargetsStore:i}),spaceVisibleUserMap:r,store:s}),action:()=>{Se().P4({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(F().kH(o,{invite_token_query:a,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,Yt().AI)(),type:Tn(e)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),l.unsetFocus())}})))}function Tn(e){return"google"===e.source?"google_contacts":"slack"===e.source?"slack":void(0,z().HB)(e.source)}function _n(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:o,rank:i,tokenQuery:s,environment:r,type:a}=e;Se().lW({inviteTargetsStore:n,inviteTarget:t})&&F().kH(r,{invite_token_query:s,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,Yt().AI)(),type:a}),o.unsetFocus()}const Pn=o.forwardRef((function(e,t){const{blockStore:n,inviteTarget:a,permissionItem:l,mostPermissivePermissions:d,permissionItemArgs:c,isRedesignEnabled:u}=e,m=(0,i().v3)(),[p,g]=(0,o.useState)(!1),f=(0,s().K8)((()=>n.getSpaceId()),[n]),h=(0,s().K8)((()=>d&&d.length>0),[d]),v=(0,o.useCallback)((()=>{if(h){const e=!1===p;g(!p),e&&yt().lD(m,{share_menu_session_id:U().Ay.state.sessionId,type:"group",group_id:a.value.group_id})}}),[m,h,p,g,a]),y=(0,r().IS)((e=>({buttonMenuItem:(0,Pe().sH)({isRedesignEnabled:u,isMobile:m.device.isMobile}),permissionRoleButton:{marginRight:-6,color:e.text.secondary,fontSize:12},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[m.device.isMobile,u]);return(0,T.jsx)(Tt().A,{delayThreshold:0,placement:Vt().W.Left,textWrap:!0,style:y.tooltip,renderTooltip:()=>(0,T.jsx)(Ln,{blockStore:n,blockPermissionItem:l}),render:o=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...o,children:(0,T.jsx)(St().A,{...e,buttonStyle:y.buttonMenuItem,...(0,Nt().A)(e,{onClick:v}),ref:t,title:(0,T.jsx)(cn,{inviteTarget:a,isRedesignEnabled:u,isMobile:m.device.isMobile,captionOverride:h&&p?(0,T.jsx)(Dn,{}):void 0}),right:(0,T.jsx)(_t().Y,{type:l.type,table:pt().ev,disabled:!0,icon:h?p?lt().B:dt().d:void 0,role:l.role??"none",isCurrentUser:!1,buttonStyle:y.permissionRoleButton})})}),h&&p&&(0,T.jsx)("div",{style:y.expandablePermissionList,children:null==d?void 0:d.map(((t,o)=>{const i=t.permissionItem.type;let s=null;switch(i){case"space_permission":s=(0,T.jsx)(An().A,{store:n,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:c,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_permission":s=(0,T.jsx)(kn().A,{store:n,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:c,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":s=(0,T.jsx)(Zt().A,{spaceId:f,store:n,groupPermission:t,permissionItemArgs:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"space_owner_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"collection_property_permission":case"team_owner_permission":case"team_permission":break;default:(0,z().HB)(i)}return(0,T.jsx)("div",{style:y.roundedPermissionItem,children:s},o)}))})]})})})),Bn=o.forwardRef((function(e,t){const{blockStore:n,inviteTarget:a,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,i().v3)(),[p,g]=(0,o.useState)(!1),f="existingUser"===a.type?Wt().LU.createChildStore(n,{table:Q().oo,id:a.value.id}):void 0,h=(0,s().K8)((()=>"none"===a.spaceRole?(0,Dt().p)({spaceVisibleUserMap:c,userId:a.value.id,store:n}):(0,an().v)(a.spaceRole)),[a,c,n]),v=(0,s().K8)((()=>n.getSpaceId()),[n]),y=(0,s().K8)((()=>d&&d.length>0),[d]),b=(0,o.useCallback)((()=>{const e=!1===p;g(!p),e&&yt().lD(m,{share_menu_session_id:U().Ay.state.sessionId,type:"user",userId:a.value.id})}),[m,p,g,a]),x=(0,r().IS)((e=>({permissionRoleButton:{marginRight:-6,color:e.text.secondary,fontSize:12},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:Pe().zr},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,T.jsx)(Tt().A,{delayThreshold:0,placement:Vt().W.Left,textWrap:!0,style:x.tooltip,renderTooltip:()=>(0,T.jsx)(Ln,{blockStore:n,blockPermissionItem:l}),render:o=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...o,children:(0,T.jsx)(St().A,{...e,...(0,Nt().A)(e,{onClick:b}),ref:t,title:(0,T.jsx)(an().A,{isLarge:!0,actorStore:f,containerStyle:x.cellMemberAvatarContainer,spaceRole:h,caption:y&&p?(0,T.jsx)(Dn,{}):void 0}),right:(0,T.jsx)(_t().Y,{type:l.type,table:pt().ev,disabled:!0,icon:y?p?lt().B:dt().d:void 0,role:l.role??"none",isCurrentUser:!1,buttonStyle:x.permissionRoleButton})})}),y&&p&&(0,T.jsx)("div",{style:x.expandablePermissionList,children:null==d?void 0:d.map(((t,o)=>{const i=t.permissionItem.type;let s=null;switch(i){case"space_permission":s=(0,T.jsx)(An().A,{store:n,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_owner_permission":s=(0,T.jsx)(jn().A,{store:n,blockTeamOwnerPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":s=(0,T.jsx)(kn().A,{store:n,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":s=(0,T.jsx)(wn().A,{store:n,blockTeamGuestPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":s=(0,T.jsx)(Zt().A,{store:n,spaceId:v,groupPermission:t,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":s=(0,T.jsx)(Xt().A,{store:n,userPermission:t,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"collection_property_permission":case"space_owner_permission":case"team_owner_permission":case"team_permission":break;default:(0,z().HB)(i)}return(0,T.jsx)("div",{style:x.roundedPermissionItem,children:s},o)}))})]})})})),Rn=o.forwardRef((function(e,t){const{inviteTarget:n}=e,o=n.type,i=(0,s().K8)((()=>(0,O().FI)()),[]);switch(o){case"group":return i?(0,T.jsx)(Mn().Ay,{...e,inviteTarget:n}):(0,T.jsx)(Pn,{...e,ref:t,inviteTarget:n});case"existingUser":return i?(0,T.jsx)(Mn().Ay,{...e,inviteTarget:n}):(0,T.jsx)(Bn,{...e,ref:t,inviteTarget:n});default:(0,z().HB)(o)}}));function Ln(e){const{blockStore:t,blockPermissionItem:n}=e,o=(0,i().v3)(),l=(0,s().O$)(Qe().AppStoreCurrentSpaceStore),d=(0,s().K8)((()=>{if(l)return(0,V().c2)(o,l)}),[o,l]),c=(0,s().K8)((()=>{const e=n.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Wt().h4.createChildStore(t,{table:ft().yK,id:n.team_id})}}),[t,n]),u=(0,s().K8)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,r().IS)((()=>({container:{fontWeight:A().Wy.bold,...A().RC},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p=n.type;return"space_permission"===p?(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,T.jsxs)("span",{style:m.container,children:[d&&(0,T.jsx)(jt().B,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,T.jsx)(Ct().A,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===p?(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(jt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Ct().A,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===p?(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(jt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Ct().A,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===p?(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(jt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Ct().A,{store:c,style:m.recordTitle})]})}}):"group_permission"===p?(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===p||"exclusive_user_permission"===p||"public_permission"===p||"trusted_domain_permission"===p||"collection_property_permission"===p||"restricted_permission"===p||"deleted_permission"===p||"team_permission"===p||"team_owner_permission"===p||"bot_permission"===p||"space_owner_permission"===p?(0,T.jsx)(T.Fragment,{children:mt().Tt(n.role??"none")&&(0,T.jsx)(a().sA,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,z().HB)(p)}function Dn(){return(0,T.jsx)(a().sA,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function Nn(e){const{styles:t,importContactType:n}=e,o="google"===n?"Google account":"Slack workspace";return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,ut().G)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,T.jsx)("div",{children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:o}})})]})]})}function On(e){const{styles:t}=e;return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,ct().x)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,T.jsx)("div",{children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function En(e){const{inviteTargetsStore:t,flowId:n,emailMessage:o}=e,s=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,textAlign:"center",fontSize:14,position:"relative",pointerEvents:"auto",marginTop:32,marginBottom:24,gap:14},logos:{display:"flex",gap:12,alignItems:"center",justifyContent:"center"},text:{marginTop:6,textAlign:"center"},subtext:{color:e.text.secondary},button:{padding:"8px 12px"}})),[]),l=(0,Ft().Hc)(),d=(0,i().v3)(),c=(0,Ae().X)("disconnect_contact_import"),u=(0,Ut().C)({onClickAuthenticated:e=>{c?Qt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:o??""}),t.setState({...t.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:l.importListButtonContainer,buttonStyle:l.importListButton,flowId:n});return(0,T.jsxs)("div",{style:s.container,children:[(0,T.jsxs)("div",{style:s.logos,children:[(0,T.jsx)(Ee().Q,{iconGroup:Rt().m,variantName:"default",style:{height:22,width:22}}),(0,T.jsx)(Ee().Q,{iconGroup:Lt().j,variantName:"default",style:{height:22,width:22}})]}),(0,T.jsxs)("div",{style:s.text,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.title",defaultMessage:"Import contacts"})}),(0,T.jsx)("div",{style:s.subtext,children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.text",defaultMessage:"Connect with Google or Slack"})})]}),(0,T.jsx)("div",{children:(0,T.jsx)(Mt().Ay,{popupType:kt().nl.Popup,alignmentToOrigin:Mt().yP.Start,placementToOrigin:Mt().sx.Left,render:()=>(0,T.jsx)(Bt().A,{importListItems:u}),originGap:12,renderOrigin:e=>(0,T.jsx)(xt().E,{...e,onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),vt().V(d,{source:"share_menu_empty_state"})},style:s.button,children:(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.button",defaultMessage:"Get started"})})})})]})}function Un(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:o}=e;const i=(0,ht().Ay)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,o),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function Fn(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:o,shouldShowAutoFillEmail:i,environment:s,inviteTargetsStore:r,menuListStore:l,styles:d}=e;return Un({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,T.jsx)(St().A,{icon:(0,ct().x)({width:20,height:20}),title:(0,T.jsx)(Kn,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:o}),caption:o?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,T.jsx)(X().I,{icon:at,size:"sm",color:"tertiary"}),...t}),action:async()=>{const o=(0,fe().qh)(e.tokenQuery);if(!(0,fe().DT)(o)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(Se().P4({target:t,inviteTargetsStore:r})||r.setState({inviteTargets:[...r.state.inviteTargets,t],tokenQuery:""}))}const i=await bt().Ah(s,[o]);if(!i.length)return;const a=i[0];Se().P4({target:a,inviteTargetsStore:r})||(F().kH(s,{invite_token_query:t,selected_user_token:a,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,Yt().AI)(),type:"autofill"}),r.setState({inviteTargets:[...r.state.inviteTargets,a],tokenQuery:""}),l.unsetFocus())}})))}function Kn(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:o}=e;return o?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,T.jsx)(a().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const Vn=function(e){const t=(0,i().v3)(),n=(0,a().tz)(),[r,l]=(0,o.useState)(!0),d=(0,s().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,s().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Ze().A.completeSlackAuthentications.state.length>0&&Ye().YA(),n=Ze().A.externalAuthentications.state.filter((e=>e.integration_id===We().E8)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly]),u=(0,s().K8)((()=>{const e=zt().A.state.shouldUseEdgeCache,t=ke().default.checkGate({gateName:"edge_cache_share_menu"});return e&&t}),[]),[{value:m,status:p}]=(0,st().Yb)((async()=>({...await bt().hQ({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:n,shouldUseEdgeCacheRollout:u}).finally((()=>l(!1))),tokenQuery:d})),[t,n,e.membersOnly,d,c,u],{debounce:40});return(0,T.jsx)(Cn,{...e,tokenQuery:d,showShimmer:r,ready:"pending"!==p&&"idle"!==p,error:"rejected"===p,result:m})};function zn(e){const t=(0,i().v3)(),n=(0,s().uB)(e.inviteTargetsStore,ce().Ay),a=(0,s().K8)((()=>n.state.inviteTargets),[n]),{display:l,source:d,focus:c,emailMessage:u}=(0,s().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),m=(0,s().O$)(Qe().AppStoreCurrentSpaceStore),p=l===U().pP.Invite&&a.length>0,g=(0,s().K8)((()=>d===U().NL.Notion&&0===a.length&&(0,Ye().YA)()),[a.length,d]),f=(0,s().O$)(Ze().A.completeSlackAuthentications),h=(0,s().K8)((()=>d===U().NL.Notion&&0===a.length),[a.length,d]),v=(0,s().K8)((()=>Ze().A.externalAuthentications.state.filter((e=>e.integration_id===We().E8))),[]),y=(0,s().K8)((()=>(0,O().FI)()),[]),[b,x]=(0,o.useState)(!1),S=p&&!g,M=(0,o.useCallback)((()=>{n.reset()}),[n]);(0,o.useEffect)((()=>{if(m&&!b&&(g||h)){if(g)for(const e of f)He().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:m.id,integrationId:We().zG,importContactType:"slack"}}).catch((e=>{}));if(h)for(const e of v)He().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:m.id,integrationId:We().E8,importContactType:"google"}}).catch((e=>{}));x(!0)}}),[g,h]);const A=function(e){let{scrollerMarginBottom:t}=e;return(0,r().IS)((e=>({scroller:{flexGrow:1,marginBottom:t},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary}})),[t])}({scrollerMarginBottom:S?nt:0}),w=(0,qe().J)(),k=(0,s().K8)((()=>!(!w||d===U().NL.Slack||d===U().NL.Google)&&"empty_state"===ke().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[w,d]);return l!==U().pP.Invite?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ge().H,{type:$e().A.Y,style:A.scroller,children:(0,T.jsx)(Vn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:d===U().NL.Slack,shouldShowGoogleOnly:d===U().NL.Google,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,emailMessage:u,flowId:e.flowId})}),k?null:(0,T.jsx)(it().g,{shouldShowSlackImportContactsButton:g,shouldShowGoogleImportContactsButton:h,emailMessage:u,inviteTargetsStore:n,isRedesignEnabled:y,emailMessageOpen:S,flowId:e.flowId,source:"share_menu"}),(0,T.jsx)(ot,{open:p&&!g,focus:c===U().yZ.Message,value:u,onFocus:()=>{d&&l===U().pP.Invite&&U().Ay.setState({...U().Ay.state,focus:U().yZ.Message,tab:U().QC.Share,display:l,source:d,emailMessage:u})},onChange:e=>{U().Ay.setState({...U().Ay.state,focus:c,tab:U().QC.Share,display:l,source:d,emailMessage:e.target.value})},onCancel:async()=>{await Xe().T({environment:t,inviteTargetsStore:n})&&(Xe().XP(t),M())},maxLength:1e3})]})}var Wn=()=>n(951514),Hn=()=>n(838517),Gn=()=>n(539048),Yn=()=>n(289241);const qn=(0,le().xh)("personCropCircleBadgeExclamationPoint",{default:{loader:()=>n.e(50710).then(n.bind(n,178024))},small:{loader:()=>n.e(50710).then(n.bind(n,477102))},fill:{loader:()=>n.e(50710).then(n.bind(n,88484))},fillSmall:{loader:()=>n.e(50710).then(n.bind(n,25749))}},["person","alert","exclamation","warning","user"]);var $n=()=>n(529305),Qn=()=>n(951540),Zn=()=>n(300481),Xn=()=>n(995473);function Jn(e){const{email:t}=e;return(0,T.jsx)(oe().A,{avatar:{email:t},size:28})}function eo(e){const{children:t}=e,n=(0,r().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,T.jsxs)("div",{style:n.wrapper,children:[t,(0,T.jsx)("div",{style:n.shield,children:(0,T.jsx)(Ee().Q,{iconGroup:Xn().u,colorName:"secondary",variantName:"mini"})})]})}function to(e){const{rows:t,internalDomains:n}=e,o=(0,r().IS)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,T.jsx)(Ge().H,{type:$e().A.Y,style:o.inviteTargetList,children:(0,T.jsx)(Z().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,T.jsx)(no,{email:e.email,internalDomains:n},e.email);case"existing":return(0,T.jsx)(oo,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,z().HB)(t)}}))})})}function no(e){const{email:t,internalDomains:n}=e,o=(0,he().C7)(t,n);return(0,T.jsx)(io,{avatar:o?(0,T.jsx)(eo,{children:(0,T.jsx)(Jn,{email:t})}):(0,T.jsx)(Jn,{email:t}),name:t,email:t})}function oo(e){const{userStore:t,internalDomains:n}=e,o=(0,a().tz)(),{name:i,email:r}=(0,s().K8)((()=>({name:t.getDisplayName(o),email:t.getEmail()})),[t,o]);if(!i||!r)return null;const l=(0,he().C7)(r,n);return(0,T.jsx)(io,{avatar:l?(0,T.jsx)(eo,{children:(0,T.jsx)(oe().A,{userStore:t,size:28})}):(0,T.jsx)(oe().A,{userStore:t,size:28}),name:i,email:r})}function io(e){const{avatar:t,name:n,email:o}=e;return(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,T.jsxs)(Z().Y1,{gap:2,children:[(0,T.jsx)(J().D,{styleName:"Body-14px/Medium",children:n}),(0,T.jsx)(J().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:o})]})]})}function so(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,z().HB)(t)}}function ro(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:r,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i().v3)(),u=(0,a().tz)(),[m,p]=(0,s().K8)((()=>[n.id,n.getName()]),[n]),g=(0,s().K8)((()=>null==r?void 0:r.getUserId()),[r]),f=(0,s().K8)((()=>{var e;return(null===(e=Zn().A.getData(c,{spaceId:m}))||void 0===e?void 0:e.filter((e=>e.hasGuests)).map((e=>e.domain)))??[]}),[c,m]),h=(0,Ie()._X)({name:"internal_guests",spaceId:m,userId:g,amount:0}),v=(0,o.useCallback)((()=>{const e=t.map(so).filter(z().O9);l(e)}),[t,l]);return h&&f?(0,T.jsx)(ye().A,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:v,children:(0,T.jsx)($n().tf,{header:(0,T.jsx)($n().YA,{iconAndTitle:(0,T.jsx)($n().ZQ,{iconGroup:qn,iconColorName:"secondary",title:u.formatMessage(lo.title,{spaceName:p,guestLimit:h.limit.total})}),description:u.formatMessage(lo.description,{domain:f[0].url,p:e=>(0,T.jsx)(J().D,{colorName:"uiBluePrimary",children:(0,T.jsx)("p",{children:e})})})}),footer:(0,T.jsx)(ao,{rowCount:t.length,onClickAddMembers:v,onClickManageGuests:d}),children:(0,T.jsx)(to,{rows:t,internalDomains:f})})}):null}function ao(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:o}=e,i=(0,a().tz)(),s=i.formatMessage(lo.addMember,{rowCount:t});return(0,T.jsxs)(Z().Y1,{gap:16,children:[(0,T.jsxs)(Z().Y1,{gap:8,children:[(0,T.jsx)(Qn().A,{"aria-label":s,onClick:n,style:{height:32},children:s}),(0,T.jsx)(ee().A,{size:"lg","aria-label":i.formatMessage(lo.manageGuestsInSettings),onClick:o,children:i.formatMessage(lo.manageGuestsInSettings)})]}),(0,T.jsx)("div",{style:{textAlign:"center"},children:(0,T.jsx)(J().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(lo.billingNotice)})})]})}const lo=(0,a().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(610931);var co=()=>n(502140),uo=()=>n(704082),mo=()=>n(23371),po=()=>n(145046),go=()=>n(575015),fo=()=>n(707781),ho=()=>n(919536),vo=()=>n(477784);async function yo(e){const{environment:t,email:n}=e,o=await He().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===o.type){const e=o.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,o=await He().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,fo().H)(vo().A.getIntl())}});if("failed"===o.type)throw o.error;return o.data.userId}({environment:t,email:n})}async function bo(e){const{blockPermissionItem:t,blockStore:n,environment:o,metadata:i,sudoModeStore:s}=e;await ho().J4({environment:o,store:n,sudoModeStore:s,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var xo=()=>n(363721);const So=(0,a().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function Mo(e){const{environment:t,intl:n,internalDomains:o,destination:i,invites:s,metadata:r,sudoModeStore:a,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:o,metadata:i,sudoModeStore:s,contextualInviteStore:r}=e,a=(await(0,mo().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:o}=e,{blockStore:i,spaceStore:s}=o,{defaultAddability:r}=t;try{switch(r.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:s,defaultAddability:r}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:a}=s,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=o,{inviteOrigin:m}=i,p=await yo({environment:t,email:a});if(!p)throw new Error("Invitee user not found");const g={type:"user_permission",role:c,user_id:p},f={type:"user_permission",role:l,user_id:p};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:o,inviteOrigin:i,spacePermissionItem:s,spaceStore:r,sudoModeStore:a}=e;if(t.user_id!==s.user_id)throw new Error("User IDs for block and space permission items must match");if(!r.isTeamsEnabled()&&!(await W().oH({environment:o,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.");await ho().J4({environment:o,store:r,sudoModeStore:a,permissionItems:[s],invite:{inviteOrigin:i}}),await ho().J4({environment:o,store:n,sudoModeStore:a,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:m,spacePermissionItem:g,spaceStore:u});const h="member"===r.type&&"over_internal_guest_limit"===r.reason;return{type:"createdMember",invite:n,inviteeUserId:p,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:s,internalDomain:r}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:a}=s,{spaceStore:l}=o,{inviteMessage:d}=i,c=await yo({environment:t,email:a});if(!c)throw new Error("Invitee user not found");await async function(e){const{environment:t,spaceStore:n,inviteeUserId:o,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const s=await He().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:o,spaceId:n.id,message:i}});if("failed"===s.type)throw s.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==r;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:s}=e,{invitee:r}=n;if(void 0===r)throw new Error("Expected invite.invitee to be defined");const{email:a}=r,{blockRole:l,blockStore:d}=o,c=await yo({environment:t,email:a});if(!c)throw new Error("Invitee user not found");const u={type:"user_permission",role:l,user_id:c};return await bo({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:s}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:s}=n.invitee,{blockRole:r,blockStore:a,spaceStore:l}=o,{inviteMessage:d}=i,c={id:a.id,spaceId:l.id},u=await yo({environment:t,email:s});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:o,inviteeUserId:i,inviteMessage:s}=e,r=await He().callApi({eventName:"requestAccess",environment:o,data:{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:s}}});if("failed"===r.type)throw r.error}({block:c,blockRole:r,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:s}=e,{blockRole:r,blockStore:a}=o;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:r,group_id:l.group_id};return await bo({blockPermissionItem:d,blockStore:a,environment:t,metadata:i,sudoModeStore:s}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,z().HB)(r)}}catch(l){var a;const e=(0,uo().A)(l).message,o={miscDataToConvertToString:{message:e,spaceId:s.id,blockId:i.id,actorUserId:n.currentUser.id,inviteeEmail:null===(a=t.invitee)||void 0===a?void 0:a.email,defaultAddabilityType:r.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),co().log({level:d?"info":"error",from:"processInvite",type:c,data:o});const u=vo().A.formatMessage(So[c]);return void(d?po().rG({message:u}):po().f1(u))}}({environment:t,invite:e,destination:o,metadata:i,sudoModeStore:s})))).filter(z().O9);if(r){const e={};for(const t of a)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);r.setState({...r.state,invitedEmailToUserIdMap:e})}return a}({destination:i,environment:t,invites:s,metadata:r,sudoModeStore:a,contextualInviteStore:l});if((0,xo().Bw)({destination:i,environment:t,internalDomains:o,inviteResults:d,metadata:r}),0===d.length)return!1;return(0,O().FI)()?go().D6({label:Ao({invites:s,intl:n})}):go().D6({label:n.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"})}),!0}function Ao(e){var t;const{invites:n,intl:o}=e,i=null===(t=n[0].invitee)||void 0===t?void 0:t.email;i||o.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const s=n.length-1;return n.filter((e=>{var t;return"member"!==(null===(t=e.invitee)||void 0===t?void 0:t.currentRole)})).length===n.length?s<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:s}):s<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:s})}function wo(e){e.reset(),U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.MainShareMenu,source:U().mc.ShareTopbarButton})}async function ko(e){const{addAsMembersResult:t,destination:n,environment:o,internalDomains:i,intl:s,invites:r,inviteTargetsStore:a,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",Fe().A.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(wo(a),await Mo({destination:n,environment:o,internalDomains:i,invites:r,intl:s,metadata:l})):(0,z().HB)(t))}async function jo(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:o,metadata:i,invites:s,environment:r,internalDomains:a,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:m}=e,p=s.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=s.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(p){const e=s.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:o}=t;switch(o){case"existingUser":return{type:"existing",userStore:new(Wt().LU)(n,{table:Q().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,z().HB)(o)}}({environment:r,inviteTarget:e.inviteTarget}))).filter(z().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:o}=e;return await Yn().T.showAsyncModal((e=>(0,T.jsx)(Gn().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,T.jsx)(ro,{inviteUserListRows:t,spaceStore:n,spaceUserStore:o,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await ko({addAsMembersResult:n,destination:t,environment:r,internalDomains:a,intl:l,invites:s,inviteTargetsStore:d,metadata:i})}else{wo(d);if(!(await Mo({destination:t,environment:r,internalDomains:a,intl:l,invites:s,metadata:i,sudoModeStore:m,contextualInviteStore:n})))return;const e=s.map((e=>e.invitee)).filter(z().O9);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:o,invitees:i,spaceStore:s}=e,r=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:r}),K().BY({environment:o,spaceStore:s,contextualInviteStore:t})}({contextualInviteStore:n,environment:r,spaceStore:c,defaultAddabilities:o,invitees:e})}}function Co(e){const{tooltip:t,disabled:n,onClick:o}=e,i=(0,s().K8)((()=>(0,O().FI)()),[]);return(0,T.jsx)(Tt().A,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,T.jsx)(Qn().A,{size:"lg",style:{marginLeft:8,...i&&{borderRadius:6,paddingLeft:12,paddingRight:12}},disabled:n,onClick:o,...e,children:(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var Io=()=>n(975392),To=()=>n(76311),_o=()=>n(797715),Po=()=>n(338221),Bo=()=>n(538433),Ro=()=>n(779648),Lo=()=>n(699692),Do=()=>n(167089),No=()=>n(987392);const Oo=(0,a().YK)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guest:{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function Eo(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:i}=e,r=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,z().HB)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,z().HB)(t.reason);if("member_request"===t.type)return"red";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,z().HB)(t.reason)}else(0,z().HB)(t)}(t,n),l=(0,a().tz)(),d=Fo(r),c=(0,o.useCallback)((()=>{i(t)}),[t,i]),u=(0,s().K8)((()=>(0,O().FI)()),[]),m=function(e){const{inviteTarget:t,defaultAddability:n,intl:o,isRedesignEnabled:i}=e,s=_e(t),r=t.type;if("group"===r)return;if("invalidUser"===r)return o.formatMessage(Oo.invalidUser,{text:t.value.text});if(!s)return;if("existingUser"!==r&&"newUser"!==r)return(0,z().HB)(r);if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return o.formatMessage(Oo.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return o.formatMessage(Oo.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return o.formatMessage(Oo.disabledByAdmins);if("not_authorized_domain"===n.reason)return o.formatMessage(Oo.notAuthorizedDomain,{email:s});if("invalid_email"===n.reason)return o.formatMessage(Oo.invalidUser,{text:"unknown"});(0,z().HB)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?o.formatMessage(Oo.autojoinMember,{email:s,domain:(0,fe().zN)(s)}):"guests_disabled"===n.reason?o.formatMessage(Oo.guestsDisabledMember,{email:s}):"over_internal_guest_limit"===n.reason?s:(0,z().HB)(n.reason);if("member_request"===n.type)return o.formatMessage(Oo.disabledByAdmins);if("member_page_add"===n.type)return s;if("guest"===n.type)return i?o.formatMessage(Oo.guestV2,{email:s}):o.formatMessage(Oo.guest,{email:s});if("guest_request"===n.type)return o.formatMessage(Oo.guestRequest);if("guest_page_add"===n.type)return i?o.formatMessage(Oo.guestV2,{email:s}):o.formatMessage(Oo.guest,{email:s});(0,z().HB)(n)}({inviteTarget:t,defaultAddability:n,intl:l,isRedesignEnabled:u});return(0,T.jsx)(Tt().A,{placement:Vt().W.Top,renderTooltip:()=>m,disableTooltip:!m,render:e=>(0,T.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,T.jsxs)(Z().Y1,{gap:2,style:d.token,borderRadius:u?4:3,padding:"2px 4px",width:"hug",children:[(0,T.jsxs)(Z().Y1,{align:"center-left",borderRadius:3,direction:"horizontal",gap:4,width:"hug",children:[(0,T.jsx)(Uo,{inviteTarget:t,tokenColor:r}),(0,T.jsx)(J().D,{colorName:Ko(r),styleName:"UIRegular-14px/Regular",customStyles:d.label,children:Ho(t,l)}),(0,T.jsx)(gn().A,{hoveredStyle:d.removeButtonHovered,pressedStyle:d.removeButtonPressed,onClick:c,children:(0,T.jsx)(Ee().Q,{iconGroup:No().k,colorName:"secondary",variantName:"small"})})]}),(0,T.jsx)(je,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,T.jsx)("div",{style:{marginLeft:24,paddingBottom:2},children:(0,T.jsx)(J().D,{colorName:"secondary",styleName:"UISmall-12px/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function Uo(e){const{inviteTarget:t,tokenColor:n}=e,o=Fo(n);switch(n){case"green":return(0,T.jsx)(Ee().Q,{iconGroup:Bo().g,colorName:"greenPrimary",variantName:"default"});case"yellow":return(0,T.jsx)(Ee().Q,{iconGroup:Lo().u,colorName:"yellowPrimary",variantName:"default"});case"red":return(0,T.jsx)(Ee().Q,{iconGroup:Ro().F,colorName:"uiRedPrimary",variantName:"default"});case"gray":return"existingUser"===t.type?(0,T.jsx)(Z().Y1,{align:"center",width:20,height:20,children:(0,T.jsx)(oe().A,{userValue:t.value,size:16})}):(0,T.jsx)("div",{style:o.iconCircle,children:(0,Do().M)(o.icon)});default:(0,z().HB)(n)}}function Fo(e){return(0,r().IS)((t=>({token:Vo(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function Ko(e){switch(e){case"green":return"greenPrimary";case"yellow":return"yellowPrimary";case"red":return"uiRedPrimary";case"gray":return"grayPrimary";default:(0,z().HB)(e)}}function Vo(e,t){return{background:zo(e,t),border:Wo(e,t)}}function zo(e,t){switch(e){case"green":return t.fill.greenPrimary;case"yellow":return t.fill.yellowSecondary;case"red":return t.tint.uiRed;case"gray":return t.legacyDefaultSelectColor;default:(0,z().HB)(e)}}function Wo(e,t){switch(e){case"red":return`1px dashed ${t.stroke.uiRedPrimary}`;case"green":case"yellow":case"gray":return;default:(0,z().HB)(e)}}function Ho(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return $().Bj6.fromValue(Q().oo,e.value).getDisplayName(t);case"group":return(0,ln().Pf)({intl:t,groupName:e.value.name});default:(0,z().HB)(n)}}function Go(e){const{addabilities:t,disabled:n,metadata:a,focus:l,onFocus:d,onInputChanged:c,onSubmit:u,placeholder:m,right:p,showEmptyError:g,setAutoFocusInput:f}=e,h=(0,i().v3)(),v=(0,i().Y0)(),y=(0,s().uB)(e.inviteTargetsStore,ce().Ay),b=(0,s().K8)((()=>y.state.inviteTargets),[y]),x=function(e){const{focus:t,disabled:n,hasTokens:o}=e,i=(0,s().K8)((()=>(0,O().FI)()),[]);return(0,r().IS)((e=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:i?{alignSelf:"flex-start"}:{},inputOuterStyle:{borderRadius:i?6:4,...t&&!i&&{background:"none"},...n&&{background:e.inputBackground,color:e.text.secondary,fill:pn().Ay.white,opacity:.4},...i&&{alignItems:"flex-start"}},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{...!o&&{padding:2}},warningMessage:{color:"#DE5550"}})),[o,i,t,n])}({focus:l,disabled:n,hasTokens:b.length>0}),S=(0,s().K8)((()=>y.state.tokenQuery),[y]),M=(0,s().K8)((()=>(0,O().FI)()),[]),{inputFieldText:A}=(0,s().K8)((()=>({inputFieldText:y.state.tokenQuery.trim()})),[y]),w=(0,o.useCallback)((e=>{To().S({inviteTargetsStore:y,targetToRemove:e})}),[y]);return b?(0,T.jsx)(_o().Ay,{focus:l,focusAfterAnimation:!0,onClick:()=>{v.isMobile||null==d||d()},format:_o().le.Share,value:S,onChange:e=>{if(M&&0===A.length){const e=U().Ay.state;U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),null==f||f(!1)}To().P({environment:h,event:e,inviteTargetsStore:y,inviteOrigin:a.inviteOrigin,flowId:a.inviteFlowId,onInputChanged:c})},type:"email",tokens:b.map(((e,n)=>(0,T.jsx)(Eo,{inviteTarget:e,onClickRemove:w,defaultAddability:Yo(e,t)},n))),disabled:n,autoComplete:"off",placeholder:m,onRemoveLastToken:()=>{y.setState({...y.state,inviteTargets:y.state.inviteTargets.slice(0,-1)})},right:p,rightWrapStyle:x.inputRightItemStyle,showBorder:!0,inputStyle:x.inputInnerStyle,inputAndTokenWrapRightStyle:x.inputAndTokenWrapRight,style:x.inputOuterStyle,onSubmit:u,inputFullWidth:!0,message:(0,T.jsx)(Po().p,{invalidInvites:(0,Io().oE)(b.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:g,styles:x.warningMessage})}):null}function Yo(e,t){const n=_e(e);if(n)return null==t?void 0:t[n]}var qo=()=>n(115912);function $o(e){const{onClick:t,featureAvailability:n}=e;return(0,T.jsx)(Tt().A,{disableTooltip:!1,renderTooltip:()=>(0,T.jsx)(qo().j,{featureAvailability:n}),render:e=>(0,T.jsx)(Qn().A,{size:"lg",style:{marginLeft:8},onClick:t,...e,children:(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Qo=1e3;function Zo(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:m,spaceRole:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,v=(0,i().v3)(),y=(0,a().tz)(),b=(0,r().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:pn().Ay.uiGray}})),[]),[x,S]=(0,o.useState)("editor"),[M,A]=(0,o.useState)(!1),w=(0,s().K8)((()=>(0,O().FI)()),[]),{source:k,focus:j,emailMessage:C,display:I}=(0,s().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),_=(0,s().K8)((()=>t.getType()),[t]),{inviteTargets:P,inputFieldText:B}=(0,s().K8)((()=>({inviteTargets:(0,Se().U1)({inviteTargetsStore:c,includeInputFieldText:!0}),inputFieldText:c.state.tokenQuery.trim()})),[c]),R=async()=>{if(!M&&l&&d){if(0===P.length&&w){const e=U().Ay.state;return U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),void F().UC(v,{source:"invite_button"})}A(!0);try{const e={blockRole:x,blockStore:t,spaceRole:p,spaceStore:g};await jo({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:v,internalDomains:d,intl:y,invites:u,inviteTargetsStore:c,metadata:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{A(!1)}}},L=(0,Le().sf)(u.map((e=>e.invitee)).filter(z().O9)),D=(0,s().K8)((()=>f.getUserId()),[f]),N=(0,Ie()._X)({name:"guests",spaceId:g.id,userId:D,amount:L}),E=(0,s().K8)((()=>t.canEditMembership()),[t]),K=(0,Hn().i0)(t),V=(0,Hn().ty)(t),W=Object.values(l??{}).some((e=>"none"===e.type||"member_request"===e.type)),H=C.length>Qo,G=M||!E||K||V,[Y,q]=(0,o.useState)(!G);return(0,T.jsx)(Tt().A,{disableTooltip:E&&!K&&!V,placement:Vt().W.Left,renderTooltip:()=>E?K?(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):V?(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:w?(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}):(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people"}),render:e=>(0,T.jsxs)("div",{style:{display:"flex"},...e,children:[(0,T.jsx)(Go,{inviteTargetsStore:c,metadata:m,focus:j===U().yZ.Search||w&&I===U().pP.MainShareMenu&&Y,setAutoFocusInput:q,addabilities:l,disabled:G,onFocus:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:k||U().NL.Notion,emailMessage:C||""}),F().Wd(v,{source:k||U().NL.Notion}),0===P.length&&w&&F().UC(v,{source:"invite_button"})},onSubmit:()=>{B.length>0||R()},placeholder:y.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:w&&B.length>0&&U().Ay.getState().display===U().pP.Invite||P.length>0?(0,T.jsx)(Wn().Ay,{disabled:!E||K||V,role:x,table:"block",type:"user_permission",blockType:_,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:b.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>S(e)}):void 0}),N&&(0,Ie().N9)(N,{available:()=>(0,T.jsx)(Co,{tooltip:C.length>Qo?(0,T.jsx)(a().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!E||K||V||W||H,onClick:R}),unavailable:e=>(0,T.jsx)($o,{featureAvailability:e,onClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:void 0,source:k||U().NL.Notion,emailMessage:C||""}),bt().D6({environment:v,upgradeButtonName:"user_permission_item"})}})})]})})}var Xo=()=>n(905977);const Jo=function(e){const t=(0,r().DP)(),{buttonStyle:n}=(0,r().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,boxShadow:e.shadow2XS,background:e.inputBackground,color:e.text.secondary,fill:pn().Ay.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}})),[]);return(0,T.jsx)(gn().A,{hovered:e.hovered,onClick:e.onClick,disabled:e.disabled,disabledFeedback:!0,style:{...n,...e.isLarge&&{height:32},...e.style},hoveredStyle:{background:t.buttonHoveredBackground},pressedStyle:{background:t.buttonPressedBackground},onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:e.className,children:e.children})};const ei=function(e){const{store:t}=e,{isMobile:o}=(0,i().Y0)(),l=(0,s().K8)((()=>t.canEditMembership()),[t]),d=(0,s().K8)((()=>(0,O().FI)()),[]),c=(0,Hn().i0)(t),u=(0,Hn().ty)(t),m=(0,r().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:Je().Y3},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden",...d?{background:e.tint.regular,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:o?36:30}:{}},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...A().RC},iconContainer:{fill:e.icon.secondary,marginRight:8},blueButton:{minWidth:Je().CO}})),[o,d]);return(0,T.jsx)(Tt().A,{renderTooltip:()=>u?(0,T.jsx)(a().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,T.jsx)(a().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:l&&!c&&!u,render:t=>(0,T.jsxs)("div",{style:m.buttonContainer,...t,children:[(0,T.jsx)(Jo,{onClick:e.onClick,disabled:!l||c||u,style:m.inputButton,children:(0,T.jsx)("div",{style:m.inputContent,children:o&&d?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:m.iconContainer,children:(0,n(668657).q)({height:16,width:16})}),(0,T.jsx)(a().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,T.jsx)(a().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!o&&(0,T.jsx)(Qn().A,{size:"lg",onClick:e.onClick,disabled:!l||c||u,style:m.blueButton,children:(0,T.jsx)(a().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function ti(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,i().v3)(),c=(0,i().WS)(),u=(0,s().uB)(void 0,D().A),m=(0,s().K8)((()=>u.state.permissionsInviteStore),[u]),p=(0,s().K8)((()=>u.stage),[u]),g=(0,s().K8)((()=>m.state.modalOpen),[m]),f=(0,s().K8)((()=>(0,O().FI)()),[]),h=(0,s().K8)((()=>t.canAdmin()),[t]),v=(0,s().K8)((()=>{const e=ue().subscriptionDataStoreInstance.state;return Boolean(e&&Gt().Fq(e))}),[]),y=(0,s().K8)((()=>(0,E().Xh)({store:t})),[t]),b=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",minHeight:f?0:52,marginBottom:f?16:void 0},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[f]),x=(0,o.useCallback)(((e,t)=>{e&&t>0&&go().D6({label:(0,T.jsx)(a().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:c?b.requestedUsersToast:void 0})}),[c,b.requestedUsersToast]);return p!==L().d5.closed||c&&!h?null:(0,T.jsx)(gn().A,{mobileFeedback:!0,disabled:!0,style:b.button,children:(0,T.jsxs)("div",{style:b.buttonInner,children:[g&&(0,T.jsx)(Xo().H,{store:t,disabled:!h,membersOnly:y,isSubscribed:v,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:b.modalButton,permissionsInviteStore:m,onInviteComplete:x,analyticsFrom:"mobile_invite"}),(0,T.jsx)(ei,{store:t,onClick:()=>(0,Ot().LH)({environment:d,permissionsInviteStore:m,store:t,isSubscribed:v,renderInShareModal:!1})})]})})}var ni=()=>n(762295),oi=()=>n(772357);function ii(e){const{spaceName:t,domainUrl:n}=e,o=(0,a().tz)();return(0,T.jsx)(oi().l,{tint:"gray",iconGroup:ni().A,label:o.formatMessage(si.label,{spaceName:t}),description:o.formatMessage(si.description,{domain:n}),display:"inline"})}const si=(0,a().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}‘ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});var ri=()=>n(14931),ai=()=>n(736953),li=()=>n(482421),di=()=>n(54882),ci=()=>n(931085),ui=()=>n(782422),mi=()=>n(352723),pi=()=>n(424339),gi=()=>n(550171);const fi=(0,a().YK)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function hi(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,s().K8)((()=>(0,ui()._m)(n)),[n]),d=(0,s().K8)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,s().K8)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,mi().zt)({userId:l.id,store:t}),o=function(e){let{environment:t,calculatedPermission:n,store:o}=e;const i=(0,Me().pp)(o)||Qe().default.state.currentSpaceStore;if(!i)return null;if((0,mt().Ds)(n)){const e=(0,V().RF)({groupId:n.group_id}),t=null==e?void 0:e.name;return t?(0,T.jsxs)(T.Fragment,{children:[(0,di().$)({width:18,marginRight:5}),t]}):null}if((0,mt().eu)(n)){var s;const e=n.team_id||(null===(s=(0,Me().Uo)(o))||void 0===s?void 0:s.id);if(!e)return null;const t=Wt().h4.createChildStore(i,{table:ft().yK,id:e,spaceId:i.id});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(pi().x,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,T.jsx)(gi().i,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,mt().Lg)(n))return(0,mt().Ni)(n)?(0,T.jsx)(a().sA,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(pi().x,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,V().GK)(t,i)]});if((0,mt().W8)(n))return(0,T.jsx)(ci().A,{underline:!0,inline:!0,onClick:()=>{U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish})},children:(0,T.jsx)(a().sA,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:n,calculatedPermission:e,store:t});return{role:e.role,attribution:o}}),[l,t,n]),{userId:m,spaceId:g}=(0,s().K8)((()=>({userId:t.userId,spaceId:t.getSpaceId()})),[t]),f=(0,Ie().P9)({name:"block_read_and_write_role",spaceId:g,userId:m}),h=(0,s().K8)((()=>!!c&&(f&&!(0,mt().p2)(c))),[c,f]);(0,o.useEffect)((()=>{c&&yt().VJ(n,{share_menu_session_id:U().Ay.state.sessionId,role:c})}),[]);const v=(0,r().IS)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:h?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:h?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.text.tertiary},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[h]),[y,b]=(0,o.useState)(!1),[x,S]=(0,o.useState)(!1),M=(0,o.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const o=await He().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0}});"success"===o.type&&o.data.request?(b(!0),yt().T_(n,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:o.data.requestId})):"failed"===o.type&&"UserRateLimitResponse"===(null===(e=o.body)||void 0===e?void 0:e.name)&&S(!0)}),[n,c,t]);if(!(0,mt().PW)(c))return null;const A=function(e){switch(e){case"editor":return fi.fullAccess;case"read_and_write":return fi.editor;case"content_only_editor":return fi.contentEditor;case"comment_only":return fi.commenter;case"reader":return fi.reader;case"none":case"membership_admin":return null;default:(0,z().HB)(e)}}(c);return A?(0,T.jsx)(Tt().A,{delayThreshold:0,renderTooltip:()=>(0,T.jsx)(a().sA,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,T.jsxs)("div",{style:v.container,...e,children:[(0,T.jsxs)("div",{style:v.bannerBodyContainer,children:[(0,T.jsx)(oe().A,{userStore:l,size:20,style:v.icon}),(0,T.jsx)(p().A,{style:v.bannerLabel,isMultiline:!0,children:(0,T.jsx)(a().sA,{...A,values:{hasAttribution:Boolean(u),attribution:(0,T.jsx)("span",{style:v.attribution,children:u})}})})]}),h&&(0,T.jsx)("div",{style:v.requestAccessContainer,children:(0,T.jsx)(gn().A,{style:y||x?v.pendingAccessRequestButton:v.accessRequestButton,onClick:M,disabled:y||x,children:y?(0,T.jsx)(a().sA,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):x?(0,T.jsx)(a().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,T.jsx)(a().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:Vt().W.Left}):null}var vi=()=>n(222787),yi=()=>n(259738),bi=()=>n(55144);function xi(e){const{store:t,permissionItemArgs:n}=e,{showTeamPermission:o,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:s,mostPermissiveAncestorTeamMemberItem:r,mostPermissiveAncestorTeamGuestItem:a,mostPermissiveTrustedDomainItem:l,mostPermissiveSpaceItem:d,pagePermissionUIModel:c,mostPermissivePublicItem:u,showSitePublicPermission:m,showPublicShareLinkPermission:p,showTrustedDomainPermission:g,showRestrictedPermissionBanner:f}=e.calculatedPermissions,h=Number(o)+Number(i)+Number(m);return(0,T.jsxs)(T.Fragment,{children:[m&&u&&(0,T.jsx)(yi().P,{store:t,publicPermissionItem:u,permissionItemArgs:n}),o&&s&&r&&(0,T.jsx)(bi().A,{store:t,blockTeamOwnerPermission:s,blockTeamMemberPermission:r,blockTeamGuestPermission:a,permissionItemArgs:n}),i&&(0,T.jsx)(An().A,{store:t,spacePermission:d,publicPermission:u,showPublicShareLinkPermission:p,trustedDomainPermission:l,showTrustedDomainPermission:g,permissionItemArgs:n,fromPermissionWrapper:"permission_list",isRestricted:f}),(0,T.jsx)(Si,{store:t,pagePermissions:c,numberPermissionsAlreadyRendered:h,permissionItemArgs:n})]})}function Si(e){const t=(0,a().tz)(),n=(0,s().K8)((()=>{const e=Qe().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:o,pagePermissions:i,numberPermissionsAlreadyRendered:r,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p}=i,g=(0,qt().x)(),f=(0,s().K8)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:n}=e,o={};return t.forEach((t=>{o[t.permissionItem.user_id]=(0,T.jsx)(Xt().A,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:n,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),o}({store:o,mostPermissiveUserPermissions:p,permissionItemArgs:l,spaceVisibleUserMap:g}):[];return Io().oE(Object.keys(e).map((n=>{const i=Wt().LU.createChildStore(o,{table:Q().oo,id:n}),s=i.getModel();if(!i.isReady()||s)return{title:(0,ri().c6)(t,s),permissionItem:e[n]}})))}),[c,p,l,o,t,g]),h=function(e){const{store:t,mostPermissiveTeamPermissions:n,permissionItemArgs:o}=e;return n.map((e=>mt().nl(e.permissionItem)?(0,T.jsx)(jn().A,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):mt().un(e.permissionItem)?(0,T.jsx)(wn().A,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,T.jsx)(kn().A,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:o,mostPermissiveTeamPermissions:m,permissionItemArgs:l}),v=(0,s().K8)((()=>{const e=n?function(e){const{spaceId:t,mostPermissiveGroupPermissions:n}=e,o={},i=new Set(ai().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return n.forEach((n=>{const s=n.permissionItem.group_id;i.has(s)&&(o[s]=(0,T.jsx)(Zt().A,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),o}({store:o,spaceId:n,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):{};return Object.entries(e).map((e=>{let[n,o]=e;const i=ai().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n));return{title:i?(0,ln().Pf)({intl:t,groupName:i.group.name}):"",permissionItem:o}}))}),[t,u,l,n,o]),y=[...f,...v];y.sort(((e,t)=>e.title.localeCompare(t.title)));const b=h.concat(y.map((e=>e.permissionItem))),x=b.length;if(0===x)return null;if(x>5-r){const e=Math.max(2-r,0);return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(vi().G0,{}),b.slice(0,e),(0,T.jsx)(li().A,{permissions:b.slice(e,-1)}),b[x-1]]})}return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(vi().G0,{}),b]})}function Mi(e,t){return e.from.table===pt().ev&&e.from.blockId===t.id}const Ai=function(e){const t=(0,i().v3)(),{device:a}=t,{store:l,permissionItemArgs:d,calculatedPermissions:c}=e,{sudoModeStore:u}=d,{permissionItemsCount:m,pagePermissionUIModel:p,showRestrictedPermissionBanner:g}=c,f=(0,s().K8)((()=>{if(!Qe().default.state.currentSpaceStore)return!0;if(l.isTopLevelPrivatePage())return!0;const e=(0,Me().fU)(l);for(const t of e)if((0,n(360482)._p)(t)&&t.isTopLevelPrivatePage())return!0;return!1}),[l]);let h=null;const v=(0,s().K8)((()=>(0,E().Hb)({store:l,showRestrictedPermissionBanner:g})),[l,g]),{canAccessParent:y}=(0,s().K8)((()=>(0,E().iG)({store:l})),[l]),b={...c};if(!v&&y){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:n,mostPermissiveTeamPermissions:o,mostPermissiveUserPermissions:i}=t,[s,r]=Io().jB(n,(t=>Mi(t,e))),[a,l]=Io().jB(o,(t=>Mi(t,e))),[d,c]=Io().jB(i,(t=>Mi(t,e))),u={...t,mostPermissiveGroupPermissions:r,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:a,mostPermissiveUserPermissions:d};return[u,m]}(l,p);b.pagePermissionUIModel=e,h=(0,T.jsx)(Si,{store:l,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:d,showHeader:!0})}const x=(0,s().K8)((()=>!(0,E().Aj)({store:l})),[l]),S=a.isMobile?$e().A.None:$e().A.Y,M=(0,r().IS)((e=>({scroller:{paddingBottom:10,minHeight:a.isMobile||0===m?void 0:1===m?60:90}})),[a,m]);return(0,o.useEffect)((()=>{yt().Fn({environment:t,calculatedPermissions:c})}),[]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(Ge().H,{style:M.scroller,type:S,children:[!f&&(0,T.jsx)(hi,{store:l}),(0,T.jsx)(n(433638).A,{store:l,showRestrictedPermissionBanner:g,showPermissionInheritanceBanner:!1,sudoModeStore:u}),!v&&m>0&&(0,T.jsx)(vi().Ay,{store:l}),(0,T.jsx)(xi,{store:l,calculatedPermissions:b,permissionItemArgs:d}),h,x&&(0,T.jsx)(n(954889).A,{store:l})]}),!a.isMobile&&(0,T.jsx)(j().A,{store:l,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:b,permissionItemArgs:d})]})};function wi(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:a,permissionItemArgs:l,spaceStore:d,spaceUserStore:c,subscriptionDataStore:u}=e,m=(0,i().Y0)(),p=m.isMobile,{spaceId:g,spaceName:f,userId:h,spaceModel:v}=(0,s().K8)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),userId:c.getUserId(),spaceModel:d.getModel()})),[d,c]),y=(0,s().K8)((()=>(0,Me().Uo)(t)),[t]),[b,x]=(0,s().K8)((()=>[null==c?void 0:c.getModel(),null==y?void 0:y.getModel()]),[c,y]),S=(0,s().K8)((()=>U().Ay.state.display),[]),M=(0,s().K8)((()=>(0,O().FI)()),[]),A=function(e,t,n){return(0,r().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:t?n?"80vh":530:540}})),[t,n])}(0,M,(0,Ae().X)("collection_property_permissions")),w=(0,s().uB)(void 0,we().A),k=(0,s().K8)((()=>n.state.flowId),[n]),j=function(e){const t=(0,i().Y0)();return(0,o.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==U().pP.MainShareMenu||U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:U().NL.Notion,emailMessage:""})}),[t,e])}(S),I=(0,Be().K)(u),_=(0,s().K8)((()=>(0,Se().U1)({inviteTargetsStore:a,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:Te({currentMembersAndGuests:I,inviteTarget:e})}))).filter(z().O9)),[a,I]),P=(0,Ce().mF)({space:d,spaceUser:c,team:y,invitees:_.map((e=>e.invitee)).filter(z().O9),store:t}),B=(0,xe().A)(d),R=_.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&B&&(0,he().C7)(e.email,B))),L=(0,Ie()._X)({name:"internal_guests",spaceId:g,userId:h,amount:R.length}),D=(0,Ie().P9)({name:"non_admin_members",spaceId:g,userId:h})?"read_and_write":"editor",N=(0,be().r1)({spaceStore:d}),E=(0,s().K8)((()=>{const e=U().Ay.state,t=e.display===U().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),F=(0,s().K8)((()=>P?_.map((e=>{const{inviteTarget:t,invitee:n}=e,o=null==n?void 0:n.email;let i,s;return"group"===t.type?s={type:"group"}:o?(i=(0,he().CH)(o,B??[]),s=P[o]??{type:"none",reason:"other"}):s={type:"none",reason:"other"},{defaultAddability:s,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[_,P,B]),K=(0,ve().Vi)(L,(()=>{if(!f)return;if(N)return;const e=R[0];if(!e)return;const t=(0,fe().zN)(e.email);return t?(0,T.jsx)(ii,{spaceName:f,domainUrl:t}):void 0})),V=(0,Ae().X)("share_menu_inheritance_banner");return(0,T.jsx)(ye().A,{debugName:"ShareMenuShareTab",capture:!0,onTab:j,children:(0,T.jsxs)("div",{style:A.container,children:[(0,T.jsxs)(Z().Y1,{direction:"vertical",gap:16,padding:M?p?`0 ${Pe().u6}px 0px ${Pe().u6}px`:`0 ${Pe().rL}px 8px ${Pe().rL}px`:"0 14px 8px 14px",children:[m.isMobile?(0,T.jsx)(ti,{store:t,permissionItemArgs:l}):(0,T.jsx)(Zo,{blockStore:t,contextualInviteStore:n,defaultAddabilities:P,internalDomains:B,invites:F,inviteTargetsStore:a,metadata:E,spaceRole:D,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),K]}),S===U().pP.MainShareMenu&&!M&&(0,T.jsx)(Ai,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l}),S===U().pP.MainShareMenu&&M&&(0,T.jsx)(C().default,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l,showPermissionInheritanceBanner:V}),S===U().pP.Invite&&!m.isMobile&&(0,T.jsx)(zn,{store:t,inviteTargetsStore:a,menuListStore:w,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:k}),(0,T.jsx)(je,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,T.jsx)(Ve,{domains:B,spaceId:g,spaceModel:v,userId:h,spaceUserModel:b,teamModel:x,blockStore:t}),whenDisabled:null})]})})}const ki=function(e){const{store:t,sudoModeStore:o}=e,i=(0,s().K8)((()=>o.state.changePermissionsEnabled),[o]),l=(0,s().K8)((()=>o&&o.shouldUserHaveAccessToPrivatePageBlock()&&!o.doesUserAlreadyHaveEditorAccess(t.pointer)&&o.state.privatePageStore),[o,t]),d=(0,r().IS)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:A().Wy.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return l?(0,T.jsxs)("div",{style:d.container,children:[(0,T.jsx)(p().A,{isMultiline:!0,children:(0,T.jsx)(a().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,T.jsx)("b",{children:t})}}})}),(0,T.jsxs)(ee().A,{size:"lg",disabled:i,style:d.button,onClick:()=>{o.setState({...o.state,changePermissionsEnabled:!0})},children:[(0,n(464034).x)(d.icon),i?(0,T.jsx)(a().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,T.jsx)(a().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function ji(e){const t=(0,s().K8)((()=>U().Ay.state.tab),[]);switch(t){case U().QC.Share:return(0,T.jsx)(wi,{...e,blockStore:e.store,subscriptionDataStore:ue().subscriptionDataStoreInstance});case U().QC.Publish:return(0,T.jsx)(ge,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,z().HB)(t)}}function Ci(){const e=(0,i().Y0)(),t=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:A().Wy.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,T.jsxs)("div",{style:t.container,children:[de(t.iconStyle),(0,T.jsx)("div",{style:t.offlineMessageHeadline,children:(0,T.jsx)(p().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(a().sA,{defaultMessage:"You're offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,T.jsx)(p().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(a().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const Ii=function(e){const{store:t,permissionItemArgs:o}=e,a=(0,i().Y0)(),l=(0,s().uB)(e.inviteTargetsStore,ce().Ay),d=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),c=(0,s().O$)(n(802955).e);return(0,T.jsxs)("div",{style:d.container,children:[o.sudoModeStore&&(0,T.jsx)(ki,{store:t,sudoModeStore:o.sudoModeStore}),!a.isMobile&&(0,T.jsx)(me().aR,{inviteTargetsStore:l,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),c?(0,T.jsx)(ji,{inviteTargetsStore:l,...e}):(0,T.jsx)(Ci,{})]})};function Ti(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:l,location:d}=e,A=(0,i().v3)(),w=(0,i().Y0)();(0,y().fJ)(R().Ns.publishSite),(0,y().fJ)(R().Ns.publishedSiteSettings);const k=(0,s().uB)(e.universalMemberInviteStore,D().A),C=(0,s().K8)((()=>k.state.contextualInviteStore),[k]),I=(0,N().H)(),P=(0,b().r)(),F=(0,x().HI)(),K=(0,s().K8)((()=>(0,O().FI)()),[]),V=(0,s().K8)((()=>E().dR({store:t,environment:A,trustedDomainsStore:I})),[A,t,I]),z=(0,s().K8)((()=>C.state.inviteStage),[C]),W=(0,s().K8)((()=>U().Ay.state.tab),[]),H=(0,r().IS)((e=>({title:{fontSize:K?16:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:K&&w.isMobile?e.surface.page:void 0}})),[w.isMobile,K]),G=(0,o.useMemo)((()=>({onUpgradeButtonClick:l,sudoModeStore:n,location:d})),[l,n,d]),Y=(0,s().K8)((()=>S().default.isVisible(M().n)),[]),q=(0,s().K8)((()=>(0,B().g)()),[]);if(!P)return q?(0,T.jsx)(_,{calculatedPermissions:V,store:t,permissionItemArgs:G,onClose:e.onClose}):null;if(!(w.isMobile||z!==L().d5.share_workspace&&z!==L().d5.request_workspace||Y))return(0,T.jsx)(ae,{blockStore:t,spaceStore:P,contextualInviteStore:C});const $=w.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:K?(0,T.jsx)(p().A,{isMobile:w.isMobile,style:H.title,children:(0,T.jsx)(a().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}):(0,T.jsx)(p().A,{isMobile:w.isMobile,style:H.title,children:(0,T.jsx)(a().sA,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,T.jsx)(me().zM,{mostPermissivePublicItem:V.mostPermissivePublicItem}),left:(0,T.jsx)(g().A,{href:(0,v().xS)("guides.sharing"),analyticsFrom:"sharing"}),footer:W===U().QC.Share&&(0,T.jsx)(j().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:V,permissionItemArgs:G}),topbarStyle:H.topbarStyle,right:(0,T.jsx)(m().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return F?(0,T.jsx)(u().A,{...$,className:f().NXe,children:(0,T.jsx)(c().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(_i,{store:t,spaceStore:P,spaceUserStore:F,permissionItemArgs:G,calculatedPermissions:V,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:C})})}):null}function _i(e){let{store:t,spaceStore:n,spaceUserStore:s,permissionItemArgs:r,calculatedPermissions:a,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:m}=e;const p=(0,i().v3)();return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:p}),d().clear({preventDismissMobileKeyboard:!0,environment:p})}),[p]),(0,T.jsx)(Ii,{store:t,spaceStore:n,spaceUserStore:s,permissionItemArgs:r,calculatedPermissions:a,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:m})}},21209:(e,t,n)=>{n.d(t,{$:()=>l});n(725707),n(491955),n(403517);var o=()=>n(237385),i=()=>n(803290),s=()=>n(294997),r=()=>n(736953),a=()=>n(979537);function l(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>{if(!e.isDefined())return[];return(0,s().ri)({rawMembers:e.getRawMembership(),groupsInSpace:r().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((n=>a()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(n.getGroupId())))}),[t,e])}},35630:(e,t,n)=>{n.d(t,{$:()=>M,b:()=>A});n(725707),n(244387),n(242343);var o=()=>n(16791),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(950635),l=()=>n(846581),d=()=>n(653998),c=()=>n(225679),u=()=>n(654548),m=()=>n(477784),p=()=>n(622286),g=()=>n(907721),f=()=>n(73758),h=()=>n(932322),v=()=>n(88271),y=()=>n(103151),b=()=>n(35462),x=()=>n(594184),S=n(163643);function M(e){let{isPageMoreButton:t,hideTopBorder:n,store:o,wordCountStores:l,showWordCount:c}=e;const u=(0,s().K8)((()=>A(o)),[o]),{device:p}=(0,i().v3)(),M=(0,s().K8)((()=>p.isPhone),[p]),k=m().A.getIntl(),j=(0,r().IS)((()=>({menuItem:{paddingTop:M?8:n?0:6,paddingBottom:M?8:16}})),[n,M]);return u&&!u.canAccess?null:(0,S.jsx)(v().A,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,S.jsx)(h().Ay,{style:u?void 0:j.menuItem,shouldWrapTitle:!0,title:u?(0,S.jsx)(y().A,{placement:g().W.Right,render:e=>(0,S.jsxs)("div",{...e,children:[c&&(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,S.jsx)(d().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,S.jsx)(x().A,{store:o})}})}),l&&(0,S.jsx)(w,{stores:l}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,a().lR)(k,u.lastEditedBy):void 0}})}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,style:{marginBottom:c?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,S.jsx)(f().A,{store:o,compactFormat:!0})}):void 0,loading:!u})})}function A(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),s=e.getLastEditedTime(),r=m().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&s&&i){const a=(0,c().vt)({parentStore:e,pointer:t}),d=(0,l().jE)(n,o().locale,r),u=(0,c().vt)({parentStore:e,pointer:i}),m=(0,l().jE)(s,o().locale,r);if(!u)return;return{canAccess:!0,createdBy:a,createdTime:d,lastEditedBy:u,lastEditedTime:m}}}function w(e){const{stores:t}=e,n=(0,p().X)("selectable_word_count"),o=(0,s().K8)((()=>n?k(t):0),[n,t]);return n?(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:o}})}):null}function k(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+k(t.getContentStores())}),0)}},36178:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(242343),i=()=>n(653998),s=n(163643);const r=(0,i().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const a=function(e){const{teamStore:t,teamName:a,teamId:l,isModalOpen:d,onDismiss:c}=e,[u,m]=(0,o.useState)(""),p=(0,n(237385).v3)(),g=(0,i().tz)(),f=async()=>{await n(465235).Ip({environment:p,teamId:l,message:u}),c()},h=(0,n(174114).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,s.jsx)(n(922172).a,{open:d,onDismiss:c,innerStyle:h.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:h.requestTitle,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:a,icon:(0,s.jsx)(n(424339).x,{style:h.icon,store:t,disabled:!0,size:22})}})}),(0,s.jsx)(n(59175).A,{textarea:!0,style:h.input,value:u,onChange:e=>{m(e.target.value)},placeholder:g.formatMessage(r.message_placeholder)}),(0,s.jsxs)("div",{style:h.footer,children:[(0,s.jsx)(n(35462).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,s.jsx)(n(951540).A,{size:"lg",style:h.requestInvitesButton,onClick:f,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},38597:(e,t,n)=>{n.r(t),n.d(t,{TeamJoinLeaveButton:()=>y});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(31448),l=()=>n(548694),d=()=>n(904697),c=()=>n(259539),u=()=>n(105018),m=()=>n(653998),p=()=>n(209684),g=n(163643);const f=function(e){const{teamStore:t,from:r,navigateToTeamHomeOnJoin:a,style:l,hoveredStyle:d,icon:c,isRed:u}=e,f=(0,i().v3)(),h=(0,s().O$)(n(485966).AppStoreCurrentSpaceStore),v=(0,o.useCallback)((async()=>{h&&await n(628854).e2({environment:f,teamStore:t,currentSpaceStore:h,from:r,andNavigateToTeamHome:a??!1})}),[h,f,t,r,a]);return(0,g.jsx)(p().p,{style:l,hoveredStyle:d,onClick:v,icon:c,isRed:u,children:(0,g.jsx)(m().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var h=()=>n(872131);const v=function(e){const{teamStore:t,style:i,hoveredStyle:r}=e,[a,l]=(0,o.useState)(!1),d=(0,s().K8)((()=>t.getName()),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(p().p,{style:i,hoveredStyle:r,onClick:()=>l(!0),children:(0,g.jsx)(m().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,g.jsx)(n(36178).A,{teamStore:t,teamName:d,teamId:t.id,isModalOpen:a,onDismiss:()=>l(!1)})]})};function y(e){const{teamStore:t,style:n,hoveredStyle:o}=e,m=(0,i().v3)(),p=(0,c().Q)(),y=(0,u().G)(t),b=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]),x=(0,r().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:a().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...n},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...o}})),[n,o]),S=(0,s().K8)((()=>(0,d().isUnownedTeam)({membership:t.getRawMembership()})&&(0,l().s7)(m)),[m,t]),M=!y&&"open"===b||S,A=!y&&"closed"===b;return p?null:y?(0,g.jsx)(h().A,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):M?(0,g.jsx)(f,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):A?(0,g.jsx)(v,{teamStore:t,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):null}},40473:(e,t,n)=>{n.d(t,{A:()=>M});n(403517);var o=n(242343),i=()=>n(16791),s=()=>n(803290),r=()=>n(174114),a=()=>n(81322),l=()=>n(31448),d=()=>n(622163),c=()=>n(967454),u=()=>n(501578),m=()=>n(204024),p=()=>n(126451),g=()=>n(286404),f=()=>n(951540),h=()=>n(35462),v=n(163643);const y=20;function b(e){var t;let{icon:a,iconStyle:u,title:m,subtitle:p,confirmText:b,confirmTextStyle:M="blue",confirmTextPerRadioOption:A,cancelText:w,radioOptions:k,defaultSelectedRadioOption:j,onDismiss:C,onSelectRadio:I,onConfirm:T,width:_,footer:P}=e;const B=(0,n(237385).v3)(),[R,L]=(0,o.useState)(j??(null===(t=k[0])||void 0===t?void 0:t.key)),D=(0,s().uB)(void 0,n(580257).A),N=(0,s().K8)((()=>null==D?void 0:D.state.elementRef),[D]),O=(0,c().CR)(N),E=(0,c().yE)(N),U=(0,c().o7)(N),F=E>0,K=Math.ceil(E+U)<Math.floor(O),V=(0,o.useCallback)((e=>{e!==R&&(L(e),null==I||I(e))}),[I,R]),z=(0,o.useCallback)((()=>{T(R)}),[T,R]),W=(0,r().IS)((e=>{const t={marginLeft:-20,marginRight:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${_??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:y,borderRadius:6,alignItems:"stretch"},icon:{width:36,height:36,fill:e.icon.secondary,marginBottom:6,...u},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:l().vc(i().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:l().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:l().vc(i().locale).sans,fontSize:(0,d().ny)(B,"UIRegular"),lineHeight:(0,d().ks)(B,"UIRegular"),fontWeight:l().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...t,opacity:F?1:0},bottomDivider:{...t,opacity:K?1:0},scroller:{marginLeft:-20,marginRight:-20,paddingLeft:y,paddingRight:y},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,right:10,zIndex:1}}}),[B,u,K,F,_]),H=(null==A?void 0:A[R])??b;return(0,v.jsxs)("div",{style:W.container,children:[(0,v.jsx)("div",{style:W.dismissButton,children:(0,v.jsx)(x,{onClick:C})}),a&&(0,v.jsx)("div",{style:W.iconContainer,children:a(W.icon)}),(0,v.jsx)(h().A,{isMultiline:!0,style:W.title,children:m}),p&&(0,v.jsx)(h().A,{isSmall:!0,style:W.subtitle,isMultiline:!0,children:p}),k.length>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:W.topDivider}),(0,v.jsx)(n(142708).H,{type:n(98508).A.Y,style:W.scroller,store:D,children:(0,v.jsx)("div",{style:W.radioContainer,children:k.map((e=>(0,v.jsx)(S,{radioItem:e,isSelected:e.key===R,onSelectRadio:V},e.key)))})}),(0,v.jsx)("div",{style:W.bottomDivider})]}),(0,v.jsxs)("div",{style:W.actionButtonsContainer,children:["blue"===M?(0,v.jsx)(f().A,{size:"lg",onClick:z,children:H}):"red"===M?(0,v.jsx)(f().A,{size:"lg",onClick:z,isRed:!0,children:H}):(0,v.jsx)(g().A,{size:"lg",onClick:z,children:H}),(0,v.jsx)(g().A,{size:"lg",onClick:C,style:W.cancelButton,children:w??(0,v.jsx)(n(653998).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),P]})}function x(e){let{onClick:t}=e;const n=(0,r().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,v.jsx)(p().A,{style:n.button,hoveredStyle:n.buttonHovered,pressedStyle:n.buttonPressed,onClick:t,children:(0,a().V)(n.closeIcon)})}function S(e){let{radioItem:t,isSelected:n,onSelectRadio:o}=e;const i=(0,r().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14-m().p,border:void 0,boxShadow:n?`inset 0 0 0 1px ${e.icon.uiBluePrimary}`:`inset 0 0 0 1px ${e.stroke.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...l().RC},optionTitle:{fontWeight:l().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"}})),[n]);return(0,v.jsxs)(g().A,{size:"lg",onClick:()=>o(t.key),style:i.button,children:[(0,v.jsxs)("div",{style:i.buttonText,children:[(0,v.jsx)(h().A,{style:i.optionTitle,children:(0,v.jsx)(u().j,{children:t.title})}),t.subtitle&&(0,v.jsx)(h().A,{isSmall:!0,isMultiline:!0,style:i.optionSubtitle,children:t.subtitle})]}),(0,v.jsx)(m().A,{isSelected:n})]})}const M=o.memo(b)},50408:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>w});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(81322),l=()=>n(378809),d=()=>n(653998),c=()=>n(336400),u=()=>n(658388),m=()=>n(354148),p=()=>n(637269),g=()=>n(129978),f=()=>n(370557),h=()=>n(907721),v=()=>n(485966),y=()=>n(216273),b=()=>n(126451),x=()=>n(822493),S=n(163643);const M=(0,d().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function A(e){let{store:t,isVisible:n,compact:u,framerMotion:m}=e;const g=(0,i().v3)(),h=(0,d().tz)(),v=(0,s().O$)(y().b),x=(0,s().K8)((()=>f().Ay.state.expanded),[]),A=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:0,height:28,background:e.accentColors.uiBlue[100],...(0,p().g)({noDrag:g.device.isElectron&&!v})},hoveredButton:{background:e.accentColors.uiBlue[200]},pressedButton:{background:e.accentColors.uiBlue[300]},suggestionIcon:{height:18,width:18,marginLeft:9,marginRight:7},text:{fontSize:14,lineHeight:1.428,marginRight:7},closeIcon:{height:14,width:14,fill:e.text.uiBlueSecondary,marginRight:9}})),[g.device.isElectron,v]),w=(0,o.useCallback)((()=>{c().PD({environment:g,navigableBlockStore:t,mode:"default",location:"stop_suggest_pill"})}),[g,t]),j=(0,o.useRef)(null),{AnimatePresence:C,motion:I}=m;return(0,S.jsx)(C,{children:n&&(0,S.jsxs)(I.div,{ref:j,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,S.jsxs)(b().A,{style:A.button,hoveredStyle:A.hoveredButton,pressedStyle:A.pressedButton,onClick:w,ariaLabel:h.formatMessage(M.stopSuggestRole),children:[(0,l().A)(A.suggestionIcon),(0,S.jsx)(C,{initial:x,children:!u&&!x&&(0,S.jsx)(I.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:A.text,children:(0,S.jsx)(d().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,a().V)(A.closeIcon)]},"button"),!u&&!x&&(0,S.jsx)(k,{store:t,origin:j})]})})}function w(e){const{value:t}=(0,g().fJ)(m().fM);return t?(0,S.jsx)(A,{...e,framerMotion:t}):null}function k(e){const{store:t,origin:n}=e,r=(0,d().tz)(),a=(0,i().v3)(),l=(0,s().K8)((()=>t.isCommentOnly()),[t]),c=(0,s().K8)((()=>{var e;return null===(e=v().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),m=l||!c,[p,g]=(0,o.useState)(m);return p?(0,S.jsx)(x().k,{origin:n,alignmentToOrigin:h().C.Center,placementToOrigin:"bottom",header:(0,S.jsx)(S.Fragment,{children:r.formatMessage(M.tooltip)}),content:l?r.formatMessage(M.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),u().eO({environment:a,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},77251:(e,t,n)=>{n.d(t,{W:()=>o});const o=n(129044).default.createValue(!1,{name:"AiPageTranslationCalloutStore"})},79040:(e,t,n)=>{n.d(t,{_:()=>r});var o=()=>n(477784);const i=(0,n(653998).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"}});function s(e){const{environment:t,store:o,viewType:i}=e;n(84543).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(267439).c)({environment:t,store:o,viewType:i,transaction:e}),n(191756).uK({environment:t,store:o,pageVisitSource:n(712437).y8.LinkInPage});const s=o.getCollectionViewStores()[0];s&&(0,n(934807).F)(s.id,{viewType:i})}})}const r=[{name:o().A.formatMessage(i.table),type:"table",iconFn:n(120844).T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"table"})},{name:o().A.formatMessage(i.board),type:"board",iconFn:n(923e3).q,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"board"})},{name:o().A.formatMessage(i.list),type:"list",iconFn:n(899498).n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"list"})},{name:o().A.formatMessage(i.timeline),type:"timeline",iconFn:n(679637).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"timeline"})},{name:o().A.formatMessage(i.calendar),type:"calendar",iconFn:n(348588).D,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"calendar"})},{name:o().A.formatMessage(i.gallery),type:"gallery",iconFn:n(598758).p,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"gallery"})}]},82276:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(34662),a=()=>n(975392),l=()=>n(890256),d=()=>n(836331),c=()=>n(205670);function u(e){const{store:t}=e;return function(e){const t=(0,i().v3)(),[n,u]=(0,o.useState)("uninitialized"),[m,p,g,f,h]=(0,s().K8)((()=>{var n,o;return e.pathIsDead()||"on"!==d().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),r().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(o=e.getCover())||void 0===o?void 0:o.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,o.useEffect)((()=>{"storeReady"===n?u("generateImage"):m&&u("storeReady")}),[m,p,g,f,h]);const v=(0,o.useMemo)((()=>(0,a().sg)((()=>{u("storeReady"),l().F({environment:t,store:e})}),5e3)),[t,e]);(0,s().K8)((()=>{"generateImage"===n&&(c().default.state,v())}),[n,v])}(t),null}},88143:(e,t,n)=>{n.d(t,{A:()=>l});n(242343);var o=()=>n(975392),i=()=>n(791497),s=()=>n(907721),r=()=>n(466321),a=n(163643);const l=function(){const{isMobile:e,isTablet:t}=(0,n(237385).Y0)(),i=(0,n(803290).O$)(n(862142).A),l=(0,n(622286).X)("mobile_icon_picker_bottom_sheet");return(0,a.jsx)(n(443252).Ay,{popupType:e?l?r().n.BottomSheet:r().n.SlideUp:r().n.Popup,bottomSheetInitialState:t?"full":"half",open:i.isActive,originRect:i.isActive?i.originRect:void 0,originGap:i.isActive?i.originGap:void 0,placementToOrigin:s().W.Bottom,alignmentToOrigin:s().C.Center,preventScaleTransition:!0,onDismiss:d,render:()=>{if(i.isActive)return(0,a.jsx)(n(655830).A,{debugName:"MediaMenu",capture:!0,onUp:o().D_,onDown:o().D_,children:(0,a.jsx)(n(722793).Ay,{...i,onCancel:d})})},trapFocus:!0})};function d(){i().I()}},94163:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const i=new o},96144:(e,t,n)=>{n.d(t,{R:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("verificationCheck",{viewBox:"0 0 6 7",svg:(0,o.jsx)("path",{d:"M2.84245 6.11619C2.71116 6.30644 2.53392 6.40156 2.31072 6.40156C2.20131 6.40156 2.10066 6.37881 2.00875 6.33332C1.92123 6.28782 1.83589 6.21545 1.75274 6.11619L0.150985 4.25515C0.0503282 4.12694 0 3.99874 0 3.87053C0 3.73406 0.04814 3.61826 0.14442 3.52314C0.245077 3.42388 0.365427 3.37425 0.50547 3.37425C0.597374 3.37425 0.680525 3.39286 0.754923 3.43008C0.833698 3.46317 0.912473 3.52934 0.991247 3.6286L2.28446 5.21049L5.00875 1.07896C5.13129 0.892857 5.28446 0.799805 5.46827 0.799805C5.60394 0.799805 5.72648 0.841161 5.83589 0.923874C5.9453 1.00659 6 1.11618 6 1.25266C6 1.32297 5.98249 1.39327 5.94748 1.46358C5.91685 1.52975 5.88184 1.59178 5.84245 1.64968L2.84245 6.11619Z"})})},105018:(e,t,n)=>{n.d(t,{G:()=>r});var o=()=>n(237385),i=()=>n(803290),s=()=>n(979537);function r(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,s()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},105429:(e,t,n)=>{n.d(t,{m:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{type:"uninitialized"}}isWriting(){return"filling"===this.state.type&&!this.state.haveAllBlocksCompletedAutofill&&!this.state.didInterruptStreaming}setIsWriting(e){var t;const{propertySchema:o,stores:i,sessionIdForAnalytics:s}=e,r=i[0].getAssociatedCollectionId()??(null===(t=i[0].getCollectionStore())||void 0===t?void 0:t.id),a=s||n(214144).JW();return this.setState({type:"filling",propertySchema:o,collectionId:r,numBlocksToAutofill:i.length,numBlocksAutofilled:0,sessionId:a,didInterruptStreaming:!1,haveAllBlocksCompletedAutofill:!1}),a}}const i=new o},112224:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>a});n(242343);var o=()=>n(779648),i=()=>n(584604),s=()=>n(982517),r=n(163643);function a(e){return(0,r.jsx)(i().L,{...e,iconGroup:o().F,children:(0,r.jsx)(s().g,{})})}},120332:(e,t,n)=>{n.d(t,{m:()=>s});var o=()=>n(803290),i=()=>n(4822);function s(){return(0,o().K8)((()=>(0,i().VR)()),[])}},153258:(e,t,n)=>{n.d(t,{b:()=>r});var o=()=>n(876695),i=()=>n(137476);var s=()=>n(545313);function r(e){const{environment:t,collectionContextStore:n,view_type:r,view_config_uri:a,from:l,...d}=e;!function(e,t){i().vd(e,"create_view",t)}(t,{...(0,o().sl)(n)||{},...d,view_type:r,view_config_uri:a,from:l}),(0,s().f)({collectionContextStore:n,action:"create_view",from:l,property_type:void 0})}},159671:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>E});n(725707),n(491955),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(599932),l=()=>n(162901),d=()=>n(653998),c=()=>n(235843),u=()=>n(935091),m=()=>n(54852),p=()=>n(783e3),g=()=>n(797715),f=()=>n(307542),h=()=>n(640979),v=()=>n(861095),y=()=>n(904697),b=()=>n(485966),x=()=>n(714604),S=()=>n(734225),M=()=>n(104838),A=()=>n(198654),w=()=>n(975392),k=()=>n(209684),j=()=>n(535906),C=()=>n(273520),I=()=>n(858023),T=()=>n(88271),_=()=>n(103151),P=()=>n(907721),B=()=>n(755769),R=()=>n(282319),L=()=>n(935449),D=n(163643);function N(e){const{selectedRole:t,allRoles:n,onChange:o,store:a,labelStyle:l}=e,{device:c}=(0,i().v3)(),m=(0,r().DP)(),p=(0,L().R)(a),g=(0,s().K8)((()=>{const{currentSpaceStore:e}=b().default.state;return null==e?void 0:e.canEditMembership()}),[]),f=(0,s().K8)((()=>a.isDefault()),[a]);return(0,D.jsx)(C().Ay,{popupType:c.isMobile?C().z7.SlideUp:C().z7.Popup,renderOrigin:e=>(0,D.jsxs)(k().p,{style:l,...e,children:[(0,D.jsx)(d().sA,{...y().ROLE_MESSAGE_MAP[t].label}),(0,A().b)({width:10,marginLeft:4,fill:m.lightIconColor})]}),placementToOrigin:B().UV.Bottom,render:e=>{const i=[{key:"roles",render:e=>(0,D.jsx)(T().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:i,disabledReason:s}=(0,R().m)({role:n,isCurrentUserTeamOwner:Boolean(p),userIsSpaceAdmin:Boolean(g),isDefaultTeam:f}),r={key:n,render:e=>(0,D.jsx)(_().A,{disableTooltip:!i,placement:P().W.Right,textWrap:!0,renderTooltip:()=>s,render:o=>(0,D.jsx)("span",{...o,children:(0,D.jsx)(j().A,{...e,isChecked:w().n4(n,t),disabled:i,disabledFeedback:i,title:(0,D.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,D.jsx)(d().sA,{...y().ROLE_MESSAGE_MAP[n].label})}),caption:(0,D.jsx)("span",{style:{color:m.text.secondary},children:(0,D.jsx)(d().sA,{...y().ROLE_MESSAGE_MAP[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{o(n),e.close()}};return r}))}];let s;return s=c.isMobile?{menuType:h().gu.Modal,title:(0,D.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,D.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:h().gu.Popup,width:264},(0,D.jsx)(u().A,{...s,children:(0,D.jsx)(I().Ay,{type:I().Oh.Vertical,initialFocus:void 0,sections:i})})}})}const O="member";function E(e){const{store:t,onEmptySubmit:n}=e,o=(0,i().v3)();(0,l().Yb)((async()=>{await M().x(o)}),[]);const a=(0,s().uB)(e.permissionsInviteStore,S().A),d=(0,s().K8)((()=>Boolean(a.state.isFocused)),[a]),c=(0,s().K8)((()=>a.state.tokenQuery),[a]),p=(0,s().K8)((()=>d&&c.length>0),[d,c]),g=(0,r().IS)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){a.setState({...a.state,isFocused:e})}return(0,D.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,D.jsx)(u().A,{menuType:h().gu.Popup,header:(0,D.jsx)(U,{store:t,permissionsInviteStore:a,setFocus:f,onEmptySubmit:n}),scrollerStyle:g.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:p&&(0,D.jsx)("div",{style:g.permissionsInviteSearchRequest,children:(0,D.jsx)(m().A,{permissionsInviteStore:a,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}function U(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:l,setFocus:u}=e,m=(0,d().tz)(),f=(0,i().v3)(),h=(0,o.useRef)(null),y=(0,s().K8)((()=>Boolean(n.state.isFocused)),[n]),b=(0,s().K8)((()=>n.state.tokenQuery),[n]),S=(0,s().K8)((()=>n.state.inviteRole),[n]),M=(0,s().K8)((()=>n.state.inviteTargets),[n]),A=(0,r().IS)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:y?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[y]);function w(e){if(n.state.isInviteTargetsEmpty)return;const t=n.state.inviteTargets.filter((t=>t!==e));0===M.length?n.setState({...n.state,inviteTargets:[],inviteRole:O,isInviteTargetsEmpty:!0}):n.setState({...n.state,inviteTargets:t})}const k=M.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,D.jsx)(p().A,{target:e,onClickRemove:w,role:S,shouldWrap:!0,style:A.inputTokenVerticalMargin,backgroundColor:(0,v().qv)(e)},t)}));return(0,D.jsx)(g().Ay,{ref:h,focus:y,onClick:()=>u(!0),format:g().le.Share,value:b,onChange:async e=>{await async function(e){const{environment:t,permissionsInviteStore:n,event:o,setFocus:i,inputRef:s}=e;if(!n.state.isInviteTargetsEmpty&&(0,x().qs)(n.state))return;const r=o.target.value,{extractedEmails:l,newInputValue:d}=(0,a().Ct)(r),u=await c().Ah(t,l),m=u.filter((e=>!(0,v().mQ)({target:e,permissionsInviteStore:n}))),p=[...n.state.inviteTargets,...m];if(p.length>0){if(n.setState({...n.state,inviteTargets:p,isInviteTargetsEmpty:!1,tokenQuery:d}),!d){const e=s.current;e&&(e.value="")}i(!(m.length>0))}else n.setState({...n.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:d})}({environment:f,event:e,permissionsInviteStore:n,setFocus:u,inputRef:h})},onEmptySubmit:l,type:"email",placeholder:m.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:k,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=O),n.setState(e)},focusAfterAnimation:!0,right:(0,D.jsx)(F,{store:t,permissionsInviteStore:n}),style:A.tokenMenuItem,inputStyle:A.inputTokenVerticalMargin,inputDivStyle:A.inputDiv,inputFullWidth:!0})}function F(e){const{store:t,permissionsInviteStore:n}=e,o=(0,s().K8)((()=>{const e=b().default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,f().Qd)()}),[]),i=(0,s().K8)((()=>n.state.inviteRole),[n]),a=(0,r().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return o?(0,D.jsx)(N,{store:t,selectedRole:i,allRoles:y().TeamRolesWithGuest,onChange:l,labelStyle:a.teamRoleLabel}):(0,D.jsx)(N,{store:t,selectedRole:i,allRoles:y().TeamRoles,onChange:l,labelStyle:a.teamRoleLabel})}},183409:(e,t,n)=>{n.d(t,{HX:()=>s,Hi:()=>i().Hi,lR:()=>r});var o=()=>n(406073),i=()=>n(164474);function s(){o().A.setState({open:!0,submitted:!1,error:void 0})}function r(){o().A.setState({open:!1})}},202193:(e,t,n)=>{n.d(t,{Qo:()=>a,hu:()=>l,k9:()=>s,nE:()=>r});var o=()=>n(555919),i=()=>n(654548);const s=(0,n(653998).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"database.source.titlePlaceholder"},newTitlePlaceholder:{defaultMessage:"New database",id:"database.source.newTitlePlaceholder"},actionsButtonAriaLabel:{defaultMessage:"Collection actions",id:"database.source.actionsButtonAriaLabel"}});function r(e){let{intl:t,isDBUXChromeEnabled:n,isWorkflowsAppContainerEnabled:o,collectionStore:i}=e;var r;return o?t.formatMessage(n?s.newTitlePlaceholder:s.titlePlaceholder):(null==i||null===(r=i.getModel())||void 0===r?void 0:r.getEmptyTitlePlaceholder({intl:t,isWorkflowsAppContainerEnabled:o}))||t.formatMessage(s.titlePlaceholder)}function a(e){let{collectionStore:t,intl:n,isDBUXChromeEnabled:o,isWorkflowsAppContainerEnabled:i}=e;return t.getName()??[[r({intl:n,isDBUXChromeEnabled:o,isWorkflowsAppContainerEnabled:i,collectionStore:t})]]}function l(e){let{collectionStore:t,intl:n,isDBUXChromeEnabled:s,isWorkflowsAppContainerEnabled:a}=e;return null!=t&&t.isDefined()?(0,i().r4)(t.getName(),t)||r({intl:n,isDBUXChromeEnabled:s,isWorkflowsAppContainerEnabled:a,collectionStore:t}):(0,o().L)(n)}},202900:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(725707),n(229032);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(284594),l=()=>n(758611),d=()=>n(653998),c=()=>n(220413),u=()=>n(31448),m=()=>n(818369),p=()=>n(782422),g=()=>n(330358),f=()=>n(945857),h=()=>n(59175),v=()=>n(951540),y=()=>n(611824),b=n(163643);const x={padding:"24px 36px 24px",minWidth:300,maxWidth:400},S=n(129044).default.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,s().K8)((()=>f().A.state.open),[]);return(0,b.jsx)(n(922172).a,{open:e,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(I,{}),onDismiss:w})};function A(){const e=(0,r().DP)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.text.tertiary,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,a().$)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(y().A,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function w(){f().A.setState({open:!1})}function k(){w(),g().A.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function j(){const e=(0,r().DP)(),t=(0,i().v3)(),n=(0,s().K8)((()=>(0,p()._m)(t)),[t]),o=(0,s().K8)((()=>null==n?void 0:n.getEmail()),[n]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:u().Wy.medium,marginTop:0},children:o}),(0,b.jsx)("div",{style:{color:e.text.secondary,marginTop:4},children:(0,b.jsx)(d().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(v().A,{style:{marginTop:12},onClick:k,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function C(){const e=(0,d().tz)(),t=(0,r().DP)(),n=(0,i().v3)(),a=(0,s().uB)(void 0,S),[l,u]=(0,o.useState)(""),p=(0,o.useCallback)((()=>async function(e,t,n,o){if(n){const i=await m().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==i.type&&i.data.promo?f().A.state.open&&(await f().A.state.handlePromoCode(n),w()):o.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,l,a)),[n,e,l,a]),g=(0,o.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,u,a)),[u,a]),y=(0,s().O$)(a),x=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(h().A,{style:{marginRight:8,height:32},value:l,onChange:g,onSubmit:p,placeholder:x}),(0,b.jsx)(v().A,{onClick:p,disabled:!l,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:c().Ay.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:y})]})]})}function I(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:o.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(y().A,{external:!0,href:l().eR.pricing,children:e})}})}),(0,b.jsx)(j,{}),(0,b.jsx)(C,{}),(0,b.jsx)(A,{})]})}},203716:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>v});n(242343);var o=()=>n(237385),i=()=>n(803290),s=()=>n(174114),r=()=>n(386311),a=()=>n(653998),l=()=>n(31448),d=()=>n(286404),c=()=>n(951540),u=()=>n(754313),m=()=>n(610271),p=()=>n(127776),g=()=>n(810733),f=()=>n(732566),h=n(163643);function v(){const e=(0,o().v3)(),t=(0,a().tz)(),n=(0,s().IS)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},title:{marginTop:16,marginBottom:12,color:e.text.primary,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),v=(0,i().K8)((()=>g().A.state.open),[]);return(0,h.jsx)(u().A,{onDismiss:()=>{g().A.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:n.modal,children:(0,h.jsxs)(m().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,r().I)(n.loopIcon),(0,h.jsx)("div",{style:n.title,children:(0,h.jsx)(a().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:n.description,children:(0,h.jsx)(a().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c().A,{size:"lg",style:n.confirmButton,onClick:()=>{if(g().A.state.open){const{pageStore:n,flowId:o}=g().A.state;p().v4({environment:e,intl:t,page:n,flowId:o}),g().A.setState({open:!1})}},children:(0,h.jsx)(a().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d().A,{size:"lg",style:n.cancelButton,onClick:()=>g().A.setState({open:!1}),children:(0,h.jsx)(a().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(f().A,{message:(0,h.jsx)(a().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:v})}},209718:(e,t,n)=>{n.d(t,{H:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("settingsUpgradeFilled",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M10 19c4.935 0 9.009-4.073 9.009-9 0-4.926-4.082-9-9.018-9C5.065 1 1 5.074 1 10c0 4.927 4.074 9 9 9zm0-4.422c-.47 0-.818-.33-.818-.8v-4.23l.087-1.863-.81 1.01-1 1.053a.762.762 0 01-.558.235c-.435 0-.757-.314-.757-.74 0-.218.07-.392.218-.549l2.994-3.029c.2-.217.4-.313.644-.313.261 0 .461.104.662.313l2.976 3.03a.73.73 0 01.227.548c0 .426-.322.74-.758.74a.73.73 0 01-.557-.235l-.992-1.045-.818-1.027.087 1.871v4.23c0 .47-.348.801-.827.801z"})})},210290:(e,t,n)=>{n.d(t,{S:()=>d,q:()=>l});n(725707),n(500234);var o=()=>n(236339),i=()=>n(865226),s=()=>n(302376),r=()=>n(29869),a=()=>n(314164);function l(e){const{environment:t,collectionContextStore:n,event:r,buttonPopupParent:l}=e,d=(0,a().t2)(n);if(!d)return null;const c=s().Vr(r);i().oo({environment:t,url:d,openInNew:c}),c||null==l||l.close(),(0,o().X)({environment:t,collectionContextStore:n,action:"click_source_view"})}function d(e){var t;let{environment:n,collectionStore:o,pageVisitSource:a,event:l}=e;const d=o.getParentBlockStore();if(!d)return;const c=null===(t=d.getCollectionViewStores())||void 0===t?void 0:t.find((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),u=(0,r().J8)({store:d,fullyQualified:!1,pageVisitSource:a,collectionViewId:null==c?void 0:c.id});i().oo({environment:n,url:u,openInNew:s().Vr(l)})}},232780:(e,t,n)=>{n.r(t),n.d(t,{CloseTemplatesPopupComponent:()=>ve,default:()=>ae});var o=()=>n(353420),i=n(242343),s=()=>n(237385),r=()=>n(803290),a=()=>n(174114),l=()=>n(360044),d=()=>n(377963),c=()=>n(169201),u=()=>n(653998),m=()=>n(577860),p=()=>n(31448),g=()=>n(90290),f=()=>n(145046),h=()=>n(649334),v=()=>n(575015),y=()=>n(578269),b=()=>n(494217),x=()=>n(604633);function S(){return"web-mobile"===(0,s().Y0)().deviceType}var M=()=>n(922898),A=()=>n(621072),w=()=>n(337581),k=()=>n(485966),j=()=>n(869537),C=()=>n(141122),I=()=>n(129044);class T extends I().default{getInitialState(){return{inMemoryRecordCache:new(n(371807).A)({name:"TemplateRecordCacheStore"})}}}var _=()=>n(505316),P=()=>n(126451),B=()=>n(356813),R=()=>n(966789),L=(n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(403517),()=>n(519423)),D=()=>n(220574),N=()=>n(545250),O=()=>n(145017),E=()=>n(518797),U=()=>n(409211),F=()=>n(34662),K=()=>n(818369),V=()=>n(305189),z=()=>n(111066),W=()=>n(34559),H=()=>n(927685),G=()=>n(282131),Y=()=>n(782422),q=()=>n(950452);class $ extends I().default{getInitialState(){return{}}}const Q=$;var Z=()=>n(797470),X=()=>n(413871),J=()=>n(142708),ee=()=>n(518471),te=()=>n(365060),ne=n(163643);const oe=function(e){let{style:t,disabled:o,disablePointerEvents:a,previewRootId:l,previewSpaceId:d,isPaidTemplate:c,userHasAcquiredTemplate:m,templateRecordCacheStore:p}=e;const g=(0,s().v3)(),f=(0,r().uB)(p,T),h=(0,r().uB)(void 0,Q),v=(0,r().O$)(n(802955).A),y=(0,i.useCallback)(((e,n)=>(0,ne.jsx)(se,{err:e,store:n,style:t,disabled:o,disablePointerEvents:a,isPaidTemplate:c,userHasAcquiredTemplate:m,pageTemplatePreviewStore:h})),[t,o,a,h,c,m]),b=(0,i.useCallback)((e=>{const{rootId:t,spaceId:n}=e;return async function(e,t,n,o,i){if(i){return new(X().Bv)(n,{table:O().ev,id:e})}const s=await K().callApi({eventName:"loadBlockSubtree",environment:n,data:{block:{id:e,spaceId:t},shallow:!1},headers:(0,L().WS)({spaceId:t})});if("failed"===s.type)throw s.error;const{currentSpaceStore:r}=k().default.state,{inMemoryRecordCache:a}=o.state;a.clearCache(),a.isTemplatePreview=!0;const l=new Set,d=new Set,c=D().RecordMapWithRole.create(s.data.subtreeRecordMap);for(const f of c){const{pointer:e,model:t,role:o}=f;if(!o)return;if(a.setModelAndRole({pointer:e,userId:n.currentUser.id},t,"editor"),(null==t?void 0:t.table)===O().ev){const e=t.getProperties();for(const t of Object.keys(e)){const n=(0,F().Fbh)(e[t]);for(const e of n)l.add(e);const o=(0,F().jgW)(e[t]);for(const e of o)d.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===U().oo?l.add(t.created_by_id):d.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===U().oo?l.add(t.last_edited_by_id):d.add(t.last_edited_by_id))}}const u=await Promise.all(Array.from(l).map((async e=>{if(r){const t=X().LU.createChildStore(r,{table:U().oo,id:e});await t.load();return t.getValue()}{const t=await(0,V().e)(n,{pointer:{table:U().oo,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const f of u)f&&a.setRecord({pointer:{table:U().oo,id:f.id},userId:n.currentUser.id},{role:"reader",value:f});const m=await Promise.all(Array.from(d).map((async e=>{if(r){const t=(0,X().Oo)(r,{table:E().GP,id:e,spaceId:r.id});await t.load();return t.getValue()}{const t=await(0,V().e)(n,{pointer:{table:E().GP,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const f of m)f&&a.setRecord({pointer:{table:E().GP,id:f.id,spaceId:f.space_id},userId:n.currentUser.id},{role:"reader",value:f});const{currentUserStore:p}=k().default.state;p&&(await p.load(),a.setRecord({pointer:p.pointer,userId:n.currentUser.id},{role:"editor",value:p.getValue()}));const g=new(X().Bv)(n,{table:O().ev,id:e},{inMemoryRecordCache:a});return g}(t,n,g,f,o)}),[g,f,o]),x=(0,i.useCallback)((e=>function(e,t,n){const{device:o}=t,i=(0,N().parseRoute)({url:e,isMobile:o.isMobile,baseUrl:H().A.domainBaseUrl,publicDomainName:H().A.publicDomainName,protocol:H().A.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?n.setState({...n.state,navigatedRootId:i.peekViewBlockId}):n.setState({...n.state,navigatedRootId:i.blockId}))}(e,g,h)),[g,h]);return v.online?(0,ne.jsx)(G().B,{value:x,children:(0,ne.jsx)(n(921637).A,{request:{rootId:l,spaceId:d},performRequest:b,render:y})}):(0,ne.jsx)(G().B,{value:x,children:(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,ne.jsx)(n(35462).A,{isSmall:!0,children:(0,ne.jsx)(u().sA,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function ie(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function se(e){let{store:t,style:n,disabled:o,disablePointerEvents:a,isPaidTemplate:l,userHasAcquiredTemplate:d,pageTemplatePreviewStore:c}=e;const m=(0,s().v3)(),p=(0,r().uB)(c,Q),g=(0,r().K8)((()=>p.state.navigatedRootId),[p]),f=S(),h=(0,r().K8)((()=>t&&(0,Y().fl)({environment:m,store:t})),[m,t]);if((0,i.useEffect)((()=>{l&&!f&&v().D6({label:(0,ne.jsx)(u().sA,{defaultMessage:"Purchase is unavailable on this platform",id:"pageTemplatePreview.paidTemplate.message"}),durationMs:"keep"})}),[m,l,f,d]),t&&h){let e;return e=g?X().Bv.createChildStore(t,{table:O().ev,id:g}):t,(0,ne.jsx)("div",{style:n,children:(0,ne.jsx)(te().A,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=t;return(0,ne.jsx)(J().H,{style:ie(m),type:h,store:q().A,preventType:z().u5(m),...n,children:a?(0,ne.jsxs)("section",{inert:"",children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]}):(0,ne.jsxs)(ne.Fragment,{children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]})},e.id)}},e.id)})}return(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...n},children:(0,ne.jsx)(R().A,{legacySize:W().Kh})})}const re={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const ae=function(){const e=(0,s().v3)(),t=(0,r().uB)(void 0,T),o=(0,i.useCallback)((()=>me(e,t)),[e,t]),a=(0,i.useCallback)((()=>(0,ne.jsx)(ge,{templateRecordCacheStore:t})),[t]),{device:l}=e,d=(0,r().O$)(j().A),c=(0,r().O$)(k().AppStoreCurrentSpaceViewStore);return(0,i.useEffect)((()=>{d.open&&c&&n(84543).createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,canUndo:!0,perform:e=>{h().setTemplateVisited({item:d.item,spaceViewStore:c,transaction:e})}})}),[c,e,d.item,d.open]),l.isMobile?(0,ne.jsx)(n(443252).Ay,{open:d.open,render:a,forceFullScreenSlideUp:!0,onDismiss:o,popupType:n(466321).n.SlideUp}):null};function le(){return new Promise(((e,t)=>{f().ui({message:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function de(e){h().close(e),g().xl()}function ce(e){var t,n;let{modalState:o,templateRecordCacheStore:i}=e;const s=(0,r().uB)(i,T);return(0,ne.jsx)(oe,{disablePointerEvents:o.disablePointerEvents,previewRootId:o.item.previewRootId,previewSpaceId:o.item.spaceId,isPaidTemplate:Boolean(null===(t=o.item.marketplaceTemplateMetadata)||void 0===t?void 0:t.isPaidTemplate),userHasAcquiredTemplate:Boolean(null===(n=o.item.marketplaceTemplateMetadata)||void 0===n?void 0:n.userHasAcquiredTemplate),style:re,templateRecordCacheStore:s,disabled:!0},o.item.previewRootId)}function ue(e,t,n,o){const{inMemoryRecordCache:i}=n.state,s=j().A.state,{currentSpaceViewStore:r,currentSpaceStore:a,mainEditorCurrentBlockStore:l}=k().default.state;if(s.open&&r&&a){const n=l&&l.isEmptyPage()?l:void 0,d=C().default.state.open&&C().default.state.targetStore&&C().default.state.targetStore.isEmptyPage()?C().default.state.targetStore:void 0;h().accept({environment:t,item:s.item,spaceStore:a,spaceViewStore:r,useRecordCache:e?i:void 0,initializeStore:s.createNewPage?void 0:n||d,isPrivate:s.isPrivate,acceptFrom:s.createNewPage?"sidebar":"newPage",isEmailShared:o})}}async function me(e,t){const{inMemoryRecordCache:n}=t.state;if(v().N2(),n.appliedTransaction){await le()?ue(!0,e,t):de(e)}else de(e)}async function pe(e,t,n){var o,i,s,r;const{inMemoryRecordCache:a}=t.state;if(a.appliedTransaction){return void ue(!!(await le()),e,t)}const l=null===(o=j().A.state.item)||void 0===o||null===(o=o.marketplaceTemplateMetadata)||void 0===o?void 0:o.isPaidTemplate,d=null===(i=j().A.state.item)||void 0===i||null===(i=i.marketplaceTemplateMetadata)||void 0===i?void 0:i.marketplaceListingId,c=null===(s=j().A.state.item)||void 0===s||null===(s=s.marketplaceTemplateMetadata)||void 0===s?void 0:s.userHasAcquiredTemplate,u=null===(r=j().A.state.item)||void 0===r?void 0:r.id;if(j().A.state.open&&l&&d&&u&&!c)return M().A.setState({...M().A.state,from:"mobileApp",marketplaceListingId:d,templateId:u}),void j().A.setState({...j().A.state,isCheckout:!0});!c&&l||ue(!1,e,t,n)}function ge(e){var t,n,d,c,p;let{templateRecordCacheStore:g}=e;const f=(0,s().v3)(),h=(0,u().tz)(),C=(0,a().DP)(),I=S(),T=(0,r().K8)((()=>{var e;return(null===(e=k().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||m().q}),[]),P=(0,r().K8)((()=>A().A.state.duplicationStatus),[]),B=(0,r().O$)(j().A),L=null===(t=B.item)||void 0===t||null===(t=t.marketplaceTemplateMetadata)||void 0===t?void 0:t.creator,D=null===(n=B.item)||void 0===n||null===(n=n.marketplaceTemplateMetadata)||void 0===n?void 0:n.emailCaptureType,N="duplicating"===P,O=Boolean(null===(d=B.item)||void 0===d||null===(d=d.marketplaceTemplateMetadata)||void 0===d?void 0:d.isPaidTemplate),E=null===(c=B.item)||void 0===c||null===(c=c.marketplaceTemplateMetadata)||void 0===c?void 0:c.paidTemplatePrice,U=Boolean(null===(p=B.item)||void 0===p||null===(p=p.marketplaceTemplateMetadata)||void 0===p?void 0:p.userHasAcquiredTemplate),F=(0,i.useCallback)((()=>{if("required"!==D&&"optional"!==D)return pe(f,g);w().A.open({creator:L,emailRequirement:D,onSubmit:async e=>{await pe(f,g,e)}})}),[f,D,L,g]),K=(0,i.useCallback)((()=>me(f,g)),[f,g]),V=(0,i.useCallback)((()=>{v().N2(),j().A.state.open&&j().A.setState({...j().A.state,isCheckout:!1}),M().A.setState({...M().A.state,isModalOpen:!1,from:void 0,marketplaceListingId:void 0,templateId:void 0,creatorId:void 0,customerId:void 0})}),[]),z=(0,x().IT)(C,T);return B.open?(0,ne.jsx)(y().QA,{title:B.isCheckout?(0,ne.jsx)(u().sA,{defaultMessage:"Complete checkout",id:"pageTemplateModal.mobileModal.checkoutTitle"}):void 0,left:B.isCheckout?(0,ne.jsx)(he,{handleClick:V}):(0,ne.jsx)(ve,{handleClick:K,style:{marginLeft:20}}),right:B.isLoading?(0,ne.jsx)(R().A,{style:{marginRight:40}}):B.isCheckout?null:(0,ne.jsx)(fe,{handleClick:F,isDisabled:N||O&&!I,label:U?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.addAgain",defaultMessage:"Add again"}):O&&E?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.buyTemplate",defaultMessage:"Buy for <money></money>",values:{money:()=>(0,ne.jsx)(l().v,{cost:{amount:100*E,currencyCode:"USD"},intl:h,trailingZeroDisplay:"auto"})}}):void 0}),shouldRenderLeftDirectly:!0,shouldRenderRightDirectly:!0,onCancel:K,disableHeaderShadow:!0,forceFullScreenSlideUp:!0,children:B.isCheckout?(0,ne.jsx)(o().Elements,{stripe:(0,_().getStripe)(),options:z,children:(0,ne.jsx)(b().l,{})}):(0,ne.jsx)(ce,{templateRecordCacheStore:g,modalState:B})}):null}function fe(e){let{handleClick:t,isDisabled:n,label:o}=e;const i=(0,a().IS)((e=>({doneButton:{display:"flex",alignItems:"center",height:34,paddingLeft:14,paddingRight:14,marginRight:20,fontWeight:p().Wy.medium,color:n?e.text.secondary:e.text.primary,background:e.tint.regular,borderRadius:17}})),[n]);return(0,ne.jsx)(P().A,{mobileFeedback:!0,style:i.doneButton,onClick:t,disabled:n,children:o||(0,ne.jsx)(u().sA,{defaultMessage:"Use template",id:"pageTemplateModal.mobileModal.useTemplateButton.label"})})}function he(e){let{handleClick:t}=e;const n=(0,u().tz)(),o=(0,a().IS)((e=>({iconButton:{borderRadius:17,width:34,height:34,marginLeft:20},icon:{width:20,height:20}})),[]);return(0,ne.jsx)(B().A,{icon:e=>(0,d().I)(o.icon),style:o.iconButton,isDarkIconColor:!0,onClick:t,ariaLabel:n.formatMessage({defaultMessage:"Back",id:"pageTemplateModal.mobileModal.checkout.backButton.label"})})}function ve(e){let{handleClick:t,style:n,disabled:o}=e;const i=(0,a().DP)(),s=(0,u().tz)(),r={background:i.tint.regular,borderRadius:17,width:34,height:34,...n};return(0,ne.jsx)(B().A,{disabled:o,icon:e=>(0,c().u)({width:20,height:20}),style:r,isDarkIconColor:!0,onClick:t,ariaLabel:s.formatMessage({defaultMessage:"Close",id:"pageTemplateModal.mobileModal.closeButton.label"})})}},233048:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(242343);var o=()=>n(803290),i=()=>n(174114),s=()=>n(433119),r=()=>n(801008),a=n(163643);function l(e){let{store:t,permissionsInviteStore:n,origin:l}=e;const d=(0,o().K8)((()=>n.state.modalOpen),[n]),c=()=>{n.reset()},u=(0,i().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,a.jsx)(s().A,{modalStyle:u.modal,open:d,onDismiss:c,renderContent:()=>(0,a.jsx)("div",{style:u.overlay,children:(0,a.jsx)(r().A,{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:c,onDismiss:c})}),origin:l})}},251399:(e,t,n)=>{n.d(t,{J:()=>Y});n(610931),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(186839),l=()=>n(444701),d=()=>n(615917),c=()=>n(97787),u=()=>n(473478),m=()=>n(96297),p=()=>n(121686),g=()=>n(113805),f=()=>n(70107),h=()=>n(330678),v=()=>n(710548),y=(n(358848),n(91270),n(725707),n(491955),()=>n(804750)),b=()=>n(984826),x=()=>n(653998),S=()=>n(356813),M=()=>n(103151),A=()=>n(983050),w=()=>n(838218),k=()=>n(907721),j=()=>n(62522),C=()=>n(220678),I=()=>n(546820),T=n(163643);const _=(0,x().YK)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),P=32;function B(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,x().tz)(),{layoutStore:n,addModuleHoverMenuStore:o,currentModuleSelection:i}=(0,I().LH)(),a=(0,s().K8)((()=>{if(o.state.isOpen)return o.state.moduleId}),[o]),l=(0,s().K8)((()=>{if(!a)return;const e=w().A.findModuleContainer({layoutStore:n,moduleId:a});return e?e.getNode():void 0}),[a,n]),c=(0,s().K8)((()=>{if(!i||"new_module"===i.type)return!1;const e=n.getModuleById(i.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[i,n]),u=(0,s().K8)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area].filter((e=>(0,b()._)(e))),s=0===i.length||(null===(t=i.at(-1))||void 0===t?void 0:t.id)===a;return o.state.isOpen&&!c&&!s}),[o,a,c,n,e.area]),m=(0,C().t)({area:e.area,afterModuleId:a}),p=(0,j().d)(),g=(0,r().IS)((e=>({bigRoundButton:{...p.button,width:P,height:P,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...p.buttonHovered},bigRoundButtonPressed:{...p.buttonPressed}})),[p]),f="form"===(0,s().K8)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(_.formLayoutAddModule):t.formatMessage(_.pageLayoutAddModule),h=l?l.offsetLeft-40:void 0,v=l?l.offsetTop+l.offsetHeight-4:void 0;return void 0===h||void 0===v?null:(0,T.jsx)(d().A,{visible:u,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",left:h,top:v},children:(0,T.jsx)(M().A,{placement:k().W.Left,renderTooltip:()=>f,render:e=>(0,T.jsx)(S().A,{...e,style:g.bigRoundButton,hoveredStyle:g.bigRoundButtonHovered,className:A().kew,pressedStyle:g.bigRoundButtonPressed,onClick:m,icon:y().b,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},isBlue:!0,ariaLabel:f})})})}var R=()=>n(610271),L=()=>n(521839),D=()=>n(129978);const N={BuilderAddModuleButtonEducationTooltip:new(D().O2)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(63538).then(n.bind(n,773262))))},O=(0,D()._h)(N.BuilderAddModuleButtonEducationTooltip,(e=>e.default));var E=()=>n(116485);const U=(0,x().YK)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),F=o.forwardRef((function(e,t){const{area:o}=e,{layoutStore:i}=(0,I().LH)(),a=(0,s().K8)((()=>i.getLayoutType()),[i]),l=(0,x().tz)(),d=(0,j().d)(),c=(0,r().IS)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 16px 8px 12px",fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],color:e.accentColors.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,C().t)("views_main_tab_modules"===o?{area:o,viewsMainTabId:e.viewsMainTabId}:{area:o});if("form_conditional_modules"===o)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const m=(0,s().K8)((()=>{var t;const n=i.getModules();return("views_main_tab_modules"===o?(null===(t=n[o])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[o]).length>0}),[i,o,e.viewsMainTabId]);return"page_details"!==o||m?(0,T.jsx)(M().A,{renderTooltip:()=>l.formatMessage(U.addQuestionModuleTooltip),disableTooltip:"form"!==a,placement:k().W.Bottom,render:e=>(0,T.jsx)(S().A,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:y().b,iconStyle:{width:16,height:16},isBlue:!0,className:A().kew,ariaLabel:l.formatMessage(U.addPageModule),ref:t,...e})}):(0,T.jsxs)(n(417653).A,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(280704).b)({width:12,marginRight:4}),(0,T.jsx)(x().sA,{...U.addModuleToPanelButton})]})})),K=o.memo((function(e){var t;const{shouldShowTooltip:i}=(0,n(518881).J)(),{area:r}=e,a=i&&"page_main"===r,l=i&&"form_layout_schema"!==r,d=o.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:m,isPropertyTypeSearchInputDirtyStore:p}=(0,I().LH)(),g=(0,s().K8)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,s().K8)((()=>{var t;if("form_conditional_modules"===r)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===r?(null===(t=n[r])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[r]).length>0}),[u,r,e.viewsMainTabId]),[h,v]=o.useState(!1),y=o.useCallback((()=>{p.state||m(void 0)}),[p,m]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,T.jsx)(n(655830).A,{onUndo:y,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,T.jsx)(V,{})}):"placeholder"===(null==g?void 0:g.type)?null:a||l?(0,T.jsxs)(R().Ye,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:E().hg,children:[(0,T.jsx)(L().u,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>v(!0),children:(0,T.jsx)(F,{isEducationCalloutVisible:a,...e,ref:d})}),a&&h&&(0,T.jsx)(O,{buttonRef:d})]}):(0,T.jsx)(R().Ye,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:E().hg,children:(0,T.jsx)(F,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function V(){const e=(0,r().IS)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.accentColors.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.stroke.uiBlueSecondary}, inset 0px 0px 0px 1px ${e.stroke.uiBlueSecondary}`}})),[]);return(0,T.jsx)("div",{style:e.ghostPageModuleContainer,className:E().hg,children:(0,T.jsx)(L().u,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,T.jsx)("div",{style:e.ghostPageModule})})})}var z=()=>n(975392);const W=12;function H(){const{addModuleHoverMenuStore:e}=(0,I().LH)(),t=(0,h().z)(),n=(0,o.useCallback)((n=>{const o=w().A.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let i=null;for(const e of o){const o=e.getNode();if(!o)continue;const s=o.getBoundingClientRect();if(n.clientX>s.right||n.clientX<s.left&&s.left-n.clientX>300)continue;if(n.clientY<=s.bottom&&s.bottom-n.clientY<W||n.clientY>s.bottom&&n.clientY-s.bottom<W+t){i=e;break}}if(i)e.setState({isOpen:!0,moduleId:i.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),i=z().nF(n,30);return(0,o.useEffect)((()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)})),[i]),null}var G=()=>n(590585);function Y(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,i().v3)(),{sessionId:y,layoutStore:b,currentModuleSelection:x,setModuleSelection:S,canEditLayout:M,layoutBuilderModuleSelectionStore:A}=(0,I().LH)(),w=(0,o.useRef)(null),k=(0,v().ub)({layoutStore:b,pageStoreId:void 0}),j=(0,s().K8)((()=>b.isTabbedPageLayout()),[b]),C=(0,h().z)(),{nonMoveableHeaderModules:_,moveableModules:P,nonMoveableFooterModules:R}=(0,s().K8)((()=>{var n;const o="views_main_tab_modules"===t?(null===(n=k[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:k[t];return(0,l().jS)(t,o)}),[t,k,null==e?void 0:e.viewsMainTabId]),L=(0,s().K8)((()=>{const e=A.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,o=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&o.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&o.area!==t,isDraggingAnyModuleList:!0,dragArea:o}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,A]),D=P.map((e=>"form_layout_schema"===t?{key:e.id,draggable:"placeholder"!==e.type}:{key:e.id,draggable:!0})),N=(0,o.useMemo)((()=>new(p().A)),[]),O=(0,s().K8)((()=>N.state.isDragging),[N]),U=(0,s().K8)((()=>{var e;return null===(e=b.getModel())||void 0===e?void 0:e.getLayoutType()}),[b]);(0,o.useEffect)((()=>{w.current&&L.isDraggingIntoThisArea&&(0,m().$v)({element:w.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[L.isDraggingIntoThisArea,n]);const F=(0,o.useCallback)((n=>{const o="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};S({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:o,draggingModuleFinalArea:o})}),[t,e.viewsMainTabId,S]),V=(0,o.useCallback)((e=>{e&&S({type:"existing_module",moduleId:e,isDragging:!1})}),[S]),z=(0,o.useCallback)((()=>{const e=A.state,t=b.getLayoutType();t&&(0,a().Hc)(t)?S(void 0):null!=e&&e.isDragging&&A.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[A,S,b]),W=(0,o.useCallback)((e=>{const o=A.state,i=null!=o&&o.isDragging?o.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==i?void 0:i.area)&&(null!=e&&e.key&&i&&i.area!==t&&((0,g().E)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewsMainTabId}:{area:i.area}},moduleId:e.key,layoutStore:b,sessionId:y}),(0,f().z)({moduleId:e.key,layoutStore:b,environment:n})),z())}),[A,t,z,n,b,y]),Y=(0,o.useCallback)((o=>{let{key:i,endPosition:s,startPosition:r}=o;if(L.isDraggingFromThisAreaToOtherArea)return;const a=_.length,l="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,g().E)({environment:n,layoutStore:b,position:{type:"absolute",index:a+s,...l},moduleId:i,sessionId:y}),(0,f().z)({moduleId:i,layoutStore:b,environment:n})}),[L.isDraggingFromThisAreaToOtherArea,_.length,t,e.viewsMainTabId,n,b,y]),q=(0,r().IS)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:C,marginBottom:C},addButtonContainer:{paddingTop:"page_in_collection"===U?8:0,marginBottom:"form"===U?0:12,width:"100%"},dropzoneHalo:{background:u().to,height:u().NZ,marginTop:-u().NZ},hiddenModuleStyle:{display:"none"}})),[C,U]),$=(0,o.useCallback)((e=>{const n="existing_module"===(null==x?void 0:x.type)&&x.moduleId===e,o=n&&O;return(0,T.jsx)(G().n,{active:n,pageModuleId:e,isDragging:o,area:t,style:o&&L.isDraggingFromThisAreaToOtherArea?q.hiddenModuleStyle:void 0},e)}),[L.isDraggingFromThisAreaToOtherArea,x,O,q.hiddenModuleStyle,t]),Q=(0,o.useMemo)((()=>_.length?_.map((e=>$(e.id))):null),[_,$]),Z=(0,o.useMemo)((()=>R.length?R.map((e=>$(e.id))):null),[R,$]),X=(0,o.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),J=(0,o.useMemo)((()=>({buttonContainer:q.addButtonContainer})),[q.addButtonContainer]);if(!b)return null;let ee;return ee=!!M&&(!j||("views_main_tab_modules"===t||"page_details"===t)),(0,T.jsxs)(T.Fragment,{children:[Q,Boolean(D.length)&&(0,T.jsx)(c().Ay,{forceDragKeyIndex:L.isDraggingFromThisAreaToOtherArea?D.length-1:void 0,className:E().hg,store:N,keys:D,direction:"vertical",onDraggingKeyChanged:F,onDrop:(e,t)=>{Y(t)},onDragCancel:z,onDragEnd:W,onClick:V,style:q.draggableList,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:$,disabled:!M,...j?{}:{hoverCursorStyleOverride:L.isDraggingAnyModuleList?"grabbing":void 0}}),(0,T.jsx)(d().A,{visible:L.isDraggingIntoThisArea,initial:X.enter,animate:X.animate,exit:X.exit,skip:!L.isDraggingAnyModuleList,className:"layout-content",ref:w,style:q.dropzoneHalo}),ee&&(0,T.jsx)(K,{...e,styles:J}),"form"===U&&M&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(H,{}),(0,T.jsx)(B,{area:t})]}),Z]})}},252443:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>R});var o=n(242343),i=()=>n(16791),s=()=>n(237385),r=()=>n(803290),a=()=>n(174114),l=()=>n(379470),d=()=>n(421777),c=()=>n(288685),u=()=>n(653998),m=()=>n(31448),p=()=>n(570537),g=()=>n(110975),f=()=>n(271674),h=()=>n(884373),v=()=>n(931085),y=()=>n(951540),b=()=>n(35462),x=()=>n(520276),S=()=>n(927685),M=()=>n(245388),A=()=>n(392608),w=()=>n(689248),k=()=>n(148732),j=()=>n(700934),C=()=>n(485966),I=()=>n(825634),T=()=>n(313067),_=()=>n(471809),P=()=>n(310085),B=n(163643);function R(){const e=(0,s().v3)(),t=(0,a().IS)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:m().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.text.secondary,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.text.secondary},successTitle:{fontSize:25,fontWeight:m().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:m().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,o.useEffect)((()=>{const t=()=>{I().A.state.isVisible&&_().A.state.isConnectingCalendar&&(_().A.setState({isConnectingCalendar:!1}),f().oX({environment:e}))};return I().A.addListener(t),()=>{I().A.removeListener(t)}}),[e]);const n=(0,r().K8)((()=>_().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),R=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().MR({environment:e,userSettingsStore:t}),_().A.setState({signupCtaAttribution:void 0}))}),[e]),D=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),N=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),O=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),E=(0,r().K8)((()=>C().default.state.currentUserSettingsStore),[]),U=(0,r().K8)((()=>{const e=null==E?void 0:E.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[E]),F=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M().Rz,{onClick:R}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.successCheckmark,children:(0,l().X)(t.successCheckmarkIcon)}),(0,B.jsx)("div",{style:t.successTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,B.jsxs)("div",{style:t.downloadContainer,children:[(0,B.jsxs)("div",{style:t.downloadContent,children:[(0,B.jsx)("div",{style:t.downloadTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,B.jsx)("div",{style:t.downloadButtonContainer,children:(0,B.jsx)(y().A,{style:t.downloadButton,onClick:()=>{p().Lt(e,{cta:"download"}),g().f({environment:e,url:S().A.calendar.downloadUrl}),O()},children:(0,B.jsx)(u().sA,{...P().z.downloadApp})})})]}),(0,B.jsx)("div",{style:t.notionCalendarLogo,children:(0,d().u)(t.notionCalendarLogoIcon)})]})]})]}),K=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(x().A,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:x().V[i().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,B.jsx)(M().Rz,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:R}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.title,children:(0,B.jsx)(u().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,B.jsxs)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,B.jsx)(u().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,B.jsx)(h().A,{size:1,style:t.divider}),(0,B.jsxs)("div",{style:t.footer,children:[(0,B.jsxs)(v().A,{external:!0,href:(0,A().xS)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,B.jsx)(u().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,c().M)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]}),(0,B.jsx)(P().A,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{p().be(e,{cta:"open_calendar"}),D()},onGetNotionCalendarClick:()=>{p().be(e,{cta:"get_calendar"}),N()},onDownloadClick:()=>{p().be(e,{cta:"download"}),O()}})]})]});return(0,B.jsx)(j().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,B.jsx)(L,{launchModalPhase:U,renderChild:()=>"connected_notion_calendar"===U?F():K()}),desktopInnerStyle:t.container,desktopOnDismiss:R,phoneRenderInner:()=>null})}function L(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,s().v3)();return(0,o.useEffect)((()=>{"connected_notion_calendar"===t?p().Y8(i):p().aq(i)}),[i,t]),n()}},259539:(e,t,n)=>{n.d(t,{Q:()=>a});var o=()=>n(237385),i=()=>n(803290),s=()=>n(548694),r=()=>n(485966);function a(){const e=function(){const e=(0,o().v3)();return(0,i().K8)((()=>{const t=r().default.state.currentSpaceStore;if(!t)return{loading:!0};if(!s().IL(t))return{loading:!1,isUserTeamGuestOfSpace:!1};const n=r().default.state.currentSpaceViewStore;if(!n||!e.currentUser.id)return{loading:!0};const o=s().vb({userId:e.currentUser.id,spaceViewStore:n});return o.isLoaded?{loading:!1,isUserTeamGuestOfSpace:o.isTeamGuestInSpace}:{loading:!0}}),[e])}();return(0,i().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},260276:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(712437),a=()=>n(284594),l=()=>n(653998),d=()=>n(598995),c=()=>n(191756),u=()=>n(392608),m=()=>n(485966);class p extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const g=new p;var f=()=>n(209684),h=()=>n(579494),v=()=>n(403812),y=n(163643);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(31448).Wy.bold,marginRight:"auto"},x={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},S={padding:"24px 36px 24px",minWidth:300};const M=function(){const e=(0,s().O$)(g);return(0,y.jsx)(n(922172).a,{open:e.open,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,y.jsxs)(o.Fragment,{children:[(0,y.jsxs)("div",{style:x,children:[(0,y.jsx)("div",{style:b,children:(0,y.jsx)(l().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,y.jsx)(A,{})]}),(0,y.jsx)("div",{children:(0,y.jsx)(k,{modalState:e})})]}),onDismiss:w})};function A(){const e=(0,i().v3)();return(0,y.jsx)(h().A,{href:(0,u().xS)("guides.import"),onClick:()=>d().FH(e,{from:"import"}),external:!0,children:(0,y.jsx)(f().p,{size:"sm",icon:a().$,isGray:!0,children:(0,y.jsx)(l().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function w(){g.setState({open:!1})}function k(e){let{modalState:t}=e;const n=(0,i().v3)(),{mainEditorCurrentBlockStore:o,currentSpaceStore:a,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,s().K8)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}=m().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}}),[]);return o&&a&&l&&d?(0,y.jsx)(v().A,{pageStore:t.open&&t.pageStore?t.pageStore:o,spaceStore:a,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.setState({open:!1}),c().uK({environment:t,store:e,pageVisitSource:r().y8.Import})}(e,n),readOnlyCreditButton:!1}):null}},267439:(e,t,n)=>{n.d(t,{c:()=>y,t:()=>b});n(610931);var o=()=>n(752597),i=()=>n(220574),s=()=>n(34662),r=()=>n(197881),a=()=>n(415029),l=()=>n(448316),d=()=>n(84543),c=()=>n(868068),u=()=>n(900921),m=()=>n(477784),p=()=>n(593745),g=()=>n(485966),f=()=>n(836331),h=()=>n(134915);const v=(0,n(653998).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function y(e){var t,n,s;const{environment:d,store:m,viewType:v,transaction:y}=e,b=null===(t=m.getBlockTitleStore())||void 0===t?void 0:t.getValue();f().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&h().A.state.open&&h().A.setState({open:!1});const x=m.getSpaceId()??(null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id)??(null===(s=g().default.state.mainEditorCurrentBlockStore)||void 0===s?void 0:s.getSpaceId()),S=x?d.idCreator.getSpaceIdCreatorSync(x):void 0;a().j({environment:d,sourceBlockId:"root",targetBlockPointer:m.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().qP)({isInline:!1,viewType:v})),targetRecordCache:m.inMemoryRecordCache,transaction:y,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:d,block:m,blockType:"collection_view_page",transaction:y}),b&&l().R9({environment:d,store:m.getBlockTitleStore(),value:b,transaction:y}),o().default.afterNextFlush((()=>{const e=p().K.findCollectionViewBlockFromStore(m);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))})),r().v(d,{from:"template_picker",type:"collection_view_page",creating_block_id:m.id,is_full_screen:!0,view_type:v})}async function b(e){var t,o,l;const{environment:p,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:y}=await Promise.resolve().then(n.bind(n,108665)),{formEditorActions:b}=await y.load(),x=f.getSpaceId()??(null===(o=g().default.state.currentSpaceStore)||void 0===o?void 0:o.id)??(null===(l=g().default.state.mainEditorCurrentBlockStore)||void 0===l?void 0:l.getSpaceId()),S=x?p.idCreator.getSpaceIdCreatorSync(x):void 0;d().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:p,canUndo:!0,perform:e=>{var t;a().j({environment:p,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().mT)({isInline:!1,name:(0,s().w9s)(h)?(0,s().x9d)(m().A.formatMessage(v.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:p,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStore(),o=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema(),l=f;if(!o)throw new Error("Schema not found");const d=b.createCollectionFormEditorView({environment:p,transaction:e,collectionViewBlockStore:l,schema:o,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:p,transaction:e,collectionViewBlockStore:l,schema:o}),r().v(p,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==d?void 0:d.formId,view_id:l.id})}})}},267611:(e,t,n)=>{n.d(t,{V:()=>s,h:()=>i});var o=()=>n(978398);function i(){o().z.setState({isOpen:!0})}function s(){o().z.setState({isOpen:!1})}},275338:(e,t,n)=>{function o(e){return Date.now()-parseInt(e.timestamp)}n.d(t,{S:()=>o})},276004:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>m,default:()=>p});n(242343);var o=()=>n(803290);const i=(0,n(680369).xh)("docBadgePlus",{default:{loader:()=>n.e(94802).then(n.bind(n,292834))},small:{loader:()=>n.e(94802).then(n.bind(n,148488))},fill:{loader:()=>n.e(94802).then(n.bind(n,668306))},fillSmall:{loader:()=>n.e(94802).then(n.bind(n,486059))}},["IPR","initial page render","recent document","recent page","recents","page history"]);var s=()=>n(653998),r=()=>n(281267),a=()=>n(330358),l=()=>n(529305),d=()=>n(539048),c=n(163643);function u(){r().A.setState({open:!1})}function m(){const e=(0,o().O$)(r().A);return(0,c.jsx)(d().s,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,c.jsx)(l().tf,{header:(0,c.jsx)(l().YA,{iconAndTitle:(0,c.jsx)(l().ZQ,{iconGroup:i,title:(0,c.jsx)(s().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(s().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(s().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{a().A.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const p=m},281267:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const i=new o},282319:(e,t,n)=>{n.d(t,{W:()=>a,m:()=>r});n(242343);var o=()=>n(653998),i=n(163643);const s=(0,o().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust team membership."}});function r(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}=e;return t||"owner"!==n?o&&"team_level_guest"===n?l(s.addingGuestsToDefaultTeam):!i&&"team_level_guest"===n||!t&&"team_level_guest"===n?l(s.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(s.upgradingAnOwnerAsNonOwner)}function a(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:a,originalTeamMemberInfo:d,onlyHasOneOwner:c,isUnowned:u,isMemberCurrentUser:m,canCurrentUserAddTeamMembers:p}=e;if("team_level_guest"===n&&"team_level_guest"!==d.type)return l(s.downgradingAMemberToAGuest);const g="owner"!==n&&"owner"===d.type;if(g&&!t)return l(s.downgradeToOwnerAsNonOwner);if(g&&c)return l("none"===n?"group"===d.entity_type?s.removeLastGroupOwner:s.removeLastUserOwner:"group"===d.entity_type?s.downgradeLastMakingAGroupAnOwner:s.downgradeLastUserOwner);if("none"===n&&o)return l(s.removingMemberFromDefaultTeam);return"group"===d.entity_type&&"team_level_guest"===n?l(s.makingAGroupATeamGuest):"owner"===n&&i&&"user"===d.entity_type&&u&&m||"owner"===n&&a&&m?{isDisabled:!1,disabledReason:void 0}:"none"===n?t||p&&"member"===d.type?{isDisabled:!1,disabledReason:void 0}:l(s.removingMemberAsMember):t?r({isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}):l(s.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,i.jsx)(o().sA,{...e})}}},283886:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>_,messages:()=>k});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(633627),l=()=>n(653998),d=()=>n(972340),c=()=>n(983050),u=()=>n(906230),m=()=>n(480415),p=()=>n(636208),g=()=>n(422340),f=()=>n(186438),h=()=>n(907721),v=()=>n(802955),y=()=>n(209684),b=()=>n(273520),x=()=>n(151835),S=()=>n(103151),M=()=>n(278267),A=()=>n(657304),w=n(163643);const k=(0,l().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function j(e){let{store:t,buttonPopupStore:a}=e;const l=(0,i().v3)(),{isMobile:c,isTablet:u}=(0,s().K8)((()=>({isMobile:l.device.isMobile,isTablet:l.device.isTablet})),[l]),h=(0,s().uB)(void 0,n(299097).A),v=(0,s().uB)(void 0,n(60020).Ay),y=(0,s().uB)(void 0,n(420401).A),x=(0,s().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(t,y)),[t,y]),S=(0,s().K8)((()=>(0,n(268117).FI)({disableLogging:!0})),[]),M=(0,s().K8)((()=>t.canAdmin()),[t]),A=(0,s().K8)((()=>!c&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(h,v)),[v,c,h]),{sudoModeStoreId:k}=(0,s().K8)((()=>{var e;return{sudoModeStoreId:null===(e=y.state.privatePageStore)||void 0===e?void 0:e.id}}),[y]),j=(0,s().O$)(n(485966).AppStoreCurrentSpaceStore);(0,o.useEffect)((()=>{!function(e){var t;let{environment:n,store:o,sudoModeStore:i,canAdmin:s,currentSpaceStore:r}=e;null!==(t=i.state.privatePageStore)&&void 0!==t&&t.id&&i.state.privatePageStore.id!==o.id&&i.reset();s||d().B({environment:n,sudoModeStore:i,pageBlockId:o.id,currentSpaceStore:r})}({environment:l,sudoModeStore:y,store:t,canAdmin:M,currentSpaceStore:j})}),[M,l,t,y,k,j]),(0,o.useEffect)((()=>{g().Ay.setState({...g().Ay.state,isInitialized:!0})}));const I=(0,o.useCallback)((()=>{a.reset()}),[a]),_=(0,o.useCallback)((()=>{T({buttonPopupStore:a,universalMemberInviteStore:h,inviteTargetsStore:v}),n(360378).IU({environment:l}),m().Tk(l),(0,f().g)()||n(104838).x(l)}),[a,h,v,l]),P=(0,o.useCallback)((e=>(0,w.jsx)(C,{buttonPopupEvents:e,handleClick:_})),[_]),B=(0,o.useCallback)((async()=>{if(v.state.inviteTargets.length>0){return void(await m().T({environment:l,inviteTargetsStore:v})&&(m().XP(l),T({buttonPopupStore:a,universalMemberInviteStore:h,inviteTargetsStore:v})))}const{permissionsInviteStore:e}=h.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,n(861095).iQ)({environment:l,permissionsInviteStoreState:e.state,from:"share_menu"})||(m().XP(l),T({buttonPopupStore:a,universalMemberInviteStore:h,inviteTargetsStore:v}))}),[a,l,v,h]),R=(0,r().IS)((e=>({buttonPopup:{...c?{width:"100%"}:u?{width:460}:{width:S?p().$D:500,overflow:"hidden",...S&&{borderRadius:p().Sg,boxShadow:e.shadowMD,..."dark"===e.mode&&{border:`1px solid ${e.largePopupBorder}`}}}}})),[c,S,u]);return(0,w.jsx)(b().Ay,{popupType:c?b().z7.SlideUp:b().z7.Popup,forceInitialInbound:!0,buttonPopupStore:a,renderOrigin:P,originGap:c?void 0:8,style:R.buttonPopup,onClick:_,render:()=>(0,w.jsx)(n(872856).k,{buttonPopupStore:a,sudoModeStore:y,store:x,inviteTargetsStore:v,universalMemberInviteStore:h,onUpgradeButtonClick:I,location:c?"topbar_mobile":"topbar_share_button",onClose:B}),persistOnClose:A,onDismiss:B,onClose:B})}function C(e){let{buttonPopupEvents:t,handleClick:n}=e;const{isMobile:a}=(0,i().Y0)(),d=!(0,s().O$)(v().e),c=(0,s().K8)((()=>(0,f().g)()),[]),m=(0,r().IS)((e=>({shortcut:{color:e.text.contrastSecondary}})),[]),p=(0,o.useCallback)((()=>d?(0,w.jsx)(l().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{children:c?(0,w.jsx)(l().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,w.jsx)(l().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,w.jsx)(x().A,{style:m.shortcut,name:"openShareMenu"})]})),[d,c,m.shortcut]);return(0,w.jsx)(S().A,{disableTooltip:a,renderTooltip:p,placement:h().W.Bottom,delayThreshold:400,render:e=>(0,w.jsx)(I,{events:(0,u().A)(e,t),handleClick:n,disabled:d})})}function I(e){let{events:t,handleClick:n,disabled:o}=e;const{isMobile:s}=(0,i().Y0)(),d=(0,l().tz)(),u=(0,r().IS)((e=>{const t=(0,M().aD)(e),n=(0,A().Hh)(e);return{mobileIconStyle:t.iconStyle,shareButton:{...s?t.iconContainer:{marginRight:n.iconButton.marginRight,marginLeft:n.iconButton.marginRight}}}}),[s]);const m=s?(0,a().Y)(u.mobileIconStyle):(0,w.jsx)(l().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"});return(0,w.jsx)(y().p,{id:void 0,className:c().voG,...t,mobileFeedback:s,style:u.shareButton,"aria-label":d.formatMessage(k.share),disabled:o,disabledFeedback:o,children:m})}function T(e){let{buttonPopupStore:t,universalMemberInviteStore:n,inviteTargetsStore:o}=e;t.reset(),n.reset(),o.reset()}const _=o.memo(j)},299097:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{permissionsInviteStore:new(n(339838).A),contextualInviteStore:new(n(138385).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},328547:(e,t,n)=>{n.d(t,{A:()=>u});n(403517);var o=n(242343),i=()=>n(803290),s=()=>n(653998),r=()=>n(861095),a=()=>n(360482),l=()=>n(783e3),d=()=>n(797715),c=n(163643);const u=function(e){const{origin:t,permissionsInviteStore:u,store:m,handleClickRemoveToken:p,handleInputChange:g,handleInputSubmit:f,defaultRoleForNonBot:h,right:v,focus:y,handleFocus:b}=e,x=(0,i().K8)((()=>0!==(0,n(352723).Qo)()),[]),S="share_menu"===t||"add_members"===t,M="add_members"===t,[A,w]=(0,i().$y)(u),k=(0,n(237385).v3)(),{device:j}=k,C=(0,s().tz)(),{tokenQuery:I}=A,T=(0,n(731390).N)(m),_=A.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,r().yi)(e),a="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=i?T:void 0,u={key:t,target:e,onClickRemove:p,role:A.inviteRole,shouldWrap:S,showInfoIcon:Boolean(d)};return S&&a?(0,c.jsx)(n(103151).A,{placement:n(907721).W.Top,disableTooltip:M,renderTooltip:()=>i?d||(0,c.jsx)(s().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:a}}):a,render:n=>(0,o.createElement)("span",{...n,key:t},(0,c.jsx)(l().A,{...u,backgroundColor:(0,r().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})}));return(0,c.jsx)(d().Ay,{focus:j.isMobile?void 0:y,focusInitial:j.isMobile,focusAfterAnimation:!0,onClick:()=>{j.isMobile||null==b||b()},format:d().le.Share,value:I,onChange:g,type:"email",tokens:_,disabled:!1,autoComplete:"off",placeholder:S?x?C.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):C.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,a().Yu)(m)||(0,a().nw)(m)?C.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):C.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...A};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=h),w(A)},right:v,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:k.device.isMobile?0:A.isInviteTargetsEmpty?7:6,paddingBottom:k.device.isMobile||S?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:j.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:A.isInviteTargetsEmpty?3:0,paddingBottom:0,...y&&{background:"none"}}}})}},337081:(e,t,n)=>{n.r(t),n.d(t,{PopupBottomSheet:()=>f});var o=n(242343),i=()=>n(237385),s=()=>n(269280),r=()=>n(803290),a=()=>n(174114),l=()=>n(401548),d=()=>n(73876),c=()=>n(367111),u=()=>n(109380),m=()=>n(211358),p=()=>n(13774),g=n(163643);function f(e){const{isAndroid:t}=(0,i().Y0)(),n=(0,a().IS)((n=>({container:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",overflow:"hidden",pointerEvents:"none"},content:{position:"absolute",bottom:0,left:0,right:0,maxHeight:"var(--full-viewport-height)"},overlay:{pointerEvents:"auto",position:"absolute",top:0,left:0,bottom:0,right:0,...e.disableDarkOverlayBackground?{}:{background:t?(0,l().X4)("black","light"===n.mode?.2:.8):(0,l().X4)("black","light"===n.mode?.12:.29)},transition:"opacity 0.5s cubic-bezier(0.32, 0.72, 0, 1)"}})),[e.disableDarkOverlayBackground,t]),s=(0,o.useRef)(null),[r,d]=(0,o.useState)(0);return e.open?(0,g.jsx)(u().L,{keepFocus:e.keepFocus,preventCaptureEsc:e.preventCaptureEsc,onDismiss:e.onDismiss,children:t=>(0,g.jsxs)("div",{...t,style:n.container,children:[(0,g.jsx)("div",{"aria-hidden":!0,tabIndex:-1,ref:s,style:{...n.overlay,opacity:r},onMouseDown:e=>e.preventDefault()},"overlay"),(0,g.jsx)("div",{style:n.content,children:(0,g.jsx)(h,{...e,overlayRef:s,setAnimationState:d,children:e.render()})})]})},"popup-keyboard-area"):null}function h(e){const{initialState:t,onDismiss:n,overlayRef:l,setAnimationState:u}=e,{WindowSizeStore:f,TabbedRouterStore:h}=(0,i().v3)(),{isAndroid:v,isTablet:y,isMobileNative:b}=(0,i().Y0)(),x=(0,r().K8)((()=>h.state.modal.length>0),[h]),S=(0,o.useRef)(!1),M="half"===t||"full"===t&&e.enableHalfSheet,A=(0,o.useMemo)((()=>window.innerHeight),[]),w=(0,o.useRef)(A),k=(0,o.useMemo)((()=>({closed:A,half:.5*A,open:0})),[A]),j=(0,r().K8)((()=>f.getSafePaddingTopCSS(v?16:10)),[f,v]),[C,I]=(0,o.useState)({transform:`translateY(${k.closed}px) translateZ(0)`});(0,s().w)((()=>{m().KP.setState(!0),u(1),P({target:"half"===t?k.half:k.open,animate:!0})}));const T=(0,a().IS)((t=>({sheet:{backgroundColor:e.bottomSheetBackgroundColor?t.surface[e.bottomSheetBackgroundColor]:t.surface.wash,borderRadius:"12px 12px 0 0",maxWidth:640,margin:"0 auto",marginTop:j,boxShadow:v?void 0:t.shadowMD},dragHandle:{height:5,width:v?44:38,backgroundColor:t.stroke.primary,borderRadius:5,margin:"0px auto"}})),[j,v,e.bottomSheetBackgroundColor]),_=(0,o.useRef)(-1),P=(0,o.useCallback)((e=>{const{target:t,animate:n}=e,o=Math.max(Math.min(t,k.closed),k.open),i=_.current;window.cancelAnimationFrame(i),_.current=window.requestAnimationFrame((()=>{if(w.current=o,I({transform:`translateY(${o}px) translateZ(0)`,transition:n?"transform 0.5s cubic-bezier(0.32, 0.72, 0, 1)":void 0}),S.current){const e=Math.max(0,Math.min(o/k.closed,1)),t=.5-e<k.half?e:0,i=1-Math.max(0,Math.min(2*t,1));p().q.update((e=>({...e,attached:!0,animating:n,proportion:i})))}}))}),[_,w,k]),B=(0,r().K8)((()=>{const{phase:e}=c().A.state;return e===c().i.willShow}),[]);(0,o.useEffect)((()=>{B&&w.current>50&&P({target:k.open,animate:!0})}),[B,k.open,w,P]),(0,o.useEffect)((()=>{const e=l.current;if(e){const t=e=>{P({target:k.closed,animate:!0})};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)}}),[l,k.closed,P,n]);const R=(0,o.useCallback)((()=>{var e;return null===(e=d().A.MenuScroller)||void 0===e?void 0:e.getNode()}),[]),L=(0,o.useRef)(0),D=(0,o.useRef)(0),N=(0,o.useRef)(void 0),O=(0,o.useRef)(0),E=(0,o.useRef)(!1),U=(0,o.useRef)(!1),F=(0,o.useCallback)((e=>{E.current=!1,U.current=!1,N.current=void 0;const t={open:.3*A,half:A*(v?.55:.65)},n={open:A*(v?.3:.4)},o=Math.max(0,Date.now()-O.current),i=(w.current-L.current)/o;let s;s=i<-.5?k.open:i>1?M&&w.current<t.half?k.half:k.closed:M?w.current<t.open?k.open:w.current<t.half?k.half:k.closed:w.current<n.open?k.open:k.closed,void 0!==s&&P({target:s,animate:!0})}),[v,M,A,w,P,k]);(0,o.useEffect)((()=>{if(b&&!v&&!y&&!x&&!p().q.state.attached)return S.current=!0,p().q.update((e=>({...e,attached:!0}))),()=>{S.current=!1,p().q.update((e=>({...e,attached:!1})))}}),[b,v,y,x,w,A,k.half]);const K=(0,o.useCallback)((e=>{var t,n;const o=e.touches[0].clientY-D.current,i=o<0,s=N.current?e.touches[0].clientY-N.current:void 0;if(N.current=e.touches[0].clientY,0!==((null===(t=R())||void 0===t?void 0:t.scrollTop)??0)){U.current=!0;const e=R();return void(!i&&e&&s&&e.scrollBy({top:-s}))}if(U.current)return;const r=(null===(n=R())||void 0===n?void 0:n.clientHeight)??0;if(i&&r<k.half-17-100)return;if(i&&0===w.current)return;e.preventDefault(),e.stopPropagation(),E.current=!0;const a=Math.max(0,L.current+o);P({target:a,animate:!1})}),[w,P,k.half,R]),V=(0,o.useCallback)((e=>{"transform"===e.propertyName&&m().KP.setState(!0)}),[]),z=(0,o.useCallback)((e=>{"transform"===e.propertyName&&m().KP.setState(!1)}),[]),W=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const e=W.current;if(e)return e.addEventListener("touchmove",K),e.addEventListener("transitionrun",V),e.addEventListener("transitionend",z),()=>{e.removeEventListener("touchmove",K),e.removeEventListener("transitionrun",V),e.removeEventListener("transitionend",z)}}),[K,V,z]),(0,g.jsx)("div",{role:"none",ref:W,style:{...C,willChange:"transform"},onTransitionEnd:e=>{"transform"===e.propertyName&&w.current===k.closed&&(u(0),null==n||n(e))},onTouchStart:e=>{L.current=w.current,D.current=e.touches[0].clientY,O.current=Date.now(),w.current>0&&(E.current=!0)},onTouchEnd:F,children:(0,g.jsxs)("div",{role:"dialog","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy,"aria-modal":!!e.trapFocus||void 0,style:{...T.sheet,pointerEvents:E.current?"none":"auto",touchAction:E.current?"none":"auto"},children:[(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:T.dragHandle},"drag-spacer"),(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",height:`calc(var(--full-viewport-height) - 17px - ${j})`},children:e.children})]},"content")},"sheet")}},338008:(e,t,n)=>{n.d(t,{A:()=>x});n(725707),n(500234),n(113085);var o=n(242343),i=()=>n(237385),s=()=>n(721778),r=()=>n(133763),a=()=>n(870099),l=()=>n(735432),d=()=>n(53664),c=()=>n(803290),u=()=>n(172470);var m=()=>n(37394),p=()=>n(420797),g=()=>n(836331),f=()=>n(13889),h=()=>n(332284),v=()=>n(182613),y=()=>n(668261),b=n(163643);function x(e){const t=(0,i().v3)(),a=(0,r().J)(),[l,d]=(0,o.useState)([]),m=(0,c().K8)((()=>u().A.state.initialRenderCompleted),[]);(0,o.useEffect)((()=>{(async()=>{if(m){const{lowPriActionsWithKeyboardShortcuts:e}=await Promise.all([n.e(96159),n.e(96346),n.e(36209),n.e(92845),n.e(71718),n.e(15498)]).then(n.bind(n,898094));d(e)}})()}),[m]);const p=(0,o.useRef)(),g=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===p.current&&e.clientY===g.current||(p.current=e.clientX,g.current=e.clientY,f().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const h=(0,o.useMemo)((()=>[...s().D0,...l]),[l]),v=(0,o.useMemo)((()=>function(e,t,n){const o={};for(const i of t)for(const s of i.shortcuts)o[s]=o=>M(s,o,e,t,n);return o}(t,h,a)),[t,h,a]);return(0,b.jsx)(y().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:v})}function S(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(p().A.state.isActive&&!g().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function M(e,t,n,o,i){if(!S())return;const s=v().default.state.stores,r=v().default.state.pivot||s[0],c=r&&m().T.getRectFromStore(r),u=o.find((t=>!!t.shortcuts.some((t=>t===e))&&l().F6(t,{environment:n,blocks:s,originRect:c,publicEditMode:void 0})));if(u){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=p().A.state.isActive;u.action({environment:n,blocks:s,originRect:c,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",lazyDependencies:i},t);const o=s[0];let r,l,m,v;var y;if(o)r=o.getType(),l=r?(0,d().Yt)(r,o.getFormat()):void 0,m=null===(y=o.getCollectionStore())||void 0===y?void 0:y.id,v=o.getParentCollectionIdUpToTwoLevels();(0,a().N)(n,{analyticsName:u.analyticsName,action_type:u.analyticsActionType,from:"keyboard_shortcut",block_id:null==o?void 0:o.id,block_type:r,is_toggleable:l,collection_id:m,parent_collection_id:v}),b={resetBlockMenuStore:e},f().A.setKeyboardMode(!0),h().default.reset(),g().default.checkGate({gateName:"block_menu_shortcut_fix"})&&b.resetBlockMenuStore&&p().A.reset()}var b}},344393:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{active:!1,stringValue:""}}}const i=new o},353509:(e,t,n)=>{n.d(t,{E:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("microphone",{viewBox:"0 0 17 25",svg:(0,o.jsx)("path",{d:"M0.20752 12.0743C0.20752 13.5496 0.511882 14.853 1.12061 15.9845C1.72933 17.116 2.57438 18.0219 3.65576 18.7023C4.73714 19.3826 5.98324 19.7908 7.39404 19.9269V22.129H3.45166C3.17236 22.129 2.93245 22.2257 2.73193 22.4191C2.53141 22.6196 2.43115 22.8595 2.43115 23.1388C2.43115 23.4109 2.53141 23.6437 2.73193 23.837C2.93245 24.0376 3.17236 24.1378 3.45166 24.1378H13.313C13.5923 24.1378 13.8322 24.0376 14.0327 23.837C14.2332 23.6437 14.3335 23.4109 14.3335 23.1388C14.3335 22.8595 14.2332 22.6196 14.0327 22.4191C13.8322 22.2257 13.5923 22.129 13.313 22.129H9.37061V19.9269C10.7814 19.7908 12.0239 19.3826 13.0981 18.7023C14.1795 18.0219 15.0246 17.116 15.6333 15.9845C16.242 14.853 16.5464 13.5496 16.5464 12.0743V9.94739C16.5464 9.66809 16.4461 9.43176 16.2456 9.2384C16.0522 9.04504 15.8159 8.94836 15.5366 8.94836C15.2573 8.94836 15.0174 9.04504 14.8169 9.2384C14.6164 9.43176 14.5161 9.66809 14.5161 9.94739V11.9991C14.5161 13.2166 14.2583 14.2837 13.7427 15.2003C13.2271 16.1098 12.5109 16.8152 11.5942 17.3165C10.6776 17.8178 9.60693 18.0685 8.38232 18.0685C7.16488 18.0685 6.09424 17.8178 5.17041 17.3165C4.24658 16.8152 3.52686 16.1098 3.01123 15.2003C2.50277 14.2837 2.24854 13.2166 2.24854 11.9991V9.94739C2.24854 9.66809 2.14827 9.43176 1.94775 9.2384C1.74723 9.04504 1.50374 8.94836 1.21729 8.94836C0.94515 8.94836 0.708822 9.04504 0.508301 9.2384C0.30778 9.43176 0.20752 9.66809 0.20752 9.94739V12.0743ZM8.38232 15.8448C9.10563 15.8448 9.75016 15.6766 10.3159 15.34C10.8888 14.9962 11.3364 14.5236 11.6587 13.922C11.9881 13.3204 12.1528 12.6222 12.1528 11.8273V4.59778C12.1528 3.80286 11.9881 3.10461 11.6587 2.50305C11.3364 1.90149 10.8888 1.43241 10.3159 1.09583C9.75016 0.752075 9.10563 0.5802 8.38232 0.5802C7.65902 0.5802 7.0109 0.752075 6.43799 1.09583C5.87223 1.43241 5.42464 1.90149 5.09521 2.50305C4.76579 3.10461 4.60107 3.80286 4.60107 4.59778V11.8273C4.60107 12.6222 4.76579 13.3204 5.09521 13.922C5.42464 14.5236 5.87223 14.9962 6.43799 15.34C7.0109 15.6766 7.65902 15.8448 8.38232 15.8448Z"})})},364602:(e,t,n)=>{n.d(t,{R:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("eyeHide",{viewBox:"0 0 16 12",svg:(0,o.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},379470:(e,t,n)=>{n.d(t,{X:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})})},382445:(e,t,n)=>{n.d(t,{F:()=>d});n(242343);var o=()=>n(237385),i=()=>n(174114),s=()=>n(129808),r=()=>n(569434),a=()=>n(983050),l=n(163643);function d(e){let{}=e;const{isElectronMac:t}=(0,o().Y0)(),n=function(e){return(0,i().IS)((t=>({container:{display:"flex",justifyContent:"flex-end",alignItems:"center",paddingRight:10,height:(0,s().ek)(e)},unexpand:{borderRadius:4,width:28,height:28},hoveredUnexpand:{fill:t.text.primary,background:t.sidebarItemSelectedBackground}})),[e])}(t);return(0,l.jsx)("div",{style:n.container,className:a().sbV,children:(0,l.jsx)("div",{className:a().qGl,children:(0,l.jsx)(r().I,{style:n.unexpand,hoveredStyle:n.hoveredUnexpand})})})}},392863:(e,t,n)=>{n.d(t,{C:()=>f});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(682369),a=()=>n(435819),l=()=>n(922172),d=()=>n(330358),c=()=>n(689248),u=()=>n(148732),m=()=>n(266963),p=()=>n(777864),g=n(163643);function f(e){const{message:t}=e,n=(0,i().v3)(),f=(0,s().K8)((()=>!d().A.state.open&&!n.device.isMobile),[n]),h=(0,s().K8)((()=>f&&m().default.isVisible(t.key)),[t,f]);(0,r().A)((()=>{u().DL(n,{callout_key:t.key,placement_key:"Modal"})}),h);const v=(0,o.useCallback)((()=>{u().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),c().OX(n,t)}),[n,t]),y=(0,o.useCallback)(((e,o)=>()=>{u().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==o||o()}),[n,t]);let b;var x;e.primary&&(b={...e.primary,onClick:y("primary_cta",null===(x=e.primary)||void 0===x?void 0:x.onClick)});let S;var M;e.secondary&&(S={...e.secondary,onClick:y("secondary_cta",null===(M=e.secondary)||void 0===M?void 0:M.onClick)});let A;var w;e.link&&(A={...e.link,onClick:y("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return h?(0,g.jsx)(l().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:v,render:()=>(0,g.jsx)(a().A,{capture:!0,allowEsc:!0,render:()=>(0,g.jsx)(p().T,{...e,onDismiss:v,primary:b,secondary:S,link:A})})}):null}},394156:(e,t,n)=>{n.d(t,{L:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},406073:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{open:!1}}}const i=new o},421761:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(129978);const i=new(o().O2)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(9304),n.e(92011),n.e(38482),n.e(89693),n.e(67780),n.e(96933),n.e(34983),n.e(21377)]).then(n.bind(n,494260)))),s=(0,o()._h)(i,(e=>e.UpdateSidebarTabInfo))},423162:(e,t,n)=>{n.r(t),n.d(t,{checkmarkCircleIcon:()=>s,iconDefinition:()=>i});n(242343);var o=n(163643);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M12.876 7.982a.625.625 0 1 0-1.072-.644L9.25 11.595 7.815 9.92a.625.625 0 0 0-.95.813l2 2.334a.625.625 0 0 0 1.01-.085z"}),(0,o.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},s=(0,n(680369).wt)("checkmarkCircle",i)},429392:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(242343),i=()=>n(803290),s=()=>n(486540),r=()=>n(653998),a=()=>n(145046),l=()=>n(919536),d=()=>n(990616),c=()=>n(944498),u=()=>n(378219),m=()=>n(35462),p=n(163643);const g=function(e){let{store:t}=e;const g=(0,n(174114).DP)(),f=(0,n(237385).v3)(),h=(0,o.useMemo)((()=>({environment:f,blocks:[t],publicEditMode:void 0})),[f,t]),v=(0,i().K8)((()=>c().Uo6([c().Ezz,c().AU6(c().p2L)])(h)),[h]),y=(0,i().K8)((()=>c().Uo6([c()._mr,c().AU6(c().Km9)])(h)),[h]);if(v){const{device:e}=f;return(0,p.jsx)("div",{style:{backgroundColor:g.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${g.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,p.jsxs)(n(126451).A,{disabled:!y,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),o=u().KA(e),i=o?s().wD(u().E(o)):[],c=s().Cd(e.getModel(),n,i),m={type:"restore",permissionChanges:c},{accept:g}=await a().Gh({message:(0,d().r6)(m),acceptLabel:(0,d().QU)(m),cancelLabel:(0,p.jsx)(r().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,p.jsx)(d().f2,{openState:m})});g&&l().YD({environment:t,store:e})}(t,f),children:[(0,p.jsx)(m().A,{isMultiline:!0,isSmall:!0,children:(0,p.jsx)(r().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),y&&(0,p.jsx)(m().A,{style:{marginTop:6,fontWeight:n(31448).Wy.semibold},children:(0,p.jsx)(r().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})}return null}},433330:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>oo});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(862279),l=()=>n(397257),d=()=>n(653998),c=()=>n(76394),u=()=>n(615917),m=()=>n(356813),p=()=>n(142708),g=()=>n(138045),f=()=>n(103151),h=()=>n(610271),v=()=>n(502852),y=()=>n(477784),b=()=>n(907721),x=()=>n(98508),S=()=>n(272690),M=()=>n(365262),A=()=>n(267911),w=()=>n(448488),k=()=>n(521972),j=()=>n(83544),C=()=>n(810111),I=()=>n(875089),T=()=>n(670481),_=()=>n(31448),P=()=>n(817150),B=()=>n(927999),R=()=>n(84543),L=()=>n(113915),D=()=>n(932322),N=()=>n(431551),O=()=>n(957356),E=()=>n(129978);const U={switchFromSimpleToTabbedLayoutActions:new(E().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,568804)))),switchFromTabbedToSimpleLayoutActions:new(E().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,292152)))),createRelationViewsModuleActions:new(E().O2)("createRelationViewsModuleActinos",(async()=>Promise.resolve().then(n.bind(n,478235)))),deleteViewsModuleDependenciesActions:new(E().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,477267))))};n(362833),n(403517);var F=()=>n(564134),K=()=>n(916963),V=()=>n(680369),z=n(163643);const W=(0,V().wt)("propertyText",{viewBox:"0 0 26 17",svg:(0,z.jsx)("path",{d:"M0.066 16V15.296L1.342 14.79L6.688 1.282L7.436 1.172L8.206 0.952L13.266 14.79L14.762 15.274V16H9.108V15.274L10.978 14.768L9.636 10.918H4.268L2.992 14.504L5.104 15.274V16H0.066ZM6.974 3.372L4.752 9.598H9.174L6.996 3.372H6.974ZM18.5422 16.33C17.3762 16.33 15.9022 15.516 15.9022 13.756C15.9022 11.996 17.1782 11.204 19.4442 10.61L21.7102 10.016V8.872C21.6662 7.178 20.7862 6.298 19.6202 6.298C18.9602 6.298 18.4102 6.584 18.2342 6.694L18.1462 8.872C18.1462 8.872 17.5962 8.938 17.2662 8.938C16.5622 8.938 16.2102 8.586 16.2102 7.992C16.2102 6.98 18.1462 5.374 20.4122 5.374C22.6342 5.374 23.6022 6.386 23.6022 8.564V14.504C23.6022 14.944 23.7122 15.098 24.3282 15.098H25.4282V15.714C25.4282 15.714 24.1522 16.264 23.3382 16.264C22.2162 16.264 21.7542 15.494 21.7542 14.548H21.6882C20.4562 15.714 19.9282 16.33 18.5422 16.33ZM19.7082 14.834C20.7642 14.834 21.4462 14.042 21.7102 13.646V10.742L19.5982 11.446C18.5642 11.798 17.9042 12.216 17.9042 13.14C17.9042 14.262 18.7622 14.834 19.7082 14.834Z"})});var H=()=>n(668657),G=()=>n(535906),Y=()=>n(401382),q=()=>n(858023),$=()=>n(88271),Q=()=>n(749975),Z=()=>n(206183),X=()=>n(546820),J=()=>n(220865),ee=()=>n(728373),te=()=>n(113805);function ne(e){const{propertyId:t,propertyType:n,environment:o,transaction:i,layoutStore:s,collectionStore:r,currentModuleSelection:a,sessionId:l,isPropertyCreation:d}=e,c=s.getModel(),u=r.getModel();if(!c||!u||"new_module"!==(null==a?void 0:a.type))return;const m={id:(0,ee().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?m.config={property_person:{style:"compact"}}:"number"===n&&(m.config={property_number:{style:"large"}}),"form_conditional_modules"===a.area)return;const p=(0,J().dI)({collectionModel:u,module:m});return(0,te().UQ)({environment:o,transaction:i,layoutStore:s,position:"views_main_tab_modules"===a.area?{type:"area_relative",area:a.area,viewId:a.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:a.area,location:"end_moveable"},module:p,sessionId:l,isPropertyCreation:d}),m}function oe(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:s,setModuleSelection:r,sessionId:a}=(0,X().LH)(),{collectionStore:l}=(0,X().bi)();return(0,o.useCallback)((o=>{let{propertyType:i,isPropertyCreation:d}=o;const{performResult:c}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const r=t.getModel(),c=l.getModel();if(!r||!c||"new_module"!==(null==s?void 0:s.type))return;return ne({propertyId:n(154956).IL({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:Z().dC[i],propertyType:i,transaction:o}),propertyType:i,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:s,sessionId:a,isPropertyCreation:d})}});c&&r({type:"existing_module",moduleId:c.id,isDragging:!1})}),[e,r,t,l,s,a])}function ie(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:s,sessionId:r}=(0,X().LH)(),{collectionStore:a}=(0,X().bi)();return(0,o.useCallback)((o=>{const{propertyId:i,propertyType:l}=o,{performResult:d}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:o=>ne({propertyId:i,propertyType:l,environment:e,transaction:o,layoutStore:t,collectionStore:a,currentModuleSelection:n,sessionId:r,isPropertyCreation:!1})});return d?(s({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,s,t,a,n,r])}n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601),n(725707),n(491955);var se=()=>n(716605),re=()=>n(946854),ae=()=>n(712923);function le(e){return void 0!==e[1]}function de(e){let{propertySortPriority:t,defaultCount:i,moreButtonStyle:r,moreButtonTitleStyle:a,isSearching:l}=e;const{layoutStore:u}=(0,X().LH)(),{collectionStore:m}=(0,X().bi)(),p=(0,ae().h)(),g=(0,s().K8)((()=>{const e=u.getModules();return new Set((0,n(563241).Q)(e).filter(re().gx).map((e=>e.propertyId)))}),[u]),[f,h]=o.useState(!1);return(0,s().K8)((()=>{const e=m.getSchema();if(!u.getModel())return[];const o=(0,c().WP)(e).filter(le).sort(((e,n)=>{const o=e[1],i=n[1];return(t[o.type]??1/0)-(t[i.type]??1/0)})).map((e=>{let[t,o]=e;if(t!==F().rn&&!g.has(t))return(0,F().JY)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"compact"}:(0,F().AM)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"large"}:"formula"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:(0,n(61014).isNumberFormulaPropertySchema)(o)?"large":"small"}:"file"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"landscape"}:{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t}})).filter(c().O9).map((t=>{const o=(0,se()._g)({schema:e,property:t.propertyId});if(o)return{key:t.id,keywords:[o.name,Z().dC[o.type]],render:e=>{let{ref:o,...i}=e;return(0,z.jsx)(n(886712).k,{...i,propertyId:t.propertyId})},action:()=>{p({layoutModule:t})}}})).filter(c().O9),s={keywords:[],key:"use-existing-property-show-more",render:e=>(0,z.jsx)(G().A,{...e,buttonStyle:r,desktopTitleStyle:a,title:f?(0,z.jsx)(d().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,z.jsx)(d().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>h((e=>!e))};return o.length>i&&!l?[...f?o:o.slice(0,i),s]:o}),[p,m,u,g,t,i,f,r,a,l])}var ce=()=>n(582646);function ue(e){const{propertyId:t}=e,{collectionStore:n}=(0,X().bi)(),o=(0,r().DP)(),i=(0,s().K8)((()=>{const e=n.getSchema();return(0,se()._g)({schema:e,property:t})}),[n,t]);return i?(0,z.jsx)(ce().A,{...e,icon:(0,z.jsx)(K().zB,{size:16,theme:o,icon:i.icon,type:i.type}),name:i.name}):null}function me(){const{layoutStore:e,currentModuleSelection:t}=(0,X().LH)(),{collectionStore:r}=(0,X().bi)(),a=(0,n(622286).X)("collection_view_module"),l=(0,i().v3)(),d=(0,ae().h)(),u=(0,o.useCallback)((t=>{const o=(0,n(478235).createRelationViewsModule)({environment:l,collectionStore:r,relationPropertyId:t,layoutStore:e});o&&d({layoutModule:o})}),[d,r,e,l]),m=(0,s().K8)((()=>"new_module"===(null==t?void 0:t.type)&&"page_details"===t.area),[t]);return(0,s().K8)((()=>{if(!a||m)return[];const t=r.getSchema();if(!e.getModel())return[];return Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,F().nC)(n)&&(0,c().O9)(n.property)})).map((e=>{const n=(0,se()._g)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...o}=t;return(0,z.jsx)(ue,{...o,propertyId:e})},action:()=>{u(e)}}})).filter(c().O9)}),[a,m,r,e,u])}const pe=(0,d().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),ge={file:{icon:j().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:j().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:pe.propertyFileCaption}},ai_summary:{icon:j().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:pe.propertyAiSummaryCaption}},person:{icon:j().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:pe.propertyPersonCaption}},text:{icon:W,tooltip:{image:j().A.images.tooltips.blocks.textPng,caption:pe.propertyTextCaption}},number:{icon:j().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:pe.propertyNumberCaption}}},fe={file:1,ai_summary:2,number:3,text:4,person:5},he=o.memo((function(){const e=(0,i().v3)(),t=(0,r().DP)(),a=(0,d().tz)(),{currentModuleSelection:l,isPropertyTypeSearchInputDirtyStore:c}=(0,X().LH)(),u=(0,Q().ET)(),m="new_module"===(null==l?void 0:l.type)&&"page_details"===l.area,p=(0,s().K8)((()=>[...(0,Z().xm)({collectionContextStore:u,environment:e}),"ai_summary"].sort(((e,t)=>(fe[e]??1/0)-(fe[t]??1/0)))),[u,e]),g=me(),[f,v]=(0,o.useState)(!1),[y,b]=(0,o.useState)(),x=(0,o.useCallback)((e=>{c.setState(!0),b(e.target.value)}),[c]);o.useEffect((()=>()=>{c.setState(!1)}),[c]);const S=oe(),M=ie(),A=(0,o.useMemo)((()=>({actionHandler:e=>S({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=ge[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=ge[e],o="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return o&&"string"!=typeof o?o({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,K().P0)({theme:t,willShowOnTooltip:!1})}):(0,z.jsx)(K().zB,{size:o?36:16,theme:t,type:e,icon:o,style:{fill:(0,F().hN)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,F().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{M({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[S,t,M]),w=(0,n(171326).g)(A),k=(0,r().IS)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,marginLeft:8,paddingBottom:2},searchInputContainer:{marginTop:8,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.mediumIconColor,width:10},moreButton:{marginLeft:0},moreButtonTitle:{margin:0,color:e.text.tertiary,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),j=(0,s().K8)((()=>{const e=y||f,t={keywords:[],key:"create-new-property-more",render:e=>(0,z.jsx)(G().A,{...e,buttonStyle:k.moreButton,desktopTitleStyle:k.moreButtonTitle,title:f?(0,z.jsx)(d().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,z.jsx)(d().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>v((e=>!e))};return[...p.slice(0,e?void 0:5).map(w),...y?[]:[t]]}),[p,f,w,y,k.moreButton,k.moreButtonTitle]),C=de({propertySortPriority:fe,defaultCount:4,moreButtonStyle:k.moreButton,moreButtonTitleStyle:k.moreButtonTitle,isSearching:Boolean(y)}),I=(0,o.useMemo)((()=>{const e=[];return C.length>0&&e.push({key:"existing-properties",render:e=>(0,z.jsx)($().A,{title:a.formatMessage(pe.existingPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:C}),e.push({key:"create-new-properties",render:e=>(0,z.jsx)($().A,{title:a.formatMessage(pe.createNewPropertyModuleSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:j}),g.length>0&&e.push({key:"related-collection-properties",render:e=>(0,z.jsx)($().A,{title:a.formatMessage(pe.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:g}),e}),[j,C,a,g,k.sectionTitle]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(h().Ye,{style:k.sidebarHeading,alignItems:"center",children:(0,z.jsx)(d().sA,{...m?pe.addToPanel:pe.addToPage})}),(0,z.jsx)(Y().Ay,{focusInitial:!0,onChange:x,placeholder:a.formatMessage(pe.searchInputPlaceholder),showClearButton:!0,value:y||"",style:k.searchInputContainer,inputOuterStyle:k.searchInput,inputLeft:(0,H().q)(k.searchInputIcon),itemMarginLeft:0}),(0,z.jsx)(n(777010).j,{filterQuery:y,initialFocus:0,type:q().Oh.Vertical,sections:I})]})}));var ve=()=>n(800057),ye=(n(771702),()=>n(530075)),be=()=>n(896433),xe=()=>n(474473),Se=(n(324989),n.n(n(567012))),Me=()=>n(129044),Ae=()=>n(951592),we=()=>n(73792),ke=()=>n(487121),je=()=>n(96297);function Ce(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:r}=e,a=o.useMemo((()=>Me().default.createValue("")),[]),[l,d]=o.useState([]),[c,u]=o.useState({}),[m,p]=o.useState(null),g=o.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(r);return n&&(e=e.filter((e=>!n.has(e)))),e}),[r,t,n]),f=(0,s().O$)(a),h=(0,Ae().lW)(f,100,((e,t)=>e===t));o.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of g){const o=r[n];o&&null!==Se().match(h,o.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[g,l,h,r]),o.useEffect((()=>{if(0===l.length)return void p(null);const e=null!==m?l[m]:null;e&&void 0!==c[e]?p(c[e]):p(0)}),[m,l,c]);const v=(0,i().v3)(),y=null!==m?l[m]:null;return o.useEffect((()=>{const e=document.getElementsByClassName(we().wT).item(0);e&&!(0,ke().E)({element:e})&&(0,je().uf)({el:e,environment:v,windowHeight:window.innerHeight,minEdgeDist:16})}),[v,y]),{searchInputValueStore:a,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:m,moveToNextSearchMatch:()=>{if(null===m||l.length<=1)return;const e=m+1;p(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===m||l.length<=1)return;const e=m-1;p(e>=0?e:l.length-1)}}}var Ie=()=>n(356418);function Te(e){let{propertyGroupId:t,pagePropertiesStore:n}=e;const{collectionStore:o}=(0,X().bi)(),i=(0,r().IS)((e=>({button:{color:e.text.secondary,paddingLeft:8,height:34},buttonIcon:{fill:e.icon.secondary,marginRight:8}})),[]);return(0,z.jsx)(Ie().Xt,{style:i.button,iconStyle:i.buttonIcon,collectionStore:o,isInPeekRenderer:!1,propertyGroupId:t,pagePropertiesStore:n})}const _e=o.memo(Te);n(610931);var Pe=()=>n(175532),Be=()=>n(259849),Re=()=>n(949712),Le=()=>n(52531),De=()=>n(34662),Ne=()=>n(975392),Oe=()=>n(209684),Ee=()=>n(273520),Ue=()=>n(369515),Fe=()=>n(441292),Ke=()=>n(59175),Ve=()=>n(935091),ze=()=>n(443252),We=()=>n(951540),He=()=>n(640979),Ge=()=>n(962373),Ye=()=>n(801600);class qe extends Me().default{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const $e=new qe;function Qe(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:a,isLastPropertyGroup:l,styles:c}=e,u=(0,s().uB)(void 0,Ge().A),m=(0,s().K8)((()=>$e.isRenameInputForcedOpenForGroup(n)),[n]),[p,g]=(0,o.useState)(m);(0,o.useEffect)((()=>{u.setState({...u.state,open:m})}),[u,m]);const f=(0,o.useCallback)((()=>{g(!1),$e.resetForceRenameInputOpen()}),[]),h=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),y=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),x=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==c?void 0:c.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginRight:"auto",paddingLeft:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.text.secondary,fontWeight:500,padding:"0 8px 0 5px",display:"block",..._().RC},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[c]);return(0,z.jsx)("div",{style:x.container,children:(0,z.jsx)(Ee().Ay,{style:{width:268},onClose:f,popupType:ze().nl.Popup,renderOrigin:e=>(0,z.jsxs)(Oe().p,{...e,style:x.titleContainer,children:[(0,z.jsx)(Ue().A,{iconSize:12,iconStyle:x.dragIcon}),(0,z.jsx)("div",{style:x.label,children:t})]}),buttonPopupStore:u,alignmentToOrigin:b().C.Start,render:e=>{return p?(0,z.jsx)(Ze,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,z.jsx)(Ve().A,{menuType:He().gu.Popup,children:(0,z.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,z.jsx)($().A,{...e}),items:(o=e.close,(0,Ne().oE)([{key:"rename",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,Re().j)(x.menuIcon),title:(0,z.jsx)(d().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{g(!0)}},!a&&{key:"move-up",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,Be().q)(x.menuIcon),title:(0,z.jsx)(d().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{v(n),o()}},!l&&{key:"move-down",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,Pe().P)(x.menuIcon),title:(0,z.jsx)(d().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{y(n),o()}},{key:"delete",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,Le().I)({width:16,height:16}),title:(0,z.jsx)(d().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,z.jsx)(d().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{h(n),o()}}]))}]})});var o}})})}function Ze(e){let{propertyGroupId:t,afterSubmit:n,value:s}=e;const[a,l]=(0,o.useState)(s),c=(0,r().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),u=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)(((n,o)=>{const i=e.getNormalizedPropertyGroups();if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const s=i.map((e=>e.id===n?{...e,title:o}:e));R().createAndCommit({environment:t,perform(t){B().zA({stores:[e],update:{property_groups:s},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),m=(0,o.useCallback)((()=>{const e=(0,De().xV3)(a).trim();0!==e.length&&(u(t,e),n())}),[n,u,a,t]),p=(0,o.useCallback)((e=>{l(e.target.value)}),[]);return(0,z.jsx)(Fe().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,z.jsxs)("div",{style:c.container,children:[(0,z.jsx)(Ke().A,{style:c.input,onSubmit:m,selectAll:!0,value:a,onChange:p,focusInitial:!0}),(0,z.jsx)(We().A,{style:c.button,onClick:m,children:(0,z.jsx)(d().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var Xe=()=>n(750221),Je=()=>n(97787);n(358848);function et(e){let{sections:t,onDrop:n,renderKey:i,getInvalidDropIndices:s,direction:a}=e;const[l,d]=o.useState({type:"notDragging"}),u=(0,o.useMemo)((()=>{const e={};for(const n of t)e[ot(n.key)]=n;return e}),[t]),m=(0,o.useCallback)((e=>(0,c().O9)(u[ot(e)])),[u]),p=(0,o.useMemo)((()=>t.flatMap((e=>[e.key,...e.items]))),[t]),g=(0,o.useMemo)((()=>p.map(ot)),[p]),f=(0,o.useMemo)((()=>{const e={};for(const t of p)e[ot(t)]=t;return e}),[p]),h=o.useCallback(((e,o)=>{let{key:i}=o;m(i)?n({newSections:nt({orderedSectionKeys:e.filter(m),originalSections:t}),droppedKey:i,isSection:!0}):n({newSections:tt({flattenedKeys:e.map((e=>f[e])),getIsSection:m}),droppedKey:i,isSection:!1})}),[m,n,t,f]),v=o.useCallback((e=>{m(e)?d({type:"draggingSection",key:e}):d({type:"draggingItem",key:e})}),[m]),y=o.useCallback((()=>d({type:"notDragging"})),[]),b=(0,o.useCallback)((e=>{let t;t=m(e)?new Set(p.flatMap(((e,t)=>m(e)?[]:[t]))):new Set([0]);const n=null==s?void 0:s({flattenedKeys:g,...m(e)?{isSection:!0,key:e}:{isSection:!1,key:e}});return n?new Set([...t,...n]):t}),[s,m,p,g]),x=(0,r().IS)((e=>{const t={opacity:1,transition:"opacity 0.2s ease"},n={...t,opacity:.7};return{container:{},undraggedSection:t,draggedSection:n,undraggedItem:{...t,width:"100%"},draggedItem:{...n,width:"100%"},itemInDraggedSection:{...t,opacity:0,width:"100%"}}}),[]),S=(0,o.useMemo)((()=>{const e="draggingSection"===l.type?l.key:void 0,n="draggingItem"===l.type?l.key:void 0,o={};return t.forEach(((t,n)=>{const s=ot(t.key),r=e===s;o[s]=(0,z.jsx)("div",{style:r?x.draggedSection:x.undraggedSection,children:i({key:s,isDraggable:it(t.key),isSection:!0,sectionIndex:n,sectionLength:t.items.length})})})),t.forEach(((t,s)=>{const r=e===ot(t.key);return t.items.forEach(((e,a)=>{const l=n===ot(e),d=t.items.length,c=ot(e);o[c]=(0,z.jsx)("div",{style:l?x.draggedItem:r?x.itemInDraggedSection:x.undraggedItem,children:i({key:ot(e),isDraggable:it(e),isSection:!1,sectionIndex:s,itemIndex:a,sectionLength:d})})}))})),o}),[l,i,t,x.draggedItem,x.draggedSection,x.itemInDraggedSection,x.undraggedItem,x.undraggedSection]);return(0,z.jsx)(Je().Ay,{style:x.container,direction:a,keys:p,renderKey:e=>S[e],onDraggingKeyChanged:v,onDragEnd:y,onDrop:h,getInvalidDropIndices:b})}function tt(e){let{flattenedKeys:t,getIsSection:n}=e;const o=function(e){let{orderedList:t,getIsSection:n}=e;const o=t.findIndex((e=>n(e)));if(-1===o||0===o)return t;return[t[o],...t.slice(0,o),...t.slice(o+1)]}({orderedList:t,getIsSection:n}),i=[];for(const s of o)if(n(s))i.push({key:s,items:[]});else{const e=s,t=i.at(-1);t&&t.items.push(e)}return i}function nt(e){let{orderedSectionKeys:t,originalSections:n}=e;const o={};for(const i of n)o[ot(i.key)]={key:i.key,items:i.items};return t.flatMap((e=>o[e]?[o[e]]:[]))}function ot(e){return"string"==typeof e?e:e.key}function it(e){return"string"==typeof e||(e.draggable??!0)}const st=o.memo(et);function rt(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:i}=e,{collectionStore:r}=(0,X().bi)(),a=(0,s().K8)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,o.useCallback)(((e,t)=>i({propertyId:e,rowIndex:t})),[i]),d=(0,be().Od)({collectionStore:r,format:t});return a?(0,z.jsx)(Je().Ay,{keys:a,onDrop:d,direction:"vertical",renderKey:l}):null}function at(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:r}=e,a=(0,i().v3)(),{collectionStore:l}=(0,X().bi)(),d=(0,s().K8)((()=>l.getNormalizedPropertyGroups()??[]),[l]),u=(0,o.useMemo)((()=>Object.fromEntries(d.map((e=>[e.id,e])))),[d]),m=(0,s().K8)((()=>d.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,Xe().Op)(e.id)]}}))),[d]),p=(0,o.useCallback)((e=>{let{flattenedKeys:t,isSection:n}=e;return n?new Set(t.flatMap(((e,t)=>(0,c().O9)(u[e])?[]:[t]))):new Set(t.flatMap(((e,t)=>(0,Xe().k9)(e)?[t+1]:[])))}),[u]),g=(0,o.useCallback)((e=>{var o;return e.isSection?n({groupId:e.key,groupTitle:null===(o=u[e.key])||void 0===o?void 0:o.title,rowIndex:e.sectionIndex}):(0,Xe().k9)(e.key)?r((0,Xe().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[u,r,n,t]),f=(0,o.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,Xe().k9)(e))),o="string"==typeof e.key?e.key:e.key.key;return{id:o,title:null===(t=u[o])||void 0===t?void 0:t.title,propertyIds:n}}));R().createAndCommit({environment:a,perform(e){(0,Ye().Yf)({collectionStore:l,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[l,a,u]);return(0,z.jsx)(st,{direction:"vertical",sections:m,renderKey:g,onDrop:f,getInvalidDropIndices:p})}var lt=()=>n(573520),dt=()=>n(364602);const ct=(0,V().wt)("eyelash",{viewBox:"0 0 16 16",svg:(0,z.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var ut=()=>n(743661);function mt(e){let{collectionStore:t,pageStore:n,layoutModule:i,pagePropertiesStore:a,propertyId:l,draggable:d,rightButton:c,searchHighlighted:u}=e;const m=(0,s().K8)((()=>n.isNonEditableState()),[n]),{collectionSchema:p,collectionFormat:g,canEditCollection:f}=(0,s().K8)((()=>({collectionSchema:t.getSchema(),collectionFormat:t.getFormat(),canEditCollection:t.canEdit()})),[t]),h=(0,r().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingLeft:2}})),[]),v=(0,o.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),y=Boolean(u),b=Boolean(u&&u.active);return(0,z.jsxs)("div",{style:h.propertyRowContainer,children:[(0,z.jsx)(ut().I,{schema:p,styleVariants:v,format:g,property:l,collectionStore:t,disabled:!1,locked:m,canConfigureCollection:f,isInPeekRenderer:!1,hideDragHandle:!d,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginRight:2},blockStore:n,pagePropertiesStore:a,layoutModule:i,forceHighlight:y,forceFocusedHighlight:b}),c?c():null]})}function pt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:r,collectionStore:a,pageStore:l,searchHighlighted:c}=e,u=(0,d().tz)(),p=(0,i().v3)(),g=(0,s().K8)((()=>a.getSchema()),[a]),f=(0,s().K8)((()=>(0,I().L)(a.getFormat(),g,void 0,C().jf.Collection)),[a,g]),h=g[t],v=(0,o.useCallback)((e=>{R().createAndCommit({environment:p,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{P().D7({property:t,visibility:e,store:a,format:f,transaction:n})}})}),[f,a,p,t]),y="show"===(null==n?void 0:n.visibility)?lt().h:"hide_if_empty"===(null==n?void 0:n.visibility)?dt().R:ct,x="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!h)return null;return(0,z.jsx)(mt,{pageStore:l,collectionStore:a,propertyId:t,pagePropertiesStore:r,draggable:!0,rightButton:()=>(0,z.jsx)(Ee().Ay,{popupType:ze().nl.Popup,renderOrigin:e=>(0,z.jsx)(m().A,{ariaLabel:u.formatMessage(ft.visibilityToggleIconAriaLabel,{propertyName:h.name}),icon:y,isDarkIconColor:x,...e}),alignmentToOrigin:b().C.Start,render:e=>(0,z.jsx)(gt,{parentClose:e.close,setVisibilityOfProperty:v})}),searchHighlighted:c,layoutModule:e.layoutModule})}function gt(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,o.useMemo)((()=>[{key:0,render:e=>(0,z.jsx)($().A,{...e}),items:[{key:"always_show",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,lt().h)({width:16,height:16}),title:(0,z.jsx)(d().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,z.jsx)(G().A,{...e,icon:(0,dt().R)({width:16,height:16}),title:(0,z.jsx)(d().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,z.jsx)(G().A,{...e,icon:ct({width:16,height:16}),title:(0,z.jsx)(d().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,z.jsx)(Ve().A,{menuType:He().gu.Popup,children:(0,z.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:i})})}const ft=(0,d().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),ht=(0,d().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not Found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function vt(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:i,moveToNextSearchMatch:a,moveToPreviousSearchMatch:l}=e,c=(0,s().O$)(t),u=(0,d().tz)(),p=o.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),a()):"ArrowUp"===e.key?l():"ArrowDown"===e.key&&a()}),[a,l]),g=(0,r().IS)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginRight:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.mediumIconColor,width:10},searchInputOuter:{background:e.white}})),[]),f=o.useMemo((()=>{if(""!==c)return(0,z.jsxs)(h().Ye,{alignItems:"center",gap:8,children:[(0,z.jsx)("div",{children:null!==n?`${n+1} of ${i.length}`:u.formatMessage(ht.notFound)}),null!==n&&(0,z.jsxs)(h().Ye,{gap:0,alignItems:"center",children:[(0,z.jsx)(m().A,{icon:Pe().P,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonDownAriaLabel),onClick:a}),(0,z.jsx)(m().A,{icon:Be().q,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonUpAriaLabel),onClick:l})]})]})}),[c,n,i.length,u,g,a,l]);return(0,z.jsx)(Y().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:p,placeholder:u.formatMessage(ht.filterPropertiesInputPlaceholder),showClearButton:!0,value:c,inputLeft:(0,H().q)(g.searchInputIcon),inputOuterStyle:g.searchInputOuter,inputRightStyle:g.searchMatchCount,inputRight:f})}function yt(e){const{module:t}=e,{layoutStore:n}=(0,X().LH)(),{collectionStore:i,pageStore:a}=(0,X().bi)(),l=(0,s().K8)((()=>n.getModules()),[n]),d=(0,s().K8)((()=>i.getSchema()),[i]),u=(0,s().K8)((()=>(0,I().L)(i.getFormat(),d,void 0,C().jf.Collection)),[i,d]),m=(0,o.useMemo)((()=>new Set((0,ye().q)({modulesByArea:l,collectionSchema:d,collectionFormat:u}))),[u,l,d]),g=(0,o.useMemo)((()=>new(xe().YB)),[]),f=(0,s().K8)((()=>i.getNormalizedPropertyGroups()),[i]),v=(0,s().K8)((()=>{const e={};return null==f||f.forEach(((t,n)=>{e[t.id]=n})),e}),[f]),y=(0,be().z7)({store:a,format:u,schema:d,collectionStore:i}),b=(0,o.useMemo)((()=>{const e={};return y.forEach((t=>e[t.property]=t)),e}),[y]),{searchInputValueStore:S,searchMatches:M,searchMatchesMap:A,activeSearchMatchIndex:w,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j}=Ce({mergedPropertiesMap:b,propertyGroups:f,propertyIdsToExclude:m}),T=(0,o.useCallback)((e=>{let{propertyId:n}=e;if(m.has(n))return null;const o=void 0!==A[n]&&null!==w?{active:n===M[w]}:void 0;return(0,z.jsx)(pt,{propertyId:n,propertyFormat:b[n],collectionStore:i,pagePropertiesStore:g,pageStore:a,searchHighlighted:o,layoutModule:t})}),[w,i,b,t,g,a,m,M,A]),_=(0,o.useCallback)((e=>{let{groupId:t,groupTitle:n}=e;const o=v[t],i=0===o,s=(0,c().O9)(f)&&o===f.length-1,r={container:i?void 0:{marginTop:20}};return(0,z.jsx)(Qe,{title:n,propertyGroupId:t,isFirstPropertyGroup:i,isLastPropertyGroup:s,styles:r})}),[v,f]),P=(0,o.useCallback)((e=>(0,z.jsx)(_e,{propertyGroupId:e,pagePropertiesStore:g})),[g]),B=Boolean(y.length&&y.length>m.size),R=(0,r().IS)((e=>({addPropertyButtonContainer:{marginLeft:2,paddingBottom:8},container:{marginTop:B?4:8,height:"100%",overflow:"visible hidden",marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},searchInputContainer:{marginRight:Jt,marginLeft:Jt,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingLeft:6,paddingRight:6},listContainer:{padding:`0 ${Jt}px 56px`}})),[B]);return(0,z.jsxs)(h().wt,{style:R.container,children:[B&&(0,z.jsx)("div",{style:R.searchInputContainer,children:(0,z.jsx)(vt,{searchInputValueStore:S,activeSearchMatchIndex:w,searchMatches:M,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j})}),(0,z.jsx)(p().H,{type:x().A.Y,style:R.listContainer,children:Boolean(f)?(0,z.jsx)(at,{renderPropertyRow:T,renderPropertyGroupRow:_,renderAddPropertyButton:P}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(rt,{collectionFormat:u,mergedProperties:y,renderPropertyRow:T}),(0,z.jsx)("div",{style:R.addPropertyButtonContainer,children:(0,z.jsx)(_e,{pagePropertiesStore:g})})]})})]})}var bt=()=>n(280704),xt=()=>n(622163);const St=(0,d().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function Mt(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)(),n=(0,d().tz)(),s=(0,r().IS)((e=>({button:{fontSize:(0,xt().ny)(t,"UISmall"),color:e.text.secondary,padding:8,fontWeight:_().Wy.medium},icon:{fill:e.icon.secondary,marginRight:4}})),[t]),a=(0,o.useCallback)((()=>{const o=n.formatMessage(St.newSection),{performResult:i}=R().createAndCommit({environment:t,perform:t=>(0,Ye().PA)({collectionStore:e,newGroupTitle:o,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&$e.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,z.jsx)(Oe().p,{icon:bt().b,onClick:a,style:s.button,iconStyle:s.icon,children:(0,z.jsx)(d().sA,{...St.addSection})})}function At(e){const{title:t}=e;return(0,z.jsxs)(h().Ye,{justifyContent:"space-between",children:[t,(0,z.jsx)(Mt,{})]})}var wt=()=>n(521325),kt=()=>n(261603),jt=()=>n(475923);function Ct(e){return(0,z.jsx)("div",{style:{marginLeft:-8,marginRight:-8},children:e.children})}function It(e){let{module:t}=e;const{collectionStore:n}=(0,X().bi)(),i=(0,Q().ET)(),r=(0,s().K8)((()=>n.getSchema()),[n]),a=(0,s().K8)((()=>{if((0,re().gx)(t))return t}),[t]),l=(0,s().K8)((()=>a&&r[a.propertyId]),[a,r]);if((0,o.useEffect)((()=>{if(a)return wt().Ow({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1}),wt().dP({collectionSettingsStore:i.settingsStore,item:{type:"property",property:a.propertyId,formatKey:void 0}}),()=>{wt().os({collectionSettingsStore:i.settingsStore})}}),[i,a]),!l||!a)return null;const d=(0,z.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium},children:Z().dC[l.type]});return(0,z.jsx)(Ct,{children:(0,z.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:i.settingsStore,context:jt().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:d,fullHeight:!0})})}n(500234);var Tt=()=>n(780866);function _t(e){let{module:t}=e;const{collectionStore:n,pageStore:o}=(0,X().bi)(),i=(0,r().IS)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.regular,color:e.text.secondary,marginLeft:8}})),[]);return(0,z.jsxs)("div",{style:i.configureContainer,children:[(0,z.jsx)("div",{style:i.configureDescription,children:(0,z.jsx)(d().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,z.jsx)(Pt,{layoutModule:t,pageStore:o,collectionStore:n})]})}function Pt(e){let{collectionStore:t,pageStore:n,layoutModule:r}=e;const a=(0,i().v3)(),l=(0,o.useMemo)((()=>new(xe().YB)),[]),{collectionPagePropertySections:d}=(0,s().K8)((()=>{const e=t.getSchema(),n=t.getFormat();return{collectionPagePropertySections:(0,Tt().T)({format:n,schema:e,visibilityLevels:["inline","minimal"]})}}),[t]),c=d.map((e=>e.section)),u=(0,o.useCallback)((e=>{if(!d)return;const n=e.map((e=>{const t=d.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));R().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:a,canUndo:!0,perform:e=>{P().LK({environment:a,pageSectionFormats:n,store:t,transaction:e})}})}),[d,t,a]);return d.length?(0,z.jsx)(Je().Ay,{direction:"vertical",keys:c,renderKey:e=>(0,z.jsx)(mt,{pageStore:n,collectionStore:t,propertyId:e,pagePropertiesStore:l,layoutModule:r,draggable:!0}),onDrop:e=>u(e)}):null}var Bt=()=>n(668742),Rt=()=>n(458582),Lt=()=>n(763145),Dt=()=>n(760813),Nt=()=>n(130081);function Ot(e){const{environment:t,layoutModule:n,collectionStore:o,layoutStore:i,propertyId:s}=e,r=o.getSchema(),a=i.getModel(),l=null==a?void 0:a.getPageModuleAreaById(n.id);if(!l||!a||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let o,i=[...t??[]];return i.includes(e)?(i=i.filter((t=>t!==e)),o=!1):(i.push(e),i.length>Lt().U&&(i=(0,se().Vl)(i,n)),o=!0),{isNowPinned:o,pinnedPropertyIds:i}}(s,n.propertyIds,r),c={...n,propertyIds:d};R().createAndCommit({environment:t,perform(e){(0,Dt().HD)({environment:t,transaction:e,property:s,layoutStore:i}),(0,Nt().UQ)({environment:t,transaction:e,layoutStore:i,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Et=()=>n(290557);function Ut(e){let{module:t}=e;const{collectionStore:n,pageStore:a}=(0,X().bi)(),l=(0,i().v3)(),{layoutStore:u}=(0,X().LH)(),m=(0,s().K8)((()=>n.getSchema()),[n]),p=(0,s().K8)((()=>(0,I().L)(n.getFormat(),m,void 0,C().jf.Collection)),[n,m]),g=(0,o.useMemo)((()=>new(xe().YB)),[]),v=(0,o.useMemo)((()=>"normalizedTitleWithIcon"!==t.type?[]:(0,se().Vl)(t.propertyIds,m)),[t,m]),y=(0,o.useMemo)((()=>new Set(v)),[v]),x=(0,s().K8)((()=>{var e;return null===(e=p.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,F().NM)(e)&&!y.has(e)))}),[p.property_visibility,y]),S=(0,s().K8)((()=>(0,c().uv)(m)),[m]),M=(0,be().z7)({store:a,format:p,schema:m,collectionStore:n,propertyIds:S}),A=(0,o.useMemo)((()=>{const e={};for(const t of M)e[t.property]=t;return e}),[M]),{searchInputValueStore:w,searchMatches:k,activeSearchMatchIndex:j,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchMatchesMap:B}=Ce({mergedPropertiesMap:A,propertyGroups:void 0,propertyIdsToExclude:void 0}),L=function(e){const t=(0,i().v3)(),{layoutStore:n}=(0,X().LH)();return(0,o.useCallback)((o=>{const i=n.getModel(),s=null==i?void 0:i.getPageModuleAreaById(e.id);if(!s||!i)return;const r={...e,propertyIds:o};R().createAndCommit({environment:t,perform(o){(0,Nt().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:s,moduleId:e.id},updatedModule:r})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),E=(0,r().IS)((e=>{const t={fontSize:_().J.UISmall.desktop,lineHeight:"24px",color:e.text.secondary,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${Jt+6}px 0`},scrollableContainer:{padding:`0 ${Jt}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginLeft:8},optionsContainer:{marginTop:24},optionsLabel:{...t,marginLeft:6,marginBottom:6},switcherButton:{marginRight:0},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),U=v.length?(0,z.jsx)(Je().Ay,{keys:v,onDrop:L,direction:"vertical",renderKey:e=>(0,z.jsx)(Kt,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0})}):null,K=v.length>=Lt().U,V=x.map((e=>(0,z.jsx)(Kt,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1,pinButtonDisabled:K,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0},e))),W=Ft(t),H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,z.jsx)(Ie().Xt,{...e,style:E.addPropertyButton,iconStyle:E.addPropertyButtonIcon,collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:g,onPropertyAdded:W,disabled:K})},{backlinksVisibility:G,updateBacklinksVisibility:Y}=(0,Et().Ap)({store:n,format:p}),q=(0,d().tz)(),$=(0,o.useCallback)((()=>{const e="show"===t.propertyLabels||!t.propertyLabels;R().createAndCommit({environment:l,perform(n){var o;const i=null===(o=u.getModel())||void 0===o?void 0:o.getPageModuleAreaById(t.id);i&&(0,Nt().UQ)({environment:l,transaction:n,layoutStore:u,position:{area:i,moduleId:t.id},updatedModule:{...t,propertyLabels:e?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[t,l,u]),Q=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{...E.pinnedPropertiesLabel},children:(0,z.jsx)(d().sA,{...Vt.pinnedPropertiesLabel})}),U,(0,z.jsx)("div",{style:{marginLeft:2},children:K?(0,z.jsx)(f().A,{placement:b().W.Left,render:e=>H(e),renderTooltip:()=>q.formatMessage(Vt.maxPinnedPropertiesAddPropertyTooltip,{br:(0,z.jsx)("br",{})})}):H()}),V.length>0&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{...E.pinnedPropertiesLabel,marginTop:24},children:(0,z.jsx)(d().sA,{...Vt.unpinnedPropertiesLabel})}),V]})]});return(0,z.jsxs)(h().wt,{style:E.container,children:[(0,z.jsx)("div",{style:E.propertySearchInputContainer,children:(0,z.jsx)(vt,{activeSearchMatchIndex:j,searchMatches:k,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchInputValueStore:w})}),(0,z.jsxs)("div",{style:E.scrollableContainer,children:[Q,(0,z.jsxs)("div",{style:E.optionsContainer,children:[(0,z.jsx)("div",{style:E.optionsLabel,children:(0,z.jsx)(d().sA,{...Vt.optionsLabel})}),(0,z.jsx)(D().Ay,{title:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:$,right:(0,z.jsx)(N().A,{on:"show"===t.propertyLabels||void 0===t.propertyLabels}),rightStyle:E.switcherButton}),(0,z.jsx)(D().Ay,{right:(0,z.jsx)(O().p7,{currentVisibility:G,onSelect:Y}),rightStyle:E.switcherButton,title:(0,z.jsx)(d().sA,{...Vt.showBacklinksOption})})]})]})]})}function Ft(e){const{layoutStore:t}=(0,X().LH)(),{collectionStore:n}=(0,X().bi)(),s=(0,i().v3)();return(0,o.useCallback)((o=>{Ot({environment:s,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:o})}),[s,e,n,t])}function Kt(e){let{layoutModule:t,propertyId:n,isPinned:o,pinButtonDisabled:i,...a}=e;const l=(0,d().tz)(),c=(0,r().DP)(),{collectionStore:u,pageStore:p}=(0,X().bi)(),g=(0,s().K8)((()=>u.getSchema()),[u])[n],h=Ft(t);if(!g)return null;const v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,z.jsx)(m().A,{...e,disabled:i,ariaLabel:o?l.formatMessage(Vt.toggleUnpinnedAriaLabel,{propertyName:g.name}):l.formatMessage(Vt.togglePinnedAriaLabel,{propertyName:g.name}),icon:o?Rt().b:Bt().N,iconStyle:{fill:c.icon.primary},onClick:()=>h(n)})};return(0,z.jsx)(mt,{pageStore:p,collectionStore:u,propertyId:n,layoutModule:t,rightButton:()=>i?(0,z.jsx)(f().A,{placement:b().W.Left,render:e=>v(e),renderTooltip:()=>l.formatMessage(Vt.maxPinnedPropertiesTooltip,{br:(0,z.jsx)("br",{})})}):v(),...a})}const Vt=(0,d().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"}});var zt=()=>n(259897);const Wt=o.memo((function(e){let{module:t}=e;const{moduleStateByIdStore:o}=(0,X().bi)(),i=(0,s().K8)((()=>{var e;return null===(e=o.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[o,t.id]),a=(0,s().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),l=(0,s().K8)((()=>null==i?void 0:i.settingsStore),[i]),c=(0,r().IS)((()=>({titleWrapper:{...$t,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),u=(0,s().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===t.type&&i&&l&&u?(0,z.jsx)(Ct,{children:(0,z.jsx)(Q().p2.Provider,{value:i,children:(0,z.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:l,context:jt().Bd.ViewSettings})})}):(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:c.titleWrapper,children:(0,z.jsx)(d().sA,{...ve().s.viewsMain})}),(0,z.jsxs)("div",{style:c.viewsContainer,children:[(0,z.jsx)(Ht,{collectionContextStore:i,currentViewId:a,module:t}),"viewsMain"===t.type&&(0,z.jsx)(n(470440).ConfigureViewsMainModuleAddViewButton,{renderOrigin:e=>(0,z.jsx)(Oe().p,{icon:n(339189).W,isGray:!0,...e,children:(0,z.jsx)(d().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})})]})]})}));function Ht(e){let{collectionContextStore:t,currentViewId:o,module:r}=e;const a=(0,i().v3)(),l=(0,s().K8)((()=>{if(!t)return[];const e=t.collectionViewBlockStore(),n=null==e?void 0:e.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[t]);return"editor"===r.type?(0,z.jsx)(Oe().p,{children:(0,z.jsx)("div",{style:{fontWeight:600},children:(0,z.jsx)(d().sA,{...ve().s.editor})})},"editor"):l&&t?(0,z.jsx)(z.Fragment,{children:l.map((e=>(0,z.jsx)(Oe().p,{icon:t=>(0,z.jsx)(n(511441).h,{viewIcon:e.icon,viewType:e.type,color:"regular",style:t}),onClick:()=>{(0,zt().t)({environment:a,collectionContextStore:t,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),wt().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore})},children:(0,z.jsx)("div",{style:{fontWeight:e.id===o?600:void 0},children:void 0!==e.type?(0,n(314164).OO)({collectionViewName:e.name,collectionViewType:e.type}):(0,z.jsx)(d().sA,{...Gt.newView})})},e.id)))}):null}const Gt=(0,d().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}});function Yt(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,X().bi)(),o=(0,s().K8)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),i=(0,s().K8)((()=>null==o?void 0:o.settingsStore),[o]);return t&&o&&i?(0,z.jsx)(Ct,{children:(0,z.jsx)(Q().p2.Provider,{value:o,children:(0,z.jsx)(kt().m$,{collectionContextStore:o,collectionSettingsStore:i,context:jt().Bd.ViewSettings})})}):null}function qt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,X().LH)(),o=(0,s().K8)((()=>n.getModuleById(t)),[n,t]),i=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==o?void 0:o.type)&&"normalizedTitleWithIcon"!==(null==o?void 0:o.type)?{paddingBottom:80}:{height:"100%"}}})),[null==o?void 0:o.type]);return o?(0,z.jsxs)("div",{style:i.container,children:[(a=o,"viewsMain"!==a.type&&"editor"!==a.type&&!(0,re().gx)(a)&&(0,z.jsx)(Qt,{module:o})),(0,z.jsx)(Zt,{module:o})]}):null;var a}const $t={fontWeight:_().Wy.medium,marginBottom:0,marginLeft:6,fontSize:16,lineHeight:"24px"};function Qt(e){const{module:t}=e,n=(0,z.jsx)("div",{style:$t,children:(0,z.jsx)(d().sA,{...ve().s[t.type]})});return"properties"===t.type?(0,z.jsx)(At,{title:n}):n}function Zt(e){const{module:t}=e;if((0,re().gx)(t))return(0,z.jsx)(It,{module:t});const{type:n}=t;switch(n){case"properties":return(0,z.jsx)(yt,{module:t});case"normalizedTitleWithIcon":return(0,z.jsx)(Ut,{module:t});case"relationsGroup":return(0,z.jsx)(_t,{module:t});case"views":return(0,z.jsx)(Yt,{module:t});case"viewsMain":case"editor":return(0,z.jsx)(Wt,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":return null;default:(0,c().HB)(n)}return null}const Xt=290,Jt=16;function en(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,X().LH)(),{collectionStore:o,pageStore:i}=(0,X().bi)(),a=(0,s().K8)((()=>{const e=o.getFormat(),t=o.getSchema();return(0,I().L)(e,t,void 0,C().jf.Collection)}),[o]),l=(0,r().IS)((t=>({container:{padding:`8px ${Jt}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:Xt,width:Xt,maxWidth:Xt},title:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,margin:"0px 8px 0px 8px"},label:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.medium,margin:"24px 8px 6px 8px",color:t.text.secondary},switcherButton:{marginRight:0}})),[e]),c=(0,s().K8)((()=>Boolean(o.getFormat().external_object_id)),[o]);return e?(0,z.jsxs)(p().H,{type:x().A.Y,style:l.container,children:["existing_module"===e.type&&(0,z.jsx)(qt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,z.jsx)(he,{})]}):(0,z.jsxs)("div",{style:l.container,children:[(0,z.jsx)("div",{style:l.title,children:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,z.jsx)(tn,{collectionStore:o,layoutStore:t,sessionId:n,styles:l}),(0,z.jsx)("div",{style:l.label,children:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,z.jsx)(on,{disabled:c,collectionStore:o,normalizedCollectionFormat:a,styles:l}),(0,z.jsx)(nn,{disabled:c,collectionStore:o,normalizedCollectionFormat:a,styles:l}),(0,z.jsx)(sn,{layoutStore:t,styles:l}),(0,z.jsx)(rn,{pageStore:i,layoutStore:t,styles:l})]})}function tn(e){const{collectionStore:t,layoutStore:n,sessionId:r,styles:a}=e,l=(0,i().v3)(),u=(0,s().K8)((()=>n.isTabbedPageLayout()),[n]),{value:m}=(0,E().fJ)(U.switchFromSimpleToTabbedLayoutActions),{value:p}=(0,E().fJ)(U.switchFromTabbedToSimpleLayoutActions),g=!m||!p,f=u?"tabbed":"simple",h=(0,o.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:j().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:j().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),v=(0,o.useCallback)((async e=>{m&&p&&("simple"===e?p.switchFromTabbedToSimpleLayout({environment:l,layoutStore:n}):"tabbed"===e?await m.switchFromSimpleToTabbedLayout({environment:l,layoutStore:n}):(0,c().HB)(e),(0,S().GF)({environment:l,layoutId:n.id,collectionId:t.id,sessionId:r,structure:e}))}),[m,p,l,n,t.id,r]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:a.label,children:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,z.jsx)(L().A,{disabled:g,options:h,selectedOption:f,onOptionSelected:v,height:"tall"})]})}function nn(e){var t;const{disabled:n,collectionStore:s,normalizedCollectionFormat:r,styles:a}=e,l=(0,i().v3)(),c="section_hide"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",u=(0,o.useCallback)((e=>{const t=s.getFormat(),n=s.getSchema(),o=(0,I().L)(t,n,void 0,C().jf.Collection);P().OD({environment:l,pageSection:"comments",visibility:e,store:s,format:o})}),[s,l]);return(0,z.jsx)(D().Ay,{title:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"}),right:(0,z.jsx)(O().kS,{disabled:n,currentVisibility:c,onSelect:u}),rightStyle:a.switcherButton})}function on(e){var t;const n=(0,i().v3)(),{disabled:s,collectionStore:r,normalizedCollectionFormat:a,styles:l}=e,c="minimal"===(null===(t=a.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",u=(0,o.useCallback)((e=>{const t=r.getFormat(),o=r.getSchema(),i=(0,I().L)(t,o,void 0,C().jf.Collection);P().OD({environment:n,pageSection:"margin_comments",visibility:e,store:r,format:i})}),[r,n]);return(0,z.jsx)(D().Ay,{title:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,z.jsx)(O().J8,{disabled:s,currentVisibility:c,onSelect:u}),rightStyle:l.switcherButton})}function sn(e){const{layoutStore:t,styles:n}=e,r=(0,i().v3)(),a=(0,s().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,o.useCallback)((()=>{R().createAndCommit({environment:r,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;B().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,r]);return(0,z.jsx)(D().Ay,{title:(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"}),onClick:l,right:(0,z.jsx)(N().A,{on:a}),rightStyle:n.switcherButton})}function rn(e){const{pageStore:t,layoutStore:n,styles:a}=e,l=(0,i().v3)(),c=(0,s().K8)((()=>n.getFormatStore().getKeyValue("page_full_width")),[n]),u=(0,o.useCallback)((()=>{R().createAndCommit({environment:l,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{const o=!n.getFormatStore().getKeyValue("page_full_width");B().zA({stores:[n],update:{page_full_width:o},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&B().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,l,t]),m=(0,r().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,z.jsx)(D().Ay,{title:(0,z.jsxs)("div",{style:m.title,children:[(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,z.jsx)(f().A,{placement:b().W.Bottom,renderTooltip:()=>(0,z.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,z.jsx)("div",{...e,children:(0,T().G)(m.icon)}),style:m.tooltip})]}),onClick:u,right:(0,z.jsx)(N().A,{on:Boolean(c)}),rightStyle:a.switcherButton})}var an=()=>n(251399),ln=()=>n(957857),dn=()=>n(116485),cn=()=>n(996094),un=()=>n(846287),mn=()=>n(145017),pn=()=>n(246132);function gn(e){var t;const{layoutStore:o,tabToFocus:i,moduleStateByIdStore:s,environment:r}=e,a=o.pointer,l=o.getModules(),d=(0,un().EX)(l,(e=>"viewsMain"===e.type));if(!d||!(0,re().y6)(d.module))return;const{module:u}=d,m=null==s||null===(t=s.get(u.id))||void 0===t?void 0:t.collectionContextStore;if(!m)return;const p=n(638907).B.createChildStore(o,u.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;if("page"!==e.getType())return!1;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===a.id})):(0,c().HB)(i),g&&(0,zt().t)({environment:r,collectionContextStore:m,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}var fn=()=>n(769884),hn=()=>n(23371),vn=()=>n(731827),yn=()=>n(413871);async function bn(e){const{environment:t,layoutStore:n,blockPointer:o}=e,i=yn().Bv.createChildStore(n,o);if(await i.load(),!i.isCollectionView())return;const s=i.getCollectionViewStores();await(0,hn().lX)(s,25,(e=>e.load()));const r=s.filter((e=>"page"===e.getType()));if(r.length<=1)return;const a=n.getModules(),l=(0,un().JO)(a,re().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=r.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=r.filter((e=>e!==c));0!==u.length&&R().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const s of u){var t,o;const r=null===(t=s.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,vn().T)({collectionViewBlockStore:i,collectionViewStore:s,transaction:e}),!r)continue;const a=(null===(o=n.getRawModules())||void 0===o||null===(o=o.views_main_tab_modules)||void 0===o?void 0:o[r])||[];for(const t of a.reverse())R().applyOperation({store:n,transaction:e,operation:fn().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});R().applyOperation({store:n,transaction:e,operation:fn().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:r})})}}})}async function xn(e){const{environment:t,layoutStore:o}=e;await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const o=n.getBlockChildrenPointers();for(const s of o){var i;null!==(i=n.getModel())&&void 0!==i&&i.isTabbedLayoutCollectionViewBlockPointer(s)&&await bn({environment:t,layoutStore:n,blockPointer:s})}}({environment:t,layoutStore:o}),(0,n(538119).O)({environment:t,layoutStore:o})}const Sn=o.memo((function(e){let{children:t,collectionStore:r,pageStore:a,sessionId:l,layoutBuilderModuleSelectionStore:d}=e;const c=(0,i().v3)(),u=(0,s().K8)((()=>{var e;return null===(e=n(485966).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),m=(0,s().K8)((()=>r.getSpaceId()),[r]),p=(0,o.useMemo)((()=>(null==a?void 0:a.id)??(0,n(754697).Z1)({environment:c,table:mn().ev,spaceId:m})),[c,null==a?void 0:a.id,m]),g=(0,o.useCallback)((e=>{var t;if(e.operation.pointer.id===p)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===p)throw new Error("Unexpected operation on temporary page.");return!0}),[p]),f=(0,pn().S)(n(468933).oB,{canUndo:!1,shouldPersistOperation:a?void 0:g}),h=(0,s().K8)((()=>{if(a)return a.clone(f.cache);return R().createAndCommit({environment:c,perform(e){const t=n(759625).Wv({environment:c,type:"page",id:p,inMemoryRecordCache:f.cache,transaction:e});return R().applyOperation({store:t,operation:n(582226).op.update({pointer:{id:t.pointer.id,table:mn().ev,spaceId:t.pointer.spaceId},path:[],args:{parent_id:r.id,parent_table:r.table}}),transaction:e}),t},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[r,f.cache,c,a,p]),v=function(e,t){const r=(0,i().v3)(),a=(0,o.useMemo)((()=>new(n(595922).A)(r)),[r]),l=(0,pn().f)(e,t),d=(0,s().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,o.useEffect)((()=>{a.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[a,l,d]),a}(f,r),{unpersistedCollectionStore:y,unpersistedLayoutStore:b,modulesByArea:x}=(0,s().K8)((()=>{const e=v.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[v]),[S,M]=(0,o.useState)(void 0);(0,n(682369).A)((()=>{M((0,Ne().mg)(x))}),Boolean(x));const A=(0,s().uB)(void 0,n(605003).A),w=o.useRef(!1);(0,s().K8)((()=>{u&&y&&!b&&(R().createAndCommit({environment:c,perform:e=>Dt().$L({environment:c,transaction:e,collectionStore:y,userId:u}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),w.current=!0)}),[c,y,b,u]);const k=(0,o.useCallback)((async()=>{if(u&&b)return await xn({environment:c,layoutStore:b}),f.persist("PageLayoutEditorContext.updateLayout")}),[f,c,b,u]),j=(0,o.useCallback)((()=>{f.reset();const e=r.getLayoutStore();return!!e&&(R().createAndCommit({environment:c,perform(t){Nt().gL({environment:c,transaction:t,layoutStore:e,collectionStore:r})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[r,f,c]),C=(0,s().K8)((()=>d.getState()),[d]),I=(0,s().K8)((()=>h.isReady()&&(null==b?void 0:b.isReady())),[b,h]),[T,_]=(0,o.useState)([]),P=(0,o.useMemo)((()=>new(n(162544).G)),[]),B=(0,o.useCallback)((e=>{if(d.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,un().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&gn({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:P,environment:c})}}),[c,d,P,b]),L=Me().default.createValue(!1),D=(0,o.useMemo)((()=>b&&{layoutStore:b,collectionStore:y,currentModuleSelection:C,setModuleSelection:B,sessionId:l,addModuleHoverMenuStore:A,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:L,layoutBuilderModuleSelectionStore:d}),[b,y,C,B,l,A,L,d]),N=(0,o.useMemo)((()=>y&&{pageStore:h,hasUnsavedChanges:f.hasChanges,saveChanges:k,moduleIdsMovedFromSidebar:T,setModuleIdsMovedFromSidebar:_,isNewLayout:w.current,initialLayoutModulesByArea:S,resetLayoutToDefault:j,moduleStateByIdStore:P,collectionContextStore:v,collectionStore:y}),[y,h,f.hasChanges,k,T,S,j,P,v]);return I&&b&&D&&N?(0,z.jsx)(Q().RI,{value:v,children:(0,z.jsx)(X().Op.Provider,{value:D,children:(0,z.jsxs)(X().sf.Provider,{value:N,children:[(0,cn().isConsoleEnabled)()&&(0,z.jsx)(Mn,{}),t]})})}):null}));function Mn(){return(0,o.useEffect)((()=>()=>{(0,cn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,cn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,cn().exposeDebugValue)("baseLayoutEditorContext",(0,X().LH)()),(0,cn().exposeDebugValue)("pageLayoutEditorContext",(0,X().bi)()),null}var An=n.n(n(309102)),wn=()=>n(169201),kn=()=>n(129808),jn=()=>n(145046),Cn=()=>n(28210),In=()=>n(709237),Tn=()=>n(983050),_n=()=>n(216273),Pn=()=>n(198654),Bn=()=>n(32194),Rn=()=>n(966789),Ln=()=>n(975515),Dn=()=>n(701513),Nn=()=>n(906230),On=()=>n(289988);function En(e){let{collectionStore:t}=e;const n=(0,o.useRef)(null),[i,r]=o.useState(""),{pageStore:a}=(0,X().bi)(),{results:l,isResultsLoading:c}=(0,On().W)({query:i,type:Bn().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,collectionId:t.id,options:{disable:!1}}),u=(0,s().K8)((()=>c?[{key:"loading",action:()=>{},render:e=>(0,z.jsx)(Ln().A,{...e,title:(0,z.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,z.jsx)(Rn().A,{})})})}]:0===l.length?[{key:"no_results",action:()=>{},render:e=>(0,z.jsx)(Ln().A,{...e,title:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:l.map((e=>{const t=(null==a?void 0:a.id)===e.id;return{key:e.id,render:n=>(0,z.jsx)(Dn().A,{...n,store:e.store,hidePath:!0,isChecked:t}),action:()=>{if(t)return;if(!k().g.state.isOpen||"layout-editor"!==k().g.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:k().g.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:k().g.state.sessionId,collectionStore:k().g.state.collectionStore};k().g.setState(n)}}}))),[null==a?void 0:a.id,c,l]),m=(0,z.jsx)($().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,z.jsx)(Y().Ay,{ref:n,value:i,placeholder:y().A.formatMessage(Fn.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{r(e.target.value)},focusInitial:l.length>0||void 0})}),p=(0,z.jsx)(Ve().A,{menuType:He().gu.Popup,header:m,width:300,children:(0,z.jsx)(q().Ay,{type:q().Oh.Vertical,style:{marginBottom:0},sections:[{key:"results",items:u,render:e=>(0,z.jsx)($().A,{...e})}],initialFocus:l.length>0?0:void 0})});return(0,z.jsx)(Ee().Ay,{popupType:Ee().z7.Popup,renderOrigin:e=>(0,z.jsx)(Un,{...e,pageStore:a}),originGap:2,render:()=>p,onClose:()=>r("")})}function Un(e){const{pageStore:t,...n}=e,o=(0,r().IS)((e=>({previewButton:{color:e.text.secondary,fontWeight:_().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{..._().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,z.jsx)(f().A,{placement:b().W.Right,renderTooltip:()=>(0,z.jsx)(d().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,z.jsxs)(Oe().p,{...(0,Nn().A)(e,n),style:o.previewButton,children:[(0,z.jsxs)("div",{style:o.previewLabelContainer,children:[(0,z.jsx)("div",{style:o.previewLabel,children:(0,z.jsx)(d().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,z.jsx)(In().A,{store:t,style:o.recordTitle})]}),(0,Pn().b)(o.chevronDownIcon)]})})}const Fn=(0,d().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}});const Kn=function(){const e=(0,d().tz)(),t=(0,i().v3)(),{setModuleSelection:s,currentModuleSelection:a,layoutStore:l,sessionId:c}=(0,X().LH)(),u=void 0===a,m=(0,o.useCallback)((()=>{var e;null==s||s(void 0),(0,S().L3)({environment:t,layoutId:l.id,collectionId:null===(e=l.getCollectionModel())||void 0===e?void 0:e.id,sessionId:c,from:"page_settings_button_click"})}),[s,t,l,c]),p=(0,r().IS)((e=>({button:{...u&&{background:e.state.hover}},icon:{width:V().Ev.default,height:V().Ev.default}})),[u]);return s?(0,z.jsx)(Oe().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),icon:n(954397).slidersIcon,iconStyle:p.icon,onClick:m,style:p.button,size:"lg",children:(0,z.jsx)(d().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null},Vn=(0,V().xh)("arrowUTurnUpLeft",{default:{loader:()=>n.e(75152).then(n.bind(n,644540))},small:{loader:()=>n.e(75152).then(n.bind(n,561578))},fill:{loader:()=>n.e(75152).then(n.bind(n,71064))},fillSmall:{loader:()=>n.e(75152).then(n.bind(n,155241))}},["uturn","left","reverse","direction","turn","undo","back"]);var zn=()=>n(611506),Wn=()=>n(727567),Hn=()=>n(529305),Gn=()=>n(539048),Yn=()=>n(627717),qn=()=>n(50903),$n=()=>n(466321);const Qn={id:"pageLayoutAreas.page_main",defaultMessage:"main page",description:"Name for the main area of the page"},Zn={id:"pageLayoutAreas.page_details",defaultMessage:"sidebar",description:"Name for the details sidebar"},Xn={id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form",description:"Name for the form area"},Jn=(0,d().YK)({page_main:Qn,page_layout_schema:Qn,page_details:Zn,page_info_layout_schema:Zn,form_layout_schema:Xn,form_conditional_modules:Xn,views_main_tab_modules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab",description:"Name for the views main tab"},person_profile_page_main:{id:"pageLayoutAreas.person_profile_page_main",defaultMessage:"person profile main column",description:"Name for the person profile page main area (primary column)"},person_profile_page_details:{id:"pageLayoutAreas.person_profile_page_details",defaultMessage:"person profile details column",description:"Name for the person profile page details area (secondary column)"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}});function eo(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:a,initialLayoutModulesByArea:l,resetLayoutToDefault:c}=(0,X().bi)(),{sessionId:u,layoutStore:m}=(0,X().LH)(),p=(0,i().v3)(),g=(0,d().tz)(),[f,v]=(0,o.useState)(!1),y=(0,s().K8)((()=>m.getModules()),[m]),x=(0,r().IS)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:_().Wy.medium},saveButtonRevertItemTitle:{fontSize:_().J.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),M=(0,o.useCallback)((t=>{Dt().Fv({environment:p}),S().do({environment:p,sessionId:u,collectionId:e.id,existingLayoutId:a?void 0:m.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:l,finalModulesByArea:y})}),[e.id,p,l,a,m.id,u,y]),A=(0,o.useCallback)((async()=>{if(t){v(!0);try{await n(),M(!0)}catch(e){if(v(!1),!(e instanceof qn().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?g.formatMessage(Jn.page_main):"page_info_layout_schema"===t.area?g.formatMessage(Jn.page_details):g.formatMessage(Jn.generic)};jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else{if("multiple_views_main_content_tabs"!==(null==t?void 0:t.type)){const e=g.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});return void jn().f1(e)}jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}))}}}}else M(!1)}),[M,t,g,n]),w=(0,o.useCallback)((()=>{c(),S().kA({environment:p,context:"layout",sessionId:u,collectionId:e.id,layoutId:a?void 0:m.id}),j(!1),M(!0)}),[M,e.id,p,a,m.id,c,u]),[k,j]=o.useState(!1);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ee().Ay,{popupType:$n().n.Popup,alignmentToOrigin:b().C.End,originGap:4,render:e=>(0,z.jsx)($().A,{style:x.saveButtonSectionMenuItem,children:(0,z.jsx)(G().A,{onClick:()=>{j(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:x.saveButtonRevertItem,body:(0,z.jsxs)(h().Ye,{gap:10,children:[(0,Wn()._)(x.saveButtonRevertItemIcon),(0,z.jsxs)(h().wt,{children:[(0,z.jsx)("div",{style:x.saveButtonRevertItemTitle,children:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,z.jsx)("div",{children:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,z.jsx)(Yn().A,{style:x.saveButton,mainButtonStyle:x.saveButtonInner,title:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:A,disableDropdown:!1,icon:zn().p,iconStyle:x.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:f})}),k&&(0,z.jsx)(Gn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>j(!1),areaConstraint:{width:{type:"min",length:300}},render:e=>{let{sizeRange:t}=e;return(0,z.jsx)(Hn().tf,{header:(0,z.jsx)(Hn().YA,{iconAndTitle:(0,z.jsx)(Hn().ZQ,{iconGroup:Vn,title:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,z.jsx)(Hn().aO,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:w}],secondaryButtons:[{buttonType:"dismiss",label:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:t})}})]})}function to(){const e=(0,i().v3)(),{device:t}=e,{isElectron:n,isElectronMac:a}=t,{sessionId:l,layoutStore:c}=(0,X().LH)(),{collectionStore:u,hasUnsavedChanges:m,isNewLayout:p,initialLayoutModulesByArea:g}=(0,X().bi)(),f=(0,s().K8)((()=>c.getModules()),[c]),v=(0,s().O$)(_n().b),y=n&&!v,b=(0,s().K8)((()=>(0,kn().ek)(a)),[a]),x=(0,o.useCallback)((async()=>{S().do({environment:e,sessionId:l,collectionId:u.id,existingLayoutId:p?void 0:c.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:g,finalModulesByArea:f});const t=()=>Dt().Fv({environment:e});if(!m)return void t();const{accept:n}=await jn().Gh({message:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.closeConfirmModal.content",defaultMessage:"Discard all layout changes?"}),acceptLabel:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.closeConfirmModal.discard",defaultMessage:"Discard"})});n&&t()}),[e,l,u.id,p,c.id,g,f,m]),M=(0,r().IS)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",margin:"8px 16px 8px 16px"},topbarPlaceholder:{minHeight:b,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",left:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",..._().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[b]);return(0,z.jsxs)("header",{style:M.header,children:[y?(0,z.jsx)("div",{style:M.topbarPlaceholder,className:An()({[Tn().N_7]:!0,[Tn().sbV]:!0})}):null,(0,z.jsxs)("div",{style:M.headerContent,children:[(0,z.jsx)("div",{style:M.titlePreviewContainer,children:(0,z.jsxs)("div",{style:M.titlePreviewElementContainer,children:[(0,z.jsx)(no,{collectionStore:u}),(0,z.jsx)(En,{collectionStore:u})]})}),(0,z.jsxs)(h().Ye,{style:M.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,z.jsx)("div",{style:M.pageSettingsButtonContainer,children:(0,z.jsx)(Kn,{})}),(0,z.jsxs)(h().Ye,{gap:8,alignItems:"center",style:M.rightButtons,children:[(0,z.jsx)(Oe().p,{onClick:x,icon:wn().u,size:"lg",children:(0,z.jsx)(d().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,z.jsx)(eo,{})]})]})]})]})}function no(e){let{collectionStore:t}=e;const n=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:_().Wy.medium,width:"100%",..._().RC}})),[]),o=(0,s().K8)((()=>t.getIcon()),[t]);return(0,z.jsxs)("div",{style:n.container,children:[(0,z.jsx)(Cn().B,{icon:o,size:20,isEmptyPage:!1,disabled:!0}),(0,z.jsx)(In().A,{store:t})]})}function oo(e){const t=(0,r().IS)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%",marginTop:-20,minWidth:A().ok,zIndex:0,position:"relative"}})),[]),n=(0,s().K8)((()=>k().g.getState()),[]),i=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,a=(0,s().uB)(e.layoutBuilderModuleSelectionStore,w().A),l=n.isOpen&&"layout-editor"===n.mode;return(0,o.useEffect)((()=>{l&&a.setState(i?{type:"existing_module",moduleId:i,isDragging:!1}:void 0)}),[i,l,a]),n.isOpen&&"layout-editor"===n.mode?(0,z.jsxs)(Sn,{...n,layoutBuilderModuleSelectionStore:a,children:[e.debugChildForTestsOnly,(0,z.jsxs)(u().A,{tag:h().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,z.jsx)(to,{}),(0,z.jsxs)(h().Ye,{style:t.innerContainer,children:[(0,z.jsx)(io,{}),(0,z.jsx)(en,{})]})]})]}):null}function io(){const{pageStore:e}=(0,X().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:a,sessionId:l}=(0,X().LH)(),d=(0,i().v3)(),u=(0,s().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),m=(0,s().K8)((()=>{const t=(0,A().dV)(d);switch(t){case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,c().HB)(t)}}),[d,e]),f=(0,s().K8)((()=>(0,M().oQ)(d).totalWidth),[d]),h=(0,s().K8)((()=>Boolean(e.getCover())),[e]),y=(0,r().IS)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.accentColors.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...u?{cursor:"grabbing"}:{}},mainPage:{flex:3,paddingTop:h?void 0:28},sidebarScroller:{borderLeft:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${M().MH}px ${M().uZ}px`,marginBottom:100,flex:1,minWidth:f,maxWidth:f,width:f,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"}})),[u,h,f]),[b,w]=(0,o.useState)(!0);return(0,z.jsxs)("div",{role:"presentation",style:y.container,onClick:e=>{(0,v().SQ)({event:e,context:v().y$.EditorClick,callback:()=>{var e;t(void 0),(0,S().L3)({environment:d,layoutId:a.id,collectionId:null===(e=a.getCollectionModel())||void 0===e?void 0:e.id,sessionId:l,from:"background_click"})}})},children:[(0,z.jsx)(ln().s,{area:"page_main",style:y.mainPageContainer,children:(0,z.jsx)(g().l,{children:(0,z.jsx)(p().H,{type:x().A.Y,style:y.mainPageScrollContainer,children:(0,z.jsx)("div",{style:y.mainPage,children:(0,z.jsx)(dn().Mx,{type:m,children:(0,z.jsx)(an().J,{area:"page_main"})})})})})}),b&&(0,z.jsx)(ln().s,{area:"page_details",children:(0,z.jsxs)(p().H,{type:x().A.Y,style:y.sidebarScroller,children:[(0,z.jsx)(so,{isSidebarOpen:!0,setIsSidebarOpen:w}),(0,z.jsx)("div",{style:y.sidebar,children:(0,z.jsx)(an().J,{area:"page_details"})})]})}),!b&&(0,z.jsx)(so,{isSidebarOpen:!1,setIsSidebarOpen:w})]})}function so(e){let{isSidebarOpen:t,setIsSidebarOpen:n}=e;const i=(0,r().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",right:t?void 0:4,left:t?4:void 0,top:4}})),[t]),s=(0,o.useCallback)((()=>{n((e=>!e))}),[n]);return(0,z.jsx)("div",{style:i.container,children:(0,z.jsx)(f().A,{renderTooltip:()=>t?(0,z.jsx)(d().sA,{...ro.hideSidebar}):(0,z.jsx)(d().sA,{...ro.showSidebar}),placement:b().W.Top,render:e=>(0,z.jsx)(m().A,{icon:t?l().O:a().S,...e,onClick:s,style:i.button,ariaLabel:t?y().A.formatMessage(ro.hideSidebar):y().A.formatMessage(ro.showSidebar)})})})}const ro=(0,d().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},442958:(e,t,n)=>{n.d(t,{A:()=>i});n(242343);var o=n(163643);const i=function(e){const t=(0,n(237385).v3)(),i=(0,n(174114).DP)();return(0,o.jsx)(n(579494).A,{style:{display:"flex",alignSelf:"stretch",width:36,...e.isRight?{marginRight:-8}:{marginLeft:-8}},external:!0,href:e.href,onClick:()=>n(598995).FH(t,{from:e.analyticsFrom}),children:(0,o.jsx)(n(126451).A,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,n(284594).$)({width:18,marginTop:1,fill:i.lightIconColor})})})}},447425:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(680369),l=()=>n(31448),d=()=>n(103151),c=()=>n(622163),u=()=>n(907721),m=()=>n(382640),p=()=>n(76394),g=n(163643);const f=function(e){let{additionalStyles:t,transitionMs:o,force:i,children:s}=e;const a=(0,n(447331).j)(),l=(0,r().IS)((()=>{let e;switch(i){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=a?1:0;break;default:(0,p().HB)(i)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,p().O9)(o)?o:200}ms ease-in`,...t}}}),[t,i,a,o]);return(0,g.jsx)("div",{style:l.hoverStyle,children:s})};function h(e){let{icon:t,title:n,tooltip:o,hasRightElement:s,iconContainerStyle:m}=e;const p=(0,i().v3)(),f=(0,r().IS)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,c().ny)(p,"UISmall"),fontWeight:l().Wy.medium,color:e.text.secondary,fill:e.mediumIconColor,flexShrink:0,maxWidth:s?200:"100%"},title:{...l().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:a().Ev.sm,height:a().Ev.sm,marginRight:8,marginTop:1,...m}})),[p,m,s]);return n?(0,g.jsx)(d().A,{renderTooltip:()=>o,disableTooltip:!o,placement:u().W.Top,alignment:u().C.Start,render:e=>(0,g.jsxs)("div",{style:f.panelTitleAndIcon,...e,children:[(0,g.jsx)("div",{style:f.panelIconContainer,children:t}),(0,g.jsx)("span",{style:f.title,children:n})]})}):null}const v=function(e){let{children:t,title:a,icon:l,tooltip:d,iconContainerStyle:c,panelStyle:u,headerStyle:p,rightStyle:v,actions:y,right:b,disableRightFadeIn:x,disableActionsFadeIn:S,hideWrapStyle:M,actionsGap:A,userSelectOverride:w}=e;const k=(0,i().WS)(),j=Boolean(a),C=Boolean(b),I=(0,s().uB)(void 0,n(522841).B),T=(0,s().uB)(void 0,n(283451)._),_=(0,o.useMemo)((()=>({isHoveredOnPanelStore:I,sizeStore:T})),[I,T]),P=(0,o.useCallback)((()=>I.setState(!0)),[I]),B=(0,o.useCallback)((()=>I.setState(!1)),[I]),R=(0,o.useCallback)((e=>{e.width<m().Xy?T.setState("narrow"):T.setState("wide")}),[T]),L=(0,r().IS)((e=>({tile:{userSelect:w??"none",WebkitUserSelect:w??"none"},panel:M?{}:{paddingLeft:12,paddingRight:12,...(0,m().V$)({isPhone:k,theme:e}),...u},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:32,paddingBottom:14,marginLeft:m().Fq,...p},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:A??6,paddingLeft:6}})),[k,M,u,p,A,w]),D=(j||C)&&(0,g.jsxs)("div",{style:L.headerContainer,children:[(0,g.jsx)(h,{title:a,icon:l,tooltip:d,hasRightElement:C,iconContainerStyle:c}),(C||y)&&(0,g.jsxs)("div",{style:L.rightActions,children:[C&&(0,g.jsx)(f,{force:x?"forceShow":void 0,additionalStyles:v,children:b}),y&&(0,g.jsx)(f,{force:S?"forceShow":void 0,additionalStyles:L.actions,children:y})]})]});return(0,g.jsx)(n(275976).R.Provider,{value:_,children:(0,g.jsxs)("div",{style:L.tile,onMouseEnter:P,onMouseLeave:B,children:[D,(0,g.jsx)(n(686329).EE,{onSizeChange:R,children:(0,g.jsx)("div",{style:L.panel,children:t})})]})})}},448488:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(129044))().default{getInitialState(){}}},458582:(e,t,n)=>{n.d(t,{b:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("pinFilled",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},465235:(e,t,n)=>{n.d(t,{D2:()=>M,Ip:()=>b,Jk:()=>x,YT:()=>S,e2:()=>v,g:()=>y});n(725707),n(491955);var o=()=>n(712437),i=()=>n(409211),s=()=>n(539174),r=()=>n(818369),a=()=>n(759625),l=()=>n(575015),d=()=>n(783759),c=()=>n(84543),u=()=>n(477784),m=()=>n(548694),p=()=>n(485966),g=()=>n(628854),f=()=>n(723);const h=(0,n(653998).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function v(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const r=o.getSpaceId();if(!r)return;await g().rU({environment:t,teamId:o.id,spaceId:r,teamUserInfo:i,isSettingDefaultTeam:!1,inviterId:n})&&(s().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:n,teamStore:o}),l().D6({label:u().A.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:n,teamStore:i}=e;const s=p().default.state.currentUserRootStore,r=i.getSpaceId();if(!r||!s)return;const a=s.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await d().tR({environment:t,spaceViewStore:a,userSettingsStore:void 0,userRootStore:s,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await f().J({environment:t,spaceId:r,userId:n}),g().L0({environment:t,teamStore:i,shouldScroll:!0})}async function b(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await r().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(s().XQ(t,{teamId:n}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:u().A.formatMessage(h.requestTeamSuccessMessage)})}))):l().D6({label:u().A.formatMessage(h.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:n,accessRequestStore:o,status:r}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:i().oo,id:l});if(d){if("approved"===r){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await g().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{a().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i().oo,resolved_by_id:t.currentUser.id,status:r}})}}),s().GW(t,{store:n,resolution:r})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:s}=await(0,m().ex)({environment:t,disableRedirectUrl:!1});n?await d().tR({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:s,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:i,userSettingsStore:s,pageVisitSource:o().y8.BackForward})}async function M(e){let{environment:t,teamId:n}=e;const o=await r().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},468343:(e,t,n)=>{n.d(t,{h:()=>s});var o=()=>n(803290),i=()=>n(904697);function s(e){return(0,o().K8)((()=>{var t;return void 0===e?0:(null===(t=(0,i().getTeamMemberCountAndSampleUserIds)(e))||void 0===t?void 0:t.memberCountWithGuests)??0}),[e])}},469973:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});n(242343);var o=()=>n(237385),i=()=>n(803290),s=()=>n(218357),r=()=>n(653998),a=()=>n(975392),l=()=>n(76394),d=()=>n(641546),c=()=>n(88271),u=n(163643);const m=[{key:"block in comment menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[n(196031).z,d().b2,d().qI]}];var p=()=>n(800720),g=()=>n(682191);const f=[{key:"page mention context menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[...n(550726).YO,g().oc,g().ko]}];var h=()=>n(870099),v=()=>n(883674),y=()=>n(782422),b=()=>n(876695),x=()=>n(640979),S=()=>n(392608),M=()=>n(53664),A=()=>n(875878),w=()=>n(245313),k=()=>n(520969),j=(n(403517),()=>n(328827)),C=()=>n(507190),I=()=>n(836693),T=()=>n(59714),_=()=>n(220413),P=()=>n(32901),B=()=>n(927999),R=()=>n(84543),L=()=>n(944498),D=()=>n(477784),N=()=>n(113269);const O=(0,r().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),E=(0,P().fi)({key:"simple table header column",displayName:O.simpleTableHeaderColumn,label:D().A.formatMessage(O.simpleTableHeaderColumn),svg:n(994772).X,validators:[L().p2L,L().AU6(L().wFE),L().xCr,L().z5D],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>B().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),U=(0,P().fi)({key:"simple table header row",displayName:O.simpleTableHeaderRow,label:D().A.formatMessage(O.simpleTableHeaderRow),svg:n(715944).p,validators:[L().p2L,L().AU6(L().wFE),L().nRE],isEnabled:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const o=t.getParentBlockStore();null!=o&&o.isType("table")&&B().zA({stores:[o],update:{table_block_column_header:!o.getFormat().table_block_column_header},transaction:n})}}),F=(0,P().Ls)({key:"insert column left",displayName:O.simpleTableInsertColumnLeft,analyticsName:O.simpleTableInsertColumnLeft.defaultMessage,svg:n(566581).w,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,canUndo:!0,perform:e=>{N().T4({environment:t,transaction:e})}})}}),K=(0,P().Ls)({key:"insert column right",displayName:O.simpleTableInsertColumnRight,analyticsName:O.simpleTableInsertColumnRight.defaultMessage,svg:n(566232).P,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,canUndo:!0,perform:e=>{N().sf({environment:t,transaction:e})}})}}),V=(0,P().Fw)({key:"duplicate columns",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,canUndo:!0,perform:e=>{N().V0({transaction:e})}})}}),z=(0,P().Fw)({key:"delete columns",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Jt9,L().Pqm],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,canUndo:!0,perform:e=>{N().LL({environment:t,transaction:e})}})}}),W=(0,P().Ls)({key:"clear column contents",displayName:O.simpleTableClearContents,analyticsName:O.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,canUndo:!0,perform:e=>{N()._D({environment:t,transaction:e})}}),N().wr()}}),H=(0,P().Ls)({key:"insert row above",displayName:O.simpleTableInsertRowAbove,analyticsName:O.simpleTableInsertRowAbove.defaultMessage,svg:n(236089).s,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,canUndo:!0,perform:e=>{N().pW({environment:t,transaction:e})}})}}),G=(0,P().Ls)({key:"insert row below",displayName:O.simpleTableInsertRowBelow,analyticsName:O.simpleTableInsertRowBelow.defaultMessage,svg:n(715768).v,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,canUndo:!0,perform:e=>{N().pc({environment:t,transaction:e})}})}}),Y=(0,P().Fw)({key:"duplicate rows",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t,lazyDependencies:{duplicateActions:n}}=e;R().createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,canUndo:!0,perform:e=>{n&&N().n2({environment:t,transaction:e,duplicateActions:n})}})}}),q=(0,P().Fw)({key:"delete rows",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[L().p2L,L().AU6(L().vEP),L().ZLr,L().Hcy],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,canUndo:!0,perform:e=>{N().pf({environment:t,transaction:e})}})}}),$=(0,P().Ls)({key:"clear row contents",displayName:O.simpleTableClearContents,analyticsName:O.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,canUndo:!0,perform:e=>{N()._D({environment:t,transaction:e})}}),N().wr()}}),Q=[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],Z=[L().p2L,L().AU6(L().vEP),L().Hcy];function X(e,t,o,i){const s=i||(0,n(58889).qo)(e),r=(0,P().Ls)({key:`color ${o||e}`,displayName:s,analyticsName:s.defaultMessage,fuzzySearchKeywords:(0,P().Mf)(e),validators:"column"===t?Q:Z,action:t=>{let{blocks:n,environment:o}=t;R().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:o,canUndo:!0,perform:t=>{N().wW(o,e,t)}})},closeParentMenu:!0,render:t=>(0,u.jsx)(n(117258).Ay,{...t,color:e,overrideDisplayName:r.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,P().Kg)(n,e,o)}});return r}const J=(0,P().gy)({key:"simple table column background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>X(e,"column")))]}),ee=(0,P().gy)({key:"simple table column text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>X(e,"column")))]}),te=(0,P().gy)({key:"simple table row background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>X(e,"row")))]}),ne=(0,P().gy)({key:"simple table row text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>X(e,"row")))]}),oe=(0,P().uk)({key:"set column color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:Q,subActions:()=>[{key:0,title:D().A.formatMessage(O.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ee.actions},{key:1,title:D().A.formatMessage(O.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:J.actions}]}),ie=(0,P().uk)({key:"set row color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:Z,subActions:()=>[{key:0,title:D().A.formatMessage(O.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ne.actions},{key:1,title:D().A.formatMessage(O.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:te.actions}]}),se=[(0,P().gy)({key:"column section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[E,oe,F,K,V,W,z]}),(0,P().gy)({key:"row section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[U,ie,H,G,Y,$,q]})];var re=()=>n(907721),ae=()=>n(466321),le=()=>n(485966),de=()=>n(420797),ce=()=>n(413871),ue=()=>n(182613),me=()=>n(429392),pe=()=>n(35630),ge=()=>n(518397),fe=()=>n(401382),he=()=>n(655830),ve=()=>n(935091),ye=()=>n(743668),be=()=>n(443252),xe=()=>n(797631);function Se(){const e=(0,o().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,u.jsx)(Me,{}):(0,u.jsx)(Ae,{})}function Me(){const e=(0,i().O$)(de().A);return(0,w().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,u.jsx)(Ae,{})}function Ae(){const e=(0,o().Y0)(),t=(0,i().O$)(de().A);return(0,u.jsx)(be().Ay,{popupType:e.isPhone?ae().n.BottomSheet:ae().n.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ie,placementToOrigin:re().W.Bottom,alignmentToOrigin:re().C.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,u.jsx)(we,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function we(){var e;const t=(0,o().v3)(),n=(0,o().WS)(),c=(0,x().Tf)(),g=(0,i().O$)(de().A),y=null===(e=g.stores)||void 0===e?void 0:e[0],S=(0,i().K8)((()=>null==y?void 0:y.isCollectionView()),[y]),w=(0,i().K8)((()=>g.isActive?function(e){switch(e){case"default":return d().JS;case"simple_table":return se;case"page_mention":return f;case"sidebar_outliner":return p().LV;case"comment_media":return m;case"block_in_collection_timeline_view":return d().bH;case"block_in_collection":return d().SH;default:(0,l().HB)(e)}}(null==g?void 0:g.actionSectionGroupKey):[]),[g]),[k,j]=(0,A().$)();if(!g.isActive||!y)return null;const{originBlockRect:C,inputValue:I,publicEditMode:T}=g||{},_={environment:t,blocks:g.stores,originRect:C,publicEditMode:T,analyticsFrom:g.analyticsFrom},P=g.showInput&&(0,u.jsx)(Ce,{inputComboboxProps:k}),B=n?{menuType:x().gu.Modal,title:(0,u.jsx)(r().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:c?void 0:(0,u.jsx)(ye().DoneMenuText,{}),onClickRight:c?void 0:Ie,header:P}:{menuType:x().gu.Popup,width:265,header:P};return(0,u.jsx)(he().A,{debugName:"BlockMenu",capture:!0,onBackspace:a().D_,children:(0,u.jsxs)(ve().A,{...B,children:[(0,u.jsx)(ge().A,{filter:I,context:_,sections:w,onAccept:e=>function(e,t){const n=de().A.state;if(!n.isActive)return;const{stores:o}=ue().default.state,{analyticsFrom:i,collectionContextStore:r}=n,a=o[0];if(a){const n=a.getParentTable(),o=a.getType();if(o&&n){let l;if(n===s().yK){const e=a.getParentId(),{currentSpaceStore:t}=le().default.getState();t&&void 0!==e&&(l=ce().h4.createChildStore(t,{table:s().yK,id:e}))}const d=(0,b().sl)(r)||{};(0,h().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:a.id,block_type:o,parentTeamStore:l,is_toggleable:(0,M().Yt)(o,a.getFormat()),parent_collection_id:a.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&v().VN()}(e,t),initialFocus:I?0:void 0,comboboxProps:g.showInput?j:void 0,shouldShowBlockTypeTitle:!0}),!I&&(0,u.jsx)(je,{}),!I&&(0,u.jsx)(me().A,{store:y}),!I&&S&&(0,u.jsx)(ke,{})]})})}function ke(){const[e,t]=(0,i().K8)((()=>{const e=de().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,y().sj)(t.id)]}),[]);return e?t?(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(r().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:k().hI,analyticsFrom:"block_menu"})}):(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(r().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,S().xS)("guides.database"),analyticsFrom:"block_menu"})}):null}function je(){const e=(0,o().v3)(),t=(0,i().O$)(de().A),n=(0,i().K8)((()=>e.currentUser.isLoggedIn()),[e]),s=(0,i().K8)((()=>t.isActive&&1===t.stores.length&&(0,y().sj)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||s?null:(0,u.jsx)(pe().$,{store:t.stores[0],isPageMoreButton:!1}):null}function Ce(e){const t=(0,r().tz)(),n=(0,o().WS)(),s=(0,i().O$)(de().A);if(!s.isActive||n)return null;const{inputValue:a}=s;return(0,u.jsx)(c().A,{isInput:!0,children:(0,u.jsx)(fe().Ay,{value:a,onChange:Te,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,...e.inputComboboxProps})})}function Ie(){v().VN()}function Te(e){de().A.state.isActive&&de().A.setState({...de().A.state,inputValue:e.target.value})}},470440:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddViewButton:()=>h});n(725707),n(491955),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(653998),a=()=>n(521325),l=()=>n(535906),d=()=>n(858023),c=()=>n(88271),u=()=>n(907721),m=()=>n(466321),p=()=>n(546820),g=n(163643);const f=(0,r().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDatabase:{defaultMessage:"Link existing database",id:"pageLayout.configureViews.linkAnExistingDatabase"}}),h=o.memo((function(e){const{renderOrigin:t,onClose:r}=e,l=(0,i().v3)(),[d,c]=(0,o.useState)(!1),f=(0,o.useRef)(null),{layoutStore:h}=(0,p().LH)(),b=(0,o.useContext)(p().sf),x=null==b?void 0:b.moduleStateByIdStore,S=(0,s().K8)((()=>{var e;const t=h.getModuleByType("viewsMain");if(t)return null==x||null===(e=x.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[h,x]),M=(0,o.useCallback)(((e,t)=>{S&&((0,n(259897).t)({environment:l,collectionContextStore:S,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),a().Ow({collectionContextStore:S,collectionSettingsStore:S.settingsStore,closeOnEscape:!1}))}),[l,S]),A=(0,s().K8)((()=>{var e;const t=null===(e=h.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===n(21164).Vl)return t}),[h]),w=(0,s().K8)((()=>{const e=null==A?void 0:A.getNormalizedSchema();return Object.entries(e??{}).filter((e=>{let[t,o]=e;return(0,n(76394).O9)(o)&&(0,n(564134).nC)(o)&&o.property}))}),[A]),k=(0,o.useCallback)((()=>{c(!1),null==r||r()}),[r]),j=(0,o.useCallback)((()=>{c(!0)}),[c]),C=(0,o.useMemo)((()=>n(129044).default.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),I=(0,o.useCallback)((()=>{const e=null==S?void 0:S.viewsModuleContextStore.getViewsModule();e&&a().R8({collectionSettingsStore:C,item:{type:"selectViewsModuleSource",module:e}})}),[null==S?void 0:S.viewsModuleContextStore,C]),T=(0,o.useCallback)((()=>{a().os({collectionSettingsStore:C})}),[C]),_=(0,o.useCallback)((()=>(0,g.jsx)(v,{setIsOpen:c,onClose:r,relations:w,setCurrentViewPointer:M,collectionModel:A,viewsMainModuleCollectionContextStore:S,openViewsCreationPopup:I})),[r,w,M,A,S,I]),P=(0,o.useCallback)((e=>t(e)),[t]);return S&&A?(0,g.jsxs)("div",{ref:f,children:[(0,g.jsx)(n(273520).Ay,{alignmentToOrigin:u().C.Center,popupType:m().n.Popup,onClose:k,onClick:j,open:d,render:_,renderOrigin:P,disablePopup:!0}),(0,g.jsx)(y,{buttonRef:f,viewsMainModuleCollectionContextStore:S,viewsCreationMenuCollectionSettingsStore:C,openViewsCreationPopup:I,closeViewsCreationPopup:T})]}):null})),v=o.memo((function(e){const{setIsOpen:t,onClose:s,relations:a,setCurrentViewPointer:u,collectionModel:m,viewsMainModuleCollectionContextStore:h,openViewsCreationPopup:v}=e,y=(0,i().v3)(),b=(0,n(174114).DP)(),{layoutStore:x,setModuleSelection:S}=(0,p().LH)(),M=(0,o.useMemo)((()=>{if(0!==a.length)return{key:0,items:[],render:e=>(0,g.jsx)(c().A,{...e,title:(0,g.jsx)(r().sA,{...f.relatedToDatabase,values:{database:null==m?void 0:m.getName()}}),children:a.map((e=>{let[t,o]=e;return(0,g.jsx)(l().A,{title:null==o?void 0:o.name,icon:(0,g.jsx)(n(916963).zB,{size:16,theme:b,icon:null==o?void 0:o.icon,type:"relation"}),focused:!1,onClick:()=>{if(!h)return;const{viewsMainModule:e,collectionViewPointer:i}=(0,n(936957).ZX)({environment:y,layoutStore:x,relationPropertyId:(null==o?void 0:o.property)??t,targetCollectionPointer:(null==o?void 0:o.collection_pointer)??(null==m?void 0:m.pointer),viewName:null==o?void 0:o.name,viewIcon:null==o?void 0:o.icon});e&&S({type:"existing_module",moduleId:e.id,isDragging:!1}),i&&(n(752597).default.afterNextFlush((()=>{u(i,null==e?void 0:e.id),null==s||s()})),h&&(0,n(153258).b)({environment:y,view_type:"table",collectionContextStore:h,from:"viewsMain"}))}},t)}))})}}),[h,m,y,x,s,a,u,S,b]),A=(0,o.useMemo)((()=>{const e=a.length>0;return{key:1,items:[],render:t=>(0,g.jsx)(c().A,{...t,topBorder:e,children:(0,g.jsx)(l().A,{title:(0,g.jsx)(r().sA,{...f.linkExistingDatabase}),icon:(0,g.jsx)(n(511441).h,{color:"regular",viewType:"table"}),onClick:()=>{v()},focused:!1},"link_existing_database")})}}),[v,a.length]);return(0,g.jsx)(n(935091).A,{menuType:n(640979).gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,g.jsx)(d().Ay,{initialFocus:void 0,sections:[M,A].filter((e=>void 0!==e)),type:d().Oh.Vertical})})})),y=o.memo((function(e){var t;const{buttonRef:i,viewsMainModuleCollectionContextStore:r,viewsCreationMenuCollectionSettingsStore:a,closeViewsCreationPopup:l}=e,d=(0,s().K8)((()=>a.state.open),[a]),c=(0,o.useCallback)((()=>{l()}),[l]),p=(0,o.useCallback)((()=>(0,g.jsx)(n(343931)._,{context:n(475923).Bd.TopbarFilterPopup,collectionContextStore:r,collectionSettingsStore:a,hideDesktopHeader:!0})),[a,r]);return(0,g.jsx)(n(443252).Ay,{open:d,trapFocus:!0,popupType:m().n.Popup,render:p,originRect:null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:u().C.Center,placementToOrigin:u().W.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:c})}))},478235:(e,t,n)=>{n.r(t),n.d(t,{createRelationViewsModule:()=>p});var o=()=>n(564134),i=()=>n(214144),s=()=>n(145017),r=()=>n(289765),a=()=>n(728373),l=()=>n(795394),d=()=>n(759625),c=()=>n(84543),u=()=>n(754697),m=()=>n(413871);function p(e){const{environment:t,layoutStore:n,collectionStore:p,relationPropertyId:g}=e,f=p.getSchema(),h=g?f[g]:void 0;if(!h||!(0,o().nC)(h))return;const v=h.collection_pointer;if(!v)return;const y=h.property;if(!y)return;const b=m().md.createChildStore(p,v);if(!b)return;const x=b.getParentBlockStore();if(!x)return;const{performResult:S}=c().createAndCommit({environment:t,perform:e=>{const{inMemoryRecordCache:o}=x,m=d().Wv({environment:t,type:"collection_view",inMemoryRecordCache:o,transaction:e}),p=x.getSpaceId(),g=(0,a().Ay)(),f=(0,u().JH)({environment:t,table:r().Gy,spaceId:p}).id,v=m.pointer,S={id:f,type:"table",parent_id:v.id,parent_table:s().ev,space_id:p,alive:!0,name:h.name,format:{collection_pointer:b.pointer,property_filters:[{id:i().JW(),filter:{property:y,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],subitem_display_mode:"disabled",hide_linked_collection_name:!0}};c().applyOperation({store:m,operation:{pointer:m.pointer,path:["view_ids"],command:"listAfter",args:{id:f}},transaction:e}),l().NI({childStore:m,parentStore:n,transaction:e}),d().eC({environment:t,table:r().Gy,value:S,inMemoryRecordCache:o,transaction:e});return{id:g,type:"views",collection_view_block_pointer:{...v,spaceId:p}}},canUndo:!0,userAction:"viewsModuleActions.createRelationViewsModule"});return S}},487121:(e,t,n)=>{n.d(t,{E:()=>i});n(725707),n(107652);var o=()=>n(96297);function i(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return(0,o().sl)(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}},497808:(e,t,n)=>{n.d(t,{DV:()=>l,W5:()=>r,l7:()=>a,y7:()=>s});var o=()=>n(129978);const i={CollectionNewViewsPopupComponent:new(o().O2)("CollectionNewViewsPopupComponent",(async()=>await Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(55373),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(78708),n.e(67435),n.e(62620)]).then(n.bind(n,464342)))),CollectionViewSelect:new(o().O2)("CollectionViewSelect",(async()=>await n.e(35756).then(n.bind(n,230274)))),CollectionLinkExistingModal:new(o().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(96159),n.e(96346),n.e(36192),n.e(55373),n.e(44711),n.e(53321),n.e(90825),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(4422),n.e(67435),n.e(76181),n.e(72832),n.e(90280),n.e(84778),n.e(26090),n.e(12341),n.e(47864),n.e(90978),n.e(5287)]).then(n.bind(n,407049)))),ModalOverlayCollectionView:new(o().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([n.e(96159),n.e(96346),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(73361),n.e(32413)]).then(n.bind(n,532623))))},s=(0,o()._h)(i.CollectionNewViewsPopupComponent,(e=>e.CollectionNewViewsPopupComponent)),r=(0,o()._h)(i.CollectionViewSelect,(e=>e.CollectionViewSelect)),a=(0,o()._h)(i.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),l=(0,o()._h)(i.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},502063:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(151255))().A{}const i=new o},506153:(e,t,n)=>{n.d(t,{i:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,o.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},512040:(e,t,n)=>{n.d(t,{A:()=>s});var o=()=>n(21045);class i extends(()=>n(129044))().default{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,o().A)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,o().A)(this.instanceState,e)||this.setState(e)}}const s=new i;(0,n(996094).exposeDebugValue)("AutomationFocusStore",i)},520276:(e,t,n)=>{n.d(t,{A:()=>a,V:()=>s});n(725707),n(324989);var o=n(242343),i=n(163643);const s={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function r(e){return e.src?(0,i.jsx)("img",{style:e.style,src:e.src}):null}const a=o.forwardRef((function(e,t){const s=(0,n(174114).DP)(),a=o.useRef(e);a.current=e,o.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const o=document.getElementById(e.src),i=new n.Player(o);return i?(i.on("play",(e=>{var t,n;null===(t=(n=a.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=a.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=a.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,a.current.src]);const l=function(e,t){const o=(0,n(76394).WP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${o}`}(a.current.src,{texttrack:a.current.defaultTextTrack,playsinline:!1,...a.current.options}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,boxShadow:`0 1px 0 0 ${s.stroke.secondary}`};return(0,i.jsxs)(n(857703).A,{ratio:a.current.aspectRatioOverride??9/16,children:[(0,i.jsx)(r,{style:d,src:a.current.preloadThumbnailSrc}),(0,i.jsx)("iframe",{ref:t,id:a.current.src,className:a.current.className,allowFullScreen:!0,src:l,style:{...d,...a.current.style}})]})}))},536505:(e,t,n)=>{n.d(t,{l:()=>o});const o=(0,n(680369).xh)("arrowChevronSingleDown",{default:{loader:()=>n.e(95737).then(n.bind(n,633427))},small:{loader:()=>n.e(95737).then(n.bind(n,663821))},fill:{loader:()=>n.e(95737).then(n.bind(n,267521))},fillSmall:{loader:()=>n.e(95737).then(n.bind(n,166650))}},["chevron","down","arrow","direction","downward"])},538119:(e,t,n)=>{n.d(t,{O:()=>a});var o=()=>n(502140),i=()=>n(582226),s=()=>n(76394),r=()=>n(84543);function a(e){var t;const{environment:n,layoutStore:a}=e,d=a.getPreviousViewsMainCollectionViewBlockPointer(),c=null===(t=a.getModuleByType("viewsMain"))||void 0===t?void 0:t.collection_view_block_pointer;if(!a.getModel()||!a.canEdit())return;const u=a.getBlockChildren(),{blocksToRemoveFromChildArray:m,clearPreviousPointer:p}=function(e){let{previousViewsMainBlockId:t,currentViewsMainBlockId:n,currentBlocksArray:o}=e;if(o.length>1)return l;const i=1===o.length?o[0]:void 0;if((0,s().O9)(n))return(0,s().O9)(t)?{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i===t&&n!==i?[t]:[]}:l;if((0,s().O9)(t)){return i===t?l:{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i?[i]:[]}}return{clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}}({previousViewsMainBlockId:null==d?void 0:d.id,currentViewsMainBlockId:null==c?void 0:c.id,currentBlocksArray:u});if(!p&&0===m.length)return;const g=p?null:d;(0,o().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:a.pointer,expectedPreviousPointer:g,actualPreviousPointer:c??null,actualChildIds:u}}),r().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{if(p&&r().applyOperation({store:a,transaction:e,operation:i().op.update({pointer:a.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),m.length>0)for(const t of m)r().applyOperation({store:a,transaction:e,operation:i().op.removeChild({pointer:a.pointer,path:["blocks"],args:{id:t}})})}})}const l={clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}},543001:(e,t,n)=>{n.d(t,{B:()=>s});var o=()=>n(174114),i=()=>n(220413);function s(e){return(0,o().IS)((t=>({wrapper:{background:e?(0,i().qh)(e,t).color:t.surface.wash,borderRadius:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[e])}},546002:(e,t,n)=>{n.d(t,{J:()=>r});n(403517),n(242343);var o=()=>n(174114),i=()=>n(517198),s=n(163643);function r(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const n=(0,o().IS)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),r=[...Array(t)].map(((e,t)=>(0,s.jsxs)("div",{style:n.skeletonSection,children:[(0,s.jsx)(i().A,{style:n.skeletonCircle}),(0,s.jsxs)("div",{style:{width:"80%"},children:[(0,s.jsx)(i().A,{style:{width:"80%",...n.skeletonRect,marginTop:0}}),(0,s.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}}),(0,s.jsx)(i().A,{style:{width:"60%",...n.skeletonRect}}),(0,s.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}})]})]},t)));return(0,s.jsx)("div",{children:r})}},559181:(e,t,n)=>{n.d(t,{A:()=>s});n(242343);var o=()=>n(653998),i=n(163643);const s=function(e){let{collectionViewName:t,collectionViewType:s}=e;return t?(0,i.jsx)(n(826033).A,{children:t}):"page"===s?(0,i.jsx)(o().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(o().sA,{...n(91338).X[s]})}},569177:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Be});var o=n(242343),i=()=>n(16791),s=()=>n(237385),r=()=>n(803290),a=()=>n(16456),l=()=>n(427091),d=()=>n(972375),c=()=>n(653998),u=()=>n(640979),m=()=>n(622286),p=()=>n(245313),g=()=>n(17969),f=()=>n(792824),h=()=>n(441292),v=()=>n(935091),y=()=>n(743668),b=()=>n(88271),x=()=>n(871002),S=()=>n(535906),M=()=>n(431551),A=n(163643);function w(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("date"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("daterange"===t.type){const e={type:"datetimerange",start_date:t.start_date,start_time:"00:00",end_date:t.end_date,end_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("datetime"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}else{const e={type:"daterange",start_date:t.start_date,end_date:t.end_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}}),[t,n]);return(0,A.jsx)(S().A,{focused:!1,onClick:i,title:(0,A.jsx)(c().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,A.jsx)(M().A,{on:"date"!==t.type&&"daterange"!==t.type,onClick:i})})}var k=()=>n(486826),j=()=>n(910824),C=()=>n(174114),I=()=>n(220413),T=()=>n(76394),_=()=>n(31448),P=()=>n(789894),B=()=>n(772074),R=()=>n(613313),L=()=>n(126451),D=()=>n(209684),N=()=>n(918695),O=()=>n(361837);const E=Object.freeze({backgroundColor:I().Ay.blue,color:I().Ay.white}),U=Object.freeze({backgroundColor:I().Ay.blueWithAlpha(.43)});function F(e,t){switch(e){case g().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case g().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case g().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function K(e,t,n){return void 0===e||"relative"===e||"ll"===e?x().WA(Y(n,t)):x().c1(e)}function V(e,t){return e&&(e!==x().jk||t)?x().B4(e):x()._g}function z(){return(0,d().X)(i().locale).time}function W(e,t,n){return(0,N().FM)(e,V(t,!1),n)}function H(e,t,n,o,i){return o.device.isMobile?(0,N().yc)(e,a().tr,t):(0,N().yc)(e,K(n,t,i),t)}function G(e,t,n,o){return!e||"number"==typeof e&&isNaN(e)?t&&(0,O().NN)(t)?function(e,t){var n,o;const i=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,s=(null==t||null===(o=t.getPropertyTypeSpecificConfig("date"))||void 0===o?void 0:o.includeTime)??!1,r=a().vF({timezone:(0,l().P)()});if(i&&s)return a().NC(r.startOf("day").valueOf(),r.startOf("day").valueOf(),(0,l().P)());if(i)return a().Mk(r.valueOf(),r.valueOf(),(0,l().P)());if(s)return a().Xo(r.startOf("day"));return e}(n,o):n:e}function Y(e,t){return e||t.locale}function q(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,T().HB)(e)}function $(e){let{store:t,dateValue:n,disabled:d,firstDayOfWeek:p,onChangeValue:f}=e;const h=(0,s().v3)(),v=(0,s().Y0)(),y=(0,u().Tf)(),b=(0,m().X)("nds_datepicker_refresh"),S=(0,r().K8)((()=>(0,R().D$)(h)),[h]),{focus:M,currentMonth:w}=(0,r().K8)((()=>({focus:t.state.focus,currentMonth:t.state.currentMonth})),[t]),N=(0,C().IS)((e=>({container:{textAlign:"center",...v.isMobile?{padding:"16px 14px 16px",background:e.popoverBackground,...!y&&{borderBottom:`1px solid ${e.regularDividerColor}`}}:{padding:b?`0 ${B().Qm}px`:"4px 0 4px"}},todayButton:{width:43,height:20},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:I().Ay.uiGray}})),[v.isMobile,y,b]),O=a().AA(n,(0,l().P)()),F=w||O.start,K=O.start.toJSDate(),V=M===g().xQ.StartDate||M===g().xQ.StartTime,z=(0,o.useCallback)(((e,o,i)=>{if(d)return;const s=k().c9.fromJSDate(e).setLocale(x().M5).toFormat(a().tr);if(i.shiftKey&&("date"===n.type||"datetime"===n.type)){const e=q(n,s);return null==f||f(e),void t.setState({...t.state,focus:g().xQ.EndDate})}let r;if(x().oM(n)||x().L3(n)){M===g().xQ.StartDate||M===g().xQ.StartTime?r={...n,start_date:s}:M===g().xQ.EndDate||M===g().xQ.EndTime?r={...n,end_date:s}:(0,T().HB)(M);const e=a().AA(r,(0,l().P)());e.end<e.start&&(x().oM(r)?r={...r,start_date:r.end_date,end_date:r.start_date}:x().L3(r)?r={...r,start_date:r.end_date,start_time:r.end_time,end_date:r.start_date,end_time:r.start_time}:(0,T().HB)(r),t.setState({...t.state,focus:M===g().xQ.StartDate||M===g().xQ.StartTime?g().xQ.EndDate:g().xQ.StartDate})),t.setState({...t.state,focus:M===g().xQ.StartDate||M===g().xQ.StartTime?g().xQ.EndDate:g().xQ.StartDate})}else r={...n,start_date:s};t.setState({...t.state,error:{...t.state.error,[M]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[M]:void 0}}),null==f||f(r)}),[n,d,M,f,t]),W=(0,o.useCallback)((e=>{t.setState({...t.state,currentMonth:k().c9.fromJSDate(e)})}),[t]),H=(0,o.useMemo)((()=>({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today",description:"Label for the button that selects today's date in the calendar"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month",description:"Aria label for the button that navigates to the previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month",description:"Aria label for the button that navigates to the next month"}})),[]),G=(0,o.useMemo)((()=>{if(O.end){const e=O.end.toJSDate();return{modifiers:{range:{from:K,to:e},...V?{end:e,start:K}:{start:K,end:e}},modifiersStyles:{range:{backgroundColor:b?"transparent":I().Ay.blueWithAlpha(.15)},start:V?E:U,end:V?U:E}}}return{selected:K,modifiers:{start:K},modifiersStyles:{start:E}}}),[O.end,K,V,b]),Y=(0,o.useCallback)((e=>(0,A.jsx)("div",{className:"notion-calendar-caption",children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,A.jsx)(j().$J,{displayMonth:e.displayMonth}),(0,A.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,A.jsx)(D().p,{onClick:e=>{W(k().c9.now().toJSDate()),z(k().c9.now().toJSDate(),{},e)},isGray:!0,style:{...N.button,...N.todayButton,fontSize:12,fontWeight:_().Wy.medium},children:(0,A.jsx)(c().sA,{...H.todayButtonLabel})}),(0,A.jsx)(L().A,{onClick:()=>W(k().c9.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...N.button,...N.navButtonSize},"aria-label":H.previousMonthLabel.defaultMessage,children:(0,A.jsx)(j().Bu,{style:N.navButton})}),(0,A.jsx)(L().A,{onClick:()=>W(k().c9.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...N.button,...N.navButtonSize},"aria-label":H.nextMonthLabel.defaultMessage,children:(0,A.jsx)(j()._l,{style:N.navButton})})]})]})})),[z,N.button,N.navButtonSize,N.todayButton,N.navButton,W,H.nextMonthLabel,H.previousMonthLabel,H.todayButtonLabel]);return(0,A.jsx)("div",{style:N.container,children:S?(0,A.jsx)(P().n,{className:"notion-date-property-menu notranslate",components:{Caption:Y},numberOfMonths:1,weekStartsOn:p,defaultMonth:F.toJSDate(),month:F.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:z,onMonthSelected:W,...G}):(0,A.jsx)(P().n,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:p,defaultMonth:F.toJSDate(),month:F.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:z,onMonthSelected:W,...G})})}function Q(e){let{onChangeValue:t}=e;const n=(0,o.useCallback)((()=>{null==t||t(void 0)}),[t]);return(0,A.jsx)(S().A,{focused:!1,onClick:n,title:(0,A.jsx)(c().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}function Z(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("datetimerange"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:t.start_time,time_zone:t.time_zone,reminder:t.reminder};null==n||n(e)}else if("daterange"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder};null==n||n(e)}else{const e=q(t);null==n||n(e)}}),[t,n]);return(0,A.jsx)(S().A,{focused:!1,onClick:i,title:(0,A.jsx)(c().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,A.jsx)(M().A,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:i})})}n(403517);const X=(0,c().YK)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function J(e){const{reminder:t,shouldShowTime:n,intl:o,formatTime:i}=e;if(!t)return o.formatMessage(X.none);if(x().fc(t)){const{unit:e,value:s,time:r}=t,a=i({start_time:r,time_format:"LT",humanReadable:!0,intl:o}),l=n?`(${a})`:"";return 0===s?o.formatMessage(X.onTheDay,{formattedTimeText:l}):"day"===e?o.formatMessage(X.daysBefore,{formattedTimeText:l,numberOfDays:s}):"year"===e?o.formatMessage(X.yearsBefore,{formattedTimeText:l,numberOfYears:s}):"month"===e?o.formatMessage(X.monthsBefore,{formattedTimeText:l,numberOfMonths:s}):o.formatMessage(X.weeksBefore,{formattedTimeText:l,numberOfWeeks:s})}{const{unit:e,value:n}=t;return 0===n?o.formatMessage(X.atTimeOf):"hour"===e?o.formatMessage(X.hoursBefore,{numberOfHours:n}):o.formatMessage(X.minutesBefore,{numberOfMinutes:n})}}var ee=()=>n(846581),te=()=>n(508026),ne=()=>n(975392),oe=()=>n(137476);var ie=()=>n(273520),se=()=>n(918625),re=()=>n(858023),ae=()=>n(397791);function le(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,m().X)("nds_datepicker_refresh"),r=(0,s().v3)(),{device:a}=r,d=(0,c().tz)(),p=(0,m().X)("db_ux_mobile"),g=(0,o.useCallback)((e=>{e?x().fc(e)?null==n||n({...t,reminder:{...e,defaultTimeZone:(0,l().P)()}}):"datetime"!==t.type&&"datetimerange"!==t.type||null==n||n({...t,reminder:e}):null==n||n({...t,reminder:e}),function(e,t){oe().vd(e,"set_reminder",{date:t.date,reminder:t.reminder})}(r,{date:t,reminder:e})}),[t,r,n]),f=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,icon:i?void 0:(0,A.jsx)(ae().I,{icon:te().alarmIcon}),title:(0,A.jsx)(c().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:a.isMobile,chevronType:"right",right:J({reminder:t.reminder,intl:d,formatTime:ee().fU})})),[t.reminder,a.isMobile,d,i]),h=(0,o.useCallback)((e=>{let n;n=a.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),...!p&&{right:(0,A.jsx)(y().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250};const o=("date"===t.type||"daterange"===t.type?x().vK:x().SA).map((n=>{const o=J({reminder:n,shouldShowTime:!0,intl:d,formatTime:ee().fU});return{key:o,action:()=>{g(n),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:o,isChecked:ne().n4(n,t.reminder)})}}));return(0,A.jsx)(v().A,{...n,children:(0,A.jsx)(re().Ay,{type:re().Oh.Vertical,sections:[{key:"reminder section",render:e=>(0,A.jsx)(b().A,{...e}),items:o}],initialFocus:void 0})})}),[t.type,t.reminder,a.isMobile,d,g,p]);return(0,A.jsx)(ie().Ay,{popupType:a.isMobile?p?ie().z7.BottomSheet:ie().z7.SlideUp:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:f,render:h})}function de(e){let{dateValue:t,shouldShowReminder:n,shouldShowEndDateControl:o,shouldShowAllDayControl:i,onChangeValue:r}=e;return(0,s().Y0)().isMobile?n||o||i?(0,A.jsxs)(b().A,{topBorder:!0,children:[n&&(0,A.jsx)(le,{dateValue:t,onChangeValue:r}),o&&(0,A.jsx)(Z,{dateValue:t,onChangeValue:r}),i&&(0,A.jsx)(w,{dateValue:t,onChangeValue:r})]}):null:(0,A.jsxs)(A.Fragment,{children:[n&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(le,{dateValue:t,onChangeValue:r})}),(o||i)&&(0,A.jsxs)(b().A,{topBorder:!0,children:[o&&(0,A.jsx)(Z,{dateValue:t,onChangeValue:r}),i&&(0,A.jsx)(w,{dateValue:t,onChangeValue:r})]})]})}var ce=()=>n(158918);function ue(e){let{dateFormat:t,onChangeDateFormat:n}=e;const i=(0,m().X)("nds_datepicker_refresh"),r=(0,m().X)("db_ux_mobile"),{isMobile:a}=(0,s().Y0)(),l=(0,c().tz)(),d=t||x().vz,p=(0,o.useCallback)((e=>e),[]),g=(0,o.useCallback)((e=>{null==n||n(e)}),[n]),f=(0,o.useCallback)((e=>(0,A.jsx)(S().A,{...e,title:l.formatMessage(x().xz[e.value])})),[l]),h=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,focused:!1,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),showExtensionArrow:a,chevronType:i?"right":"down",right:d?l.formatMessage(x().xz[d]):(0,A.jsx)(c().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[d,l,i,a]),M=(0,o.useMemo)((()=>({menuTitle:l.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:x().wJ,getKey:p,selectedItem:d,onSelect:g,renderItem:f,renderOrigin:h})),[d,p,l,g,f,h]);if(i){const e=e=>{const t=x().wJ.map((t=>({key:t,action:()=>{g(t),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:l.formatMessage(x().xz[t]),isChecked:t===d})})));let n={menuType:u().gu.Popup};return a&&(n={menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),...!r&&{right:(0,A.jsx)(y().DoneMenuText,{}),onClickRight:e.close}}),(0,A.jsx)(v().A,{...n,children:(0,A.jsx)(re().Ay,{type:re().Oh.Vertical,initialFocus:void 0,sections:[{key:"date format section",render:e=>(0,A.jsx)(b().A,{...e}),items:t}]})})};return(0,A.jsx)(ie().Ay,{popupType:a?ie().z7.BottomSheet:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:h,render:e})}return(0,A.jsx)(ce().A,{...M})}var me=()=>n(207573);function pe(e){let{dateValue:t,timeFormat:n,onChangeTimeFormat:i}=e;const r=(0,m().X)("nds_datepicker_refresh"),a=(0,m().X)("db_ux_mobile"),{isMobile:l}=(0,s().Y0)(),d=(0,c().tz)(),p="date"===t.type||"daterange"===t.type,g=V(n,!0),f=function(e){const t=V(e,!0),n=z();for(const o in n)if(n[o]===t)return o;return"12h"}(n),h=z(),M=(0,o.useCallback)((e=>e),[]),w=(0,o.useCallback)((e=>{const t=h[e];null==i||i(t)}),[i,h]),k=(0,o.useCallback)((e=>(0,A.jsx)(S().A,{...e,title:d.formatMessage(x().px[e.value])})),[d]),j=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,focused:!1,title:(0,A.jsx)(c().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:p,showExtensionArrow:l,chevronType:r?"right":"down",right:!p&&(g?d.formatMessage(x().px[f]):(0,A.jsx)(c().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[d,p,r,l,f,g]),C=(0,o.useMemo)((()=>({menuTitle:d.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:x().ZD,selectedItem:f,disabled:p,getKey:M,onSelect:w,renderItem:k,renderOrigin:j})),[M,d,p,w,k,j,f]);if(r){if(p)return null;const e=e=>{const t=x().ZD.map((t=>({key:t,action:()=>{w(t),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:d.formatMessage(x().px[t]),isChecked:t===f})})));let n={menuType:u().gu.Popup};return l&&(n={menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.mobileTimeFormatModal.title"}),...!a&&{right:(0,A.jsx)(y().DoneMenuText,{}),onClickRight:e.close}}),(0,A.jsx)(v().A,{...n,children:(0,A.jsx)(re().Ay,{type:re().Oh.Vertical,initialFocus:void 0,sections:[{key:"time format section",render:e=>(0,A.jsx)(b().A,{...e}),items:t}]})})};return(0,A.jsx)(ie().Ay,{popupType:l?ie().z7.BottomSheet:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:j,render:e})}return(0,A.jsx)(ce().A,{...C})}function ge(e){const{dateValue:t,dateFormat:n,timeFormat:r,onChangeDateFormat:p,onChangeTimeFormat:g,onChangeValue:f}=e,h=(0,s().Y0)(),x=!d().V.includes(i().locale),M="date"===t.type||"daterange"===t.type,w="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().P)(),k=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const n={...t,time_zone:e};null==f||f(n)}}),[t,f]),j=(0,m().X)("db_ux_mobile");return(0,A.jsxs)(A.Fragment,{children:[!M&&(0,A.jsx)(me().G,{enableRecents:!0,placementToOrigin:ie().sx.Right,currentValue:w,onSelect:k,renderOrigin:e=>(0,A.jsx)(se()._,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!M&&a().GF(w),chevronType:"right"})}),(0,A.jsx)(ie().Ay,{popupType:h.isMobile?j?ie().z7.BottomSheet:ie().z7.SlideUp:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:e=>(0,A.jsx)(S().A,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.label"}),focused:!1,showExtensionArrow:!0}),render:e=>{let o;return o=h.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.title"}),...!j&&{right:(0,A.jsx)(y().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250},(0,A.jsx)(v().A,{...o,children:(0,A.jsxs)(b().A,{children:[(0,A.jsx)(ue,{dateFormat:n,onChangeDateFormat:p}),x&&(0,A.jsx)(pe,{dateValue:t,timeFormat:r,onChangeTimeFormat:g})]})})}})]})}var fe=()=>n(141666),he=()=>n(907721),ve=()=>n(59175),ye=()=>n(103151);const be=12;function xe(e){let{store:t,disabled:n,locale:i,format:d,dateFormat:u,timeFormat:p,dateValue:f,formQuestionStore:h,onChangeValue:v}=e;const y=(0,s().v3)(),{device:b,WindowSizeStore:S}=y,M=(0,c().tz)(),w=(0,m().X)("nds_datepicker_refresh"),{focus:k,inputTemporaryValue:j,error:I}=(0,r().K8)((()=>({focus:t.state.focus,inputTemporaryValue:t.state.inputTemporaryValue,error:t.state.error})),[t]),{formQuestionHasEndDate:_,formQuestionIncludesTime:P}=(0,r().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==h||null===(e=h.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==h||null===(t=h.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[h]),R=(0,o.useMemo)((()=>a().AA(f,(0,l().P)(),Y(i,M))),[f,i,M]),L=d&&(0,O().NN)(d)?P:"datetime"===f.type||"datetimerange"===f.type,D=d&&(0,O().NN)(d)?_:"daterange"===f.type||"datetimerange"===f.type,N=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startDate;if(!e)return;const n=H(e,M,u,y,i);if(!n)return g().dz.InvalidDate;const o={...f,start_date:n},s=a().Dz(o);if(!s)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:s.start,error:{...t.state.error,[g().xQ.StartDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartDate]:void 0}}),null==v||v(o)}),[u,f,y,M,i,v,t]),E=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startTime;if(!e)return;const n=W(e,p,M);if(!n)return g().dz.InvalidTime;if(x().L3(f)){const{newDate:e,currentMonth:o}=a().uj({previous:f,updatedStartTime:n});t.setState({...t.state,currentMonth:o,error:{...t.state.error,[g().xQ.StartTime]:void 0,[g().xQ.EndDate]:void 0,[g().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartTime]:void 0}}),null==v||v(e)}else{if(!x().Ar(f))return g().dz.InvalidTime;{const e={...f,start_time:n},o=a().Dz(e);t.setState({...t.state,currentMonth:o.start,error:{...t.state.error,[g().xQ.StartTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartTime]:void 0}}),null==v||v(e)}}}),[f,M,v,t,p]),U=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endDate;if(!e)return;const n=H(e,M,u,y,i);if(!n)return g().dz.InvalidDate;if(!x().oM(f)&&!x().L3(f))return;const o={...f,end_date:n},s=a().Dz(o);if(!s)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:s.end,error:{...t.state.error,[g().xQ.EndDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.EndDate]:void 0}}),null==v||v(o)}),[u,f,y,M,i,v,t]),F=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endTime;if(!e)return;const n=W(e,p,M);if(!n)return g().dz.InvalidTime;if(!x().L3(f))return;const o={...f,end_time:n},i=a().Dz(o);if(!i)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[g().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.EndTime]:void 0}}),null==v||v(o)}),[f,M,v,t,p]),K=(0,o.useCallback)((()=>{t.setState({...t.state,focus:g().xQ.StartDate,inputIsFocused:!0,currentMonth:R.start})}),[R.start,t]),V=(0,o.useCallback)((()=>{t.setState({...t.state,focus:g().xQ.StartTime,inputIsFocused:!0,currentMonth:R.start})}),[R.start,t]),z=(0,o.useCallback)((()=>{R.end&&t.setState({...t.state,focus:g().xQ.EndDate,inputIsFocused:!0,currentMonth:R.end})}),[R.end,t]),G=(0,o.useCallback)((()=>{R.end&&t.setState({...t.state,focus:g().xQ.EndTime,inputIsFocused:!0,currentMonth:R.end})}),[R.end,t]),q=(0,o.useCallback)((()=>{let e;if(t.state.focus===g().xQ.StartDate)e=N();else if(t.state.focus===g().xQ.StartTime)e=E();else if(t.state.focus===g().xQ.EndDate)e=U();else{if(t.state.focus!==g().xQ.EndTime)return(0,T().HB)(t.state.focus);e=F()}e?t.setState({...t.state,error:{...t.state.error,[t.state.focus]:e}}):t.setState({...t.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[U,F,N,E,t]),$=(0,o.useCallback)((e=>{t.setState({...t.state,inputTemporaryValue:{...t.state.inputTemporaryValue,[t.state.focus]:e.target.value||""}}),b.isAndroid&&q()}),[b.isAndroid,q,t]),[Q,Z]=(0,r().K8)((()=>[b.isMobile?S.getSafePaddingLeftCSS(16):w?B().Qm:14,b.isMobile?S.getSafePaddingRightCSS(16):w?B().Qm:14]),[b.isMobile,w,S]),X=(0,C().IS)((e=>({container:{paddingTop:b.isMobile?16:8,paddingBottom:b.isMobile?16:8,paddingLeft:Q,paddingRight:Z,display:L?"block":"flex",...b.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:b.isMobile?e.popoverBackground:void 0}})),[b.isMobile,Q,Z,L]);return(0,A.jsxs)("div",{style:X.container,children:[(0,A.jsx)(Se,{inputDateValue:j.startDate,inputTimeValue:j.startTime,rangeValue:R.start,disabled:n,dateError:I.startDate,timeError:I.startTime,isDateFocused:k===g().xQ.StartDate,isTimeFocused:k===g().xQ.StartTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:u,timeFormat:p,onChange:$,onDateFocus:K,onTimeFocus:V,onBlur:q,onSubmit:q}),D&&(0,A.jsx)("div",{style:{width:12,height:8}}),R.end&&(0,A.jsx)(Se,{inputDateValue:j.endDate,inputTimeValue:j.endTime,rangeValue:R.end,disabled:n,dateError:I.endDate,timeError:I.endTime,isDateFocused:k===g().xQ.EndDate,isTimeFocused:k===g().xQ.EndTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:u,timeFormat:p,onChange:$,onDateFocus:z,onTimeFocus:G,onBlur:q,onSubmit:q})]})}function Se(e){let{inputDateValue:t,inputTimeValue:n,rangeValue:i,disabled:r,dateError:l,timeError:d,isDateFocused:u,isTimeFocused:m,hasTime:p,hasEndDate:g,locale:f,dateFormat:h,timeFormat:v,onChange:y,onDateFocus:b,onTimeFocus:S,onBlur:M,onSubmit:w}=e;const k=(0,s().Y0)(),j=(0,c().tz)(),I=(0,T().O9)(l)||(0,T().O9)(d),_=u||m,P=(0,C().IS)((e=>({input:Me(k,e,I,_,g),separator:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})),[k,I,_,g]),B=(0,o.useCallback)((()=>F(l,j)),[l,j]),R=(0,o.useCallback)((()=>F(d,j)),[d,j]),L=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,fe().pN)(t)?i.toFormat(a().tr):t;return(0,A.jsx)(ve().A,{type:"date",format:ve().C.Transparent,value:e,onChange:y,onFocus:b,onBlur:M,onSubmit:w,disabled:r,size:1})}{const e=(0,fe().pN)(t)?i.toFormat(K(h,j,f)):t;return(0,A.jsx)(ve().A,{selectAll:!0,format:ve().C.Transparent,value:e,focusInitial:u,onChange:y,onFocus:b,onBlur:M,onSubmit:w,disabled:r,size:1})}}),[h,k.isMobile,r,M,y,b,w,t,j,u,f,i]),D=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,fe().pN)(n)?i.toFormat(x().GE):n;return(0,A.jsx)(ve().A,{type:"time",format:ve().C.Transparent,value:e,onChange:y,onFocus:S,onBlur:M,onSubmit:w,size:1,disabled:r})}{const e=(0,fe().pN)(n)?i.toFormat(V(v,!1)):n;return(0,A.jsx)(ve().A,{format:ve().C.Transparent,value:e,focusInitial:m,onChange:y,onFocus:S,onBlur:M,onSubmit:w,size:1,disabled:r})}}),[k.isMobile,r,M,y,w,S,n,m,i,v]);return(0,A.jsxs)("div",{style:P.input,children:[(0,A.jsx)(ye().A,{renderTooltip:B,originGap:be,forceVisibleState:(0,T().O9)(l),placement:he().W.Left,render:L}),p&&(0,A.jsx)("div",{style:P.separator}),p&&(0,A.jsx)(ye().A,{renderTooltip:R,originGap:be,forceVisibleState:(0,T().O9)(d),placement:he().W.Right,render:D})]})}function Me(e,t,n,o,i){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingLeft:8,paddingRight:8,flexBasis:"50%",flexGrow:1,fontSize:e.isMobile?16:14,...n?{background:I().Ay.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${I().Ay.red}`}:o&&i?{background:I().Ay.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${I().Ay.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var Ae=()=>n(392608),we=()=>n(797631),ke=()=>n(442958);function je(){return(0,s().Y0)().isMobile?(0,A.jsx)(ke().A,{href:(0,Ae().xS)("guides.reminders"),analyticsFrom:"date_selector"}):(0,A.jsx)(we().A,{title:(0,A.jsx)(c().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,Ae().xS)("guides.reminders"),analyticsFrom:"date_selector"})}function Ce(e){const{dateValue:t,onChangeValue:n}=e,{isMobile:i}=(0,s().Y0)(),r="date"===t.type||"daterange"===t.type,d="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().P)(),u=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const o={...t,time_zone:e};null==n||n(o)}}),[t,n]);return r?null:(0,A.jsx)(me().G,{enableRecents:!0,placementToOrigin:ie().sx.Right,currentValue:d,onSelect:u,renderOrigin:e=>(0,A.jsx)(se()._,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!r&&a().GF(d),showExtensionArrow:i,chevronType:"right"})})}var Ie=()=>n(247200),Te=()=>n(466139);function _e(e){const{onChangeValue:t}=e,n=(0,c().tz)();return(0,A.jsx)(b().A,{title:(0,A.jsx)(c().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,A.jsx)(S().A,{title:(0,A.jsx)(Te().W,{templateVariableType:e}),caption:(0,Ie().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}function Pe(e){let{store:t,value:n,header:p,isTemplatePage:g,shouldShowReminder:h,shouldShowControls:x=!0,canConfigureCollection:S,disabled:M,format:k,dateFormat:j,timeFormat:C,firstDayOfWeek:I,formQuestionStore:T,onChangeValue:_,onChangeDateFormat:P,onChangeTimeFormat:B,onDismiss:R}=e;const L=(0,s().Y0)(),D=(0,m().X)("nds_datepicker_refresh"),N=(0,m().X)("db_ux_mobile"),O=(0,o.useMemo)((()=>a().Ec((0,l().P)())),[]),E=(0,r().K8)((()=>G(n,k,O,T)),[n,k,O,T]),U=(0,r().K8)((()=>t.state.inputIsFocused),[t]),F=(0,o.useMemo)((()=>L.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),...!N&&{right:(0,A.jsx)(y().DoneMenuText,{}),onClickRight:R},left:h?(0,A.jsx)(je,{}):void 0,header:(0,A.jsx)(b().A,{children:(0,A.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:k,dateFormat:j,timeFormat:C,dateValue:E,formQuestionStore:T,onChangeValue:_})})}:{menuType:u().gu.Popup,maxHeight:"none",width:D?"min-content":270,header:p}),[j,E,L.isMobile,M,k,T,p,D,_,R,h,t,C,N]),K=!d().V.includes(i().locale);return(0,A.jsxs)(v().A,{...F,children:[(0,A.jsx)(f().A,{show:U}),g&&(0,A.jsx)(_e,{onChangeValue:_}),(0,A.jsxs)(b().A,{topBorder:g,children:[!L.isMobile&&(0,A.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:k,dateFormat:j,timeFormat:C,dateValue:E,formQuestionStore:T,onChangeValue:_}),(0,A.jsx)($,{store:t,dateValue:E,firstDayOfWeek:I,disabled:M,onChangeValue:_})]}),M?null:(0,A.jsxs)(A.Fragment,{children:[D&&(h||x)?(0,A.jsxs)(b().A,{topBorder:!0,children:[x&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Z,{dateValue:E,onChangeValue:_}),S&&(0,A.jsx)(ue,{dateFormat:j,onChangeDateFormat:P}),(0,A.jsx)(w,{dateValue:E,onChangeValue:_}),S&&K&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(pe,{dateValue:E,timeFormat:C,onChangeTimeFormat:B}),(0,A.jsx)(Ce,{dateValue:E,onChangeValue:_})]})]}),h&&(0,A.jsx)(le,{dateValue:E,onChangeValue:_})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(de,{dateValue:E,shouldShowReminder:h,shouldShowEndDateControl:x,shouldShowAllDayControl:x,onChangeValue:_}),S&&x&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(ge,{dateValue:E,dateFormat:j,timeFormat:C,onChangeDateFormat:P,onChangeTimeFormat:B,onChangeValue:_})})]}),(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(Q,{onChangeValue:_})}),!L.isMobile&&h&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(je,{})})]})]})}function Be(e){const t=(0,r().uB)(void 0,g().Ay),n=(0,r().K8)((()=>t.state.inputIsFocused),[t]);return(0,p().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,A.jsx)(h().A,{debugName:"DatePropertyMenu",capture:n,allowEsc:!0,children:(0,A.jsx)(h().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,A.jsx)(Pe,{store:t,...e})})})}},571107:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>Yt});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(668657),l=()=>n(653998),d=()=>n(31448),c=(n(610931),n(358848),n(91270),n(725707),n(500234),n(403517),n(113085),()=>n(16791)),u=()=>n(712437),m=()=>n(762847),p=()=>n(392610),g=()=>n(170582),f=()=>n(934889),h=()=>n(680369),v=n(163643);const y=(0,h().wt)("fontStyleMono",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M6.817 12 6.08 9.513H3.017L2.28 12H1.192l2.675-8.725h1.388L7.93 12zM4.605 4.388h-.113L3.267 8.6H5.83zm10.008 7.399q0 1.338-.75 2.1-.75.763-2.088.763-1.45 0-2.313-.888l.588-.687q.676.7 1.737.7 1.825 0 1.825-1.925v-1.075h-.05q-.625 1.2-1.987 1.2-1.175 0-1.85-.875-.675-.888-.675-2.412t.675-2.4q.675-.888 1.85-.888 1.361 0 1.988 1.2h.05V5.55h1zm-2.65-.7q.7 0 1.175-.35t.475-.974v-2.15q0-.626-.476-.975-.474-.35-1.175-.35-.862 0-1.35.525-.487.524-.487 1.412v.925q0 .888.488 1.412.487.526 1.35.526Z"})})}),b=(0,h().wt)("fontStyleSans",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"m.76 12 3.248-8.807h.842v1.422h-.348L1.914 12H.761Zm1.472-2.52.341-.935h3.98l.342.934H2.232ZM7.188 12 4.6 4.615V3.193h.494L8.341 12zm4.557 2.32q-.793 0-1.385-.226a2.26 2.26 0 0 1-.947-.63 1.86 1.86 0 0 1-.433-.94l.012-.005h1.099l.006.006q.085.373.513.61.427.244 1.135.244.885 0 1.38-.402.5-.398.5-1.123v-1.331h-.098a2.24 2.24 0 0 1-1.22 1.007q-.39.128-.843.128-.848 0-1.47-.403a2.7 2.7 0 0 1-.953-1.123q-.336-.714-.336-1.635v-.013q0-.922.336-1.635.342-.72.964-1.13.623-.415 1.484-.415.464 0 .854.147t.69.415q.305.269.506.64h.074V5.42h1.062v6.488q0 .733-.36 1.276a2.27 2.27 0 0 1-1.014.836q-.66.3-1.556.3m-.049-3.602q.61 0 1.044-.28.44-.288.671-.788.238-.5.238-1.153v-.013q0-.653-.238-1.16a1.84 1.84 0 0 0-.671-.793q-.434-.287-1.044-.287t-1.037.287a1.83 1.83 0 0 0-.647.794 2.9 2.9 0 0 0-.22 1.16v.012q0 .653.22 1.153.225.5.646.787.428.282 1.038.281"})})}),x=(0,h().wt)("fontStyleSerif",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.29 12v-.416l.753-.299 3.16-7.982.441-.065.455-.13 2.99 8.177.884.286V12h-3.34v-.429l1.104-.299-.793-2.275H2.772l-.754 2.119 1.248.455V12zm4.08-7.462L3.058 8.217h2.613L4.384 4.538h-.013Zm10.764 2.106-1.482-.078-.013.039c.325.273.663.754.663 1.443 0 1.417-1.287 2.327-2.587 2.327q-.488 0-.936-.156c-.3.234-.455.455-.455.65 0 .182.182.429.48.442l2.458.143c1.287.078 1.859.65 1.859 1.456 0 1.079-1.391 2.405-3.81 2.405-1.234 0-2.352-.52-2.352-1.469 0-.481.325-1.027.949-1.365l.312-.169v-.026l-.923-.884c.26-.663.546-.988 1.027-1.391C9.726 9.647 9.297 9.01 9.297 8.1c0-1.417 1.105-2.379 2.496-2.379.598 0 1.014.143 1.534.325l1.807-.195zM11.87 9.816c.689 0 1.248-.611 1.248-1.599 0-1.391-.624-1.989-1.404-1.989-.767 0-1.222.572-1.222 1.56 0 1.274.533 2.028 1.378 2.028m1.274 2.691-2.457-.156c-.195.208-.56.689-.56 1.157 0 .481.43 1.157 1.795 1.157 1.599 0 2.262-.767 2.262-1.365 0-.455-.3-.741-1.04-.793"})})});var S=()=>n(954397),M=()=>n(974567);const A={viewBox:"0 0 20 20",svg:(0,v.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},w=(0,h().wt)("textSmall",A),k=(0,h().wt)("textStyleIcon",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.74 13.097c-.355 0-.574-.212-.574-.554 0-.116.02-.226.075-.37l3.206-8.55q.226-.625.862-.623c.437 0 .717.212.875.629l3.206 8.538a1 1 0 0 1 .075.37c0 .34-.233.56-.595.56-.355 0-.533-.137-.663-.52l-.882-2.413H2.292l-.882 2.413c-.13.383-.307.52-.67.52m1.887-3.972h3.356l-1.66-4.6h-.035zm9.604 4.02c-1.449 0-2.454-.875-2.454-2.181 0-1.272.964-2.071 2.694-2.167l2.208-.123v-.588c0-.957-.636-1.552-1.702-1.552-.89 0-1.47.37-1.853 1.162-.103.192-.267.274-.479.274-.293 0-.519-.199-.519-.5 0-.143.055-.307.13-.478.39-.882 1.463-1.449 2.748-1.449 1.736 0 2.83.964 2.83 2.454v4.56c0 .369-.232.594-.56.594-.322 0-.554-.225-.554-.567v-.902h-.028c-.423.888-1.408 1.463-2.46 1.463Zm.28-.95c1.204 0 2.168-.855 2.168-1.942v-.725l-2.065.13c-1.073.069-1.654.554-1.654 1.279 0 .752.629 1.257 1.552 1.257Z"})})});var j=()=>n(86280),C=()=>n(220413),I=()=>n(975392),T=()=>n(927999),_=()=>n(267611),P=()=>n(759625),B=()=>n(84543),R=()=>n(486963),L=()=>n(691898),D=()=>n(331516),N=()=>n(639607),O=()=>n(88271),E=()=>n(906230),U=()=>n(907721),F=()=>n(126451),K=()=>n(858023),V=()=>n(103151),z=()=>n(35462);function W(e,t){return e.isFiltering?function(e){return(0,v.jsx)(D().A,{...e,title:e.caption,caption:void 0})}(e):function(e,t){let{id:n,caption:s,focused:a,isActive:l,onClick:d,onMouseDown:c,onMouseEnter:u,onMouseLeave:m,role:p,style:g,tooltip:f,ignoreLocalHoverState:h,disallowTabbing:y}=e;const b=(0,i().Y0)(),{isMenuListFocusVisible:x}=(0,o.useContext)(K().VU),S=(0,r().IS)((e=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...b.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:l?C().Ay.blue:"inherit",...a&&x&&{boxShadow:e.outlineBlueInputBoxShadow}}})),[l,b,x,a]);return(0,v.jsx)(V().A,{renderTooltip:()=>f,placement:U().W.Bottom,delayThreshold:80,render:e=>{const o=(0,E().A)(e,{onMouseEnter:u,onMouseLeave:m}),{onMouseDown:i,...r}=o;return(0,v.jsx)(F().A,{...r,id:n,role:p,ref:t,mobileFeedback:b.isMobile,onClick:d,onMouseDown:o.onMouseDown||c,hovered:a,style:S.button,ignoreLocalHoverState:h,disallowTabbing:y,className:"notranslate",children:(0,v.jsxs)("div",{style:S.optionItem,children:[(0,v.jsx)("div",{style:{...g,height:25},children:"Ag"}),(0,v.jsx)(z().A,{isSmall:!0,style:{marginTop:4},children:s})]})})}})}(e,t)}const H=o.forwardRef(W);const G=function(e){const{children:t}=e,n=(0,i().v3)(),{mobileStyle:o,desktopStyle:s}=(0,r().IS)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,v.jsx)(O().A,{...e,children:(0,v.jsx)("div",{style:n.device.isMobile?o:s,children:t})})};var Y=()=>n(326259),q=()=>n(76394),$=()=>n(471979);function Q(e){const{intl:t,blockStore:n}=e,o=(0,$().i1)(n);if("none"!==o.type){if("expired"===o.type)return t.formatMessage(Z.expiredVerification);if("verified"===o.type){if(o.isIndefinite)return t.formatMessage(Z.indefiniteVerification);{const e=o.dateTimeRange.end,n=(0,Y().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(Z.verificationWithEndDate,{date:n})}}(0,q().HB)(o)}}const Z=(0,l().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var X=()=>n(837583),J=()=>n(106804),ee=()=>n(32901),te=()=>n(865226),ne=()=>n(944498),oe=()=>n(28416),ie=()=>n(29869);const se=(0,l().YK)({openInMacAppName:{id:"action.openInMacApp.name",defaultMessage:"Open in Mac app"},openInWindowsAppName:{id:"action.openInWindowsApp.name",defaultMessage:"Open in Windows app"},openIniOSAppName:{id:"action.openIniOSApp.name",defaultMessage:"Open in iOS app"},openInAndroidAppName:{id:"action.openInAndroidApp.name",defaultMessage:"Open in Android app"}}),re=(0,ee().Ls)({key:"open in mac app",displayName:se.openInMacAppName,analyticsName:se.openInMacAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().cX8,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),ae=(0,ee().Ls)({key:"open in windows app",displayName:se.openInWindowsAppName,analyticsName:se.openInWindowsAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().uFH,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),le=(0,ee().Ls)({key:"open in ios app",displayName:se.openIniOSAppName,analyticsName:se.openIniOSAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().un6,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}}),de=(0,ee().Ls)({key:"open in android app",displayName:se.openInAndroidAppName,analyticsName:se.openInAndroidAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().m01,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}});function ce(){return[re,ae,le,de]}var ue=()=>n(241592),me=()=>n(574541),pe=()=>n(640979),ge=()=>n(840024),fe=()=>n(802955),he=()=>n(615661),ve=()=>n(935091),ye=()=>n(743668),be=()=>n(793613);function xe(e){const{blockStore:t,menuListItemProps:a,title:d,onFocus:c,closeParentMenu:u}=e,m=(0,i().v3)(),p=(0,r().DP)(),g=(0,pe().Tf)(),f=(0,s().K8)((()=>ge().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:h}=(0,n(747588).H)({pageStore:t,enabled:f}),y=(0,n(751895).n)(),[b,x]=(0,o.useState)(void 0),S=b??h??y,{isTranslating:M,editorModeConfigTranslateState:A}=(0,s().K8)((()=>{const e=he().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:S}}}),[t,S]),w=!(0,s().O$)(fe().e),k=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;x(t)}),[]),j=(0,o.useCallback)((e=>{const{targetLanguage:n}=e;me().Z9({pageStore:t,environment:m}),me().Ww({pageStore:t,targetLanguage:n,sourceLanguage:S,environment:m,triggeredFrom:"action_menu"}),u()}),[t,S,m,u]),C=(0,s().K8)((()=>(0,ee().cz)(p,M)),[M,p]);return"pre_activation"!==A.status||w?(0,v.jsx)(D().A,{...a,title:d,badge:(0,v.jsx)(be().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C,onClick:()=>{me().DL({pageStore:t,environment:m,triggeredFrom:"action_menu"}),u()},disabled:w,disabledFeedback:w,tooltipText:w?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0}):(0,v.jsx)(n(350208).A,{...a,disableDefaultClick:!0,onFocus:c,focused:a.focused,disableCloseOnEnter:!0,renderExtension:(e,o)=>{const i=m.device.isMobile?{menuType:pe().gu.Modal,right:g?void 0:(0,v.jsx)(ye().DoneMenuText,{}),left:g?(0,v.jsx)(ye().MobileModalBackButton,{}):void 0,onClickRight:g?void 0:o.close,onClickLeft:g?o.close:void 0,shouldRenderMobileRefresh:g,paddingTop:g?10:void 0,title:d,...e}:{menuType:pe().gu.Popup,height:480,...e};return(0,v.jsx)(ve().A,{...i,onClick:e=>{e.stopPropagation()},children:(0,v.jsx)(n(749840).Z,{onSelectTargetLanguage:j,onSelectSourceLanguage:k,editorModeConfigTranslateState:A,sourceLanguage:S,detectedPageLanguage:h,preferredLanguage:y,subMenuPlacement:U().W.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,v.jsx)(D().A,{...e,ref:t,title:d,badge:(0,v.jsx)(be().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C})})}var Se=()=>n(137476),Me=()=>n(477784),Ae=()=>n(481148),we=()=>n(279136),ke=()=>n(895269),je=()=>n(667801),Ce=()=>n(370557),Ie=()=>n(485966),Te=()=>n(836331),_e=()=>n(330358),Pe=()=>n(304816),Be=()=>n(611168),Re=()=>n(172007);const Le=(0,l().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),De=(0,ee().fi)({key:"ai_co_editing",displayName:Le.aiCoEditingName,label:Me().A.formatMessage(Le.aiCoEditingName),svg:n(486796).sparklesIcon,isEnabled:e=>e.isNavigableBlock()&&(0,Re().Wv)(e,e.environment),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().ln6),()=>ge().zD.isAiEnabled(),ne().SQN("ai_co_editing")],action:async(e,t,n)=>{if(!t.isNavigableBlock())return;const o=(0,Re().Wv)(t,e);if(await(0,Be().ne)({environment:e,pageId:t.id,active:!o}),o){(await(0,Be().gY)()).clearStore()}}});var Ne=()=>n(641546),Oe=()=>n(488036),Ee=()=>n(781891),Ue=()=>n(578964);const Fe={viewBox:"0 0 20 20",svg:(0,v.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})},Ke=(0,h().wt)("comment",Fe),Ve={viewBox:"0 0 20 20",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M10 5.88c.345 0 .625.28.625.625V8.38H12.5a.625.625 0 1 1 0 1.25h-1.875v1.875a.625.625 0 1 1-1.25 0V9.63H7.5a.625.625 0 1 1 0-1.25h1.875V6.505c0-.345.28-.625.625-.625"}),(0,v.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},ze=(0,h().wt)("commentAdd",Ve);var We=()=>n(213255),He=()=>n(826403),Ge=()=>n(18376),Ye=()=>n(899037),qe=()=>n(772785),$e=()=>n(842492),Qe=()=>n(712048),Ze=()=>n(191759),Xe=()=>n(218746),Je=()=>n(366691);const et=(0,l().YK)({addCover:{id:"mobile_page_actions.add_cover",defaultMessage:"Add cover"},changeCover:{id:"mobile_page_actions.change_cover",defaultMessage:"Change cover"},addComment:{id:"mobile_page_actions.add_comment",defaultMessage:"Add comment"},viewComments:{id:"mobile_page_actions.view_comments",defaultMessage:"View comments"},backlinks:{id:"mobile_page_actions.backlinks",defaultMessage:"Backlinks"},addDescription:{id:"mobile_page_actions.add_description",defaultMessage:"Add description"},showDescription:{id:"mobile_page_actions.show_description",defaultMessage:"Show description"},hideDescription:{id:"mobile_page_actions.hide_description",defaultMessage:"Hide description"}});function tt(e){const{blockStore:t,environment:n}=e;return(0,ee().Ls)({key:"add comment",displayName:et.addComment,svg:ze,analyticsName:et.addComment.defaultMessage,validators:[ne().pxM,ne().AU6(ne().omD),L().tm,ne().AU6(L().SD)],closeParentMenu:!0,track:{actionName:"add_comment"},action:async(e,o,i)=>{await(0,qe().O)({blockStore:t,environment:n})}})}function nt(e){const{environment:t,intl:n,blockStore:o}=e,i=Boolean(o.getCover());return(0,ee().Ls)({key:"add page cover",displayName:i?et.changeCover:et.addCover,svg:He().M,analyticsName:i?et.changeCover.defaultMessage:et.addCover.defaultMessage,validators:[ne().p2L,ne()._fc,ne().AU6(ne().oy3),ne().FFM,ne().AU6(ne().J$q)],closeParentMenu:!0,track:{actionName:"edit_cover"},action:(e,i,s)=>{Ge().W({environment:t,intl:n,store:o,rect:i.originRect})}})}function ot(e){const{environment:t,blockStore:n}=e,o=(0,$e().J)(n,t).backlinksCount;if(o<=0)return;return"section_hide"!==(0,Qe().nl)(n.getFormat().page_section_visibility)?(0,ee().Ls)({key:"view backlinks",displayName:et.backlinks,analyticsName:"view_backlinks",validators:[ne().pxM],track:{actionName:"view_backlinks"},closeParentMenu:!0,render:e=>(0,v.jsx)(D().A,{...e,title:(0,v.jsx)(l().sA,{id:"topbarMoreMenuActions.viewBacklinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:o}}),svg:Ue().D}),action:(e,t,n)=>{Je().F.setState({isOpen:!0})}}):void 0}function it(e){const{blockStore:t}=e;if(!t.isType(m().xd.collectionViewPage))return;const n=Ze().A.getPageViewBlockStore(t);if(!n)return;const{currentUserSettingsStore:o}=Ie().default.state,i=t.getCollectionViewSourceDescriptionStoreIfSingleSource(),s=Ye().OW(i),r=n.state.isPageDescriptionExpanded;return s&&r?st({shouldShow:!1,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):s&&!r?st({shouldShow:!0,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):function(e){const{blockStore:t,descriptionStore:n,pageViewBlockStore:o,userSettingsStore:i}=e;return(0,ee().Ls)({key:"add collection description",displayName:et.addDescription,analyticsName:"add_collection_description",validators:[ne().BAy,ne().p2L],closeParentMenu:!0,svg:We().A,track:{actionName:"add_collection_description"},action:(e,s,r)=>{Ye().de({environment:s.environment,pageId:t.id,store:o,userSettingsStore:i,isExpanded:!0,descriptionStore:n})}})}({blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o})}function st(e){const{shouldShow:t,blockStore:n,descriptionStore:o,pageViewBlockStore:i,userSettingsStore:s}=e;return(0,ee().Ls)({key:t?"show collection description":"hide collection description",displayName:t?et.showDescription:et.hideDescription,analyticsName:t?"show_collection_description":"hide_collection_description",validators:[ne().BAy,ne().p2L],closeParentMenu:!0,svg:We().A,track:{actionName:t?"show_collection_description":"hide_collection_description"},action:(e,t,r)=>{Ye().Bq({toggleStore:i,pageId:n.id,descriptionStore:o,environment:t.environment,userSettingsStore:s})}})}var rt=()=>n(327509),at=()=>n(85924),lt=()=>n(800720),dt=()=>n(781469),ct=()=>n(721778);const ut=(0,l().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Page verification"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"}});function mt(e){const{environment:t,intl:n,context:o,isFiltering:i}=e,s=o.blocks[0],r=s.getFollowSettingsKey(),a=we().H8({followSettingsKey:r,environment:t,blockStore:s,from:"more_menu"});if(s.isSystemBlock())return[(0,ee().gy)({key:"system block all actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Et,kt,Ne().qQ,Ne().Zk,ct().p6,jt,...ce()]})];const l=(0,Ae().LX)({device:t.device});return[i?vt(t,s.getFormat().page_font||"default"):ft,(0,ee().gy)({key:"page style and layout",render:e=>(0,v.jsx)(O().A,{...e,topBorder:!1}),actions:[...(0,I().oE)([yt,bt,Mt,Et,kt]),...l?(0,I().oE)([Ne().Xv,nt({environment:t,intl:n,blockStore:s}),tt({blockStore:s,environment:t}),(0,ee().Ls)({key:"view comments",displayName:et.viewComments,svg:Ke,analyticsName:et.viewComments.defaultMessage,validators:[ne().pxM,ne().AU6(ne().omD),L().tm,L().SD],closeParentMenu:!0,track:{actionName:"view_comments"},action:(e,t,n)=>{Xe().A.setState({open:!0})}}),ot({environment:t,blockStore:s}),it({blockStore:s})]):[]]}),(0,ee().gy)({key:"viewing of page content",render:e=>(0,v.jsx)(O().A,{...e}),actions:[xt,ke().Z,De,Ne().fg,Ne().Fh,Ne().cy]}),rt().LQ,(0,ee().gy)({key:"editing of page content",render:e=>(0,v.jsx)(O().A,{...e}),actions:[At,Oe().DI,wt]}),(0,ee().gy)({key:"undo",render:e=>(0,v.jsx)(O().A,{...e}),actions:[ct().tN]}),(0,ee().gy)({key:"topbar primary actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Ne().qQ,Ne().Zk,It({environment:t,intl:n,blockStore:s}),ct().p6,jt,Ct,Ee().TR,Ee().kl,Ee().J8,Ee().lb,at().t,lt().dl]}),(0,ee().gy)({key:"topbar import actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Nt,Ne().TD,Ot]}),(0,ee().gy)({key:"topbar wiki actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:(0,I().oE)([dt().H0,dt().hk])}),Dt(),Lt(t,a),(0,X().A)(o),(0,ee().gy)({key:"topbar view options",render:e=>(0,v.jsx)(O().A,{...e}),actions:ce()})]}function pt(e){return(0,ee().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3),...e.extraValidators],render:(t,n)=>{const o=n.blocks[0].getFormat().page_font,i=e.font===o||!e.font&&!o;return(0,v.jsx)(H,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,isChecked:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,n,o)=>{let{blocks:i,environment:s}=n;const{serverCommitResult:r}=B().createAndCommit({userAction:"actionRegistry.createFontAction",environment:s,canUndo:!0,perform:t=>{T().zA({stores:i,update:{page_font:e.font},transaction:t}),function(e,t){Se().vd(e,"change_font_type",t)}(s,{type:e.font||"default"})}});r.then(t)}})}const gt=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return pt({displayName:ut.fontDefaultName,caption:(0,v.jsx)(l().sA,{...ut.fontDefaultCaption}),font:void 0,tooltip:(0,v.jsx)(l().sA,{...ut.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:d().vc(c().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:b})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return pt({displayName:ut.fontSerifName,caption:(0,v.jsx)(l().sA,{...ut.fontSerifCaption}),font:"serif",tooltip:(0,v.jsx)(l().sA,{...ut.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:d().vc(c().locale).serif},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:x})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return pt({displayName:ut.fontMonoName,caption:(0,v.jsx)(l().sA,{...ut.fontMonoCaption}),font:"mono",tooltip:(0,v.jsx)(l().sA,{...ut.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:d().vc(c().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:y})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return pt({displayName:ut.fontComicName,caption:(0,v.jsx)(l().sA,{...ut.fontComicCaption}),font:"comic",tooltip:(0,v.jsx)(l().sA,{...ut.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:d().vc(c().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[ne().or([ne().SQN("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],ft=(0,ee().gy)({key:"font section",title:void 0,render:e=>(0,v.jsx)(G,{...e}),actions:gt.map((e=>e.action({isFiltering:!1})))});function ht(e){return(0,ee().gy)({key:"font extension menu",render:e=>(0,v.jsx)(O().A,{...e}),actions:gt.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function vt(e,t){const n=(0,C().O4)({theme:e.ThemeModeStore.state}),o=gt.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,ee().gy)({key:"textStyleAction",render:e=>(0,v.jsx)(O().A,{...e}),actions:[(0,ee().uk)({key:"font style section",displayName:ut.textFontStyle,analyticsName:ut.textFontStyle.defaultMessage,svg:k,right:(0,v.jsx)(v.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.text.tertiary,marginRight:5},width:300,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],subActions:()=>[ht(t)],initialFocus:o,hideSubActions:!0,fuzzySearchKeywordsArray:[ut.fontDefaultName,ut.fontSerifName,ut.fontMonoName]})]})}const yt=(0,ee().fi)({key:"small text",displayName:ut.fontSmallTextKeywords,label:Me().A.formatMessage(ut.fontSmallTextLabel),svg:w,isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_text_size"},action:(e,t,n)=>T().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{Se().vd(t,"change_font_size",{type:e?"small":"large"})}}),bt=(0,ee().fi)({key:"full width",displayName:ut.fullWidthLabel,svg:n(209662).l,label:Me().A.formatMessage(ut.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[ne().AU6(ne().tpB),ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_width"},action:(e,t,n)=>{T().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{Se().vd(t,"change_page_width",{type:e?"full_width":"default_width"})}}),xt=(0,ee().fi)({key:"page lock",displayName:ut.lockPageName,label:Me().A.formatMessage(ut.lockPageName),svg:e=>(0,v.jsx)(N().I,{isLocked:!1,style:e}),svgWhenEnabled:e=>(0,v.jsx)(N().I,{isLocked:!0,style:e}),isEnabled:e=>e.isLockedForAllUsers(),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],action:(e,t,n)=>P().zv({store:t.getFormatStore(),data:{block_locked:!t.isLockedForAllUsers(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),St=[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().FrL),ne().or([ne().wTm])],Mt=(0,ee().fi)({key:"floating table of contents",displayName:ut.floatingTableOfContents,svg:n(668204).L,label:Me().A.formatMessage(ut.floatingTableOfContents),isEnabled:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:St,action:(e,t,n)=>{var o;const i="off"!==(null===(o=t.getModel())||void 0===o?void 0:o.getFloatingTableOfContentsState());P().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,Se().u4)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),At=(0,ee().Ls)({key:"suggest edits",displayName:ut.suggestEditsName,analyticsName:ut.suggestEditsName.defaultMessage,validators:[ne().AU6(ne().ln6),ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().$9,ne().AU6(ne().oy3)],render:(e,t)=>{const o="suggest"===he().Uv.getMode(t.blocks[0]),i=(0,C().O4)({theme:t.environment.ThemeModeStore.state});return(0,v.jsx)(D().A,{...e,title:(0,v.jsx)(l().sA,{...ut.suggestEditsName}),svg:n(577955).a,right:(0,ee().cz)(i,o)})},action:e=>{const t="suggest"===he().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&Pe().A.reset(),n(336400).PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),wt=(0,ee().Ls)({key:"translate",displayName:ut.translate,analyticsName:"open_translate_bar_from_topbar",validators:[ne().yI5,ne().pxM],closeParentMenu:!0,render:(e,t,n)=>{let{onFocus:o}=n;const i=t.blocks.at(0);if(i)return(0,v.jsx)(xe,{onFocus:o,closeParentMenu:()=>{Pe().A.reset()},blockStore:i,menuListItemProps:e,title:(0,v.jsx)(l().sA,{...ut.translate})})},action:()=>{}}),kt=(0,ee().Ls)({key:"customize page",displayName:ut.customizePageLabel,analyticsName:ut.customizePageLabel.defaultMessage,svg:S().slidersIcon,validators:[ne().AU6(ne().wTm),ne().VNy,ne().AU6(ne().oy3),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().or([ne().FrL,ne().AU6(ne().omD),ne().UC4]),ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>(0,v.jsx)(D().A,{...e,title:(0,v.jsx)(l().sA,{...ut.customizePageLabel}),svg:S().slidersIcon}),action:e=>{n(817150).ho({originRect:e.originRect})}}),jt=(0,ee().Fw)({key:"copy link to block non-desktop",displayName:ee().AY.copyLinkNavigableTypeName,analyticsName:ee().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(718799).w,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[ne().M3g,ne().vXb,ne().AU6(ne().b8R),ne().AU6(ne().oy3),ne().AU6(ne().Po5)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,o)=>{let{lazyDependencies:i,...s}=t;const{clipboardActions:r}=i;r?r.copyLinkToBlock({...s,callback:e,event:o}):n(502140).log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),Ct=(0,ee().Fw)({key:"duplicate",displayName:ee().AY.duplicateName,analyticsName:ee().AY.duplicateName.defaultMessage,svg:n(507190).V,validators:[ne()._fc,ne().p2L,ne().MIU,ne().omD,ne().AU6(ne().Xjv(m().xd.externalObjectInstancePage)),ne().AU6(ne().UC4),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,t,o)=>{let{environment:i}=t;const s=n(782422).ao();if(!s)return;const r=s.getAssociatedCollectionStore();if(!r)return;if(!(0,n(937968).EF)(i))return;const a=new(n(595922).A)(i);if(a.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:r}),(0,n(981810).ls)(s,a))return void(await n(983048).HF({environment:i,blocks:[s],collectionContextStore:a,callback:e}));const{duplicateBlock:l}=await(0,n(303298).D6)(),{serverCommitResult:d}=B().createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:i,canUndo:!0,perform:e=>{const{blockStores:t}=l({environment:i,stores:[s],transaction:e,targetSpaceId:(0,n(66460).e)(r.pointer.spaceId),preferDuplicateLocation:"local",options:{addCopyName:(0,n(816763).A)(s),deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate()}}),o=t[0];n(795394).X$({childStore:o,parentStore:r,transaction:e}),s.isTemplate()&&n(551102).BC({parentStore:r.getTemplatePagesStore(),appendStore:o,transaction:e}),n(191756).uK({environment:i,store:o,pageVisitSource:u().y8.Duplicate})}});d.then(e)},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function It(e){const{environment:t,intl:n,blockStore:o}=e,i=(0,C().O4)({theme:t.ThemeModeStore.state});return(0,ee().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:ut.pageVerification,render:e=>(0,v.jsx)(D().A,{...e,svg:p().J,title:(0,v.jsx)(l().sA,{...ut.pageVerification}),right:(0,v.jsx)("div",{style:{color:i.text.tertiary,marginRight:0},children:Q({intl:n,blockStore:o})}),rightStyle:{marginRight:5},showExtensionArrow:!0}),validators:[ne().FrL,e=>ne().p2L(e),()=>(0,$().Io)(),()=>{var e;const t=null===(e=Ie().default.state.currentSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,j().Xi)(t))}],closeParentMenu:!1,action:()=>{_().h()}})}const Tt=(0,ee().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:ut.pageUpdates,svg:f().clockIcon,validators:[L().tm,ne().FrL],closeParentMenu:!0,action:()=>{n(953798).A.setState({open:!0})},disabled:()=>!fe().A.state.online}),_t=(0,ee().Ls)({key:"action page history",displayName:ut.pageHistoryName,analyticsName:ut.pageHistoryName.defaultMessage,svg:M().G,validators:[ne().or([ne().hfc,ne().Xmj]),ne()._fc,ne().M3g,ne().AU6(ne().vP$),ne().AU6(ne().PfK),ne().AU6(ne().Qp$),ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;return n(861917).WE({environment:t,blockStore:o[0],from:"topbar"})},render:(e,t)=>{let{onClick:o,key:i,...s}=e,{environment:r}=t;return(0,v.jsx)(n(879759).A,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:o,alwaysAllowClick:!0,render:(e,t)=>{const n=!fe().A.state.online;return(0,v.jsx)(D().A,{...(0,E().A)(s,e),title:Me().A.formatMessage(ut.pageHistoryNewName),svg:M().G,dontShrinkRight:!0,right:t,tooltipText:n?Me().A.formatMessage(ee().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},i)}}),Pt=(0,ee().Ls)({key:"view analytics",displayName:ut.viewAnalyticsName,analyticsName:ut.viewAnalyticsName.defaultMessage,svg:n(412961).o,validators:[ne().JYi,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu"),Ce().Ay.setState({...Ce().Ay.state,updatesSubTab:Ce().VE.Analytics})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Bt=(0,ee().Ls)({key:"view updates and analytics",displayName:ut.viewUpdatesAndAnalyticsName,analyticsName:ut.viewUpdatesAndAnalyticsName.defaultMessage,validators:[ne().JYi,ne().AU6(ne().Po5)],svg:f().clockIcon,closeParentMenu:!0,action:e=>{const{currentUserSettingsStore:t}=Ie().default.state;t&&B().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(658388).mJ({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu")},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function Rt(e,t){var n;const o=(0,C().O4)({theme:e.ThemeModeStore.state});return(0,ee().uk)({key:"notifications",displayName:ut.notifyMe,analyticsName:ut.notifyMe.defaultMessage,svg:g().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:o.text.tertiary,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[ne().AU6(ne().oy3),ne().AU6(ne().Po5)],subActions:()=>[(0,ee().gy)({key:"notifications",render:e=>(0,v.jsx)(O().A,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,I().oE)(t.map((e=>{let{action:t}=e;return t.displayName?we().aE(t.displayName):void 0})))})}function Lt(e,t){return(0,ee().gy)({key:"notifyMe",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Rt(e,t)]})}function Dt(){const e="on"===Te().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0});return(0,ee().gy)({key:"editorActions",render:e=>(0,v.jsx)(O().A,{...e}),actions:(0,I().oE)([Tt,e?Bt:Pt,_t])})}const Nt=(0,ee().Ls)({key:"open import modal",displayName:ut.importName,analyticsName:ut.importName.defaultMessage,svg:n(792104).f,validators:[ne().IRu,ne().p2L,ne().AU6(ne().Xjv(m().xd.externalObjectInstancePage)),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,o=!1;if(1===t.length){const[e]=t;o=e.isCollectionView()}o?n(281267).A.setState({open:!0}):_e().A.setState({..._e().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Ot=(0,ee().Ls)({key:"export block",displayName:ut.exportName,analyticsName:ut.exportName.defaultMessage,validators:[ne().M3g,ne().y9r,ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>{const t=!fe().A.state.online;return(0,v.jsx)(D().A,{...e,svg:n(598793).Q,title:(0,v.jsx)(l().sA,{...ut.exportName}),tooltipText:t?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):(0,v.jsx)(l().sA,{...ut.exportCaption}),disabled:t,disabledFeedback:t})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];if(!i.isDefined())return;let s=!0;const r=(0,R().U)(t[0]);if(r){const e=null==r?void 0:r.collectionStore();null!=e&&e.isPageTreeCollection()&&(s=!1)}n(429318).Ss({environment:o,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:s})}}),Et=(0,ee().Ls)({key:"open page layout editor",displayName:ut.openPageLayoutEditor,analyticsName:ut.openPageLayoutEditor.defaultMessage,validators:[ne().wTm],closeParentMenu:!0,render:function(e){const t=!fe().A.state.online;return(0,v.jsx)(D().A,{...e,disabled:t,disabledFeedback:t,svg:n(918305)._,title:(0,v.jsx)(n(610271).Ye,{children:(0,v.jsx)(l().sA,{...ut.openPageLayoutEditor})}),tooltipText:t?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0})},action:function(e){let t,o,i,s,{environment:r,blocks:a}=e;for(const n of a)if(n.isCollectionView()){const e=n.getCollectionStore();if(e){t=n,o=e;const r=(0,R().U)(n);i=null==r?void 0:r.collectionViewStore(),s="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){t=n,o=e,s="customize_page_button_in_three_dot_menu";break}}if(!o||!t||!s)throw new Error("Could not edit page layout: Could not find collection");n(760813).nh({environment:r,blockStore:t,collectionStore:o,collectionViewStore:i,from:s})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});var Ut=()=>n(392608),Ft=()=>n(875878),Kt=()=>n(35630),Vt=()=>n(518397),zt=()=>n(401382),Wt=()=>n(932322),Ht=()=>n(797631),Gt=()=>n(594184);function Yt(e){const{blockStore:t,onClickOriginRect:n,handleAccept:c,handleDismiss:u}=e,m=(0,i().v3)(),p=(0,i().Y0)(),g=(0,l().tz)(),[f,h]=(0,o.useState)(""),[y,b]=(0,Ft().$)(),x=(0,s().K8)((()=>({environment:m,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu"})),[m,t,n]),{initialSections:S,filterSections:M}=(0,s().K8)((()=>({initialSections:mt({environment:m,intl:g,context:x,isFiltering:!1}),filterSections:mt({environment:m,intl:g,context:x,isFiltering:!0})})),[m,g,x]),A=(0,s().K8)((()=>0===f.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,f]),w=(0,s().K8)((()=>0===f.length&&t.canEdit()&&!t.isPersonProfile()),[t,f.length]),k=(0,s().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),j=(0,r().IS)((e=>({caption:{color:e.text.tertiary},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.accentColors.gray[500]}})),[]),C=(0,s().K8)((()=>p.isMobile&&!Te().default.checkGate({gateName:"mobile_topbar_more_menu_search"})||t.isPersonProfile()),[p,t]),I=(0,v.jsxs)(v.Fragment,{children:[A&&!w&&(0,v.jsx)(Wt().Ay,{caption:(0,v.jsx)("span",{style:j.caption,children:(0,v.jsx)(l().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,v.jsx)(Gt().A,{store:t})}})})}),w&&(0,v.jsx)("div",{style:{marginBottom:1},children:(0,v.jsx)(Kt().$,{store:t,isPageMoreButton:!0,showWordCount:A})})]}),T=p.isMobile?{menuType:pe().gu.Modal,title:(0,v.jsx)(l().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:j.menuPropIcon,onClickRight:u,titleOuterStyle:{fontSize:17,fontWeight:d().Wy.bold},paddingTop:10,shouldRenderMobileRefresh:!0}:{menuType:pe().gu.Popup,maxHeight:"80vh"};return(0,v.jsxs)(ve().A,{...T,children:[C?(0,v.jsx)(Vt().A,{sections:S,onAccept:c,context:x}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(O().A,{isInput:!0,children:(0,v.jsx)(zt().Ay,{value:f,onChange:e=>h(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:g.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,inputLeft:(0,a().q)({...j.icon}),showClearButton:!0,...y})}),(0,v.jsx)(Vt().A,{sections:S,filterSections:M,onAccept:c,context:x,filter:f,showNoResultsMessage:!0,initialFocus:f.length>0?0:void 0,comboboxProps:b})]}),(A||w)&&(p.isMobile?(0,v.jsx)(v.Fragment,{children:I}):(0,v.jsx)(O().A,{topBorder:!0,children:I})),k&&(0,v.jsx)(qt,{})]})}function qt(){return(0,v.jsx)(O().A,{topBorder:!0,children:(0,v.jsx)(Ht().A,{title:(0,v.jsx)(l().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Ut().xS)("guides.database"),analyticsFrom:"topbar_more_button"})})}},578964:(e,t,n)=>{n.d(t,{D:()=>i});n(242343);const o={viewBox:"0 0 20 20",svg:(0,n(163643).jsx)("path",{d:"M15.417 5.467c.23-.23.219-.615-.025-.859s-.629-.255-.86-.025l-8.857 8.858V7.313a.625.625 0 0 0-1.25 0v7.637c0 .345.28.625.625.625h7.637a.625.625 0 1 0 0-1.25H6.559z"})},i=(0,n(680369).wt)("arrowDiagonalDownLeft",o)},584604:(e,t,n)=>{n.d(t,{L:()=>a});n(242343);var o=()=>n(421338),i=()=>n(543001),s=()=>n(707260),r=n(163643);function a(e){let{backgroundColor:t,children:n,...a}=e;const l=(0,i().B)(t),d={wrapper:{...l.wrapper,background:t?l.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,r.jsx)(o().Y1,{style:d.wrapper,align:"center",children:(0,r.jsx)(s().r,{...a,direction:"vertical",overrideSize:()=>48,children:n})})}},591925:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>jm});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(932196),a=()=>n(497808),l=()=>n(319638),d=()=>n(129978);const c=new(d().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([n.e(7097).then(n.bind(n,281434)),n.e(7097).then(n.bind(n,846796))]);return{Notification:e,ElectronContextMenu:t}})),u=(0,d()._h)(c,(e=>e.ElectronContextMenu));var m=()=>n(205207),p=()=>n(213454),g=(n(725707),n(491955),()=>n(34662)),f=()=>n(975392),h=()=>n(356214),v=()=>n(244815),y=()=>n(84543),b=()=>n(935091),x=()=>n(443252),S=()=>n(640979),M=()=>n(621641),A=()=>n(22442),w=()=>n(723817),k=()=>n(907721),j=()=>n(466321),C=()=>n(375817),I=()=>n(205670),T=()=>n(196005),_=()=>n(34425),P=n(163643);function B(){const e=(0,i().Y0)(),{open:t,filter:n,emojiTextStore:r,popupOpen:a,originRect:l,alwaysShowPopup:d}=(0,s().K8)((()=>{const e=T().A.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){if(!e.textStore)return;return A().vD(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:o,showPopupWithEmptyFilter:i,selectionRect:s}=e,r=Boolean(i);return{open:t,filter:n,emojiTextStore:o,popupOpen:n.length>0||r,originRect:s,alwaysShowPopup:r}}),[]),{textMode:c,prevChar:u,singleTextSelectionStore:m}=(0,s().K8)((()=>{var e;const t=I().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:o}=t,i=g().qAZ(o.start.store.getValue());return{textMode:n,prevChar:i?i[o.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,M().H7)(o))||void 0===e?void 0:e.store}}),[]),p=(0,s().K8)((()=>C().A.state.open),[]);return(0,o.useEffect)((()=>{t&&!p&&("editing"!==c||!n&&":"!==u||m!==r||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&v().VN()}),[r,n,p,t,u,m,c]),(0,P.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:a,originRect:l,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:L,render:()=>(0,P.jsx)(R,{open:t,filter:n||"",alwaysShowPopup:d}),keepFocus:!0})}function R(e){let{open:t,filter:n,alwaysShowPopup:s}=e;const r=(0,i().v3)(),a=(0,i().Y0)(),l=(0,o.useRef)(null),d=a.isMobileNative&&!a.isTablet?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:w().jv,onClickOutside:v().VN};const c=(0,o.useMemo)((()=>f().sg((e=>{h().P$(r,{searchQuery:e})}),500)),[r]);return t?!Boolean(s)&&n.length<1?null:(0,P.jsx)(b().A,{innerRef:l,...d,children:(0,P.jsx)(_().p,{filter:n,onSubmit:e=>D(e,r),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?v().VN():c(n))},isCallout:!1,menuRef:l,isInline:!0,onUpload:{onComplete:e=>{D(e,r)}}})}):null}function L(){v().VN()}function D(e,t){y().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{v().Ju({environment:t,emoji:e,transaction:n})}})}var N=()=>n(917717),O=(n(362833),n(403517),()=>n(129221)),E=()=>n(712437),U=()=>n(427091),F=()=>n(201430),K=()=>n(927311),V=()=>n(653998),z=()=>n(764872),W=()=>n(818369),H=()=>n(437071),G=()=>n(927685),Y=()=>n(213517),q=()=>n(360482),$=()=>n(698094),Q=()=>n(539581),Z=()=>n(927105),X=()=>n(485966),J=()=>n(836331),ee=()=>n(825634),te=()=>n(413871),ne=()=>n(101558);function oe(e,t){const n=(0,s().K8)((()=>t?null==e?void 0:e.userId:void 0),[t,null==e?void 0:e.userId]),r=(0,s().K8)((()=>ee().A.state.isVisible),[]),a=(0,V().tz)(),l=(0,i().v3)(),d=(0,o.useRef)(),c=(0,o.useRef)(),u=(0,o.useRef)(-1),m=(0,o.useCallback)((()=>{const{mobileNative:e}=l,{allSpaces:t,currentSpace:n}=ie();e&&(t===d.current&&n===c.current||e.setBadgeNumber(t,n),c.current=n),t!==d.current&&(t>0?H().setBadge(`${t}`):H().setBadge("")),d.current=t}),[l]),p=(0,o.useMemo)((()=>f().Oo(m)),[m]),g="on"===(0,ne().r)("inbox_activity_split"),h=(0,o.useCallback)((async(t,n)=>{if(n===u.current||!e)return;if(u.current=n,!function(e){if(0===Q().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(n)))return;const o=J().default.checkGate({gateName:"multi_cell_get_user_notifications"}),i=await(async e=>{let t=[];if(o){const n=W().callMultiCellApi({eventName:"getUserNotifications",environment:l,data:{size:1e3,isInboxV2:!0,splitInboxActivity:g,markNotificationsAsReceived:e},headers:{}});for await(const e of n)"success"===e.type&&t.push(...e.data.results)}else{const n=await W().callApi({eventName:"getUserNotifications",environment:l,data:{size:1e3,isInboxV2:!0,splitInboxActivity:g,markNotificationsAsReceived:e}});if("failed"===n.type)return[];t=n.data.results}return t})(r);Q().A.setState({results:i}),p();const s=f().KC.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const r of s)se(r,e,a,l)}),[e,p,l,g,a,r]);(0,o.useEffect)((()=>{r&&h("visibilityChange",u.current)}),[r,h]);const v=(0,o.useMemo)((()=>f().nF(h,1e3)),[h]);(0,o.useEffect)((()=>{if(!n)return;let e;const t=e=>{let{key:t,value:n}=e;Z().A.whenActive((()=>{v(t,n)}))};if(n){const o=(0,F().dp)(n);e=$().Ay.addListener(o,void 0,t,void 0,l),h("initializeListener",-1)}return Q().A.addListener(m),l.mobileNative&&X().default.addListener(m),()=>{e&&$().Ay.removeListener(e,l),Q().A.addListener(m),l.mobileNative&&X().default.removeListener(m)}}),[n,l,h,v,m])}function ie(){const e="on"===J().default.getGroup("inbox_activity_split")?"comments":"mentions";return{allSpaces:Q().A.getTotalUnreadCountForType(e),currentSpace:Q().A.getUnreadCountForCurrentSpace()[e]??0}}async function se(e,t,n,o){const i=(0,te().Oo)(t,{table:K()._p,id:e});await i.load();const s=i.getKeyStore("activity_id").getValue(),r=i.getKeyStore("space_id").getValue();if(!r||!s)return;const a=(0,q().jA)(i,s,r);await a.load();const l=a.getModel(),{currentUserStore:d,currentSpaceViewStore:u}=X().default.state;if(d&&u&&l&&!l.invalid&&!O().zP(l,d.id)&&await H().isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await u.load(),!u.isDefined())return;if(!l.isMentionType())return;if("reacted"===l.getType())return;if(!u.getNotifyDesktop())return;if(!o.device.isDesktop)return;const e=(0,(await c.load()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,U().P)(),intl:n,pageVisitSource:E().y8.PushNotification,recipientUser:d.getModel(),experimentService:J().default,collectionFeatureGates:(0,Y().i)()});if(!e)return;const{subject:t,body:s}=e,r=new Notification(t,{body:s,silent:!0}),m=O().JT(l.type),p={medium:"desktop_push",type:m,badge_number:ie().allSpaces,notification_id:i.id,activity_id:a.id},g=e=>z().Gj({environment:o,args:p,action:e});g("sent"),r.addEventListener("show",(()=>g("shown"))),r.addEventListener("close",(()=>g("closed"))),r.addEventListener("click",(()=>{const e=O().KP({activity:l,getRecordModel:i.getRecordModel,baseUrl:G().A.domainBaseUrl,pageVisitSource:E().y8.PushNotification}),t=(0,E().p3)(e,[m,"desktop_push"],E().y8.PushNotification);H().openNotificationUrl(t,o),g("clicked")}))}}const re=new(d().O2)("linkMenu",(()=>n.e(4586).then(n.bind(n,506376)))),ae=(0,d()._h)(re,(e=>e.default)),le=new(d().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,181776)))),de=(0,d()._h)(le,(e=>e.MessageStoreDebugPanel));var ce=()=>n(94163);function ue(){return(0,s().K8)((()=>ce().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,P.jsx)(de,{}):null}n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601);var me=()=>n(519423),pe=()=>n(307542);function ge(){const e=(0,i().v3)(),{shouldTrigger:t,spaceId:n,userId:r}=(0,s().K8)((()=>{const e={shouldTrigger:!1,spaceId:void 0,userId:void 0},{currentSpaceStore:t,currentSpaceViewStore:n,spaceTransitionStatus:o}=X().default.state;if(!(0,pe().F0)())return e;if((0,X().isTransitioningSpaces)(o))return e;if(!t||!t.canRead())return e;const i=null==n?void 0:n.getUserId();return i?{shouldTrigger:!0,spaceId:t.getSpaceId(),userId:i}:e}),[]);return(0,o.useEffect)((()=>{t&&(fe.has(n)||(fe.add(n),W().callApi({eventName:"scheduleSetupPeopleCollection",environment:e,data:{spaceId:n},userId:r,headers:(0,me().WS)({cellId:void 0,recordId:n,spaceId:n})})))}),[e,t,n,r]),null}const fe=new Set;var he=()=>n(162901),ve=()=>n(904697);const ye=(0,f().sg)(W().callApi,1e3,{leading:!0,trailing:!0}),be=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>function(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:o,currentUserStore:i,spaceTransitionStatus:s}=X().default.state,r=null==n?void 0:n.getUserId(),a=null==n?void 0:n.getSpaceId(),l={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&r&&a?(0,X().isTransitioningSpaces)(s)||t.currentUser.id!==r||(null==i?void 0:i.id)!==r||(null==o?void 0:o.id)!==a?l:(0,ve().isPersonalHomeEnabledForUser)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:r,spaceViewSpaceId:a}:l:l}({environment:e})),[e]);return(0,he().Yb)((async()=>{t.readyForHomePagesRequest&&await ye({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,me().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var xe=()=>n(633990),Se=()=>n(936997),Me=()=>n(164160),Ae=()=>n(779921),we=()=>n(790245),ke=()=>n(150649),je=()=>n(723),Ce=()=>n(408758);function Ie(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,s().O$)(X().default),n=e.currentUser.id,r=(0,s().K8)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!r||!n)return;const t=$().Ay.addListener((0,F().Li)({userId:n,spaceId:r}),void 0,(async t=>{let{value:o}=t;(function(e){var t;let{spaceId:n,userId:o,emitValue:i}=e;const s=null===(t=Ce().A.getUserJoinedTeamsState({userId:o,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(s===i)return!1;if(void 0===s&&Ce().A.getHasFetched({userId:o,spaceId:n}))return!1;return!0})({spaceId:r,userId:n,emitValue:o})&&await je().u({environment:e,spaceId:r,userId:n,emitValue:o});const i=Ce().A.getUserJoinedTeamsState({userId:n,spaceId:r});i&&Ce().A.setUserJoinedTeamsState({userId:n,spaceId:r,state:{...i,lastEmitValue:o}})}),void 0,e);return function(){t&&$().Ay.removeListener(t,e)}}),[e,n,r]),null}var Te=()=>n(338008),_e=()=>n(174114),Pe=()=>n(81322),Be=()=>n(284594),Re=()=>n(31448),Le=()=>n(717780),De=()=>n(384221),Ne=()=>n(654548),Oe=()=>n(868199),Ee=()=>n(392608),Ue=()=>n(158294),Fe=()=>n(356813),Ke=()=>n(103151),Ve=()=>n(636045);const ze=(0,V().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function We(){const e=(0,i().v3)(),{device:t}=e,n=(0,V().tz)(),r=(0,_e().IS)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?Re().J.UIRegular.mobile:Re().J.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:a,altText:l,canEdit:d}=(0,s().K8)((()=>{const e=Ue().A.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,Ne().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,o.useEffect)((()=>{a&&De().setSelectionAtEnd({store:a})}),[a]),(0,P.jsx)(b().A,{menuType:t.isMobile?S().gu.ActionSheet:S().gu.Popup,width:t.isMobile?"100vw":310,children:(0,P.jsxs)("div",{style:r.wrapper,children:[(0,P.jsxs)("div",{children:[(0,P.jsx)(Fe().A,{style:r.closeButton,hovered:!0,icon:Pe().V,onClick:()=>Le().V(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:r.helpText,children:(0,P.jsx)(V().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,P.jsx)(Ke().A,{renderTooltip:()=>n.formatMessage(ze.learnTooltip),render:e=>(0,P.jsx)(Fe().A,{ariaLabel:n.formatMessage(ze.learnTooltip),icon:Be().$,external:!0,href:(0,Ee().xS)("guides.altText"),style:r.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&a&&(0,P.jsx)(Ve().A,{store:a,disabled:!1,pasteBehavior:"plaintext",style:r.input,placeholderStyle:r.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>Le().V(e),onEsc:()=>Le().V(e),onTab:()=>!0,placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:Oe().Os.none})]})})}const He=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,_e().IS)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:o,originRect:r}=(0,s().K8)((()=>{const{open:e}=Ue().A.state;return e?{open:e,originRect:Ue().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:o,originRect:r,originGap:8,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.End,onDismiss:()=>Le().V(e),render:()=>(0,P.jsx)(We,{}),sameWidthAsOrigin:!1,style:n.popup,trapFocus:!0})};var Ge=()=>n(90290),Ye=()=>n(622286),qe=()=>n(604284),$e=()=>n(48913),Qe=()=>n(370557),Ze=()=>n(750169),Xe=()=>n(762847),Je=()=>n(76394),et=()=>n(806514),tt=()=>n(695387),nt=()=>n(747459),ot=()=>n(98508),it=()=>n(994800),st=()=>n(655830),rt=()=>n(743668),at=()=>n(365060),lt=()=>n(207762);const dt=[Ze().c.Open,Ze().c.Resolved];const ct=function(e){let{discussionIds:t,blockStore:o,recursivelyLoadAllDiscussions:r,tab:a,property_id:l}=e;const d=(0,i().v3)(),{resolved:c,unresolved:u}=(0,s().K8)((()=>{const e=q().Bw(o,{recursivelyLoadAllDiscussions:r,includePropertyDiscussions:!0}).filter((e=>{if(t&&!t.includes(e.id)&&!q().j3(e))return!1;return!Boolean(l)||e.getPropertyId()===l})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=q().uy(e);return{resolved:n,unresolved:i}}),[o,r,t,l]),{device:m}=d;let p;return p=m.isMobile?{menuType:S().gu.Modal,title:(0,P.jsx)(V().sA,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,P.jsx)(gt,{tab:a,resolved:c,unresolved:u}),right:(0,P.jsx)(rt().DoneMenuText,{}),onClickRight:Ge().xl,whiteBackground:!0}:{menuType:S().gu.Popup,header:(0,P.jsx)(gt,{tab:a,resolved:c,unresolved:u}),width:480,maxHeight:"50vh",onClickOutside:Ge().xl},(0,P.jsx)(n(611871).A,{capture:!0,preventType:ot().A.All,children:(0,P.jsx)(n(435819).A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,P.jsx)(st().A,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:Ge().xl,onBackspace:pt,onDelete:pt,children:(0,P.jsx)(at().A,{store:o,droppable:!0,render:()=>(0,P.jsx)(b().A,{...p,children:(0,P.jsx)(ht,{tab:a,blockStore:o,resolved:c,unresolved:u})})},o.id)})})})};function ut(e){let{message:t}=e;const n=(0,i().v3)(),{device:o}=n,s=(0,_e().IS)((e=>({emptyState:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.text.secondary}})),[o.isMobile]);return(0,P.jsx)("div",{style:s.emptyState,children:t})}function mt(e){const t=Ze().A.state;t.open&&Ze().A.setState({...t,tab:dt[e]})}function pt(e){null==e||e.preventDefault(),Ge().xl()}function gt(e){let{tab:t,resolved:n,unresolved:o}=e;const s=(0,i().v3)(),{device:r}=s,a=o.length,l=n.length,d=(0,_e().IS)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===l||0===a?null:(0,P.jsx)(lt().Ay,{tabs:[(0,P.jsxs)("div",{children:[(0,P.jsx)(V().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,P.jsx)("span",{style:d.openCountStyle,children:a})]},"openDiscussions"),(0,P.jsxs)("div",{children:[(0,P.jsx)(V().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,P.jsx)("span",{style:d.resolvedCountStyle,children:l})]},"resolvedDiscussions")],selectedIndex:dt.indexOf(t),onChange:mt,style:{...r.isAndroid&&{borderBottom:"none"}}})}function ft(e){const{value:t}=(0,d().fJ)(l().commentsDependency),n=(0,i().v3)(),o=(0,s().K8)((()=>nt().A.state.open&&tt().A.state.overlapsExistingDiscussionMenu),[]),r=(0,s().K8)((()=>Ze().A.state.open&&Ze().A.state.tab===Ze().c.Open),[]),a=(0,s().K8)((()=>Ze().A.state.open&&Ze().A.state.keepNewDiscussionAtBottom),[]),c=(0,s().K8)((()=>(nt().A.state.open&&tt().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const u=a?e.discussionStores[0]:void 0;return(0,P.jsxs)(P.Fragment,{children:[t&&e.discussionStores.slice(u?1:0).map(((n,o,i)=>(0,P.jsx)(l().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===o,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:Ge().xl},n.id))),u&&t&&(0,P.jsx)(l().PW,{store:u,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:Ge().xl},u.id),o&&r&&(0,P.jsx)(et().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:c,noBackgroundColors:!0})]})}function ht(e){let{tab:t,blockStore:n,resolved:r,unresolved:a}=e;const c=(0,_e().DP)(),u=(0,i().v3)(),{device:m}=u,p=(0,s().K8)((()=>n.getType()),[n]),g=(0,s().K8)((()=>it().B(n)),[n]),{value:f}=(0,d().fJ)(l().commentsDependency);if(!f)return null;if(t===Ze().c.Open){if(a.length){const e=p&&(0,Je().O)(Xe().kt,p);return m.isMobile&&e&&g?(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${c.regularDividerColor}`,marginBottom:1},children:(0,P.jsx)(g,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,P.jsx)(ft,{discussionStores:a,blockStore:n})]}):(0,P.jsx)(ft,{discussionStores:a,blockStore:n})}return(0,P.jsx)(ut,{message:(0,P.jsx)(V().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return r.length?(0,P.jsx)(ft,{discussionStores:r,blockStore:n}):(0,P.jsx)(ut,{message:(0,P.jsx)(V().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const vt=function(){const e=(0,i().v3)(),{device:t}=e,r=(0,s().K8)((()=>Ze().A.state.rect),[]),a=(0,s().K8)((()=>{if(!Ze().A.state.open)return!1;let t=!1;const o=Ze().A.state.property_id;if(Ze().A.state.open&&o){var i;const e=null===(i=Ze().A.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,qe().Hc)({layoutStore:e,propertyId:o}).isPropertyInPageDetails)}const s=(0,n(377561).$N)(e,Ze().A.state.blockStore);return!!t||(Qe().Ay.state.currentTab!==Qe().tF.Comments||!(0,$e().Nk)(e))&&!s}),[e]),l=(0,o.useCallback)((()=>{Ge().xl()}),[]),d=(0,o.useCallback)((()=>{if(Ze().A.state.open)return(0,P.jsx)(ct,{tab:Ze().A.state.tab,blockStore:Ze().A.state.blockStore,discussionIds:Ze().A.state.discussionIds,recursivelyLoadAllDiscussions:Ze().A.state.recursivelyLoadAllDiscussions,property_id:Ze().A.state.property_id})}),[]),c=(0,Ye().X)("comment_sidebar_for_you");return(0,P.jsx)(x().Ay,{popupType:t.isMobile?c?j().n.BottomSheet:j().n.SlideUp:j().n.Popup,bottomSheetInitialState:"half",open:a,originRect:r,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,disableMouseCapture:!0,originGap:4,render:d,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:l,trapFocus:!0})};var yt=()=>n(906066),bt=()=>n(8115),xt=()=>n(502140),St=()=>n(52223),Mt=()=>n(578525),At=()=>n(782023),wt=()=>n(317697),kt=()=>n(531568),jt=()=>n(956188),Ct=()=>n(239773),It=()=>n(354218),Tt=()=>n(572753),_t=()=>n(364746),Pt=()=>n(953140),Bt=()=>n(137476),Rt=()=>n(782422),Lt=()=>n(983050),Dt=()=>n(562188),Nt=()=>n(477784),Ot=()=>n(840024),Et=()=>n(708230),Ut=()=>n(471370),Ft=()=>n(182613),Kt=()=>n(535906),Vt=()=>n(858023),zt=()=>n(88271);const Wt=(0,V().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const Ht=function(){const e=(0,i().Y0)(),t=(0,i().v3)(),r=(0,s().O$)(Et().A),{stores:a,phase:l}=(0,s().O$)(Ft().default);(0,o.useEffect)((()=>{r.open&&((0,n(21045).A)(a,r.blocks)&&l===Ft().SelectionPhase.Selected||At().VN(t))}),[r,a,l,t]);const d=(0,o.useCallback)((()=>{At().VN(t)}),[t]),c=r.open&&"ai_actions"===r.type;return(0,P.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:r.open,originRect:r.open?r.rect:void 0,placementToOrigin:c?k().W.Right:k().W.Bottom,alignmentToOrigin:c?k().C.Start:k().C.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,P.jsx)(Yt,{}),onDismiss:d,disableFlippingPlacement:c})};function Gt(e){const{menuItemProps:t}=e,{isMobile:n}=(0,i().Y0)(),o=(0,s().O$)(Ot().ts),r=n?{mobileIconStyle:o?{marginLeft:18,marginRight:2}:void 0}:{};return(0,P.jsx)(Kt().A,{...t,title:Nt().A.formatMessage(Dt().VT.askAI),icon:(0,P.jsx)(kt().H2,{}),...r})}function Yt(){const e=(0,i().v3)(),t=(0,_e().DP)(),{device:n}=e,o=(0,s().K8)((()=>{const n=Et().A.state;return n.open?"ai_actions"===n.type?function(e,t,n){var o;const i=(0,Rt().ao)();if(!i)return null;const s=(0,jt().clientSkillToAssistantSurfaceAction)((0,Ct().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),r={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:i,selectionState:Ft().default.state,textSelectionState:I().default.state,userSettings:null===(o=X().default.state.currentUserSettingsStore)||void 0===o?void 0:o.getSettings()},a=(0,jt().filterAssistantSurfaceActionsForContext)(s,r),l=(0,Tt().d7)({assistantSuggestionContext:r,validatedActions:a}).filter(Ct().isAssistantSurfaceActionWithClientSkill),d=(0,jt().clientSkillToAssistantSurfaceAction)(l),c=(0,yt().gC)();return[{key:"ai_actions_paste_menu",render:e=>(0,P.jsx)(zt().A,{...e,title:Nt().A.formatMessage(Wt.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,P.jsx)(Kt().A,{...e,icon:(0,P.jsx)(Mt().O1,{svg:St().K}),title:Nt().A.formatMessage(Wt.pasteItem)}),action:()=>{(0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),At().VN(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,P.jsx)(Kt().A,{...t,title:Nt().A.formatMessage(Pt().DZ.writerGlobalSkill,{displayName:Nt().A.formatMessage(e.displayName),acceptsParameters:(0,bt().yH)(e.skillType)||(0,bt().SH)(e.skillType)}),icon:(0,P.jsx)(Mt().O1,{svg:e.icon,svgFill:(0,It().vJ)(e.category).color(n).color})}),action:async()=>{try{(0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),At().VN(t),await(0,wt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=Ut().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await _t().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,Ct().dangerouslyCreateClientSkillWithParameterValues)(e),updater:Ut().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{xt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,P.jsx)(Gt,{menuItemProps:e}),action:async()=>{try{(0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),At().VN(t),await(0,wt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{xt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,e,t):"blocks"===n.type||"links"===n.type?function(e,t){const{blocks:n}=e,{currentSpaceStore:o}=X().default.state,i=[];if("blocks"===e.type){const{copiedStores:s,pageSource:r}=e;At().GV({currentSpaceId:null==o?void 0:o.id,blocks:n,copiedStores:s})&&i.push({name:Nt().A.formatMessage(Wt.createTransclusion),action:async()=>{(0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await At().Ce({environment:t,blocks:n,copiedBlockIds:s.map((e=>e.id))})}}),At().h8({blocks:n})&&i.push({name:Nt().A.formatMessage(Wt.linkToPage),action:async()=>((0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),At().Xw({environment:t,blocks:n,source:{type:"blocks",copiedStores:s,pageSource:r}}))})}return"links"===e.type&&i.push({name:Nt().A.formatMessage(Wt.linkToPage),action:async()=>((0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),At().Xw({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,P.jsx)(zt().A,{...e}),items:[{key:"dismiss",render:e=>(0,P.jsx)(Kt().A,{...e,title:Nt().A.formatMessage(Wt.dismissItem)}),action:()=>{(0,Bt().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),At().VN(t)}},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,P.jsx)(Kt().A,{...e,title:t}),action:n}}))]}]}(n,e):void(0,Je().HB)(n):null}),[e,t]);if(null===o)return null;let r;return r=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:320,maxHeight:"40vh"},(0,P.jsx)(b().A,{...r,className:Lt().poM,children:(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,sections:o,initialFocus:0})})}var qt=()=>n(344393),$t=()=>n(59175),Qt=()=>n(35462);const Zt=function(){const e=(0,i().v3)(),{device:t}=e,{active:n,stringValue:o}=(0,s().K8)((()=>{const{active:e,stringValue:t}=qt().A.state;return{active:e,stringValue:t}}),[]),r=window.innerWidth/2-150,a=window.innerHeight/2,l=t.isMobileNative?(0,P.jsx)(V().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,P.jsx)(V().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,P.jsx)(x().Ay,{popupType:t.isMobileNative?j().n.SlideUp:j().n.Popup,open:n,originRect:{top:a,left:r},onDismiss:Xt,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:0,render:()=>(0,P.jsx)(st().A,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:f().D_,onCommandEnter:f().D_,onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onDelete:f().D_,onBackspace:f().D_,onEsc:f().D_,onLeft:f().D_,onRight:f().D_,onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:f().D_,children:(0,P.jsxs)("div",{style:{padding:8,width:300},children:[(0,P.jsx)($t().A,{style:{width:"100%",fontSize:12},value:o,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,P.jsx)(Qt().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function Xt(){qt().A.setState({...qt().A.state,active:!1,stringValue:""})}var Jt=()=>n(938124),en=()=>n(101123),tn=()=>n(716826),nn=()=>n(749007),on=()=>n(41717);const sn=function(){const e=(0,s().O$)(tn().Hf);return(0,P.jsx)(on().A,{open:e,children:(0,P.jsx)(rn,{})})};function rn(){const e=(0,s().O$)(tn().Ay),t=(0,s().K8)((()=>function(){const e=tn().Ay.state;if(!e.isDragging)return;const{startX:t,startY:n,currentX:o,currentY:i}=e;return{position:"absolute",top:0,left:0,transform:`translate3d(${o-t}px, ${i-n}px, 0)`}}()),[]);if(!e.isDragging)return null;const n=e.draggedStores.map(((t,n)=>(0,P.jsx)("div",{children:e.ghostElements[n].map(((e,t)=>(0,P.jsx)(nn().A,{element:e},t)))},n)));return(0,P.jsx)("div",{style:t,children:n})}var an=()=>n(691859),ln=()=>n(736953);const dn=function(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,s().K8)((()=>({currentSpaceStore:X().default.state.currentSpaceStore})),[]);return(0,o.useEffect)((()=>{if(!t)return;const o=$().Ay.addListener((0,F().On)(t.id),void 0,(async o=>{let{value:i}=o;if(!ln().A.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const s=await W().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,me().WS)({cellId:void 0,spaceId:t.id})});if("failed"===s.type)return xt().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed"}),[];ln().A.setState({permissionGroupsAndMemberCounts:s.data.groupsWithMemberCount.map((e=>({group:n(769884).Bj6.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){o&&$().Ay.removeListener(o,e)}}),[t,e]),null};var cn=()=>n(979537);const un=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,s().O$)(X().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=$().Ay.addListener((0,F().yp)({spaceId:t.id,userId:r}),void 0,(async n=>{let{value:o}=n;if(!cn()._.shouldRefetch({spaceId:t.id,userId:r,emitValue:o}))return;const i=await W().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[r]},headers:(0,me().WS)({cellId:void 0,spaceId:t.id})});if("failed"===i.type)return xt().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers"}),[];const s=cn()._.getState();cn()._.setState({...s,[r]:{...s[r],[t.id]:{spacePermissionGroupIds:new Set(i.data.userToGroupMap[r]||[]),lastEmitValue:o}}})}),void 0,e);return function(){n&&$().Ay.removeListener(n,e)}}),[t,r,e]),null};var mn=()=>n(349947),pn=()=>n(137650),gn=()=>n(329144);function fn(e){const{environment:t,pointers:n,userIdToCloneFrom:o}=e;for(const i of n)mn().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:i,userId:o}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const hn=new(n(218508).G)((()=>0));const vn=function(){const e=(0,i().v3)(),[t,r]=(0,o.useState)(!1);(0,o.useEffect)((()=>{!async function(){await n(37312).waitForInitialPageRenderToComplete(),r(!0)}()}),[]);const a=(0,s().K8)((()=>{var e;return null===(e=(0,n(754421).vZ)())||void 0===e?void 0:e.id}),[]),l=e.currentUser.id,d=(0,s().K8)((()=>{const e=gn().A.getKeys();return a&&l?e.includes(a)?e:[...e,a]:e}),[a,l]);return function(e,t){const n=(0,i().v3)();(0,o.useEffect)((()=>{const o=hn.get(e)+1;hn.set(e,o);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${o})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),pn().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),pn().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,s().K8)((()=>{if(!t)return[];const n=[];for(const t of d){const o=gn().A.getDataWithoutRefetch(e,{spaceId:t});if(!o)continue;const i=o.pointers,s=o.lastFetchedBy;t===a&&s!==l&&fn({environment:e,pointers:i,userIdToCloneFrom:s}),n.push(...i)}return n}),[d,a,l,e,t])),function(e){const t=(0,i().v3)();(0,o.useEffect)((()=>{const n=[];for(const o of e){const e=$().Ay.addListener((0,F().VW)(o),void 0,(e=>{let{value:t}=e;gn().A.emit({spaceId:o},t)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)$().Ay.removeListener(e,t)}}),[t,e])}(d),null};var yn=()=>n(871002),bn=()=>n(496580),xn=()=>n(939971),Sn=()=>n(448316),Mn=()=>n(903112);const An=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(Mn().A);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.originRect,onDismiss:xn().V,render:()=>(0,P.jsx)(wn,{shouldShowReminder:!!n.open&&n.allowReminders}),trapFocus:!0})};function wn(e){let{shouldShowReminder:t}=e;const n=(0,i().v3)(),o=(0,s().K8)((()=>kn()),[]);if(!o)return null;const r="default",{date_format:a,time_format:l,dateValue:c}=o;return(0,P.jsx)(d().u2,{dependency:m().cm,children:e=>{let{DatePropertyMenu:o}=e;return(0,P.jsx)(o,{firstDayOfWeek:Rt().XX.state,value:c,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=kn();if(!n)return;const{textStore:o,textValue:i,tokenIndex:s}=n,r=g().AhH(i.slice(0,s)),a=g().AhH(i.slice(0,s+1));y().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{Sn().jQ({environment:e,store:o,selection:{startIndex:r,endIndex:a},transaction:t})}})}(t);if(!yn().kC(e))return;const o=kn();if(!o)return;const{date_format:i,time_format:s}=o;jn({date_format:i,time_format:s,...e},t,n)}(e,n,r),dateFormat:a,onChangeDateFormat:e=>function(e,t,n){const o=kn();if(!o)return;const{dateValue:i,time_format:s}=o;jn({date_format:e,time_format:s,...i},t,n)}(e,n,r),timeFormat:l,onChangeTimeFormat:e=>function(e,t,n){const o=kn();if(!o)return;const{dateValue:i,date_format:s}=o;jn({date_format:s,time_format:e,...i},t,n)}(e,n,r),onDismiss:xn().V,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function kn(){const e=Mn().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,o=t.getValue();if(o){const e=o[n];if(e){(0,bn().MX)(g().qXl(e),"Token should be a mention token");const i=g().uPN(e),s=g().$CJ(i);if(s){const{date_format:r,time_format:a,...l}=g().K7D(s);return{textStore:t,textValue:o,tokenIndex:n,token:e,annotations:i,date_format:r,time_format:a,dateValue:l}}}}}}function jn(e,t,n){const o=kn();if(!o)return;const{textStore:i,textValue:s,tokenIndex:r,token:a,annotations:l}=o,d=l.map((t=>g().qsB(t)?["d",e]:t)),c=g().Ey_(a[0],d),u=g().AhH(s.slice(0,r)),m=g().AhH(s.slice(0,r+1));y().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{Sn().jQ({environment:t,store:i,selection:{startIndex:u,endIndex:m},transaction:e}),Sn().yr({environment:t,store:i,tokens:[c],index:u,transaction:e}),J().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||De().clear({environment:t})}})}n(113085);var Cn=()=>n(269280),In=()=>n(29116),Tn=()=>n(193135),_n=()=>n(545250),Pn=()=>n(145017),Bn=()=>n(141666),Rn=()=>n(653224),Ln=()=>n(46406),Dn=()=>n(750094),Nn=()=>n(378219);const On={quip:"Quip",evernote:"Evernote",workflowy:"Workflowy",monday:"Monday",confluence:"Confluence",trello:"Trello"},En=(Object.values(On),[{name:On.quip,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.quip\\.com)\\/(?<docId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}]),Un=[{name:On.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/shard\\/(?<shardId>[^\\/]+)\\/nl\\/(?<userId>[^\\/]+)\\/(?<noteId>[a-zA-Z0-9]+)\\/?(?:.*)?$"},{name:On.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\?b=(?<notebookId>[^&]+)&n=(?<noteId>[^&]+)$"},{name:On.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\/note\\/(?<noteId>[a-f0-9-]+)(?:\\?.*)?$"}],Fn=[{name:On.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/s\\/(?<shareId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"},{name:On.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/#\\/(?<nodeId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"}],Kn=[{name:On.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/views\\/(?<viewId>\\d+)\\/?(?:.*)?$"},{name:On.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/?(?:.*)?$"},{name:On.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/items\\/(?<itemId>\\d+)\\/?(?:.*)?$"}],Vn=[{name:On.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/pages\\/(?<pageId>\\d+)\\/(?<pageTitle>[^\\/?#]+)\\/?(?:.*)?$"},{name:On.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/?(?:.*)?$"}],zn=[{name:On.trello,attributes:[],regex:"^(?<site>https:\\/\\/trello\\.com)\\/b\\/(?<boardId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],Wn={[On.quip]:En,[On.evernote]:Un,[On.workflowy]:Fn,[On.monday]:Kn,[On.confluence]:Vn,[On.trello]:zn};function Hn(e){if(!e||"string"!=typeof e)return{type:"failure"};for(const[t,n]of Object.entries(Wn))for(const o of n)if(new RegExp(o.regex).test(e)&&Gn(t))return{type:"success",importName:t,pattern:o};return{type:"failure"}}function Gn(e){return Object.values(On).some((t=>t===e))}var Yn=()=>n(18377),qn=()=>n(963768),$n=()=>n(330358),Qn=()=>n(793824),Zn=()=>n(884373),Xn=()=>n(966789),Jn=()=>n(402557);const eo=(0,V().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),to=(0,V().YK)({mentionPage:{defaultMessage:"Mention",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},pagePreview:{defaultMessage:"Preview",id:"embedMenu.actions.pagePreview.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),no="3rd party import section",oo={image:Nt().A.formatMessage(eo.image),video:Nt().A.formatMessage(eo.video),tweet:Nt().A.formatMessage(eo.tweet),drive:Nt().A.formatMessage(eo.drive),gist:Nt().A.formatMessage(eo.gist),figma:Nt().A.formatMessage(eo.figma),invision:Nt().A.formatMessage(eo.invision),abstract:Nt().A.formatMessage(eo.abstract),framer:Nt().A.formatMessage(eo.framer),whimsical:Nt().A.formatMessage(eo.whimsical),mixpanel:Nt().A.formatMessage(eo.mixpanel),miro:Nt().A.formatMessage(eo.miro),sketch:Nt().A.formatMessage(eo.sketch),excalidraw:Nt().A.formatMessage(eo.excalidraw),replit:Nt().A.formatMessage(eo.replit),audio:Nt().A.formatMessage(eo.audio),maps:Nt().A.formatMessage(eo.maps),loom:Nt().A.formatMessage(eo.loom),typeform:Nt().A.formatMessage(eo.typeform),codepen:Nt().A.formatMessage(eo.codepen),pdf:Nt().A.formatMessage(eo.pdf),embed:Nt().A.formatMessage(eo.embed),hex:Nt().A.formatMessage(eo.hex),deepnote:Nt().A.formatMessage(eo.deepnote),drawing:Nt().A.formatMessage(eo.drawing)};const io=function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,s().O$)(Yn().A);return(0,P.jsx)(x().Ay,{popupType:t.isMobileNative&&!t.isTablet?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,P.jsx)(Xn().A,{}):(0,P.jsx)(go,{}),onDismiss:()=>so(e)})};function so(e){const t=Yn().A.state;if(!t.open)return;const{url:n}=t;Rn().ol(e,{url:n,type:"close"}),Ln().VN()}function ro(e,t){const n=Yn().A.state;if(!n.open)return;const{url:o}=n;Ln().Ju({environment:t,type:e}),"form"!==e&&Rn().ol(t,{url:o,type:e})}function ao(e){let{environment:t,importType:n,isImportGateEnabled:o}=e;return o?{key:no,render:e=>(0,P.jsx)(zt().A,{...e}),items:[{key:"import",render:e=>(0,P.jsx)(lo,{environment:t,importType:n,menuItemProps:e}),action:()=>function(e,t){let n;(0,Qn().t)({environment:e,action:"click",from:"paste_link"}),t&&(n=function(e){switch(e){case"Evernote":return"evernote";case"Monday":return"monday";case"Confluence":return"confluence";case"Trello":return"trello";case"Workflowy":return"workflowy";case"Quip":return"quip";default:return}}(t)),$n().A.setState({...$n().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:n,openedFrom:"link_paste"}),Ln().VN()}(t,n)}]}:null}function lo(e){let{environment:t,importType:n,menuItemProps:o}=e;return(0,Cn().w)((()=>{(0,Qn().t)({environment:t,action:"view",from:"paste_link"})})),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Zn().A,{size:4}),(0,P.jsx)(Kt().A,{...o,title:(0,P.jsx)(V().sA,{id:"embedMenu.actions.import.title",defaultMessage:"Import from {importType}",values:{importType:n}})})]})}function co(e,t,n){const{device:o}=t,{url:i,textStore:s}=e,{currentSpaceStore:r}=X().default.state,a=[],l=(0,_n().parseRoute)({url:i,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName,isMobile:o.isMobile,protocol:G().A.protocol,currentUrl:window.location.href}),d=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"],c=s.getRecordStoreUIParent(),u="page"===l.name?l.blockId:"team"===l.name?l.peekViewBlockId:void 0,m="page"===l.name&&l.scrollToBlockId,p="page"===l.name?l.collectionViewId:void 0;if(u){const e=te().Bv.createChildStore(s,{table:Pn().ev,id:u});e.isType("form")&&a.push({name:Nt().A.formatMessage(to.embed),validator:()=>!Ln().en(s)&&po(c)&&(null==r?void 0:r.id)===e.getSpaceId(),type:Xe().xd.form});const t=m?te().Bv.createChildStore(s,{table:Pn().ev,id:m}):void 0;a.push({name:Nt().A.formatMessage(to.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!Ln().en(s)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(o)}(e,p))&&!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(o)}(e,p)&&(null==r?void 0:r.id)===e.getSpaceId()&&po(c)&&mo(e),type:Xe().xd.collectionView}),a.push({name:Nt().A.formatMessage(void 0===t?to.mentionPage:to.mentionBlock),validator:()=>mo(e),type:"mention-page"}),a.push({name:Nt().A.formatMessage(to.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!Ln().en(s)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==r?void 0:r.id)&&po(c)&&mo(e)),type:"create-transclusion"}),J().default.checkGate({gateName:"enable_page_previews"})&&a.push({name:Nt().A.formatMessage(to.pagePreview),validator:()=>!t&&!e.isCollectionView()&&!Ln().en(s)&&mo(e)&&po(c)&&!e.isType("form"),type:"page-preview"})}const g=Bn().HP(oo);for(const f of g)"embed"!==f&&a.push({name:oo[f],validator:e=>Tn().dA[f](e)&&po(c),type:f});a.push({name:Nt().A.formatMessage(to.bookmarkMenuItem),validator:e=>!Ln().en(s)&&po(c)&&Tn().Vp(e),type:Xe().xd.bookmark}),a.push({name:oo.embed,validator:e=>!Ln().en(s)&&po(c)&&Tn().dA.embed(e),type:"embed"});const h=f().oE(a.map((e=>{let{name:n,validator:o,type:s}=e;if(o({url:i,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,P.jsx)(Kt().A,{...e,title:n}),action:()=>ro(s,t)}}}))),v={key:"link-mention",render:e=>(0,P.jsx)(Kt().A,{...e,title:Nt().A.formatMessage(to.linkMention)}),action:()=>ro("link-mention",t)},y={key:"dismiss",render:e=>(0,P.jsx)(Kt().A,{...e,title:Nt().A.formatMessage(to.dismissItem)}),action:()=>so(t)};if(0===h.length)return[];(0,_n().Jx)(l)?h.push(y):(uo(i,d)?("embed Create bookmark"!==h[0].key||h.reverse(),h.push(y)):h.unshift(y),J().default.checkGate({gateName:"enable_link_mentions"})&&h.splice(0,0,v));const b={key:"embed section",render:e=>(0,P.jsx)(zt().A,{...e}),items:h},x={key:"import section",render:e=>(0,P.jsx)(zt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Zn().A,{size:4}),(0,P.jsx)(Kt().A,{...e,title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(V().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,P.jsx)(Jn().A,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const o=Yn().A.state;if(!o.open)return;const{url:i}=o,s=X().default.state.mainEditorCurrentBlockStore,r=s&&(null===(t=(0,Nn().Uo)(s))||void 0===t?void 0:t.id),a=null===(n=i.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];qn().Ay.setState({...qn().Ay.state,teamSpaceId:r,projectKeys:a?[a]:[]}),Dn().jh({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,Bt().u4)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:qn().Ay.createNewFlowId(),from:"link_paste_menu"}}}),Ln().VN(),Rn().ol(e,{url:i,type:"jira-sync"})}(t)}]},S=Hn(i),M="success"===S.type?S.importName:void 0,A=ao({environment:t,importType:M,isImportGateEnabled:n});return uo(i,["atlassian.net/jira","/jira/"])?[b,x]:n&&function(e){return"success"===Hn(e).type}(i)&&A?[b,A]:[b]}function uo(e,t){return t.some((t=>e.includes(t)))}function mo(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,In().xm)(t)}function po(e){if(!(e instanceof te().Bv))return!1;const t=e.getType();return!!t&&(0,Xe().IU)(t,e.getFormat())}function go(){const e=(0,i().v3)(),{device:t}=e,n=(0,Ye().X)("contextualized_import_entrypoints"),r=(0,s().K8)((()=>{const t=Yn().A.state;return t.open?co(t,e,n):null}),[e,n]),a=(0,s().K8)((()=>!!Yn().A.state.loading),[]),l=(null==r?void 0:r.length)??0;(0,o.useEffect)((()=>{a||0!==l||Ln().VN()}),[l,a]),function(){const e=(0,s().O$)(Yn().A),t=(0,s().O$)(I().default);(0,o.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,M().KP)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||Ln().VN()}}),[e,t])}();const d=(0,_e().IS)((e=>({header:t.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Re().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Re().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[t]);if(null===r)return null;let c;return c=t.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:r.some((e=>e.key===no))?270:r.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},(0,P.jsx)(P.Fragment,{children:a?(0,P.jsx)(Xn().A,{style:{marginLeft:3,marginRight:3}}):(0,P.jsx)(b().A,{...c,className:Lt().poM,header:(0,P.jsx)(Qt().A,{style:d.header,isSmall:!t.isMobile,isSecondaryColor:!t.isMobile,children:(0,P.jsx)(V().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,sections:r,initialFocus:0})})})}var fo=()=>n(271674),ho=()=>n(863969),vo=()=>n(204810);function yo(){const e=(0,i().v3)(),t=e.currentUser.id,n=(0,ho().O)(),r=(0,s().K8)((()=>(0,vo().x)({isPhone:e.device.isPhone,spaceStore:X().default.state.currentSpaceStore})),[e.device]);return(0,o.useEffect)((()=>{if(!n||!t||!r)return;const o=$().Ay.addListener((0,F().DZ)({notionUserId:t,spaceId:n}),void 0,(0,$().AY)((t=>{let{version:n}=t;-1!==n&&bo(e)})),void 0,e);return function(){o&&$().Ay.removeListener(o,e)}}),[e,t,n,r]),null}const bo=(0,f().sg)((e=>{fo().oX({environment:e})}),5e3,{leading:!0,trailing:!0});var xo=()=>n(752597),So=()=>n(185912),Mo=()=>n(506153),Ao=()=>n(706412),wo=()=>n(680369);const ko=(0,wo().wt)("collapse",{viewBox:"0 0 16 16",svg:(0,P.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var jo=()=>n(456013),Co=()=>n(673357),Io=()=>n(339189),To=()=>n(890449),_o=()=>n(220413),Po=()=>n(935923),Bo=()=>n(85751),Ro=()=>n(573845),Lo=()=>n(164186),Do=()=>n(360378),No=()=>n(244563),Oo=()=>n(593745),Eo=()=>n(102312),Uo=()=>n(615917),Fo=()=>n(209684);const Ko={background:"rgba(255, 255, 255, 0.055)"},Vo={padding:"6px 10px 6px 6px"},zo={padding:"6px 6px 6px 10px"},Wo={display:"flex",borderRadius:4,background:_o().Ay.blackWithAlpha(.65)},Ho=.5,Go=.5,Yo=2,qo=-.002,$o=-.004;function Qo(e){let{visible:t,isOpen:n,zoomScale:o,handleZoomIn:r,handleZoomOut:a,handleNext:l,handlePrevious:d,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:m,resetHideControlsTimeout:p,clearHideControlsTimeout:f,isSaving:h,isEditingZoom:v,handleClose:y}=e;const b=(0,i().Y0)(),x=(0,i().v3)(),{blockStore:S,imageUrl:M}=(0,s().K8)((()=>({blockStore:Eo().A.state.blockStore,imageUrl:Eo().A.state.imageUrl})),[]),A=(0,s().K8)((()=>{var e;return Boolean(S&&(M||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&g().q4_(S.getProperties().source)))}),[S,M]);if(b.isMobile)return null;return(0,P.jsxs)(Uo().A,{visible:t,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:si(n),onClick:e=>{!function(e){e.stopPropagation()}(e),p(),u()},children:[(0,P.jsx)("div",{style:{...Wo,marginRight:10},children:(0,P.jsx)(Xo,{handlePrevious:d,handleNext:l})}),(0,P.jsxs)("div",{style:Wo,children:[(0,P.jsx)(Zo,{zoomScale:o,handleZoomIn:r,handleZoomOut:a,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:m,isEditingZoom:v}),(0,P.jsx)(ui,{}),A?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Jo,{onClick:()=>{if(!S||!A)return;Eo().A.setState({...Eo().A.state,isSaving:!0}),f();const e=null==S?void 0:S.getProperties();let t,n;if(t=M||g().q4_(null==e?void 0:e.source),t){if((0,So()._J)(t)){const o=g().q4_(null==e?void 0:e.title)||(0,So().Jt)(t);n=Bo().KE(x,{url:t,download:!0,downloadName:o,permissionRecord:S.pointer})}else{const o=g().q4_(null==e?void 0:e.caption);n=(0,So().pJ)(t,null==S?void 0:S.pointer,G().A.domainBaseUrl,x.currentUser.id,o)}n.then((()=>{Eo().A.setState({...Eo().A.state,isSaving:!1}),(0,Po().d)(x,{type:"download",triggered_by:"click"}),p()}))}},loading:h}),(0,P.jsx)(ui,{})]}):void 0,(0,P.jsx)(ei,{onClick:y})]})]})}function Zo(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:s,setZoomScale:r,disableZoomEditing:a,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i().v3)(),m=(0,o.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,Po().d)(u,{type:"set_zoom",new_zoom:e}),r(e)}a()}),[a,u,r]);return(0,P.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=Go,render:e=>(0,P.jsx)(Fo().p,{...e,disabled:t<=Go,style:{...li(t<=Go),...zo},onClick:s,icon:e=>(0,Co().c)({...e,fill:ri(),height:16,margin:0,width:16})})}),d?(0,P.jsx)(ti,{initialValue:c,onSubmit:m,onCancel:a,primaryColor:ri(),secondaryColor:ai()}):(0,P.jsx)(Fo().p,{onClick:e=>{e.stopPropagation(),l()},style:{color:ai(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=Yo,render:e=>(0,P.jsx)(Fo().p,{...e,disabled:t>=Yo,style:li(t>=Yo),onClick:n,icon:e=>(0,Io().W)({...e,fill:ri(),height:16,margin:0,width:16})})})]})}function Xo(e){let{handlePrevious:t,handleNext:n}=e;const o=(0,P.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:r}=(0,s().K8)((()=>{const{blockStore:e}=Eo().A.state;return{blockStore:e,allImageBlocksOnPage:e?oi():[]}}),[]);if(!i)return o;if(r.length<=1)return o;const a=r.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===a)return o;const l=r.length;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,P.jsx)(di,{imageIndex:a-1,totalImageCount:l})}),disableTooltip:0===a,render:e=>(0,P.jsx)(Fo().p,{...e,disabled:a<=0,style:{...li(a<=0),...zo},hoveredStyle:Ko,onClick:()=>t(),icon:e=>(0,Mo().i)({...e,fill:ri(),height:16,margin:0,width:16})})}),(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,P.jsx)(di,{imageIndex:a+1,totalImageCount:l})}),disableTooltip:a+1===l,render:e=>(0,P.jsx)(Fo().p,{...e,disabled:a>=l-1,style:{...li(a>=l-1),...Vo},hoveredStyle:Ko,onClick:()=>n(),icon:e=>(0,Ao().Z)({...e,fill:ri(),height:16,margin:0,width:16})})})]})}function Jo(e){let{onClick:t,loading:n}=e;return(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,P.jsx)(Fo().p,{...e,disabled:n,onClick:t,style:li(!1),hoveredStyle:Ko,children:n?(0,P.jsx)(Xn().A,{size:"sm"}):(0,jo().k)({fill:ri(),width:16})})})}function ei(e){let{onClick:t}=e;return(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(ci,{primaryText:(0,P.jsx)(V().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,P.jsx)(Fo().p,{...e,onClick:t,style:{...li(!1),...Vo},hoveredStyle:Ko,icon:e=>ko({...e,fill:ri(),height:16,margin:0,width:16})})})}function ti(e){const[t,n]=(0,o.useState)(e.initialValue);return(0,P.jsx)($t().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:$t().C.Transparent,right:(0,P.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const ni=function(){const e=(0,i().v3)(),t=(0,o.useRef)(!1),r=(0,o.useRef)(),a=(0,o.useRef)(),[l,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(void 0),[m,p]=(0,o.useState)(!1),{isOpen:g,rendered:h,fullScreenNodeRect:v,fullscreenNodeAnimationComplete:y,contentAspectRatio:b,zoomScale:x,panOffset:S,skipAnimations:M,isSaving:A,blockStore:w,panStartPosition:k}=(0,s().K8)((()=>{var e;const{state:t}=Eo().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),j=(0,s().K8)((()=>{const t=e.WindowSizeStore.state.width;return Ro().wX(t)}),[e.WindowSizeStore]);(0,n(705180).A)({capture:g,preventType:ot().A.All});const C=(0,o.useCallback)((()=>{r.current&&clearTimeout(r.current)}),[]),I=(0,o.useCallback)((()=>{p(!0),C(),l||A||(r.current=setTimeout((()=>p(!1)),2e3))}),[C,l,A]),T=(0,o.useCallback)((e=>{I();const t=Math.max(Math.min(e,Yo),Go),n=t<=1?{x:0,y:0}:S;Eo().A.setState({...Eo().A.state,zoomScale:t,panOffset:n})}),[S,I]),_=(0,o.useCallback)((e=>{const t=fi(e,c);t&&(e.x!==t.x&&(k.x=k.x+(e.x-t.x)),e.y!==t.y&&(k.y=k.y+(e.y-t.y)),Eo().A.setState({...Eo().A.state,panOffset:t,panStartPosition:k}))}),[c,k]),B=(0,o.useCallback)((()=>{d(!1),Eo().A.setState({...Eo().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),R=(0,o.useCallback)((()=>{d(!0),C()}),[C]),L=(0,o.useCallback)((()=>{d(!1),I()}),[I]),D=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ro().VN(),(0,Po().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),Do().IU({environment:e}),gi(),xo().default.afterNextFlush((()=>{B()}))}),[e,B]),O=(0,o.useCallback)((e=>{(0,N().Vt)(e)||D()}),[D]),E=(0,o.useCallback)((e=>{if(e.stopPropagation(),(0,N().Vt)(e))return;let t,n;t=x<1?1:x<1.5?1.5:1,n=t<=1?{x:0,y:0}:fi({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},c)??S,Eo().A.setState({...Eo().A.state,zoomScale:t,panOffset:n}),I(),L()}),[c,L,S,I,x]),U=(0,o.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!w)return;const o=oi();if(!o)return;const i=o.findIndex((e=>e.id===w.id));if(i+t<0||i+t>=o.length)return;(0,Po().d)(e,{type:t>0?"next":"previous",image_count:o.length,image_index:i+t,triggered_by:n?"keypress":"click"}),Eo().A.setState({...Eo().A.state,skipAnimations:!0}),a.current&&clearTimeout(a.current),a.current=setTimeout((()=>{Eo().A.setState({...Eo().A.state,skipAnimations:!1})}),250);const s=o[i+t];Lo().iy({environment:e,blockStore:s}),B()}),[w,e,B]),F=(0,o.useCallback)((function(){U(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),K=(0,o.useCallback)((function(){U(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),V=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(x-Ho))/2;x-n<.25&&(n-=Ho),(0,Po().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),z=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(x+Ho))/2;n-x<.25&&(n+=Ho),(0,Po().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),W=(0,o.useCallback)((e=>{c&&1===e.buttons&&ii()&&_({x:e.clientX/x-k.x,y:e.clientY/x-k.y})}),[c,k.x,k.y,_,x]),H=(0,o.useCallback)((e=>{switch(e.key){case"+":case"=":z(!0);break;case"-":case"_":V(!0)}}),[z,V]);(0,o.useEffect)((()=>{const e=e=>{T(x+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*$o):t.deltaX&&e(t.deltaX*$o):t.metaKey?t.deltaY?e(t.deltaY*qo):t.deltaX&&e(t.deltaX*qo):ii()&&_({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,S.x,S.y,_,T,x]);const G=window.innerWidth,Y=window.innerHeight-2*j;let q=G-2*j;const $=b??(v?v.width/v.height:void 0);if(void 0===$)return null;let Q=q/$;if(Q>Y){const e=Q/Y;Q/=e,q/=e}const Z={opacity:0},X={scale:x,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let J;return J=m?x>=1.5?"zoom-out":"zoom-in":"none",(0,P.jsx)(on().A,{open:g||!y,children:(0,No().A)((e=>(0,P.jsx)(st().A,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{D(!0)},onEnter:f().D_,onSpace:()=>D(!0),onCommandEnter:()=>D(!0),onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onUp:f().D_,onDown:f().D_,onDelete:f().D_,onBackspace:f().D_,onLeft:()=>F(!0),onRight:()=>K(!0),onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:H,children:(0,P.jsxs)("div",{style:hi({isOpen:g,showControls:m}),...e,onClick:O,onMouseMove:I,children:[g&&(0,P.jsx)(n(908818).B,{}),(0,P.jsx)(Uo().A,{visible:g,initial:Z,exit:Z,animate:X,skip:M,forceCompositeLayer:!0,style:{display:"flex",cursor:J,maxWidth:q,maxHeight:Q,justifyContent:"center"},ref:e=>{e&&!c&&u({width:e.clientWidth,height:e.clientHeight})},onClick:E,onMouseDown:pi,onMouseUp:gi,onMouseLeave:gi,onMouseMove:W,onAnimationEnd:mi,children:h}),(0,P.jsx)(Qo,{visible:m,isOpen:g,zoomScale:x,handleZoomIn:z,handleZoomOut:V,handlePrevious:F,handleNext:K,setZoomScale:T,disableZoomEditing:L,enableZoomEditing:R,clearHideControlsTimeout:C,resetHideControlsTimeout:I,isSaving:A,isEditingZoom:l,handleClose:D})]})})))})};function oi(){const{blockStore:e}=Eo().A.state;if(!e)return[];if(function(){const{blockStore:e}=Eo().A.state;return(null==e?void 0:e.getParentTable())===To().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Ft().default.getCurrentRootStore();return Oo().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function ii(){const{zoomScale:e}=Eo().A.state;return e>1}function si(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function ri(){return _o().Ay.white}function ai(){return _o().Ay.whiteWithAlpha(.5)}function li(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function di(e){let{imageIndex:t,totalImageCount:n}=e;return(0,P.jsx)(V().sA,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function ci(e){const{primaryText:t,secondaryText:n}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,P.jsx)("span",{style:{color:ai()},children:n}):void 0]})}function ui(){return(0,P.jsx)("span",{style:{borderLeft:`1px solid ${_o().Ay.whiteWithAlpha(.25)}`,height:"100%"}})}function mi(){const{isOpen:e}=Eo().A.state;e||Eo().A.setState({...Eo().A.state,fullscreenNodeAnimationComplete:!0})}function pi(e){const{panOffset:t,zoomScale:n}=Eo().A.state;Eo().A.setState({...Eo().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function gi(){Eo().A.setState({...Eo().A.state,skipAnimations:!1})}function fi(e,t){if(!t)return;let n,o;n=t.width*Yo>window.innerWidth?(t.width*Yo-window.innerWidth)/(2*Yo):(window.innerWidth-t.width*Yo)/(2*Yo),o=t.height*Yo>window.innerHeight?(t.height*Yo-window.innerHeight)/(2*Yo):(window.innerHeight-t.height*Yo)/(2*Yo);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*o),o)}}function hi(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var vi=()=>n(206363),yi=()=>n(612848),bi=()=>n(280630),xi=()=>n(486881),Si=()=>n(8058);const Mi=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),r=(0,o.useCallback)((n=>function(e,t,n){if(!Si().A.isOpen())return;if(!n.current)return;const o=n.current.getSelection();if(!o)return;const i=Si().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&o.startIndex===i&&o.endIndex===i&&(ki(t),yi().IV())}(n,e,t)),[e]),a=(0,o.useCallback)((n=>function(e,t,n){if(!n.current)return;const o=n.current.getSelection();if(!o)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===o.startIndex&&0===o.endIndex&&(ki(t),yi().IV(Si().q.Backward))}(n,e,t)),[e]),l=(0,o.useCallback)((()=>ki(e)),[e]),c=(0,s().K8)((()=>Si().A.state),[]),u=(0,s().K8)((()=>function(){if(!Si().A.isOpen())return;return Si().A.state.savedTextSelectionRect}()),[]),m=(0,s().K8)((()=>function(){var e;if("editing"!==I().default.state.mode&&!Si().A.isOpen())return!0;const t=Si().A.isOpen()?null===(e=(0,M().H7)(Si().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,bi().TL)(t);if(e&&e.isNonEditableState())return!0}const n={[g().Ifu.User]:g().Ifu.User,[g().Ifu.Page]:g().Ifu.Page,[g().Ifu.CustomEmoji]:g().Ifu.CustomEmoji,[g().Ifu.Comment]:g().Ifu.Comment,[g().Ifu.Bot]:g().Ifu.Bot,[g().Ifu.Date]:g().Ifu.Date,[g().Ifu.ExternalObjectInstance]:g().Ifu.ExternalObjectInstance,[g().Ifu.TemporaryPage]:g().Ifu.TemporaryPage,[g().Ifu.TemplateVariable]:g().Ifu.TemplateVariable,[g().Ifu.FormulaPageProperty]:g().Ifu.FormulaPageProperty,[g().Ifu.FormulaContextValue]:g().Ifu.FormulaContextValue,[g().Ifu.Group]:g().Ifu.Group,[g().Ifu.Team]:g().Ifu.Team,[g().Ifu.Citation]:g().Ifu.Citation,[g().Ifu.LinkMention]:g().Ifu.LinkMention,[g().Ifu.AssistantInstructionsCollection]:g().Ifu.AssistantInstructionsCollection,[g().Ifu.GeoPoint]:g().Ifu.GeoPoint,[g().Ifu.SlackSpecialMention]:g().Ifu.SlackSpecialMention};for(const o of Object.values(n))if((0,xi().y_)(o))return!0;return!1}()),[]);if(!c.open)return null;const p=c.value,f=c.error;return(0,P.jsx)(d().u2,{dependency:n(211379).y,children:e=>c.open?(0,P.jsx)(n(785966).A,{Prism:e,ref:t,isOpen:!0,equationValue:p,error:f,displayMode:"inline",disabled:m,originRect:u,originGap:8,onDismiss:wi,onChange:Ai,onSubmit:l,onLeft:a,onRight:r}):null})};function Ai(e,t){Si().A.isOpen()&&Si().A.setState({...Si().A.state,value:e,error:t})}function wi(){yi().IV()}function ki(e){y().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{yi().t5({environment:e,equationStore:Si().A,transaction:t})}})}var ji=()=>n(151172),Ci=()=>n(302376),Ii=()=>n(217013),Ti=()=>n(214227);function _i(e){switch(e){case Ii().A.Preview:return(0,P.jsx)(V().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case Ii().A.Mention:return(0,P.jsx)(V().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case Ii().A.Link:return(0,P.jsx)(V().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,Je().HB)(e)}}const Pi=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),[n]=(0,s().$y)(Ti().A),r=(0,o.useCallback)((t=>{if(n.open){var o;if(!t)ji().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!1});Ti().A.setState({open:!1})}}),[e,n]),a=(0,o.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&r(void 0)}),[r,n.open]),l=(0,o.useCallback)((e=>{if(!n.open||!e.target)return;const o=t.current;o&&(o.contains(e.target)||r(void 0))}),[r,n.open]);(0,o.useEffect)((()=>((0,Ci().P4)(window,"keydown",a),(0,Ci().P4)(window,"mousedown",l),()=>{(0,Ci().Ol)(window,"keydown",a),(0,Ci().Ol)(window,"mousedown",l)})),[a,l]);const d=(0,o.useRef)(!1);function c(t){var o;n.open&&void 0!==t.indexGlobal&&(Ti().A.setState({...n,focusedIndex:t.indexGlobal}),ji().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0}))}(0,s().K8)((()=>{var t,o;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(o=n.args.commentStore.state)||void 0===o?void 0:o.isReady()))??!1;var s;i&&!d.current&&n.open&&ji().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(s=n.args.commentStore)||void 0===s?void 0:s.state,useTempStores:!0});d.current=i}),[e,n]);const u=(0,s().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),m=e.device.isMobile;return(0,P.jsx)(x().Ay,{popupType:u?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:k().W.Top,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:m,keepFocus:m,render:function(){var o;const{device:i}=e;if(!n.open)return;const s=function(t){const{url:n,args:o}=t,i=[];i.push({title:_i(Ii().A.Preview),validator:()=>!0,type:Ii().A.Preview}),i.push({title:_i(Ii().A.Mention),validator:()=>!0,type:Ii().A.Mention}),i.push({title:_i(Ii().A.Link),validator:()=>!0,type:Ii().A.Link});return[{key:"menu section",render:e=>(0,P.jsx)(zt().A,{...e}),items:f().oE(i.map((t=>{let{title:i,validator:s,type:r}=t;if(s({url:n,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`item ${r}`,render:t=>(0,P.jsx)(Kt().A,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),ji().fS({actionType:r,environment:e,commentStore:null===(i=o.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return ji().fS({actionType:r,environment:e,commentStore:null===(t=o.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),r=i.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Re().Wy.semibold,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:Re().Wy.semibold};let a;return a=i.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:200,maxHeight:"40vh"},null!==(o=n.args.commentStore)&&void 0!==o&&o.state&&n.args.commentStore.state.isReady()?(0,P.jsx)(b().A,{...a,className:Lt().poM,ref:t,header:(0,P.jsx)(Qt().A,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,P.jsx)(V().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,sections:s,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,P.jsx)(b().A,{...a,className:Lt().poM,ref:t,header:(0,P.jsx)(Qt().A,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,P.jsx)(V().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(zt().A,{style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(Xn().A,{})})})},onDismiss:()=>r(void 0)})};var Bi=()=>n(88143),Ri=(n(500234),()=>n(357247)),Li=()=>n(502063),Di=()=>n(676333),Ni=()=>n(245313),Oi=()=>n(283826),Ei=()=>n(60020),Ui=()=>n(129044);class Fi extends Ui().default{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const Ki=Fi;var Vi=()=>n(261804),zi=()=>n(603769),Wi=()=>n(839999),Hi=()=>n(916963),Gi=()=>n(807912),Yi=()=>n(465546),qi=()=>n(377963),$i=()=>n(916480),Qi=()=>n(411711),Zi=()=>n(668657),Xi=()=>n(880395),Ji=()=>n(123047),es=()=>n(284320);function ts(e){return"+"===e.insertionType?(0,P.jsx)(ns,{}):(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(rs,{svg:Zi().q.__iconDefinition.svg,viewBox:Zi().q.__iconDefinition.viewBox})})}function ns(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(rs,{svg:Io().W.__iconDefinition.svg,viewBox:Io().W.__iconDefinition.viewBox})})}function os(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(rs,{svg:Qi().I.__iconDefinition.svg,viewBox:Qi().I.__iconDefinition.viewBox})})}function is(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(rs,{svg:$i().b.__iconDefinition.svg,viewBox:$i().b.__iconDefinition.viewBox})})}function ss(e){const{pageStore:t,theme:n,isSafariOrIOS:o,emojiType:i,currentUserId:s}=e;return(0,Ji().h6)({pageModel:t.getModel(),pageRole:t.getRole(),showEmojiInline:!0,emojiType:i,baseUrl:G().A.domainBaseUrl,getRecordModel:t.getRecordModel,isClient:!0,isSafariOrIOS:o,currentUserId:s,theme:n,emojiData:es().A.state})}function rs(e){const{svg:t,viewBox:n}=e,i=(0,o.useMemo)((()=>{const e=Xi().A.renderToString((0,P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,n]),s=(0,_e().IS)((e=>({container:{width:"100%",height:"100%",backgroundColor:e.mediumIconColor,WebkitMaskImage:i,maskImage:i,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})),[i]);return(0,P.jsx)("div",{style:s.container})}var as=()=>n(470637);class ls extends Ui().default{getInitialState(){}}const ds=new ls;function cs(e){const{isFirefox:t}=(0,i().Y0)();return(0,o.useCallback)((n=>{as().A.withListenerIgnored((()=>{var o;const i=Vi().A.state;if(!i.open)return;if(!n)return void i.temporaryInputData.setState(void 0);const{title:s,icon:r,allowTabCompletion:a}=n,l=e.current??"",d=s.toLowerCase().startsWith(l)?i.oldTextValue&&0!==(null===(o=i.oldTextValue)||void 0===o?void 0:o.length)?"":s.slice(l.length):"";ds.setState(a?d:void 0);const c=t?void 0:r;i.temporaryInputData.setState({prefix:i.insertionType,suffix:"[["===i.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const us=(0,V().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}'s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),ms=o.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,r=(0,s().K8)((()=>330),[]),a=(0,s().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===Gi().FormulaContextValueKind.ContextValue)return e}),[t]),l=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:o}=e,r=(0,i().v3)(),a=(0,V().tz)(),l=(0,s().K8)((()=>{if(!t)return;const e=Rt().oc();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,Je().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const o=te().md.createChildStore(e,n);return o.getSchema()}(e,t):void 0}),[t]);if(!t||!l)return[];const d=(0,Yi().sM)(t);return(0,f().oE)(Object.entries(l).map((e=>{let[i,s]=e;if(s&&Gi().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(s.type))return{action:e=>{y().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{const l=(0,g().ESw)({contextValueId:t.id,name:(0,Wi().Nl)(a,d,s.name),property:i,valueSnapshot:"current"});Ri().Ju({annotations:[l],editorMode:"default",environment:r,mentionType:"formulaContextVariable",menuListItemAction:e,query:n.current??"",transaction:o})}})},key:`formula property ${i}`,render:e=>(e.focused&&o({allowTabCompletion:!0,icon:(0,P.jsx)(is,{}),title:a.formatMessage(us.possessiveContextValueProperty,{contextValueName:d,propertyName:s.name})}),(0,P.jsx)(Kt().A,{...e,icon:(0,P.jsx)(ps,{children:Hi().LE[s.type]({height:17,width:17})}),title:s.name}))}})))}({contextValue:a,queryRef:n,setTemporaryInputData:cs(n)}),d=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:i}=e,s=(0,V().tz)(),r=(0,o.useCallback)((()=>{i.setState({formulaTypecheckContextValue:void 0}),Vi().A.updateOpenState({showFormulaProperty:!1})}),[i]),a=(0,_e().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,Yi().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,P.jsx)(zt().A,{...e,desktopTitleStyle:a.sectionDesktopTitle,title:(0,P.jsxs)("header",{style:a.titleHeader,children:[(0,P.jsx)(Fe().A,{ariaLabel:s.formatMessage(us.backButtonAriaLabel),icon:qi().I,iconStyle:a.backButtonIcon,onClick:r,style:a.backButton}),(0,P.jsx)(V().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:a,items:l,mentionMenuCurrentFormulaStore:t});if(!d||0===d.length)return null;const c={menuType:S().gu.Popup,width:r};return(0,P.jsx)(b().A,{...c,children:(0,P.jsx)(Vt().Ay,{initialFocus:0,sections:d,type:Vt().Oh.Vertical})})}));function ps(e){const{children:t}=e,n=(0,_e().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,P.jsx)("div",{style:n.wrapper,children:t})}class gs extends Ui().default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const fs=gs;function hs(e,t){return t?Vi().A.state.open&&"@"===Vi().A.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():Vi().A.state.open&&"[["===Vi().A.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var vs=()=>n(463790),ys=()=>n(631474),bs=()=>n(997302);function xs(e,t){const n=(0,s().K8)((()=>Vi().A.getMentionMenuContext()),[]);return(0,o.useCallback)((()=>{let o,i=Date.now();const s=Vi().A.state;if(s.open&&(i=s.openTime,o=s.flowId),s.open){var r;const a=Date.now(),{numServerRequests:l}=bs().A.state,d=s.sessionId,c=s.showMentionAndShare;vs().sM(e,{timeToAbandonInMs:a-i,analyticsFrom:n,queryLength:(null===(r=t.current)||void 0===r?void 0:r.length)??0,flowId:o,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}s.open&&s.showInvite&&ys().F$(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:s.flowId}),Ri().VN()}),[n,e,t])}function Ss(e){let{usePopupOnMobile:t}=e;const n=(0,i().Y0)();return!t&&(n.isMobileNative&&!n.isTablet)}var Ms=()=>n(726910);function As(e){let{clearSavedSelection:t,filter:n}=e;const o=(0,i().v3)(),r=(0,s().O$)(Vi().A),a=(0,s().K8)((()=>330),[]);if(!r.open)return null;const l="block"===r.textStore.table?r.textStore.id:void 0;return(0,P.jsx)(Ms().Ay,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Ri().eh({environment:o,titleText:hs(o,n),clearSavedSelection:t,createInValue:e,menuListItemAction:void 0})},parentBlockId:l,onAutocompleteQueryChange:ws,autocompleteQuery:r.createInQuery,desktopWidth:a,onCancel:ks})}function ws(e){Vi().A.updateOpenState({createInQuery:e})}function ks(){Vi().A.updateOpenState({showCreateIn:!1,createInQuery:""})}var js=()=>n(250393);function Cs(e){let{inviteTargetsStore:t,personPropertyInviteStore:n,filter:r}=e;const a=(0,i().v3)(),l=(0,o.useCallback)((()=>Is(a,t,n)),[a,t,n]),d=(0,s().K8)((()=>Rt().ao()),[]),c=(0,s().K8)((()=>Vi().A.getInviteOrigin()),[]);return d?(0,P.jsx)(js().A,{inviteOrigin:c,store:d,onInviteCompleteFn:e=>{if(!e.success)return Is(a,t,n),null;const{invitedUsers:o,requestedUsers:i}=e,s=f().xW(Object.values(o),Object.values(i));s.length?y().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:a,canUndo:!0,perform:e=>{Ri().Ju({environment:a,editorMode:"default",annotations:s.map((e=>(0,g().P4h)(e))),transaction:e,menuListItemAction:void 0,query:hs(a,r),mentionType:"user"})}}):Is(a,t,n)},handleBackButtonClick:l,inviteTargetsStore:t,personPropertyInviteStore:n}):null}function Is(e,t,n){const o=Vi().A.state;o.open&&(ys().F$(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:o.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),Vi().A.updateOpenState({showInvite:!1}))}var Ts=()=>n(407152),_s=()=>n(329911),Ps=()=>n(528643),Bs=()=>n(919536),Rs=()=>n(575015),Ls=()=>n(367111),Ds=()=>n(397791);const Ns="ShowMentionInvite";function Os(e){return`${Ns}-${e}`}function Es(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>Rt().ao()),[]),{mentionMenuCurrentMentionStore:o,menuPopupType:r}=e,{userId:a,displayName:l,userEmail:d}=(0,s().K8)((()=>o.getState()),[o]),c=(0,s().K8)((()=>Ls().A.mobileNativeBottomPadding(t)),[t]),u=(0,s().K8)((()=>Vi().A.state.open),[]);if(!n)return null;const m={key:"invite buttons",render:e=>(0,P.jsx)(zt().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,P.jsx)(Kt().A,{title:(0,P.jsx)(V().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,P.jsx)(V().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:l}}),icon:(0,$i().b)({width:18}),...e}),action:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Ri().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),_s().K.set({userId:t.currentUser.id,key:Os(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,P.jsx)(Kt().A,{title:(0,P.jsx)(V().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,P.jsx)(V().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:l}}),icon:(0,P.jsx)(Ds().I,{icon:Ts().x}),...e}),action:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Ri().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),y().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{Bs().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}}),Ps().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:a,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:a}],invite_message_length:0}),Rs().rL({item:{label:(0,P.jsx)(V().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:l}})},undoFunc:()=>y().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{Bs().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},p=r===S().gu.ActionSheet?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${c}px)`}:{menuType:S().gu.Popup};return(0,P.jsxs)(b().A,{...p,children:[(0,P.jsx)(st().A,{debugName:"MentionMenu",capture:u}),(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,initialFocus:0,sections:[m]})]})}var Us=()=>n(802955),Fs=()=>n(975515);const Ks=(0,V().YK)({addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}});var Vs=()=>n(711361),zs=()=>n(196387),Ws=()=>n(504690),Hs=()=>n(644518),Gs=()=>n(247200),Ys=()=>n(188877),qs=()=>n(300659),$s=()=>n(512040);var Qs=()=>n(83544),Zs=()=>n(740520),Xs=()=>n(178063),Js=()=>n(202884),er=()=>n(191756),tr=()=>n(906230);const nr={...Re().RC,fontWeight:Re().Wy.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function or(e){const{pageTitle:t}=e;return t?(0,P.jsx)(V().sA,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,P.jsx)("span",{style:nr,children:t})}}):(0,P.jsx)(V().sA,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function ir(e){const{pageTitle:t}=e;return t?(0,P.jsx)(V().sA,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,P.jsx)("span",{style:nr,children:t})}}):(0,P.jsx)(V().sA,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var sr=()=>n(84979);function rr(e){const{isFirstSection:t,query:n,clearSavedSelection:r,setTemporaryInputData:a}=e,{isOpen:l,insertionType:d,isCreatePageEnabled:c,textStore:u}=(0,s().K8)((()=>{const e=Vi().A.state.open;return{isOpen:e,isCreatePageEnabled:Vi().A.state.mentionTypes.createPage,insertionType:e?Vi().A.state.insertionType:void 0,textStore:e?Vi().A.state.textStore:void 0}}),[]),m=function(e){const{query:t,textStore:n,clearSavedSelection:r,setTemporaryInputData:a}=e,l=(0,i().v3)(),d=(0,V().tz)(),c=(0,s().K8)((()=>Js().D8(n)),[n]),u=(0,o.useMemo)((()=>({key:"add new subpage",action:async e=>{c&&await Ri().eh({environment:l,clearSavedSelection:r,titleText:t,createInValue:c.createInValue,onPageCreated:e=>{e&&""===g().q4_(e.getTitleValue())&&er().uK({environment:l,store:e,pageVisitSource:E().y8.Create})},menuListItemAction:e})},render:e=>{e.focused&&a({title:0===t.length?d.formatMessage(Ks.addPage):"",icon:(0,P.jsx)(ns,{}),allowTabCompletion:!1});const n=n=>(0,P.jsx)(Kt().A,{...(0,tr().A)(n||{},e),icon:(0,P.jsx)(Ds().I,{icon:Xs().plusIcon}),title:(0,P.jsx)(ir,{pageTitle:t})});return l.device.isMobile?n():(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(sr().A,{imageURL:Qs().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,P.jsx)(V().sA,{...Ms().DZ.createSubpage})}),placement:k().W.Right,delayThreshold:0,render:e=>n(e)})}})),[l,r,c,d,t,a]);return u}({query:n,textStore:u,clearSavedSelection:r,setTemporaryInputData:a}),p=function(e){const{query:t,setTemporaryInputData:n}=e,s=(0,i().v3)(),r=(0,V().tz)(),a=(0,o.useCallback)((()=>{Vi().A.updateOpenState({showCreateIn:!0})}),[]),l=(0,o.useMemo)((()=>({key:"open create in menu",action:a,render:e=>{e.focused&&n({title:0===t.length?r.formatMessage(Ks.addPage):"",icon:(0,P.jsx)(ns,{}),allowTabCompletion:!1});const o=n=>(0,P.jsx)(Kt().A,{...(0,tr().A)(n||{},e),icon:(0,P.jsx)(Ds().I,{icon:Zs().arrowDiagonalUpRightIcon}),title:(0,P.jsx)(or,{pageTitle:t})});return s.device.isMobile?o():(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)(sr().A,{imageURL:Qs().A.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,P.jsx)(V().sA,{...Ms().DZ.newPageIn})}),placement:k().W.Right,delayThreshold:0,render:e=>o(e)})}})),[s.device.isMobile,a,r,t,n]);return l}({query:n,setTemporaryInputData:a}),f=(0,o.useMemo)((()=>{if(!c||!l)return;const e="@"===d?(0,P.jsx)(V().sA,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:n=>(0,P.jsx)(zt().A,{...n,title:e,desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:[m,p]}}),[t,m,p,c,l,d]);return f}var ar=()=>n(660714),lr=()=>n(846581),dr=()=>n(16456),cr=()=>n(918695),ur=()=>n(751895);function mr(e){const{category:t,query:n,setTemporaryInputData:o,templateVariableResults:s}=e,r=(0,i().v3)(),a=(0,V().tz)();return s.filter((e=>(0,Gs().BX)(e,t))).map((e=>({key:e,render:t=>{const n=(0,Gs().Ti)(e,a),i=(0,Gs().EC)(e,a);return t.focused&&o({title:n,icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,P.jsx)(Kt().A,{...t,title:n,caption:i,inline:!0})},action:t=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{Ri().Ju({environment:r,editorMode:"default",annotations:[g().Ii$({type:e})],transaction:o,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var pr=()=>n(855470),gr=()=>n(331516);function fr(e,t){return function(){t.setState({formulaTypecheckContextValue:e}),Vi().A.updateOpenState({showFormulaProperty:!0})}}function hr(e){const{formulaReturnType:t,query:n,formulaContextVariableResults:o,setTemporaryInputData:s}=e;return vr({environment:(0,i().v3)(),formulaVariableFilter:e=>e.kind===Gi().FormulaContextValueKind.ContextValue&&e.type.type===t&&!(0,Yi().IF)(e),query:n,formulaContextVariableResults:o,setTemporaryInputData:s})}function vr(e){const{environment:t,formulaVariableFilter:n,query:o,formulaContextVariableResults:i,setTemporaryInputData:s}=e;if(0===i.length)return[];const r=i.filter(n);return 0===r.length?[]:r.map((e=>{const n=(0,Yi().sM)(e),i=(0,Yi().E9)(e),r=(0,Yi().Ix)(e.type);return{action:yr(t,e,o),key:e.id,render:t=>(t.focused&&s({allowTabCompletion:!0,icon:(0,P.jsx)(is,{}),title:e.name}),(0,P.jsx)(gr().A,{...t,svg:r,title:n,tooltipText:i}))}}))}function yr(e,t,n){return function(o){y().createAndCommit({userAction:"MentionMenu.formulaMenuItem",environment:e,canUndo:!0,perform:i=>{const s=(0,g().CA$)(t);Ri().Ju({annotations:[s],editorMode:"default",environment:e,mentionType:"formulaContextVariable",menuListItemAction:o,query:n,transaction:i})}})}}function br(e){const{isFirstSection:t,query:r,setTemporaryInputData:a,templateVariableResults:l,formulaContextVariableResults:d}=e,c=(0,i().v3)(),u=(0,V().tz)(),m=function(e){const[t,i]=(0,o.useState)([]),r=(0,V().tz)(),{areDateMentionsAllowed:a,areReminderMentionsAllowed:l}=(0,s().K8)((()=>({areDateMentionsAllowed:Vi().A.state.mentionTypes.date,areReminderMentionsAllowed:Vi().A.state.mentionTypes.reminder})),[]),d=(0,ur().n)(),c=(0,Ye().X)("chrono_node_date_mentions"),u=(0,o.useCallback)((async()=>{if(e.length<1)return;const t=await async function(e){const{query:t,intl:o,userLocal:i}=e,{chronoNodeDependency:s}=await Promise.all([n.e(91757),n.e(58587)]).then(n.bind(n,131824)),r=await s.load(),a={en:r.en.parse,ja:r.ja.parse,zh:r.zh.parse,fr:r.fr.parse,de:r.de.parse,es:r.es.parse,pt:r.pt.parse,nl:r.nl.parse}[i]??r.en.parse,l=a(t,void 0,{forwardDate:!0}),d=l.length>0?l[0]:void 0;if(!d)return;const{start:c,end:u}=d,m=c.isCertain("minute")||c.isCertain("hour"),p=(null==u?void 0:u.isCertain("minute"))||(null==u?void 0:u.isCertain("hour")),g=c.date().getTime(),f=null==u?void 0:u.date().getTime(),h=(0,U().P)(),v=dr().KQ(g,h),y={unit:"day",value:0,time:yn().lM,defaultTimeZone:h},b=t.toLowerCase().startsWith(o.formatMessage(cr().DZ.remind).toLowerCase());let x;if(g&&!f)x=m?{...v,reminder:b?xr(c):void 0}:{type:"date",start_date:v.start_date,reminder:b?y:void 0};else if(f){const e=dr().NC(g,f,(0,U().P)());x=m&&p?{...e,reminder:b?xr(c):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:b?y:void 0}}if(!x)return;let S=(0,lr().ZF)({value:x,allowRelativeDates:!0,userTimeZone:(0,U().P)(),intl:o});b&&(S=o.formatMessage(Sr.reminder,{dateTime:S}));return{label:S,value:()=>x}}({query:e,intl:r,userLocal:d});i(t?[t]:[])}),[r,e,d]),m=(0,ar().Y)((async()=>await u()),100);return(0,he().Yb)((async()=>{if(!a)return;c&&m.cancel();const t=function(e){const{query:t,allowReminder:n,intl:o}=e;if(0===t.length)return(0,f().oE)([{label:o.formatMessage(Sr.autocompleteToday),value:()=>dr().Ec((0,U().P)())},n?void 0:{label:o.formatMessage(Sr.autocompleteNextTuesday),value:()=>{const e=dr().ah((0,U().P)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(dr().tr),start_time:n.toFormat(yn().GE),time_zone:(0,U().P)()}}},n?{label:o.formatMessage(Sr.autocompleteReminder),value:()=>({type:"datetime",start_date:dr().uf((0,U().P)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:yn().lM,defaultTimeZone:(0,U().P)()},time_zone:(0,U().P)()})}:void 0]);const i=t.normalize("NFKD"),s=n?cr().bm(i,o):cr().FA(i,o);if(!s)return[];let r=(0,lr().ZF)({value:s,date_format:"relative",userTimeZone:(0,U().P)(),intl:o,allowRelativeDates:!0});s.reminder&&(r=o.formatMessage(Sr.reminder,{dateTime:r}));return[{label:r,value:()=>s}]}({query:e,allowReminder:l,intl:r}).slice(0,6);t.length>0||!c?i(t):await m()}),[m,a,e,l,r,c]),t}(r),p=mr({templateVariableResults:l,category:"date",query:r,setTemporaryInputData:a}),g=hr({formulaReturnType:"date",query:r,formulaContextVariableResults:d,setTemporaryInputData:a}),h=(0,o.useMemo)((()=>m.map((e=>{let{label:t,value:n}=e;return{key:t,render:e=>{if(e.focused&&a({title:t,icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),cr().e_(t,u)){const o=(0,lr().ZF)({value:n(),userTimeZone:(0,U().P)(),intl:u,allowRelativeDates:!1});return(0,P.jsx)(Kt().A,{...e,title:t,caption:o,inline:!0})}return(0,P.jsx)(Kt().A,{...e,title:t})},action:e=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:c,canUndo:!0,perform:t=>{const o=n();Ri().Ju({environment:c,editorMode:"default",annotations:[["d",{...o,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:r,mentionType:o.reminder?"reminder":"date"})}})}}}))),[m,u,a,c,r]),v=(0,o.useMemo)((()=>[...g,...p,...h]),[h,g,p]),b=(0,o.useMemo)((()=>{if(v.length>0)return{key:"date results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:v}}),[v,t]);return b}function xr(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:yn().lM}}const Sr=(0,V().YK)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"}});var Mr=()=>n(466051);const Ar=(0,V().YK)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function wr(e){const{isFirstSection:t,query:n,setTemporaryInputData:r}=e,a=(0,i().v3)(),l=(0,V().tz)(),d=function(e){const{query:t}=e,n=(0,s().K8)((()=>Vi().A.state.mentionTypes.group),[]),i=(0,s().K8)((()=>ln().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))),[]),r=(0,o.useMemo)((()=>n?(0,Ys().Ay)(t,i,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,i]);return r}({query:n}),c=(0,s().K8)((()=>f().pY(ln().A.state.permissionGroupsAndMemberCounts,(e=>e.group.group_id))),[]),u=(0,ho().O)(),m=(0,o.useMemo)((()=>f().oE(d.map((e=>{var t;if(!u)return;const o=l.formatMessage(Ar.groupMentionCaption,{numMembersInGroup:(null===(t=c[e.group_id])||void 0===t?void 0:t.memberCount)||0});return{key:e.id,render:t=>(t.focused&&r({title:e.name||"",icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,P.jsx)(Mr()._,{menuListItemProps:{...t,caption:o},group:e,iconSizeOverride:a.device.isMobile?24:void 0})),action:t=>{y().createAndCommit({userAction:"MentionMenu.groupMention",environment:a,canUndo:!0,perform:o=>{Ri().Ju({environment:a,editorMode:"default",annotations:[g().dWL(e.group_id,u)],transaction:o,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[d,u,l,c,r,a,n]),p=(0,o.useMemo)((()=>{if(0!==m.length)return{key:"group results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:m}}),[m,t]);return p}var kr=()=>n(208565),jr=()=>n(141122),Cr=()=>n(709237);const Ir=o.forwardRef((function(e,t){const{store:n}=e,o=(0,i().v3)().device.isMobile?24:20,s=(0,_e().IS)((e=>({icon:{fill:e.text.tertiary,width:o,height:o}})),[o]);return(0,P.jsx)(Kt().A,{...e,ref:t,title:(0,P.jsx)(Cr().A,{store:n}),className:"notranslate",icon:(0,Qi().I)(s.icon)})}));function Tr(e){const t=(0,i().v3)(),n=(0,V().tz)(),{query:r,setTemporaryInputData:a,isFirstSection:l}=e,d=function(e){const{intl:t,query:n}=e,o=n.toLowerCase(),i=(0,Ye().X)("mention_menu_page_headings"),r=(0,s().K8)((()=>{const e=(0,Rt().ZO)();if(!e)return;const{mainEditorCurrentBlockStore:t}=X().default.state;return e===t?t:jr().default.peekTargetStore.state===e?jr().default.peekTargetStore.state:void 0}),[]),a=(0,s().K8)((()=>{if(!i||!r)return[];const e=J().default.checkGate({gateName:"toc_nested_headings"});return(0,kr().T)(r.id,r.getRecordModel,e)}),[i,r]),l=(0,s().K8)((()=>r?(0,f().oE)(a.map((e=>{const n=te().Bv.createChildStore(r,{table:Pn().ev,id:e}),i=n.getModel();if(!i)return;const s=i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().P)(),intl:t});return s&&s.toLowerCase().includes(o)?n:void 0}))):[]),[t,o,r,a]);return l}({query:r,intl:n}),c=0===d.length,u=(0,s().K8)((()=>d.map((e=>{const o=e.id;return{key:o,render:t=>{if(t.focused){const t=e.getModel();if(t){const o=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,U().P)(),intl:n});a({title:o||"",icon:(0,P.jsx)(os,{}),allowTabCompletion:!0})}}return(0,P.jsx)(Ir,{...t,store:e})},action:e=>{y().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{Ri().Ju({environment:t,editorMode:"default",annotations:[["p",o]],transaction:n,menuListItemAction:e,query:r,mentionType:"heading"})}})}}}))),[t,d,n,r,a]),m=(0,o.useMemo)((()=>{if(!c)return{key:"heading results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),desktopTitleStyle:l?{paddingTop:4}:void 0,topBorder:!l}),items:u}}),[u,l,c]);return m}var _r=()=>n(621301);function Pr(e){const{isFirstSection:t,environment:n,query:r,setTemporaryInputData:a}=e,{teamResults:l,currentTeamResultStore:d}=function(e){const t=(0,i().v3)(),{query:n}=e,o=(0,s().K8)((()=>(0,qs().D)({isMobileNative:t.device.isMobileNative,disableExposureLogging:!0})&&Vi().A.state.mentionTypes.team),[t.device.isMobileNative]),r=(0,s().K8)((()=>{var e;if(!o)return[];if(!Vi().A.state.open)return[];const t=(null===(e=X().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(Je().O9))||[];return(0,Ys().Ay)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[o,n]),a=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.textStore:void 0),[]);return{teamResults:r,currentTeamResultStore:(0,s().K8)((()=>{if(a&&(0,Nn().Wo)(a))return(0,Nn().Iw)(a)}),[a])}}({query:r}),c=(0,ho().O)(),u=(0,s().K8)((()=>f().oE(l.map((e=>{if(!c)return;return{key:e.id,render:t=>(t.focused&&a({title:e.getName()||"",icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,o.createElement)(_r().A,{...t,key:e.id,teamStore:e})),action:t=>{y().createAndCommit({userAction:"MentionMenu.teamMention",environment:n,canUndo:!0,perform:o=>{Ri().Ju({environment:n,editorMode:"default",annotations:[g().DH3(e.id,c,"teamspace")],transaction:o,menuListItemAction:t,query:r,mentionType:"team"})}})}}})))),[n,r,a,c,l]),m=(0,o.useMemo)((()=>{if(0!==u.length)return{key:"team results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:u}}),[u,t]);return{currentTeamResultStore:d,teamResultsSection:m}}var Br=()=>n(32194),Rr=()=>n(441165),Lr=()=>n(646591),Dr=()=>n(289988),Nr=()=>n(162339),Or=()=>n(357703),Er=()=>n(638907),Ur=()=>n(701513);const Fr=20;function Kr(e){const{query:t,isFirstSection:n,setTemporaryInputData:r,formulaContextVariableResults:a}=e,l=(0,V().tz)(),d=(0,i().v3)(),{device:c}=d,u=d.currentUser.id,m=(0,_e().DP)(),p=c.isSafari||c.isIOS,{results:g,isLoading:h}=function(e){const t=(0,s().K8)((()=>Vi().A.state.mentionTypes.page),[]),n=(0,s().K8)((()=>Vi().A.state.open&&Vi().A.state.textStore instanceof Er().B?Vi().A.state.textStore:void 0),[]),o=(0,i().v3)(),r=(0,s().K8)((()=>(0,Ws().y)(o)),[o]),{overriddenPublicShareLinkSpaceStore:a,furthestPublicShareAncestorId:l}=(0,Or().W)(),d=(0,s().K8)((()=>Boolean(X().default.state.currentSpaceStore||a)||Boolean(n)),[n,a]),c=(0,s().K8)((()=>{var e;return null===(e=(0,Rt().ao)())||void 0===e?void 0:e.id}),[]),u=(0,s().K8)((()=>Lr().NK.state.filter((e=>e.pageId!==c)).slice(0,Fr).map((e=>e.store))),[c]),m=""===e,{results:p,isResultsLoading:g}=(0,Dr().W)({...r?{type:Br().Vz.BlocksInAncestor,ancestorId:l??""}:{type:Br().Vz.BlocksInSpace},source:"mention_menu",query:e,limit:Fr,filters:{excludeTemplates:!0,includePublicPagesWithoutExplicitAccess:r},options:{disable:!t||!d||m||r&&!l,overrideSpaceStore:r?a:void 0}});return{results:(0,s().K8)((()=>m?u.map((e=>({pageStore:e,serverEventProperties:void 0}))):p.map((e=>{let{store:t,serverEventProperties:n}=e;return{pageStore:t,serverEventProperties:n}}))),[p,u,m]),isLoading:g}}(t),v=hr({formulaReturnType:"block",query:t,formulaContextVariableResults:a,setTemporaryInputData:r}),b=(0,o.useMemo)((()=>(0,f().oE)(g.map((e=>{let{pageStore:n,serverEventProperties:o}=e;const i=n.id;return{key:i,render:e=>{if(e.focused){const e=n.getModel();if(e){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().P)(),intl:l});r({title:t||"",icon:(0,P.jsx)(ss,{pageStore:n,theme:m,isSafariOrIOS:p,emojiType:(0,Rr().FN)(d),currentUserId:u}),allowTabCompletion:!0})}}return(0,P.jsx)(Ur().A,{...e,store:n,showVerifiedPageBadge:!0})},action:e=>{y().createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:d,canUndo:!0,perform:n=>{Ri().Ju({environment:d,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:t,serverEventProperties:o,mentionType:"page",resultId:i})}})}}})))),[u,d,l,p,t,g,r,m]),x=(0,o.useMemo)((()=>[...v,...b]),[v,b]),S=!(x.length>0)&&!h?zr.noPageResults:zr.linkToPage,M=(0,o.useMemo)((()=>(0,P.jsxs)(P.Fragment,{children:[l.formatMessage(S),(0,P.jsx)(Vr,{show:h})]})),[l,h,S]),A=(0,o.useMemo)((()=>({key:"no page results",render:e=>(0,P.jsx)(zt().A,{...e,title:M,desktopTitleStyle:n?{paddingTop:4}:void 0,topBorder:!n}),items:x})),[x,M,n]);return{pageResultsSection:A,isPageResultsLoading:h}}function Vr(e){let{show:t}=e;const n=(0,Nr().A)(t,500,300);return(0,P.jsx)(Xn().A,{style:{textAlign:"center",visibility:n?"visible":"hidden",display:"inline",marginLeft:8}})}const zr=(0,V().YK)({noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}});n(244387);var Wr=()=>n(950635),Hr=()=>n(379470),Gr=()=>n(409211),Yr=()=>n(14931),qr=()=>n(3311),$r=()=>n(773253),Qr=()=>n(352723),Zr=()=>n(432809),Xr=()=>n(415806);const Jr=(0,V().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMention",defaultMessage:"@here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMention",defaultMessage:"@channel"}}),ea=(0,V().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMentionNoAmpersand",defaultMessage:"here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMentionNoAmpersand",defaultMessage:"channel"}}),ta=[{message:ea.here,channelRecipient:"here"},{message:ea.channel,channelRecipient:"channel"}],na=o.forwardRef((function(e,t){const{channelRecipient:o}=e;return(0,P.jsx)(Kt().A,{...e,icon:(0,n(911183).q)({width:14,height:14}),title:(0,P.jsx)(V().sA,{...Jr[o]}),ref:t,inline:!0,caption:(0,P.jsx)(V().sA,{...Jr[o]})})}));var oa=()=>n(313141),ia=()=>n(520969);const sa=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function ra(){const e=(0,s().K8)((()=>oa().A.state.open&&sa.includes(oa().A.state.discussionLocation)),[]),t=(0,s().K8)((()=>Vi().A.getIsMockText()),[]),n=(0,s().K8)((()=>(0,ia().lU)(X().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!n}function aa(e,t){const{user:o,focused:r}=e,a=(0,i().v3)(),l=(0,V().tz)(),d=(0,_e().IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.contrastSecondary,fontWeight:Re().Wy.regular,maxWidth:240},tooltipHeader:{color:e.text.contrastPrimary,fontWeight:Re().Wy.medium}})),[]),c=(0,Wr().A7)(o),u=(0,Wr().lR)(l,c),m=(0,s().K8)((()=>{const e=(0,Rt().ao)();return!(e&&(0,Zr().Aj)({store:e}))||"none"!==(0,Qr().om)(o.id)}),[o.id]),p=(0,s().K8)((()=>{var e;return o.id===(null===(e=X().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[o.id]),g=ra(),f=(0,s().K8)((()=>{if(!g)return;if(!r)return;if(m)return;const e=(0,Rt().ao)(),t=e&&Boolean(_s().K.get({userId:a.currentUser.id,key:Os(e.id)})),o=null==e?void 0:e.canAdmin();return!t&&o?(0,Ts().x)(d.icon):(0,n(394156).L)(d.icon)}),[g,a.currentUser.id,m,r,d.icon]),h=(0,s().K8)((()=>{if(!g)return null;const e=o.email;return(0,P.jsxs)("div",{style:d.tooltip,children:[(0,P.jsx)("header",{style:d.tooltipHeader,children:(0,P.jsx)(da,{userName:u,userHasAccessToPage:m,userIsSelf:p})}),e]})}),[g,m,p,u,o.email,d.tooltip,d.tooltipHeader]);return(0,P.jsx)(n(698995).A,{...e,ref:t,actor:c,right:f,tooltip:h,tooltipPlacement:g?k().W.Right:void 0,useEmailAsTooltip:!g,customUserTitleStyles:a.device.isMobile?{fontSize:14}:void 0,iconSizeOverride:a.device.isMobile?24:void 0})}const la=o.forwardRef(aa);function da(e){let{userName:t,userHasAccessToPage:n,userIsSelf:o}=e;return o?(0,P.jsx)(V().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):n?null:(0,P.jsx)(V().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won't be notified because they don't have page access",values:{userName:t}})}n(324989);var ca=()=>n(446588),ua=()=>n(23371),ma=()=>n(199557),pa=()=>n(509484),ga=()=>n(14679),fa=()=>n(472951);const ha=75,va=4;function ya(e){const{query:t,environment:n,intl:r}=e,a=(0,s().K8)((()=>Vi().A.state.open),[]),l=(0,s().K8)((()=>e.disabled||!Vi().A.state.mentionTypes.user),[e.disabled]),c=(0,s().K8)((()=>Boolean(X().default.state.currentSpaceStore)),[]),u=(0,Ye().X)("edge_cache_mentions"),[{value:m=[],status:p}]=(0,he().Yb)((async()=>{if(l||u||!a||!c)return[];const e=await async function(e,t,n){if(Us().A.state.online){const o=await pa().T.searchActions.load();return await o.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:o.isPersonalPronoun(e,n)})}return[]}(t,n,r.locale);return e}),[l,u,a,c,t,n,r.locale],{debounce:ha}),{results:g,isLoading:h}=function(e){const{query:t,flagEnabled:n,disabled:r}=e,a=(0,V().tz)(),l=(0,i().v3)(),c=(0,s().K8)((()=>Vi().A.state.open),[]),u=(0,s().O$)(X().AppStoreCurrentSpaceStore),m=!r&&n&&t.length>0&&u&&c,p=(0,s().K8)((()=>{var e;const t=fa().k.getSortedUserIds(),n=null===(e=(0,Rt()._m)(l))||void 0===e?void 0:e.id;return[...(0,f().oE)([n]),...t]}),[l]),g=(0,s().K8)((()=>{const e=X().default.state.mainEditorCurrentBlockStore;return e?(0,Qr().i0)(e).flatMap((e=>{let{permissionItem:t}=e;return(0,ca().B2)(t)?[t.user_id]:[]})):[]}),[]),h=(0,d().fJ)(pa().T.searchActions),[{value:v=[],status:y}]=(0,he().Yb)((async()=>{if(!m||"resolved"!==h.status)return[];const e=(0,f().sb)([...p,...g]),n=h.value;return(await n.searchUsers({environment:l,parentStore:u,query:t,userIds:e.slice(0,100),minFuzzyScore:25,placeSelfFirst:n.isPersonalPronoun(t,a.locale)})).slice(0,3)}),[m,h.status,h.value,p,g,l,u,t,a.locale]),b=(0,o.useMemo)((()=>({field:"name_normalized",direction:"asc"})),[]),x=(0,ma().n)({query:t,sort:b,filter:void 0,limit:50,disable:!m}),S=(0,s().K8)((()=>(null==x?void 0:x.rowsStore.state.rows)??[]),[x]),[{value:M=[],status:A}]=(0,he().Yb)((async()=>{if(!m)return[];const e=S.sort(((e,t)=>{var n,o;const i=(null===(n=fa().k.state)||void 0===n?void 0:n[e.id])??0;return((null===(o=fa().k.state)||void 0===o?void 0:o[t.id])??0)-i})),t=await(0,ua().lX)(e,e.length,(async e=>{const t=ga().L.createChildStore(u,{table:Gr().oo,id:e.id});return await t.load(),t.getValue()}));return(0,f().oE)(t)}),[u,m,S],{debounce:ha}),w=(0,o.useMemo)((()=>{const e=new Set;return[...v,...M].filter((t=>!e.has(t.id)&&(e.add(t.id),!0)))}),[v,M]),k="pending"===A||"pending"===y;return{results:w,isLoading:k}}({query:t,flagEnabled:u,disabled:l}),v=(0,o.useMemo)((()=>u?g:m),[u,m,g]),y=(0,s().K8)((()=>Vi().A.state.emptyQueryUserRequestStore.state.result??[]),[]),b="pending"===(u?h:p);return{results:0===t.length?y.slice(0,va):v.slice(0,20),isLoading:b}}const ba="__invite";function xa(e){const{isFirstSection:t,query:n,inviteTargetsStore:r,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:l,setTemporaryInputData:d,templateVariableResults:c,formulaContextVariableResults:u,currentTeamResultStore:m,disabled:p}=e,f=(0,i().v3)(),h=(0,V().tz)(),v=(0,s().K8)((()=>Vi().A.state.mentionTypes.user),[]),{results:b,isLoading:x}=ya({query:n,environment:f,intl:h,disabled:p}),S=(0,s().K8)((()=>(0,Rt().ao)()),[]),M=(0,s().K8)((()=>S&&Boolean(_s().K.get({userId:f.currentUser.id,key:Os(S.id)}))),[f.currentUser.id,S]),A=(0,s().K8)((()=>Vi().A.state.mentionTypes.inviteUserToPage&&!M),[M]),w=mr({templateVariableResults:c,category:"user",query:n,setTemporaryInputData:d}),k=hr({formulaReturnType:"person",query:n,formulaContextVariableResults:u,setTemporaryInputData:d}),j=(0,s().K8)((()=>{const e=Vi().A.state.mentionTypes.team;return(0,qs().D)({isMobileNative:f.device.isMobileNative,disableExposureLogging:!0})&&e}),[f.device.isMobileNative]),C=(0,s().K8)((()=>!b.find((e=>e.email===n))&&Vi().A.state.mentionTypes.inviteUserToWorkspace),[n,b]),I=(0,ho().O)(),T=(0,s().K8)((()=>{var e;return"slack_notification"===(null===(e=$s().A.state.automationActionStore)||void 0===e?void 0:e.getType())}),[]),_=C||b.length>0||w.length>0||k.length>0||j,B=(0,s().K8)((()=>{if(!I||!m||!_)return;const e=h.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&d({title:e,icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,o.createElement)(_r().A,{...t,key:"everyone-unique-item",teamStore:m,renderAsEveryoneMention:!0})),action:e=>{y().createAndCommit({userAction:"MentionMenu.teamMention",environment:f,canUndo:!0,perform:t=>{Ri().Ju({environment:f,editorMode:"default",annotations:[g().DH3(m.id,I,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[_,m,f,h,n,d,I]),R=(0,s().K8)((()=>ta.reduce(((e,t)=>{if(!T)return e;const{channelRecipient:i,message:s}=t,r=h.formatMessage(s);if("channel"!==i&&"here"!==i)return e;if(!r.startsWith(n))return e;const a=function(e){return`slack-special-mention-${e}-unique-item`}(i),l={key:a,render:e=>(e.focused&&d({title:r,icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,o.createElement)(na,{...e,channelRecipient:i,key:a})),action:e=>{y().createAndCommit({userAction:`MentionMenu.slackSpecialMention.${s.id}MenuItem`,environment:f,canUndo:!0,perform:t=>{Ri().Ju({environment:f,editorMode:"default",annotations:[g().zP1(i)],transaction:t,menuListItemAction:e,query:n,mentionType:"slackSpecialMention"})}})}};return e.push(l),e}),[])),[T,f,h,n,d]),L=ra(),D=(0,s().K8)((()=>Vi().A.getMentionMenuContext()??Pn().ev),[]),N=(0,s().K8)((()=>!!S&&((0,Zr().Aj)({store:S})&&S.canAdmin())),[S]),O=(0,o.useCallback)((async e=>{let{user:t}=e;if(!(!f.device.isMobile&&L&&!M&&N))return;if(!S)return;const n=await W().callApi({eventName:"canMentionInviteUserToPage",environment:f,data:{block:{id:S.pointer.id,table:Pn().ev,spaceId:S.getSpaceId()},mentionedUser:{id:t.id,table:Gr().oo,spaceId:S.getSpaceId()}}});if("success"!==n.type||!n.data.canInvite)return;const o=(0,qr().Ay)();$r().HK(function(e){const{environment:t,user:n,pageStore:o,intl:i,flowId:s,from:r}=e;return o&&_s().K.set({userId:t.currentUser.id,key:Os(o.id),value:!0}),{id:`invite_${n.id}`,title:i.formatMessage(Aa.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,P.jsx)(Sa,{user:n}),actions:{primary:{title:i.formatMessage(Aa.pageInviteToastInviteButton),onAction:()=>{if(!o)return;const i="read_and_write";y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Bs().zP({environment:t,transaction:e,store:o,permissionItems:[{type:"user_permission",role:i,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:s})}}),_s().K.set({userId:t.currentUser.id,key:Os(o.id),value:!1}),Ps().Jg(t,{role:i,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:i,user_id:n.id}],invite_message_length:0,invite_flow_id:s}),Ma(t,{flow_id:s,selection:"invite",target_user_id:n.id,from:r}),$r().HK(function(e){const{user:t,intl:n,environment:o,pageStore:i,flowId:s,from:r}=e;return{id:`invite_${t.id}`,icon:Hr().X,title:n.formatMessage(Aa.pageInviteSnackbarSuccessTitle),jsxMessage:void 0,message:n.formatMessage(Aa.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(Aa.pageInviteUndo),onAction:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:o,canUndo:!0,perform:e=>{i&&Bs().zP({environment:o,transaction:e,store:i,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:s})}}),$r().UW(`invite_${t.id}`),function(e,t){(0,Bt().u4)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("undo_invite_to_page_popup",void 0,t)}(o,{flow_id:s,target_user_id:t.id,from:r})}}}}}(e))}},secondary:{title:i.formatMessage(Aa.pageInviteToastIgnoreButton),onAction:()=>{o&&($r().UW(`invite_${n.id}`),Ma(t,{flow_id:s,selection:"dismiss",target_user_id:n.id,from:r}))}}}}}({environment:f,user:t,pageStore:S,intl:h,flowId:o,from:D})),function(e,t){(0,Bt().u4)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("trigger_invite_to_page_popup",void 0,t)}(f,{flow_id:o,target_user_id:t.id,from:D})}),[f,M,N,L,S,D,h]),E=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.flowId:void 0),[]),U=(0,o.useCallback)(((e,t,n,o)=>{t.reset(),n.reset(),E&&(t.setState({...t.state,tokenQuery:o}),n.setState({...n.state,flowId:E}),ys().TS(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:E}),Vi().A.updateOpenState({showInvite:!0}))}),[E]),F=(0,s().K8)((()=>b.map((e=>{const t=e.id;return{key:t,render:n=>(n.focused&&d({title:(0,Yr().c6)(h,e),icon:(0,P.jsx)(is,{}),allowTabCompletion:!0}),(0,o.createElement)(la,{...n,key:t,user:e})),action:o=>{const i=(0,Qr().om)(t);A&&"none"===i?(l.setState({userId:t,userEmail:e.email,displayName:(0,Wr().A7)(e).getDisplayName(h)}),Vi().A.updateOpenState({showMentionAndShare:!0})):(y().createAndCommit({userAction:"MentionMenu.menuItem",environment:f,canUndo:!0,perform:t=>{Ri().Ju({environment:f,editorMode:"default",annotations:[(0,g().P4h)(e.id)],transaction:t,menuListItemAction:o,query:n,mentionType:"user"})}}),O({user:e}))}}})).concat(C&&_?[{key:ba,action:()=>U(f,r,a,n),render:e=>(e.focused&&d({title:"",icon:(0,P.jsx)(is,{}),allowTabCompletion:!1}),(0,P.jsx)(Kt().A,{...e,icon:(0,P.jsx)(Ds().I,{icon:Ts().x}),title:n.length>0?(0,P.jsx)(V().sA,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,P.jsx)(V().sA,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[O,f,U,h,r,l,a,n,d,C,A,_,b]),K=(0,o.useMemo)((()=>[...B?[B]:[],...R,...k,...w,...F]),[B,k,w,R,F]),z=(0,o.useMemo)((()=>{if(0!==K.length||x)return{key:"user results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:K}}),[K,t,x]);return v?{userResultsSection:z,isUserResultsLoading:x,numberOfUserResults:b.length}:{userResultsSection:void 0,isUserResultsLoading:!1,numberOfUserResults:0}}function Sa(e){const{user:t}=e,n=(0,_e().IS)((()=>{const e=(0,_o().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.tooltipBackground,color:e.text.contrastPrimary}}}),[]);return(0,P.jsxs)("div",{style:n.container,children:[(0,P.jsx)(Ke().A,{overlayContainerZIndex:202,alignment:k().C.Center,originGap:2,placement:k().W.Top,renderTooltip:()=>t.email,render:e=>(0,P.jsx)("div",{style:n.tokenContainer,...e,children:(0,P.jsx)(Xr().t_,{userValue:t,isSingle:!0,shouldShrink:!0,format:Xr().t_.Format.Medium})}),style:n.darkTooltip}),(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{...Aa.pageInviteToastMessage})})]})}function Ma(e,t){(0,Bt().u4)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("select_invite_to_page_popup",t.selection,t)}const Aa=(0,V().YK)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They won’t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var wa=()=>n(599932);function ka(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,r=i.length>0,a=(0,s().K8)((()=>Vi().A.state.open&&Vi().A.state.insertionType),[]),l=function(e){const{templateVariableResults:t,query:n,numberOfUserResults:o}=e,i=(0,s().K8)((()=>Vi().A.state.open),[]),r=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.sectionOrder:void 0),[]),a=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:o}=e,i=t+n.length;if(""===o||i>0||(0,wa().xn)(o))return!0;const s=n.some((e=>(0,Gs().BX)(e,"user")));if(s)return!0;return!1}({numberOfUserResults:o,templateVariableResults:t,query:n});if(i&&r)return r;if(a)return Ca;return ja}({numberOfUserResults:t,templateVariableResults:n,query:i});return(0,o.useMemo)((()=>{const e=l,t=(0,Bn().sb)([...e,...Vi().k]),n=t.filter((e=>"createPage"!==e));return"+"===a?["createPage",...n]:"@"===a&&r||"[["===a?[...n,"createPage"]:t}),[r,a,l])}const ja=["date","page","team","group","heading","user"],Ca=["date","user","page","team","group","heading"];function Ia(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:r,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c}=e,[u,m]=(0,o.useState)(ja[0]),p=(0,i().v3)(),g=(0,s().K8)((()=>(0,Ws().y)(p)),[p]),h=(0,_e().DP)(),v=(0,i().WS)(),{expandSection:y,isOpen:b}=(0,s().K8)((()=>({isOpen:Vi().A.state.open,expandSection:Vi().A.state.open?Vi().A.state.expandSection:void 0})),[]),x=function(e){const t=(0,V().tz)();return(0,s().K8)((()=>Vi().A.state.mentionTypes.templateVariable),[])?(0,Gs().W4)(e,t):[]}(t),S=function(e){const t=(0,s().K8)((()=>Vi().A.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:i}=(0,s().K8)((()=>({automationActionStore:$s().A.state.automationActionStore,typecheckResult:$s().A.state.typecheckResult})),[]),r=(0,o.useMemo)((()=>n&&i?(0,Hs().getContextValuesForAction)({value:i},n.id):(null==i?void 0:i.valueTypes)||[]),[n,i]),a=i&&t;return(0,o.useMemo)((()=>a?(0,Ys().Ay)(e,r,(e=>e.kind!==Gi().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[a,e,r])}(t),{pageResultsSection:M,isPageResultsLoading:A}=Kr({query:t,isFirstSection:"page"===u,setTemporaryInputData:c,formulaContextVariableResults:S}),w=br({templateVariableResults:x,formulaContextVariableResults:S,isFirstSection:"date"===u,query:t,setTemporaryInputData:c}),k=Tr({query:t,setTemporaryInputData:c,isFirstSection:"heading"===u}),{teamResultsSection:j,currentTeamResultStore:C}=Pr({isFirstSection:"team"===u,environment:p,query:t,setTemporaryInputData:c}),{userResultsSection:I,isUserResultsLoading:T,numberOfUserResults:_}=xa({isFirstSection:"user"===u,query:t,inviteTargetsStore:r,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:l,setTemporaryInputData:c,templateVariableResults:x,formulaContextVariableResults:S,currentTeamResultStore:C,disabled:g}),B=wr({isFirstSection:"group"===u,query:t,setTemporaryInputData:c}),R=rr({isFirstSection:"createPage"===u,query:t,clearSavedSelection:n,setTemporaryInputData:c}),L=function(e){const{mentionMenuCurrentFormulaStore:t,setTemporaryInputData:n,isFirstSection:i,formulaContextVariableResults:r}=e,a=r.filter((e=>e.kind===Gi().FormulaContextValueKind.ContextValue&&"block"===e.type.type)),l=(0,s().K8)((()=>{const e=a.map((e=>{const o=(0,Yi().sM)(e),i=(0,Yi().E9)(e),s=(0,Yi().Ix)(e.type);return{action:fr(e,t),key:e.id,render:e=>(e.focused&&n({title:o,icon:(0,P.jsx)(is,{}),allowTabCompletion:!1}),(0,P.jsx)(gr().A,{...e,right:(0,pr().V)({height:"auto",marginInlineStart:6,width:12}),svg:s,title:o,tooltipText:i}))}}));return(0,f().oE)(e)}),[a,t,n]),d=(0,o.useMemo)((()=>{if(0!==l.length)return{items:l,key:"formula property results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Property from",id:"mentionMenu.formulaPropertySection.title"}),desktopTitleStyle:i?{paddingTop:4}:void 0,topBorder:!i})}}),[l,i]);return d}({mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,isFirstSection:"formula"===u,formulaContextVariableResults:S}),D=function(e){const{query:t,formulaContextVariableResults:n,setTemporaryInputData:r,isFirstSection:a}=e,l=(0,i().v3)(),d=(0,s().K8)((()=>vr({environment:l,formulaVariableFilter:e=>e.kind===Gi().FormulaContextValueKind.ContextValue&&(0,Yi().IF)(e),query:t,formulaContextVariableResults:n,setTemporaryInputData:r})),[l,n,t,r]),c=(0,o.useMemo)((()=>{if(0!==d.length)return{items:d,key:"custom formula results",render:e=>(0,P.jsx)(zt().A,{...e,title:(0,P.jsx)(V().sA,{defaultMessage:"Custom",id:"mentionMenu.customFormulaVariables.title"}),desktopTitleStyle:a?{paddingTop:4}:void 0,topBorder:!a})}}),[d,a]);return c}({query:t,formulaContextVariableResults:S,setTemporaryInputData:c,isFirstSection:"custom-formula"===u}),N=(0,o.useMemo)((()=>({date:w,user:I,page:M,group:B,team:j,heading:k,createPage:R,formula:L,"custom-formula":D,bot:void 0})),[w,I,M,B,j,k,R,L,D]),O=ka({templateVariableResults:x,numberOfUserResults:_,query:t});(0,o.useEffect)((()=>{const e=O.find((e=>void 0!==N[e]));m(e??O[0])}),[N,O]);const E=!T&&!A;(0,o.useEffect)((()=>{const e=zs().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");E&&zs().default.DO_NOT_USE_measureLegacy(e,{environment:p})}),[p,E]);const U=(0,o.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:o,expandSection:i,theme:s,isPhone:r}=e;if(!o||i===t)return n;const{items:a}=n,l=r||"heading"===t?3:5;if(a.length<=l)return n;const d=[...a.slice(0,l),{key:"show more",render:e=>(0,P.jsx)(Kt().A,{...e,icon:(0,Vs()._)({width:16,fill:s.text.secondary}),title:(0,P.jsx)("span",{style:{color:s.text.secondary},children:(0,P.jsx)(V().sA,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:a.length-l}})})}),action:()=>{Vi().A.updateOpenState({expandSection:t})}}];return{...n,items:d}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:v,isOpen:b,expandSection:y,theme:h})),[v,b,y,h]);return(0,o.useMemo)((()=>{const e=[];for(const t of O){const n=N[t];n&&(g&&"user"===t||e.push("createPage"===t?n:U({sectionName:t,menuSection:n})))}return e}),[O,N,U,g])}const Ta=(0,V().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),_a=(0,V().YK)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),Pa=o.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:a}=e;return(0,P.jsx)(Ba,{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:a})}));function Ba(e){let{query:t,queryRef:r,clearSavedSelection:a,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u}=e;const m=(0,V().tz)(),p=(0,i().v3)(),g=(0,s().O$)(Vi().A),f=(0,s().O$)(Us().e),h=Boolean(g.open&&g.usePopupOnMobile),v=cs(r),y=Ia({clearSavedSelection:a,query:t,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u,setTemporaryInputData:v}),x=(0,n(190094).o_)();let M;(0,o.useEffect)((()=>{if(!f)return;const e=g.mentionTypes.user,t=g.mentionTypes.page,n=g.mentionTypes.date;let o="";e&&t&&n?o=m.formatMessage(_a.mentionAll):e&&t?o=m.formatMessage(_a.mentionPersonPage):e&&n?o=m.formatMessage(_a.mentionPersonDate):t&&n?o=m.formatMessage(_a.mentionPageDate):e?o=m.formatMessage(_a.mentionPerson):n?o=m.formatMessage(_a.mentionDate):t&&g&&(o=g.open&&"+"===g.insertionType?m.formatMessage(Ks.addPage):m.formatMessage(_a.mentionPage)),v({title:o,icon:(0,P.jsx)(ts,{insertionType:g.open?g.insertionType:"+"}),allowTabCompletion:!1})}),[f,v,m,g]),f||(M=(0,P.jsx)(Fs().A,{title:(0,P.jsx)(V().sA,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})}));const{device:A}=p,w=(0,s().K8)((()=>330),[]),k=xs(p,r);let j;j=Ss({usePopupOnMobile:h})?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${x}px)`}:{menuType:S().gu.Popup,width:w,maxHeight:A.isMobile?"30vh":"40vh",onClickOutside:k};const C=(0,o.useCallback)((e=>{(function(e){return""===e})(r.current??"")&&(e.preventDefault(),k())}),[r,k]);return(0,P.jsxs)(b().A,{...j,header:M,children:[(0,P.jsx)(st().A,{debugName:"MentionMenu",capture:g.open,onBackspace:C}),(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,initialFocus:Ra(t),sections:y,onEmptyEnter:k,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===y.length&&(0,P.jsx)(zt().A,{children:(0,P.jsx)(Fs().A,{title:(0,P.jsx)(V().sA,{...Ta.noResults})})})]})}function Ra(e){if(""!==e)return 0}function La(){const e=(0,i().v3)(),t=(0,s().O$)(Vi().A),n=t.open&&t.showCreateIn,r=t.open&&t.showInvite,a=t.open&&t.showMentionAndShare,l=t.open&&t.showFormulaProperty,d=Boolean(t.usePopupOnMobile),c=(0,s().uB)(void 0,Ei().Ay),u=(0,s().uB)(void 0,Oi().A),m=(0,s().uB)(void 0,fs),p=(0,s().uB)(void 0,Ki),g=(0,s().K8)((()=>{if(t.open)return A().aX(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),f=(0,s().K8)((()=>{if(g&&t.open)return A().mX(t.textStore,g)}),[g,t]),h=(0,s().K8)((()=>hs(e,f)),[e,f]),v=(0,o.useRef)(h);(0,o.useEffect)((()=>{v.current=h}),[h]);const y=(0,s().K8)((()=>!!t.open&&("+"!==t.insertionType||""!==h)),[h,t]),b=(0,s().K8)((()=>Rt().ao()),[]),w=y&&(b&&(n||r)||a),{clearSavedSelection:C,getSavedSelection:T}=(0,Ni().A)({shouldPreserveTextSelection:w,shouldPreserveBlockSelection:!1,shouldRestoreSelection:w});(0,o.useEffect)((()=>{const e=Vi().A.state;if(e.open){var t;const n=I().default.state,o="editing"===n.mode?(0,M().H7)(n.multiSelection):void 0,i=(null==o?void 0:o.store)===e.textStore,s=T().textSelectionState,r=s&&"editing"===s.mode&&(null===(t=(0,M().H7)(s.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!i&&!r)return void Ri().VN();const a=i&&(null==o?void 0:o.selection);if(g&&a&&(a.startIndex<g.filter.startIndex||a.endIndex>g.filter.endIndex))return void Ri().VN();const l=f&&f[0];if("+"===e.insertionType&&l&&!(0,Di().D$)(l))return void Ri().VN();if("@"===e.insertionType&&l&&(0,Di().Yv)(l))return void Ri().VN();if(void 0===f&&!e.isEmptyPageTitle)return void Ri().VN()}}),[f,T,g]);const{device:_}=e,[B,R]=(0,o.useState)(void 0),L=Li().A.getSize(),D=(0,s().K8)((()=>{if(_.isMobile&&0!==L)return Li().A.find((e=>e.isCaptured()))}),[_,L]);(0,o.useEffect)((()=>{const e=null==D?void 0:D.getNode();if(e){const t=new(zi().E);return t.observe(e),t.rect.addListener((e=>{R({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[D]);const N=Ss({usePopupOnMobile:d}),O=N?j().n.SlideUp:j().n.Popup,E=xs(e,v);return(0,P.jsx)(x().Ay,{popupType:O,open:y,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22}:t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:12,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:E,disableDarkOverlayBackground:_.isMobile,keepFocus:!0,trapFocus:!1,render:()=>_.isMobile?(0,P.jsxs)(P.Fragment,{children:[!a&&(0,P.jsx)(Pa,{query:h,queryRef:v,clearSavedSelection:C,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:p}),(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,P.jsx)(As,{clearSavedSelection:C,filter:f}),open:n,keepFocus:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,P.jsx)(Cs,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}),open:r,keepFocus:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{popupType:O,render:()=>(0,P.jsx)(Es,{mentionMenuCurrentMentionStore:m,menuPopupType:N?S().gu.ActionSheet:S().gu.Popup}),open:a,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{keepFocus:!0,open:l,popupType:j().n.SlideUp,render:()=>(0,P.jsx)(ms,{mentionMenuCurrentFormulaStore:p,queryRef:v}),trapFocus:!1})]}):n?(0,P.jsx)(As,{clearSavedSelection:C,filter:f}):r?(0,P.jsx)(Cs,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}):a?(0,P.jsx)(Es,{mentionMenuCurrentMentionStore:m,menuPopupType:S().gu.Popup}):l?(0,P.jsx)(ms,{mentionMenuCurrentFormulaStore:p,queryRef:v}):(0,P.jsx)(Pa,{query:h,queryRef:v,clearSavedSelection:C,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:p})})}var Da=()=>n(437800),Na=()=>n(409103),Oa=()=>n(505381),Ea=()=>n(336519),Ua=()=>n(658388),Fa=()=>n(995625);const Ka={...Na().k2,csv:[...Na().k2.csv,"text/csv"]},Va=Na().fF.filter((e=>["csv","docx","html","txt","markdown","pdf"].includes(e)));function za(e){return Object.keys(Ka).includes(e)}function Wa(e){var t;const{type:n,environment:o}=e,i=function(e){for(const t of Object.keys(Ka)){if(!za(t))continue;const n=Ka[t];if((Array.isArray(n)?n.flat(1/0):[n]).includes(e))return t}}(n);if(!i||"string"!=typeof n||!Va.includes(i))return;const s=(0,Fa().R$)(o),r=null==s||null===(t=s.getSettings())||void 0===t?void 0:t.adoption_entry_points,a=r?null==r?void 0:r.import_nudge_on_drag:void 0;if(a&&a.length>0)return;J().default.checkGate({gateName:"contextualized_import_entrypoints"})&&((0,Qn().t)({environment:o,action:"view",from:"import_nudge_on_drag"}),$r().Iz({message:Nt().A.formatMessage(Ha.triggerNudgeOnDragDescription),presentationType:"transient",id:"nudge-on-drag",title:Nt().A.formatMessage(Ha.triggerNudgeOnDragTitle),onUserDismiss:()=>{(0,Qn().t)({environment:o,action:"dismiss",from:"import_nudge_on_drag"})},onDismiss:()=>{Ua().pr(o,{entryPoint:"import_nudge_on_drag"})},actions:{primary:{title:Nt().A.formatMessage(Ha.triggerNudgeOnDragPrimaryAction),onAction:()=>{(0,Qn().t)({environment:o,action:"click",from:"import_nudge_on_drag"}),Oa().kY(o,{from:"import_nudge_on_drag"}),$r().UW("nudge-on-drag"),Ea().Ow({currentTab:"imports",openedFrom:"import_nudge_on_drag",subtab:i})}}}}))}const Ha=(0,V().YK)({triggerNudgeOnDragTitle:{id:"adoption.nudgeOnDrag.title",defaultMessage:"Try importing your file"},triggerNudgeOnDragDescription:{id:"adoption.nudgeOnDrag.description",defaultMessage:"You can import this file to directly edit your content in a Notion database"},triggerNudgeOnDragPrimaryAction:{id:"adoption.nudgeOnDrag.primaryAction",defaultMessage:"Import now"}});const Ga=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=Da().v7(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&Do().IU({environment:t})}(t,e),o(t)},o=f().nF((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(qa,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&J().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),Da().GB(e,{currentX:n.clientX,currentY:n.clientY})}),Ya),i=t=>{!function(e,t){var n;e.preventDefault();const o=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);o.length>0&&(Wa({environment:t,type:o[0].type}),Da().b({environment:t,files:o,analyticsFrom:"native_drag"}))}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},Ya=62.5;function qa(e){Da().Pt(e)}var $a=()=>n(216143),Qa=()=>n(729522),Za=()=>n(151835);const Xa=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>{const e=I().default.state;if("editing"!==e.mode)return null;const t=(0,M().H7)(e.multiSelection);if(!t)return null;const{store:n,selection:o}=t;if(o.endIndex!==o.startIndex+1)return null;const i=n.getValue(),s=g().ANx(i,o.startIndex);if(!s||!g().rjO(s))return null;const[r]=g().N5L([s]);return{pageId:r,store:n}}),[]),n=(0,o.useCallback)((()=>(0,P.jsx)(Ja,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const r=Qa().getSelectionRect();return(0,P.jsx)(Ke().A,{render:()=>{},renderTooltip:n,originRect:r,forceVisibleState:Boolean(t&&r),placement:k().W.Bottom})};function Ja(e){let{pageMentionTokenStoreState:t}=e;const n=(0,_e().DP)(),s=(0,i().v3)(),r=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault();const s=te().Bv.createChildStore(i,{table:Pn().ev,id:o});er().uK({store:s,environment:t,visitType:$a().ig.Link,openInNew:"tab",pageVisitSource:E().y8.MentionInPage})}(e,s,t)),[s,t]),a=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault&&e.preventDefault();const s=te().Bv.createChildStore(i,{table:Pn().ev,id:o});er().uK({store:s,environment:t,visitType:$a().ig.Link,pageVisitSource:E().y8.MentionInPage})}(e,s,t)),[s,t]);return(0,P.jsx)(st().A,{debugName:"PageMentionOverlay",capture:!0,onEnter:a,onCommandEnter:r,children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(V().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{onlyShowFirst:!0,name:"enter",style:{color:n.text.contrastSecondary}})})]})})}var el=()=>n(941746),tl=()=>n(235006),nl=()=>n(308265);function ol(){const e=(0,V().tz)(),t=(0,_e().DP)(),n=(0,i().v3)(),r=(0,nl().BG)(),{device:a}=n,l=(0,s().K8)((()=>tl().A.state.blockStore),[]),d=(0,s().K8)((()=>null==l?void 0:l.getTitleStore()),[l]),c=(0,s().K8)((()=>(null==l?void 0:l.canEdit())??!1),[l]),u=(0,s().K8)((()=>{var t;return(null==l||null===(t=l.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:l.getRecordModel,userTimeZone:(0,U().P)(),intl:e,isWorkflowsAppContainerEnabled:r}))??""}),[l,e,r]);if((0,o.useEffect)((()=>{const{blockStore:e}=tl().A.state;if(!e)return;const t=e.getTitleStore();t&&De().selectAllText({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!l||!d)return null;let m;return m=a.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,P.jsx)(b().A,{...m,children:(0,P.jsx)("div",{style:sl(t),children:(0,P.jsx)(Ve().A,{store:d,disabled:!c,onEsc:()=>el().V(n),onEnter:()=>el().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:u,style:rl(t),pasteBehavior:"inline",inPageFind:Oe().Os.none})})})}const il=function(){const e=(0,i().v3)(),{device:t}=e,{blockStore:n,originRect:o}=(0,s().K8)((()=>{const{blockStore:e,originRect:t}=tl().A.state;return{blockStore:e,originRect:t}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,originGap:4,onDismiss:()=>el().V(e),render:()=>(0,P.jsx)(ol,{}),trapFocus:!0})};function sl(e){return{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"}}function rl(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var al=()=>n(52531),ll=()=>n(759625),dl=()=>n(347549),cl=()=>n(438885),ul=()=>n(28210);function ml(e){const t=(0,V().tz)(),n=(0,i().v3)(),{device:r}=n,a=(0,nl().BG)(),l=(0,s().K8)((()=>cl().A.state.clonedBlockStore),[]),d=(0,s().K8)((()=>null==l?void 0:l.getTitleStore()),[l]),c=(0,s().K8)((()=>(null==l?void 0:l.canEdit())??!1),[l]),u=(0,s().K8)((()=>{var e;if(l)return null===(e=l.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:l.getRecordModel,userTimeZone:(0,U().P)(),intl:t,isWorkflowsAppContainerEnabled:a})}),[l,t,a]);(0,o.useEffect)((()=>{if(!l)return;const e=l.getTitleStore();e&&De().selectAllText({environment:n,store:e,canSelectAllBlocks:!1})}),[l,n]);const m=(0,_e().IS)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!l||!d)return null;const{renderDelete:p}=e;let g;return g=r.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,P.jsx)(b().A,{...g,children:(0,P.jsxs)("div",{style:m.wrapper,children:[(0,P.jsx)(hl,{blockStore:l}),(0,P.jsx)(Ve().A,{store:d,disabled:!c,onEsc:()=>dl().V(n),onEnter:()=>dl().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:u,style:m.input,pasteBehavior:"inline",inPageFind:Oe().Os.none}),p&&c&&(0,P.jsx)(gl,{})]})})}const pl=function(){const e=(0,i().v3)(),{device:t}=e,{clonedBlockStore:n,originRect:o}=(0,s().K8)((()=>{const{clonedBlockStore:e,originRect:t}=cl().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,originGap:4,onDismiss:()=>dl().V(e),render:()=>(0,P.jsx)(fl,{}),trapFocus:!0})};function gl(){const e=(0,i().v3)(),t=(0,V().tz)();return(0,P.jsx)(Fe().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,al().I)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=cl().A.state;t&&await Lo().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),dl().V(e)}})}function fl(){const e=(0,s().K8)((()=>cl().A.state.renderDelete),[]);return(0,P.jsx)(ml,{renderDelete:Boolean(e)})}function hl(e){let{blockStore:t}=e;const n=(0,_e().DP)(),o=(0,i().v3)(),r={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},a=(0,s().K8)((()=>t.canEdit()),[t]),l=(0,s().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,s().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,s().K8)((()=>t.getIcon()),[t]),u=(0,s().K8)((()=>t.isEmptyPage()),[t]),m=(0,s().K8)((()=>t.getType()),[t]);return a?(0,P.jsx)(ul().B,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:r,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:m,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=cl().A.state;if(n){const o=n.getIconStore();o&&y().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{ll().KY({store:o,value:e,transaction:t})}})}}(e,o)}):(0,P.jsx)(ul().B,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:r})}n(107652);var vl=()=>n(556078),yl=()=>n(716605);const bl=(0,wo().wt)("bold",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var xl=()=>n(198654),Sl=()=>n(940112),Ml=()=>n(273919);const Al=(0,wo().wt)("italic",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var wl=()=>n(319989);const kl=(0,wo().wt)("strikethrough",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),jl=(0,wo().wt)("underline",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var Cl=()=>n(21164),Il=()=>n(810310),Tl=()=>n(870099),_l=()=>n(352118),Pl=()=>n(165924);function Bl(e){const{clientSkill:t}=e,n=(0,V().tz)(),o=(0,s().K8)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,P.jsx)(P.Fragment,{children:o})}var Rl=()=>n(415953);function Ll(e){if(e.inMemoryRecordCache.isMockTextStore){const t=e.getRecordStoreAtRootPath();if(t.table===Pn().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof te().bx||e instanceof te().dn)).ancestor)}var Dl=()=>n(126451);function Nl(e){const t=(0,i().v3)(),{isMobile:s}=(0,i().Y0)(),r=(0,o.useRef)(null),a=async()=>{const o=I().default.state;if("empty"===o.mode)return;const i=await n(73631).T.formulas.load();n(56576).of({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,formulasModule:i})};return(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,P.jsxs)(Dl().A,{ref:r,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...t,children:[(0,n(745719).s)({width:s?22:20,height:s?22:20,marginTop:s?0:1,marginRight:e.iconOnly?0:4}),!s&&!e.iconOnly&&(0,P.jsx)(V().sA,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}Nl.displayName="InlineReactionButton";const Ol=Nl;var El=()=>n(459742),Ul=()=>n(733158),Fl=()=>n(400885),Kl=()=>n(53664),Vl=()=>n(271748),zl=()=>n(286555),Wl=()=>n(799220),Hl=()=>n(615661),Gl=()=>n(308966),Yl=()=>n(950452),ql=()=>n(240579),$l=()=>n(410625),Ql=()=>n(505506),Zl=()=>n(872386),Xl=()=>n(518397),Jl=()=>n(273520),ed=()=>n(390556),td=()=>n(378809),nd=()=>n(336400);function od(e){const t=(0,i().v3)(),{isMobile:n}=(0,i().Y0)(),r=(0,s().K8)((()=>"suggest"===Hl().Uv.getMode(e.blockStore)),[e.blockStore]),a=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof te().Bv&&n.isNavigableBlock()&&nd().PD({environment:t,navigableBlockStore:n,mode:r?"default":"suggest",location:"rich_text_menu"})},l=(0,_e().IS)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:r?t.blueColor:t.icon.primary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,r,e.iconOnly,e.style]);return(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:r?(0,P.jsx)(V().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,P.jsx)(V().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,P.jsx)("div",{})]}),render:t=>(0,P.jsxs)(Dl().A,{style:l.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...t,children:[(0,td().A)(l.icon),!n&&!e.iconOnly&&(r?(0,P.jsx)(V().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,P.jsx)(V().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var id=()=>n(934799),sd=()=>n(148418),rd=()=>n(777880);function ad(){var e;if(!(0,Ye().X)("selectable_word_count"))return null;const t=null===(e=Qa().get())||void 0===e?void 0:e.cloneContents(),n=t?ld(t):0;return 0===n?null:(0,P.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,P.jsx)(V().sA,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function ld(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];o.childNodes.length>0?t+=ld(o):o.textContent&&(t+=(0,Ne().sQ)(o.textContent))}return t}const dd={[Xe().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[Xe().xd.code]:new Set(["showCode","showCompletions"]),[Xe().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Xe().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},cd={[Xe().xd.factory]:!0};const ud=function(){const e=(0,vl().S)(),t=(0,i().v3)(),r=(0,i().Y0)(),a=(0,s().O$)($l().A),{isActive:l,blockTarget:d,isAnimatingClosed:c}=a,u=(0,s().O$)(X().AppStoreMainEditorCurrentBlockStore),m=(0,s().K8)((()=>Ot().zD.isRichTextMenuSuggestionEnabled()),[]),p=(0,s().K8)((()=>{var e;return"slack_notification"===(null===(e=$s().A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[g,h]=(0,o.useState)(void 0),v=(0,o.useCallback)((()=>{var e;if(!m||!u)return;const n=(0,jt().filterAndRankAssistantSurfaceActionsForContext)((0,jt().clientSkillToAssistantSurfaceAction)((0,Ct().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:u,selectionState:Ft().default.state,textSelectionState:I().default.state,isMobile:t.device.isMobile,userSettings:null===(e=X().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[m,u,t]),y=(0,s().K8)((()=>{const t=d,o=I().default.state;if(!l||"empty"===o.mode)return;const{multiSelection:i}=o,s=(0,Ul().$W)(i),r=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),a=(0,M().KP)(i),c=I().default.isEditingComment(),u=I().default.isEditingFormQuestion(),m=t&&"form"===t.getType(),f=u||m,h=I().default.isEditingCaption(),v=t&&t.getParentTable()===Cl().Vl,y=a&&t&&i.start.store===t.getCollectionViewSourceDescriptionStoreIfSingleSource(),b=n(724903).Gb(),x=e&&e.publicEditModeStore.state,S=!(0,Qr().QT)(x)&&(i.start.store.canEdit()&&i.end.store.canEdit()),A=t&&"suggest"===Hl().Uv.getMode(t),w=J().default.checkGate({gateName:"block_reactions"}),k=r.some(((e,t)=>{const n=s[t].store.table===To().SN&&!s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),j=S&&!k,C=t&&t.getType(),T=C&&dd[C],_=null==t?void 0:t.isType("button"),P=(0,Rl().u)(i.start.store)||(0,Rl().u)(i.end.store),B=Ll(i.start.store)||Ll(i.end.store);let R=!1;const L=Ae().A.state.isOpen?Ae().A.state:we().A.state.isOpen?we().A.state:void 0;if(L){const e=L.store.getParentStore();if((null==e?void 0:e.table)===Cl().Vl){const t=e.getSchema(),n=L.property,o=(0,yl()._g)({schema:t,property:n});"text"!==(null==o?void 0:o.type)||o.ai_inference||(R=!0)}}const D={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!c&&!v&&!y&&!h&&t&&j&&!_&&!A&&!f&&(P||!B)),showBold:Boolean(j),showItalic:Boolean(j),showStrikethrough:Boolean(j),showUnderline:Boolean(j)&&!p,showCode:Boolean(j)&&!p,showLink:Boolean(a&&j),showHighlight:Boolean(j)&&!p,showDiscuss:Boolean(!c&&t&&(R||!v)&&!y&&!f&&!B),showReact:Boolean(w&&!c&&t&&!v&&!y&&!B&&!f),showSuggest:Boolean(!c&&t&&!s.some((e=>e.editable.props.disableSuggestEdit))&&!v&&!y&&!B&&!b&&!k&&!f),showEquation:Boolean(a&&j&&!A&&!f&&!p),showActionButton:Boolean(a&&!c&&!h&&t&&!v&&!f&&(P||!B)),targetBlockStore:t,isComment:c,showCompletions:Boolean((0,n(88442).ZE)(x)&&j&&!c&&!h&&t&&!v&&!y&&!_&&!B&&!A&&!f),topRankedSkill:g};if(T&&T.size>0)for(const e of T)D[e]=!1;return D}),[d,l,e,g,p]),[b,x]=(0,o.useState)(y);(0,o.useEffect)((()=>{y&&x(y)}),[y]);const S=(0,s().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),A=(0,s().K8)((()=>y&&y.showDiscuss&&!y.showBold),[y]),w=(0,o.useCallback)((()=>{if(n(224812).A.state.open||Ql().A.state.open)return;if(n(177086).l.state)return Pl().I();const e=I().default.state;if("empty"===e.mode)return Pl().I();const o=(0,Ul().$W)(e.multiSelection);if(0===o.length)return Pl().I();if(!o.every((e=>{let{store:t}=e;return t.table===Pn().ev||t.table===To().SN||t.table===Cl().Vl||t.table===n(109046).lo})))return Pl().I();if(!t.currentUser.isLoggedIn()||!o.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=Qa().get();if(Rt().fI())return Pl().I();if(o.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return Pl().I();const s=o.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(s.some((e=>e&&e.pathIsDead())))return Pl().I();if(s.some((e=>e&&(0,Wl().dL)(e))))return Pl().I();if(s.some(((e,t)=>{const n=o[t].store.canComment(),i=o[t].store.table===To().SN&&o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Pl().I();const l=o.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof te().Bv))return!1;const o=n.getValue();return!!o&&cd[o.type]}));if(l)return Pl().I();const d=i?Qa().getRect(i):void 0;if(d&&!zl().HY(d,(0,n(791019).A)()))return Pl().I();if(cl().A.isActive()||tl().A.isActive()||Si().A.isOpen()||l||Vl().default.isPeekDismissableState()||!i||!function(){const e=Qa().get();return void 0!==e&&!e.collapsed&&"empty"!==I().default.state.mode&&!(0,M().kM)(I().default.state.multiSelection)}()||n(5413).A.state.open||"assistantCompletionPopup"===Ut().default.state.type)return Pl().I();let c=0,u=0;if(d){c=d.left;const e=25,t=d.top-36-e,o=n(129808).ek(r.isElectronMac),i=S-36-e;u=Math.min(Math.max(t,o),i)}0===Math.abs($l().A.state.top-u)&&Math.abs($l().A.state.left-c)<10&&(u=$l().A.state.top,c=$l().A.state.left),h(v()),$l().A.setState({...a,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:Ft().default.state.stores[0]})}),[t.currentUser,S,r.isElectronMac,a,h,v]),k=(0,o.useMemo)((()=>f().nF(w,200,{leading:!1})),[w]);(0,o.useEffect)((()=>(Ft().default.addListener(k),I().default.addListener(k),Gl().A.addListener(w),ql().A.addListener(w),Yl().A.addListener(w),Vl().default.addListener(w),()=>{I().default.removeListener(k),Ft().default.removeListener(k),Gl().A.removeListener(w),ql().A.removeListener(w),Yl().A.removeListener(w),Vl().default.removeListener(w)})),[w,k]);const j=(0,s().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===Pn().ev)return!!t&&(0,Fl().fc)(t);return!1}(d)),[d]),C=(0,o.useCallback)((()=>{a.isActive||$l().A.setState({...a,isAnimatingClosed:!1}),x(y)}),[a,y]);return(0,P.jsx)(on().A,{open:l||c,children:(0,P.jsx)(pd,{handleAnimationEnd:C,isActive:l,isExternallyImportedAndSyncedCollectionPageBlockTarget:j,lastRenderState:b,richTextMenuStoreState:a,canOnlyDiscuss:A})})},md=o.forwardRef((function(e,t){let{lastRenderState:n,richTextMenuStoreState:o,canOnlyDiscuss:i,style:s}=e;const{top:r,left:a}=o,l=Math.max(i?a:a-60,0),d=i?"12px 0":12;return(0,P.jsxs)("div",{className:Lt().Vl,style:{pointerEvents:"none",position:"absolute",top:r,left:0,display:"flex",width:"100%",...s},ref:t,children:[(0,P.jsx)("div",{style:{flexShrink:1,width:l,minWidth:24}}),(0,No().A)((e=>(0,P.jsx)("div",{style:{pointerEvents:"none",padding:d},...e,children:n&&(0,P.jsx)(Id,{renderState:n})}))),(0,P.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function pd(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:o,lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:r}=e;return(0,P.jsx)(Uo().A,{tag:md,visible:n&&!o,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:t,config:{duration:120},lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:r})}function gd(e){let{theme:t,styles:n}=e;return(0,P.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function fd(e){let{blockStore:t}=e;const n=(0,_e().DP)(),o=(0,i().v3)(),r=(0,V().tz)();let a=(0,P.jsx)(V().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,s().K8)((()=>t.getType()),[t]);if(l){const e=El().ry[l];a=e&&e.displayName||a}return(0,P.jsx)(Jl().Ay,{popupType:Jl().z7.Popup,buttonPopupStore:Ql().A,originGap:4,renderOrigin:e=>(0,P.jsx)(Ke().A,{renderTooltip:()=>r.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,P.jsxs)(Dl().A,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.icon.primary,borderRadius:6},...(0,tr().A)(e,t),children:[a,(0,xl().b)({width:10,marginLeft:4,fill:n.lightIconColor})]})}),render:()=>(0,P.jsx)(b().A,{menuType:S().gu.Popup,children:(0,P.jsx)(Xl().A,{context:{blocks:[t],environment:o,publicEditMode:void 0,analyticsFrom:"rich_text_menu"},sections:[Il().t3],onAccept:e=>{const n=t.getType(),i=t.getFormat();Pl().I(),(0,Tl().N)(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Kl().Yt)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,_l().s)(o,{action:"turn_into"})}})}function hd(){const e=(0,_e().DP)();return(0,P.jsx)(id().A,{type:"b",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:e.text.contrastSecondary},name:"toggleBold"})})]}),children:bl({width:16,height:16})})}function vd(){const e=(0,_e().DP)();return(0,P.jsx)(id().A,{type:"i",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:e.text.contrastSecondary},name:"toggleItalics"})})]}),children:Al({width:16,height:16})})}function yd(){const e=(0,_e().DP)();return(0,P.jsx)(id().A,{type:"s",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:e.text.contrastSecondary},name:"toggleStrike"})})]}),children:kl({width:16,height:16})})}function bd(){const e=(0,_e().DP)();return(0,P.jsx)(id().A,{type:"_",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:e.text.contrastSecondary},name:"toggleUnderline"})})]}),children:jl({width:16,height:16})})}function xd(){const e=(0,_e().DP)();return(0,P.jsx)(id().A,{type:"c",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(V().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:e.text.contrastSecondary},name:"toggleCode"})})]}),children:(0,Sl().N)({width:16,height:16})})}function Sd(e){let{}=e;const t=(0,_e().DP)();return(0,P.jsx)(rd().A,{children:(0,P.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,wl().w)({width:16,height:16,color:t.icon.primary}),(0,xl().b)({width:10,fill:t.lightIconColor})]})})}function Md(e){let{intl:t,topRankedSkill:n}=e;const o=(0,_e().DP)(),r=(0,i().v3)(),a=(0,s().K8)((()=>Ot().zD.isXMLAssistantEnabled()),[]);return(0,P.jsxs)(P.Fragment,{children:[n&&(0,P.jsxs)(Dl().A,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,Mt().Nj)({environment:r,clientSkillWithParameterValues:(0,Ct().dangerouslyCreateClientSkillWithParameterValues)(n),from:"rich_text_menu",assistantSurfaceType:r.device.isMobile?"mobileWriter":"writer"}),(0,_l().s)(r,{action:"completions"})},children:[n.icon({width:16,height:16,marginRight:6,fill:(0,It().vJ)(n.category).color(o).color}),(0,P.jsx)("span",{children:(0,P.jsx)(Bl,{clientSkill:n})})]}),(0,P.jsx)(Ke().A,{renderTooltip:()=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{children:a?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Za().A,{style:{color:o.text.contrastSecondary},name:"commandJ"})})]}),render:e=>(0,P.jsxs)(Dl().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,wt().toggleInitialPrompt)({from:"rich_text_menu",environment:r}),(0,_l().s)(r,{action:"completions"})},children:[(0,P.jsx)(kt().iB,{}),(0,P.jsx)("span",{style:{marginLeft:6,marginRight:2},children:(0,P.jsx)(V().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Ad(){const e=(0,i().v3)();return(0,P.jsx)(sd().A,{onClick:()=>{(0,_l().s)(e,{action:"e"}),Pl().I()},children:(0,Ml().c)({width:16,height:16})})}function wd(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,_e().DP)(),i=(0,V().tz)();return(0,P.jsx)(ed().A,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28},iconOnly:n,blockStore:t,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function kd(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,_e().DP)();return(0,P.jsx)(Ol,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28,width:n?28:void 0},iconOnly:n,blockStore:t})}function jd(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,P.jsx)(od,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function Cd(e){let{targetBlockStore:t}=e;const n=(0,_e().DP)(),o=(0,i().v3)();return(0,P.jsx)(Zl().A,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.icon.primary},fadeIn:!1,onClick:()=>{(0,_l().s)(o,{action:"more"})}})}function Id(e){let{renderState:t}=e;const o=(0,V().tz)(),i=(0,_e().DP)(),r=(0,s().K8)((()=>$l().A.state.isActive),[]),a=t.showDiscuss||t.showReact||t.showSuggest,l=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,d=l;return(0,P.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:r?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Md,{intl:o,topRankedSkill:t.topRankedSkill}),(0,P.jsx)(gd,{theme:i})]}),a&&t.targetBlockStore&&(0,P.jsxs)(P.Fragment,{children:[t.showDiscuss&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(wd,{targetBlockStore:t.targetBlockStore,iconOnly:!1}),!d&&(t.showReact||t.showSuggest)&&(0,P.jsx)(gd,{theme:i})]}),t.showReact&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(kd,{targetBlockStore:t.targetBlockStore,iconOnly:d}),!d&&t.showSuggest&&(0,P.jsx)(gd,{theme:i})]}),t.showSuggest&&(0,P.jsx)(jd,{targetBlockStore:t.targetBlockStore,iconOnly:d}),l&&(0,P.jsx)(gd,{theme:i})]}),l&&(0,P.jsxs)(P.Fragment,{children:[t.showTurnInto&&t.targetBlockStore&&(0,P.jsx)(fd,{blockStore:t.targetBlockStore}),(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,P.jsx)(hd,{}),t.showItalic&&(0,P.jsx)(vd,{}),t.showUnderline&&(0,P.jsx)(bd,{}),t.showStrikethrough&&(0,P.jsx)(yd,{}),t.showCode&&(0,P.jsx)(xd,{}),t.showEquation&&(0,P.jsx)(Ad,{})]}),t.showLink&&(0,P.jsx)(Sd,{}),t.showHighlight&&(0,P.jsx)(n(248188).A,{blockStore:t.targetBlockStore})]}),(0,P.jsx)(ad,{}),t.showActionButton&&t.targetBlockStore&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(gd,{theme:i}),(0,P.jsx)(Cd,{targetBlockStore:t.targetBlockStore})]})]})}var Td=()=>n(502852),_d=()=>n(191759),Pd=()=>n(667801),Bd=()=>n(440588);const Rd=5,Ld=18,Dd=.38;const Nd=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0),n=(0,o.useRef)(void 0),r=(0,o.useRef)(1/0),a=(0,o.useRef)(void 0),l=(0,s().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,o.useEffect)((()=>{l<Pd().OnlyOneSidebarVisibleWidthThreshold&&(0,$e().Nk)(e)&&(0,$e().KB)(e)&&Pd().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,l]),(0,o.useEffect)((()=>{const o=o=>{!function(e){let{e:t,environment:n,timerRef:o,cachedPageViewRectRef:i,previousMousePositionRef:s,mouseSpeedRef:r}=e;(0,Td().SQ)({event:t,context:Td().y$.SidebarMouseMove,callback:()=>{Ed(i),void 0!==s.current&&(r.current=Math.sqrt(Math.pow(t.clientX-s.current.x,2)+Math.pow(t.clientY-s.current.y,2))),function(e){let{x:t,y:n,timerRef:o,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(o.current),o.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:o,previousMousePositionRef:s});const e=J().default.checkGate({gateName:"sidebar_hover_expansion_v3"});if(i.current){const o=Bd().sidebarOpenStore.state,s=t.clientX,a=i.current.left,l=Math.max(a*Dd,Ld,Bd().sidebarMousePeekXStore.state);s<l&&!jr().default.isCenterPeekOpen()&&r.current<Rd&&0!==r.current&&!o&&!e&&Pd().open({fromElectron:!1}),s>(0,$e().r6)(n)&&s>l&&o&&Pd().close()}}})}({e:o,environment:e,timerRef:a,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:r})};return window.addEventListener("mousemove",o),window.addEventListener("mouseout",Od),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseout",Od)}}),[e]),(0,P.jsx)(P.Fragment,{})};function Od(e){e.toElement||e.relatedTarget||Pd().close()}const Ed=f().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=X().default.state,t=_d().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Ud=()=>n(966358),Fd=(n(771702),()=>n(16791)),Kd=()=>n(257987),Vd=()=>n(918244);const zd=(0,wo().xh)("page",{default:{loader:()=>n.e(82985).then(n.bind(n,823890))},small:{loader:()=>n.e(88931).then(n.bind(n,313992))},mini:{loader:()=>n.e(35189).then(n.bind(n,270942))},large:{loader:()=>n.e(86763).then(n.bind(n,420208))},extraLarge:{loader:()=>n.e(83295).then(n.bind(n,919732))}});var Wd=()=>n(162883),Hd=()=>n(30922),Gd=()=>n(387758),Yd=()=>n(66460),qd=()=>n(982145),$d=()=>n(455831),Qd=()=>n(598995),Zd=()=>n(145046),Xd=()=>n(865226),Jd=()=>n(861917),ec=()=>n(493124),tc=()=>n(173736),nc=()=>n(112224),oc=()=>n(944498),ic=()=>n(225679),sc=()=>n(481148),rc=()=>n(838517),ac=()=>n(900376),lc=()=>n(797470),dc=()=>n(943066),cc=()=>n(670682),uc=()=>n(613313),mc=()=>n(111826),pc=()=>n(764227),gc=()=>n(139586),fc=()=>n(167790),hc=()=>n(565361),vc=()=>n(835431),yc=()=>n(291796),bc=()=>n(305043),xc=()=>n(60525),Sc=()=>n(579494),Mc=()=>n(206799),Ac=()=>n(701270),wc=()=>n(286404),kc=()=>n(951540),jc=()=>n(142708),Cc=()=>n(442958),Ic=()=>n(371807),Tc=()=>n(564134),_c=()=>n(416199),Pc=()=>n(220574),Bc=()=>n(293665),Rc=()=>n(289765),Lc=()=>n(518471);const Dc=function(e){const t=(0,i().v3)(),r=(0,s().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),a=(0,s().K8)((()=>{var e;return null==r||null===(e=r.getLayoutStore())||void 0===e?void 0:e.getModules()}),[r]),l=(0,s().K8)((()=>{if(!r)return 0;const{count:e}=(0,qe().pm)({collectionStore:r});return e}),[r]),{device:{isMobile:d}}=(0,i().v3)(),c=l>0&&!d,u=(0,_e().IS)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1,...c&&{paddingLeft:70,paddingRight:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(589004).xt,flexShrink:0,borderLeft:`1px solid ${e.stroke.secondary}`}})),[c]),m=(0,o.useCallback)((e=>{Jd().un(),Xd().oo({environment:t,url:e})}),[t]),p=e.blockStore.id,h=e.timestamp,[v]=(0,he().Yb)((async()=>await async function(e,t,n){const{timestamp:o}=e,i=e.block.id,s=await W().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===s.type)throw s.error;const r=Pc().RecordMapWithRole.create(s.data.contentMap),a=n.currentUser.id,l=new(Ic().A)({name:"PageSnapshotPreview"});for(const{pointer:p,model:g}of r)g&&l.setModelAndRole({pointer:p,userId:a},g,"reader");l.snapshotData={blockId:i,timestamp:o};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:a}),o=(0,_c().jV)(e);n||!(0,qr().uj)(e.id)||d.has(o)||d.set(o,(0,te().Oo)(t,e))},u=[];for(const{model:p}of r)if(p)if(p.table===Pn().ev){const e=p,t=e.getProperties(),n=Bc().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(g().moK)));for(const d of n)c(d);const o=Bc().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(yl().n)));for(const d of o)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:Pn().ev,id:d});const s=e.getCollectionPointer();s&&(c(s),u.push(s.id));const r=f().sb(f().Bq(Object.keys(t).map((e=>t[e])).map(g().Fbh)));for(const d of r)c({table:Gr().oo,id:d});const a=p.getCreatedByPointer();a&&c(a);const l=p.getLastEditedByPointer();l&&c(l)}else if(p.table===Rc().Gy){var m;const e=null===(m=p.getFormat())||void 0===m?void 0:m.collection_pointer;e&&c(e)}else if(p.table===To().SN){const e=p.getCreatedByPointer();e&&c(e)}return await Nc({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:a}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Cl().Vl,id:e},userId:a}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const o=null===(t=n.schema)||void 0===t?void 0:t[e],i=o&&(0,Tc().nC)(o)?(0,Tc().zO)(o):void 0;i&&c({table:Cl().Vl,id:i})}))})),await Nc({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:a}),{blockStore:new(te().Bv)(n,{table:Pn().ev,id:i},{inMemoryRecordCache:l}),timestamp:o}}({block:{id:p,spaceId:(0,Yd().e)(e.blockStore.pointer.spaceId)},timestamp:h},e.blockStore,t)),[p,t,e.blockStore,h]),y="pending"!==v.status&&"idle"!==v.status,b=v.value,x=v.error,S=(0,Nr().A)(!y||!b,400,400),M=(0,s().K8)((()=>{if(S)return(0,P.jsx)("div",{style:u.spinnerWrapper,children:(0,P.jsx)(Xn().A,{})});if(x)return(0,P.jsx)("div",{style:{padding:32},children:(0,P.jsx)(V().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const o=(0,Rt().fl)({environment:t,store:e.blockStore});return b?(0,P.jsxs)(n(610271).Ye,{style:u.container,children:[(0,P.jsx)(at().A,{store:b.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:n}=e;return(0,P.jsx)(jc().H,{style:u.scroller,type:o,...n,children:(0,P.jsx)(Lc().Ay,{store:b.blockStore,disabled:!0,context:lc().Rr.InPageSnapShot,paddingBottom:(0,Lc().Wj)(t),layoutModulesByArea:a})})}},b.timestamp),c&&(null==a?void 0:a.page_details)&&(0,P.jsx)(jc().H,{style:u.layoutDetailsSidebar,type:ot().A.Y,children:(0,P.jsx)(n(421761).H,{store:b.blockStore,context:lc().Rr.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:a.page_details})})]}):void 0}),[S,x,t,e.blockStore,b,u.spinnerWrapper,u.container,u.layoutDetailsSidebar,u.scroller,c,a]);return(0,P.jsx)(tc().K,{from:"PageSnapshotPreview",fallback:e=>{let{error:t,errorId:n}=e;return(0,P.jsx)(nc().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,P.jsx)(n(282131).B,{value:m,children:M})})};async function Nc(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:o}=e,i=Array.from(t.values());await(0,ua().lX)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))}const Oc={SnapshotAdminDebugButton:new(d().O2)("SnapshotAdminDebugButton",(async()=>await n.e(14201).then(n.bind(n,272361))))},Ec=(0,d().jQ)(Oc.SnapshotAdminDebugButton,(e=>e.SnapshotAdminDebugButton));var Uc=()=>n(310594);const Fc={display:"flex",justifyContent:"center",padding:32},Kc=(0,V().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Vc=function(){const e=(0,V().tz)(),t=(0,i().v3)(),{device:o}=t,r=(0,s().O$)(ac().A),a=au();return o.isMobile?(0,P.jsx)(x().Ay,{ariaLabel:$c(e),popupType:j().n.SlideUp,open:r.open,render:()=>(0,P.jsx)(ru,{}),onDismiss:Jd().un}):(0,P.jsx)(n(922172).a,{ariaLabel:$c(e),open:r.open,innerStyle:a.modal,onDismiss:Jd().un,render:()=>(0,P.jsx)(ru,{}),className:Lt().uMd})},zc=(0,P.jsx)(V().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function Wc(){return Gd().MO.filter((e=>"personal"!==e.tier))}function Hc(e){const t=Wc(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function Gc(e){var t;if(G().A.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const o=(i=n,(Date.now()-parseInt(i.timestamp))/Bn().nD);var i;if((0,pc().sP)()&&o<=Gd().et.plus.days)return;const s=function(e){return Wc().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,pc().bw)(s))return;const r=s[0]??"enterprise";return(0,$d().dL)(r)?void 0:{tier:r,message:(0,P.jsx)(V().sA,{defaultMessage:"Please upgrade to the {upsellTier} plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Kd().A)((0,$d().$P)(r)?"plus":r),snapshotLimitDays:(null===(t=Hc(r))||void 0===t?void 0:t.days)??Math.floor(o)}})}}function Yc(){return(0,P.jsx)(Cc().A,{href:(0,Ee().xS)("guides.pageHistory"),analyticsFrom:"page_history"})}function qc(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,sc().mM)({environment:t})}function $c(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function Qc(e){const{device:t}=e;return t.isMobile?24:20}function Zc(e){let{menuState:t}=e;const n=(0,i().v3)(),r=(0,s().K8)((()=>t.blockStore.getIcon()),[t.blockStore]),a=(0,s().K8)((()=>t.blockStore.isEmptyPage()),[t.blockStore]),l=au();return t.snapshot?(0,P.jsxs)(o.Fragment,{children:[(0,P.jsxs)("div",{style:l.header,children:[r?(0,P.jsx)(ul().B,{disabled:!0,icon:r,isEmptyPage:a,size:Qc(n)}):null,r?null:(0,P.jsx)(Mc().Q,{iconGroup:zd,variantName:"default",colorName:"secondary"}),(0,P.jsx)(Ac().D,{styleName:"Body-14px/Regular",colorName:"tertiary",children:(0,P.jsx)(Cr().A,{store:t.blockStore})})]}),(0,P.jsx)(Dc,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function Xc(e,t){dc().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"},trialability:"none"}})}function Jc(e){let{message:t,showUpgradeButtonForTier:n}=e;const o=(0,i().v3)(),{device:r}=o,a=(0,s().K8)((()=>mc().qc(bc().subscriptionDataStoreInstance.state)),[]),l=au();let d=qc(n,o);return d&&(0,sc().mM)({environment:o})&&"personal"===n&&!a&&(d=!1),a||(d=!1),(0,P.jsxs)("div",{style:r.isMobile?l.unavailableMessageComponentMobile:l.unavailableMessageComponent,children:[qc(n,o)?(0,P.jsx)("img",{src:Qs().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}):null,(0,P.jsx)("div",{style:{...!r.isMobile&&{maxWidth:283}},children:t}),d&&n?(0,P.jsx)(wc().A,{size:"lg",onClick:()=>Xc(n,o),style:l.upsell,icon:()=>(0,P.jsx)(Mc().Q,{iconGroup:Hd().k,variantName:"fill",colorName:"uiBluePrimary"}),children:(0,P.jsx)(V().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function eu(e){const t=(0,V().tz)(),{requestUpgradeTier:n}=e,{requestState:o,openModal:i}=(0,vc().E)({feature:n,entrypoint:"version_history",analyticsEntrypoint:"version_history"}),s=(0,hc().j)(o,t),r=(0,fc().k)(o,t),a=au();return(0,P.jsxs)("div",{style:a.unavailableMessageComponent,children:[(0,P.jsx)("img",{src:Qs().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}),(0,P.jsx)("div",{style:{maxWidth:283},children:(0,P.jsx)(V().sA,{defaultMessage:"Your workspace owners must upgrade to the {requestUpgradeTier} plan to restore this page.",id:"historyModal.desktopModal.requestUpgradeMessage",values:{requestUpgradeTier:(0,Kd().A)(n)}})}),(0,P.jsx)(yc().U,{onClick:i,label:s,testId:`${n}-request-button`,disabledTooltip:r,tooltipPlacement:k().W.Bottom,useOutlineButton:!0})]})}function tu(e){const t=(0,i().v3)(),n=(0,V().tz)(),{device:r}=t,{menuState:a,loadingMore:l}=e,d=(0,Nr().A)(l,300,100),c=au();const u=function(e){const t=new Map;return e.forEach((e=>{const n=(0,lr().W_)(parseInt(e.timestamp),"very_short",Fd().locale),o=t.get(n)??0;t.set(n,o+1)})),t}(e.snapshotValues),m=(0,o.useCallback)((e=>{const t=e>Date.now()-6*Bn().nD,n=u.get((0,lr().W_)(e,"very_short",Fd().locale));return!!n&&(n>1||t)}),[u]),p=(0,s().K8)((()=>f().oE(e.snapshotValues.map(((o,i)=>{const s=i>0?e.snapshotValues[i-1]:void 0,l=!Gc({snapshot:o,nextFutureSnapshot:s});return{key:o.id,action:()=>{Jd().Xn({environment:t,snapshot:o,nextFutureSnapshot:s})},render:e=>{const t=o.authors||[],i=n.formatList(f().oE(t.map((e=>(0,ic().JQ)({parentStore:a.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),s=(0,P.jsx)("div",{style:{...Re().RC},children:i}),d=Boolean(a.snapshot&&a.snapshot.id===o.id),u=parseInt(o.timestamp),p=m(u),g=new Date(u).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",h=p?(0,lr().jE)(u,Fd().locale,n,"·",g):(0,lr().W_)(u,g,Fd().locale);return l?(0,P.jsx)(Kt().A,{...e,title:h,focused:!r.isMobile&&d,caption:s,buttonStyle:c.buttonMenuItem,itemMarginLeft:8,right:G().A.isAdminMode?(0,P.jsx)(Ec,{snapshot:o}):null}):(0,P.jsx)(Kt().A,{...e,title:(0,P.jsx)("div",{style:c.menuItem,children:(0,P.jsx)("div",{style:{...r.isMobile&&{display:"flex",flex:1},...Re().RC},children:h})}),focused:!r.isMobile&&d,caption:s,right:(0,P.jsx)(Mc().Q,{iconGroup:Vd().x,variantName:"small",colorName:"tertiary"}),buttonStyle:c.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginRight:"7px"}})}}})))),[e.snapshotValues,r.isMobile,t,n,a.blockStore,a.snapshot,c,m]),g=a.snapshot&&a.snapshot.id,h=p.findIndex((e=>g===e.key)),v=[{key:"snapshots",render:e=>(0,P.jsx)(zt().A,{...e}),items:p}];return(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,initialFocus:h,sections:v}),(0,P.jsx)(xc().A,{loading:l,fetchSize:a.size,resultSize:e.snapshotValues.length,onLoadMore:Jd().p2}),d&&(0,P.jsx)("div",{style:Fc,children:(0,P.jsx)(Xn().A,{})})]})}function nu(e){let{menuState:t,onRestoreSnapshot:n}=e;const o=(0,i().v3)();return(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=Gc({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),i=!e,s=i?(0,P.jsx)(Dc,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,P.jsx)(Jc,{message:e.message,showUpgradeButtonForTier:e.tier}),r=!i&&o.device.isMobileBrowser;return(0,P.jsx)(b().A,{menuType:S().gu.Modal,title:(0,lr().jE)(parseInt(t.snapshot.timestamp),Fd().locale,Nt().A.getIntl()),right:(0,P.jsx)(rt().DoneMenuText,{}),onClickRight:Jd().j8,leftDisabled:!i&&!o.device.isMobileBrowser,left:r?(0,P.jsx)(V().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,P.jsx)(V().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{r?Xc(e.tier,o):await n()})(),whiteBackground:i,forceFullScreenSlideUp:!0,children:s})}})}function ou(e){const t=(0,i().v3)(),{menuState:n}=e,o=(0,rc().i0)(n.blockStore),r=(0,rc().ty)(n.blockStore),a=(0,s().K8)((()=>Boolean(n.snapshot&&!o&&!r&&!Gc({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,oc().Xmj)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,t))),[t,n,o,r]),l=au();return(0,P.jsxs)("div",{style:l.sidebarStyle,children:[(0,P.jsxs)("div",{style:l.sidebarHeader,children:[(0,P.jsx)(Ac().D,{styleName:"Heading-17px/Semibold",colorName:"primary",customStyles:{fontSize:16},children:(0,P.jsx)(V().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,P.jsx)(ec().R,{onClick:Jd().un,style:l.dismiss})]}),(0,P.jsx)(jc().H,{type:ot().A.Y,style:{flex:1},children:(0,P.jsx)(tu,{...e})}),(0,P.jsxs)("div",{style:l.actions,children:[(0,P.jsx)(Fo().p,{size:"lg",style:l.learnMoreButton,onClick:()=>{Qd().FH(t,{from:"page_history"}),Xd().oo({environment:t,url:(0,Ee().xS)("guides.pageHistory"),openInNew:"tab"})},icon:()=>(0,P.jsx)(Mc().Q,{iconGroup:Wd().G,variantName:"small",colorName:"secondary"}),children:(0,P.jsx)(Ac().D,{colorName:"secondary",children:(0,P.jsx)(V().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})})}),(0,P.jsx)(Ke().A,{disableTooltip:a,renderTooltip:()=>r?(0,P.jsx)(V().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):o?(0,P.jsx)(V().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,P.jsx)(V().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,P.jsx)(kc().A,{size:"lg",onClick:e.onRestoreSnapshot,disabled:!a,...t,style:l.restoreButton,children:(0,P.jsx)(V().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function iu(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,P.jsx)(Jc,{message:zc,showUpgradeButtonForTier:!1})),n=e.error?(0,P.jsx)("div",{style:Fc,children:(0,P.jsx)(V().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,P.jsx)("div",{style:Fc,children:(0,P.jsx)(Xn().A,{})}):(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(jc().H,{type:ot().A.Y,children:(0,P.jsx)(tu,{...e})}),(0,P.jsx)(nu,{...e})]}),(0,P.jsx)(b().A,{menuType:S().gu.Modal,title:(0,P.jsx)(V().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,P.jsx)(Yc,{}),right:(0,P.jsx)(rt().DoneMenuText,{}),onClickRight:Jd().un,header:t,children:(0,P.jsx)(tc().K,{from:"MobileHistory",fallback:e=>{let{error:t,errorId:n}=e;return(0,P.jsx)(nc().LargeSurfaceRenderError,{error:t,errorId:n})},children:n})})}function su(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>e.menuState.snapshot?Gc({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),o=au(),r=(0,s().K8)((()=>(0,Lc().Wj)(t)),[t]),a=(0,cc().f_)({spaceId:e.menuState.blockStore.pointer.spaceId}),l=(0,gc().y)(a),d=(0,s().K8)((()=>(0,uc().NV)()),[]);let c;return c=e.error?(0,P.jsx)("div",{style:Fc,children:(0,P.jsx)(V().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,P.jsx)("div",{style:Fc,children:(0,P.jsx)(Xn().A,{})}):n?d&&(0,qd().rU)(n.tier)&&l?(0,P.jsxs)("div",{style:o.blurContainer,children:[(0,P.jsx)("div",{style:o.unavailableMessageText,children:(0,P.jsx)(eu,{requestUpgradeTier:n.tier})}),(0,P.jsx)("div",{style:o.snapshotBlur,children:(0,P.jsx)(Lc().Ay,{store:e.menuState.blockStore,disabled:!0,context:lc().Rr.InPageSnapShot,paddingBottom:r})})]}):(0,P.jsxs)("div",{style:o.blurContainer,children:[(0,P.jsx)("div",{style:o.unavailableMessageText,children:(0,P.jsx)(Jc,{message:n.message,showUpgradeButtonForTier:n.tier})}),(0,P.jsx)("div",{style:o.snapshotBlur,children:(0,P.jsx)(Lc().Ay,{store:e.menuState.blockStore,disabled:!0,context:lc().Rr.InPageSnapShot,paddingBottom:r})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,P.jsx)(Zc,{menuState:e.menuState}):(0,P.jsx)(Jc,{message:zc,showUpgradeButtonForTier:!1}),(0,P.jsxs)(tc().K,{from:"DesktopHistory",fallback:e=>{let{errorId:t}=e;return(0,P.jsx)(nc().LargeSurfaceRenderError,{errorId:t})},children:[(0,P.jsx)("div",{style:o.preview,children:c}),(0,P.jsx)(ou,{...e})]})}function ru(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(ac().A),[o]=(0,he().Yb)((async()=>{if(n.open)return await async function(e,t,n){const{device:o}=n,i=await W().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:s}=i.data;if(t.pageHasCollection=s.some((e=>{var t;const n="collection"===e.parent_table,o=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||o&&0!==o})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),o=s.findIndex((t=>parseInt(t.timestamp)<e));0===s.length||(0===o?Jd().Xn({environment:n,snapshot:s[o],nextFutureSnapshot:void 0}):o>0?Jd().Xn({environment:n,snapshot:s[o-1],nextFutureSnapshot:o>1?s[o-2]:void 0}):s.length<t.size?Jd().Xn({environment:n,snapshot:s[s.length-1],nextFutureSnapshot:s.length>1?s[s.length-2]:void 0}):Jd().p2())}else Boolean(t.snapshot)||o.isMobile||ac().A.setState({...t,snapshot:s[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,Yd().e)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),r="pending"!==o.status&&"idle"!==o.status,a=o.error,l=o.value,d=(0,Nr().A)(Boolean(n.open&&(!l||l.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const c=t.isMobile?iu:su;return(0,P.jsx)(c,{snapshotValues:l?l.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",o=n.pageHasCollection?[{key:t,text:(0,P.jsx)(V().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(V().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,P.jsx)(Sc().A,{external:!0,href:(0,Ee().xS)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,P.jsx)(V().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:i,selectionResult:s}=await Zd().Gh({message:(0,P.jsx)("div",{style:{fontWeight:Re().Wy.semibold,fontSize:"medium"},children:(0,P.jsx)(V().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,P.jsx)(V().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o,mode:o?"wide":void 0,textAlign:"left"});if(i){try{await Jd().n5(e,null==s?void 0:s[t])}catch{Zd().f1(Nt().A.formatMessage(Kc.restoreSnapshotError))}Jd().un()}},error:a,initialLoading:d,loadingMore:!r})}function au(){return(0,_e().IS)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:Uc().pN,padding:"10px 8px 0px 8px",borderLeft:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",padding:"4px 4px 4px 8px"},actions:{display:"flex",padding:"12px 12px 12px 6px",borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginLeft:"-8px",marginRight:"-8px"},learnMoreButton:{padding:"0px 8px",borderRadius:"6px",gap:4},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${Uc().pN}px)`,boxShadow:`1px 0 0 ${e.regularDividerColor}`},restoreButton:{backgroundColor:e.text.uiBluePrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginLeft:"0px",marginRight:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingLeft:14,gap:6},modal:{height:`${Uc().fi}vh`,width:`${Uc().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingLeft:"8px",paddingRight:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var lu=()=>n(399384);async function du(e){const{environment:t,emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:s}=e,r=function(e){const{emitValue:t,spaceStore:n,currentUserId:o,lastEmitData:i}=e;if(void 0===t)return!0;const s=n.id!==i.spaceId,r=o!==i.userId,a=t!==i.value;return s||r||a}({emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:s});if(!r)return;const a=await(0,ve().getTeamsWithAggregateData)({fromCache:!1,environment:t,spaceStore:o,currentUserId:i,includeArchived:!1});if(!a)return;const{teams:l,teamAggregateData:d}=a;lu().A.setState({teams:l,teamAggregateData:d,lastEmitData:{spaceId:o.id,userId:i,value:n}})}const cu=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,s().O$)(X().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=$().Ay.addListener((0,F().Dh)(t.id),void 0,(async n=>{let{value:o}=n;await du({environment:e,emitValue:o,spaceStore:t,currentUserId:r,lastEmitData:lu().A.state.lastEmitData})}),void 0,e);return function(){n&&$().Ay.removeListener(n,e)}}),[t,r,e]),null};var uu=()=>n(423392),mu=()=>n(92091);const pu=function(){const e=(0,_e().DP)(),t=(0,i().v3)(),o=(0,s().O$)(mu().A),r=(0,s().O$)(n(755648).A);if(!o.open)return null;const a=o.integration.info.icon;return a?(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+r,right:16+r,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,P.jsx)(n(516267).A,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,P.jsx)("div",{style:{color:e.text.primary,fontSize:14,fontWeight:Re().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,P.jsx)(V().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:o.integration.name}})}),(0,P.jsxs)("div",{style:{color:e.text.secondary,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,P.jsx)(V().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,P.jsx)(n(611824).A,{href:(0,Ee().xS)("guides.unfurling"),external:!0,children:(0,P.jsx)(V().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,P.jsx)(kc().A,{onClick:()=>async function(e){const t=mu().A.state,{currentSpaceStore:n}=X().default.state;if(!t.open||!n)return;await uu().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),gu(t.integration.id,e),mu().A.reset()}(t),style:{width:"100%"},children:(0,P.jsx)(V().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,P.jsx)(Fe().A,{icon:n(169201).u,onClick:()=>function(e){const t=mu().A.state;t.open&&gu(t.integration.id,e);mu().A.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function gu(e,t){const{currentUserSettingsStore:n}=X().default.state;n&&y().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{Ua().Cw({transaction:t,userSettingsStore:n,integrationId:e})}})}n(358848),n(91270);var fu=()=>n(706788),hu=()=>n(193302),vu=()=>n(868746),yu=()=>n(793613);const bu=function(){const e=(0,s().uB)(vu().A),t=(0,i().v3)(),n=(0,o.useRef)(null),r=(0,i().Y0)(),[a,l]=(0,s().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,o.useEffect)((()=>{const e=e=>{a&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&ku(t)},o=e=>{if(!a||!e.target||!n.current)return;const o=n.current;o&&o!==e.target&&ku(t)};return(0,Ci().P4)(window,"keydown",e),(0,Ci().P4)(window,"mousedown",o),()=>{(0,Ci().Ol)(window,"keydown",e),(0,Ci().Ol)(window,"mousedown",o)}}),[a,n,t]),(0,P.jsx)(x().Ay,{popupType:r.isMobileNative&&!r.isTablet?j().n.SlideUp:j().n.Popup,open:Boolean(a&&l),originRect:a?l:void 0,placementToOrigin:k().W.Top,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:r.isMobile,keepFocus:r.isMobile,render:()=>(0,P.jsx)(xu,{}),onDismiss:ku})};function xu(){const e=(0,s().uB)(vu().A),t=(0,i().v3)(),n=(0,i().Y0)(),r=(0,o.useRef)(null),a=(0,V().tz)(),[l,d,c,u]=(0,s().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),m=(0,_e().IS)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Re().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Re().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]);if(!l)return null;const p={fontSize:Re().J.UIRegular.desktop,fontWeight:Re().Wy.regular,font:"SF Pro"},g={key:"embed section",render:e=>(0,P.jsx)(zt().A,{...e,style:{paddingTop:6,paddingBottom:0}}),items:d.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,P.jsx)(Kt().A,{...n,title:(0,P.jsx)(Su,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),Mu(e,a,t)},style:p}),action:()=>Au(e,t)})))},f={key:"import section",render:e=>(0,P.jsx)(zt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:d.filter((e=>"import"===e)).map(((e,n)=>({key:e,render:n=>function(e){let{props:t,optionType:n,integration:o,environment:i,intl:s,menuTextStyle:r}=e;return(0,P.jsx)(ju,{props:t,optionType:n,integration:o,environment:i,intl:s,menuTextStyle:r})}({props:n,optionType:e,integration:c,environment:t,intl:a,menuTextStyle:p}),action:()=>Au(e,t)})))},h=[g,f];return(0,P.jsx)(hu().LazyAssistantUnfurlingMenuWithAiSection,{url:u,integration:c,headerStyle:m.header,menuTextStyle:p,updateUnfurlingOptionType:Mu,handleDismiss:Au,renderMenu:e=>{let o,{maybeAiActionSection:i}=e;return o=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:d.includes("import")?260:Boolean(i)?220:200,maxHeight:"40vh",onClickOutside:()=>ku(t)},(0,P.jsx)(b().A,{...o,className:Lt().Uvd,ref:r,header:(0,P.jsx)(Qt().A,{style:m.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,P.jsx)(V().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Vt().Ay,{type:Vt().Oh.Vertical,sections:i?[...h,i]:h,initialFocus:0,onKeyboardArrow:e=>function(e,t,n,o){const i=vu().A.state;if(!i.open||void 0===e.indexGlobal)return;const s=i.allOptionTypes.at(e.indexGlobal);if(!s)return void(o&&Mu("preview",t,n));Mu(s,t,n)}(e,a,t,Boolean(i)),priority:1,disallowBackspace:!0})})}})}function Su(e){let{optionType:t,integration:n}=e;return"preview"===t?(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===t?(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===t?(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===t?(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===t?(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===t?(null==n?void 0:n.id)===fu().me?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,P.jsx)(Jn().A,{style:{display:"inline"}})]}):(null==n?void 0:n.id)===fu().mn?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports"}),(0,P.jsx)(yu().E,{style:{display:"inline"},newBadgeKey:"salesforce_sync_unfurling_option",didUserEngage:!1,keyType:"date"})]}):(0,P.jsx)(V().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}):void(0,Je().HB)(t)}function Mu(e,t,n){y().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:o=>{fo().Oi({environment:n,type:wu(e),useTemporaryRecordCache:!0,transaction:o,intl:t})}})}function Au(e,t){const n=vu().A.state;Oa().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open?(y().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:e=>{fo().VN({environment:t,setType:"link",transaction:e})}}),fo().z1({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore})):y().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{fo().VN({environment:t,setType:e?wu(e):void 0,transaction:n})}})}function wu(e){return"import"===e?"link":e}function ku(e){Au(void 0,e)}function ju(e){let{props:t,optionType:n,integration:o,environment:i,intl:s,menuTextStyle:r}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Zn().A,{size:4}),(0,P.jsx)(Kt().A,{...t,title:(0,P.jsx)(Su,{optionType:n,integration:o}),onMouseEnter:e=>{t.onMouseEnter(e),Mu(n,s,i)},style:r})]})}var Cu=()=>n(725155),Iu=()=>n(737682),Tu=()=>n(289232),_u=()=>n(887615),Pu=()=>n(858562);const Bu=10;function Ru(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n,currentUserRootStore:r}=(0,s().O$)(X().default),a=null==n?void 0:n.id,l=(0,_u().n)(t),d=(0,s().K8)((()=>f().oE(l?(0,Tu().f)({currentUserRootStore:r}).map((e=>e.getSpaceId())):[null==t?void 0:t.id])),[l,t,r]);return(0,o.useEffect)((()=>{if(!a)return;const t=async(t,n)=>{const o=Pu().A.getSharedPagesState({userId:a,spaceId:t});o&&o.emitValue===n||await Iu().Z({environment:e,userId:a,spaceId:t,emitValue:n})},n=d.length>Bu?new(Cu().O)(Bu):void 0,o=d.map((o=>{const i=f().nF((async e=>{let{value:i}=e;return n?n.enqueue((async()=>t(o,i))):t(o,i)}),5e3);return{listener:$().Ay.addListener((0,F().Rs)({userId:a,spaceId:o}),void 0,i,void 0,e),throttledHandler:i}}));return function(){null==n||n.cancel(),o&&o.forEach((t=>{let{listener:n,throttledHandler:o}=t;n&&$().Ay.removeListener(n,e),o&&o.cancel()}))}}),[d,a,e]),null}n(610931);var Lu=()=>n(973055),Du=()=>n(768022),Nu=()=>n(572589),Ou=()=>n(218357),Eu=()=>n(283759),Uu=()=>n(486963),Fu=()=>n(367859),Ku=()=>n(384213),Vu=()=>n(105157);const zu=200,Wu=30,Hu=125,Gu=25;var Yu=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Yu||{});function qu(e){return e.type===Yu.Selectable?{type:tn().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:tn().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function $u(e){const{target:t,device:n,direction:o,points:i}=e;return o===tn().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function Qu(e){return(0,Fu().M)(e)?{type:Yu.Selectable,target:e}:{type:Yu.DropTarget,target:e}}function Zu(e){if(!e||!(0,Fu().M)(e))return!1;let t=e;const n=tn().Ay.state;if(!n.isDragging)return!1;const{draggedStores:o}=n;for(;t;){if(o.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Xu(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Ju(e){switch(e.direction){case tn().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:r,canAcceptDrop:a}=e,l=tn().bH.Onto,d=$u({device:t,target:i,direction:l,points:s});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&tm(d,o)&&!Zu(i)&&a(i,l))return{...Qu(i),direction:l,left:o.left,top:o.top,width:o.width,height:o.height,priority:r}}(e);case tn().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:r,optionKeyDown:a,canAcceptDrop:l}=e,d=tn().bH.Left,c=$u({device:t,target:i,direction:d,points:s});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.left)<=zu&&(a||!Zu(i))&&l(i,d))return{...Qu(i),direction:d,left:o.left,top:o.top,width:0,height:o.height,priority:r}}(e);case tn().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:r,optionKeyDown:a,canAcceptDrop:l}=e,d=tn().bH.Right,c=$u({device:t,target:i,direction:d,points:s});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.right)<=zu&&(a||!Zu(i))&&l(i,d))return{...Qu(i),direction:d,left:o.right,top:o.top,width:0,height:o.height,priority:r}}(e);case tn().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:r,optionKeyDown:a,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Wu,c=Xu({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=tn().bH.Above,m=$u({device:t,target:i,direction:u,points:s});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&o&&m.x>=o.left-d-c&&m.x<=o.right+c&&(a||!Zu(i))&&Math.abs(m.y-o.top)<=Hu&&(o.height<=2*Gu||m.y<=o.top+Gu)&&l(i,u))return{...Qu(i),direction:u,left:o.left,top:o.top,width:o.width,height:0,priority:r}}(e);case tn().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:r,optionKeyDown:a,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Wu,c=Xu({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Hu,m=i.props.isLastItem?Number.MAX_SAFE_INTEGER:Hu,p=tn().bH.Below,g=$u({device:t,target:i,direction:p,points:s});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&o&&g.x>=o.left-d-c&&g.x<=o.right+c&&o.bottom-g.y<=u&&g.y-o.bottom<=m&&(o.height<=2*Gu||g.y>=o.bottom-Gu)&&(a||i.props.isLastItem||!Zu(i))&&l(i,tn().bH.Below))return{...Qu(i),direction:tn().bH.Below,left:o.left,top:o.bottom,width:o.width,height:0,priority:r}}(e)}}function em(e){const{device:t,rect:n,target:o,points:i,optionKeyDown:s}=e;return tm($u({device:t,target:o,direction:tn().bH.Onto,points:i}),n)&&Zu(o)&&!s}function tm(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var nm=()=>n(342729),om=()=>n(431789),im=()=>n(4822),sm=()=>n(196113),rm=()=>n(383430),am=()=>n(237113),lm=()=>n(483763),dm=()=>n(37394),cm=()=>n(486905),um=()=>n(708299),mm=()=>n(332284);const pm=2,gm=20,fm=7;function hm(){const e=(0,o.useRef)(!1),t=(0,o.useRef)(!1),n=(0,o.useRef)(void 0),s=(0,i().Y0)(),r=(0,i().v3)(),a=(0,vl().S)(),l=(0,Lu().d)((e=>as().A.withListenerIgnored((()=>(e=>{const o=mm().default.state;if(!(e&&e.target instanceof Element)||o.isOpen&&o.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:i}=tn().Ay.state;if(i)g();else{if(!n.current)return;bm(r,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,o.useCallback)((()=>{e.current||l(void 0)}),[l]),c=f().nF((()=>{const{isDragging:e}=tn().Ay.state;xo().default.afterNextFlush((()=>{n.current&&!e&&bm(r,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,o.useMemo)((()=>new WeakMap),[]),m=(0,o.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,oc().x7S)({environment:r,blocks:e,publicEditMode:a&&a.publicEditModeStore.state});return u.set(e,n),n??!1}),[r,a,u]),p=(0,o.useCallback)((()=>{const e=tn().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:o,offsetX:i,offsetY:s,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:o,environment:i,pageContext:s,canDragFn:r}=e,{device:a}=i,l=nm().r(),d=function(){const{selectableRectMap:e}=Vu().default.state,{dropTargetRectMap:t}=Ku().A.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const m=dm().T.findSelectableFromStore(n),p=m?m.getContextSelectableContainer():void 0;let g=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),m=e.getContextSelectableContainer();if(a.isPhone&&m!==p)continue;if(!m||m.getProps().disable)continue;const h=ym(m),v={device:a,isNativeDrag:o,rect:n,target:e,points:t,priority:h,optionKeyDown:l.option,canAcceptDrop:(e,t)=>km({target:e,direction:t,optionKeyDown:l.option,environment:i,pageContext:s,canDragFn:r})};if(em(v))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};g.push(...f().oE([Ju({...v,direction:tn().bH.Onto}),Ju({...v,direction:tn().bH.Left}),Ju({...v,direction:tn().bH.Right}),Ju({...v,direction:tn().bH.Above}),Ju({...v,direction:tn().bH.Below})]))}g=function(e){const t=Sm(f().Sk(e,Sm));return e.filter((e=>Sm(e)===t))}(g);const h=g.filter((e=>e.direction===tn().bH.Above||e.direction===tn().bH.Below)),v=f().wq(h,(e=>Math.abs(e.top-xm(e,t,i).y)));if(v&&v.target===m)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let y=h.filter((e=>{let{top:t}=e;return Math.abs(t-(v?v.top:0))<=pm}));if(y.length>1){y=y.filter((e=>{const n=xm(e,t,i).x,o=Xu({device:a});return n>=e.left-o&&n<=e.left+e.width+o})),y=f().Ul(y,(e=>{let{left:t}=e;return t}));let e=0;for(;e<y.length-1;e++){const n=y[e+1],o=xm(n,t,i).x;if(n.left>o)break}y=y.slice(0,e+1),y.reverse()}const b=y.map(qu);let x;const S=g.filter((e=>e.direction===tn().bH.Onto)),M=f().wq(S,(e=>e.height));if(M){h.some((e=>{const n=xm(e,t,i).y;return Math.abs(e.top-n)<fm}))||(x=qu(M))}let A;const w=g.filter((e=>e.direction===tn().bH.Left||e.direction===tn().bH.Right)).sort(((e,t)=>e.height-t.height));let k=f().wq(w,(e=>{const n=xm(e,t,i).x;return Math.abs(e.left-n)}));if(k){const e=k,t=w.filter((t=>Math.abs(t.left-e.left)<gm));t.length>0&&(k=f().wq(t,(e=>e.left)))}if(k){const e=k;h.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(A=qu(k))}return{ontoDropZone:x,verticalDropZone:A,horizontalDropZones:b}}({points:{mousePoint:{x:n,y:o},originPoint:{x:n-i,y:o-s}},draggingStore:t[0],isNativeDrag:l,environment:r,pageContext:a,canDragFn:m});if(d.ontoDropZone)tn().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)tn().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=f().RT(d.horizontalDropZones);if(t.type===tn().OX.Selectable){const o=dm().T.findSelectableFromStore(t.store);if(o){const i=o.getContextClosestSelectable();let s;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(s=i.props.store),void tn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:s})}}else{if(rm().A.findDropTargetFromKey(t.key))return void tn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}tn().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[r,m,a]),g=(0,o.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{p()}finally{e.current=!1}}),[p]),h=(0,o.useCallback)((()=>{const{isDragging:e}=tn().Ay.state;e&&g()}),[g]),v=(0,o.useCallback)((()=>{t.current=!0}),[]);(0,o.useEffect)((()=>(window.addEventListener("mousemove",l),Ft().default.addListener(c),s.isIOS&&window.addEventListener("touchend",v),window.addEventListener("keydown",h),window.addEventListener("keyup",h),tn().Ay.addListener(d),window.addEventListener("scroll",Mm,!0),window.addEventListener("resize",Am),Rt().RR.addListener(wm),Do().sf(),()=>{window.removeEventListener("mousemove",l),Ft().default.removeListener(c),s.isIOS&&window.removeEventListener("touchend",v),window.removeEventListener("keydown",h),window.removeEventListener("keyup",h),tn().Ay.removeListener(d),window.removeEventListener("scroll",Mm,!0),window.removeEventListener("resize",Am),Rt().RR.removeListener(wm)})),[s.isIOS,d,c,h,l,v])}function vm(){const e=mm().default.state;e.isOpen&&!e.menuIsOpen&&mm().default.reset()}function ym(e){return(Ft().default.state.droppableContainerStack||[]).indexOf(e)}function bm(e,t,n,o){var i,s;const r=mm().default.state;if(r.isOpen&&r.menuIsOpen)return;const a=function(e){const{environment:t,target:n,x:o,y:i,rightMarginCommentActionsEnabled:s}=e;if(um().A.state.isResizing||tn().Ay.state.isDragging||ke().default.state.isActive||Rt().RR.state)return;const{selectableRectMap:r}=Vu().default.state,a=lm().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!a)return;const l=r.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=r.get(e),m=cm().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),p=cm().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:m}),g=cm().mC(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===a&&n&&zl().ux((0,mm().getExpandedSelectableRect)(n,s,m,p,g),o,i)){for(const t of mm().HOVER_REGIONS)zl().ux((0,mm().getHoverRegionOfRect)(n,t,m,p,g),o,i)&&u.push({selectable:e,hoveredRegion:t});zl().ux((0,mm().getExactSelectableRect)(n,s),o,i)&&c.push(e)}d=l.next()}const m=f().Ul(c,(e=>{const t=r.get(e);return t?-t.left:1/0})),p=m.find((e=>{const t=e.getNode();return!t||!m.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return p?{exactSelectable:p,nearbySelectables:u,container:a}:{nearbySelectables:u,container:a}}({environment:e,target:t,x:n,y:o,rightMarginCommentActionsEnabled:!0});if(!a)return void mm().default.reset();const l=!r.isOpen||(null===(i=a.exactSelectable)||void 0===i?void 0:i.props.store)!==r.currentStore,d=r.isOpen&&(null===(s=a.exactSelectable)||void 0===s?void 0:s.props.store)===r.currentStore;var c,u;l?mm().default.setState({...r,isOpen:!0,menuIsOpen:!1,container:a.container,nearbySelectables:a.nearbySelectables,currentStore:null===(c=a.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=a.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:o}):d&&mm().default.setState({...r,nearbySelectables:a.nearbySelectables,mouseX:n,mouseY:o})}function xm(e,t,n){return $u({device:n.device,target:e.target,points:t})}function Sm(e){return(null==e?void 0:e.priority)??0}function Mm(){Do().AP(),vm()}function Am(){Do().AP(),vm()}function wm(){const e=mm().default.state,t=Rt().RR.state;e.isOpen&&!e.menuIsOpen&&t&&mm().default.reset()}function km(e){const{target:t,direction:n,optionKeyDown:o,environment:i,pageContext:s,canDragFn:r}=e;if(Ae().A.state.isOpen&&!jr().default.state.open)return!1;if(we().A.state.isOpen)return!1;const a=tn().Ay.state,l=a.isDragging?a.draggedStores:[],d=!!a.isDragging&&a.isNativeDrag;let c,u,m,p=!1,g=!1;l.find((e=>{const t=am().A.findOutlinerItemFromStore(e);return!!t&&(c=t,u=t.type,p=t.isTopLevelItem,!0)}));const f=(0,Fu().M)(t)?am().A.findOutlinerItemFromStore(t.props.store):void 0,h=null==f?void 0:f.parentStore;var v;f&&(m=f.type,g=f.isTopLevelItem||"team"===(null===(v=f.parentStore)||void 0===v?void 0:v.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:o,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===Ou().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||o&&o.pointer.id===e.pointer.id&&i!==tn().bH.Onto))return!0}return!1}({draggingOutlinerItem:c,selectableOutlinerItemParent:h,direction:n}))return!1;if(!(0,Fu().M)(t))return t.props.canAcceptDrop({direction:n,draggingStores:l,isNativeDrag:d});const y=t.props.store;if(y.pathIsDead())return!1;if((0,Wl().dL)(y))return!1;if("suggest"===Hl().Uv.getMode(y))return!1;const b=(0,Uu().U)(y);if(b&&b.isInTrashStore.state)return!1;const x=y.getAssociatedCollectionStore();if(n===tn().bH.Onto&&x){const e=x.id,t=(0,Uu().U)(y),n=null==t?void 0:t.collectionViewBlockStore(),o=null==t?void 0:t.collectionViewStore();if(n&&o&&"page"!==o.getType()){if(l.find((o=>{const i=o.getAssociatedCollectionStore(),s=(0,Uu().U)(o);return Boolean(o instanceof te().Bv&&i&&i.id===e)||Boolean(s===t&&y.id!==n.id)})))return!1}}if(n!==tn().bH.Onto){const e=(0,Uu().U)(y);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!l.find((t=>{const n=(0,Uu().U)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var S;const e=null===(S=y.getCollectionStore())||void 0===S?void 0:S.getSchema();if(Boolean(t.props.groupsPointer.find((t=>!(0,Du().wj)(t,(null==x?void 0:x.getSchema())??e))))){if(l.find((e=>{var n;const o=dm().T.findSelectableFromStore(e);return(null==o||null===(n=o.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,Nu().PZ)(o.props.groupsPointer,t.props.groupsPointer)})))return!1}}if((0,om().qy)({targets:l,destination:y,direction:n,draggingOutlinerType:u}))return!1;if(o&&l.find((e=>e.isTypedCollectionViewBlock()||(0,Eu().sZ)(e))))return!1;if(f&&n!==tn().bH.Onto&&!g&&!(0,oc().ecY)({environment:i,blocks:[f.store],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(m&&d)return!1;if("bookmarks"===u&&p&&("bookmarks"!==m||!g||n===tn().bH.Onto))return!1;if("bookmarks"===m&&g&&n!==tn().bH.Onto&&("bookmarks"!==u||!p))return!1;if(c&&c.isTopLevelItem&&"team"===c.type&&c.parentStore&&c.parentStore.table===Ou().yK){const e=c.parentStore,t=te().h4.createChildStore(e,{...e.pointer,table:Ou().yK});if(t&&!(0,im().dp)({teamStore:t,environment:i}))return!1}if(f&&f.isTopLevelItem&&"team"===f.type&&f.parentStore&&f.parentStore.table===Ou().yK){const e=f.parentStore,t=te().h4.createChildStore(e,{...e.pointer,table:Ou().yK});if(t&&!(0,im().dp)({teamStore:t,environment:i}))return!1}const{currentSpaceViewStore:M}=X().default.state,A=m?im().Kv[m]:void 0;if(M&&f&&c&&A&&f.isTopLevelItem&&n!==tn().bH.Onto&&c.type!==m){const{sortOption:e}=(0,im().RQ)({spaceViewStore:M,type:A});if("lastEdited"===e)return!1}if("shared"===m&&g&&n!==tn().bH.Onto&&("shared"!==u||!p))return!1;if(m&&g&&n!==tn().bH.Onto){if(l.find((e=>{const t=e.getType();return Boolean(!t||!Xe().BJ[t])})))return!1}const{device:w}=i;if(m&&w.isMobile&&n===tn().bH.Onto&&g)return!1;if(l.some((e=>Boolean(sm().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(sm().A.findCollectionTemplatePickerItemFromStore(y)))return!1;if(n===tn().bH.Onto&&y&&!(0,oc().p2L)({environment:i,blocks:[y],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(!r(l))return!1;if(l.some((e=>e.isTransclusionType()))){if(y.findRecordStoreUIAncestor((e=>{if(e===y)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,Xe().Mp)(t))})).ancestor)return!1}return!0}function jm(){const e=(0,i().Y0)(),t=(0,i().v3)(),{isMobile:n,isElectron:d}=e;(0,o.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]);const c=(0,s().O$)(X().AppStoreCurrentSpaceStore);(0,o.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,o.useEffect)((()=>{function e(e){ke().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:ke().default.state.currentX,currentY:ke().default.state.currentY,toggle:e.shiftKey}))}function n(e){ke().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function o(e){ke().default.state.isActive&&((0,N().Mb)(e)||e.preventDefault(),r().OG(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}}),[t]);const g=t.currentUser.isLoggedIn();return oe(c,g),hm(),(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(vt,{}),(0,P.jsx)(l().Gc,{}),(0,P.jsx)(l().MC,{}),(0,P.jsx)(ue,{}),(0,P.jsx)(Te().A,{priority:-1,capture:!0,debugName:"AppComponents"}),g&&!n&&(0,P.jsx)(Nd,{}),g&&(0,P.jsx)(Se().AuthSyncListener,{}),g&&(0,P.jsx)(cu,{}),g&&(0,P.jsx)(dn,{}),g&&(0,P.jsx)(un,{}),g&&(0,P.jsx)(Ie,{}),g&&(0,P.jsx)(yo,{}),g&&(0,P.jsx)(be,{}),g&&(0,P.jsx)(ge,{}),g&&(0,P.jsx)(Ru,{}),(0,P.jsx)(sn,{}),(0,P.jsx)(Ga,{}),(0,P.jsx)(m().Li,{}),(0,P.jsx)(pl,{}),(0,P.jsx)(il,{}),(0,P.jsx)(ni,{}),(0,P.jsx)(Zt,{}),!n&&(0,P.jsx)(ud,{}),(0,P.jsx)(Mi,{}),(0,P.jsx)(Xa,{}),(0,P.jsx)(Bi().A,{}),(0,P.jsx)(Jt().Ay,{store:Ae().A}),(0,P.jsx)(Jt().Ay,{store:we().A}),(0,P.jsx)(a().DV,{}),(0,P.jsx)(La,{}),(0,P.jsx)(Me().Tm,{}),(0,P.jsx)(B,{}),(0,P.jsx)(io,{}),(0,P.jsx)(xe().Sd,{}),(0,P.jsx)(bu,{}),(0,P.jsx)(Pi,{}),(0,P.jsx)(pu,{}),(0,P.jsx)(Ht,{}),(0,P.jsx)(Ud().A,{}),(0,P.jsx)(ae,{}),d&&(0,P.jsx)(u,{}),(0,P.jsx)(An,{}),(0,P.jsx)(en().Y,{}),g&&(0,P.jsx)(Vc,{}),(0,P.jsx)(vi().nJ,{}),(0,P.jsx)(He,{}),(0,P.jsx)(an().yQ,{}),g&&(0,P.jsx)(vn,{}),(0,P.jsx)(p().h,{})]})}},594184:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(242343),i=()=>n(653998),s=()=>n(733311),r=n(163643);function a(e){const t=(0,o.useMemo)((()=>(0,s().s)(e.store)),[e.store]);return(0,r.jsx)(i().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},605003:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(129044))().default{getInitialState(){return{isOpen:!1}}}},618946:(e,t,n)=>{n.d(t,{p:()=>r});var o=()=>n(237385),i=()=>n(803290),s=()=>n(782422);function r(){const e=(0,o().v3)();return(0,i().O$)((0,s().rp)(e))}},644587:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(242343),i=()=>n(237385),s=()=>n(174114),r=()=>n(818551),a=()=>n(653998),l=()=>n(31448),d=()=>n(914877),c=()=>n(756770),u=()=>n(290938),m=()=>n(430148),p=()=>n(209684),g=()=>n(951540),f=n(163643);function h(){const e=(0,i().v3)().currentUser.id;(0,o.useEffect)((()=>{if(!e)return;(0,c().S)(e);const t=window.setInterval((()=>{(0,c().S)(e)}),n(141666).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(803290).K8)((()=>u().A.state.open),[]),s=x();return(0,f.jsx)(n(754313).A,{onDismiss:n(975392).lQ,render:()=>(0,f.jsx)("div",{style:s.modal,children:(0,f.jsxs)(n(610271).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:s.image,src:n(83544).A.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:s.title,children:(0,f.jsx)(a().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:s.description,children:(0,r().Qq)(d().N6,"banner")}),(0,f.jsx)(v,{}),(0,f.jsx)(y,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function v(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(g().A,{size:"lg",style:e.acceptAllButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(a().sA,{...r().LS.acceptAllButtonLabel})})}function y(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(p().p,{size:"lg",isGray:!0,style:e.moreOptionsButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(a().sA,{...r().LS.rejectAllButtonLabel})})}function b(){const e=x();return(0,f.jsx)(m().A,{hasDismissButton:!0,onDismiss:()=>{u().A.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(p().p,{...t,size:"lg",isGray:!0,style:e.moreOptionsButton,children:(0,f.jsx)(a().sA,{...r().LS.moreOptionsButtonLabel})})})}function x(){return(0,s().IS)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.text.primary,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.text.secondary,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const S=o.memo(h)},667253:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>y,TopbarPageAnalyticsOptOutMenu:()=>v,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(242343);var o=()=>n(237385),i=()=>n(803290),s=()=>n(653998),r=()=>n(13769),a=()=>n(392608),l=()=>n(907721),d=()=>n(466321),c=()=>n(485966),u=()=>n(204435),m=()=>n(443252),p=()=>n(611824),g=()=>n(90760),f=n(163643);const h=n(129044).default.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function v(){const e=(0,o().v3)(),t=(0,i().K8)((()=>h.state.isOpen),[]),n=(0,i().K8)((()=>h.state.rect),[]),r=(0,i().O$)(c().AppStoreMainEditorCurrentBlockStore);return r?(0,f.jsx)(m().Ay,{popupType:e.device.isMobile?d().n.SlideUp:d().n.Popup,alignmentToOrigin:l().C.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u().VP,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(s().sA,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(y,{store:r})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function y(e){const t=(0,o().v3)(),n=(0,i().K8)((()=>{const e=c().default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),l=(0,i().K8)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g().A,{type:"dropdown",currentOption:l?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:n=>{"do_not_record"===n?r().Oy(t,e.store.id):r().F3(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(p().A,{external:!0,href:(0,a().xS)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},668204:(e,t,n)=>{n.d(t,{L:()=>s});n(242343);var o=n(163643);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("g",{clipPath:"url(#clip0_9208_17166)",children:(0,o.jsx)("path",{d:"M8.125 14.75c0-.345.28-.625.625-.625h10.1a.625.625 0 0 1 0 1.25H8.75a.625.625 0 0 1-.625-.625M7 9.375a.625.625 0 1 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zm-1.75-4.75a.625.625 0 0 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zM2.9 9.375a.625.625 0 1 0 0 1.25h1.5a.625.625 0 1 0 0-1.25zM.525 5.25c0-.345.28-.625.625-.625h1.5a.625.625 0 0 1 0 1.25h-1.5a.625.625 0 0 1-.625-.625m4.125 8.875a.625.625 0 0 0 0 1.25h1.5a.625.625 0 1 0 0-1.25z"})}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_9208_17166",children:(0,o.jsx)("path",{d:"M0 0h20v20H0z"})})})]})},s=(0,n(680369).wt)("tableOfContents",i)},670029:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=n(163643);const l=(0,n(680369).wt)("thanksShield",{viewBox:"0 0 27 32",svg:(0,a.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var d=()=>n(653998);const c=["dmca_no_action"],u=(0,d().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var m=()=>n(220413),p=()=>n(975392),g=()=>n(31448),f=()=>n(818369),h=()=>n(145046),v=()=>n(183409),y=()=>n(782422),b=()=>n(653147),x=()=>n(477784),S=()=>n(640979),M=()=>n(392608),A=()=>n(802955),w=()=>n(406073),k=()=>n(473852),j=()=>n(435819),C=()=>n(59175),I=()=>n(935091),T=()=>n(932322),_=()=>n(858023),P=()=>n(152058),B=()=>n(204024);function R(e){let{name:t,title:n,caption:s,isSelected:l,onClick:d,disabled:c}=e;const[u,m]=(0,P().A)(),p=(0,i().Y0)(),g=(0,r().IS)((e=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:c?.4:1,...m&&{boxShadow:e.outlineBlueInputBoxShadow}},caption:{color:e.text.secondary,marginLeft:8},input:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}})),[c,m]),f=(0,o.useCallback)((()=>{c||d()}),[c,d]);return p.isMobile?(0,a.jsx)(T().Ay,{title:n,right:(0,a.jsx)(B().A,{isSelected:l}),onClick:f}):(0,a.jsxs)("label",{style:g.root,children:[(0,a.jsx)(B().A,{isSelected:l}),(0,a.jsx)("div",{children:n}),s&&(0,a.jsx)("div",{style:g.caption,children:s}),(0,a.jsx)("input",{type:"radio",checked:l,disabled:c,name:t,onClick:f,style:g.input,ref:u})]})}var L=()=>n(286404),D=()=>n(88271),N=()=>n(487966),O=()=>n(611824),E=()=>n(671622);const U=(0,d().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const F=function(){const e=(0,s().K8)((()=>w().A.state.open),[]);return(0,a.jsx)(n(754313).A,{ariaLabel:x().A.formatMessage(U.dialogLabel),onDismiss:Q,render:()=>(0,a.jsx)(ee,{}),isOpen:e})};function K(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!c.includes(t)&&!("other_content_policy_violation"===t&&!n))}function V(){const{state:e}=w().A;if(e.open){const{reason:t,additionalInformation:n}=e;return K({reason:t,additionalInformation:n})}return!1}function z(e){let{modalState:t}=e;const{reason:n}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R,{title:(0,a.jsx)(d().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>w().A.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,a.jsx)(R,{title:x().A.formatMessage(u.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>w().A.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,a.jsx)(R,{title:x().A.formatMessage(u.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>w().A.setState({...t,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,a.jsx)(R,{title:(0,a.jsx)(d().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>w().A.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function W(e){const t=w().A.getState();if(!t.open)return;const{additionalInformation:n,reason:o}=t,i=(0,y().Gu)();if(null==i||!i.id||!o||!K({reason:o,additionalInformation:n}))return void h().f1((0,a.jsx)(d().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const s=await f().callApi({eventName:"reportPage",environment:e,data:{reason:o,page:i,additionalInformation:n}});"failed"===s.type?h().Qg(s):(w().A.setState({open:!1}),h().rG({message:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[l({width:32}),(0,a.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,a.jsx)(d().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function H(e){return{width:360,padding:24,fontSize:14,color:e.text.secondary}}function G(e,t){const{device:n}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:n.isMobile?16:"10px 12px",height:n.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:n.isMobile?16:14}}function Y(e){let{isMobile:t=!1}=e;return(0,a.jsx)(d().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion's content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,a.jsx)("br",{}),contentpolicylink:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0,a.jsx)(N().A,{title:n,href:(0,M().xS)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginLeft:void 0},buttonStyle:{alignItems:"baseline",height:t?g().K_.UISmall.mobile:g().K_.UISmall.desktop,paddingLeft:"3px",paddingRight:"2px"},iconStyle:{alignSelf:"center",marginRight:"3px"},textSize:"small",isMobile:t})},clarification:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.jsx)("i",{children:t})}}})}function q(){return(0,a.jsx)(d().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion's official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.jsx)(O().A,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:t})}}})}function $(){const e=(0,r().DP)();return(0,a.jsx)("div",{style:H(e),children:(0,a.jsx)(d().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function Q(){v().lR()}function Z(){return(0,r().IS)((e=>({reportPageExplanation:{color:e.text.tertiary,background:e.contentBackground,border:`1px solid ${e.stroke.input}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:m().Ay.lightTextColor,padding:"5px",fontSize:g().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:g().Wy.medium}})),[])}function X(e){let{modalState:t}=e;const n=(0,r().DP)(),o=(0,i().v3)(),s=Z();if(!t.open)return null;const{reason:l}=t,u={menuType:S().gu.Modal,title:(0,a.jsx)(d().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,a.jsx)(d().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:Q};return(0,a.jsx)(I().A,{...u,children:(0,a.jsx)(_().Ay,{type:_().Oh.Vertical,initialFocus:void 0,sections:p().oE([{key:"help",render:e=>{let{children:t,...n}=e;return(0,a.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"help",render:()=>(0,a.jsx)(T().Ay,{title:(0,a.jsx)(Y,{isMobile:!0}),textWrapperStyle:s.mobileDescription,shouldWrapTitle:!0,right:(0,a.jsx)(a.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,a.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"options",render:()=>(0,a.jsx)(z,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>l&&!c.includes(l)&&(0,a.jsx)(C().A,{textarea:!0,style:G(o,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(U.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{w().A.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},"dmca_no_action"===l?{key:"explain_dmca",render:e=>{let{children:t,...n}=e;return(0,a.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"explain_dmca",render:()=>"dmca_no_action"===l&&(0,a.jsx)(T().Ay,{title:(0,a.jsx)(q,{}),textWrapperStyle:{...s.mobileDescription,background:n.accentColors.yellow[100],color:n.accentColors.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,a.jsx)(a.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:e=>{let{children:t,...n}=e;return(0,a.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,o=V();return(0,a.jsx)(E().A,{...n,disabled:!o,title:(0,a.jsx)("div",{style:{color:o?m().Ay.red:m().Ay.uiGray},children:(0,a.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||W})},action:()=>W(o)}]}])},"main list")})}function J(e){let{modalState:t}=e;const n=(0,r().DP)(),o=(0,i().v3)(),s=Z();if(!t.open)return null;const{reason:l}=t,u="dmca_no_action"===l;return(0,a.jsx)(j().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,a.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,a.jsx)("div",{style:s.modalTitle,children:(0,a.jsx)(d().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,a.jsx)(k().A,{isMobile:!1,textSize:"small",styleKey:b().q.Yellow,style:u?s.reportPageBanner:{...s.reportPageExplanation,...s.reportPageBanner},children:u?(0,a.jsx)(q,{}):(0,a.jsx)(Y,{})}),(0,a.jsx)("div",{children:(0,a.jsx)(z,{modalState:t})}),l&&!c.includes(l)&&(0,a.jsx)(C().A,{textarea:!0,style:G(o,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(U.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{w().A.setState({...t,additionalInformation:e.target.value})}}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,a.jsx)(L().A,{size:"lg",onClick:Q,style:{marginRight:12},children:(0,a.jsx)(d().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,a.jsx)(L().A,{color:"uiRed",size:"lg",onClick:()=>W(o),disabled:!V(),disabledFeedback:!0,children:(0,a.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function ee(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(A().e),o=(0,s().O$)(w().A);return n?o.open?t.isMobile?(0,a.jsx)(X,{modalState:o}):(0,a.jsx)(J,{modalState:o}):null:(0,a.jsx)($,{})}},673357:(e,t,n)=>{n.d(t,{c:()=>i});n(242343);var o=n(163643);const i=(0,n(680369).wt)("minus",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},688266:(e,t,n)=>{n.d(t,{Js:()=>r,Ns:()=>i,d:()=>s});var o=()=>n(129978);const i={publishSite:new(o().O2)("PublishSite",(async()=>await Promise.all([n.e(9304),n.e(67780),n.e(96933),n.e(52979),n.e(16345)]).then(n.bind(n,883929)))),publishedSiteSettings:new(o().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(75134),n.e(9304),n.e(62475),n.e(3151),n.e(98629),n.e(37353),n.e(29151),n.e(16908),n.e(28721),n.e(76181),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(2804),n.e(82850),n.e(69914),n.e(19361),n.e(63327),n.e(50984),n.e(67780),n.e(96933),n.e(22542),n.e(62922),n.e(39301)]).then(n.bind(n,529840))))},s=(0,o()._h)(i.publishedSiteSettings,(e=>e.default)),r=(0,o()._h)(i.publishSite,(e=>e.default))},691859:(e,t,n)=>{n.d(t,{Ay:()=>i().A,yQ:()=>r});var o=()=>n(129978),i=()=>n(40473);const s=new(o().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,640320)))),r=(0,o()._h)(s,(e=>e.default))},693240:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(817150),a=()=>n(466321),l=()=>n(485966),d=()=>n(867362),c=()=>n(141122),u=()=>n(174114),m=()=>n(810111),p=()=>n(875089),g=()=>n(578964),f=()=>n(452894),h=()=>n(640582),v=n(163643);const y={viewBox:"0 0 16 16",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.575 2.092v.958a.575.575 0 0 0 1.15 0v-.958A1.125 1.125 0 0 0 8 8.1"}),(0,v.jsx)("path",{d:"M12.2 1.6a2.846 2.846 0 0 0-2.846 2.846V5.8H5.2a2.025 2.025 0 0 0-2.025 2.025v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2A2.025 2.025 0 0 0 10.8 5.8h-.196V4.446a1.596 1.596 0 1 1 3.192 0v1.63a.625.625 0 1 0 1.25 0v-1.63A2.846 2.846 0 0 0 12.2 1.6M4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},b=(0,n(680369).wt)("lockOpenSmall",y);var x=()=>n(668204),S=()=>n(653998),M=()=>n(31448),A=()=>n(759625),w=()=>n(84543),k=()=>n(137476),j=()=>n(712048),C=()=>n(640979),I=()=>n(481148),T=()=>n(290557),_=()=>n(433226),P=()=>n(209684),B=()=>n(932322),R=()=>n(397791),L=()=>n(88271),D=()=>n(431551),N=()=>n(957356);const O=function(e){let{store:t,useBottomSheetStyling:a}=e;const l=(0,i().v3)(),d=(0,S().tz)(),{device:c}=l,u=(0,s().K8)((()=>t.isLockedForAllUsers()),[t]),g=(0,s().K8)((()=>_().$.isTemporarilyUnlocked({userId:t.userId,blockId:t.id})),[t.id,t.userId]),f=(0,s().K8)((()=>t.isLocked()),[t]),h=(0,s().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);let y;y=c.isMobile?{menuType:C().gu.Modal,right:a?void 0:(0,v.jsx)(n(743668).DoneMenuText,{}),onClickRight:r().VN,title:d.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:C().gu.Popup,minWidth:300};const b=(0,s().K8)((()=>function(e,t){const n=e.getFormat();if(!t)return{};const o=(0,p().L)(n,t,void 0,m().jf.Collection);return o}(t,t.getSchema())),[t]),x=(0,o.useCallback)((()=>{g?_().$.relockBlock({userId:t.userId,blockId:t.id}):_().$.temporarilyUnlockBlock({userId:t.userId,blockId:t.id})}),[t.id,t.userId,g]);return(0,v.jsxs)(n(935091).A,{...y,children:[u&&(0,v.jsx)(z,{isTemporarilyUnlocked:g,onToggleLock:x}),(0,v.jsx)(E,{store:t,locked:f,format:b,isSyncedCollection:h,device:c})]})};function E(e){let{format:t,isSyncedCollection:n,store:o,locked:i,device:r}=e;const a=(0,s().K8)((()=>o.getSchema()),[o]),l=function(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}(t),{pageSectionVisibility:d}=l,c=(0,s().K8)((()=>(0,j().vk)(d)),[d]),u=(0,s().K8)((()=>o.isCollectionView()),[o]),m=(0,s().K8)((()=>!(0,I().LX)({device:r})),[r]),p=!r.isMobile&&!u;if(!a||!o)return null;if(!l)return null;if(!d)return null;const g={topLevelDiscussions:!n,backLinks:m,floatingTableOfContents:p,pageComments:!n},f={locked:i,store:o,format:t},h=(0,v.jsxs)(v.Fragment,{children:[g.backLinks&&(0,v.jsx)(F,{...f}),g.topLevelDiscussions&&(0,v.jsx)(U,{pageVisibility:d.comments,...f}),g.floatingTableOfContents&&(0,v.jsx)(K,{pageVisibility:d.comments,...f,store:o}),g.pageComments&&(0,v.jsx)(V,{pageVisibility:c,...f})]});return(0,v.jsx)(L().A,{style:{opacity:i?.5:1},children:(0,v.jsx)("div",{style:{marginLeft:2},children:h})})}function U(e){let{pageVisibility:t,locked:n,store:s,format:a}=e;const l=(0,i().v3)(),d="section_show"===t,c=(0,o.useCallback)((()=>{const e="section_show"===t?"section_hide":"section_show";r().OD({environment:l,pageSection:"comments",visibility:e,store:s,format:a})}),[l,a,t,s]),m=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]);return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(S().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"}),icon:(0,v.jsx)(R().I,{icon:f().h}),right:(0,v.jsx)("div",{style:m.switcherButtonContainer,children:(0,v.jsx)(D().A,{disabled:n,on:d,onClick:c})})})}function F(e){let{locked:t,store:n,format:o}=e;const{backlinksVisibility:i,updateBacklinksVisibility:s}=(0,T().Ap)({store:n,format:o});return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(S().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,v.jsx)(R().I,{icon:g().D}),right:(0,v.jsx)(N().p7,{currentVisibility:i,onSelect:s,disabled:t})})}function K(e){let{pageVisibility:t,locked:n,store:r,format:a}=e;const l=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]),d=(0,i().v3)(),c=(0,s().K8)((()=>{var e;return"off"!==(null===(e=r.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[r]),m=(0,o.useCallback)((()=>{w().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{A().zv({store:r.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,k().u4)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[r,d,c]);return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(S().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:(0,v.jsx)(R().I,{icon:x().L}),right:(0,v.jsx)("div",{style:l.switcherButtonContainer,children:(0,v.jsx)(D().A,{disabled:n,on:c,onClick:m})})})}function V(e){let{pageVisibility:t,locked:n,store:o,format:s}=e;const a=(0,i().v3)();return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(S().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,v.jsx)(R().I,{icon:f().h}),right:(0,v.jsx)(N().J8,{currentVisibility:t,disabled:n,onSelect:e=>{r().OD({environment:a,pageSection:"margin_comments",visibility:e,store:o,format:s})}})})}function z(e){let{isTemporarilyUnlocked:t,onToggleLock:n}=e;const o=(0,u().DP)();return(0,v.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${o.regularDividerColor}`,borderBottom:`1px solid ${o.regularDividerColor}`,background:o.surface.wash,color:o.text.secondary,paddingTop:6,paddingBottom:6},children:[(0,v.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:t?(0,v.jsx)(R().I,{icon:b,size:"sm",color:"secondary"}):(0,v.jsx)(R().I,{icon:h().O,size:"sm",color:"secondary"})}),(0,v.jsx)(S().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Page is locked."}),(0,v.jsx)(P().p,{style:{fontSize:12,color:o.text.secondary,fontWeight:M().Wy.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:n,children:t?(0,v.jsx)(S().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,v.jsx)(S().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock for me"})})]})}const W=function(){const e=(0,i().v3)(),{device:t}=e,o=(0,s().O$)(d().A);return(0,v.jsx)(n(443252).Ay,{popupType:t.isMobile?a().n.BottomSheet:a().n.Popup,bottomSheetInitialState:"half",alignmentToOrigin:n(907721).C.Center,open:o.isOpen,render:()=>(0,v.jsx)(H,{useBottomSheetStyling:t.isMobile}),originRect:o.isOpen?o.rect:void 0,onDismiss:()=>r().VN(),trapFocus:!0})};function H(e){let{useBottomSheetStyling:t}=e;const n=(0,s().O$)(d().A),o=(0,s().K8)((()=>c().default.state.open&&c().default.state.targetStore||l().default.state.mainEditorCurrentBlockStore),[]);return n.isOpen&&o?(0,v.jsx)(O,{store:o,useBottomSheetStyling:t}):null}},709625:(e,t,n)=>{n.d(t,{q:()=>a});var o=()=>n(237385),i=()=>n(162901),s=()=>n(76394),r=()=>n(818369);function a(){const e=(0,o().v3)(),[{status:t,error:n,value:a},l]=(0,i().Yb)((async()=>{const t=await r().callApi({eventName:"getUserOrganizations",environment:e,data:{}});if("success"===t.type)return t.data;if("failed"===t.type)throw t.error;return(0,s().HB)(t)}),[e]);return{organizationsInfo:(null==a?void 0:a.organizationsInfo)??[],loading:"pending"===t||"idle"===t,error:n,refresh:l}}},724356:(e,t,n)=>{n.d(t,{u:()=>s});var o=()=>n(129978);const i=new(o().O2)("teamPermissionsInviteWithModal",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,233048)))),s=(0,o()._h)(i,(e=>e.TeamPermissionsInviteWithModal))},747588:(e,t,n)=>{n.d(t,{H:()=>a});var o=()=>n(237385),i=()=>n(803290),s=()=>n(985957),r=()=>n(574541);function a(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:s=!1}=e,a=(0,o().v3)();return(0,i().K8)((()=>n?r().bY({pageStore:t,environment:a,enabled:n,forceUpdate:s}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,a,n,s])}(e);return t&&!(0,s().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},749840:(e,t,n)=>{n.d(t,{Z:()=>w});n(362833),n(725707),n(491955),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(174114),r=()=>n(883959),a=()=>n(753674),l=()=>n(985957),d=()=>n(653998),c=()=>n(188877),u=()=>n(137476),m=()=>n(640979),p=()=>n(535906),g=()=>n(401382),f=()=>n(935091),h=()=>n(858023),v=()=>n(975515),y=()=>n(206799),b=()=>n(88271),x=()=>n(350208),S=n(163643);const M=1,A=(0,d().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languages…"}});function w(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:r,sourceLanguage:l,detectedPageLanguage:c,preferredLanguage:m,subMenuPlacement:g,subMenuAlignment:f,pageId:v}=e,y=(0,i().v3)(),w=(0,d().tz)(),I="loading"===r.status,T=k(I),_=(0,s().IS)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},...T})),[T]);(0,o.useEffect)((()=>{if("pre_activation"===r.status){const e=setTimeout((()=>{(0,u().u4)({environment:y,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:v}}})}),750);return()=>clearTimeout(e)}}),[r.status,v,y]);const P=r.targetLanguage,B=C({disabled:I,filter:e=>l!==e,currentSelectedLanguage:r.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,S.jsx)(h().Ay,{initialFocus:M,type:h().Oh.Vertical,sections:[{key:"sourceLanguage",render:e=>(0,S.jsx)(b().A,{...e,title:w.formatMessage(A.sourceLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2},style:_.menuItemSectionBottomBorder}),items:[{key:l,render:(e,t)=>{let{onFocus:o}=t;return(0,S.jsx)(x().A,{...e,onFocus:o,disableDefaultClick:!0,placementToOrigin:g,alignmentToOrigin:f,renderOrigin:(e,t)=>(0,S.jsx)(p().A,{...e,disabled:I,buttonStyle:_.button,ref:t,title:w.formatMessage((0,a().Bj)(l)),caption:l===c?w.formatMessage(A.detectedLanguage):l===m?w.formatMessage(A.preferredLanguage):void 0}),renderExtension:e=>(0,S.jsx)(j,{disabled:I,extensionPopupButtonEvents:e,currentTargetLanguage:P,sourceLanguage:l,onSelectSourceLanguage:n})})},action:()=>{}}]},{key:"selectLanguage",render:e=>(0,S.jsx)(b().A,{...e,title:w.formatMessage(A.selectLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2}}),items:B}]})}function k(e){return(0,s().IS)((t=>({button:{color:e?t.text.tertiary:t.text.primary}})),[e])}function j(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:o,sourceLanguage:s,onSelectSourceLanguage:r}=e,{isMobile:a}=(0,i().Y0)(),l=C({disabled:o,filter:e=>e!==n,currentSelectedLanguage:s,onSelectLanguage:e=>{r({sourceLanguage:e})}}),d=a?{menuType:m().gu.ActionSheet,...t}:{menuType:m().gu.Popup,width:200,height:380,...t};return(0,S.jsx)(f().A,{...d,onClick:e=>{e.preventDefault()},children:(0,S.jsx)(h().Ay,{initialFocus:void 0,type:h().Oh.Vertical,sections:[{key:"originalLanguage",render:e=>(0,S.jsx)(b().A,{...e}),items:l}]})})}function C(e){const{disabled:t,filter:n,currentSelectedLanguage:s,onSelectLanguage:u}=e,m=(0,d().tz)(),{isMobile:f}=(0,i().Y0)(),[h,b]=(0,o.useState)(""),x=k(t),M=(0,o.useMemo)((()=>({key:"language-search-input",render:e=>(0,S.jsx)(g().Ay,{...e,disabled:t,placeholder:m.formatMessage(A.languageSearchPlaceholder),value:h,onChange:e=>b(e.target.value),autoFocus:!f,inputLeft:(0,S.jsx)(y().Q,{iconGroup:r().C,colorName:"lightGrayPrimary",variantName:"default"})}),action:()=>{}})),[h,t,m,f]),w=(0,o.useMemo)((()=>({key:"no-results",render:()=>(0,S.jsx)(v().A,{title:(0,S.jsx)(d().sA,{defaultMessage:"No results found.",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),j=(0,o.useMemo)((()=>{const e=[];for(const t of l().hr)if(n(t)){const n=m.formatMessage((0,a().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,m]),C=(0,o.useMemo)((()=>(0,c().Ay)(h,j,(e=>{let{languageName:t}=e;return t.toLowerCase()}))),[h,j]),I=(0,o.useMemo)((()=>C.map((e=>{let{languageCode:n,languageName:o}=e;return{key:n,render:e=>(0,S.jsx)(p().A,{...e,buttonStyle:x.button,disabled:t,title:o,isChecked:s===n}),action:()=>{t||u(n)}}}))),[C,t,s,u,x.button]);return 0===I.length?[M,w]:[M,...I]}},751895:(e,t,n)=>{n.d(t,{n:()=>r});var o=()=>n(803290),i=()=>n(577860),s=()=>n(485966);function r(){return(0,o().K8)((()=>{var e;const t=(null===(e=s().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??i().q;return(0,i().o_)(t)}),[])}},771229:(e,t,n)=>{n.d(t,{j:()=>o});const o=(0,n(680369).xh)("claude",{default:{loader:()=>n.e(3791).then(n.bind(n,8295))},darkMode:{loader:()=>n.e(3791).then(n.bind(n,709139))}})},777864:(e,t,n)=>{n.d(t,{T:()=>S});n(242343);var o=()=>n(174114),i=()=>n(17384),s=()=>n(421338),r=()=>n(695951),a=()=>n(209684),l=()=>n(972522),d=()=>n(931085),c=()=>n(397791),u=()=>n(701270),m=()=>n(951540),p=n(163643);const g=480,f=16/9,h=20;function v(e){const{heroMedia:t,heroElement:n,width:i}=e,s=(0,o().IS)((()=>({heroContainer:{width:i,marginLeft:-h,marginTop:-h,...t?{position:"relative",aspectRatio:f,overflow:"hidden"}:{}}})),[t,i]);return(0,p.jsx)("div",{style:s.heroContainer,children:t?(0,p.jsx)(y,{src:t.src,alt:t.alt,type:t.type}):n})}function y(e){const{alt:t,src:n,type:i}=e,s=(0,o().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===i?(0,p.jsx)("img",{src:n,style:s.media,alt:t}):(0,p.jsx)("video",{title:t,src:n,style:s.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function b(e){const{title:t,body:n,badge:i,eyebrow:a}=e,l=(0,o().IS)((()=>({container:{paddingRight:4,paddingBottom:12,paddingLeft:4,paddingTop:24},title:{margin:0,textWrap:"pretty"},badge:{margin:0,alignSelf:"start"},badgeInline:{display:"inline-flex",verticalAlign:"middle",margin:"-4px 0 0 8px"}})),[]);return(0,p.jsxs)(s().Y1,{style:l.container,gap:4,children:[null!=a&&a.text?(0,p.jsxs)(s().Y1,{direction:"horizontal",align:"center-left",width:"hug",gap:4,children:[a.icon?(0,p.jsx)(c().I,{icon:a.icon}):void 0,(0,p.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"primary",children:a.text})]}):null!=i&&i.text?(0,p.jsx)(r().A,{content:i.text,color:i.color,style:l.badge}):void 0,(0,p.jsxs)(u().D,{styleName:"UITitle-26px/Bold",colorName:"primary",customStyles:l.title,children:[t,null!=a&&a.text&&null!=i&&i.text?(0,p.jsx)(r().A,{content:i.text,color:i.color,style:l.badgeInline}):void 0]}),(0,p.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n})]})}function x(e){const{link:t,secondary:n,primary:r}=e,l=(0,o().IS)((e=>({container:{marginTop:16},primary:{...null!=r&&r.isFullWidth?{width:"100%"}:{},...null!=r&&r.icon?{gap:4}:{}},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",marginLeft:-4},linkIcon:{display:"inline-block",verticalAlign:"text-bottom",marginLeft:4},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"}})),[r]),g=r?(0,p.jsxs)(m().A,{color:"black",size:r.isFullWidth?"xl":"lg",onClick:r.onClick,style:l.primary,autoFocus:!0,children:[r.icon?(0,p.jsx)(c().I,{icon:r.icon}):void 0,r.text]}):void 0;if(null!=r&&r.isFullWidth)return(0,p.jsx)("div",{style:l.container,children:g});let f=(0,p.jsx)("div",{});t&&(f=(0,p.jsx)(d().A,{onClick:t.onClick,style:l.link,external:t.external,children:(0,p.jsxs)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:[t.text,t.external?(0,p.jsx)(c().I,{icon:i().arrowUpRightSquareSmallIcon,size:"sm",color:"secondary",style:l.linkIcon}):void 0]})}));const h=n?(0,p.jsx)(a().p,{onClick:n.onClick,style:l.secondary,external:n.external,children:n.text}):void 0;return(0,p.jsxs)(s().Y1,{style:l.container,direction:"horizontal",align:"center",gap:"auto",children:[f,(0,p.jsxs)(s().Y1,{direction:"horizontal",gap:8,align:"center",width:"hug",children:[h,g]})]})}function S(e){const{title:t,body:n,badge:i,eyebrow:r,heroMedia:a,heroElement:d,primary:c,secondary:u,link:m,onDismiss:f,width:y,hideCloseButton:S}=e,M=y||g,A=(0,o().IS)((e=>({container:{width:M,padding:h,position:"relative",backgroundColor:e.surface.elevated}})),[M]);return(0,p.jsxs)(s().Y1,{style:A.container,direction:"vertical",children:[a||d?(0,p.jsx)(v,{heroMedia:a,heroElement:d,width:M}):void 0,(0,p.jsx)(b,{title:t,body:n,badge:i,eyebrow:r}),(0,p.jsx)(x,{primary:c,secondary:u,link:m}),S?void 0:(0,p.jsx)(l().A,{onClick:f})]})}},781469:(e,t,n)=>{n.d(t,{zk:()=>k,wm:()=>A,Js:()=>C,H0:()=>T,hk:()=>_});n(242343);var o=()=>n(284703),i=()=>n(34662),s=()=>n(653998),r=()=>n(84543),a=()=>n(86452),l=()=>n(174114),d=()=>n(906230),c=()=>n(907721),u=()=>n(331516),m=()=>n(402557),p=()=>n(103151),g=n(163643);function f(e){let{menuListItemProps:t,title:n,caption:o,icon:i,disabled:s,tooltipText:r,showNewBadge:a}=e;const f=(0,l().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(p().A,{placement:c().W.Right,disableTooltip:!r,renderTooltip:()=>r,render:e=>(0,g.jsx)(u().A,{...(0,d().A)(t,e),style:f.menuItem,title:n,caption:o,captionStyle:o?f.caption:void 0,svg:i,disabled:s,disabledFeedback:s,right:a&&(0,g.jsx)(m().A,{})})})}var h=()=>n(944498),v=()=>n(904697),y=()=>n(764227),b=()=>n(32901),x=()=>n(810310);const S=(0,s().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function M(e,t){return(0,b().Ls)({key:"turn page into team",displayName:t,analyticsName:S.createTeamFromPageFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,render:(e,o)=>{const r=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===i().q4_(t.getTitleValue()).length)return(0,g.jsx)(s().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,v().getAccessLevelAndPermissionsForTeamCreatedFromPage)(t).accessLevel&&!(0,y().HO)())return(0,g.jsx)(s().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:o.environment,blockStore:o.blocks[0]});return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),caption:(0,g.jsx)(s().sA,{...S.createTeamFromPageCaption}),disabled:Boolean(r),tooltipText:r,icon:n(346695).I})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];n(127776).Vs({environment:o,page:i})}})}const A=M([h().Uo6([h().w2Y,h().AU6(h().d2I)])],S.createTeamFromPageFullName),w=M([h().w2Y],S.createTeamFromPageName),k=(0,b().uk)({key:"turn into teamspace or wiki",displayName:x().DZ.turnIntoSection,analyticsName:x().DZ.turnIntoSection.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:[h().w2Y,h().d2I],subActions:()=>[(0,b().gy)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(88271).A,{...e}),actions:[w,I]})],width:300});function j(e,t){return(0,b().Ls)({key:"turn page into wiki",displayName:t,analyticsName:S.turnPageIntoWikiFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;"bottom_right"===n(836331).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(936726).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:o[0]}):r().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{a().hJ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})},render:e=>{const i=!n(802955).A.state.online;return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),disabled:i,icon:o().arrowSquarePathUpDownIcon,tooltipText:i?(0,g.jsx)(s().sA,{...b().AY.unavailableOfflineTooltip}):(0,g.jsx)(s().sA,{...S.turnPageIntoWikiCaption})})}})}const C=j([h().Uo6([h().d2I,h().AU6(h().w2Y)]),h().AU6(h().oy3)],S.turnPageIntoWikiFullName),I=j([h().d2I],S.turnPageIntoWikiName);const T=j([h().d2I,h().AU6(h().oy3)],S.turnPageIntoWikiFullName),_=(0,b().Ls)({key:"undo turn page into wiki",displayName:S.undoTurnPageIntoWikiName,analyticsName:S.undoTurnPageIntoWikiName.defaultMessage,svg:n(644540).arrowUTurnUpLeftIcon,validators:[h().vXb,h().VNy,h().AU6(h().ln6),h().Afv,h().Km9,h().AU6(h().oy3)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:o}=e;const{accept:l}=await n(145046).Gh({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:'Turn "{pageName}" back into a normal page?',id:"action.undoTurnIntoWiki.message",values:{pageName:i().q4_(o[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});l&&r().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{a().nQ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})}})},789581:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>T,messages:()=>_});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(794484),l=()=>n(680369),d=()=>n(653998),c=()=>n(870099),u=()=>n(137476);var m=()=>n(360378),p=()=>n(129978);const g=new(p().O2)("topbarMoreMenu",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,571107)))),f=(0,p()._h)(g,(e=>e.TopbarMoreMenu));var h=()=>n(53664),v=()=>n(77251),y=()=>n(485966),b=()=>n(936726),x=()=>n(817545),S=()=>n(762436),M=()=>n(822493),A=n(163643);function w(e){const{originRef:t}=e,n=(0,r().IS)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.text.uiBluePrimary}})),[]);return(0,A.jsx)(S().U,{calloutId:"ai_page_translation",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:(0,A.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingLeft:4,paddingRight:4},children:[(0,x().K)(n.aiTranslateIcon),(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{v().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{v().W.reset()},nextButtonContent:(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var k=()=>n(273520),j=()=>n(521839),C=()=>n(991378);function I(e){let{originRef:t}=e;return(0,A.jsx)(S().U,{calloutId:"wiki_promo",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:C().Sw}})})}function T(e){let{buttonPopupStore:t,store:n,isLastButton:a,renderOrigin:l}=e;const d=(0,i().v3)(),{device:p}=d,[g,x]=(0,o.useState)(void 0),S=(0,o.useRef)(null),M=(0,o.useCallback)((()=>{b().r.reset(),v().W.reset(),m().IU({environment:d});const e=S.current;e&&x(e.getBoundingClientRect()),function(e){u().vd(e,"open_more_menu")}(d)}),[S,d]),C=(0,s().K8)((()=>b().r.state.showConvertTooltip),[]),T=(0,s().O$)(v().W),_=(0,r().IS)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.surface.wash}})),[]),P=(0,A.jsxs)(A.Fragment,{children:[C?(0,A.jsx)(I,{originRef:S}):T?(0,A.jsx)(w,{originRef:S}):null,(0,A.jsx)(k().Ay,{popupType:p.isMobile?k().z7.BottomSheet:k().z7.Popup,buttonPopupStore:t,renderOrigin:l||(e=>(0,A.jsx)(R,{ref:S,buttonPopupEvents:e,isLastButton:a})),onClick:M,render:()=>(0,A.jsx)(f,{blockStore:n,onClickOriginRect:g,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:o}=y().default.state;if(o){const t=o.getType();var i;if(t)(0,c().N)(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:o.id,block_type:t,is_toggleable:(0,h().Yt)(t,o.getFormat()),collection_id:null===(i=o.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels(),form_id:o.getFirstFormIdInCollectionViewBlock()})}e.closeParentMenu&&B(t)}(e,t,d),handleDismiss:()=>B(t)}),originGap:p.isElectronWindows?12:8,forceInitialInbound:!0,style:p.isMobile?_.mobilePopupStyle:{width:240,maxHeight:"80vh"}})]}),L=(0,s().K8)((()=>y().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return T&&L?(0,A.jsx)(j().u,{shape:"square",borderRadius:6,children:P}):P}const _=(0,d().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function P(e,t,o){const{device:i}=e;if(!i.isMobile){const{iconButton:{width:e,height:o}}=(0,n(657304).Hh)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:o,borderRadius:6}}const s=(0,n(278267).aD)(t).iconContainer;return o?{...s,marginLeft:i.isTablet?-6:void 0,marginRight:0}:{...s,marginLeft:i.isTablet?-6:void 0,marginRight:i.isTablet?-6:s.marginRight}}function B(e){e.setState({...e.state,open:!1})}const R=o.forwardRef((function(e,t){let{buttonPopupEvents:o,isLastButton:s}=e;const c=(0,r().DP)(),u=(0,i().v3)(),{device:m}=u,p=(0,d().tz)();return(0,A.jsx)(n(103151).A,{renderTooltip:()=>u.currentUser.isLoggedIn()?(0,A.jsx)(d().sA,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,A.jsx)(d().sA,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:n(907721).W.Bottom,originGap:m.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,A.jsx)(n(126451).A,{ref:t,style:P(u,c,s),mobileFeedback:m.isMobile,className:n(983050).ug9,ariaLabel:p.formatMessage(_.actions),...(0,n(906230).A)(o,e),children:m.isMobile?(0,a().L)({height:l().lD.lg,width:l().lD.lg,fill:c.icon.primary}):(0,a().L)({width:l().Ev.lg,height:l().Ev.lg,fill:c.icon.primary})})})}))},797588:(e,t,n)=>{n.d(t,{N:()=>l});n(242343);var o=()=>n(174114),i=()=>n(839996),s=()=>n(653998),r=()=>n(206799),a=n(163643);function l(e){let{inviteTarget:t}=e;const n=(0,o().IS)((e=>({notionMemberLine:{display:"flex",alignItems:"center",gap:2},notionMemberIcon:{display:"flex",alignItems:"center",justifyContent:"center",color:e.icon.uiBluePrimary}})),[]);return(0,a.jsxs)("div",{style:n.notionMemberLine,children:[(0,a.jsxs)("div",{style:n.notionMemberIcon,children:[(0,a.jsx)(r().Q,{variantName:"fillSmall",iconGroup:i().g}),(0,a.jsx)(s().sA,{id:"invite.google_imports.notion_member.title",defaultMessage:"Notion Member"})]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("div",{children:t.value.email})]})}},798508:(e,t,n)=>{n.d(t,{Bb:()=>s,PP:()=>a,gY:()=>p,vG:()=>d,wV:()=>u});var o=()=>n(653998);const i=(0,o().YK)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),s={section_show:i.expanded,section_collapsed:i.expanded,section_hide:i.off},r=(0,o().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),a={inline:r.default,minimal:r.minimal},l=(0,o().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),d={always_show:l.alwaysShow,section_show:l.showOnHover,section_collapsed:l.showOnHover,section_hide:l.off,inline:l.off,minimal:l.off},c=(0,o().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),u={inline:c.asPageSection,minimal:c.minimal},m=(0,o().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),p={show:m.alwaysShow,hide:m.alwaysHide,hide_if_empty:m.hideWhenEmpty,section:m.asPageSection}},799800:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>ne});n(725707),n(491955),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(712437),a=()=>n(145017),l=()=>n(818551),d=n(163643);const c={viewBox:"0 0 20 20",svg:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,d.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},u=(0,n(680369).wt)("arrowRightIntoRectangle",c);var m=()=>n(794484),p=()=>n(134917),g=()=>n(633627),f=()=>n(653998),h=()=>n(164474),v=()=>n(331516),y=()=>n(88271),b=()=>n(944498),x=()=>n(29869),S=()=>n(485966),M=()=>n(682191),A=()=>n(32901),w=()=>n(220413);const k=(0,f().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),j=(0,A().Ls)({key:"action report page",displayName:k.reportPageName,analyticsName:k.reportPageName.defaultMessage,validators:[b().sc7,b().Env,b().Kwf,b().AU6(b().kD4)],closeParentMenu:!0,render:e=>(0,d.jsx)(v().A,{...e,style:{color:w().Ay.red},svg:p().M,svgStyle:{fill:w().Ay.red},title:(0,d.jsx)(f().sA,{...k.reportPageName})}),action:e=>{let{blocks:t,environment:o}=e;n(183409).HX()}}),C=(0,f().YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),I=(0,A().Ls)({key:"log in",displayName:C.signUpOrLogInName,analyticsName:C.signUpOrLogInName.defaultMessage,svg:u,validators:[b().AU6(b().M3g),b().IrU,b().AU6(b().ZVI)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;n(271120).Tv(t),await n(794824).VE(t,{utmContent:"sign_up_or_log_in",nextRoute:n(758611).JZ.login})}}),T=(0,A().Ls)({key:"view original page",displayName:C.viewOriginalPageName,analyticsName:C.viewOriginalPageName.defaultMessage,svg:n(96913).arrowExpandDiagonalBottomLeftToTopRightIcon,validators:[b().ZVI],closeParentMenu:!0,action:e=>{let{blocks:t}=e;const n=(0,x().Ay)({store:t[0],preferPublicLink:!0,pageVisitSource:r().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${n}`,"_blank")}}),_=(0,A().Ls)({key:"report form",displayName:C.reportFormName,analyticsName:C.reportFormName.defaultMessage,svg:p().M,validators:[b().Env,b().kD4],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().Hi(t,n[0].id)}}),P=(0,A().Ls)({key:"ios share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().wHP,b().un6],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=t[0],i=o.getNavigableBlockStore();if(i){const e=(0,x().Ay)({store:i,scrollToBlockId:i.id===o.id?void 0:o.id,fullyQualified:!0,pageVisitSource:r().y8.NativeShareLink,embedded:!1});n.mobileNative&&n.mobileNative.share(e)}}}),B=(0,A().Ls)({key:"web share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().rr0],closeParentMenu:!0,action:async e=>{let{blocks:t}=e;const n=t[0],o=n.getNavigableBlockStore();if(o){const e=(0,x().Ay)({store:o,scrollToBlockId:o.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:r().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),R=(0,A().Ls)({key:"android share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:n(316551).y,validators:[b().vXb,b().wHP,b().m01],closeParentMenu:P.closeParentMenu,action:P.action}),L=(0,A().Fw)({key:"copy link",displayName:A().AY.copyLinkName,analyticsName:A().AY.copyLinkName.defaultMessage,svg:n(718799).w,shortcuts:["copyLinkToBlock"],validators:[b().M3g,b().vXb,b().AU6(b().wHP),b().AU6(b()._fc)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,n)=>{let{lazyDependencies:o,...i}=t;const{clipboardActions:s}=o;s&&s.copyLinkToBlock({...i,event:n,callback:e})}}),D=(0,A().Ls)({key:"edit page",displayName:C.editPageName,analyticsName:C.editPageName.defaultMessage,svg:n(686752).pencilLineIcon,validators:[b().vXb,b()._fc,b().Wci,b().AU6(b().V5t),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().T7(t,n[0].id)}}),N=(0,A().Ls)({key:"comment page",displayName:C.commentPageName,analyticsName:C.commentPageName.defaultMessage,svg:n(452894).h,validators:[b().vXb,b()._fc,n(691898).tm,b().AU6(b().M3g),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().aL(t,n[0].id)}}),O=(0,A().Ls)({key:"fork page",displayName:C.duplicatePageName,analyticsName:C.duplicatePageName.defaultMessage,svg:n(507190).V,validators:[b().vXb,b().FrL,b()._fc,b().K1R],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:o,environment:i}=e;n(149078).Ul({environment:i,store:t[0],originRect:o})}});function E(e){return(0,A().Ls)({key:"more actions menu",displayName:C.topbarMobileMoreActionsMenu,analyticsName:C.topbarMobileMoreActionsMenu.defaultMessage,svg:m().L,validators:[b().vXb,b().FrL,b()._fc],closeParentMenu:!0,action:e})}const U=(0,A().Ls)({key:"back to my content",displayName:C.backtoNotionName,analyticsName:C.backtoNotionName.defaultMessage,svg:n(713055).S,validators:[b().M3g,b().FrL],closeParentMenu:!0,action:(e,t)=>{let{environment:o}=e;const{currentUserRootStore:i,currentUserSettingsStore:s}=S().default.state;i&&s&&n(783759).t9({environment:o,userRootStore:i,userSettingsStore:s,pageVisitSource:r().y8.SwitchSpace})}}),F=(0,A().Ls)({key:"cookie settings",displayName:l().LS.cookieSettingsLabel,analyticsName:l().LS.cookieSettingsLabel.defaultMessage,validators:[b().AU6(b().ibx)],closeParentMenu:!1,render:e=>(0,d.jsx)(n(430148).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:o,...i}=e;return(0,d.jsx)(v().A,{...i,...t,title:n(477784).A.formatMessage(l().LS.cookieSettingsLabel),svg:n(389324).gearIcon})}}),action:()=>{}}),K=(0,A().Ls)({key:"search page",displayName:C.search,analyticsName:C.search.defaultMessage,svg:n(842940).J,validators:[b().vXb,b().FrL,b()._fc,b().Kg6],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(932387)._N({environment:t,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});const V=[(0,A().gy)({key:"user",render:e=>(0,d.jsx)(y().A,{...e}),actions:[U,I,T]}),(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(y().A,{...e}),actions:[j,_,F]})],z=[(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(y().A,{...e}),actions:[j,F]})];var W=()=>n(870099),H=()=>n(865226),G=()=>n(640979),Y=()=>n(53664),q=()=>n(504690),$=()=>n(515347),Q=()=>n(795756),Z=()=>n(413871),X=()=>n(518397),J=()=>n(935091),ee=()=>n(28210),te=()=>n(709237);function ne(e){let{blockStore:t,onDismiss:n,isPublicShareLink:l}=e;const c=(0,i().v3)(),{isMobile:u}=c.device,m=(0,s().K8)((()=>Q().A.getMode(c,t)),[c,t]),p=(0,s().K8)((()=>t.isFormBlock()),[t]),[g,f]=(0,o.useState)(u&&!p?"initialActions":"more"),h={environment:c,blocks:[t],publicEditMode:m,analyticsFrom:"topbar_more_menu"};let b;b=u?{menuType:G().gu.ActionSheet}:{menuType:G().gu.Popup,width:210,maxHeight:"80vh"};const w=(0,o.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=S().default.state;if(t){const n=t.getType();var o;if(n)(0,W().N)(c,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,Y().Yt)(n,t.getFormat()),collection_id:null===(o=t.getCollectionStore())||void 0===o?void 0:o.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[c,n]),k=(0,s().K8)((()=>{var e;if(!u)return;const n=t.getSpaceStore();if(!n)return;const o=$().GN(t),i=null==o||null===(e=o.getSiteStore())||void 0===e||null===(e=e.getHeader())||void 0===e?void 0:e.customItems;if(!i)return;return{key:"custom nav",render:e=>(0,d.jsx)(y().A,{...e}),actions:i.filter((e=>"block"===e.type)).map((e=>{const o=Z().Bv.createChildStore(n,{table:a().ev,id:e.blockId}),i=o.getIcon(),s=(0,x().Ay)({store:o,preferPublicLink:!0,pageVisitSource:r().y8.SiteCustomHeader});return{key:e.blockId,analyticsName:e.blockId,displayName:e.blockId,searchName:e.blockId,render:e=>(0,d.jsx)(v().A,{...e,left:i&&(0,d.jsx)(ee().B,{icon:i,store:t,disabled:!0,isEmptyPage:o.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,d.jsx)(te().A,{store:o,maxLength:30})}),action:()=>{H().oo({environment:c,url:s})},closeParentMenu:!0}}))}}),[c,u,t]),j=(C=()=>{f("more")},(0,A().gy)({key:"page",render:e=>(0,d.jsx)(y().A,{...e}),actions:[K,O,N,D,L,M().oc,P,R,E(C)]}));var C;const I=function(e){return(0,A().gy)({key:"page",render:e=>(0,d.jsx)(y().A,{...e}),actions:[B,P,R,E(e)]})}((()=>{f("more")})),T=(0,s().K8)((()=>(0,q().y)(c)),[c]);if("initialActions"===g){const e=k?[k,j]:[j];return(0,d.jsx)(J().A,{...b,children:(0,d.jsx)(X().A,{sections:T?[I]:e,onAccept:w,context:h})})}return(0,d.jsx)(J().A,{...b,children:(0,d.jsx)(X().A,{sections:l?z:V,context:h})})}},800720:(e,t,n)=>{n.d(t,{dl:()=>S,LV:()=>w});n(358848),n(362833),n(91270),n(242343);var o=n(163643);const i=(0,n(680369).wt)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,o.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})});var s=()=>n(836693),r=()=>n(653998),a=()=>n(84543),l=()=>n(88271),d=()=>n(944498),c=()=>n(548694),u=()=>n(667801),m=()=>n(485966),p=()=>n(641546),g=()=>n(682191),f=()=>n(781891),h=()=>n(32901),v=()=>n(781469);const y=(0,r().YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),b=(0,h().Ls)({key:"remove pinned shared page",displayName:y.unpinName,analyticsName:y.unpinName.defaultMessage,svg:i,validators:[d().p9k,d().qKm,d().AU6(d().nGR)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:s}=m().default.state;i&&s&&(a().createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:o,canUndo:!0,perform:e=>{for(const n of t)u().unpinSharedPage({environment:o,transaction:e,spaceViewStore:i,userSettingsStore:s,store:n})}}),n(945792).Nj(o,{type:"shared",from:"sidebar_dropdown_menu"}))}}),x=(0,h().Ls)({key:"edit form",displayName:y.editFormName,analyticsName:y.editFormName.defaultMessage,svg:n(827744).r,validators:[d().kD4,d().$68],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const i=t[0],s=i.getFormBlockParentBlockStore();var r;s&&n(191756).uK({environment:o,store:s,collectionViewId:null===(r=i.getParentStore())||void 0===r?void 0:r.id,pageVisitSource:n(712437).y8.FormInternalPage})}}),S=(0,h().Ls)({key:"delete block without shortcuts",displayName:h().AY.moveToTrashName,analyticsName:h().AY.moveToTrashName.defaultMessage,svg:s().trashIcon,isRed:!0,validators:[d().or([d()._fc,d().t7S,d().IuJ]),d().SvZ,d().AU6(d().xqI),d().AU6(d().Xjv(n(762847).xd.externalObjectInstancePage)),d().AU6(d().PfK),d().zrb,d().AU6(d().oy3),d().AU6(d().Po5)],closeParentMenu:!0,track:{actionName:"move_to_trash"},render:(e,t,i)=>{const a=d().dj5(t.blocks.at(0));return(0,o.jsx)(n(103151).A,{renderTooltip:()=>(0,o.jsx)("div",{style:{maxWidth:400,whiteSpace:"pre-wrap"},children:(0,o.jsx)(r().sA,{...h().AY.cannotDeleteBlockTooltip})}),render:()=>(0,o.jsx)(n(331516).A,{...e,title:(0,o.jsx)(r().sA,{...h().AY.moveToTrashName}),svg:s().trashIcon,isRed:!0,disabled:a,disabledFeedback:a,tooltipText:a?(0,o.jsx)(r().sA,{...h().AY.cannotDeleteBlockTooltip}):void 0})})},action:async(e,t,o)=>{let{blocks:i,environment:s}=t;await n(164186).Af({environment:s,blocks:i,shouldCheckSuggestEdit:!1,callback:e})}}),M=(0,h().Ls)({key:"leave shared page",displayName:y.leaveName,analyticsName:y.leaveName.defaultMessage,svg:n(867911).k,validators:[d().p9k,d().zq3],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;a().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,canUndo:!0,perform:e=>{u().leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),A=(0,h().uk)({key:"duplicate to workspace",displayName:y.duplicateToName,analyticsName:y.duplicateToName.defaultMessage,svg:n(235180).V,validators:[d()._fc,d().PaP,d().Km9,d().AU6(d().MIU),d().aAU],subActions:e=>{let{blocks:t,environment:i}=e;const{currentUserRootStore:s}=m().default.state;if(!s)return[];const r=t[0],a=n(782422).jU(s),d=[];for(const l of a){const e=l.getSpaceStore();if(e){const t=(0,c().GK)(i,e),s=(0,c().c2)(i,e);d.push({key:l.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await n(149078).w7({environment:i,store:r,spaceStore:e,spaceViewStore:l,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,i)=>{let{environment:r}=i;return(0,o.jsx)(n(535906).A,{title:t,icon:(0,o.jsx)(n(28210).B,{icon:s,isEmptyPage:!1,title:t,size:r.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,h().gy)({key:"duplicate-to",render:e=>(0,o.jsx)(l().A,{...e}),actions:d})]}}),w=[n(327509).LQ,{key:"outliner organization actions",render:e=>(0,o.jsx)(l().A,{...e}),actions:[p()._J,p().wy,b,M]},{key:"outliner available offline action",render:e=>(0,o.jsx)(l().A,{...e}),actions:[n(895269).Z]},{key:"outliner primary actions",render:e=>(0,o.jsx)(l().A,{...e}),actions:[g().ko,g().oc,p().O5,p().tA,f().As,f().nK,f().J8,f().lb,A,x,n(395338).U,n(85924).t,S]},{key:"turn page into",render:e=>(0,o.jsx)(l().A,{...e}),actions:[v().zk,v().wm,v().Js]},{key:"outliner navigation",render:e=>(0,o.jsx)(l().A,{...e}),actions:n(550726).YO}]},806514:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(242343),i=()=>n(158247),s=()=>n(803290),r=()=>n(174114),a=()=>n(716605),l=()=>n(882746),d=()=>n(653998),c=()=>n(31448),u=()=>n(154131),m=()=>n(932322),p=()=>n(35462),g=()=>n(73631),f=()=>n(782422),h=()=>n(477784),v=()=>n(807978),y=()=>n(485966),b=()=>n(56576),x=()=>n(990910),S=()=>n(991708),M=()=>n(695387),A=()=>n(747459),w=()=>n(416956),k=()=>n(729932),j=()=>n(78906),C=()=>n(591246),I=n(163643);function T(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:T,shouldShowBottomDividerLine:_,shouldExpandDiscussionWidth:P,noBackgroundColors:B,onMouseEnter:R,onMouseLeave:L,onFocus:D,onBlur:N}=e,O=(0,s().O$)(y().AppStoreMainEditorCurrentBlockStore),E=(0,s().K8)((()=>(0,f()._m)(t)),[t]),U=x().eQ,F=(0,s().K8)((()=>M().A.state.isActivelyComposing),[]),K=(0,s().K8)((()=>M().A.state.isHovered),[]),V=(0,o.useCallback)((()=>{null==R||R()}),[R]),z=(0,o.useCallback)((()=>{null==L||L()}),[L]),W=(0,o.useCallback)((()=>{null==D||D()}),[D]),H=(0,o.useCallback)((()=>{A().A.hasContent()?M().A.resetAllActiveSources():(A().A.reset(),M().A.reset()),null==N||N()}),[N]),G=(0,d().tz)(),Y=(0,o.useRef)(null);(0,i().b)(v().A,(()=>({getNode:()=>Y.current})),[]);const q=(0,r().IS)((e=>({menuDiscussionItem:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:t.device.isMobile?4:6,borderTop:!t.device.isMobile&&T?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!t.device.isMobile&&_?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:B?void 0:F?e.focusDiscussionBackground:K?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:x().FB},avatar:{marginTop:0,marginRight:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},commentAuthorPlaceholder:{marginRight:8,marginTop:2,height:U,width:U,borderRadius:20,flexShrink:0},container:{paddingTop:x().e4,paddingRight:16,paddingBottom:x().Wv,paddingLeft:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:c().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[U,t.device.isMobile,K,F,B,_,T]),$=(0,o.useCallback)((async()=>{const e=await g().T.formulas.load();b().i5({environment:t,allowActionsWhileCommenting:!0,formulasModule:e})}),[t]),Q=(0,s().K8)((()=>!A().A.state.open||"reaction"===A().A.state.content),[]),Z=(0,s().K8)((()=>{var e;return A().A.getBlockStore()??(null===(e=A().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),X=(0,s().K8)((()=>A().A.getPropertyId()),[]),J=(0,s().K8)((()=>{if(X){var e;const t=null===(e=A().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,a()._g)({schema:n,property:X})}}),[X]),ee=(0,s().K8)((()=>(0,l().RX)(h().A.getIntl()).title),[]),te=(0,s().O$)(A().f),ne=(0,s().K8)((()=>null==E?void 0:E.getDisplayName(G)),[E,G]),oe=(0,s().K8)((()=>null==Z?void 0:Z.getSpaceId()),[Z]),ie=(0,s().K8)((()=>b().Ek({environment:t})),[t]),se=(0,s().K8)((()=>A().A.getType()),[]),re=(0,s().K8)((()=>null==Z?void 0:Z.getValue()),[Z]);if(Q||!ee||!E||!Z||!O||!te||!oe||!re&&"block"===se||!ie&&"inline"===se)return null;const ae="inline"===se||X,le="block"===se&&!X?(0,I.jsx)(u().Ay,{blockValue:re,rootStore:Z,blockPreviewLocation:"comments_sidebar"}):ae?(0,I.jsx)(u().vY,{value:{value:(null==ie?void 0:ie.context)??[],spaceId:oe},propertySchema:ee,labeled:!1,rootStore:Z,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,I.jsx)("div",{style:q.discussionContainer,ref:Y,onClick:null==n?void 0:n.onClick,onMouseEnter:V,onMouseLeave:z,children:(0,I.jsx)(m().Ay,{allowTextSelection:!0,style:q.menuDiscussionItem,title:(0,I.jsx)("div",{style:q.container,children:(0,I.jsxs)("div",{style:q.comment,children:[(0,I.jsxs)("div",{style:q.userRow,children:[(0,I.jsx)(w().E,{authorStore:E,avatarSize:U,avatarStyle:q.avatar,placeholderStyle:q.commentAuthorPlaceholder}),(0,I.jsxs)("div",{style:q.noOverflow,children:[(0,I.jsx)("span",{style:q.displayName,children:ne||(0,I.jsx)("span",{style:q.placeholder})}),(0,I.jsx)(p().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:q.draftLabel,children:(0,I.jsx)(d().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,I.jsxs)("div",{style:q.commentElementsBelowUserRow,children:[(0,I.jsx)("div",{style:q.commentContext,children:(0,I.jsxs)("div",{style:q.fullWidthFlex,children:[(0,I.jsx)(k().T,{}),J&&(0,I.jsx)(C().A,{propertySchema:J}),(0,I.jsx)("div",{style:q.smallTopPadding,children:le})]})}),(0,I.jsx)(j().A,{showAvatar:!1,parentStore:O,blockStore:Z,onSubmit:$,discussionInputStore:te,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:S().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:P,dontMoveCursorToInputEndOnFocus:!0,onBlur:H,onFocus:W},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},806921:(e,t,n)=>{n.d(t,{A:()=>l});n(242343);var o=()=>n(748267),i=()=>n(653998),s=()=>n(103151),r=()=>n(907721),a=n(163643);function l(e){let{iconStyle:t}=e;return(0,a.jsx)(s().A,{textWrap:!0,style:{width:210},placement:r().W.Bottom,renderTooltip:()=>(0,a.jsx)(i().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,a.jsx)("div",{...e,children:(0,o().g)(t)})})}},810504:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>re});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(65866),l=()=>n(653998),d=()=>n(477146),c=(n(403517),()=>n(83544)),u=n(163643);const m=(0,n(680369).wt)("drawing",{viewBox:"0 0 12 12",svg:(0,u.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})});var p=()=>n(174845),g=()=>n(31448),f=()=>n(477784),h=()=>n(447425),v=()=>n(620604),y=()=>n(516267),b=()=>n(279150),x=()=>n(35462);const S=(0,l().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),M=[{icon:"📅",taskName:f().A.formatMessage(S.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,p().Q)({width:13,fill:"#448361"})},{icon:"📚",taskName:f().A.formatMessage(S.dummyTask2),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:f().A.formatMessage(S.dummyTask3),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:f().A.formatMessage(S.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,p().Q)({width:13,fill:"#448361"})},{icon:"🚧",taskName:f().A.formatMessage(S.dummyTask5),status:"Not Started",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:f().A.formatMessage(S.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,p().Q)({width:13,fill:"#448361"})}],A={Blocked:"red","In Progress":"blue","Not Started":"gray"};function w(){const e=C();return(0,u.jsx)(h().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,u.jsx)("div",{style:{paddingLeft:4},children:(0,u.jsx)(y().A,{type:"app_package_asset",size:18,icon:c().A.images.appPackages.taskDbIconSvg})}),children:(0,u.jsx)("div",{style:e.dummyAssignedToMe,children:(0,u.jsx)(k,{})})})}function k(){const e=M.map(((e,t)=>(0,u.jsx)(j,{row:e},t)));return(0,u.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function j(e){let{row:t}=e;const n=C();return(0,u.jsxs)("div",{style:n.eachTask,children:[(0,u.jsxs)("div",{style:n.taskName,children:[(0,u.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,u.jsx)(x().A,{style:n.taskTitle,children:t.taskName})]}),(0,u.jsx)("div",{style:n.taskStatus,children:(0,u.jsx)(v().X,{type:"status",value:f().A.formatMessage(S[t.status]),color:A[t.status],groupColor:void 0})}),(0,u.jsx)(b().A,{size:8}),(0,u.jsxs)("div",{style:n.location,children:[(0,u.jsx)("span",{style:n.locationIndicator,children:f().A.formatMessage(S.locationIndicator)}),(0,u.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function C(){return(0,r().IS)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...g().RC},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.text.primary,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.text.secondary,marginRight:4,maxWidth:48,...g().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(725707),n(491955),n(771702),n(113085);var I=()=>n(712437),T=()=>n(604657),_=()=>n(916963),P=()=>n(198654),B=()=>n(339189),R=()=>n(220413),L=()=>n(909680),D=()=>n(575015),N=()=>n(84543),O=()=>n(190717),E=()=>n(414997),U=()=>n(283759),F=()=>n(982415),K=()=>n(460830),V=()=>n(640979),z=()=>n(520969),W=()=>n(755769),H=()=>n(427846),G=()=>n(780942),Y=()=>n(535906),q=()=>n(273520),$=()=>n(935091),Q=()=>n(858023),Z=()=>n(951540),X=()=>n(88271),J=()=>n(487966);function ee(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,m=(0,i().v3)(),p=(0,l().tz)(),{isPhone:g,isMobileNative:f}=(0,i().Y0)(),h=(0,s().K8)((()=>g&&f),[g,f]),v=function(e){return(0,r().IS)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.text.secondary,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:R().Ay.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.text.tertiary},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.text.tertiary},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.text.tertiary}})),[e])}(g),y=(0,r().DP)(),[S,M]=(0,o.useState)(!1),A=(0,s().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),w=(0,s().K8)((()=>U().YH((0,E().appConfigs)(),n)),[n]),k=(0,s().K8)((()=>{if(A&&w)return U().DH(w,A)}),[w,A]),j=(0,o.useCallback)(((e,t)=>{const n=t.type;return U().Kb(e,t,A??{}).map((e=>{let[t,o]=e;return{key:t,title:null==o?void 0:o.name,icon:(0,u.jsx)(_().zB,{size:16,style:v.propertyIcon,theme:y,icon:null==o?void 0:o.icon,type:(null==o?void 0:o.type)||n})}}))}),[y,v.propertyIcon,A]),C=(0,s().K8)((()=>{const e=Object.keys(w||{}).filter((e=>void 0!==(null==w?void 0:w[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(w||{}).forEach((e=>{let[n,o]=e;if(!o)return;const i=null==k?void 0:k[n];if(i)return void(t[n]=i);0===j(n,o).length&&(t[n]=T().Ul)})),t}),[w,k,j]),[ee,oe]=(0,o.useState)(C),ie=(0,o.useMemo)((()=>Object.entries(ee).some((e=>{let[t,n]=e;if(t===a().yx.Status){const e=null==A?void 0:A[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[A,ee]),se=(0,o.useCallback)((e=>{const t=null==w?void 0:w[e],n={width:16,height:16,marginRight:10};if(!t)return null;const o=[...j(e,t),{key:T().Ul,title:p.formatMessage(te.createNew),icon:(0,B().W)({width:n.width,fill:v.propertyIcon.fill}),type:void 0}],i=ee[e],s=null==A?void 0:A[i||""],r=!i&&S,d=e===a().yx.Status;let c=null;return i===T().Ul?c=(0,B().W)(n):s&&(c=_().LE[null==s?void 0:s.type](n)),(0,u.jsx)(q().Ay,{popupType:g?q().z7.SlideUp:q().z7.Popup,renderOrigin:t=>(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)(x().A,{isMultiline:!0,style:v.perPropertyInstruction,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:p.formatMessage(ne[e])}})}),(0,u.jsx)(Y().A,{disabled:1===o.length,disabledFeedback:!0,focused:!1,right:(0,u.jsxs)("div",{style:v.propertyMappingDropdown,children:[r?(0,u.jsx)("span",{style:v.requiredPropertyError,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,P().b)({...v.chevronDownIconEnabled,...r?{fill:R().Ay.red}:{}})]}),rightStyle:{marginRight:g?14:8},title:(0,u.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,i===T().Ul?p.formatMessage(te.createNew):s?s.name:p.formatMessage(te.select)]}),titleStyle:i?{display:"flex",alignItems:"center"}:v.propertyMappingTitle,itemMarginLeft:8,style:{...v.propertyMappingMenu,...r?{borderColor:R().Ay.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ie&&(0,u.jsx)(x().A,{isSmall:!0,isMultiline:!0,children:(0,u.jsx)("div",{style:v.propertyConversionCallout,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:W().UV.Bottom,alignmentToOrigin:W().MY.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,u.jsx)(X().A,{...e,topBorder:0!==e.index}),items:o.map((n=>{const o={key:n.key,render:t=>(0,u.jsx)(Y().A,{...t,icon:n.icon,title:n.title,isChecked:ee[e]===n.key}),action:()=>{oe({...ee,[e]:n.key}),M(!1),t.close()}};return o}))}],i=g?{menuType:V().gu.ActionSheet}:{menuType:V().gu.Popup,width:250};return(0,u.jsx)($().A,{...i,children:(0,u.jsx)(Q().Ay,{type:Q().Oh.Vertical,initialFocus:void 0,sections:n})})}},e)}),[w,j,p,v,ee,A,S,ie,g]),re=(0,o.useCallback)((()=>{var e,o;const i=t.collectionStore(),s=t.collectionViewBlockStore();if(!i||!s)return;const r=(0,z().XH)("main"),c=null==r||null===(e=r.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==r?void 0:r.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast}),g=(0,z().XH)("myTasks"),f=null==g||null===(o=g.getModel())||void 0===o?void 0:o.getRenderUrl({getRecordModel:null==g?void 0:g.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(ee)?M(!0):N().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:m,canUndo:!0,perform:e=>{O().bC({environment:m,collectionViewBlockStore:s,collectionStore:i,databaseType:n,propertyMapping:{...ee},typedPropertySchemas:{...w},transaction:e}),d().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===a().dC&&(K().e.locallyMutatedTasksDatabase=!0),(0,L().Y)({environment:m,database_type:n,property_mapping:ee,collectionContextStore:t});const o=h?(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,F().$O)(n),databaseName:i.getName()||p.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:v.a,href:f,children:e})}}):(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,F().$O)(n),databaseName:i.getName()||p.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:v.a,href:c,children:e})}});D().rL({item:{label:o,durationMs:H().LX},undoFunc:()=>{N().createAndCommit({environment:m,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{O().Fr({environment:m,collectionContextStore:t,transaction:e})}})}})}})}),[t,ee,m,n,w,h,p,v.a]);return(0,u.jsxs)("div",{style:c,children:[(0,u.jsxs)("div",{style:v.formTitle,children:[g?(0,u.jsx)("span",{style:v.emojiTitle,children:"📋"}):null,(0,u.jsx)(x().A,{style:v.propertyMappingInstructions,isMultiline:!0,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),g?(0,u.jsx)(b().A,{size:16}):null,Object.entries(C).map((e=>{let[t,n]=e;return se(t)})),(0,u.jsxs)("div",{style:v.buttons,children:[(0,u.jsx)(Z().A,{style:v.submitMigrationButton,onClick:re,children:(0,u.jsx)(l().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,F().$O)(n)}})}),g?(0,u.jsx)(G().p,{style:v.closeButton,onClick:()=>d().A.reset(),children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,u.jsx)(J().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,F().$O)(n)}}),analyticsFrom:"set_database_type",href:z().hI,style:v.learnMore,buttonStyle:v.learnMoreButton})]})]})}const te=(0,l().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SelectFieldPlaceholder",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ne={[a().yx.Status]:te.taskStatus,[a().yx.Assign]:te.taskAssignee,[a().yx.DueDate]:te.taskDueDate};var oe=()=>n(922172),ie=()=>n(729201);const se=32;function re(){const e=ce(),t=(0,i().Y0)(),n=(0,s().O$)(d().A);return n.isModalOpen?t.isPhone?(0,u.jsx)(ie()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,u.jsx)(de,{collectionContextStore:n.collectionContextStore})}):(0,u.jsx)(oe().a,{open:!0,onDismiss:()=>d().A.reset(),innerStyle:e.desktopInner,render:()=>(0,u.jsx)(le,{collectionContextStore:n.collectionContextStore})}):null}const ae=450;function le(e){const t=ce();return(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,u.jsxs)("div",{style:t.title,children:[(0,u.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,u.jsx)(x().A,{isMultiline:!0,style:t.previewTitle,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,u.jsx)(b().A,{size:36}),(0,u.jsx)(w,{}),(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:a().dC,containerStyle:t.form})]})}function de(e){const t=ce();return(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:a().dC,containerStyle:t.phoneForm})}function ce(){return(0,r().IS)((e=>({desktopInner:{width:768,height:ae,padding:se},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.text.primary,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:ae,background:e.surface.wash,position:"absolute",top:-se,right:-se,padding:se,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:se}})),[])}},810813:(e,t,n)=>{n.d(t,{p:()=>s});var o=()=>n(84543),i=()=>n(702851);function s(e){const{environment:t,collectionStore:n,performTransaction:s}=e;return o().createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,canUndo:!0,perform:e=>{const o=n.getSchema(),r=s(e),a=n.getSchema();return(0,i().H)({environment:t,collectionStore:n,oldSchema:o,newSchema:a,transaction:e}),r}}).performResult}},811130:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(242343);var o=()=>n(237385),i=()=>n(803290),s=()=>n(174114),r=()=>n(83544),a=()=>n(653998),l=()=>n(31448),d=()=>n(336519),c=()=>n(551116),u=()=>n(511875),m=()=>n(209684),p=()=>n(922172),g=()=>n(951540),f=n(163643);function h(){const e=(0,o().Y0)(),t=(0,i().K8)((()=>u().A.state.open),[]),n=()=>{u().A.state.open&&u().A.state.onDecline&&u().A.state.onDecline(),u().A.setState({open:!1})},h=()=>{u().A.state.open&&u().A.state.onConfirm(),u().A.setState({open:!1})},v=()=>{n(),d().Ow({currentTab:"connected_apps"})},y=(0,s().IS)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l().Wy.medium,marginTop:15,marginBottom:20,color:e.text.secondary}})),[]);return(0,f.jsx)(p().a,{open:t,innerStyle:y.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsxs)("div",{style:y.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r().A.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(a().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(a().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(g().A,{size:"lg",onClick:h,children:(0,f.jsx)(a().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:c().A.vertical.tiny},children:(0,f.jsx)(m().p,{isGray:!0,size:"xs",showUnderline:!0,onClick:v,children:(0,f.jsx)(a().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]}),onDismiss:n})}},820994:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(951592),l=n(163643);const d=(0,n(680369).wt)("appDownload",{viewBox:"0 0 23 16",svg:(0,l.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var c=()=>n(81322),u=()=>n(545250),m=()=>n(653998),p=()=>n(31448),g=()=>n(362756),f=()=>n(818369),h=()=>n(865226),v=()=>n(28416),y=()=>n(189812),b=()=>n(842617),x=()=>n(601178),S=()=>n(907721),M=()=>n(485966),A=()=>n(84675),w=()=>n(209684),k=()=>n(559637),j=()=>n(356813),C=()=>n(579494),I=()=>n(443252),T=()=>n(951540),_=()=>n(35462);function P(){const e=(0,i().v3)(),t=(0,m().tz)(),[n,P]=(0,o.useState)(!0),{isDesktopBrowser:B,os:R}=(0,i().Y0)(),L=(0,s().K8)((()=>e.RouterStore.state.route.name in u().b1),[e]),D=(0,s().K8)((()=>M().default.state.inAppCalloutStore),[]),N=(0,s().K8)((()=>D.getCalloutVisibility("desktop_preference_popup").canShow),[D]),O=e.currentUser.isLoggedIn(),E=(0,s().O$)(A().A),[U,F]=(0,o.useState)(!1),K=(0,s().K8)((()=>A().A.canPersistToLocalStorage()),[]),V=!U&&O&&void 0===E&&B&&("mac"===R||"windows"===R)&&L&&K&&N,[z,W]=(0,o.useState)(!1),H=V&&z,G=(0,o.useRef)(!1);(0,o.useEffect)((()=>{V&&!G.current&&(async function(e,t){const n=await f().callApi({eventName:"getDesktopAppRegistration",environment:e,data:{os:t}});return"data"in n&&n.data.isRegistered}(e,R).then((e=>{W(e)})),G.current=!0)}),[V,W,e,R]);const Y=(0,a().ZC)(H);(0,o.useEffect)((()=>{H&&!Y&&(g()._g(e),D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[H,Y,e,D]);const q=(0,b().n_)(),$=(0,y().E)(),Q=(0,r().IS)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:p().Wy.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,l.jsx)(I().Ay,{popupType:I().nl.Popup,placementToOrigin:S().W.Bottom,alignmentToOrigin:S().C.Center,origin:(0,l.jsx)("div",{style:Q.origin}),originGap:q?-x().ls/2:0,disableMouseCapture:!0,open:H,style:Q.container,render:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:Q.header,children:[(0,l.jsx)(_().A,{style:Q.headerText,children:(0,l.jsx)(m().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,l.jsx)(j().A,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c().V,onClick:()=>{A().A.setState("never"),F(!0),g().e1(e)}})]}),(0,l.jsx)(C().A,{external:!0,onClick:()=>{$.current&&(h().oo({environment:e,url:$.current,openInNew:"tab"}),g().co(e))},children:(0,l.jsxs)(w().p,{isGray:!0,size:"xs",style:Q.appDownloadButton,children:[d(Q.appDownloadIcon),(0,l.jsx)("span",{children:(0,l.jsx)(m().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,l.jsxs)("div",{style:Q.actions,children:[(0,l.jsxs)("div",{style:Q.alwaysOpenLinks,children:[(0,l.jsx)(k().A,{checked:n,size:16,onClick:()=>{P(!n)}}),(0,l.jsx)(_().A,{isInline:!0,style:Q.alwaysOpenLinksLabel,children:(0,l.jsx)(m().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]}),(0,l.jsx)(T().A,{style:Q.alwaysOpenLinksButton,onClick:()=>{A().A.setState(n?"always":"never"),F(!0),h().eG({url:(0,v().P)(window.location.href),environment:e}),g().SS(e,{always_open_in_app:n})},children:(0,l.jsx)(m().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},823519:(e,t,n)=>{n.d(t,{a:()=>p});var o=n(242343),i=()=>n(174114),s=()=>n(76394),r=()=>n(31448),a=()=>n(421338),l=()=>n(152058),d=()=>n(755002),c=n(163643);function u(e){const{disabled:t,checked:n,selectorSize:o}=e,[s,r]=(0,l().A)(),a=function(e){const{checked:t,disabled:n,isFocusVisible:o,selectorSize:s}=e;return(0,i().IS)((e=>({root:{position:"absolute",display:"flex",width:15,height:15,padding:5,margin:1.5,justifyContent:"center",alignItems:"center",gap:8,flexShrink:0,borderRadius:"50%",transition:"background 100ms ease-out",...t?{boxShadow:`0 0 0 1.5px ${n?e.tint.regular:e.blueColor}`,background:n?e.tint.regular:e.blueColor}:{boxShadow:`0 0 0 1.5px ${n?e.icon.quaternary:e.stroke.input}`,background:e.surface.page},...o&&{boxShadow:e.outlineBlueInputBoxShadow}},active:{background:t?e.blueButtonPressedBackground:e.buttonHoveredBackground},input:{opacity:0,width:"small"===s?14:18,height:"small"===s?14:18,...n?{pointerEvents:"none"}:{cursor:"pointer"}}})),[t,n,o,s])}({checked:n,disabled:t,isFocusVisible:r,selectorSize:o});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{ref:s,type:"radio",style:a.input,className:"radio-button",...e}),(0,c.jsx)("span",{...(0,d().AH)("custom-radio-button",a.root,t?{}:{pseudoActive:a.active})})]})}var m=()=>n(701270);const p=o.forwardRef((function(e,t){let{additionalContent:n,description:s,isDisabled:l,isSelected:d,label:u,name:m,onChange:p,width:h="fill",selectorSize:v="normal",selectAlignXAxis:y="left",selectAlignYAxis:b="center",selectType:x="checkbox",style:S,supportText:M,value:A,colorName:w,alignAdditionalContent:k,...j}=e;const C=(0,o.useId)(),I=function(e){const{isSelected:t,isDisabled:n,selectAlignYAxis:o,alignAdditionalContent:s}=e;return(0,i().IS)((e=>{const i=t&&!n?e.blueColor:e.selectorBorderUnselected;return{container:{display:"flex",alignItems:s??"center",gap:12,userSelect:"none",padding:"9px 16px 10px 10px",borderRadius:6,border:`1px solid ${i}`,...!n&&{cursor:"pointer"}},title:{fontWeight:r().Wy.medium,fontSize:14,userSelect:"none",lineHeight:18},additionalContentWrapper:{flexShrink:0},selectorWrapper:{display:"flex",..."top"===o?{marginTop:2}:{}},rightAlignSelectorWrapper:{display:"flex"}}}),[t,n,o,s])}({isSelected:d,isDisabled:l,selectAlignYAxis:b,alignAdditionalContent:k}),T=(0,c.jsxs)(a().Y1,{direction:"horizontal",align:"top"===b?"top-left":"center-left",gap:12,width:h,children:[(0,c.jsx)("div",{style:I.selectorWrapper,children:(0,c.jsx)(f,{id:C,selectType:x,name:m,value:A,onChange:p,isSelected:d,selectorSize:v,isDisabled:l,...j})}),(0,c.jsx)(g,{colorName:w,description:s,label:u,selectorSize:v,supportText:M,isDisabled:l})]}),_=(0,c.jsxs)(a().Y1,{direction:"horizontal",align:"top"===b?"top-center":"center",gap:12,children:[(0,c.jsx)(g,{colorName:w,description:s,label:u,selectorSize:v,supportText:M,isDisabled:l}),(0,c.jsx)("div",{style:{...I.selectorWrapper,...I.rightAlignSelectorWrapper},children:(0,c.jsx)(f,{id:C,selectType:x,name:m,value:A,onChange:p,selectorSize:v,isSelected:d,isDisabled:l,...j})})]}),P=n?(0,c.jsx)("div",{style:I.additionalContentWrapper,children:n}):null;return(0,c.jsx)("label",{ref:t,style:{...I.container,...S},htmlFor:C,children:"left"===y?(0,c.jsxs)(c.Fragment,{children:[T,P]}):(0,c.jsxs)(c.Fragment,{children:[P,_]})})}));function g(e){const{description:t,label:n,supportText:o,selectorSize:i,isDisabled:r,colorName:l}=e;let d;return"large"===i?d="Page-Content/Text-Block":"normal"===i||void 0===i?d="Body-13px/Medium":"small"===i?d="Body-12px/Regular":(0,s().HB)(i),(0,c.jsxs)(a().Y1,{gap:4,children:[(0,c.jsxs)(a().Y1,{gap:2,children:[(0,c.jsx)(m().D,{styleName:d,colorName:l||(r?"quaternary":"primary"),children:n}),t?(0,c.jsx)(m().D,{styleName:"Caption-12px/Regular",colorName:r?"quaternary":"secondary",children:t}):null]}),o?(0,c.jsx)(m().D,{styleName:"Caption-12px/Medium",colorName:"tertiary",children:o}):null]})}function f(e){const{selectType:t,selectorSize:o="normal",id:r,name:a,value:l,onChange:d,isSelected:m,isDisabled:p,...g}=e,f=(0,i().IS)((()=>({checkboxWrapper:{minWidth:18,display:"flex",justifyContent:"center"}})),[]);switch(t){case"radio":return(0,c.jsx)(u,{id:r,name:a,value:l,onChange:d,checked:m,disabled:p,selectorSize:o,...g});case"checkbox":return(0,c.jsx)("div",{style:f.checkboxWrapper,children:(0,c.jsx)(n(830025).W,{id:r,name:a,value:l,onChange:d,checked:m,disabled:p,selectorSize:o,...g})});default:(0,s().HB)(t)}}},826403:(e,t,n)=>{n.d(t,{M:()=>s});n(242343);var o=n(163643);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M8.5 9.31a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"}),(0,o.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125h-11a2.125 2.125 0 0 1-2.125-2.125zM4.5 5.375a.875.875 0 0 0-.875.875v5.491l1.996-1.995a.625.625 0 0 1 .883 0l1.98 1.98 4.137-4.137a.625.625 0 0 1 .883 0l2.871 2.87V6.25a.875.875 0 0 0-.875-.875zm11.875 6.852-3.312-3.312-4.137 4.136a.625.625 0 0 1-.884 0l-1.98-1.98-2.437 2.438v.241c0 .483.392.875.875.875h11a.875.875 0 0 0 .875-.875z"})]})},s=(0,n(680369).wt)("photo",i)},830025:(e,t,n)=>{n.d(t,{W:()=>l});n(242343);var o=()=>n(152058),i=()=>n(174114),s=()=>n(755002),r=()=>n(96144),a=n(163643);function l(e){const{selectorSize:t="normal",...n}=e,{disabled:l,checked:d}=n,[c,u]=(0,o().A)(),m=function(e){const{checked:t,disabled:n,isFocusVisible:o,selectorSize:s}=e;return(0,i().IS)((e=>({root:{position:"absolute",display:"flex",width:"large"===s?15:11,height:"large"===s?15:11,margin:1.5,justifyContent:"center",alignItems:"center",flexShrink:0,borderRadius:"large"===s?2:1,transition:"background 100ms ease-out",...t?{boxShadow:`0 0 0 1.5px ${n?e.tint.regular:e.blueColor}`,background:n?e.tint.regular:e.blueColor}:{boxShadow:`0 0 0 1.5px ${n?e.icon.quaternary:e.stroke.input}`,background:e.surface.page},...o&&{boxShadow:e.outlineBlueInputBoxShadow}},active:{background:t?e.blueButtonPressedBackground:e.buttonHoveredBackground},input:{opacity:0,width:"large"===s?18:void 0,height:"large"===s?18:void 0,...n?{pointerEvents:"none"}:{cursor:"pointer"}},icon:{color:e.text.contrastPrimary,width:"large"===s?12:10,height:"large"===s?12:10,ariaHidden:!0}})),[s,t,n,o])}({checked:d,disabled:l,selectorSize:t,isFocusVisible:u});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{ref:c,type:"checkbox",style:m.input,...n}),(0,a.jsx)("span",{...(0,s().AH)(m.root,l?{}:{pseudoActive:m.active}),children:d&&(0,r().R)(m.icon)})]})}},840380:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>be});var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(83544),l=()=>n(653998),d=()=>n(76394),c=()=>n(836880),u=()=>n(528643),m=()=>n(441288),p=()=>n(235843),g=()=>n(861095),f=()=>n(360482),h=()=>n(863969),v=()=>n(269280),y=()=>n(983050),b=()=>n(104838),x=()=>n(951540),S=()=>n(138385),M=n(163643);const A=function(e){const{permissionsInviteStore:t,onInviteClick:r,inviteOrigin:a,sudoModeStore:d}=e,c=(0,i().v3)(),u=(0,l().tz)(),m=(0,n(997310).r)(),[g,f]=(0,o.useState)(!1),h=(0,s().uB)(void 0,S().Ay),v=(0,s().K8)((()=>t.state.inviteTargets.length>0),[t]),y=(0,o.useCallback)((e=>{e||n(575015).D6({label:(0,M.jsx)(l().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[]),b=(0,o.useCallback)((async()=>{if(m){f(!0);try{await p().kW({environment:c,store:m,sudoModeStore:d,permissionsInviteStore:t,contextualInviteStore:h,onInviteClick:r,onInviteComplete:y,inviteOrigin:a,intl:u})}catch(e){}finally{f(!1)}}}),[h,c,u,a,r,t,m,d,y]);return(0,M.jsx)(x().A,{onClick:b,disabled:!v||g,children:(0,M.jsx)(l().sA,{id:"spacePermissionsInviteButton.label",defaultMessage:"Send invite"})})};var w=()=>n(701270),k=()=>n(764227);const j=function(e){const{permissionsInviteStore:t}=e,i=(0,s().K8)((()=>(0,k().dL)()),[]),a=(0,o.useCallback)((()=>{t.reset()}),[t]),d=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between"}})),[]);return(0,M.jsxs)("div",{style:d.container,children:[(0,M.jsxs)("div",{style:d.header,children:[(0,M.jsx)(w().D,{styleName:"Heading-17px/Semibold",children:(0,M.jsx)(l().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Invite members"})}),(0,M.jsx)(n(238107).A,{onClose:a})]}),(0,M.jsx)(n(35462).A,{isSecondaryColor:!0,isMultiline:!0,children:i?(0,M.jsx)(l().sA,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}):(0,M.jsx)(l().sA,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."})})]})};n(362833),n(403517);var C=()=>n(198654),I=()=>n(535906),T=()=>n(273520),_=()=>n(935091),P=()=>n(858023),B=()=>n(443252),R=()=>n(88271),L=()=>n(758103),D=()=>n(84979),N=()=>n(640979),O=()=>n(906230),E=()=>n(352723),U=()=>n(907721),F=()=>n(943066),K=()=>n(879759),V=()=>n(111826);function z(e){const{permissionsInviteStore:t}=e,n=(0,i().v3)(),a=(0,s().K8)((()=>{const e=(0,k().AI)();return(0,V().fk)(e)}),[]);(0,v().l)((()=>{a||t.setState({...t.state,isInviteTargetsEmpty:!0,inviteTargets:[],inviteRole:"read_and_write"})}));const d=(0,s().K8)((()=>t.state.inviteRole?t.state.inviteRole:a?"editor":"read_and_write"),[a,t]),c=(0,s().K8)((()=>{const e=["editor"];return(0,E().Qu)()&&e.push("membership_admin"),a||e.push("read_and_write"),e}),[a]),u=(0,o.useCallback)((e=>{p().lf({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),m=(0,r().IS)((e=>({menuItem:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},dropdownButton:{display:"flex",minHeight:34,margin:0,width:"100%"},dropdownButtonContent:{display:"flex",alignItems:"center"},selectedRole:{width:"100%",color:e.text.secondary},downIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function g(e){const t=c.map((t=>({key:t,render:e=>{const n=(0,L().R)({type:"space_permission",table:"space",role:t,isRemovable:!1,isCurrentUser:!1});return(0,M.jsx)(I().A,{title:(0,M.jsx)(l().sA,{...n.label}),caption:(0,M.jsx)(l().sA,{...n.caption}),shouldWrapCaption:!0,...e})},action:()=>{u(t),e.close()}})));return a&&t.push({key:"read_and_write",render:e=>(0,M.jsx)(W,{menuListItemProps:e}),action:()=>{e.close()}}),t}return(0,M.jsx)(T().Ay,{popupType:B().nl.Popup,sameWidthAsOrigin:!0,render:e=>(0,M.jsx)(_().A,{menuType:N().gu.Popup,children:(0,M.jsx)(P().Ay,{type:P().Oh.Vertical,initialFocus:void 0,sections:[{key:"roles",render:e=>(0,M.jsx)(R().A,{...e}),items:g(e)}]})}),renderOrigin:e=>(0,M.jsx)(I().A,{style:m.menuItem,buttonStyle:m.dropdownButton,title:(0,M.jsxs)("div",{style:m.dropdownButtonContent,children:[(0,M.jsx)("div",{style:m.selectedRole,children:(0,M.jsx)(w().D,{styleName:"UIRegular-14px/Regular",children:(0,M.jsx)(l().sA,{...(0,L().R)({type:"space_permission",table:"space",role:d,isRemovable:!1,isCurrentUser:!1}).label})})}),(0,C().b)(m.downIcon)]}),focused:!1,...e})})}function W(e){let{menuListItemProps:t}=e;const n=(0,i().v3)(),s=(0,r().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleLabel:{marginRight:6}})),[]),d="space_permission_settings",c="plus",u=(0,o.useCallback)((()=>{(0,F().K)(n,{from:d,upsell:{type:"product",product:c,limit:{type:"none"},trialability:"none"}})}),[n]),m=(0,M.jsx)(D().A,{imageURL:a().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,M.jsx)(l().sA,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,M.jsx)(l().sA,{defaultMessage:"Upgrade to add non-admin members",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.title"})});return(0,M.jsx)(K().A,{requireUpgradeToTier:c,renderUpgradeTooltip:()=>m,analyticsName:d,tooltipPlacement:U().W.Left,render:(e,n)=>{const{focused:o,...i}=(0,O().A)(t,e),r=(0,L().R)({type:"space_permission",table:"space",role:"read_and_write",isRemovable:!1,isCurrentUser:!1});return(0,M.jsx)(I().A,{...i,title:(0,M.jsxs)("div",{style:s.titleContainer,children:[(0,M.jsx)("div",{style:s.titleLabel,children:(0,M.jsx)(l().sA,{...r.label})}),n]}),caption:(0,M.jsx)(l().sA,{...r.caption}),shouldWrapCaption:!0,focused:o})},onClick:u})}const H=function(e){const t=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8},roleText:{color:e.text.secondary}})),[]);return(0,M.jsxs)("div",{style:t.container,children:[(0,M.jsx)(w().D,{styleName:"UISmall-12px/Medium",customStyles:t.roleText,children:(0,M.jsx)(l().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Role"})}),(0,M.jsx)(z,{...e})]})};const G=function(e){const{inviteOrigin:t,onInviteClick:s,permissionsInviteStore:a}=e,l=(0,i().v3)();(0,v().l)((async()=>{await b().x(l)}));const d=(0,o.useCallback)((()=>{a.setState({...a.state,inputFocus:"none"})}),[a]),c=(0,r().IS)((()=>({container:{maxWidth:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"},footer:{display:"flex",justifyContent:"end"}})),[]);return(0,M.jsx)("div",{style:c.container,onClick:d,className:y().bFE,children:(0,M.jsx)(n(529305).tf,{header:(0,M.jsx)(j,{permissionsInviteStore:a}),footer:(0,M.jsx)("div",{style:c.footer,children:(0,M.jsx)(A,{inviteOrigin:t,onInviteClick:s,permissionsInviteStore:a})}),children:(0,M.jsxs)("div",{style:c.body,children:[(0,M.jsx)(n(361414).A,{permissionsInviteStore:a}),(0,M.jsx)(H,{permissionsInviteStore:a})]})})})};var Y=()=>n(284551),q=()=>n(196387),$=()=>n(784180),Q=()=>n(305043),Z=()=>n(433119),X=()=>n(220413),J=()=>n(975392),ee=()=>n(392608),te=()=>n(548694),ne=()=>n(714604),oe=()=>n(413871),ie=()=>n(159448),se=()=>n(797631),re=()=>n(951514),ae=()=>n(328547),le=()=>n(54852);function de(e){const{store:t,permissionsInviteStore:a,membersOnly:d,onUpgradeButtonClick:c,upgradeButtonName:u,inviteOrigin:m,onInviteClick:g}=e,h=(0,i().v3)();(0,v().l)((async()=>{await b().x(h)}));const x=(0,s().K8)((()=>(0,f().Yu)(t)),[t]),S=(0,o.useCallback)((async()=>{await p().iS({environment:h,permissionsInviteStore:a,from:"share_menu"})}),[h,a]),A=(0,r().IS)((()=>({right:{color:X().Ay.blue}})),[]);return(0,M.jsxs)(_().A,{menuType:N().gu.Modal,title:x?(0,M.jsx)(l().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,M.jsx)(l().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,M.jsx)("div",{style:A.right,children:(0,M.jsx)(l().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,M.jsx)(n(743668).CancelMenuText,{}),onClickLeft:S,onClickRight:g,header:(0,M.jsx)(ce,{...e,inviteOrigin:m,onInviteClick:g}),className:y().bFE,children:[(0,M.jsx)(R().A,{title:(0,M.jsx)(l().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,M.jsx)(pe,{store:t,onUpgradeButtonClick:c,upgradeButtonName:u,permissionsInviteStore:a})}),(0,M.jsx)("div",{children:(0,M.jsx)(ue,{store:t,permissionsInviteStore:a,membersOnly:d})}),(0,M.jsx)(me,{})]})}function ce(e){const{store:t,isSubscribed:n,onInviteClick:r,permissionsInviteStore:a,inviteOrigin:l}=e,d=(0,i().v3)(),c=(0,s().K8)((()=>g().LC({environment:d,store:t,isSubscribed:n})),[d,t,n]),m=(0,s().K8)((()=>{const e=a.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[a]),f=(0,h().O)(),v=(0,ie().lI)({spaceId:f}),y=(0,o.useMemo)((()=>J().sg((()=>{u().D2(d,{invite_flow_id:a.state.flowId,billingData:v,invite_origin:l})}),1e3)),[d,a,l,v]),b=(0,o.useCallback)((async e=>{y(),await p().Pp({environment:d,event:e,permissionsInviteStore:a})}),[y,d,a]),x=(0,o.useCallback)((e=>{p().St({targetToRemove:e,permissionsInviteStore:a,defaultRoleForNonBot:c})}),[c,a]);return(0,M.jsx)(ae().A,{permissionsInviteStore:a,store:t,handleClickRemoveToken:x,handleInputChange:b,handleInputSubmit:r,origin:"share_modal",defaultRoleForNonBot:c,focus:m,handleFocus:()=>{}})}function ue(e){const{store:t,permissionsInviteStore:n,membersOnly:o}=e,i=(0,s().K8)((()=>(0,f()._p)(t)),[t]),r=(0,s().K8)((()=>t instanceof oe().Bv&&(0,te().hN)(t.getSpaceStore())),[t]);return(0,M.jsx)(le().A,{permissionsInviteStore:n,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:i,shouldShowGroups:i,sectionRenderLimit:10,membersOnly:o,guestsMustBeRequested:r})}function me(){return(0,M.jsx)(R().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,M.jsx)(se().A,{title:(0,M.jsx)(l().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,ee().xS)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function pe(e){const t=(0,i().v3)(),{store:n,onUpgradeButtonClick:a,upgradeButtonName:l,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,s().K8)((()=>{const{inviteRole:e}=d.state;return{inviteRole:e,table:n.table}}),[d,n.table]),m=(0,s().K8)((()=>(0,ne().qs)(d.state)),[d]),g=(0,s().K8)((()=>(0,f()._p)(n)?n.getType():void 0),[n]),h=(0,s().K8)((()=>(0,f().Yu)(n)&&!n.canAdmin()),[n]),v=(0,o.useCallback)((e=>{p().lf({environment:t,newRole:e,permissionsInviteStore:d})}),[t,d]),y=(0,r().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:X().Ay.uiGray}})),[]);return m||!c?null:(0,M.jsx)(re().Ay,{disabled:h,role:c,table:u,type:"user_permission",blockType:g,isInvite:!0,onUpgradeButtonClick:a,upgradeButtonName:l,buttonStyle:y.button,isMenuItem:!0,onChange:v})}const ge=o.memo(de);var fe=()=>n(627717),he=()=>n(673411);function ve(e){const{store:t,origin:c,sudoModeStore:u,onInviteComplete:m,onInviteClick:v}=e,y=(0,i().v3)(),{isMobile:x}=y.device,A=(0,l().tz)(),w=(0,h().O)(),j=(0,n(898055).l)({spaceId:w}),C=(0,s().uB)(e.permissionsInviteStore,n(339838).A),I=(0,s().K8)((()=>C.state.modalOpen),[C]),T=e.analyticsFrom,_=(0,s().uB)(void 0,S().Ay),P=(0,o.useCallback)((async()=>{const e=q().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await p().kW({environment:y,store:t,sudoModeStore:u,permissionsInviteStore:C,contextualInviteStore:_,onInviteClick:v,onInviteComplete:m,inviteOrigin:T,intl:A}),q().default.DO_NOT_USE_measureLegacy(e,{environment:y})}),[y,t,u,C,_,v,m,T,A]);(0,o.useEffect)((()=>{I&&!(0,d().O9)(Q().subscriptionDataStoreInstance.state)&&b().x(y)}),[y,I]);const B=(0,s().K8)((()=>Boolean(t.canEditMembership())),[t]),R=(0,s().K8)((()=>B&&(0,f().Yu)(t)&&(0,d().O9)(Q().subscriptionDataStoreInstance.state)&&!k().El()),[B,t]),L=(0,s().K8)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:o}=e;if(!n&&(0,f().Yu)(t))return(0,M.jsx)(l().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,M.jsx)(l().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(o)return(0,M.jsx)(D().A,{imageURL:a().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,M.jsx)(l().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,M.jsx)(l().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:B,showUpgrade:R})),[B,R,t]),N=(0,o.useCallback)((()=>async function(e,t,n,o){const i=await(0,g().iQ)({environment:e,permissionsInviteStoreState:n.state,from:o??((0,f().Yu)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(y,t,C,e.analyticsFrom)),[y,t,C,e.analyticsFrom]),O=(0,o.useCallback)((()=>x?(0,M.jsx)(ge,{...e,onInviteClick:P,inviteOrigin:T,permissionsInviteStore:C,billingData:j}):(0,M.jsx)(G,{inviteOrigin:T,onInviteClick:P,permissionsInviteStore:C})),[x,e,P,T,C,j]),E=(0,r().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,f().Yu)(t)?(0,M.jsx)(Z().A,{open:I,onDismiss:N,renderContent:O,modalStyle:E.modal,origin:(0,M.jsx)(n(103151).A,{renderTooltip:()=>L,disableTooltip:B,render:t=>(0,M.jsx)(ye,{permissionsInviteStore:C,tooltipEvents:t,actionEnabled:B,showUpgrade:R,buttonInner:c,...e,...t})})}):(0,M.jsx)(Z().A,{open:I,onDismiss:N,renderContent:O,origin:null})}function ye(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:a,store:d,isSubscribed:p,enableInviteDropdown:f,onInviteClick:h,onInviteComplete:v,upgradeButtonName:y,onUpgradeButtonClick:b,shouldGrow:S,buttonStyle:A,permissionsInviteStore:w,buttonInner:k}=e;const j=(0,i().v3)(),C=(0,s().K8)((()=>$().F.getState().forceImportDropdownOpen),[]),I=(0,r().IS)((()=>({dropdownButton:{flex:S?1:0,...A},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[A,S]),_=(0,o.useCallback)((()=>function(e,t,n,o){(0,g().LH)({environment:e,permissionsInviteStore:o,store:t,renderInShareModal:!1,isSubscribed:n}),m().CW(e,{type:"invite"}),u().vX(e,{type:"invite",from:"settings_modal"})}(j,d,p,w)),[j,d,p,w]),P=(0,o.useCallback)((()=>n?function(e,t,n){F().K(t,{from:e,upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}}),n&&n(),m().CW(t,{type:"upgrade"})}(y,j,b):_()),[j,_,b,n,y]);if(k)return(0,M.jsx)("div",{onClick:_,children:k});const R=(0,Y().A)({onInviteClick:h,onInviteComplete:v,buttonStyle:I.importListButton,buttonContainerStyle:I.importListButtonContainer});return f?(0,M.jsx)(T().Ay,{open:!!C||void 0,popupType:B().nl.Popup,alignmentToOrigin:T().yP.End,placementToOrigin:T().sx.Bottom,render:()=>(0,M.jsx)(he().A,{importListItems:R}),originGap:12,onClose:()=>{C&&$().F.closeImportDropdown()},renderOrigin:e=>(0,M.jsx)(fe().A,{disabled:!a&&!n,style:I.dropdownButton,title:(0,M.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel.dropdown",defaultMessage:"Add members"}),onClick:P,onDropdownClick:()=>{e.onClick(),c().V(j,{source:"add_members_button"})},color:"blue"})}):(0,M.jsx)(x().A,{size:"lg",onClick:P,disabled:!a&&!n,style:I.dropdownButton,...t,children:(0,M.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const be=o.memo(ve)},858385:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M,getSpaceViewMenuItems:()=>A});n(362833),n(242343);var o=()=>n(237385),i=()=>n(803290),s=()=>n(653998),r=()=>n(149078),a=()=>n(281885),l=(n(725707),n(491955),()=>n(975392));var d=()=>n(640979),c=()=>n(548694),u=()=>n(672796),m=()=>n(466321),p=()=>n(485966),g=()=>n(8202),f=()=>n(535906),h=()=>n(935091),v=()=>n(858023),y=()=>n(743668),b=()=>n(28210),x=()=>n(88271),S=n(163643);const M=function(){const e=(0,o().v3)(),{device:t}=e,s=(0,i().O$)(g().A);return(0,S.jsx)(n(443252).Ay,{popupType:t.isMobile?m().n.SlideUp:m().n.Popup,open:s.open,render:()=>(0,S.jsx)(w,{}),originGap:8,onDismiss:r().Ew,originRect:s.originRect,enableRounding:!0})};function A(e,t){const{device:n}=e,{currentUserRootStore:o}=p().default.state;if(!o)return[];const{editableStores:i}=function(e){const t=l().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),o=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:o.length,editableStores:o}}(o),s=[];for(const r of i){const o=r.getSpaceStore();if(null!=o&&o.isReady()&&o.canEdit()){const i=(0,c().GK)(e,o),l=(0,c().c2)(e,o);s.push({key:r.id,action:async()=>{await a().Fq({environment:e,blockStore:t,spaceStore:o,spaceViewStore:r})},render:e=>(0,S.jsx)(f().A,{title:i,icon:(0,S.jsx)(b().B,{icon:l,isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return s}function w(){const e=(0,o().v3)(),{device:t}=e,n=(0,i().O$)(g().A),a=(0,i().K8)((()=>p().default.state.currentUserRootStore),[]),l=(0,i().K8)((()=>n.store?A(e,n.store):[]),[e,n]);if(!n.open||!a)return null;const c=[{key:"spaces",render:e=>(0,S.jsx)(x().A,{title:t.isMobile?void 0:(0,S.jsx)(s().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:l},{key:"logout",render:e=>(0,S.jsx)(x().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>u().logout(e),render:e=>(0,S.jsx)(k,{...e})}]}];let m;return m=t.isMobile?{menuType:d().gu.Modal,title:(0,S.jsx)(s().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,S.jsx)(y().CancelMenuText,{}),onClickRight:r().Ew}:{menuType:d().gu.Popup},(0,S.jsx)(h().A,{...m,children:(0,S.jsx)(v().Ay,{type:v().Oh.Vertical,sections:c,initialFocus:1})})}function k(e){const t=(0,i().K8)((()=>{const{currentUserStore:e}=p().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,S.jsx)(f().A,{caption:(0,S.jsx)(s().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}},861917:(e,t,n)=>{n.d(t,{j8:()=>f,un:()=>p,p2:()=>m,WE:()=>u,n5:()=>h,Xn:()=>g});var o=()=>n(66460);const i=(0,n(851552).Dv)("restoreSnapshot");var s=()=>n(900376),r=()=>n(137476);var a=()=>n(275338);var l=()=>n(839618),d=()=>n(70989);const c=(0,n(653998).YK)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function u(e){const{environment:t,from:n,...o}=e;!function(e,t){r().vd(e,"open_history",{from:t})}(t,n),s().A.setState({...o,open:!0,size:50})}function m(){const e=s().A.state;e.open&&s().A.setState({...e,size:e.size+20})}function p(){s().A.setState({open:!1})}function g(e){const{environment:t,snapshot:n,nextFutureSnapshot:o}=e;!function(e,t){r().vd(e,"select_snapshot",{ageMs:(0,a().S)(t)})}(t,n);const i=s().A.state;i.open&&s().A.setState({...i,snapshot:n,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function f(){const e=s().A.state;e.open&&s().A.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function h(e,t){if(!s().A.state.open||!s().A.state.snapshot)return;if(!s().A.state.snapshot)return;!function(e,t){r().vd(e,"restore_snapshot",{ageMs:(0,a().S)(t)})}(e,s().A.state.snapshot),d().m({message:c.restoringPreviousVersion});const n=await l().UT(e,i,{block:{id:s().A.state.blockStore.id,spaceId:(0,o().e)(s().A.state.blockStore.pointer.spaceId)},timestamp:s().A.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(d().V(),n.value.error)throw n.value.error}},862762:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>X});n(725707),n(107652),n(491955),n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(556078),r=()=>n(803290),a=()=>n(174114),l=()=>n(39742),d=()=>n(794484),c=()=>n(353509),u=()=>n(242120),m=()=>n(390325),p=()=>n(120844),g=()=>n(680369),f=()=>n(145017),h=()=>n(653998),v=()=>n(76394),y=()=>n(352211),b=()=>n(759625),x=()=>n(621214),S=()=>n(84543),M=()=>n(317697),A=()=>n(531568),w=()=>n(267439),k=()=>n(79040),j=()=>n(686329),C=()=>n(8519),I=()=>n(150968),T=()=>n(377403),_=()=>n(88442),P=()=>n(477784),B=()=>n(400885),R=()=>n(622286),L=()=>n(105373),D=()=>n(907721),N=()=>n(466321),O=()=>n(802955),E=()=>n(210466),U=()=>n(937968),F=()=>n(707299),K=()=>n(518022),V=()=>n(388615),z=()=>n(204435),W=()=>n(858023),H=()=>n(397791),G=()=>n(443252),Y=()=>n(35462),q=()=>n(909440),$=()=>n(568344),Q=n(163643);const Z=8;function X(e){const{store:t,context:n,menuListStore:R,editorWidth:E}=e,X=te(),ie=(0,B().L5)(n),se=(0,a().IS)((e=>({root:{background:ie?e.peekModalBackground:e.contentBackground,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"}})),[ie]),[re,ae]=function(e){const t=(0,i().v3)(),n=(0,r().K8)((()=>"editor"===e.getRole()),[e]),o={name:(0,h().tz)().formatMessage(ee.tableTemplateTitle),type:"database",iconFn:p().T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{const n=t.getParentStore();n&&(0,F().u)(n)&&(0,K().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,K().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:o=>{"accepted_template"!==o.type&&"accepted_empty_collection"!==o.type||S().createAndCommit({environment:e,canUndo:!1,perform:e=>{if(b().zv({store:t,transaction:e,data:{alive:!1}}),n.table===f().ev){const o=n.getContentIds();b().zv({store:n,transaction:e,data:{content:o.filter((e=>e!==t.id))}})}},userAction:"clean_up_empty_new_page"})}})}},d=function(e){const{environment:t,store:n}=e,o=(0,h().tz)(),i=(0,s().S)(),a=(0,r().K8)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),l=(0,r().K8)((()=>(0,_().ZE)(a)),[a]);return{name:o.formatMessage(ee.askAi),type:"ai",iconFn:e=>(0,Q.jsx)(A().UY,{}),shouldShow:()=>l,onClick:()=>{S().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{x().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,M().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:t,store:e}),g=function(e){const t=(0,h().tz)(),n=(0,a().DP)(),o=(0,r().K8)((()=>(0,I().h)()),[]),i=(0,T().W)(),s=te();return{name:e?"":t.formatMessage(ee.dictate),type:"dictation",iconFn:t=>(0,c().E)({...t,width:10,...e?{height:16,marginTop:"2px",marginBottom:"2px",marginLeft:"2px",marginRight:"-6px"}:{},fill:s?n.icon.primary:"dark"===n.mode?n.accentColors.red[700]:n.accentColors.red[400]}),shouldShow:()=>o&&!i,onClick:async(e,t)=>{const{dictationActions:n}=await C().$O.load();n.startDictation({environment:e,blockStore:t,from:"horizontal_template_picker",includeSystemAudio:!1})}}}(!0),v=function(){const e=(0,h().tz)(),t=(0,a().DP)(),n=(0,T().W)();return{name:e.formatMessage(ee.transcription),type:"transcription",iconFn:e=>(0,u().b)({...e,fill:t.regularIconColor}),shouldShow:()=>n,onClick:async(e,t)=>{const{transcriptionNewPageActions:n}=await C().$O.load();n.appendTranscriptionBlockToPage({environment:e})}}}(),y=function(e){const t=(0,i().v3)();return{name:(0,h().tz)().formatMessage(ee.formTemplateTitle),type:"quick-form",iconFn:l().docPlainTextIcon,shouldShow:()=>!0,onClick:async()=>{await(0,w().t)({environment:t,store:e})}}}(e),j=function(e){const{isTablet:t}=(0,i().Y0)();return{name:P().A.formatMessage(q().KQ.templates),type:"templates",iconFn:e=>(0,m().s)(e),shouldShow:()=>!t,onClick:e=>{(0,L().P)({environment:e})}}}(),B=[g,d,v,o,...n?[y]:[],j].filter((e=>e.shouldShow(t))),R=[...k()._,ne,q().zD];return[B,R]}(t),[le,de]=function(e){const{store:t,editorWidth:n,initialVisible:s,initialOverflow:r}=e,l=(0,i().v3)(),c=(0,h().tz)(),u=te(),m=(0,a().IS)((e=>({icon:{width:g().Ev.default,height:g().Ev.default,fill:e.icon.primary}})),[]),[p,f]=o.useState(void 0),[b,x]=o.useState([]),[S,M]=o.useState(void 0),[A,w]=o.useState(s.length);(0,o.useEffect)((()=>{if(!(n&&b.every(v().O9)&&S))return;let e=0,t=0;for(;t<s.length&&(e+=b[t]+Z,!(e+S>n+24));)t++;w(t)}),[b,n,s.length,S]);const k=s.slice(0,A).map(((e,n)=>{const o={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:o=>{var i;let{ref:s,...r}=o;return(0,Q.jsx)(j().EE,{onSizeChange:e=>{if(b[n]===e.width)return;const t=[...b];t[n]=e.width,x(t)},children:(0,Q.jsx)("div",{children:(0,Q.jsx)($().J,{...r,focused:p===n,onMouseEnter:o=>{var i;null===(i=e.onMouseEnter)||void 0===i||i.call(e,l,t),f(n)},onMouseLeave:n=>{var o;null===(o=e.onMouseLeave)||void 0===o||o.call(e,l,t),f(void 0)},format:"horizontal-new-page",title:(0,Q.jsx)(Y().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,m.icon),locked:!1})})})},action:n=>{(0,U().EF)(l)&&(y().ki(l,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(l,t))}};return o})),[C,I]=o.useState(!1),T=A,_={key:"more",render:e=>{let{ref:n,...o}=e;return(0,Q.jsx)(G().Ay,{origin:(0,Q.jsx)(j().EE,{onSizeChange:e=>M(e.width),children:(0,Q.jsx)("div",{children:(0,Q.jsx)($().J,{...o,focused:p===T,onMouseEnter:e=>{f(T)},onMouseLeave:e=>{f(void 0)},format:"horizontal-new-page",title:u?null:(0,Q.jsx)(Y().A,{children:c.formatMessage(ee.more)}),type:"more",icon:(0,Q.jsx)(H().I,{icon:d().L,color:"secondary"}),locked:!1})})}),alignmentToOrigin:D().C.Start,placementToOrigin:D().W.Top,originGap:4,open:C,popupType:N().n.Popup,onDismiss:()=>I(!1),render:()=>(0,Q.jsx)(oe,{store:t,items:[...s.slice(A),...r]})})},action:e=>{y().ki(l,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more"}),I(!0)}};return[k,_]}({store:t,editorWidth:E,initialVisible:re,initialOverflow:ae});return!(0,r().O$)(O().e)?null:(0,Q.jsx)(V().s,{allowSelectionWithin:!1,children:(0,Q.jsx)(W().Ay,{type:W().Oh.Horizontal,store:R,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(J,{isInPeekView:ie}),(0,Q.jsx)("div",{style:se.root,children:(0,Q.jsxs)(z().VP,{gap:12,children:[(0,Q.jsx)(Y().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:X?(0,Q.jsx)(h().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,Q.jsx)(h().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,Q.jsx)("div",{style:{cursor:"pointer"},children:(0,Q.jsx)(z().fI,{gap:Z,children:e.children})})]},e.key)})]}),items:[...le,de]}]})})}function J(e){const t=(0,a().IS)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.peekModalBackground:t.contentBackground} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,Q.jsx)("div",{style:t.fade})}const ee=(0,h().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},dictate:{defaultMessage:"Dictate",id:"newpage.templates.dictateIntoNewPage"},transcription:{defaultMessage:"Meet",id:"newpage.templates.transcription"},more:{defaultMessage:"More",id:"newpage.templates.more"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function te(){const e=(0,i().v3)(),{isTablet:t}=(0,i().Y0)(),n=(0,R().X)("tablet_refresh_template_pills_gate");return!(!t||!n)||!e.device.isMobile}const ne={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function oe(e){const{store:t,items:n}=e,s=(0,i().v3)(),r=(0,o.useMemo)((()=>new(E().A)),[]),l=(0,a().IS)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:g().Ev.default,fill:e.icon.primary},divider:{height:1,background:e.stroke.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(s))).map((e=>{const n={key:e.name,render:t=>{var n;let{ref:o,...i}=t;return"divider"===e.type?(0,Q.jsx)("div",{style:l.divider}):(0,Q.jsx)($().J,{...i,format:"horizontal-new-page-submenu",title:(0,Q.jsx)(Y().A,{children:e.name}),type:e.type,icon:null===(n=e.iconFn)||void 0===n?void 0:n.call(e,l.icon),locked:!1})},action:n=>{(0,U().EF)(s)&&(y().ki(s,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(s,t))}};return n}));return(0,Q.jsx)(W().Ay,{type:W().Oh.Vertical,store:r,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,Q.jsx)("div",{style:l.menu,children:(0,Q.jsx)(z().VP,{children:e.children},e.key)}),items:d}]})}},867934:(e,t,n)=>{n.d(t,{Wf:()=>h,YB:()=>g,aj:()=>f,f3:()=>y,qg:()=>v});n(725707),n(491955),n(403517),n(242343);var o=()=>n(174114),i=()=>n(810111),s=()=>n(653998),r=()=>n(712048),a=()=>n(640979),l=()=>n(535906),d=()=>n(935091),c=()=>n(858023),u=()=>n(88271),m=()=>n(798508),p=n(163643);function g(e){const{currentVisibility:t,propertySchema:n,onSelect:o,onClose:a}=e;let l=[...i().vj];l=l.filter((e=>"section"!==e)),(0,r()._f)({propertySchema:n})||(l=l.filter((e=>"hide_if_empty"!==e)));const d=l.map((e=>({visibility:e,label:(0,p.jsx)(s().sA,{...m().gY[e]})})));return(0,p.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:o,onClose:a})}function f(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=(0,r().SB)(t),a=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,p.jsx)(s().sA,{...m().vG[e]})})));return(0,p.jsx)(b,{currentVisibility:i,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function h(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,r=i().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,p.jsx)(s().sA,{...m().wV[e]})}))),a="section_hide"===t?void 0:t;return(0,p.jsx)(b,{currentVisibility:a,visibilityLevelsWithLabels:r,onSelect:n,onClose:o})}function v(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,r=i().qG.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,p.jsx)(s().sA,{...m().Bb[e]})}))),a="section_collapsed"===t?"section_show":t;return(0,p.jsx)(b,{currentVisibility:a,visibilityLevelsWithLabels:r,onSelect:n,onClose:o})}function y(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,r=i().RL.map((e=>({visibility:e,label:(0,p.jsx)(s().sA,{...m().PP[e]})})));return(0,p.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:r,onSelect:n,onClose:o})}function b(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:o,onClose:i}=e,s=n.map((e=>{let{visibility:n,label:s}=e;return{key:n,render:e=>(0,p.jsx)(x,{buttonMenuItemProps:e,isChecked:n===t,label:s}),action:()=>{o(n),i&&i()}}})),r=[{key:"visibilityLevels",render:e=>(0,p.jsx)(u().A,{...e,topBorder:0!==e.index}),items:s}],l={menuType:a().gu.Popup,width:"auto",maxWidth:360};return(0,p.jsx)(d().A,{...l,children:(0,p.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:r})})}function x(e){const{buttonMenuItemProps:t,label:n,isChecked:i}=e,s=(0,o().IS)((()=>({title:{display:"flex",alignItems:"center",width:150}})),[]),r=(0,p.jsx)("div",{style:s.title,children:n});return(0,p.jsx)(l().A,{...t,textWrapperStyle:{marginRight:0},title:r,isChecked:i})}},872131:(e,t,n)=>{n.d(t,{A:()=>c});n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(653998),a=()=>n(975392),l=()=>n(21209),d=n(163643);const c=function(e){const{teamStore:t,from:c,onLeavingTeam:u,style:m,hoveredStyle:p,icon:g,isRed:f,placement:h,alignment:v,buttonInternals:y}=e,b=(0,i().v3)(),x=(0,s().O$)(n(485966).AppStoreCurrentSpaceStore),S=(0,l().$)(t),M=(0,o.useCallback)((async()=>{if(!x)return;await n(628854).JC({environment:b,teamStore:t,from:c,userGroupsInTeam:S})&&(null==u||u())}),[x,b,t,c,S,u]),A=(0,d.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),w=function(e){let{teamStore:t}=e;const n=(0,i().v3)(),o=n.currentUser.id,{isDefaultTeam:c}=(0,s().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),u=(0,l().$)(t),m=(0,s().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return Boolean(o&&t.isOwner(o)&&e.length+n.length===1)}),[t,o]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:n,userGroupsInTeam:o}=e;if(t)return(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(n)return(0,d.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(o.length>0)return(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:a().oE(o.map((e=>e.name))).join()}})}({isDefaultTeam:c,isOnlyTeamOwner:m,userGroupsInTeam:u})}({teamStore:t}),k=Boolean(w),j=k?w:A;return(0,d.jsx)(n(103151).A,{style:k?{width:240}:void 0,disableTooltip:!Boolean(j),renderTooltip:e=>(0,d.jsx)("div",{...e,children:j}),textWrap:k,placement:h,alignment:v,render:e=>(0,d.jsx)(n(209684).p,{...e,style:m,hoveredStyle:p,onClick:M,disabled:k,disabledFeedback:k,icon:g,isRed:f,children:y||(0,d.jsxs)(d.Fragment,{children:[(0,n(539645).o)({width:12.5,marginRight:4}),(0,d.jsx)(r().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},874620:(e,t,n)=>{n.d(t,{b:()=>r});n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601);var o=()=>n(758989),i=()=>n(694225),s=()=>n(284320);function r(e){let{icon:t,theme:n}=e;if(t)return(0,i().A)(t)?s().A.state.emojiByColorProcessed[t]:(0,o().T8)(t)?function(e){var t;let{uri:n,theme:i}=e;const s=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return a.has(e)}(s))return;return o().l8[i.mode][s]}({uri:t,theme:n}):void 0}const a=new Set((0,n(76394).uv)(o().l8.light))},883959:(e,t,n)=>{n.d(t,{C:()=>o});const o=(0,n(680369).xh)("magnifyingGlass",{default:{loader:()=>n.e(1827).then(n.bind(n,658504))},small:{loader:()=>n.e(41805).then(n.bind(n,916278))},mini:{loader:()=>n.e(20283).then(n.bind(n,742656))},large:{loader:()=>n.e(61969).then(n.bind(n,804634))}})},887615:(e,t,n)=>{n.d(t,{n:()=>s});var o=()=>n(803290),i=()=>n(908589);function s(e){return(0,o().K8)((()=>(0,i().o)(e)),[e])}},890256:(e,t,n)=>{n.d(t,{F:()=>Y});var o=()=>n(16791),i=()=>n(145054),s=()=>n(694225),r=()=>n(673447),a=()=>n(34662),l=()=>n(401548),d=()=>n(975392),c=()=>n(31448),u=()=>n(927685),m=()=>n(477784),p=()=>n(378219),g=()=>n(874620),f=()=>n(799220),h=()=>n(927999),v=()=>n(84543),y=()=>n(663539);const b=630,x=1200,S=(0,n(220413).O4)({theme:"light"}),M=240,A="white",w=200,k=96,j=150,C=184,I=100,T=145,_=23,P=347,B=24,R=100,L=100,D=100,N="black",O=96,E=68,U=S.text.tertiary,F=40,K=(0,n(653998).YK)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),V='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function z(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e}))}function W(e,t){return`${c().Wy.bold} ${t}px ${c().xf({pageFont:e,locale:o().locale})}`}function H(e){const t=c().Wy.medium,n=c().xf({pageFont:e,locale:o().locale});return`${t} ${F}px ${n}`}function G(e){let{context:t,text:n,font:o,color:i,x:s,y:r}=e;t.font=o,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,s,r)}async function Y(e){var t;let{store:n,environment:o}=e;if(n.pathIsDead()||!(0,r().ot)(p().E(n))||(0,f().dL)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:o.currentUser.id}))return;const c=a().q4_(n.getTitleValue())||"",F=null===(t=n.getIcon())||void 0===t?void 0:t.icon,Y=function(e,t){var n;const o=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(o)return i().wY({url:o,width:x,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(o,n),q=n.getFormat(),$=new OffscreenCanvas(x,b),Q=$.getContext("2d"),[Z,X]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=W(t,O),n.style.top="110vh",n.innerText=e;const o=x-R-L,i=document.body;if(i.appendChild(n),n.clientWidth<o)return i.removeChild(n),[e,O];if(n.style.font=W(t,E),n.clientWidth<o)return i.removeChild(n),[e,E];let s=e;for(;n.clientWidth>o;)s=s.substring(0,s.length-1),n.innerText=`${s}…`;return i.removeChild(n),[`${s}…`,E]}(c,q.page_font),J=W(q.page_font,X),ee=P+(F?_:0),te=ee+B+X;if(Q){!function(e){e.fillStyle=A,e.fillRect(0,0,x,b)}(Q),await async function(e){let{context:t,coverImageUrl:n,icon:o,coverPosition:i=.5}=e;if(n){const e=await z(n),o=e.width*(M/x),s=((0,d().Et)(i)?1-i:.5)*(e.height-o);t.drawImage(e,0,s,e.width,o,0,0,x,M)}else{const e=(0,g().b)({icon:o,theme:S}),n=e?(0,l().X4)(e,.1):S.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,x,M),t.fillStyle="rgb(0,0,0,1)"}}({context:Q,coverImageUrl:Y,icon:F,coverPosition:q.page_cover_position}),await async function(e){let{context:t,store:n,icon:o}=e;if(o)if((0,s().A)(o))t.font=`${w}px ${V}`,t.textAlign="left",t.textBaseline="top",t.fillText(o,k,j);else{const e=i().wY({url:o,baseUrl:u().A.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:C,userId:void 0}),s=await z(e);t.drawImage(s,I,T,C,C)}}({context:Q,store:n,icon:F}),G({context:Q,text:Z,font:J,color:N,x:R,y:ee}),G({context:Q,text:m().A.formatMessage(K.builtWithNotion),font:H(q.page_font),color:U,x:D,y:te});const e=await $.convertToBlob();!function(e){let{store:t,file:n,environment:o}=e;y().QM({environment:o,file:n,bucket:"secure",record:t.pointer,isFileBlock:!1,onComplete:e=>{v().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:o,canUndo:!1,perform:n=>{h().lm({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:o,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},895269:(e,t,n)=>{n.d(t,{Z:()=>c});var o=()=>n(32901),i=()=>n(944498),s=()=>n(477784),r=()=>n(802955),a=()=>n(273541),l=()=>n(449596);const d=(0,n(653998).YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}}),c=(0,o().fi)({key:"available offline",svg:n(183781).arrowInCircleDownIcon,svgWhenEnabled:n(423162).checkmarkCircleIcon,displayName:d.name,label:s().A.formatMessage(d.name),isLoading:e=>{const t=void 0===l().A.state.offlinePages,n=a().B1(e.id);return t||n&&l().A.state.isSlowWrite},isEnabled:e=>a().fF(e.id),validators:[i().SQN("download_for_offline"),i().or([i().b8R,i().wHP])],action:(e,t,o,i)=>{n(94417).lX({store:t,environment:e,analyticsFrom:i})},disabled:e=>!r().A.state.online,renderTooltip:()=>s().A.formatMessage(o().AY.unavailableOfflineTooltip),disableTooltip:e=>r().A.state.online||a().Bd(e.id)})},905977:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(129978);const i=new(o().O2)("permissionsInviteWithModal",(async()=>await Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(21194),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(84341),n.e(3965),n.e(93052),n.e(67200),n.e(6463),n.e(98071),n.e(45620),n.e(96453),n.e(8081),n.e(25368),n.e(38546),n.e(80759),n.e(67183),n.e(45354),n.e(82720),n.e(83181),n.e(68455),n.e(28773),n.e(76074),n.e(78917),n.e(72883),n.e(1440),n.e(45986),n.e(67378),n.e(9353),n.e(91137),n.e(21864),n.e(52181),n.e(92924),n.e(66406),n.e(19167),n.e(55717),n.e(10152),n.e(40186),n.e(73738),n.e(70584),n.e(97074),n.e(48979),n.e(91957),n.e(76026),n.e(67262),n.e(29616),n.e(75681)]).then(n.bind(n,840380)))),s=(0,o()._h)(i,(e=>e.PermissionsInviteWithModal))},909440:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>m,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>p});n(362833),n(725707),n(403517),n(244387);var o=()=>n(653998),i=()=>n(621214),s=()=>n(84543),r=()=>n(477784),a=()=>n(105373),l=()=>n(330358);const d=(0,o().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:r().A.formatMessage(d.empty),iconFn:n(22599).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}},u={name:r().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(361499).M)(e),shouldShow:()=>!0,onClick:e=>{(0,a().P)({environment:e})}},m={name:r().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(40642).b)(e),shouldShow:()=>!0,onClick:e=>{(0,a().P)({environment:e})}},p={name:r().A.formatMessage(d.import),type:"import",iconFn:n(792104).f,shouldShow:()=>!0,onClick:(e,t)=>{const o=n(214144).JW();n(242333).A.setState({flowId:o}),n(505381).kY(e,{from:"new_page",flowId:o}),l().A.setState({...l().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},g=(0,o().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:r().A.formatMessage(g.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().T({environment:e,store:t,transaction:n})}})}},{name:r().A.formatMessage(g.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},936726:(e,t,n)=>{n.d(t,{r:()=>o});const o=n(129044).default.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},936997:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>y});n(725707),n(491955);var o=n(242343),i=()=>n(237385),s=()=>n(803290);const r="initial_handshake";var a=()=>n(409211),l=()=>n(653998),d=()=>n(975392),c=()=>n(23371),u=()=>n(3311),m=()=>n(927685),p=()=>n(413871),g=()=>n(539581),f=()=>n(348965),h=n(163643);const v=1;function y(){const e=(0,i().v3)(),t=(0,l().tz)(),n=`${m().A.identity.domainBaseUrl}/authSync`,y=e.currentUser.isLoggedIn(),[b,x]=(0,o.useState)(null),[S,M]=(0,o.useState)({value:!1,count:0}),A=(0,s().K8)((()=>g().A.getTotalUnreadMentionsCount()),[]),w=(0,s().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=m().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(x(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{y&&(S.value||0===S.count||null==b||b.postMessage({version:v,name:"unreadCount",source:"notion",unreadCount:A}))}),[y,S.count,S.value,b,A]);const k=(0,o.useCallback)((async()=>{const e=d().hS(w,"userId"),n=await(0,c().lX)(e,10,(async e=>{if(!e.userId)return;const n=p().LU.createChildStore(e,{table:a().oo,id:e.userId});await n.load();const o=n.getEmail()??"",i=n.getDisplayName(t)??"";return{id:e.userId,displayName:i,emailAddress:o}}));null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,w]);(0,o.useEffect)((()=>{y&&b&&(S.value||0===S.count)&&k()}),[y,k,S.count,S.value,b]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,b]),(0,o.useEffect)((()=>{y||(null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[y,b]);const j=(0,o.useCallback)((e=>{if(e.data.version!==v)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)M((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(x((e=>(e&&(e.onmessage=j),e))),()=>{x((e=>(e&&(e.onmessage=null),e)))})),[j,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(r,m().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},943222:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(242343);var o=()=>n(83544),i=()=>n(653998),s=()=>n(392863),r=n(163643);function a(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,r.jsx)(s().C,{...e,message:n})}const l=(0,i().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,i().tz)();return(0,r.jsx)(a,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),heroMedia:{src:o().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},950234:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>_n,PeopleRow:()=>In,SettingToggle:()=>Pn,SidebarTeamModal:()=>Tn});n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(653998),l=()=>n(975392),d=()=>n(76394),c=()=>n(31448),u=()=>n(539174),m=()=>n(983050),p=()=>n(904697),g=()=>n(320462),f=()=>n(98508),h=()=>n(485966),v=()=>n(413871),y=()=>n(943066),b=()=>n(38597),x=()=>n(806921),S=(n(362833),()=>n(792104)),M=()=>n(680369),A=()=>n(220413),w=()=>n(575015),k=()=>n(84543),j=()=>n(435819),C=()=>n(59175),I=()=>n(951540),T=()=>n(103151),_=()=>n(35462),P=()=>n(477784),B=()=>n(810526),R=()=>n(907721),L=()=>n(628854),D=()=>n(5758),N=()=>n(935449);function O(e){return!(0,N().R)(e)}var E=()=>n(79196),U=()=>n(105018),F=()=>n(872131),K=()=>n(732566),V=()=>n(424339),z=()=>n(173864),W=()=>n(548694),H=()=>n(590344),G=n(163643);const Y=(0,a().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),q=(0,a().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function $(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),o=g().p.Members,i=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(z().BA,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,G.jsx)(H().u,{currentAccessLevel:i,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,G.jsx)(Q,{teamStore:t},"permissions")],onClick:()=>{g().A.state.open&&g().A.setState({...g().A.state,tab:o})},itemStyle:n.listItem})]})}function Q(e){let{teamStore:t}=e;const n=(0,s().O$)(h().AppStoreCurrentSpaceStore),o=(0,i().v3)(),a=(0,r().IS)((e=>({label:{color:e.text.primary,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,s().K8)((()=>t.getTeamPermission()),[t]),d=(0,s().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,s().K8)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,W().GK)(o,n);return{spaceIcon:(0,G.jsx)(V().x,{disabled:!0,store:n,size:20,style:a.icon}),spaceName:e}}),[n,o,a.icon]),m=(0,s().K8)((()=>(0,G.jsx)(V().x,{disabled:!0,store:t,size:20,style:a.icon})),[t,a.icon]),p=(null==l?void 0:l.role)??"none",g=!(p===d.role),f=g?m:c,v=P().A.formatMessage(q[d.role],{showTeam:g,spaceName:u}),y=P().A.formatMessage(Y[p]);return(0,G.jsxs)("div",{style:a.row,children:[f,(0,G.jsxs)(_().A,{isSmall:!0,style:a.label,children:[g&&(0,G.jsxs)(G.Fragment,{children:[y,(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),v]})]})}var Z=()=>n(955308),X=()=>n(209684),J=()=>n(647276),ee=()=>n(547851),te=()=>n(622286),ne=()=>n(404042),oe=()=>n(161813),ie=(n(725707),n(500234),()=>n(198654)),se=()=>n(446588),re=(n(491955),()=>n(486540));const ae=["none","reader","comment_only","read_and_write","editor"],le=["reader","comment_only","read_and_write"],de=["reader","comment_only","read_and_write","editor"],ce=["editor"];function ue(e){const t=function(e){var t,n;let{teamId:o,permissions:i}=e;const s=(null===(t=i.find((e=>(0,se().Lg)(e))))||void 0===t?void 0:t.role)??"none",r=(null===(n=i.find((e=>(0,se().gl)(e)&&e.team_id===o)))||void 0===n?void 0:n.role)??s,a=i.find((e=>(0,se().un)(e)));return{spacePermission:{type:"space_permission",role:s},teamMemberPermission:{type:"explicit_team_permission",team_id:o,role:r},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:o,role:"editor"},...a&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:o,role:a.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:o}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},s={spacePermission:pe({roles:ae,currentRole:o.role}),teamGuestPermission:le,teamMemberPermission:me({roles:de,currentRole:n.role}),teamOwnerPermission:ce},{visibility:r,space_member_join_access:a}=e.settings;return"team_members"===r&&(i.space_member_join_access=["invite_only"],s.spacePermission=["none"]),"self_join"===a&&(i.visibility=["space_members"],i.invite_access=["team_members"],s.spacePermission=s.spacePermission.filter((e=>"none"!==e))),e.is_default&&(s.teamMemberPermission=[o.role],s.spacePermission=[o.role]),{settingsOptions:i,permissionItemRoleOptions:s,currentTeamPermissionItems:t}}function me(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,re().Pr)(e,n)))}function pe(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,re().Y1)(e,n)))}var ge=()=>n(535906),fe=()=>n(273520),he=()=>n(935091),ve=()=>n(858023),ye=()=>n(88271),be=()=>n(431551),xe=()=>n(640979),Se=()=>n(906230);function Me(e){let{teamStore:t}=e;const n=(0,s().K8)((()=>t.getSettingsStore().getValue()),[t]),o=(0,s().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ue({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!o)return null;const i=[(0,G.jsx)(we,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,G.jsx)(Ae,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar"),(0,G.jsx)(ke,{teamStore:t},"toggleInviteLink")];return(0,G.jsx)(z().BA,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i,hideDividers:!0})}function Ae(e){const{teamStore:t,disablePageEdits:n}=e,r=(0,i().v3)(),l=O(t),d=(0,s().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,o.useCallback)((e=>{k().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:r,canUndo:!0,perform:n=>{L().WC({environment:r,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[r,t]),u=(0,se().p2)(d),m=[{option:!0,label:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&m.push({option:!1,label:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,G.jsx)(je,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:m,optionTooltip:u?void 0:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function we(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:s}=e,r=(0,N().R)(t),l=(0,i().v3)(),d=(0,o.useCallback)((e=>{k().createAndCommit({userAction:"team.setInviteAccess",environment:l,canUndo:!0,perform:n=>{L().WC({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!r||n;return(0,G.jsx)(je,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),disabled:c,optionTooltip:c&&r&&(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:s,allOptions:[{option:"team_members",label:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,G.jsx)(a().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function ke(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().K8)((()=>(0,p().isTeamInviteLinkDisabled)(t)),[t]),l=O(t),d=(0,r().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,G.jsxs)("div",{style:d.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{children:(0,G.jsx)(a().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,G.jsx)(_().A,{isSmall:!0,style:d.subtitle,children:(0,G.jsx)(a().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,G.jsx)("div",{style:d.switcher,children:(0,G.jsx)(be().A,{disabled:l,on:!o,onClick:()=>{k().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{L().WC({environment:n,store:t,update:{disable_invite_link:!o},transaction:e})}})}})})]})}function je(e){const{title:t,caption:n,currentOption:o,allOptions:s,disabled:a,optionTooltip:l}=e,d=(0,i().Y0)(),c=(0,r().IS)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.text.secondary},tooltipWidth:{width:300}})),[]),u=s.find((e=>e.option===o));return u?(0,G.jsxs)("div",{style:c.root,children:[(0,G.jsxs)("div",{style:c.title,children:[t,n&&(0,G.jsx)(_().A,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,G.jsx)(T().A,{style:c.tooltipWidth,placement:R().W.Top,alignment:R().C.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)(fe().Ay,{...e,disablePopup:a,popupType:d.isMobile?fe().z7.SlideUp:fe().z7.Popup,alignmentToOrigin:fe().yP.End,renderOrigin:t=>(0,G.jsxs)(X().p,{style:c.buttonStyle,disabled:a,...(0,Se().A)(e,t),children:[u.label,!a&&(0,ie().b)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:xe().gu.ActionSheet}:{menuType:xe().gu.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,G.jsx)(ye().A,{...e}),items:s.map((t=>{const n={key:t.option.toString(),render:e=>(0,G.jsx)(ge().A,{...e,title:t.label,caption:t.caption,isChecked:o===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,G.jsx)(he().A,{...t,children:(0,G.jsx)(ve().Ay,{type:ve().Oh.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function Ce(e){let{teamStore:t}=e;const n=(0,r().IS)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Me,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(Ie,{teamStore:t}),(0,G.jsx)(K().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Ie(e){let{teamStore:t}=e;const n=(0,s().O$)(h().AppStoreCurrentSpaceStore),o=(0,i().v3)(),l=(0,oe().Z)(),d="enterprise",c=(0,te().X)("sharing_anyone_with_the_link"),{organizationOverrides:u}=(0,J().n)({spaceId:null==n?void 0:n.id}),m=o.currentUser.id,p=(0,s().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(u.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(u.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(u.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,u]),g=(0,N().R)(t),f=(0,s().K8)((()=>(null==n?void 0:n.canAdmin())??!1),[n]),v=(0,r().IS)((()=>({switcher:{marginRight:0}})),[]);if(!n)return null;if(!m)return null;const y=e=>l||p[e].teamIsDisabled,b=e=>{if(!y(e))return!1;if(!g)return!1;if(p[e].isControlledByOrganization)return!1;const t=(e=>p[e].spaceIsDisabled&&p[e].teamIsDisabled)(e);return!t||f},x=e=>!y(e)&&f,S=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=p[e],s=!n;L()._B({environment:o,store:t,settingName:e,newTeamSettingValue:Pe(s),spaceSettingValue:void 0===i?void 0:Pe(i)})},M=e=>{if((e=>p[e].spaceIsDisabled)(e))return(e=>p[e].teamIsDisabled)(e)?(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},A=(0,G.jsx)(ne().A,{subscriptionTier:d,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),w=(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),k=[(0,G.jsx)(Pn,{switcherStyle:v.switcher,upsellTier:d,on:p.disable_public_access.teamIsDisabled,disabled:!b("disable_public_access"),onChange:()=>S("disable_public_access"),shouldTriggerUpsell:x("disable_public_access"),secondCaption:M("disable_public_access"),title:(0,G.jsxs)(G.Fragment,{children:[c?(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.setting.shareTitleAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}):(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable publishing sites and forms"}),!y("disable_public_access")&&A]}),tooltip:!y("disable_public_access")&&w,isLocked:p.disable_public_access.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Pn,{switcherStyle:v.switcher,upsellTier:d,on:p.disable_guests.teamIsDisabled,disabled:!b("disable_guests"),onChange:()=>S("disable_guests"),shouldTriggerUpsell:x("disable_guests"),secondCaption:M("disable_guests"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!y("disable_guests")&&A]}),tooltip:!y("disable_guests")&&w,isLocked:p.disable_guests.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Pn,{switcherStyle:v.switcher,upsellTier:d,on:p.disable_export.teamIsDisabled,disabled:!b("disable_export"),onChange:()=>S("disable_export"),shouldTriggerUpsell:x("disable_export"),secondCaption:M("disable_export"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!y("disable_export")&&A]}),tooltip:!y("disable_export")&&w,isLocked:p.disable_export.isControlledByOrganization,lockedTooltip:(0,ee().C)()})],j=(0,G.jsx)(a().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,G.jsx)(z().BA,{title:j,rows:k,hideDividers:!0})}function Te(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>(0,p().getCanRestoreTeam)(e.teamStore)),[e.teamStore]);return(0,G.jsx)(X().p,{style:e.style,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),onClick:async()=>await(async e=>{let{teamStore:n,teamName:o}=e;await L().Q8({environment:t,teamStore:n,teamName:o,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{children:(0,G.jsx)(a().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(a().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})}function _e(e){const t=(0,i().v3)(),n=(0,r().IS)((()=>({archiveLabel:{color:A().Ay.red}})),[]);return(0,G.jsx)(X().p,{style:e.style,isRed:!0,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:async()=>{e.disabled||await L().mm({environment:t,teamStore:e.teamStore,from:"sidebar_team_modal"})},...e.tooltipEvents,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{style:n.archiveLabel,children:(0,G.jsx)(a().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(a().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Pe(e){return e?"disable":"allow"}const Be=(0,a().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Re(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,s().O$)(h().AppStoreCurrentSpaceStore),d=O(t),[c,u]=(0,o.useState)(void 0),[m,p]=(0,o.useState)(void 0),g=(0,r().IS)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,v]=(0,s().K8)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const y=f||"",b=v??"",x=b.length>0,S=null==c?void 0:c.trim(),M=null==m?void 0:m.trim(),A=""===S||(void 0===m||M===b.trim())&&(void 0===c||S===y.trim()),j=(0,G.jsx)(a().sA,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),C=(0,G.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,G.jsx)(V().x,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{k().createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:n,canUndo:!0,perform:n=>{L().n7({store:t,update:{icon:e},transaction:n})}})}}),d?(0,G.jsx)(_().A,{children:y}):(0,G.jsx)(Le,{value:c??y,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),T=(0,G.jsx)(a().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),R=P().A.formatMessage(Be.noDescription),D=d?(0,G.jsx)(_().A,{isMultiline:!0,isSecondaryColor:!x,children:x?b:R}):(0,G.jsx)(Le,{value:void 0===m?b:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:d,textarea:!0,autosize:!0,placeholder:R,style:g.description}),N=[(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(_().A,{isSmall:!0,children:j}),C]},"name"),(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(_().A,{isSmall:!0,children:T}),D]},"description")];return(0,G.jsxs)("div",{style:g.container,children:[(0,G.jsx)(z().BA,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:N}),!d&&(0,G.jsx)(I().A,{style:g.updateButton,disabled:A,size:"lg",onClick:async()=>{if(A)return;if(S&&S!==y.trim()){if(!(await(0,B().d$)({environment:n,spaceStore:l,teamName:S})))return}const{performResult:e,serverCommitResult:o}=k().createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,canUndo:!0,perform:e=>{L().n7({store:t,update:{name:S??y,description:M??b},transaction:e})}});try{await Promise.all([e,o])}catch(i){return}w().D6({label:(0,G.jsx)(a().sA,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,G.jsx)(a().sA,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,G.jsx)("br",{}),(0,G.jsx)($,{teamStore:t}),(0,G.jsx)(De,{teamStore:t}),(0,G.jsx)(K().A,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Le(e){const{value:t,style:n,onBlur:i,onChange:s,placeholder:r,disabled:a}=e,[l,d]=(0,o.useState)(!1);return(0,G.jsx)(j().A,{capture:l,render:o=>(0,G.jsx)(C().A,{textarea:e.textarea,autosize:e.autosize,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),s&&s(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:r,disabled:a,value:t,style:n,...o})})}function De(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:z().mZ,paddingBottom:z().mZ,paddingLeft:z().jN,paddingRight:z().jN}})),[]),[o,i]=(0,s().K8)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,N().R)(t),d=(0,U().G)(t),c=(0,E().q)(t.id),u=(0,D().c)(),m=c&&!u;if(void 0===o||!d)return null;const p=[],g=(0,G.jsx)(F().A,{buttonInternals:(0,G.jsx)(Ne,{isTeamOwner:l}),teamStore:t,placement:R().W.Bottom,alignment:R().C.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>(0,S().f)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default,transform:"rotate(-90deg)"}),isRed:!l});if(p.push(g),l)if(i)p.push((0,G.jsx)(Te,{teamStore:t,teamName:o,style:n.buttonStyle}));else{const e=(0,G.jsx)(T().A,{disableTooltip:!m,placement:R().W.Bottom,alignment:R().C.Start,renderTooltip:()=>(0,G.jsx)(a().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,G.jsx)(_e,{disabled:m,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});p.push(e)}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:{height:20,width:"100%"}}),(0,G.jsx)(z().BA,{title:(0,G.jsx)(a().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:p,itemStyle:{padding:0,margin:0}})]})}function Ne(e){let{isTeamOwner:t}=e;const n=(0,r().IS)((()=>({label:{color:t?"inherit":A().Ay.red}})),[t]);return(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{style:n.label,children:(0,G.jsx)(a().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(a().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Oe=()=>n(668657),Ee=()=>n(724356),Ue=()=>n(734225),Fe=()=>n(713471),Ke=()=>n(801008);function Ve(e){let{teamStore:t}=e;const n=(0,r().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.surface.elevated,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),o=(0,a().tz)(),i=(0,s().K8)((()=>g().A.state.memberFilterQuery),[]),l=(0,s().uB)(void 0,Ue().A),d=(0,Fe().X)(t),c=(0,s().K8)((()=>d&&!(0,p().isTeamInviteLinkDisabled)(t)),[t,d]);return(0,G.jsxs)("div",{style:n.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(Ee().u,{store:t,permissionsInviteStore:l,origin:(0,G.jsx)(T().A,{placement:R().W.Left,alignment:R().C.Start,textWrap:!0,renderTooltip:()=>d?(0,G.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,G.jsx)(a().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,G.jsx)("div",{style:{width:220},children:(0,G.jsx)(a().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,G.jsx)(I().A,{disabled:!d,size:"lg",onClick:()=>{l.setState({...l.state,modalOpen:!0})},...e,children:(0,G.jsx)(a().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),c&&(0,G.jsx)(Ke().m,{store:t,isSmall:!0})]}),(0,G.jsx)(C().A,{placeholder:o.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i,onChange:e=>{g().A.setState({...g().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Oe().q)(n.searchIcon),showClearButton:!0,format:C().C.Small})]})}n(333225),n(494367),n(516262),n(573119),n(240480),n(950443),n(619601);var ze=()=>n(162901),We=()=>n(188877),He=()=>n(129978),Ge=()=>n(509484),Ye=()=>n(985532),qe=()=>n(836331),$e=()=>n(111826),Qe=()=>n(305043),Ze=()=>n(528762),Xe=()=>n(14931),Je=()=>n(829182),et=()=>n(969836),tt=()=>n(28210),nt=()=>n(482570),ot=()=>n(388128),it=()=>n(931371),st=()=>n(736953),rt=(n(610931),()=>n(539645)),at=()=>n(145046),lt=()=>n(884373),dt=()=>n(307542),ct=()=>n(167532),ut=()=>n(962373),mt=()=>n(755769),pt=()=>n(764227),gt=()=>n(133926),ft=()=>n(282319),ht=()=>n(21209),vt=(n(113085),()=>n(218357)),yt=()=>n(405317),bt=()=>n(294997),xt=()=>n(951514),St=()=>n(352723),Mt=()=>n(24281);function At(e){var t;const{teamStore:n,memberInfo:l,permissionItem:d,memberName:c,style:u,onMenuItemClicked:m,isPermissionOverridden:p}=e,g=(0,i().v3)(),f=(0,a().tz)(),v=(0,o.useMemo)((()=>new(ut().A)),[]),y=(0,s().K8)((()=>n.getTeamPermission()),[n]),b=(0,s().O$)(h().AppStoreCurrentSpaceStore),x=(0,gt()._X)({name:"custom_teamspace_permissions",spaceId:null==b?void 0:b.id,userId:null==g||null===(t=g.currentUser)||void 0===t?void 0:t.id}),S=(0,N().R)(n),M=!(0,yt().e2)(x)&&!p||!S,A=(0,s().K8)((()=>{if(null==n||!n.isDefined())return;const e=f.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),t=(0,G.jsx)(a().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(o){const i=(null==y?void 0:y.role)===o?t:void 0;return(0,re().or)({teamValue:{id:n.id,permissions:n.getPermissionItems()},permissionRole:o})?{role:o,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:i}:{role:o,tag:i}}))}),[y,f,n]);const w=(0,r().IS)((e=>({overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},roleSelectButton:{marginRight:0,fontSize:12,color:e.text.secondary,visibility:p?void 0:"hidden"},disabledItem:{...u,color:e.text.tertiary}})),[u,p]),j=(0,G.jsxs)("div",{style:w.overrideTitle,children:[(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),null!=x&&x.upsell&&!p?(0,G.jsx)(Mt().B,{upsell:null==x?void 0:x.upsell,analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,G.jsx)(xt().Ay,{role:"owner"===l.type?"none":d.role,table:vt().yK,type:"user"===l.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===l.entity_type?"user_permission_item":"group_permission_item",disabled:M,buttonStyle:w.roleSelectButton,availableRoleItems:A,header:(0,G.jsx)(_().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,G.jsx)(a().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){at().ui({message:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:c,role:(0,St().qZ)(e).toLowerCase()}}),description:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:at().zw,items:[{label:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:t}=k().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:g,canUndo:!0,perform:t=>{L().b4({memberInfo:l,teamStore:n,transaction:t,environment:g,permissionRole:e})}});await t,n.isDefault()&&(n.getMembershipDefinedOnTeam().some((e=>(0,bt().Q6)(e,l)))||await L().Zd({environment:g,teamStore:n,teamMemberInfos:[l],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),m&&m())},buttonPopupStore:v,placementToOrigin:mt().UV.Right,alignmentToOrigin:mt().MY.End})]});return(0,G.jsx)(T().A,{placement:M?R().W.Right:R().W.Left,textWrap:!0,renderTooltip:()=>M&&!S?(0,G.jsx)(a().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,G.jsx)(a().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,G.jsx)(ge().A,{...e,focused:!1,disabled:M,style:M?w.disabledItem:u,textWrapperStyle:{marginRight:0},onClick:()=>v.setState({open:!0}),title:j,icon:p?(0,G.jsx)("div",{style:{marginTop:8},children:(0,rt().o)({width:14})}):void 0})})}function wt(e){let{teamStore:t,memberInfo:n,permissionItem:o,memberName:r,isPermissionOverridden:l,disabled:c}=e;const u=(0,s().uB)(void 0,ut().A),m=(0,i().v3)(),g=(0,s().O$)(h().AppStoreCurrentSpaceStore),f=(0,s().K8)((()=>h().default.state.currentUserStore),[]),v=(0,s().K8)((()=>{const e=null==f?void 0:f.userId;return"user"===n.entity_type&&n.user_id===e}),[null==f?void 0:f.userId,n]),y=()=>u.setState({...u.state,open:!1}),b=(0,N().R)(t),x=(0,gt().P9)({name:"team_self_promotion",spaceId:null==g?void 0:g.id,userId:null==f?void 0:f.userId}),S=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),M=(0,s().K8)((()=>{const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return e.length+n.length}),[t]),A=(0,ht().$)(t),w=0===M,j=async e=>{y();const o="owner"===e?(0,G.jsx)(a().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,G.jsx)(a().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type||"group"===n.entity_type){const e=async()=>{const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:m,canUndo:!0,perform:e=>{L().D6({environment:m,memberInfo:n,teamStore:t,transaction:e})}});await e},o=async()=>{await L().z9({environment:m,teamStore:t,currentSpaceStore:g,from:"team_settings_members",action:"upgradeToOwner"})};w&&v?at().ui({message:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:at().zw,items:[{label:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await e()}}]}):v&&x&&S?await o():await e()}}else v&&b?at().ui({message:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:at().zw,items:[{label:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:C}]}):await C();else{const i=(0,p().getTeamsWithUserDirectMembership)(n.user_id).length;at().ui({message:(0,G.jsx)(G.Fragment,{children:i>1?(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:o,numberOfOtherTeams:i-1}}):(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:o}})}),showCancel:!0,keepFocus:!1,handleCancel:at().zw,items:[{label:(0,G.jsx)(a().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(g){const{serverCommitResult:o}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:m,canUndo:!0,perform:o=>{L().Nd({environment:m,userId:n.user_id,teamStore:t,transaction:o,spaceStore:g,newTeamRole:e})}});await o}}}]})}},C=async()=>{if("owner"!==n.type||"user"!==n.entity_type&&"group"!==n.entity_type){if("member"===n.type){const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:m,canUndo:!0,perform:e=>{L().P8({environment:m,memberInfo:n,teamStore:t,transaction:e})}});await e}}else{const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:m,canUndo:!0,perform:e=>{L().qS({memberInfo:n,teamStore:t,transaction:e,environment:m})}});await e}},I=async()=>{var e;const{entity_type:o}=n;switch(y(),o){case"group":const i=null===(e=st().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===e?void 0:e.group;if(!i)throw new Error("Permission group not found in space.");L().BQ({environment:m,teamStore:t,group:i});break;case"user":await L().fy({environment:m,teamStore:t,userId:n.user_id,from:"team_settings_member_table",userGroupsInTeam:A});break;default:(0,d().HB)(o)}};return(0,G.jsx)(fe().Ay,{buttonPopupStore:u,placementToOrigin:mt().UV.Bottom,renderOrigin:e=>(0,G.jsx)(jt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:o,memberInfo:n,disabled:c}),render:()=>(0,G.jsx)(kt,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:o,memberName:r,numberOfOwners:M,isMemberCurrentUser:v,onMenuItemClicked:j,onRemoveClicked:I,onSubMenuItemClicked:y}),popupType:fe().z7.Popup})}function kt(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:o,permissionItem:i,memberName:a,numberOfOwners:d,isMemberCurrentUser:u,onRemoveClicked:p,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const v=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,dt().Qd)()}),[]),y=(0,s().K8)((()=>t.isDefault()),[t]),b=(0,ct().J)(),x=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,pt().OX)())}),[]),S=(0,N().R)(t),M=(0,Fe().X)(t),A=1===d,w=0===d,k=(0,r().IS)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular}}}),[]),j=(e,t,n)=>(0,ft().W)({isCurrentUserTeamOwner:S,role:e,isDefaultTeam:y,userIsSpaceAdmin:Boolean(b),userIsEnterpriseWorkspaceOwner:x,originalTeamMemberInfo:t,onlyHasOneOwner:A,isUnowned:w,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:n}),C=(e,t)=>{const{isDisabled:o,disabledReason:i}=j(e,t,M);return{key:e,action:()=>g(e),render:s=>{const r=!n&&t.type===e;return(0,G.jsx)(T().A,{disableTooltip:!o,placement:R().W.Right,textWrap:!0,renderTooltip:()=>i,render:t=>(0,G.jsx)("span",{...t,children:(0,G.jsx)(ge().A,{...s,style:r?k.menuItem:k.indentedMenuItem,disabled:o,disabledFeedback:o,title:(0,G.jsx)(Ct,{type:e}),caption:Tt(e),shouldWrapCaption:!0,icon:r?(0,rt().o)({width:14}):void 0})})})}}},I=y&&"user"===o.entity_type,_="group"!==o.entity_type&&v,P=[{key:"teamRoles",items:l().oE([C("owner",o),C("member",o),_?C("team_level_guest",o):void 0,_t({onRemoveClicked:p,styles:k,...j("none",o,M),isMemberInDefaultTeam:I}),..."owner"===o.type||w?[]:[{key:"divider",action:()=>{},render:()=>(0,G.jsx)(lt().A,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,G.jsx)("span",{...e,children:(0,G.jsx)(At,{teamStore:t,memberInfo:o,permissionItem:i,memberName:a,onMenuItemClicked:f,isPermissionOverridden:n,style:n?k.menuItem:k.indentedMenuItem})})}]]),render:e=>(0,G.jsx)(ye().A,{...e,topBorder:0!==e.index})}];return(0,G.jsx)(he().A,{className:m().yw8,menuType:xe().gu.Popup,children:(0,G.jsx)(ve().Ay,{type:ve().Oh.Vertical,initialFocus:void 0,sections:P})})}function jt(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:o,permissionItem:i,memberInfo:s}=e;const l=(0,r().IS)((e=>({label:{color:e.text.primary,fontSize:12.5,fontWeight:c().Wy.regular},overrideLabel:{color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d().HB)(e)}}(n);return It(e)}(s.type,o,i.role);return(0,G.jsxs)(X().p,{disabled:n,...t,children:[o&&(0,G.jsxs)("span",{style:l.overrideLabel,children:[(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,G.jsx)("span",{style:l.label,children:u}),!n&&(0,ie().b)(l.chevron)]})}function Ct(e){let{type:t}=e;const n=It(t);return(0,G.jsx)("div",{children:(0,G.jsx)("span",{children:n})})}function It(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(a().sA,{...p().ROLE_MESSAGE_MAP[e].label});case"none":return;default:(0,d().HB)(e)}}function Tt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(a().sA,{...p().ROLE_MESSAGE_MAP[e].caption});case"none":return;default:(0,d().HB)(e)}}function _t(e){let{styles:t,isDisabled:n,disabledReason:o,onRemoveClicked:i,isMemberInDefaultTeam:s}=e;return{key:"remove",action:i,render:e=>(0,G.jsx)(T().A,{disableTooltip:!n,placement:R().W.Right,textWrap:!1,renderTooltip:()=>o,render:o=>(0,G.jsx)("span",{...o,children:(0,G.jsx)(ge().A,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:n,disabledFeedback:!0,title:(0,G.jsx)(a().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var Pt=()=>n(501578);function Bt(e){const{icon:t,label:n,name:o,tag:i,style:s}=e,a=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...s},labelContainer:{display:"flex",flexDirection:"column",...c().RC,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[s]);return(0,G.jsxs)("div",{style:a.container,children:[t,(0,G.jsxs)("div",{style:a.labelContainer,children:[(0,G.jsxs)("div",{style:a.nameContainer,children:[(0,G.jsx)(Pt().j,{style:a.name,children:o}),i]}),n&&(0,G.jsx)(_().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,G.jsx)(Pt().j,{children:n})})]})]})}function Rt(e){const{iconComponent:t,label:n,name:o,permissionRoleSelectComponent:i,tag:s,tooltip:a,style:l}=e,d=(0,r().IS)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,G.jsxs)("div",{style:d.permissionRow,children:[(0,G.jsx)(Bt,{icon:t,name:o,tag:s,label:n,style:{minWidth:200,marginRight:6}}),(0,G.jsx)(T().A,{textWrap:!0,style:{width:210},disableTooltip:!a,placement:R().W.Left,renderTooltip:()=>a,render:e=>(0,G.jsx)("span",{...e,children:i})})]})}function Lt(e){const{type:t,store:n,permissionItem:o,memberInfo:l}=e,c=(0,i().v3)(),u=(0,a().tz)(),m="group"===t?e.permissionGroup:void 0,g="user"===t?e.userStore:void 0,f=(0,s().O$)(h().AppStoreCurrentSpaceStore),v=(0,s().K8)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,it().sE)(f,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d().HB)(t)}}),[t,l,f]),y=(0,N().R)(n),b=(0,Fe().X)(n),x=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,s().K8)((()=>{const e=c.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=f&&f.isDefined()&&n.isDefined()&&t&&e)&&(0,p().isEligibleToUpgradeMemberToOwnerForUnownedTeam)({environment:c,teamStore:n,spaceStore:f})}),[c,f,n]),M=(0,s().K8)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return Boolean(e.find((e=>(0,se().Ds)(e)&&e.group_id===l.group_id)));case"user":return Boolean(e.find((e=>(0,se().B2)(e)&&e.user_id===l.user_id)));default:return!1}}),[l,n]),{name:A,label:w,icon:k,isSelfUserPermission:j}=(0,s().K8)((()=>{const e=c.currentUser.id;switch(t){case"group":return Nt({permissionGroup:m,spaceId:null==f?void 0:f.id});case"user":return function(e){var t;let{intl:n,userStore:o,currentUserId:i}=e;const s=void 0!==i&&(null==o||null===(t=o.getModel())||void 0===t?void 0:t.id)===i;return{name:(0,Xe().c6)(n,null==o?void 0:o.getModel()),label:null==o?void 0:o.getEmail(),icon:(0,G.jsx)(nt().A,{avatarShouldShowShadow:!0,userStore:o,size:32}),isSelfUserPermission:s}}({intl:u,userStore:g,currentUserId:e});default:(0,d().HB)(t)}}),[c.currentUser.id,t,m,null==f?void 0:f.id,u,g]),C=(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,G.jsx)(wt,{teamStore:n,memberInfo:l,memberName:A,permissionItem:o,isPermissionOverridden:M,disabled:b&&"member"===l.type?!y&&M:!y&&!S||"team_level_guest"===l.type&&!x})}),I=(0,r().IS)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17},titleYouIndicator:{color:e.text.secondary}})),[]),T=(0,G.jsxs)("div",{style:{display:"flex",gap:4},children:[A,j&&(0,G.jsx)("span",{style:I.titleYouIndicator,children:(0,G.jsx)(a().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})})]});return(0,G.jsx)(Rt,{style:I.row,tag:(0,se().EH)(v)?(0,G.jsx)(Je().A,{desktopStyle:I.pill,mobileStyle:I.pill,role:Dt(v)}):"group"===t?(0,G.jsx)("div",{style:I.pill,children:k}):void 0,permissionRoleSelectComponent:C,iconComponent:"group"===t?(0,G.jsx)(et().A,{size:32}):k,name:T,label:w})}function Dt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d().HB)(e)}}function Nt(e){var t;let{spaceId:n,permissionGroup:o}=e;const{name:i,icon:s}=o,r=(null===(t=st().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===o.group_id)))||void 0===t?void 0:t.memberCount)??0;return{name:i||(0,G.jsx)(a().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,G.jsx)(T().A,{placement:R().W.Bottom,alignment:R().C.Start,disableTooltip:0===r,renderTooltip:()=>(0,G.jsx)(ot().Q,{group:o,limit:10,noMembersMessage:void 0}),render:e=>(0,G.jsxs)("div",{...e,children:[(0,G.jsx)(a().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,G.jsx)(a().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:r}})]})}),icon:s&&(0,G.jsx)(tt().B,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:s&&n?{icon:s,pointer:{table:Ze().NX,id:n}}:void 0}),isSelfUserPermission:!1}}var Ot=()=>n(339189),Et=()=>n(863969),Ut=()=>n(104838);function Ft(e){let{teamStore:t,...n}=e;const l=(0,i().v3)(),d=(0,Et().O)(),c=(0,a().tz)(),u=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,o.useCallback)((e=>{w().D6({label:(0,G.jsx)(a().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,o.useCallback)((async(e,n)=>{await L().Zd({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Ut().x(l):m(n)}),[l,m,t]),g=(0,o.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),f=(0,o.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.group_id},t)),[p]),h=(0,s().K8)((()=>{if("groupToAdd"in n)return Nt({spaceId:d,permissionGroup:n.groupToAdd})}),[d,n]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,Xe().c6)(c,e);return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(Bt,{icon:(0,G.jsx)(nt().A,{userValue:e,size:32}),name:t,label:e.email}),Kt((()=>{g(e,t)}))]})}{if(!d||!h)return(0,G.jsx)(G.Fragment,{});const{groupToAdd:e}=n;return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(Bt,{icon:(0,G.jsx)(et().A,{size:32}),name:h.name,label:h.label,tag:(0,G.jsx)("div",{style:u.pill,children:h.icon})}),Kt((()=>{f(e,h.name)}))]})}}function Kt(e){return(0,G.jsx)(X().p,{isBlue:!0,onClick:e,icon:Ot().W,children:(0,G.jsx)(a().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Vt=()=>n(175532),zt=()=>n(259849);function Wt(e){let{sortType:t,onChangeSortType:n}=e;const o=(0,r().IS)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",s=e=>{const o=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:o})};return(0,G.jsxs)("div",{style:o.container,children:[(0,G.jsx)(Ht,{title:(0,G.jsx)(a().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>s("name")}),(0,G.jsx)(Ht,{title:(0,G.jsx)(a().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>s("role")})]})}function Ht(e){let{sortedType:t,title:n,onClick:o}=e;const i=(0,r().IS)((e=>({button:{color:e.text.secondary,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,G.jsxs)(X().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:o,children:["ascending"===t&&(0,zt().q)(i.sortIcon),"descending"===t&&(0,Vt().P)(i.sortIcon),n]})}function Gt(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,r().IS)((e=>({container:{display:"block",overflow:"hidden"},noResult:{fontSize:c().J.UIRegular.desktop,color:e.text.secondary,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),u=(0,a().tz)(),[m,f]=(0,o.useState)({column:"role",sortedAscending:!1}),v=(0,Fe().X)(t),y=(0,s().K8)((()=>{const e=Qe().subscriptionDataStoreInstance.state;return e?t.getMemberInfoUsingSpaceMembers((0,$e().Ye)(e))??[]:[]}),[t]),b=(0,s().O$)(h().AppStoreCurrentSpaceStore),x=(0,s().K8)((()=>h().default.state.currentUserStore),[]),{permissionRowInfos:S,numNotShown:M}=(0,s().K8)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:n,intl:o}=e;if(""===n)return t;return(0,We().Ay)(n,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name||"";case"user":const{userStore:n}=e;return n.getSearchName(o);default:(0,d().HB)(t)}}))}({permissionRowInfos:(0,p().getPermissionRowInfos)({currentUserStore:x,currentSpaceStore:b,teamStore:t,members:y}),memberFilterQuery:g().A.state.memberFilterQuery,intl:u}),n=function(e){let{permissionRowInfos:t,sortType:n,intl:o}=e;const{column:i,sortedAscending:s}=n,r={permissionRowInfos:t,sortedAscending:s};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n}=e;const o=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const n=e.memberInfo.entity_type,o=t.memberInfo.entity_type;return i.indexOf(n)-i.indexOf(o)})).sort(((e,t)=>{const i=e.memberInfo.type,s=t.memberInfo.type,r=o.indexOf(i)-o.indexOf(s);return n?-r:r}))}(r);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n,intl:o}=e;return[...t].sort(((e,t)=>{const i=Yt(e,o)??"",s=Yt(t,o)??"";if(i===s)return 0;const r=i<s?-1:1;return n?-r:r}))}({...r,intl:o});(0,d().HB)(i)}({permissionRowInfos:e,sortType:m,intl:u}),o=g().A.state.limitMembers?n.slice(0,50):n;return{permissionRowInfos:o,numNotShown:e.length-o.length}}),[b,x,y,t,m,u]),A=(0,He().fJ)(Ge().T.searchActions),w=(0,s().K8)((()=>{const e=Ye().A.state.shouldUseEdgeCache,t=qe().default.checkGate({gateName:"edge_cache_settings"});return e&&t}),[]),k=(0,s().K8)((()=>g().A.state.memberFilterQuery),[]),[j]=(0,ze().Yb)((async()=>{if(!v||null==k||!k.trim().length||"resolved"!==A.status)return[];const e=A.value;return[...(await e.searchSpaceUsers({environment:n,query:k,membersOnly:!0,limit:5,shouldUseEdgeCacheRollout:w})).map((e=>({type:"user",value:e}))),...e.searchSpaceGroups({query:k,intl:u}).map((e=>({type:"group",value:e})))]}),[v,k,A.status,A.value,n,u,w]),C=(0,s().K8)((()=>{if("resolved"!==j.status)return[];const e=new Set(S.map($t));return j.value.filter((t=>!e.has("user"===t.type?t.value.id:t.value.group_id))).slice(0,5)}),[j.status,j.value,S]),I=Boolean(null==k?void 0:k.trim().length),T=S.length>0;return(0,G.jsxs)("div",{style:l.container,children:[(0,G.jsx)(qt,{title:I?(0,G.jsx)(a().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,G.jsx)(Wt,{sortType:m,onChangeSortType:f}),rows:S,renderRow:e=>(0,G.jsx)(Lt,{store:t,...e})}),M>0&&(0,G.jsx)(X().p,{isGray:!0,size:"xs",style:l.showMore,onClick:()=>{g().A.update((e=>({...e,limitMembers:!1})))},children:(0,G.jsx)(a().sA,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:M}})}),C.length>0&&(0,G.jsx)(qt,{title:(0,G.jsx)(a().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:C,renderRow:e=>"user"===e.type?(0,G.jsx)(Ft,{teamStore:t,memberToAdd:e.value}):(0,G.jsx)(Ft,{teamStore:t,groupToAdd:e.value})}),!T&&0===C.length&&(0,G.jsx)("div",{style:l.noResult,children:(0,G.jsx)(a().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Yt(e,t){const{type:n}=e;if("user"===n){const{userStore:n}=e;return n.getDisplayName(t)}if("group"===n){const{permissionGroup:t}=e;return t.name}(0,d().HB)(n)}function qt(e){let{rows:t,renderRow:n,title:i}=e;const s=(0,r().IS)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,G.jsxs)(G.Fragment,{children:[i&&(0,G.jsx)(_().A,{isSmall:!0,children:i}),(0,G.jsx)("div",{style:s.membersList,children:t.map(((e,t)=>(0,G.jsxs)(o.Fragment,{children:[t>0&&(0,G.jsx)("div",{style:s.memberDivider}),n(e)]},t)))})]}):null}function $t(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d().HB)(e)}}function Qt(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,G.jsxs)("div",{style:n.content,children:[(0,G.jsx)(Ve,{teamStore:t}),(0,G.jsx)(Gt,{store:t})]})}var Zt=()=>n(758989);function Xt(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().tz)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,s().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=O(t),u=(0,s().K8)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:o.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[o]),m=(0,r().IS)((e=>({button:{fontSize:12.5,marginRight:0,color:e.text.secondary}})),[]),p=l&&(0,G.jsx)(xt().Ay,{role:l.role,table:vt().yK,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,se().B2)(t)||(0,se().Ds)(t))&&(0,re().dI)(e,t.role))).length>0){if(!(await(0,B().fT)()))return}k().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{L().HU({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:[]})}})}}),g=(0,s().K8)((()=>t.getName()),[t]),f=(0,s().K8)((()=>t.getIcon()),[t]),h=f&&Zt().T8(f.icon)?Zt().VA(f.icon):"gray",v=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,y=(0,G.jsx)(V().x,{disabled:!0,store:t,size:z().QT,icon:v});return p?(0,G.jsx)(Rt,{permissionRoleSelectComponent:p,iconComponent:y,name:Jt(g)}):null}function Jt(e){return e?(0,G.jsx)(a().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(a().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function en(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().DP)(),l=(0,a().tz)(),{teamPermissionItem:d,teamPermissions:c}=(0,s().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=O(t),m=(0,s().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),o=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,re().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:o}}:{role:e,disabledInfo:void 0}}return[i("editor"),i("read_and_write"),i("comment_only"),i("reader")]}),[l,t]),p=d&&(0,G.jsx)(xt().Ay,{role:d.role,table:vt().yK,type:(0,se().gl)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:m,onChange:async e=>{const o=c.filter((t=>((0,se().B2)(t)||(0,se().Ds)(t))&&(0,re().dI)(e,t.role)));if(o.length>0){if(!(await(0,B().fT)()))return}k().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{L().xp({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:o})}})}}),{teamName:g}=(0,s().K8)((()=>({teamName:t.getName()})),[t]),f=(0,G.jsx)(V().x,{disabled:!0,store:t,size:z().QT});return(0,G.jsx)(Rt,{permissionRoleSelectComponent:p,iconComponent:f,name:tn(g)})}function tn(e){return e?(0,G.jsx)(a().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(a().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var nn=()=>n(409211),on=()=>n(132634);function sn(e){const{teamStore:t,teamOwnerIds:n}=e,o=(0,r().DP)(),i=(0,s().K8)((()=>t.getName()),[t]),l=(0,s().K8)((()=>t.getTeamOwnerPermission()),[t]),d=(0,s().K8)((()=>h().default.state.currentUserStore),[]),c=(0,s().K8)((()=>d?n.map((e=>v().LU.createChildStore(d,{table:nn().oo,id:e}))):[]),[d,n]);return(0,G.jsx)(Rt,{tooltip:(0,G.jsx)(a().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,G.jsx)(xt().Ay,{role:"editor",table:vt().yK,type:l&&(0,se().nl)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:o.text.secondary,marginRight:0},availableRoleItems:[]}),iconComponent:(0,G.jsx)(on().l,{teamStore:t,ownerStores:c,isSmall:!0}),name:rn(i)})}function rn(e){return e?(0,G.jsx)(a().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,G.jsx)(a().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var an=()=>n(748267),ln=()=>n(919536);function dn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().O$)(h().AppStoreCurrentSpaceStore),{iconComponent:r,spaceName:a}=(0,s().K8)((()=>{if(!o)return{iconComponent:void 0,spaceName:void 0};const e=(0,W().GK)(n,o);return{iconComponent:(0,G.jsx)(V().x,{disabled:!0,store:o,size:z().QT}),spaceName:e}}),[o,n]);return(0,G.jsx)(Rt,{permissionRoleSelectComponent:(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,G.jsx)(un,{teamStore:t})}),iconComponent:r,name:cn(a)})}function cn(e){return e?(0,G.jsx)(a().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,G.jsx)(a().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function un(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().DP)(),d=(0,s().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=O(t),u=(0,s().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ue({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,G.jsx)(T().A,{renderTooltip:()=>(0,G.jsx)(a().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,an().g)({width:14,height:14,fill:o.timelineRed,marginRight:4}),(0,G.jsx)("div",{style:{fontSize:12.5,color:o.timelineRed,marginRight:8},children:(0,G.jsx)(a().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l().Ul(m,(e=>-se().TE[e])).map((e=>({role:e})));return(0,G.jsx)(xt().Ay,{role:d.role,table:vt().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:e,onChange:e=>{const o={...d,role:e};k().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{ln().bo({environment:n,store:t,permissionItems:[o],transaction:e})}})}})}}function mn(e){let{teamStore:t}=e;const n=(0,s().K8)((()=>t.isDefault()),[t]),o=(0,s().K8)((()=>t.getOwnerUserIds()),[t]),i=(0,s().K8)((()=>{const e=h().default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,dt().Qd)())}),[n]),a=(0,r().IS)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,G.jsxs)("div",{style:a.container,children:[(0,G.jsx)(sn,{teamStore:t,teamOwnerIds:o},"0"),(0,G.jsx)(en,{teamStore:t},"1"),i&&(0,G.jsx)(Xt,{teamStore:t},"2"),!n&&(0,G.jsx)(dn,{teamStore:t},"3")]})}var pn=()=>n(582295);function gn(e){let{teamStore:t}=e;const n=(0,r().IS)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(fn,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(pn().a,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,G.jsx)(Qt,{teamStore:t})]})}function fn(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,s().K8)((()=>t.getName()),[t]),d=(0,r().IS)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,o.useCallback)(((e,o)=>{L().qH({environment:n,accessLevel:e,isDefault:o,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]),m=[(0,G.jsx)(H().u,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,G.jsx)(mn,{teamStore:t},"permissions")];return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(z().BA,{title:(0,G.jsx)(a().sA,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:d.teamSettingsListItems}),(0,G.jsx)(K().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,G.jsx)(a().sA,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var hn=()=>n(468343),vn=()=>n(655830),yn=()=>n(922172),bn=()=>n(709237),xn=()=>n(142708),Sn=()=>n(732165),Mn=()=>n(412084),An=()=>n(207762),wn=()=>n(678523);function kn(e){return(0,G.jsx)(wn().A,{...e,children:(0,G.jsx)(a().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function jn(e){const{teamStore:t}=e,n=(0,s().K8)((()=>g().A.state.tab),[]);if(void 0===n)return null;switch(n){case g().p.General:return(0,G.jsx)(Re,{teamStore:t});case g().p.Members:return(0,G.jsx)(gn,{teamStore:t});case g().p.Security:return(0,G.jsx)(Ce,{teamStore:t});default:(0,d().HB)(n)}}function Cn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:o,isDefined:i}=(0,s().K8)((()=>{const e=v().LU.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,G.jsx)(Sn().A,{avatarShouldShowShadow:!0,userStore:o,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function In(e){const{userIds:t,label:n,hasMarginTop:o}=e,i=(0,s().O$)(h().AppStoreCurrentSpaceStore);return i?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Mn().A,{hasMarginTop:o,children:n}),t.map((e=>(0,G.jsx)(Cn,{userId:e,currentSpaceStore:i},e)))]}):null}function Tn(){const e=(0,i().v3)(),t=(0,s().O$)(h().AppStoreCurrentSpaceStore),n=(0,s().O$)(h().AppStoreCurrentSpaceViewStore),o=(0,i().Y0)(),v=(0,r().IS)((e=>({modal:{width:o.isMobile?"auto":630,height:o.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c().Wy.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.text.primary,fontWeight:c().Wy.regular,textTransform:"unset",fontSize:11}})),[o.isMobile]),{open:y,tab:S,teamStore:M}=(0,s().K8)((()=>{const{open:e,tab:t}=g().A.state;return{open:e,tab:t,teamStore:g().A.getTeamStore()}}),[]),A=(0,s().K8)((()=>null==M?void 0:M.getSettings()),[M]),w=(0,N().R)(M);if(!t||!n||!M)return null;const k=[g().p.General,g().p.Members,g().p.Security];return(0,G.jsx)(yn().a,{open:y,innerStyle:v.modal,onDismiss:()=>{g().A.reset()},render:()=>y?(0,G.jsx)("div",{className:m().kYU,style:{height:"100%"},children:(0,G.jsx)("div",{style:v.modalWrap,children:(0,G.jsx)(vn().A,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l().D_,onLeft:l().D_,onRight:l().D_,onSelectAll:l().D_,onRedo:l().D_,onUndo:l().D_,onCut:l().D_,onCopy:l().D_,onPaste:l().D_,onKeypress:l().D_,onDelete:l().D_,onTab:l().D_,children:(0,G.jsxs)("div",{style:v.innerWrap,children:[(0,G.jsxs)("div",{style:v.header,children:[(0,G.jsx)(V().x,{disabled:!0,store:M,size:24,style:v.icon}),(0,G.jsx)(bn().A,{store:M,style:{fontSize:16,fontWeight:c().Wy.semibold}}),(0,p().shouldShowLockIconForTeam)(A)&&(0,G.jsx)(x().A,{iconStyle:v.lockIcon}),(0,p().isUnownedTeam)({membership:M.getRawMembership()})&&(0,G.jsx)("div",{style:{gap:5,display:"flex"},children:(0,G.jsx)(kn,{desktopStyle:v.unownedPill,mobileStyle:v.unownedPill,innerStyle:v.unownedPillInner})}),(0,G.jsx)("div",{style:{flexGrow:1}}),(0,G.jsx)(b().TeamJoinLeaveButton,{teamStore:M,onLeavingTeam:()=>g().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,G.jsx)(An().Ay,{tabs:k.map((e=>function(e,t){switch(e){case g().p.General:return(0,G.jsx)(a().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g().p.Members:return(0,G.jsx)(_n,{teamStore:t});case g().p.Security:return(0,G.jsx)(a().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d().HB)(e)}}(e,M))),selectedIndex:(0,d().O9)(S)?k.indexOf(S):1,onChange:t=>{y&&(u().Vg(e,{store:M,tab_old_value:S??g().p.General,tab_new_value:k[t]}),g().A.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginLeft:-8},style:v.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,G.jsx)(xn().H,{type:f().A.Y,style:v.scroller,children:(0,G.jsx)("div",{style:v.contentWrap,children:(0,G.jsx)(jn,{currentSpaceStore:t,teamStore:M,userIsTeamOwner:w})})})]})})})}):null})}function _n(e){let{teamStore:t}=e;const n=(0,hn().h)(t),o=(0,r().DP)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(a().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,G.jsx)("span",{children:" "}),(0,G.jsx)("div",{style:{color:o.text.tertiary},children:n})]})}function Pn(e){let{title:t,caption:n,secondCaption:o,on:s,disabled:a,tooltip:l,style:d,switcherStyle:c,onChange:u,shouldTriggerUpsell:m,upsellTier:p,isLocked:g,lockedTooltip:f}=e;const h=(0,i().v3)(),v=(0,r().IS)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:m?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18,...c}})),[m,d,c]);return(0,G.jsxs)("div",{style:v.root,onClick:()=>{if(m)return y().K(h,{from:"team_security_settings",upsell:{type:"product",product:p,limit:{type:"none"},trialability:"none"},dontOpenPlansOnCancel:!0})},children:[(0,G.jsxs)("div",{style:v.title,children:[t,n&&(0,G.jsx)(_().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),o&&(0,G.jsx)(_().A,{isSmall:!0,children:o})]}),(0,G.jsx)("div",{style:v.switcherWrap,children:(0,G.jsx)(T().A,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)("div",{...e,children:(0,G.jsx)(be().A,{on:s,disabled:a,onClick:u,isLocked:g,lockedTooltip:f})})})})]})}},950452:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(580257).A)},953798:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(962373).A)},957356:(e,t,n)=>{n.d(t,{J8:()=>g,kS:()=>p,p7:()=>m});n(242343);var o=()=>n(237385),i=()=>n(174114),s=()=>n(198654),r=()=>n(653998),a=()=>n(209684),l=()=>n(273520),d=()=>n(798508),c=()=>n(867934),u=n(163643);function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().vG[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().Bb[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().qg,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r().sA,{...d().PP[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const t=(0,o().Y0)(),{buttonPopupStore:n,currentVisibilityLabel:r,renderVisibilityLevelsMenu:d,disabled:c}=e,m=(0,i().IS)((e=>({chevronDownIcon:{width:10,marginLeft:4,marginRight:4,fill:e.lightIconColor},currentVisibilityLabel:{color:e.text.secondary,paddingRight:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().Ay,{popupType:l().z7.Popup,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(a().p,{style:m.currentVisibilityLabel,disabled:c,...e,children:[r,(0,s().b)(m.chevronDownIcon)]}),render:d})}},957857:(e,t,n)=>{n.d(t,{s:()=>r});var o=n(242343),i=()=>n(611758),s=n(163643);const r=o.memo((function(e){let{area:t,viewsMainTabId:r,children:a,className:l,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:u}=(0,n(546820).LH)(),m=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&("page_main"===t&&u.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:r}:{area:t}}}))}),[t,c,u,r]),p=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,u]);return(0,s.jsx)("div",{onMouseEnter:m,onMouseLeave:p,className:l,style:d,children:a})}))},966358:(e,t,n)=>{n.d(t,{A:()=>a});n(725707),n(491955),n(403517);var o=n(242343),i=()=>n(437071),s=n(163643);function r(){const[e,t]=(0,o.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,o.useEffect)((()=>(null===i()||void 0===i()||i().snackbarReady(!0),()=>{null===i()||void 0===i()||i().snackbarReady(!1)})),[]),(0,o.useEffect)((()=>{const e=new(n(496985).default)((()=>n(427846).Ay.state.currentItem),{debugName:"currentItemStore"});let o=null;function i(){const n=e.state;n&&o!==n.key?(t({type:"push",item:n}),o=n.key):n||t({type:"clear"})}return e.addListener(i),()=>{e.removeListener(i)}}),[]),(0,s.jsx)(n(41717).A,{open:e.length>0,zIndex:201,children:e.map((e=>(0,o.createElement)(l,{...e,key:e.item.key,dispatch:t})))})}const a=o.memo(r),l=o.memo((function(e){let{dispatch:t,isAnimatingOut:i,item:r}=e;const a=(0,n(174114).DP)(),l=(0,n(348860).L)(),d=(0,o.useCallback)((()=>{t({type:"delete",key:r.key})}),[t,r.key]),c=(0,o.useRef)(i);(0,o.useEffect)((()=>{if(!c.current&&i){const e=setTimeout(d,270);return()=>{d(),clearTimeout(e)}}c.current=i}),[i,d]);const u=r.position??"bottom",m="top"===u?{top:24}:{bottom:l};return(0,s.jsx)("div",{style:{...m,position:"fixed",left:0,width:"100%",display:"flex",zIndex:1e6,padding:4,pointerEvents:"none"},children:(0,s.jsxs)("div",{"aria-live":"polite",style:{background:a.tooltipBackground,color:a.text.contrastPrimary,borderRadius:8,padding:"11px 16px",boxShadow:a.shadowLG,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...r.style,animationName:`snackbar-slide-in-${u}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:i?"scale(0.95)":"scale(1)",opacity:i?0:1},onTransitionEnd:i?d:void 0,children:[r.label,r.helpUrl&&(0,s.jsx)(n(931085).A,{href:r.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:a.text.contrastPrimary},children:(0,n(284594).$)({fill:a.text.contrastSecondary})}),(0,s.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:r.right})]})})}))},972522:(e,t,n)=>{n.d(t,{A:()=>a});n(242343);var o=()=>n(174114),i=()=>n(81322),s=()=>n(417653),r=n(163643);function a(e){const{top:t,right:n,onClick:a}=e,l=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,r.jsx)("div",{style:l.buttonBackground,children:(0,r.jsx)(s().A,{style:l.button,hoveredStyle:l.buttonHovered,onClick:a,children:(0,i().V)(l.icon)})})}},978398:(e,t,n)=>{n.d(t,{z:()=>i});class o extends(()=>n(129044))().default{getInitialState(){return{isOpen:!1}}}const i=new o},978968:(e,t,n)=>{n.d(t,{m:()=>o});const o=(0,n(680369).xh)("google",{default:{loader:()=>n.e(78472).then(n.bind(n,101014))},darkMode:{loader:()=>n.e(78472).then(n.bind(n,952472))}})},986571:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>z,useSortActions:()=>G});n(403517);var o=n(242343),i=()=>n(237385),s=()=>n(803290),r=()=>n(174114),a=()=>n(17127),l=()=>n(725494),d=()=>n(533666),c=()=>n(626902),u=()=>n(178063),m=()=>n(688986),p=()=>n(809226),g=()=>n(653998),f=()=>n(32901),h=()=>n(945792),v=()=>n(759625),y=()=>n(84543),b=()=>n(737682),x=()=>n(307542),S=()=>n(640979),M=()=>n(4822),A=()=>n(904697),w=()=>n(622286),k=()=>n(715768),j=()=>n(236089),C=()=>n(331516),I=()=>n(618946),T=()=>n(485966),_=()=>n(120332),P=n(163643);const B=(0,g().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var R=()=>n(974837),L=()=>n(177086),D=()=>n(628854),N=()=>n(518397),O=()=>n(126451),E=()=>n(273520),U=()=>n(935091),F=()=>n(397791),K=()=>n(88271);const V=(0,g().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function z(e){const{type:t,spaceViewStore:n}=e,s=(0,i().v3)(),a=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),l=(0,o.useCallback)((()=>{R().A.setState({open:!0}),h().ye(s,{outliner_type:M().BP[t]})}),[s,t]),c=(0,o.useCallback)((()=>{R().A.setState({open:!1})}),[]),u=(0,g().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return(0,P.jsx)(E().Ay,{popupType:E().z7.Popup,alignmentToOrigin:E().yP.Start,renderOrigin:e=>(0,P.jsx)(O().A,{style:a.button,ariaLabel:u,...e,children:(0,P.jsx)(F().I,{icon:d().Y,size:"sm",color:s.device.isMobile?"tertiary":"secondary"})}),onClick:l,onClose:c,render:e=>(0,P.jsx)(H,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const W=(0,g().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}});function H(e){const{type:t,spaceViewStore:n,onClose:o}=e,d=(0,i().v3)(),b=(0,g().tz)(),w=(0,r().IS)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),R=(0,s().K8)((()=>(0,x().rY)(d)),[d]),O=(0,s().K8)((()=>(0,M().RQ)({spaceViewStore:n,type:t})),[n,t]),E=O.sortOption,F=O.truncationLimit,z="shared"===t&&R||"private"===t||"teamspaces"===t,H="private"===t||"shared"===t&&R,q=(0,s().K8)((()=>!L().l.state),[]),$=(0,s().K8)((()=>{const{currentSpaceStore:e}=T().default.state;return!!e&&(0,A().canCreateTeam)({environment:d,spaceStore:e})}),[d]),Q=q&&"teamspaces"===t&&$,Z=G({type:t,onSelect:o,spaceViewStore:n,outlinerLocation:"sidebar"}),X=function(e){const{type:t,spaceViewStore:n,onSelect:o}=e,a=(0,i().v3)(),d=(0,r().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,s().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return m().AQ.map((e=>(0,f().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{y().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:a,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);v().KY({transaction:o,store:i,value:e})}}),p().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),h().nT(a,{outliner_type:M().BP[t],option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:(0,P.jsx)(Y,{limit:e,withItems:!0}),right:c===e&&(0,l().checkmarkIcon)(d.icon),rightStyle:d.right})})))}({type:t,onSelect:o,spaceViewStore:n}),J=function(e){const{type:t,onSelect:n}=e,o=(0,s().O$)(T().AppStoreCurrentSpaceStore),r=(0,s().O$)(T().AppStoreCurrentSpaceViewStore),a=(0,s().K8)((()=>T().default.state.currentUserRootStore),[]),l=(0,g().tz)(),d=(0,i().v3)(),c=(0,I().p)(),u=(0,_().m)(),m=(0,s().K8)((()=>(0,x().i3)({environment:d,spaceStore:o,userRootStore:a})),[d,o,a]),p=(0,M().KP)({sidebarOrder:u,sidebarState:c,showLockedSidebar:m});if(!r)return[];const b=p.indexOf(t),S=0===b,A=b===p.length-1,w=(null==c?void 0:c.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const o=B[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[()=>w>1],closeParentMenu:!0,action:o=>{let{environment:i}=o;const s=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:o,visibleSidebarOrder:i}=e;const s=[...o],r=o.indexOf(t),a=i.indexOf(t);if("moveUp"===n&&a>0){const e=i[a-1];s[o.indexOf(e)]=t,s[r]=e}if("moveDown"===n&&a<i.length-1){const e=i[a+1];s[o.indexOf(e)]=t,s[r]=e}return s}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:u,visibleSidebarOrder:p});y().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{v().zv({store:r,data:{sidebar_order:s},transaction:e})}}),h().ub(i,{section:t,previous_order:u,new_order:s,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&S||"moveDown"===e&&A,i="moveUp"===e?j().s:k().v;return(0,P.jsx)(C().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(o),svg:i})}})}))}({type:t,onSelect:o}),ee=[(0,f().uk)({key:"sort",displayName:W.sort,analyticsName:W.sort.defaultMessage,validators:[()=>H],svg:a().C,right:b.formatMessage(V[E]),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"sort",render:e=>(0,P.jsx)(K().A,{...e}),actions:Z})]}),(0,f().uk)({key:"truncationLimit",displayName:W.truncationLimit,analyticsName:W.truncationLimit.defaultMessage,validators:[()=>z],svg:c().L,right:(0,P.jsx)(Y,{limit:F}),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"truncationLimit",render:e=>(0,P.jsx)(K().A,{...e}),actions:X})]}),...J],te=[(0,f().gy)({key:"all",render:e=>(0,P.jsx)(K().A,{...e}),actions:ee}),(0,f().gy)({key:"addTeam",render:e=>(0,P.jsx)(K().A,{...e}),actions:[(0,f().Ls)({key:"addTeam",displayName:W.addTeam,analyticsName:W.addTeam.defaultMessage,validators:[()=>Q],svg:u().plusIcon,closeParentMenu:!0,action:()=>{(0,D().vn)("sidebar_team_section"),o()}})]})];return(0,P.jsx)(U().A,{menuType:S().gu.Popup,minWidth:220,children:(0,P.jsx)(N().A,{context:{blocks:[],environment:d,publicEditMode:void 0},sections:te,initialFocus:void 0})})}function G(e){const{type:t,spaceViewStore:n,onSelect:o,outlinerLocation:a}=e,d=(0,i().v3)(),c=(0,g().tz)(),{currentSpaceStore:u}=(0,s().O$)(T().default),m=d.currentUser.id,x=(0,w().X)("sidebar_add_new_pages_to_bottom"),S=(0,s().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).sortOption),[t,n]),A=(0,r().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=V[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{y().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);v().KY({transaction:o,store:i,value:e})}}),"manual"===e&&"shared"===t&&!x&&m&&u&&await b().Z({environment:d,spaceId:u.id,userId:m}),p().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),h().Rf(d,{outliner_type:M().BP[t],outliner_location:a,option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:c.formatMessage(i),right:S===e&&(0,l().checkmarkIcon)(A.icon),rightStyle:A.right})})}))}function Y(e){const{limit:t,withItems:n}=e;return t===m().vw?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,P.jsx)("span",{children:t})}},987392:(e,t,n)=>{n.d(t,{k:()=>o});const o=(0,n(680369).xh)("xMark",{default:{loader:()=>n.e(14344).then(n.bind(n,827086))},small:{loader:()=>n.e(14344).then(n.bind(n,569948))},fill:{loader:()=>n.e(14344).then(n.bind(n,374366))},fillSmall:{loader:()=>n.e(14344).then(n.bind(n,263498))}},["close","cross","delete","remove","cancel"])},991378:(e,t,n)=>{n.d(t,{Nu:()=>r,Sw:()=>o,gO:()=>i,j$:()=>s});const o=220,i=24,s=-7,r=-3},998865:(e,t,n)=>{n.d(t,{$c:()=>a,aI:()=>r,cx:()=>s,uf:()=>i});var o=()=>n(129978);const i={RequestMembersModal:new(o().O2)("RequestMembersModal",(()=>Promise.all([n.e(96159),n.e(75134),n.e(43380),n.e(96346),n.e(36192),n.e(55373),n.e(62475),n.e(3151),n.e(44711),n.e(98629),n.e(53321),n.e(58550),n.e(16471),n.e(90825),n.e(37353),n.e(29151),n.e(16908),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(63077),n.e(41870),n.e(90966),n.e(88552),n.e(90214),n.e(74562),n.e(8184),n.e(28271),n.e(17254),n.e(18895),n.e(78708),n.e(28721),n.e(4422),n.e(28866),n.e(67435),n.e(17989),n.e(48632),n.e(90625),n.e(76181),n.e(59794),n.e(72832),n.e(90280),n.e(26483),n.e(33813),n.e(81768),n.e(71104),n.e(2804),n.e(82850),n.e(84778),n.e(69914),n.e(11341),n.e(92011),n.e(19361),n.e(63327),n.e(26090),n.e(38482),n.e(12341),n.e(50984),n.e(47864),n.e(40828),n.e(76007),n.e(5023),n.e(90978),n.e(65554),n.e(53571),n.e(66885),n.e(92674),n.e(77282)]).then(n.bind(n,945669)))),GoogleImportsInviteWithModal:new(o().O2)("GoogleImportsInviteWithModal",(()=>Promise.all([n.e(96159),n.e(96346),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(18895),n.e(51195),n.e(51226)]).then(n.bind(n,373002)))),InviteDropdownMenuItemLabel:new(o().O2)("InviteDropdownMenuItemLabel",(()=>n.e(25171).then(n.bind(n,923812)))),personPropertyInviteActions:new(o().O2)("personPropertyInviteActions",(()=>Promise.all([n.e(96159),n.e(96346),n.e(36209),n.e(92845),n.e(71718),n.e(48486),n.e(83324),n.e(18895),n.e(57613)]).then(n.bind(n,598109))))},s=(0,o()._h)(i.RequestMembersModal,(e=>e.RequestMembersModal)),r=(0,o()._h)(i.GoogleImportsInviteWithModal,(e=>e.GoogleImportsInviteWithModal)),a=(0,o()._h)(i.InviteDropdownMenuItemLabel,(e=>e.InviteDropdownMenuItemLabel))}}]);