"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[17586,24598,71204],{40642:(e,t,o)=>{o.d(t,{b:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("templates",{viewBox:"0 0 20 20",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z"}),(0,n.jsx)("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z"}),(0,n.jsx)("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z"})]})})},126216:(e,t,o)=>{o.d(t,{Z:()=>r});class n extends(()=>o(129044))().default{getInitialState(){return{}}append(e){const t={...this.state};for(const o of e)t[o.templateId]=o;this.setState(t)}}const r=new n},130935:(e,t,o)=>{o.d(t,{_:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("layout",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.39999 2.19999C2.28953 2.19999 2.19999 2.28953 2.19999 2.39998V11.5999C2.19999 11.7103 2.28953 11.7999 2.39999 11.7999H4.99997C5.11042 11.7999 5.19997 11.7103 5.19997 11.5999V2.39998C5.19997 2.28953 5.11042 2.19999 4.99997 2.19999H2.39999ZM1 2.39998C1 1.6268 1.62679 1 2.39999 1H4.99997C5.77316 1 6.39995 1.6268 6.39995 2.39998V11.5999C6.39995 12.3731 5.77316 12.9999 4.99997 12.9999H2.39999C1.62679 12.9999 1 12.3731 1 11.5999V2.39998ZM9 8.80036C8.88954 8.80036 8.8 8.88991 8.8 9.00036V11.6003C8.8 11.7108 8.88954 11.8003 9 11.8003H11.6C11.7105 11.8003 11.8 11.7108 11.8 11.6003V9.00036C11.8 8.88991 11.7105 8.80036 11.6 8.80036H9ZM7.60001 9.00036C7.60001 8.22717 8.2268 7.60037 9 7.60037H11.6C12.3731 7.60037 13 8.22717 13 9.00036V11.6003C13 12.3736 12.3731 13.0003 11.6 13.0003H9C8.2268 13.0003 7.60001 12.3736 7.60001 11.6003V9.00036ZM8.79994 2.39998C8.79994 2.28953 8.88949 2.19999 8.99994 2.19999H11.5999C11.7104 2.19999 11.7999 2.28953 11.7999 2.39998V4.99997C11.7999 5.11043 11.7104 5.19996 11.5999 5.19996H8.99994C8.88949 5.19996 8.79994 5.11043 8.79994 4.99997V2.39998ZM8.99994 1C8.22675 1 7.59995 1.6268 7.59995 2.39998V4.99997C7.59995 5.77316 8.22675 6.39995 8.99994 6.39995H11.5999C12.3731 6.39995 12.9999 5.77316 12.9999 4.99997V2.39998C12.9999 1.6268 12.3731 1 11.5999 1H8.99994Z"})})},141479:(e,t,o)=>{o.d(t,{N:()=>n,s:()=>r});const n=["pre_signup_build_with_ai"],r={select_and_customize_template:["templateSelection","features","viewsSelection"],customize_template:["features","viewsSelection"],select_and_build_with_ai:["templateSelection","setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],build_with_ai:["setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],new_user_template_onboarding:["templateSelection","setupGeneratorBuilding","features","viewsSelection"],pre_signup_build_with_ai:["setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"]}},151602:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(129044))().default{getInitialState(){return{}}}const r=new n;o(996094).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",r);const i=r},194585:(e,t,o)=>{o.d(t,{n:()=>C,z:()=>S});o(610931),o(242343);var n=()=>o(803290),r=()=>o(174114),i=()=>o(505966),l=()=>o(73658),a=()=>o(916963),c=()=>o(758989),s=()=>o(242978),p=()=>o(584044),d=()=>o(130935),u=()=>o(40642),m=()=>o(76394),f=()=>o(511441),y=()=>o(327665),g=()=>o(622286),v=()=>o(328653),b=()=>o(940445),h=o(163643);const I=16;function w(e){let{icon:t,theme:o,size:n,style:i}=e;const a=(0,r().IS)((e=>({icon:{fill:(0,v().d)(t,e).icon.primary,...i}})),[t,i]);return(0,h.jsx)(l().p,{icon:t,theme:o,size:n,style:a.icon})}function S(e){var t;let{template:o,size:n,iconStyle:l}=e;const a=n??I,y=(0,r().IS)((()=>({icon:{width:a,height:a,...l}})),[a,l]),g=(0,r().DP)();if((0,i().cB)(o.templateId))return(0,p().L)(y.icon);const{type:v}=o;switch(v){case"property":return(0,h.jsx)(T,{template:o,iconSize:a,styles:y});case"collection_view":return(0,h.jsx)(f().h,{viewIcon:null===(t=o.value.format)||void 0===t?void 0:t.collection_view_icon,viewType:o.value.type,color:"lightGray",style:y.icon});case"layout":return(0,h.jsx)(h.Fragment,{children:(0,d()._)(y.icon)});case"block":return(0,h.jsx)(h.Fragment,{children:(0,u().b)(y.icon)});case"collection":case"compound":const e="collection"===o.type?o.value.targetCollection.icon:o.icon;if(!(0,c().T8)(e))throw new Error("Only Notion static icons are allowed for template icons");return(0,h.jsx)(w,{icon:e,theme:g,size:a,style:y.icon});case"automation":return(0,h.jsx)(h.Fragment,{children:(0,s().v)(y.icon)});default:(0,m().HB)(v)}}function T(e){let{template:t,iconSize:o,styles:i}=e;const l=(0,r().DP)(),c=(0,g().X)("nds_default_property_noticon"),s=(0,n().K8)((()=>{const{relatedCollectionTemplateId:e}=t;if("relation"===t.value.type&&e){return b().globalWorkflowTemplates.fromIdOfType({templateId:e,type:"collection"}).value.targetCollection.icon}return t.value.icon}),[t]);return(0,h.jsx)(a().zB,{type:t.value.type,icon:s,size:o,style:i.icon,theme:l,isDefaultNoticonEnabled:c})}function C(e){let{template:t,backgroundSize:o}=e;const n=(0,r().IS)((e=>({iconContainer:{background:k({theme:e,template:t})[30]},icon:{fill:k({theme:e,template:t})[400]}})),[t]);return(0,h.jsx)(y().y,{backgroundColor:n.iconContainer.background,backgroundSize:o,icon:(0,h.jsx)(S,{template:t,iconStyle:n.icon})})}function k(e){let{theme:t,template:o}=e;const{type:n}=o;switch(n){case"collection_view":case"automation":return t.accentColors.blue;case"property":return"relation"===o.value.type?t.accentColors.yellow:t.accentColors.red;case"layout":return t.accentColors.orange;case"block":return t.accentColors.purple;case"compound":return t.accentColors.green;case"collection":return t.accentColors.pink;default:(0,m().HB)(n)}}},242978:(e,t,o)=>{o.d(t,{v:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},327665:(e,t,o)=>{o.d(t,{y:()=>i});o(242343);var n=()=>o(174114),r=o(163643);function i(e){let{icon:t,backgroundColor:o,backgroundSize:i}=e;const l=(0,n().IS)((e=>({iconContainer:{height:i??28,width:i??28,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",background:o??e.tint.regular}})),[o,i]);return(0,r.jsx)("div",{style:l.iconContainer,children:t})}},328653:(e,t,o)=>{o.d(t,{d:()=>i});var n=()=>o(758989);const r={light:{gray:{stroke:{secondary:"rgba(84, 72, 49, 0.15)"},fill:{primary:"rgba(84, 72, 49, 0.15)",secondary:"rgba(84, 72, 49, 0.08)",tertiary:"rgba(84, 72, 49, 0.04)"},text:{primary:"#1D1B16"}},red:{stroke:{secondary:"rgba(244, 171, 159, 0.40)"},fill:{primary:"rgba(244, 171, 159, 0.40)",secondary:"rgba(244, 171, 159, 0.40)",tertiary:"rgba(243, 136, 118, 0.07)"},text:{primary:"#5D1715"}},brown:{stroke:{secondary:"rgba(210, 162, 141, 0.35)"},fill:{primary:"rgba(210, 162, 141, 0.35)",secondary:"rgba(210, 162, 141, 0.17)",tertiary:"rgba(210, 162, 141, 0.07)"},text:{primary:"#442A1E"}},orange:{stroke:{secondary:"rgba(224, 124, 57, 0.27)"},fill:{primary:"rgba(224, 124, 57, 0.27)",secondary:"rgba(224, 124, 57, 0.15)",tertiary:"rgba(224, 124, 57, 0.07)"},text:{primary:"#49290E"}},yellow:{stroke:{secondary:"rgba(236, 191, 66, 0.39)"},fill:{primary:"rgba(236, 191, 66, 0.39)",secondary:"rgba(215, 177, 24, 0.15)",tertiary:"rgba(215, 177, 24, 0.07)"},text:{primary:"#402C1B"}},green:{stroke:{secondary:"rgba(123, 183, 129, 0.27)"},fill:{primary:"rgba(123, 183, 129, 0.27)",secondary:"rgba(123, 183, 129, 0.15)",tertiary:"rgba(123, 183, 129, 0.07)"},text:{primary:"#1C3829"}},blue:{stroke:{secondary:"rgba(93, 165, 206, 0.27)"},fill:{primary:"rgba(93, 165, 206, 0.27)",secondary:"rgba(95, 167, 208, 0.15)",tertiary:"rgba(91, 166, 209, 0.07)"},text:{primary:"#183347"}},purple:{stroke:{secondary:"rgba(168, 129, 197, 0.27)"},fill:{primary:"rgba(168, 129, 197, 0.27)",secondary:"rgba(204, 170, 229, 0.15)",tertiary:"rgba(206, 175, 229, 0.07)"},text:{primary:"#412454"}},pink:{stroke:{secondary:"rgba(225, 136, 179, 0.27)"},fill:{primary:"rgba(225, 136, 179, 0.27)",secondary:"rgba(235, 159, 196, 0.15)",tertiary:"rgba(231, 147, 188, 0.07)"},text:{primary:"#4C2337"}}},dark:{gray:{stroke:{secondary:"rgba(255, 255, 255, 0.09)"},fill:{primary:"rgba(255, 255, 255, 0.13)",secondary:"rgba(255, 255, 255, 0.09)",tertiary:"rgba(255, 255, 255, 0.03)"},text:{primary:"rgba(255, 255, 255, 0.81)"}},red:{stroke:{secondary:"rgba(222, 85, 85, 0.25)"},fill:{primary:"rgba(222, 85, 84, 0.30)",secondary:"rgba(222, 85, 84, 0.30)",tertiary:"rgba(222, 85, 88, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},brown:{stroke:{secondary:"rgba(184, 101, 69, 0.25)"},fill:{primary:"rgba(184, 101, 68, 0.30)",secondary:"rgba(184, 101, 68, 0.30)",tertiary:"rgba(184, 101, 72, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},orange:{stroke:{secondary:"rgba(233, 126, 37, 0.20)"},fill:{primary:"rgba(233, 126, 36, 0.30)",secondary:"rgba(233, 126, 36, 0.30)",tertiary:"rgba(233, 126, 40, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},yellow:{stroke:{secondary:"rgba(179, 129, 61, 0.20)"},fill:{primary:"rgba(231, 161, 55, 0.30)",secondary:"rgba(231, 161, 55, 0.30)",tertiary:"rgba(162, 105, 50, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},green:{stroke:{secondary:"rgba(45, 153, 100, 0.20)"},fill:{primary:"rgba(45, 153, 100, 0.30)",secondary:"rgba(45, 153, 100, 0.30)",tertiary:"rgba(45, 153, 100, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},blue:{stroke:{secondary:"rgba(51, 126, 169, 0.20)"},fill:{primary:"rgba(51, 126, 169, 0.33)",secondary:"rgba(51, 126, 169, 0.33)",tertiary:"rgba(51, 126, 169, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},purple:{stroke:{secondary:"rgba(155, 97, 211, 0.18)"},fill:{primary:"rgba(155, 97, 211, 0.28)",secondary:"rgba(155, 97, 211, 0.28)",tertiary:"rgba(155, 97, 211, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},pink:{stroke:{secondary:"rgba(220, 76, 145, 0.22)"},fill:{primary:"rgba(220, 76, 145, 0.30)",secondary:"rgba(220, 76, 145, 0.30)",tertiary:"rgba(220, 76, 145, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}}}};function i(e,t){const o=(0,n().VA)(e),i="lightgray"===o?"gray":o;return{...r[t.mode][i],icon:{primary:n().l8[t.mode][i]}}}},367950:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{_:()=>n})},381697:(e,t,o)=>{o.r(t),o.d(t,{loadWorkflowTemplateInstances:()=>a});o(362833),o(403517);var n=()=>o(711659),r=()=>o(76394),i=()=>o(413871);const l=!1;function a(e){const t=[];let o=!1;e.isDefined()||(o=!0);const a=e=>{var n;if(!e.isDefined())return void(o=!0);const r=null===(n=e.getProperties())||void 0===n?void 0:n.workflow_template_instance;r&&t.push({instancePointer:{type:"automation",id:e.id,spaceId:e.getSpaceId()},templateId:r.template_id})},c=e.getFormat().workflow_template_instance,s=e.getParentBlockStore();if(null==s||!s.isDefined())return{isLoading:!0,instances:[]};c&&t.push({instancePointer:{type:"collection",id:e.id},templateId:c.template_id});const p=s.getCollectionViewStores()??[];for(const n of p){if(!n.isDefined()){o=!0;continue}const e=n.getFormat().workflow_template_instance;e&&t.push({instancePointer:{type:"collection_view",id:n.id},templateId:e.template_id})}const d=e.getLayoutStore();if(d)if(d.isDefined()){var u;const e=null===(u=d.getFormat())||void 0===u?void 0:u.workflow_template_instance;e&&t.push({instancePointer:{type:"layout",id:d.id,spaceId:d.getSpaceId()},templateId:e.template_id})}else o=!0;const m=e.getTemplatePageStores();for(const n of m){const e=n.getModel();if(!e){o=!0;continue}if(!e.isPageBlock())continue;const r=e.getFormat().workflow_template_instance;r&&t.push({instancePointer:{type:"block",id:e.id,spaceId:e.getSpaceId()},templateId:r.template_id});const i=n.getAutomationStore();i&&a(i)}const f=e.getAutomationStores();for(const n of f)a(n);const y=e.getSpaceId(),g=e.getSchema();for(const[r,l]of Object.entries(g)){if(!l)continue;const o=l.workflow_template_instance;if(o&&t.push({instancePointer:{type:"property",id:r,collectionId:e.id},templateId:o.template_id}),"button"===l.type&&l.automation_id){a(i().dn.createChildStore(e,{id:l.automation_id,spaceId:y,table:n().yB}))}}const v=e.getFormat().compound_workflow_template_instances??[];for(const n of v)t.push({instancePointer:{type:"compound",id:n.id,collectionId:e.id,instancePointers:n.instance_pointers.map((t=>{switch(t.type){case"automation":return{type:"automation",id:t.id,spaceId:y};case"block":return{type:"block",id:t.id,spaceId:y};case"collection_view":return{type:"collection_view",id:t.id};case"layout":return{type:"layout",id:t.id,spaceId:y};case"property":return{type:"property",id:t.id,collectionId:e.id}}(0,r().HB)(t)}))},templateId:n.template_id});return l&&console.log("loadWorkflowTemplateInstances: loaded workflow template instances for collection:",e.id,"isLoading:",o,"instances:",t),{isLoading:o,instances:t}}},633144:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(129044))().default{getInitialState(){return null}}const r=new n;o(996094).exposeDebugValue("WorkflowTemplatesBuilderStore",r);const i=r},727528:(e,t,o)=>{o.d(t,{CB:()=>k,DM:()=>W,FE:()=>E,Fy:()=>H,NU:()=>B,R5:()=>V,S1:()=>j,Sl:()=>S,TE:()=>C,Xg:()=>D,Zp:()=>R,aI:()=>A,aL:()=>F,b3:()=>h,fI:()=>_,ju:()=>w,rS:()=>L,tY:()=>z,wW:()=>M});o(610931),o(362833),o(725707),o(491955),o(500234),o(324989),o(403517),o(113085);var n=()=>o(367950),r=()=>o(505966),i=()=>o(502140),l=()=>o(711659),a=()=>o(145017),c=()=>o(21164),s=()=>o(289765),p=()=>o(968410),d=()=>o(975392),u=()=>o(76394),m=()=>o(378219),f=()=>o(413871),y=()=>o(151602),g=()=>o(381697),v=()=>o(940445);const b=!1;function h(e){const t={};for(const o of e){const e=t[o.templateId]??[];e.push(o.instancePointer),t[o.templateId]=e}return t}function I(e){let t;if("collection"===e.table)t=h((0,g().loadWorkflowTemplateInstances)(e).instances);else{const o=(0,n()._)(e.pointer),r=y().A.getState();t=(null==r?void 0:r[o])??{}}const o=w(t);return b&&(console.groupCollapsed("getTemplateIdToInstancePointersMap",e.pointer),console.trace(),console.log("Raw map:",t),console.log("Map with invalid template IDs removed:",o),console.groupEnd()),o}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v().globalWorkflowTemplates;const o={},n=(0,d().Bj)((e=>{try{return t.fromId(e),!0}catch(o){return!1}}));for(const[r,i]of Object.entries(e))n(r)&&(o[r]=i);return o}function S(e){let{environment:t,collectionStore:o}=e;const n=I(o),r=[];for(const[i,l]of Object.entries(n))for(const e of l)A({environment:t,instancePointer:e,inMemoryRecordCache:o.inMemoryRecordCache})&&r.push({instancePointer:e,templateId:i});return r}const T="dependency_";function C(e){return e.startsWith(T)}function k(e){let{collectionStore:t,sourceTemplateType:o,sourcePrimitiveId:n,dependencyMap:r}=e;const i=P({sourceTemplateType:o,sourcePrimitiveId:n,dependencyMap:r});if(!i)return n;const l=x(t,i);if(0===l.length)return`${T}${i}`;return l[l.length-1].id}function _(e){let{collectionStore:t,sourceTemplateType:o,sourcePrimitiveId:n,dependencyMap:r}=e;const i=P({sourceTemplateType:o,sourcePrimitiveId:n,dependencyMap:r});if(!i)return;const l=x(t,i);if(0===l.length)return;return l[l.length-1].id}function P(e){let{sourceTemplateType:t,sourcePrimitiveId:o,dependencyMap:n}=e;if(C(o))return o.replace(T,"");return n[(0,r().Ir)(t,o)]}function x(e,t){return I(e)[t]??[]}function M(e){let{environment:t,spaceStore:o,templateId:n}=e;return x(o,n).filter((e=>A({environment:t,instancePointer:e,inMemoryRecordCache:o.inMemoryRecordCache})))}function j(e){let{collectionStore:t,templateId:o,instancePointerType:n}=e;const r=x(t,o);if(0===r.length)return;const i=r[r.length-1];if(i.type!==n)throw new Error(`Expect to find instance pointer type ${n} for template ID ${o} but found ${i.type} instead`);return i}function B(e){let{environment:t,collectionStore:o,templateId:n}=e;return Boolean(R({environment:t,scopeStore:o,templateId:n}))}function R(e){let{environment:t,scopeStore:o,templateId:n}=e;const r=o.pointer,l=x(o,n).filter((e=>A({environment:t,instancePointer:e,inMemoryRecordCache:o.inMemoryRecordCache}))),a=(0,d().hS)(l,(e=>e.id));if(a.length!==l.length){const e=l.map((e=>e.id));i().log({level:"warning",from:"workflowTemplatesInstanceHelpers",type:"duplicateAliveInstancePointers",data:{miscDataToConvertToString:{templateId:n,instanceIds:e}}})}return 0===a.length?void 0:a.length>1?(i().log({level:"warning",from:"workflowTemplatesInstanceHelpers",type:"moreThanOneAliveInstancePointer",data:{miscDataToConvertToString:{templateId:n,scope:r,uniqueAliveInstancePointers:a}}}),a[0]):a[0]}function A(e){let{environment:t,instancePointer:o,inMemoryRecordCache:n}=e;if("property"===o.type){const e=new(f().md)(t,{table:c().Vl,id:o.collectionId},{inMemoryRecordCache:n});return Boolean(e.getSchema()[o.id])}if("collection_view"===o.type){const e=new(f().pS)(t,{table:s().Gy,id:o.id},{inMemoryRecordCache:n});return Boolean(e.getAlive())}if("collection"===o.type){const e=new(f().md)(t,{table:c().Vl,id:o.id},{inMemoryRecordCache:n});return!(0,m().ze)(e)}if("layout"===o.type){const e=new(f().rN)(t,{table:p().zx,id:o.id,spaceId:o.spaceId},{inMemoryRecordCache:n});return!(0,m().ze)(e)}if("compound"===o.type)return function(e){let{environment:t,instancePointer:o,inMemoryRecordCache:n}=e;return o.instancePointers.some((e=>A({environment:t,instancePointer:e,inMemoryRecordCache:n})))}({environment:t,instancePointer:o,inMemoryRecordCache:n});if("block"===o.type){const e=new(f().Bv)(t,{table:a().ev,id:o.id,spaceId:o.spaceId},{inMemoryRecordCache:n});return!(0,m().ze)(e)}if("automation"===o.type){const e=new(f().dn)(t,{table:l().yB,id:o.id,spaceId:o.spaceId},{inMemoryRecordCache:n});return!(0,m().ze)(e)}(0,u().HB)(o)}function D(e,t){const o=I(t);return Object.keys(o).filter((o=>B({environment:e,collectionStore:t,templateId:o}))).map((e=>v().globalWorkflowTemplates.fromId(e)))}function L(e,t){const o=[],n=I(e);for(const r of Object.values(n))o.push(...r.filter((e=>e.type===t)));return o}function z(e){let{environment:t,collectionStore:o}=e;if(!o)return;const n=S({environment:t,collectionStore:o}).filter((e=>{let{instancePointer:t}=e;return"collection"===t.type&&t.id===o.id}));if(0!==n.length){if(n.length>1)throw new Error(`More than one collection preset templates found for collection ${o.id}`);return v().globalWorkflowTemplates.fromIdOfType({templateId:n[0].templateId,type:"collection"})}}function W(e){const{type:t}=e;return"collection_view"===t||"property"===t||"layout"===t||"compound"===t||"block"===t||"automation"===t}function E(e){let{environment:t,collectionStore:o}=e;return S({environment:t,collectionStore:o}).filter((e=>"compound"===e.instancePointer.type))}function H(e){let{environment:t,collectionStore:o,instancePointerId:n}=e;const r=S({environment:t,collectionStore:o}).find((e=>e.instancePointer.id===n));if(r)return v().globalWorkflowTemplates.featureFromId(r.templateId)}function O(e){let{environment:t,collectionStore:o,propertyId:n}=e;const r=function(e){let{environment:t,collectionStore:o,propertyId:n}=e;return S({environment:t,collectionStore:o}).filter((e=>"property"===e.instancePointer.type&&e.instancePointer.id===n))}({collectionStore:o,environment:t,propertyId:n}),i=E({environment:t,collectionStore:o}).filter((e=>{let{instancePointer:t}=e;return r.some((e=>t.instancePointers.some((t=>t.id===e.instancePointer.id))))}));return{propertyTemplateInstances:r,compoundTemplateInstances:i}}function V(e){let{collectionStore:t,environment:o,propertyId:n}=e;const{propertyTemplateInstances:i,compoundTemplateInstances:l}=O({environment:o,collectionStore:t,propertyId:n}),a=i.map((e=>{let{templateId:t}=e;return v().globalWorkflowTemplates.fromId(t)})).filter((e=>(0,r().Xq)(e,"property")));return l.filter((e=>{let{templateId:t}=e;const o=v().globalWorkflowTemplates.fromId(t);if((0,r().Xq)(o,"compound"))return a.some((e=>o.value.templateItems.some((t=>t.pointer===e.templateId&&"required"===t.optionality))))}))}function F(e){let{environment:t,collectionStore:o,compoundTemplateInstancesToDelete:n}=e;const r=n.flatMap((e=>e.instancePointer.instancePointers)),i=n.map((e=>e.instancePointer.id)),l=E({environment:t,collectionStore:o}),a=[];for(const c of l)if(!i.includes(c.instancePointer.id))for(const e of c.instancePointer.instancePointers)r.some((t=>t.id===e.id))&&a.push(e);return r.filter((e=>!a.some((t=>t.id===e.id))))}},790898:(e,t,o)=>{o.r(t),o.d(t,{WorkflowTemplatesTooltip:()=>s});o(242343);var n=()=>o(174114),r=()=>o(994966),i=()=>o(103151),l=()=>o(907721),a=()=>o(385479),c=o(163643);function s(e){let{collectionTemplate:t,placement:o,render:n}=e;return t.templateId===r().MH?(0,c.jsx)(c.Fragment,{children:n({})}):(0,c.jsx)(p,{collectionTemplate:t,placement:o,render:n})}function p(e){let{collectionTemplate:t,placement:o,render:r}=e;const s=(0,n().IS)((e=>({tooltip:{whiteSpace:"break-spaces"},tooltipInner:{width:230,marginTop:4,marginBottom:4},imageContainer:{width:"100%",height:100,borderRadius:4,marginBottom:6,overflow:"hidden",color:e.text.primary},description:{whiteSpace:"normal",lineHeight:1.4}})),[]);return(0,c.jsx)(i().A,{placement:o??l().W.Left,delayThreshold:0,style:s.tooltip,render:r,renderTooltip:()=>(0,c.jsxs)("div",{style:s.tooltipInner,children:[(0,c.jsx)("div",{style:s.imageContainer,children:(0,c.jsx)(a().i,{template:t,index:0})}),(0,c.jsx)("div",{style:s.description,children:t.description})]})})}},837809:(e,t,o)=>{o.d(t,{O:()=>s,q:()=>p});o(242343);var n=()=>o(174114),r=()=>o(220413),i=()=>o(31448),l=()=>o(826033),a=()=>o(809785),c=o(163643);function s(e){const{value:t,color:o,format:s,showEllipsis:p,onClickRemove:d,showRemoveButton:u,isSingle:m,shouldShrink:f,hideTooltip:y,description:g,tooltipPlacement:v,...b}=e,h=(0,n().DP)(),I=(0,n().IS)((e=>({token:{...p&&i().RC}})),[p]),{textColor:w,backgroundColor:S}=(0,r().LD)(h,o);return t?(0,c.jsx)(a().A,{format:s,value:(0,c.jsx)(l().A,{children:t}),description:g,onClickRemove:d,showRemoveButton:u,isSingle:m,color:w,backgroundColor:S,shouldShrink:f,tooltipPlacement:v,showTooltip:y?"never":"overflow",style:I.token,...b}):null}function p(e){const{value:t,color:o,format:s,showEllipsis:p,onClickRemove:d,showRemoveButton:u,isSingle:m,shouldShrink:f,groupColor:y,tooltipPlacement:g,description:v,hideTooltip:b,...h}=e,I=(0,n().DP)(),w=(0,n().IS)((()=>({token:{...p&&i().RC}})),[p]);if(!t)return null;const{textColor:S,backgroundColor:T}=(0,r().LD)(I,o??y??"gray");let C;return C=o||(y||"gray"),(0,c.jsx)(a().A,{format:s,value:(0,c.jsx)(l().A,{children:t}),description:v,onClickRemove:d,showRemoveButton:u,isSingle:m,color:S,backgroundColor:T,shouldShrink:f,showTooltip:b?"never":"overflow",style:w.token,isRound:!0,showColoredDot:C,tooltipPlacement:g,...h})}},940445:(e,t,o)=>{o.r(t),o.d(t,{TRUNCATE_COLLECTION_TEMPLATE_ITEMS_AT:()=>j,WorkflowTemplateLogger:()=>h,getChildCollectionStoreByTemplateId:()=>P,getCollectionTemplateFromId:()=>D,getIsSetupGeneratorEnabled:()=>B,getPropertyTemplates:()=>M,getSelectedFeatureTemplateIds:()=>_,getTemplatesInCompoundTemplate:()=>x,getWorkflowTemplateItemsCaption:()=>C,getWorkflowTemplateName:()=>k,globalWorkflowTemplates:()=>w,remapPropertyIds:()=>S,shouldShowInSuggestedProperties:()=>R,useCaseByCollectionTemplateCategory:()=>A});o(610931),o(362833),o(725707),o(107652),o(491955),o(500234),o(403517);var n=()=>o(505966),r=()=>o(839999),i=()=>o(310206),l=()=>o(220574),a=()=>o(293665),c=()=>o(21164),s=()=>o(528762),p=()=>o(34662),d=()=>o(975392),u=()=>o(76394),m=()=>o(91338),f=()=>o(88442),y=()=>o(477784),g=()=>o(413871),v=()=>o(727528);const b=(0,o(653998).YK)({untitled:{id:"workflowTemplates.untitled",defaultMessage:"Untitled"}});class h{log(e){0}warn(e){0}debug(e){false}}const I=new(o(496985).default)((()=>{var e;const t=y().A.getIntl();return(0,o(435084).IC)({},t,(null===(e=o(633144).A.state)||void 0===e?void 0:e.templatesWithRowIds.map((e=>e.template)))??[],{shouldFakeLocalization:"pseudo"===t.locale,strict:!1})}),{debugName:"localizedDynamicBuilderTemplatesStore"}),w=new(n().GH)((e=>{const t=y().A.getIntl(),n=[...I.state,...(0,o(994966).Cb)(t,{localizeTemplates:!0,stage:(0,o(527392).M)()}),...Object.values(o(126216).Z.state)].find((t=>t.templateId===e));if(!n)throw new Error(`Template not found for ${e}`);return n}));function S(e){let{collectionStore:t,dependencyMap:o,object:r}=e;(0,n().$G)({object:r,callback:e=>function(e){let{collectionStore:t,dependencyMap:o,objectWithProperty:n}=e;const r=n.property,i=(0,v().CB)({collectionStore:t,sourceTemplateType:"property",sourcePrimitiveId:r,dependencyMap:o});n.property=i}({collectionStore:t,dependencyMap:o,objectWithProperty:e})})}const T=3;function C(e){if(0===e.length)return;const t=e.slice(0,T),o=e.length-t.length,n=t.join(", ");return o>0?`${n}, ${o}+`:n}function k(e){const{type:t}=e;switch(t){case"collection_view":return e.value.name??y().A.formatMessage(m().X[e.value.type]);case"property":return e.value.name;case"collection":return e.value.targetCollection.name;case"layout":case"compound":return e.name;case"block":const o=l().RecordMap.create(e.value.recordMap),n=o.getModel(e.value.blockPointer);return n?(0,p().q4_)(n.getRenderTitleTextValue({getRecordModel:i().b.fromRecordMap(o)})):y().A.formatMessage(b.untitled);case"automation":return e.value.name??(0,r().PK)(y().A.getIntl());default:(0,u().HB)(t)}}function _(e){return e.featureTemplateSelections.filter((e=>e.selected)).map((e=>e.template.templateId))}function P(e){let{environment:t,parentStore:o,collectionTemplateId:n}=e;const r=o.getSpaceId();if(!r)throw new Error(`Space ID not found for ${o}`);const i=new(g().SL)(t,{table:s().NX,id:r}),l=(0,v().wW)({environment:t,spaceStore:i,templateId:n});for(const s of l){var p;const e=new(g().md)(t,{table:c().Vl,id:s.id}),n=null===(p=e.getParentBlockStore())||void 0===p?void 0:p.getParentPointer();if(n&&a().L3.isEqual(n,o.pointer))return e}}function x(e){const t=e.value.templateItems.map((e=>w.fromId(e.pointer))),o=[];for(const r of t){if(!(0,n().$K)(r))throw new Error(`Invalid template "${r.templateId}" in compound template "${e.templateId}"`);o.push(r)}return o}function M(e){const t=[];for(const o of e)"property"===o.type?t.push(o):"compound"===o.type&&t.push(...x(o).filter((e=>(0,n().Xq)(e,"property"))));return d().hS(t,(e=>e.templateId))}const j=3;function B(e){return(0,f().ZE)(e)}function R(e){return"property"===e.type||"compound"===e.type&&x(e).every((e=>"property"===e.type))}const A={goals:"goals",projects:"project",tasks:"other",docs:"docs",meetings:"notes"};function D(e){try{return w.fromIdOfType({templateId:e,type:"collection"})}catch(t){return}}},961397:(e,t,o)=>{o.d(t,{C8:()=>u,ET:()=>d,Ll:()=>C,OX:()=>f,QT:()=>g,Rh:()=>I,UA:()=>p,Wm:()=>v,XM:()=>s,aO:()=>h,bd:()=>m,gM:()=>y,gP:()=>S,hq:()=>b,pp:()=>w});o(610931),o(362833),o(725707),o(491955),o(500234),o(403517);var n=()=>o(505966),r=()=>o(141479),i=()=>o(3311),l=()=>o(76394),a=()=>o(940445);const c=3;function s(e){let{origin:t,parentStore:o,flowId:n}=e;return{collectionTemplate:void 0,origin:t,flowId:n??(0,i().Ay)(),collectionTemplatesSearchQuery:void 0,parentStore:o}}function p(e){let{collectionViewTemplates:t,featureTemplateSelections:o}=e;const r=[];for(const i of t)r.push(...(0,n().CA)({template:i,dependencyMap:i.dependencyMap||{}}).map((e=>e.templateId)));return o.filter((e=>"required"!==e.optionality&&!r.includes(e.template.templateId)&&g(e.template)))}function d(e){let{template:t}=e;return{recordTitles:new Array(c).fill(""),featureTemplateSelections:t.value.templateItems.map((e=>m(e.pointer,e.optionality)))}}function u(e){const{collectionTemplate:t,origin:o,flowId:n,parentStore:r}=e;return{collectionTemplate:t,userCustomizations:d({template:t}),origin:o,flowId:n??(0,i().Ay)(),parentStore:r,collectionTemplatesSearchQuery:void 0,previewCollectionInfo:void 0}}function m(e,t){const o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:a().globalWorkflowTemplates).fromId(e);if(!(0,n().Jb)(o))throw new Error(`Template ${e} in collection template is not a feature template`);return"required"===t?{template:o,optionality:"required",selected:!0}:"optionalDefaultOn"===t?{template:o,optionality:"optionalDefaultOn",selected:!0}:"optionalDefaultOff"===t?{template:o,optionality:"optionalDefaultOff",selected:!1}:void(0,l().HB)(t)}function f(e){if(!e.collectionTemplate)throw new Error("Collection template cannot be undefined");return{collectionTemplate:e.collectionTemplate,userCustomizations:e.userCustomizations,origin:e.origin,flowId:e.flowId,collectionTemplatesSearchQuery:e.collectionTemplatesSearchQuery,parentStore:e.parentStore,previewCollectionInfo:e.previewCollectionInfo}}function y(e){var t,o,n,r;return{origin:e.origin,has_selection_modal_search_query:((null===(t=e.collectionTemplatesSearchQuery)||void 0===t?void 0:t.length)??0)>0,flow_id:e.flowId,collection_template_id:null===(o=e.collectionTemplate)||void 0===o?void 0:o.templateId,destination_type:null===(n=e.parentStore)||void 0===n?void 0:n.table,destination_id:null===(r=e.parentStore)||void 0===r?void 0:r.id}}function g(e){return"property"===e.type&&"relation"!==e.value.type||"compound"===e.type}function v(e){const{version:t}=e;return r().s[t]}function b(e){const{currentStepIndex:t}=e;return v(e)[t]}function h(e,t){const{currentStepIndex:o,collectionTemplate:n}=e,r=v(e);for(let i=o+1;i<r.length;i++){const e=r[i];if(!(n&&T({step:e,template:n,action:"next",isPhone:t})))return i}return-1}function I(e,t){return h(e,t)>=0}function w(e,t){return S(e,t)>=0}function S(e,t){const{currentStepIndex:o,collectionTemplate:n}=e,r=v(e);for(let i=o-1;i>=0;i--){const e=r[i];if(!(n&&T({step:e,template:n,action:"previous",isPhone:t})))return i}return-1}function T(e){let{step:t,template:o,action:n,isPhone:r}=e;switch(t){case"viewsSelection":return r||a().globalWorkflowTemplates.allOfType({templateIds:o.value.templateItems.map((e=>e.pointer)),type:"collection_view"}).length<=1;case"templateSelection":case"features":case"setupGeneratorInput":return!1;case"setupGeneratorBuilding":return"previous"===n;default:(0,l().HB)(t)}}function C(e){let{userCustomizations:t,templateId:o}=e;const n=t.featureTemplateSelections,r=n.find((e=>e.template.templateId===o));if(!r||"required"===r.optionality)return t;const i={...r,selected:!r.selected};return{...t,featureTemplateSelections:n.map((e=>e.template.templateId===o?i:e)),prevFeatureTemplateSelections:n}}}}]);