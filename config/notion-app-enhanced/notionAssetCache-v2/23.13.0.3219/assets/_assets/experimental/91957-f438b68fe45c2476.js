"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[91957],{726910:(e,t,a)=>{a.d(t,{Ay:()=>Et,oG:()=>Gt,DZ:()=>Nt});a(610931),a(362833),a(333225),a(494367),a(516262),a(573119),a(240480),a(950443),a(619601),a(725707),a(107652),a(491955),a(403517);var o=a(242343),s=()=>a(237385),n=()=>a(803290),i=()=>a(174114),r=()=>a(65866),l=()=>a(83544),c=()=>a(257987),d=()=>a(198654),u=()=>a(242103),p=()=>a(339189),m=()=>a(668657),g=()=>a(723361),h=()=>a(145017),S=()=>a(653998),v=()=>a(188877),y=()=>a(975392),f=()=>a(76394),x=()=>a(31448),A=()=>a(202884),b=()=>a(155392),I=()=>a(84543),M=()=>a(658388),T=()=>a(982415),j=()=>a(209684),k=()=>a(535906),w=()=>a(884373),P=()=>a(441292),C=()=>a(401382),B=()=>a(579494),L=()=>a(966789),O=()=>a(28210),D=()=>a(88271),K=()=>a(158918),R=()=>a(103151),N=()=>a(35462),E=()=>a(482570),q=()=>a(84979),_=()=>a(782422),z=()=>a(640979),V=()=>a(906230),W=()=>a(431789),F=()=>a(644026),H=()=>a(378219),U=()=>a(930916),Q=()=>a(392608),G=()=>a(548694),$=()=>a(904697),Y=()=>a(162339),X=()=>a(509484),J=()=>a(907721),Z=()=>a(485966),ee=()=>a(129044);const te=ee().default.createValue(void 0,{name:"CachedTypedDatabasesStore"});var ae=()=>a(802955),oe=()=>a(836331);a(500234);class se extends ee().default{getInitialState(){return{chosenSpaceId:void 0}}getChosenSpaceId(){const{chosenSpaceId:e}=this.state,{currentSpaceStore:t}=Z().default.state;return e||(null==t?void 0:t.id)}getChosenSpaceStore(){var e;return null===(e=this.getChosenSpaceViewStore())||void 0===e?void 0:e.getSpaceStore()}getChosenSpaceViewStore(){const{chosenSpaceId:e}=this.state,{currentSpaceViewStore:t,currentUserRootStore:a}=Z().default.state;if(!e&&t)return t;if(e&&a){return a.getSpaceViewStores().find((t=>t.getSpaceId()===e))}}}const ne=se;var ie=()=>a(836486),re=()=>a(413871),le=()=>a(501578),ce=()=>a(921637),de=()=>a(858023),ue=()=>a(975515),pe=()=>a(359441),me=()=>a(126451),ge=a(163643);function he(e){let{loading:t,menuListItemProps:o}=e;const n=(0,s().v3)(),{isMobile:r}=n.device,l=(0,i().IS)((e=>({button:{display:"flex",flexDirection:"row",alignItems:"center",color:e.text.tertiary,...r?{fontSize:x().J.UIRegular.mobile,lineHeight:x().K_.UIRegular.mobile,padding:4}:{fontSize:x().J.UIRegular.desktop,lineHeight:x().K_.UIRegular.desktop,margin:"0px 4px 4px",padding:4,borderRadius:4}},icon:{width:14,height:14,marginRight:8,marginLeft:8,fill:e.lightIconColor},loadingSpinner:{marginLeft:8}})),[r]);return(0,ge.jsxs)(me().A,{style:l.button,...o,children:[(0,a(175532).P)(l.icon),(0,ge.jsx)(S().sA,{defaultMessage:"Load more",id:"moveToMenu.loadMoreButtonTitle"}),t&&(0,ge.jsx)(L().A,{size:"sm",style:l.loadingSpinner})]})}const Se=o.memo(he),ve=1e3;function ye(e){let{query:t,spaceId:a,menuListStore:s,requestStore:i,getAutocompleteItems:r}=e;const l=(0,n().K8)((()=>i.state.loading),[i]),c=(0,o.useCallback)((async()=>{!ie().Ay.state.isOpen||ie().Ay.state.queryLimit>=ve||(ie().Ay.setState({...ie().Ay.state,queryLimit:ie().Ay.state.queryLimit+20}),await i.refresh())}),[i]);return(0,ge.jsx)(ce().A,{request:{query:t,spaceId:a},render:(e,a)=>(0,ge.jsx)(fe,{sections:a,error:e,menuListStore:s,initialFocus:Boolean(t)?0:void 0,loading:l,onLoadMore:c}),requestStore:i,debounce:pe().tu,performRequest:r})}function fe(e){let{sections:t,error:a,menuListStore:o,initialFocus:s,onLoadMore:i,loading:r}=e;const l=(0,n().K8)((()=>{const e=ie().Ay.state,a=e.isOpen&&e.canLoadMore;return(null==t?void 0:t.find((e=>"pages"===e.key)))&&a}),[t]);if(a)return(0,ge.jsx)(D().A,{children:(0,ge.jsx)(ue().A,{title:(0,ge.jsx)(S().sA,{defaultMessage:"Something went wrong.",id:"moveBlockMenu.errorOnMove.label"})})});if(t&&0===t.length)return(0,ge.jsx)(D().A,{children:(0,ge.jsx)(ue().A,{title:(0,ge.jsx)(S().sA,{defaultMessage:"No results",id:"moveBlockMenu.noResults.label"})})});const c=[...t||[],...l?[{key:"moveTo load more section",render:e=>(0,ge.jsx)(D().A,{disableDesktopPadding:!0,...e}),items:[{key:"moveTo load more button",render:e=>(0,ge.jsx)(Se,{menuListItemProps:e,loading:r}),action:i}]}]:[]];return(0,ge.jsx)("div",{children:(0,ge.jsx)(de().Ay,{type:de().Oh.Vertical,initialFocus:s,sections:c,store:o})})}var xe=()=>a(21164),Ae=()=>a(528762),be=()=>a(218357),Ie=()=>a(701513),Me=()=>a(709237),Te=()=>a(360482);function je(e){const{store:t,menuListItemProps:a,hidePath:o}=e,s=(0,n().K8)((()=>function(e){if((0,Te()._p)(e)&&!e.canEdit())return(0,ge.jsx)(S().sA,{id:"moveBlockMenu.needEditAccess.tooltip",defaultMessage:'You need "Can edit" access to "{parentName}" to move this page',values:{parentName:(0,ge.jsx)(Me().A,{store:e,shouldWrap:!0})}});if((0,Te().$R)(e)&&!e.canAddOrRemoveTopLevelPages())return(0,ge.jsx)(S().sA,{id:"moveBlockMenu.TeamSidebarLocked.tooltip",defaultMessage:"This teamspace has its sidebar locked. You must be a teamspace owner to move to this teamspace."})}(t)),[t]),r=Boolean(s),l=(0,i().IS)((e=>({disabledTooltip:{maxWidth:240},recordMenuItem:r?{color:e.text.secondary}:{}})),[r]);return(0,ge.jsx)(R().A,{placement:J().W.Left,textWrap:!0,style:l.disabledTooltip,disableTooltip:!r,renderTooltip:()=>s,render:e=>(0,ge.jsx)(Ie().A,{...(0,V().A)(a,e),disabled:r,store:t,hidePath:o,style:l.recordMenuItem})})}var ke=()=>a(989372),we=()=>a(622163);function Pe(e){let{spaceStore:t,collectionStore:a,menuListItemProps:o}=e;const n=(0,s().v3)(),r=(0,i().IS)((e=>({caption:{color:e.text.tertiary,fontSize:(0,we().ny)(n,"UISmall")}})),[n]);return(0,ge.jsx)(Ie().A,{caption:(0,ge.jsx)("div",{style:r.caption,children:(0,ge.jsx)(Ce,{spaceStore:t,collectionStore:a})}),store:a,...o})}function Ce(e){let{spaceStore:t,collectionStore:a}=e;const o=(0,s().v3)(),i=(0,n().K8)((()=>function(e){let{environment:t,spaceStore:a,collectionStore:o}=e;const s=(0,T().X0)({collectionStore:o});switch(s){case"team":return null;case"private":return(0,ge.jsx)(S().sA,{id:"moveToHelpers.privatePageCaptionPrefix",defaultMessage:"Private"});case"shared":return(0,ge.jsx)(S().sA,{id:"moveToHelpers.sharedPageCaptionPrefix",defaultMessage:"Shared"});default:(0,f().HB)(s)}}({environment:o,spaceStore:t,collectionStore:a})),[o,t,a]),r=(0,n().K8)((()=>(0,ke().a6)(a)),[a])&&(0,ge.jsx)(ke().Ay,{store:a,showFullPathInTooltip:!0});return r&&i?(0,ge.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[i,(0,ge.jsx)("div",{style:{paddingLeft:4,paddingRight:4},children:"/"}),r]}):r&&!i?r:(0,ge.jsx)(ge.Fragment,{children:i})}function Be(e){let{spaceStore:t,value:a,showPath:o,isCreateIn:s,onAccept:n}=e;const i=function(e){let{spaceStore:t,value:a}=e;const{type:o}=a;switch(o){case"page":return re().Bv.createChildStore(t,{table:h().ev,id:a.id});case"collection":return re().md.createChildStore(t,{table:xe().Vl,id:a.id});case"space":return re().SL.createChildStore(t,{table:Ae().NX,id:a.id});case"team":return re().h4.createChildStore(t,{table:be().yK,id:a.id});case"space-private-pages":return;default:(0,f().HB)(o)}}({spaceStore:t,value:a});if(i)return(0,F().n6)()&&i instanceof re().md?{key:i.id,render:e=>(0,ge.jsx)(Pe,{spaceStore:t,collectionStore:i,menuListItemProps:e}),action:()=>n(a)}:{key:i.id,render:e=>(0,ge.jsx)(je,{store:i,menuListItemProps:e,hidePath:!!s&&!o}),action:()=>n(a)}}a(113085);var Le=()=>a(761079),Oe=()=>a(762847),De=()=>a(748267),Ke=()=>a(333889),Re=()=>a(563546),Ne=()=>a(579031),Ee=()=>a(4822),qe=()=>a(424339);const _e=100,ze=14,Ve=24;function We(e){return(e+1)*ze}function Fe(e){const{store:t,spaceStore:a,spaceViewStore:r,depth:l,isAlias:c,menuListItemProps:d,from:p}=e,m=(0,s().v3)(),g=(0,i().DP)(),[v,y]=o.useState(!1),f=(0,i().IS)((e=>({noChildrenLabelItem:{paddingLeft:We(l)+Ve,fontSize:14,paddingBottom:6.5,color:e.text.tertiary},outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingLeft:"moveToModalTyped"===p?We(l)-4:We(l),color:e.text.primary,alignItems:"center"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginRight:4,position:"relative"},button:{..."moveToModalTyped"===p?{borderRadius:4}:{}}})),[l,p]);function x(){const e=ie().Ay.state,a=e.isOpen?e.flowId:void 0;y(!v),Re().aM(m,{flowId:a,is_toggled:!v,destination_type:t?t.table:"private_pages"})}const A=(0,n().K8)((()=>{if(t){const e=(0,ge.jsx)("div",{children:(0,Ke().G)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})});return t instanceof re().h4?(0,ge.jsx)("div",{style:f.icon,children:(0,ge.jsx)(qe().x,{disabled:!0,store:t,size:18})}):(0,ge.jsxs)("div",{style:f.icon,children:[(0,ge.jsx)(O().B,{icon:t instanceof re().Bv?t.getIcon():void 0,isEmptyPage:t instanceof re().Bv&&t.isEmptyPage(),title:void 0,size:18,disabled:!0}),c&&e]})}return(0,ge.jsx)(E().A,{size:16,userStore:(0,_()._m)(m),style:{marginLeft:3}})}),[t,f.icon,m,c]),b=(0,n().K8)((()=>t?t.table===be().yK?"private"!==t.getTeamAccessLevel()?(0,ge.jsx)("div",{style:{maxWidth:"80%"},children:(0,ge.jsx)(Me().A,{store:t})}):(0,ge.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"80%"},children:[(0,ge.jsx)(Me().A,{store:t}),(0,De().g)({width:14,height:14,marginLeft:4,fill:g.mediumIconColor})]}):(0,ge.jsx)("div",{style:{maxWidth:"80%"},children:(0,ge.jsx)(Me().A,{store:t})}):(0,ge.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:7},children:[(0,ge.jsx)(S().sA,{defaultMessage:"Private pages",id:"outliner.addToPrivatePages"}),(0,ge.jsx)("div",{style:{marginLeft:2},children:(0,u().S)({width:14,height:14,fill:g.mediumIconColor,marginLeft:4})})]})),[t,g.mediumIconColor]),I=(0,n().K8)((()=>{const e=new Set([Oe().xd.page,Oe().xd.collectionViewPage,Oe().xd.collectionView,Oe().xd.alias]),a=new Set([Oe().xd.factory]);let o=[];return t?t instanceof re().h4?o=t.getTeamPagesStores():t instanceof re().Bv&&(o=(0,Ee().yD)({rootStore:t,shouldSkipItemTypes:a,shouldShowItemTypes:e})):o=r.getPrivatePages(m)??[],o}),[t,r,m]);const M=0!==I.length?(0,ge.jsx)(He,{spaceStore:a,spaceViewStore:r,itemStores:I,depth:l+1,onAccept:e.onAccept,targets:e.targets}):(0,ge.jsx)("div",{style:f.noChildrenLabelItem,children:(0,ge.jsx)(S().sA,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})});return(0,ge.jsxs)("div",{...d,children:[(0,ge.jsx)(me().A,{onClick:function(){e.moveToPagesOnly&&(null==t?void 0:t.table)!==h().ev?x():t?t instanceof re().Bv?e.onAccept({type:"page",id:t.id,spaceId:a.id}):e.onAccept({type:"team",id:t.id,spaceId:a.id}):e.onAccept({type:"space-private-pages",spaceId:a.id})},style:f.button,children:(0,ge.jsxs)("div",{style:f.outlinerItem,children:[(0,ge.jsx)(Ne().A,{isSidebar:!0,fill:!0,icon:"chevron",open:v,color:g.mediumIconColor,onClick:x}),A,b]})}),v&&l<_e&&M]})}function He(e){const{spaceStore:t,spaceViewStore:a,itemStores:o,depth:s}=e,r=(0,n().K8)((()=>{const n=o?y().oE(o.map((o=>{if(o instanceof re().h4&&o.canAddOrRemoveTopLevelPages()||o instanceof re().Bv&&(0,F().zO)(o,e.targets)&&o.canEdit()){const n=o instanceof re().Bv&&o.getType()===Oe().xd.alias,i=n?o.getAliasTargetStore():void 0,r=i instanceof re().Bv?i:o;return(0,ge.jsx)(Fe,{spaceStore:t,spaceViewStore:a,store:r,depth:s,onAccept:e.onAccept,targets:e.targets,isAlias:n,moveToPagesOnly:e.moveToPagesOnly},o.id)}}))):[];return e.addedItems?[...e.addedItems,...n]:n}),[o,e.addedItems,e.moveToPagesOnly,e.targets,e.onAccept,t,a,s]),l=(0,i().IS)((e=>({sectionHeader:{color:e.text.secondary,fontSize:12,fontWeight:x().Wy.medium,padding:"12px 14px 4px 14px"}})),[]);return(0,ge.jsxs)(P().A,{debugName:"MoveToOutliner",capture:!0,allowEsc:!0,allowLeft:!0,children:[e.title&&(0,ge.jsx)("div",{style:l.sectionHeader,children:(0,ge.jsx)(N().A,{isSmall:!0,children:e.title})}),(0,ge.jsx)("div",{children:r})]})}function Ue(e){const{spaceStore:t,spaceViewStore:a,targets:o,moveToPagesOnly:r,forceShowPrivatePageOption:l,onAccept:c}=e,d=(0,s().v3)(),u=(0,S().tz)(),p=(0,i().IS)((()=>({modal:{height:374,maxHeight:"70vh",paddingBottom:12},body:{width:"100%"}})),[]),m=(0,$().useTeams)({fromCache:!0,includeArchived:!1,spaceStore:t}),g=(0,n().K8)((()=>{const e=a.getTeamsStores().filter((e=>e.canAddOrRemoveTopLevelPages()));return e.length>=7?e:y().hS([...e,...m],(e=>e.id)).filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)}),[m,a]),h=(0,n().K8)((()=>Qe({spaceStore:t,targets:o})),[t,o]),v=(0,n().K8)((()=>{var e;return(null==a||null===(e=a.getWorkspacePages())||void 0===e?void 0:e.filter((e=>(0,F().zO)(e,o)&&e.canEdit())))??[]}),[a,o]),f=(0,n().O$)(Z().AppStoreCurrentSpaceStore),x=(0,n().K8)((()=>{if(Ge({environment:d,targets:o,chosenSpaceStore:t,forceShowPrivatePageOption:l,currentSpaceStore:f}))return(0,ge.jsx)(Fe,{spaceStore:t,spaceViewStore:a,store:void 0,depth:0,onAccept:c,targets:o,moveToPagesOnly:r},"MoveToModal private item")}),[d,c,o,t,a,r,l,f]);return t&&a?(0,ge.jsx)("div",{style:p.modal,children:(0,ge.jsx)("div",{style:p.body,children:(0,ge.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,ge.jsx)(He,{spaceStore:t,spaceViewStore:a,itemStores:h,addedItems:[x],moveToPagesOnly:r,depth:0,title:u.formatMessage({defaultMessage:"Suggested",id:"moveToModal.suggestedSection.title"}),onAccept:e.onAccept,targets:e.targets}),g&&g.length>0&&(0,ge.jsx)(He,{spaceStore:t,spaceViewStore:a,itemStores:g,moveToPagesOnly:r,depth:0,title:u.formatMessage({defaultMessage:"Teamspaces",id:"moveToModal.teamsSection.title"}),onAccept:e.onAccept,targets:e.targets}),v.length>0&&(0,ge.jsx)(He,{spaceStore:t,spaceViewStore:a,itemStores:v,moveToPagesOnly:r,depth:0,title:u.formatMessage({defaultMessage:"Workspace",id:"moveToModal.workspaceSection.title"}),onAccept:e.onAccept,targets:e.targets})]})})}):null}function Qe(e){let{spaceStore:t,targets:a}=e,o=Le().A.getWithoutSubscribing(t.id).map((e=>{let{store:t}=e;return t})).filter((e=>(null==e?void 0:e.pathIsAccessibleAndAlive())&&!a.some((t=>"block"===t.table&&t.id===e.id))));const s=a.filter((e=>"block"===e.getParentTable())).map((e=>e.getParentId())),n=s.length===a.length,i=[...new Set(s)];return n&&1===i.length&&(o=o.filter((e=>e.id!==i[0]))),o.slice(0,7)}function Ge(e){let{environment:t,targets:a,chosenSpaceStore:o,forceShowPrivatePageOption:s,currentSpaceStore:n}=e;const i=(0,G().IL)(o),r=a.every((e=>e.isTopLevelPrivatePage())),l=n&&o.id!==n.id;return!i&&(s||l||!r)}var $e=()=>a(712437),Ye=()=>a(566342),Xe=()=>a(839996),Je=()=>a(178063),Ze=()=>a(155342),et=()=>a(350492),tt=()=>a(34662),at=()=>a(10895),ot=()=>a(795394),st=()=>a(759625),nt=()=>a(191756),it=()=>a(448316),rt=()=>a(773253),lt=()=>a(527120),ct=()=>a(243899),dt=()=>a(356813),ut=()=>a(410194),pt=()=>a(397791),mt=()=>a(29393),gt=()=>a(949712),ht=()=>a(59175),St=()=>a(922172),vt=()=>a(729201),yt=()=>a(951540);class ft extends ee().default{getInitialState(){return!1}}const xt=new ft,At=(0,S().YK)({title:{id:"tasksCreateNewDatabase.modal.title",defaultMessage:"How would you like to name your private task database?"},placeholder:{id:"tasksCreateNewDatabase.modal.placeholder",defaultMessage:"{username}'s to-do list"},create:{id:"tasksCreateNewDatabase.modal.create",defaultMessage:"Create database"},cancel:{id:"tasksCreateNewDatabase.modal.cancel",defaultMessage:"Cancel"}}),bt=380,It=24;function Mt(e){const{handleCreateTaskDatabase:t}=e,a=(0,S().tz)(),r=(0,n().K8)((()=>Z().default.state.currentUserStore),[]),l=(0,n().K8)((()=>null==r?void 0:r.getDisplayName(a)),[r,a]),c=(0,s().Y0)(),[d,u]=(0,o.useState)(""),p=(0,n().O$)(xt),m=(0,i().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:`${It}px`,width:bt},editPropertyTypeIcon:{width:32,height:32,fill:e.text.tertiary},title:{color:e.text.primary,textAlign:"center"},input:{width:"100%",height:36,fontSize:16,marginTop:16,marginBottom:`${It}px`},createButton:{width:"100%",height:36,fontSize:16,marginBottom:16},cancelButton:{color:e.text.secondary,fontSize:16}})),[]),g=(0,o.useCallback)((()=>{d.trim()&&(t(d),xt.setState(!1))}),[d,t]),h=(0,o.useCallback)((()=>{xt.setState(!1)}),[]),v=(0,o.useCallback)((e=>{"Enter"===e.key&&g()}),[g]),y=(0,o.useCallback)((e=>{u(e.target.value)}),[u]),f=(0,o.useCallback)((()=>(0,ge.jsxs)("div",{style:m.container,children:[(0,ge.jsx)("div",{children:(0,gt().j)(m.editPropertyTypeIcon)}),(0,ge.jsx)("h3",{style:m.title,children:a.formatMessage(At.title)}),(0,ge.jsx)(ht().A,{value:d,onChange:y,placeholder:a.formatMessage(At.placeholder,{username:l}),style:m.input,autoFocus:!0,onKeyDown:v}),(0,ge.jsx)(yt().A,{style:m.createButton,onClick:g,children:a.formatMessage(At.create)}),(0,ge.jsx)(j().p,{style:m.cancelButton,onClick:()=>{xt.setState(!1)},children:a.formatMessage(At.cancel)})]})),[d,l,y,v,g,a,m.cancelButton,m.container,m.createButton,m.editPropertyTypeIcon,m.input,m.title]);return p?c.isPhone?(0,ge.jsx)(vt()._,{fullscreen:!0,renderInner:f}):(0,ge.jsx)(St().a,{open:!0,showCloseIcon:!0,onDismiss:h,render:f}):null}var Tt=()=>a(619262),jt=()=>a(574361),kt=()=>a(162901),wt=()=>a(818369);var Pt=()=>a(97111),Ct=()=>a(129978),Bt=()=>a(622286);function Lt(e){let{environment:t,spaceStore:a,joinedTeamIds:o,parentStore:s,moveToTargets:i,overrideDatabaseType:r}=e;const l=(0,n().K8)((()=>{const e=null==a?void 0:a.id;if(e)return function(e){if(!te.state)return;if(e!==te.state.spaceId)return;return te.state.typedDatabases}(e)}),[null==a?void 0:a.id]),c=(0,Bt().X)("typed_move_to_improved_default_results"),d=(0,Ct().fJ)(X().T.searchActions),[{value:u,status:p}]=(0,kt().Yb)((async()=>{if(l)return l;if(!a||!s)return;const e=r??ie().Ay.getDatabaseType();if(!e)return;if("resolved"!==d.status)return;const n=d.value;let u=[];if(c){const o=((await n.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:a,parentStore:a,collectionViewBlockStore:void 0,searchSessionId:ie().Ay.state.isOpen?ie().Ay.state.flowId:void 0})).results||[]).map((e=>re().md.createChildStore(s,{table:xe().Vl,id:e})));u=(0,Pt().vl)({typedDatabases:o,blocksToFilterParents:i})}else{const n=await async function(e){let{environment:t,spaceId:a,databaseType:o,parentStore:s}=e;if(!a)return;const n=await wt().callApi({eventName:"getTypedDatabases",environment:t,data:{spaceId:a,databaseType:o}});return"success"===n.type?n.data.result.map((e=>re().md.createChildStore(s,{table:xe().Vl,id:e.collectionId}))):void 0}({environment:t,spaceId:a.id,databaseType:e,parentStore:s})??[];u=(0,Pt().gq)({environment:t,typedDatabases:n,spaceStore:a,joinedTeamIds:o})}return te.setState({typedDatabases:u,spaceId:a.id}),ie().Ay.update((e=>({...e,variant:jt().Xy}))),u}),[l,a,s,r,d.status,d.value,c,t,i,o],{debounce:pe().tu,throttle:pe().tu});return l?{success:!0,typedDatabases:l}:"resolved"===p&&u?{success:!0,typedDatabases:u}:{success:!1}}const Ot=7;function Dt(e){const{spaceStore:t,spaceViewStore:a,targets:r,menuListStore:l,onAccept:d,moveToPagesOnly:u,forceShowPrivatePageOption:p,maxMenuItems:m=Ot}=e,g=(0,s().v3)(),h=(0,S().tz)(),v=(0,i().DP)(),{isMyTasksFullPage:x,currentSpaceStore:A}=(0,n().K8)((()=>{const e=Z().default.state.mainEditorCurrentBlockStore,t=Z().default.state.currentSpaceStore;return{isMyTasksFullPage:Boolean(e&&(0,_().sj)(e.id)),currentSpaceStore:t}}),[]),b=(0,n().K8)((()=>a.getTeamsStores().map((e=>e.id))),[a]),M=(0,n().K8)((()=>ie().Ay.getDatabaseType()),[]),j=(0,n().K8)((()=>F().Hc()),[]),w=Lt({environment:g,spaceStore:t,parentStore:t,joinedTeamIds:b,moveToTargets:r}),P=(0,i().IS)((e=>({modal:{maxHeight:"70vh"},loadingShimmer:{padding:16},privateMenuItem:{marginLeft:4,marginRight:4,borderRadius:4},menuItemFooterButton:{color:e.text.secondary,fill:e.mediumIconColor}})),[]),C=(0,o.useCallback)((e=>{const a={key:e.id,render:a=>(0,ge.jsx)(Pe,{spaceStore:t,collectionStore:e,menuListItemProps:a}),action:()=>d({type:"collection",id:e.id,spaceId:t.id})};return a}),[t,d]),B=(0,n().K8)((()=>w.success?w.typedDatabases.map((e=>C(e))):[]),[w,C]);(0,o.useEffect)((()=>{0===B.length&&ie().Ay.setState({...ie().Ay.state,variant:"untyped"})}),[B.length]);const L=(0,n().K8)((()=>Ge({environment:g,targets:r,chosenSpaceStore:t,forceShowPrivatePageOption:p,currentSpaceStore:A})),[g,p,t,r,A]),O=(0,n().K8)((()=>{const{isMobile:e}=g.device;if(e){const e=r.every((e=>e.isNavigableBlock()));return Gt({query:"",chosenSpaceStore:t},g,v,h,r,d,e,p)}return{key:"privateMenuItem",render:e=>(0,ge.jsx)("div",{style:P.privateMenuItem,children:(0,ge.jsx)(Fe,{spaceStore:t,spaceViewStore:a,store:void 0,depth:0,onAccept:d,targets:r,moveToPagesOnly:u,menuListItemProps:e,from:"moveToModalTyped"})}),action:()=>{}}}),[g,p,h,u,d,t,a,P.privateMenuItem,r,v]),K=x?"home_tasks":"home_tile_tasks",R=(0,o.useMemo)((()=>({key:"helpMenuItem",render:()=>(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(ct().CollectionTasksEmptyStateModal,{from:K}),(0,ge.jsx)(k().A,{style:P.menuItemFooterButton,icon:(0,ge.jsx)(pt().I,{icon:Ze().questionMarkCircleIcon}),focused:!1,title:(0,ge.jsx)(S().sA,{defaultMessage:"Don't see your database?",id:"moveToModalTyped.helpMenuItem.title"}),onClick:()=>{Tt().A.setState(!0),(0,mt().bS)({environment:g,from:K})}})]}),action:()=>{}})),[g,K,P.menuItemFooterButton]),N=(0,o.useCallback)((e=>{let o,s;I().createAndCommit({userAction:"moveToModalTyped.handleCreateTodoList",environment:g,canUndo:!0,perform:function(n){o=st().Wv({environment:g,transaction:n,type:"collection_view",inMemoryRecordCache:g.defaultRecordCache.inMemoryRecordCache}),ot().NI({childStore:o,parentStore:t,transaction:n});const i=lt().initializeApp({environment:g,spaceViewStore:a,appUri:Ye().a6,presetUri:"notion://tasks_collection_typedDBpreset",appParentStore:t,temporaryContainerBlockStore:o,transaction:n,from:"my_tasks",skipNavigation:!0});s=null==i?void 0:i[0].getCollectionStore(),s&&it().R9({environment:g,store:s.getNameStore(),value:(0,tt().x9d)(e),transaction:n}),rt().HK({id:"database_creation_toast",title:h.formatMessage({id:"moveToModalTyped.databaseCreated.title",defaultMessage:"Database created"}),message:h.formatMessage({id:"moveToModalTyped.databaseCreated.message",defaultMessage:'"{name}" has been created'},{name:e}),presentationType:"persistent",iconGroup:Xe().g,iconGroupColorName:"greenPrimary",actions:{primary:{title:h.formatMessage({id:"moveToModalTyped.databaseCreated.openDatabase",defaultMessage:"Open database"}),onAction:()=>{nt().uK({environment:g,store:null==i?void 0:i[0],pageVisitSource:$e().y8.PersonalHomePage}),rt().UW("database_creation_toast")}}}})}}),s&&function(e){const t=te.state;t&&te.setState({...t,typedDatabases:[...t.typedDatabases,e]})}(s),at().VN({environment:g,clearSelection:!0})}),[g,h,t,a]),E=(0,o.useMemo)((()=>({key:"createDatabaseItem",render:()=>(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(Mt,{handleCreateTaskDatabase:N}),(0,ge.jsx)(k().A,{style:P.menuItemFooterButton,icon:(0,ge.jsx)(pt().I,{icon:Je().plusIcon}),focused:!1,title:(0,ge.jsx)(S().sA,{defaultMessage:"New private task database",id:"moveToModalTyped.createDatabaseItem.title"}),onClick:()=>{xt.setState(!0)}})]}),action:()=>{}})),[N,P.menuItemFooterButton]);if(!w.success||0===B.length)return(0,ge.jsx)("div",{style:P.loadingShimmer,children:(0,ge.jsx)(ut().A,{paragraphs:[{lineHeight:18,lineMargin:4,sectionWidths:[100],repeat:1,sectionMargin:0},{lineHeight:14,lineMargin:4,sectionWidths:[100,40],repeat:1,sectionMargin:-2}]})});if(!M)throw new Error("Trying to show typed moveTo modal when database type is not available.");const q=(0,T().$O)(M),z=y().oE([{key:"suggested",render:e=>(0,ge.jsx)(D().A,{...e,title:j?(0,ge.jsx)(S().sA,{defaultMessage:"{typedItemName} databases",id:"moveToModalTyped.suggestedMenuSection.title",values:{typedItemName:(0,c().A)(q)}}):(0,ge.jsx)(S().sA,{defaultMessage:"Where would you like to create your {typedItemName}?",id:"moveToModalTyped.suggestedMenuSection.titleNew",values:{typedItemName:q}}),right:j?(0,ge.jsx)(Kt,{typedItemName:q}):null}),items:B.slice(0,m)},L&&(0,f().O9)(O)&&{key:"other",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Other",id:"moveToModalTyped.otherSection.title"})}),items:[O]},!j&&{key:"create-new-footer",render:e=>(0,ge.jsx)(D().A,{...e,topBorder:!0}),items:[R,E]}]);return(0,ge.jsx)("div",{style:P.modal,children:(0,ge.jsx)(de().Ay,{initialFocus:0,type:de().Oh.Vertical,sections:z||[],store:l})})}function Kt(e){const{typedItemName:t}=e,a=(0,S().tz)(),{isMobile:o}=(0,s().Y0)(),n=(0,i().IS)((e=>({tooltip:{width:220},icon:{width:16,height:16,fill:e.mediumIconColor},iconButton:{height:18,width:18,padding:0,marginTop:-4,marginBottom:-4,marginRight:-4}})),[]);return o?null:(0,ge.jsx)(R().A,{placement:J().W.Bottom,style:n.tooltip,textWrap:!0,renderTooltip:()=>(0,ge.jsx)(S().sA,{defaultMessage:"{typedItemName} properties will be kept when moving to these locations",id:"moveTypedMenu.tooltip",values:{typedItemName:(0,c().A)(t)}}),render:e=>(0,ge.jsx)(dt().A,{ariaLabel:a.formatMessage({id:"moveToModalTyped.helpIcon.ariaLabel",defaultMessage:"Help icon for moving typed pages."}),icon:et().questionMarkCircleSmallIcon,iconStyle:n.icon,style:n.iconButton,...e})})}const Rt=5,Nt=(0,S().YK)({createSubpage:{id:"moveToOrCreateMenu.createSubpage.description",defaultMessage:"Create a new sub-page where your cursor is, inside the current block."},newPageIn:{id:"moveToOrCreateMenu.newPageIn.description",defaultMessage:"Create a new page inside any existing page, then link to it in one go."},turnInto:{id:"moveToOrCreateMenu.turnInto.description",defaultMessage:"Turn blocks into new pages inside any existing database or page."},privatePagesTitle:{defaultMessage:"Private Pages",id:"moveBlockMenu.privatePagesMenuTitle"}});const Et=function(e){let{targets:t,isCreateIn:l,onAccept:d,isAddTo:u,isTurnIntoPage:p,parentBlockId:m,autocompleteQuery:g,onAutocompleteQueryChange:x,onMouseEnter:A,onCancel:I,desktopWidth:M,forceShowPrivatePageOption:j=!1}=e;const k=(0,S().tz)(),w=(0,i().DP)(),C=(0,s().v3)(),B=(0,n().uB)(void 0,a(210466).A),L=(0,n().uB)(void 0,a(331736).A),O=(0,n().uB)(void 0,ne),K=(0,n().K8)((()=>t.length>0&&t.every((e=>e.isNavigableBlock()))),[t]),R=(0,o.useCallback)((e=>async function(e,t,a,o,s,n,i,l,d,u,p,m,g){const{currentUserRootStore:x,currentSpaceStore:A}=Z().default.state,{query:I}=e,M=p.getChosenSpaceStore();if(!x||!M||!A)return[];const j=(0,U().pw)({spaceStore:M,currentUserId:t.currentUser.id}),[k,w,P,C]=await async function(e,t,a,o,s,n){const i=[],r=[],l=[];let c=[];if(t&&qt()){const r=await X().T.searchActions.load(),c=ie().Ay.state,d=c.isOpen?c.queryLimit:W().p1,u=await r.searchPageIds({environment:s,query:t,limit:d+1,spaceId:e.id,requireEditPermissions:!1,excludeTemplates:!1,source:"move_to_menu",boostRecentlyViewedPages:!0,spaceStore:n}),p=u.results.length>d;ie().Ay.state.isOpen&&ie().Ay.state.canLoadMore!==p&&ie().Ay.setState({...ie().Ay.state,canLoadMore:p});for(const t of u.results){const s=re().Bv.createChildStore(e.getPagesStore(),{table:h().ev,id:t});if(F().zO(s,a)){const e={blockId:s.id,isEditable:s.canEdit()};zt(s,o)?l.push(e):i.push(e)}}}else{c=(await b()._P(e,e.id)).map((t=>{const a=re().Bv.createChildStore(e.getPagesStore(),{table:h().ev,id:t});return{blockId:a.id,isEditable:a.canEdit()}})),c=c.filter((t=>{let{blockId:s}=t;const n=re().Bv.createChildStore(e.getPagesStore(),{table:h().ev,id:s});if(F().zO(n,a)){const e={blockId:n.id,isEditable:n.canEdit()};return!zt(n,o)||(l.push(e),!1)}}));const t=_()._y(s);for(const e of t)if(F().zO(e,a)){const t={blockId:e.id,isEditable:e.canEdit()};zt(e,o)?l.push(t):r.push(t)}}return[i,r,l,c]}(M,I,o,s,t,A),B=await j;if(F().n6())return await async function(e,t,a,o,s,n,i,l){const{chosenSpaceStore:d,savedQuickAddParent:u,query:p,blockResults:m,recentPageResults:g}=e,{typedSuggestedMenuSection:h,typedSuggestedResults:x}=await async function(e,t,a,o,s){if(!ie().Ay.state.isOpen||ie().Ay.state.variant===r().iH||!te.state)throw new Error("Trying to render section when it's either not open, untyped, or typed but uninitialized (i.e. the typed databases are not fetched yet)");const n=ie().Ay.getDatabaseType(),i=(0,T().$O)(n),{typedDatabases:l}=te.state;let d;d=oe().default.checkGate({gateName:"typed_move_to_improved_search"})?await async function(e,t,a,o,s){const{databaseType:n,query:i,searchSessionId:r}=e,l=Ht(s);if(!l)return[];const c=await X().T.searchActions.load(),d=(await c.searchCollectionsWithRecents({environment:t,query:i,limit:20,databaseType:n,parentStore:l,spaceStore:l,collectionViewBlockStore:void 0,searchSessionId:r})).results,u=d.map((e=>Be({spaceStore:l,value:{type:"collection",id:e,spaceId:l.id},showPath:!0,isCreateIn:a,onAccept:a?o:e=>Vt(e,o,t)}))).filter(f().O9);return u}({query:e,databaseType:n?[n]:void 0,searchSessionId:ie().Ay.state.flowId},t,a,o,s):function(e,t,a,o){const{query:s,typedDatabases:n}=e,i=Ht(o);if(!i||!s||!n)return[];const r=(0,v().Ay)(s,n,(e=>{const t=String(e.getName())||"",a=(0,H().Lf)(e);return[t,a instanceof re().h4&&a.getName()||""].join(" ")}));return r.map((e=>Be({spaceStore:i,value:{type:"collection",id:e.id,spaceId:i.id},showPath:!0,isCreateIn:t,onAccept:a}))).filter(f().O9)}({query:e,typedDatabases:l},a,o,s);const u={key:"suggested",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"{typedItemName} databases",id:"moveBlockMenu.typedSuggestedSection.title",values:{typedItemName:(0,c().A)(i)}}),right:(0,ge.jsx)(Kt,{typedItemName:i})}),items:d.slice(0,Rt)};return{typedSuggestedMenuSection:u,typedSuggestedResults:l}}(p,t,a,o,i);if(ie().Ay.state.isOpen&&"aggregated_type"===ie().Ay.state.moveToContext)return[h].filter((e=>e.items.length>0));let A=F().Pk({recentPageResults:g,blockResults:m,suggestedPages:x});const b=new Set(F().rD(s));b.size>0&&(A=A.filter((e=>!b.has(e.blockId))));const I=y().hS(y().qI(y().oE([Qt({query:p,savedQuickAddParent:u},n,a,o,i),...A.map((e=>{let{blockId:t}=e;return Be({spaceStore:d,value:{type:"page",id:t,spaceId:d.id},showPath:!p,isCreateIn:a,onAccept:o})}))])),(e=>e.key)),M=y().oE($t(p,a,o,i,l)).slice(0,Rt),j=h.items.length>0,k={key:"teams",render:e=>(0,ge.jsx)(D().A,{...e,desktopStyle:{paddingTop:j?0:6,paddingBottom:6},title:(0,ge.jsx)(S().sA,{defaultMessage:"Teamspaces",id:"typedMoveBlockMenu.teamsSection.title"})}),items:M},w=h.items.length>0&&0===k.items.length;return[h,k,{key:"pages",render:e=>(0,ge.jsx)(D().A,{...e,desktopStyle:{paddingTop:w?0:6,paddingBottom:6},title:(0,ge.jsx)(S().sA,{defaultMessage:"Pages",id:"typedMoveBlockMenu.pagesSection.title"})}),items:I}].filter((e=>e.items.length>0))}({chosenSpaceStore:M,savedQuickAddParent:B,query:I,blockResults:k,recentPageResults:C},t,s,n,o,i,p,m);if(s)return function(e,t,a,o,s,n,i,r,l,c,d,u,p,m,g){const h=[],v=new Set,f=e=>{if(!e)return!1;const{key:t}=e;return!v.has(t)&&(v.add(t),!0)},x=y().oE([_t({query:t},i,c,d,u,r,p)]);!x.length||Boolean(l)||Boolean(r)||h.push({key:"defaults",render:e=>(0,ge.jsx)(D().A,{...e}),items:x});const A=y().oE([...n.slice(0,5).map((t=>{let{blockId:a}=t;return Be({spaceStore:e,value:{type:"page",id:a,spaceId:e.id},showPath:!Boolean(l)&&!Boolean(r),isCreateIn:p,onAccept:d})})),...a.slice(0,10).map((a=>{let{blockId:o}=a;return Be({spaceStore:e,value:{type:"page",id:o,spaceId:e.id},showPath:!t,isCreateIn:p,onAccept:d})})),...o.slice(0,10).map((a=>{let{blockId:o}=a;return Be({spaceStore:e,value:{type:"page",id:o,spaceId:e.id},showPath:!t,isCreateIn:p,onAccept:d})}))].slice(0,20).filter(f));A.length>0&&h.push({key:"blocks",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"}),topBorder:h.length>0&&!Boolean(l)&&!Boolean(r)}),items:A});const b=y().oE($t(t,p,d,m,g).filter(f));b.length>0&&h.push({key:"teams",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"}),topBorder:h.length>0}),items:b});const I=y().oE(s.slice(0,5).map((t=>{let{blockId:a}=t;return Be({spaceStore:e,value:{type:"page",id:a,spaceId:e.id},showPath:!0,isCreateIn:p,onAccept:d})})).filter(f));I.length>0&&h.push({key:"templates",render:e=>(0,ge.jsx)(D().A,{...e,title:r?(0,ge.jsx)(S().sA,{defaultMessage:"Add from template",id:"moveBlockMenu.addFromTemplate.title"}):(0,ge.jsx)(S().sA,{defaultMessage:"Move to template",id:"moveBlockMenu.moveToTemplate.title"}),topBorder:h.length>0}),items:I});x.length&&(Boolean(l)||Boolean(r))&&h.push({key:"defaults",render:e=>(0,ge.jsx)(D().A,{...e,topBorder:h.length>0}),items:x});return h}(M,I,k,w,P,C,t,i,l,o,n,d,s,p,m);return function(e,t,a,o,s,n,i,r,l,c,d,u,p,m,g,h,v){const f=function(e,t,a,o,s,n,i,r,l,c){const d=0===e.length&&t?Qe({spaceStore:t,targets:s}):[],u={key:"suggested",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"})}),items:y().oE([Gt({query:e,chosenSpaceStore:t},a,o,n,s,i,l,c),...d.filter((e=>F().zO(e,s))).map((e=>Be({spaceStore:t,value:{type:"page",id:e.id,spaceId:t.id},showPath:!1,isCreateIn:r,onAccept:i})))])};return u}(a,e,r,l,c,d,u,p,h,v),x=ie().Ay.state,A=x.isOpen?x.queryLimit:W().p1,b=[...i.slice(0,3),...o.slice(0,A)],I={key:"pages",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Pages",id:"moveBlockMenu.pagesSection.title"})}),items:y().hS(y().qI(y().oE([Qt({query:a,savedQuickAddParent:t},m,p,u,g),...b.map((t=>{let{blockId:o}=t;return Be({spaceStore:e,value:{type:"page",id:o,spaceId:e.id},showPath:!a,isCreateIn:p,onAccept:u})}))])),(e=>e.key))},M={key:"teams",render:e=>(0,ge.jsx)(D().A,{...e,title:(0,ge.jsx)(S().sA,{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"})}),items:y().oE($t(a,p,u,g,h)).slice(0,10)};return[f,M,I].filter((e=>e.items.length>0))}(M,B,I,k,0,0,C,t,a,o,u,n,s,i,p,m,g)}(e,C,w,t,l,d,u,p,m,k,O,K,j)),[C,w,t,l,d,u,p,m,k,O,K,j]),N=(0,n().K8)((()=>ie().Ay.state.isOpen),[]),E=(0,n().K8)((()=>!L.state.ready&&g.length>0),[L,g]),q=(0,n().K8)((()=>qt()),[]),V=(0,s().WS)(),Q=(0,n().K8)((()=>F().n6()),[]),G=(0,n().K8)((()=>{var e;return null===(e=Ht(O))||void 0===e?void 0:e.id}),[O]);if(!u&&!l&&!N)return(0,ge.jsx)(ge.Fragment,{});let $,Y;$=q?V?(0,ge.jsx)(Jt,{autocompleteQuery:g,onAutocompleteQueryChange:x,isAddTo:u,isTurnIntoPage:p,moveToSpaceMenuStore:O,menuListStore:B,isLoading:E}):(0,ge.jsx)(D().A,{isInput:!0,children:(0,ge.jsx)(Jt,{autocompleteQuery:g,onAutocompleteQueryChange:x,isAddTo:u,isTurnIntoPage:p,moveToSpaceMenuStore:O,menuListStore:B,isLoading:E})}):void 0,Y=V?{onMouseEnter:A,menuType:z().gu.Modal,title:p?(0,ge.jsx)(S().sA,{defaultMessage:"Add to another page",id:"moveBlockMenu.mobileNewPageInj.label"}):u?(0,ge.jsx)(S().sA,{defaultMessage:"Add new page in",id:"moveBlockMenu.mobileAddTo.label"}):(0,ge.jsx)(S().sA,{defaultMessage:"Move to",id:"moveBlockMenu.mobileMoveTo.label"}),right:(0,ge.jsx)(S().sA,{defaultMessage:"Done",id:"moveBlockMenu.rightDoneButton.label"}),onClickRight:I,header:$}:{onMouseEnter:A,menuType:z().gu.Popup,width:M,header:$};const J=!Boolean(g)&&!V||Q&&!Boolean(g);return(0,ge.jsxs)(P().A,{debugName:"MoveToOrCreateMenu",capture:!0,allowMenuList:!0,allowEsc:!0,allowLeft:!0,allowTabUntab:!1,allowUndo:!1,children:[(0,ge.jsx)(a(655830).A,{debugName:"MoveToOrCreateMenu",capture:!0,onEsc:I}),(0,ge.jsx)(a(935091).A,{...Y,onClick:e=>{e.stopPropagation()},footer:(0,ge.jsx)(Xt,{isCreateIn:l,isAddTo:u,moveToSpaceMenuStore:O,allTargetsAreNavigable:K}),children:J?(0,ge.jsx)(Yt,{onAccept:d,targets:t,moveToSpaceMenuStore:O,menuListStore:B,allTargetsAreNavigable:K,forceShowPrivatePageOption:j}):(0,ge.jsx)(ye,{query:g,spaceId:G,menuListStore:B,requestStore:L,getAutocompleteItems:R})})]})};function qt(){return ae().A.state.online}function _t(e,t,a,o,s,n,i){if(!n||!i)return;if(e.query)return;const r=Z().default.state.mainEditorCurrentBlockStore;if(!r)return;const c=s?re().Bv.createChildStore(r,{table:h().ev,id:s}):void 0,d=A().D8(c);return d?{key:d.pageStore.id,render:e=>{const o=t=>(0,ge.jsx)(k().A,{...(0,V().A)(t||{},e),icon:(0,p().W)({width:14}),title:a.length>1?(0,ge.jsx)(S().sA,{id:"moveBlockMenu.currentPage.pluralAddTitle",defaultMessage:"New sub-pages"}):(0,ge.jsx)(S().sA,{id:"moveBlockMenu.currentPage.singleAddTitle",defaultMessage:"New sub-page"})});return t.device.isPhone?o():(0,ge.jsx)(R().A,{renderTooltip:()=>(0,ge.jsx)(q().A,{imageURL:l().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,ge.jsx)(S().sA,{...Nt.createSubpage})}),placement:J().W.Right,delayThreshold:0,render:e=>o(e)})},action:()=>o(d.createInValue)}:void 0}function zt(e,t){return!!t&&e.isTemplate()}function Vt(e,t,a){var o;t(e);const s=ie().Ay.getDatabaseType(),n=null===(o=Z().default.state.currentSpaceStore)||void 0===o?void 0:o.id;"collection"===e.type&&n&&I().createAndCommit({userAction:"TypedMoveToMenu.handleClick",environment:a,canUndo:!0,perform:t=>{M().ee({transaction:t,databaseType:s,collectionId:e.id})}})}function Wt(e){return{width:10,marginLeft:4,fill:e.lightIconColor}}function Ft(e){var t;return!!e&&e.getChosenSpaceId()!==(null===(t=Z().default.state.currentSpaceStore)||void 0===t?void 0:t.id)}function Ht(e){return e.getChosenSpaceStore()??Z().default.state.currentSpaceStore}function Ut(e){return e.getChosenSpaceViewStore()??Z().default.state.currentSpaceViewStore}function Qt(e,t,a,o,s){const{query:n,savedQuickAddParent:i}=e,r=Ht(s);if(r)return t&&!n&&"space"===i.type||"page"===i.type?Be({spaceStore:r,value:i,showPath:!0,isCreateIn:a,onAccept:o}):void 0}function Gt(e,t,a,o,s,n,i,r){var l;const{query:c,chosenSpaceStore:d}=e,p=Z().default.state.currentSpaceStore,m=Nt.privatePagesTitle,g=o.formatMessage(m).replace(/<[^>]*>/g,""),h=c?null===(l=(0,v().It)(c,g))||void 0===l?void 0:l.score:void 0,y=c&&(h||0)>=v().sH;if((!c||y)&&i&&(!d||Ge({environment:t,targets:s,chosenSpaceStore:d,forceShowPrivatePageOption:r,currentSpaceStore:p})))return{key:"private",render:e=>(0,ge.jsx)(k().A,{icon:(0,ge.jsx)(E().A,{size:22,userStore:(0,_()._m)(t)}),title:(0,ge.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,ge.jsx)("span",{children:(0,ge.jsx)(S().sA,{...m})}),(0,$().getActiveTeamCount)()>0&&(0,ge.jsx)("div",{style:{marginLeft:10,display:"flex",alignItems:"center"},children:(0,u().S)({width:16,height:16,fill:a.mediumIconColor})})]}),...e}),action:()=>{n({type:"space-private-pages"})}}}function $t(e,t,a,o,s){if(e&&!s)return[];const n=Ht(o),i=Ut(o);if(!n||!i)return[];let r=i.getTeamsStores();return e&&(r=(0,v().Ay)(e,r,(e=>e.getName()||""))),r.map((e=>Be({spaceStore:n,value:{type:"team",id:e.id,spaceId:n.id},showPath:!1,isCreateIn:t,onAccept:a}))).filter(f().O9)}function Yt(e){let{onAccept:t,targets:a,moveToSpaceMenuStore:o,menuListStore:i,allTargetsAreNavigable:r,forceShowPrivatePageOption:l}=e;const c=(0,s().v3)(),d=(0,n().K8)((()=>Ht(o)),[o]),u=(0,n().K8)((()=>Ut(o)),[o]),p=(0,n().K8)((()=>F().n6()),[]),m=(0,n().K8)((()=>(0,G().IL)(d)),[d]);if(!u||!d)return null;const g=!r||m;return p?(0,ge.jsx)(Dt,{spaceStore:d,spaceViewStore:u,onAccept:e=>Vt(e,t,c),targets:a,menuListStore:i,moveToPagesOnly:g,forceShowPrivatePageOption:l,maxMenuItems:5}):(0,ge.jsx)(Ue,{spaceStore:d,spaceViewStore:u,onAccept:t,targets:a,moveToPagesOnly:g,forceShowPrivatePageOption:l})}function Xt(e){let{isCreateIn:t,isAddTo:a,moveToSpaceMenuStore:o,allTargetsAreNavigable:r}=e;const l=(0,S().tz)(),c=(0,i().DP)(),u=(0,s().v3)(),{currentUserRootStore:p,currentSpaceStore:m}=(0,n().K8)((()=>{const{currentUserRootStore:e,currentSpaceStore:t}=Z().default.state;return{currentUserRootStore:e,currentSpaceStore:t}}),[]),g=(0,n().K8)((()=>o.getChosenSpaceStore()),[o]),h=(0,n().K8)((()=>r&&!(null!=m&&m.getDisableMoveToSpace())&&!t&&!a),[r,m,t,a]),v=(0,n().K8)((()=>null==p?void 0:p.getSpaceViewStores()),[p]),f=(0,n().K8)((()=>y().hS(y().oE(null==v?void 0:v.map((e=>{const t=e.getSpaceStore();return!(0,G().IL)(t)&&t}))),(e=>e.id))),[v]);if(!p||!g||!m)return null;if(!h)return null;const x={menuTitle:l.formatMessage({defaultMessage:"Workspaces",id:"moveBlockMenu.spaceSwitcher.menuTitle"}),items:f,selectedItem:g,onSelect:e=>{o.setState({chosenSpaceId:e.id})},getKey:e=>e.id,renderItem:e=>(0,ge.jsx)(k().A,{...e,isChecked:e.value.id===g.id,title:(0,G().GK)(u,e.value),icon:(0,ge.jsx)(O().B,{icon:(0,G().c2)(u,e.value),isEmptyPage:!1,size:20,disabled:!0,title:(0,G().GK)(u,e.value)})}),renderOrigin:e=>(0,ge.jsxs)(j().p,{size:"sm",style:{fontWeight:"normal",fontSize:12,flexShrink:1},...e,children:[(0,ge.jsx)(O().B,{disabled:!0,icon:g.getIcon(),isEmptyPage:!1,size:16,title:g.getName(),style:{marginRight:4}}),(0,ge.jsx)(le().j,{children:(0,G().GK)(u,g)}),(0,d().b)(Wt(c))]}),width:150};return(0,ge.jsxs)("div",{children:[(0,ge.jsx)(w().A,{vertical:!1,size:1}),(0,ge.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",padding:"4px"},children:(0,ge.jsx)(K().A,{...x},"space-switcher")})]})}function Jt(e){let{isLoading:t,autocompleteQuery:a,onAutocompleteQueryChange:o,isAddTo:l,isTurnIntoPage:c,moveToSpaceMenuStore:d,menuListStore:u}=e;const p=(0,S().tz)(),h=(0,i().DP)(),v=(0,s().v3)(),{device:y}=v,f=(0,n().K8)((()=>F().n6()&&ie().Ay.state.isOpen&&ie().Ay.state.variant===r().Xy&&!te.state),[]),A=(0,n().K8)((()=>function(e){let{intl:t,isAddTo:a,isTurnIntoPage:o,moveToSpaceMenuStore:s}=e;if(Ft(s))return t.formatMessage({defaultMessage:"Duplicate page…",id:"moveToMenuRenderer.duplicateToSpace.label"});if(F().n6()){const e=ie().Ay.getDatabaseType();if(F().Hc()){const a=(0,T().$O)(e);return t.formatMessage({defaultMessage:"Move {typedItemName} to…",id:"moveToMenuRenderer.moveTo.typedLabel"},{typedItemName:a})}{const a=(0,T().$O)(e);return t.formatMessage({defaultMessage:"Search for a {typedItemName} database…",id:"moveToMenuRenderer.createIn.typedLabel"},{typedItemName:a})}}return o?t.formatMessage({defaultMessage:"Search page to add in…",id:"moveToMenuRenderer.addNewPageIn.label"}):a?t.formatMessage({defaultMessage:"Search page to add to…",id:"moveToMenuRenderer.addTo.label"}):t.formatMessage({defaultMessage:"Move page to…",id:"moveToMenuRenderer.moveTo.teamLabel"})}({intl:p,isAddTo:l,isTurnIntoPage:c,moveToSpaceMenuStore:d})),[p,l,c,d]),b=(0,n().K8)((()=>Ft(d)),[d]),I=(0,Y().A)(t,400,0);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)(C().Ay,{onCancel:()=>{ie().Ay.state.isOpen&&ie().Ay.setState({...ie().Ay.state,isOpen:!1})},preventCaptureArrowShortcuts:!a,disabled:f,focus:!y.isMobile||void 0,focusAfterAnimation:!0,value:a,onChange:e=>{o(e.target.value),u.setState({...u.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:A,inputLeft:(0,ge.jsx)(C().Zf,{icon:m().q}),inputRight:I&&(0,ge.jsx)(L().A,{style:{marginRight:2}}),style:{marginBottom:-2}}),b&&(0,ge.jsxs)(N().A,{isMultiline:!0,isSecondaryColor:!1,style:{background:h.accentColors.gray[30],marginTop:12,marginLeft:12,marginRight:12,padding:8,borderRadius:6},children:[(0,g().Q)({fill:h.accentColors.orange[400],width:14,height:14,marginRight:4,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"}),(0,ge.jsx)("span",{children:(0,ge.jsx)(S().sA,{id:"moveBlockMenu.duplicateToSpace.message",defaultMessage:"You can only duplicate pages into another workspace — not move them."})}),(0,ge.jsx)(B().A,{href:(0,Q().xS)("guides.duplicateToSpace"),style:{color:h.accentColors.gray[500],fontWeight:x().Wy.semibold,marginTop:4},children:(0,ge.jsx)(S().sA,{id:"moveBlockMenu.duplicateToSpace.learnMoreLink",defaultMessage:"Learn more"})})]})]})}},839996:(e,t,a)=>{a.d(t,{g:()=>o});const o=(0,a(680369).xh)("checkmarkCircle",{default:{loader:()=>a.e(44032).then(a.bind(a,423162))},small:{loader:()=>a.e(44032).then(a.bind(a,29152))},fill:{loader:()=>a.e(44032).then(a.bind(a,135866))},fillSmall:{loader:()=>a.e(44032).then(a.bind(a,796627))}},["check","mark","tick","confirm","approve"])}}]);