"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[63327],{10872:(e,t,o)=>{o.d(t,{X:()=>k});o(610931),o(725707),o(491955);var r=o(242343),n=()=>o(803290),a=()=>o(174114),i=()=>o(686752),l=()=>o(836693),s=()=>o(653998),u=()=>o(76394),c=()=>o(535906),p=()=>o(935091),d=()=>o(858023),m=()=>o(397791),g=()=>o(88271),y=()=>o(907721),h=()=>o(962373),f=()=>o(738355),v=()=>o(441911),x=()=>o(929841),S=()=>o(993517),b=()=>o(100096),C=o(163643);function k(e){const{onDelete:t,styles:o}=e,{disabled:i}=(0,f().b)(),l=Boolean(i),s=(0,n().uB)(void 0,h().A),c=(0,r.useCallback)((()=>{if(!t)throw new Error("onDelete is not implemented for trigger");t(),s.setState({open:!1})}),[s,t]),p=(0,r.useMemo)((()=>t?(0,C.jsx)(A,{onDelete:c}):null),[t,c]),d=(0,a().IS)((e=>({componentWrap:{borderRadius:10},buttonWrap:{borderRadius:10}})),[]),m=(0,r.useCallback)((t=>{const r=e.onClick?b().aX:b().ot;return(0,C.jsx)(r,{...t,actionMenu:p,buttonPopupStore:s,disabled:l,icon:e.icon,onClick:e.onClick,styles:{...o,...d},hideDragHandle:!0,children:e.children})}),[e.onClick,e.icon,e.children,p,s,l,o,d]);return(0,C.jsx)(x().ck,{children:(0,C.jsx)(S().P,{disable:l,renderOrigin:m,title:e.tooltip,tooltipPlacement:e.tooltipPlacement||y().W.Bottom,disableTooltip:!(0,u().O9)(e.tooltip)})})}function A(e){const{onClose:t,onEdit:o,onDelete:r}=e,n=(0,v().e)(),a=[o?{action:()=>{null==t||t(),o()},key:"edit",render:e=>(0,C.jsx)(c().A,{...e,icon:(0,C.jsx)(m().I,{icon:i().pencilLineIcon}),title:(0,C.jsx)(s().sA,{id:"automationBaseStepElement.moreActionsMenu.edit",defaultMessage:"Edit"})})}:void 0,r?{action:()=>{null==t||t(),r()},key:"delete",render:e=>(0,C.jsx)(c().A,{...e,icon:(0,C.jsx)(m().I,{icon:l().trashIcon}),title:(0,C.jsx)(s().sA,{id:"automationBaseStepElement.moreActionsMenu.delete",defaultMessage:"Delete"})})}:void 0].filter(u().O9);return(0,C.jsx)(p().A,{...n,children:(0,C.jsx)(d().Ay,{type:d().Oh.Vertical,sections:[{items:a,key:"items",render:e=>(0,C.jsx)(g().A,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}},24e3:(e,t,o)=>{o.d(t,{A:()=>x});o(242343);var r=()=>o(237385),n=()=>o(303472),a=()=>o(465546),i=()=>o(34662),l=()=>o(653998),s=()=>o(76394),u=()=>o(822606),c=()=>o(906230),p=()=>o(907721),d=()=>o(413871),m=()=>o(535906),g=()=>o(709237),y=()=>o(103151),h=()=>o(164634),f=()=>o(320856),v=o(163643);function x(e){var t;const{isChecked:o=!1,disabled:x,menuArgs:S,parentRecordStore:b}=e,{isMobile:C}=(0,r().Y0)(),k=(0,f().U)();let A;if("annotation"in e){const{annotation:t,formulaTypecheckContextValues:o}=e,r=(0,i().iVq)(t).id;A=(0,s().O9)(o)?(0,a().IV)(o,r):void 0}else A=e.contextValue;const T=(null===(t=A)||void 0===t?void 0:t.associatedCollectionForDisplay)&&d().md.createChildStore(b,A.associatedCollectionForDisplay),M=A&&(0,a().Ix)(A.type),j=C?24:20;return A?(0,v.jsx)(y().A,{renderTooltip:()=>x?(0,v.jsx)(l().sA,{...h().O.maximumPeopleSelectedTooltip}):(0,a().E9)(A),placement:p().W.Right,render:e=>(0,v.jsx)(m().A,{isChecked:o,title:(0,v.jsx)("div",{style:{display:"flex"},children:A.name}),disabled:x,style:x?k.disabledMenuItem:void 0,icon:(0,s().O9)(A.stepNumberForDisplay)?(0,v.jsx)(u().Q,{number:A.stepNumberForDisplay,size:n().H.Medium}):M?M({width:j,height:j,padding:2}):void 0,caption:T&&(0,v.jsx)(l().sA,{defaultMessage:"to {database}",id:"automations.AutomationTargetPickerMenu.VariableMenuItem.databaseCaption",values:{database:(0,v.jsx)(g().A,{store:T,style:{display:"inline"}})}}),...(0,c().A)(S,e)})}):null}},43029:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkCircleFillIcon:()=>n,iconDefinition:()=>r});o(242343);const r={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M9.875 6.25c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5"})},n=(0,o(680369).wt)("exclamationMarkCircleFill",r)},60010:(e,t,o)=>{o.d(t,{F:()=>d});var r=o(242343),n=()=>o(174114),a=()=>o(418908),i=()=>o(653998),l=()=>o(907721),s=()=>o(356813),u=()=>o(103151),c=o(163643);const p=(0,i().YK)({simpleFormulaFormulaActionButtonAriaLabel:{id:"formulas.simpleFormulaFormulaActionButton.ariaLabel",defaultMessage:"Formulas"},simpleFormulaFormulaActionButtonFormulaTooltip:{id:"formulas.simpleFormulaFormulaActionButton.formula.tooltip",defaultMessage:"Edit as formula"},simpleFormulaFormulaActionButtonSimpleFormulaTooltip:{id:"formulas.simpleFormulaFormulaActionButton.simpleFormula.tooltip",defaultMessage:"Edit as text"}});function d(e){const{disabled:t,onClick:o,value:d}=e,m="formula"===(null==d?void 0:d.type),g=(0,i().tz)(),y=(0,n().IS)((e=>({formulaIcon:{fill:m?e.icon.uiBluePrimary:e.mediumIconColor,height:16,width:16},button:{height:20,width:20}})),[m]),h=(0,r.useCallback)((()=>m?g.formatMessage(p.simpleFormulaFormulaActionButtonSimpleFormulaTooltip):g.formatMessage(p.simpleFormulaFormulaActionButtonFormulaTooltip)),[g,m]),f=(0,r.useCallback)((e=>(0,c.jsx)(s().A,{...e,ariaLabel:g.formatMessage(p.simpleFormulaFormulaActionButtonAriaLabel),disabled:t,disabledFeedback:t,icon:a().n,iconStyle:y.formulaIcon,onClick:o,style:y.button})),[t,g,o,y]);return(0,c.jsx)(u().A,{renderTooltip:h,placement:l().W.Bottom,render:f})}},69766:(e,t,o)=>{o.d(t,{A:()=>Le});var r=o(242343),n=()=>o(803290),a=()=>o(76394),i=()=>o(886087),l=(o(725707),o(491955),o(500234),o(403517),o(113085),o.n(o(567012))),s=()=>o(237385),u=()=>o(174114),c=()=>o(911575),p=()=>o(564134),d=()=>o(916963),m=o(163643);const g={viewBox:"0 0 20 20",svg:(0,m.jsx)("path",{d:"m10.775 2.583 2.475 2.475a.625.625 0 0 1 0 .884l-2.475 2.475a.625.625 0 1 1-.884-.884l1.408-1.408H4.8c-.649 0-1.175.526-1.175 1.175v5.975a.625.625 0 1 1-1.25 0V7.3A2.425 2.425 0 0 1 4.8 4.875h6.499L9.891 3.467a.625.625 0 0 1 .884-.884M17 6.1c.345 0 .625.28.625.625V12.7a2.425 2.425 0 0 1-2.425 2.425H8.7l1.408 1.408a.625.625 0 1 1-.884.884L6.75 14.942a.625.625 0 0 1 0-.884l2.475-2.475a.625.625 0 1 1 .884.884l-1.408 1.408H15.2c.649 0 1.175-.526 1.175-1.175V6.725c0-.345.28-.625.625-.625"})},y=(0,o(680369).wt)("arrowSquareLeftRight",g);var h=()=>o(934889),f=()=>o(686752),v=()=>o(178063),x=()=>o(653998),S=()=>o(975392),b=()=>o(145046),C=()=>o(226567),k=()=>o(535906),A=()=>o(401382),T=()=>o(935091),M=()=>o(858023),j=()=>o(397791),P=()=>o(88271),_=()=>o(350208),I=()=>o(434498),w=()=>o(950808),V=()=>o(640979),R=()=>o(622286),N=()=>o(943066),B=()=>o(794772),F=()=>o(738355),E=()=>o(441911),O=()=>o(466207);const D=(0,x().YK)({searchInputPlaceholder:{id:"automationEventTriggerMenu.searchInputPlaceholder.label",defaultMessage:"Search triggers…"},pageAddedCopy:{id:"automationEventTriggerMenu.pageAdded.title",defaultMessage:"Page added"},pagePropertiesEditedCopy:{id:"automationEventTriggerMenu.anyPropertyEdited.title",defaultMessage:"Any property edited"},recurrenceCopy:{id:"automationEventTriggerMenu.recurrence.title",defaultMessage:"Every…"}});function W(e){const{automationTriggerMenuStore:t,onClose:o}=e,{automationStore:i,collectionStore:g}=(0,F().k)(),y=(0,u().DP)(),h=(0,x().tz)(),C=(0,O().p)(),_=(0,R().X)("collections_xws"),I=(0,r.useMemo)((()=>({...C,closeMenu:o})),[C,o]),[V,N]=r.useState(""),B=(0,n().K8)((()=>g.getSpaceId()),[g]),W=(0,n().K8)((()=>g.getSchema()),[g]),K=(0,n().K8)((()=>i.getTrigger()),[i]),z=(0,n().K8)((()=>"event"===(null==K?void 0:K.type)&&K.event.pagesAdded),[K]),Y=(0,n().K8)((()=>{if(_)return e=>{const t=e[1];return!(0,p().nC)(t)||!(0,p().o2)(B,t)}}),[_,B]),U=(0,n().K8)((()=>(0,c().nv)({collectionFormat:g.getFormat(),collectionSchema:W,filter:Y})),[g,W,Y]),$=(0,w().iX)({collectionSchema:W,propertyIds:U,searchTerm:V}),Q=(0,n().K8)((()=>"event"===(null==K?void 0:K.type)&&(z||"none"!==K.event.pagePropertiesEdited.type)),[K,z]),G=(0,u().IS)((e=>({propertyIcon:{width:16,height:16,color:e.mediumIconColor}})),[]),X=(0,E().e)({maxHeight:"50vh",width:266}),Z=(0,s().v3)(),{isMobile:J}=(0,s().Y0)(),ee=(0,m.jsx)(P().A,{isInput:!0,children:(0,m.jsx)(A().Ay,{focus:!J,value:V,onChange:e=>{N(e.target.value)},placeholder:h.formatMessage(D.searchInputPlaceholder)})}),te=(0,n().K8)((()=>function(e){const{environment:t,intl:o,searchInput:r,actions:n,hasPageAddedTrigger:a,hasAnyEventConditions:i,automationStore:s}=e,u=s.getTrigger(),c=o.formatMessage(D.pageAddedCopy),p=o.formatMessage(D.recurrenceCopy),d=o.formatMessage(D.pagePropertiesEditedCopy),{hasAnyPageEditedTrigger:g,specificPropertyChangedFilters:y}=H(u),h=S().oE([g||!l().test(r,d)?void 0:{key:"any_property_edited",action:async()=>{const e=await async function(e){const{hasSpecificPropertyChangedFilters:t}=e;if(!t)return!0;return await b().Gh({message:(0,m.jsx)(x().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.message",defaultMessage:"Replace other triggers?"}),description:(0,m.jsx)(x().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.description",defaultMessage:"Adding the 'Any property edited' trigger will replace all other property triggers."}),acceptLabel:(0,m.jsx)(x().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.acceptLabel",defaultMessage:"Replace"})}).then((e=>e.accept))}({hasSpecificPropertyChangedFilters:y.length>0});e&&(n.addAnyPropertyEditedTrigger(),n.closeMenu())},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(j().I,{icon:f().pencilLineIcon,color:"secondary"}),title:d})},!a&&l().test(r,c)?{key:"page_added",action(){n.addPageAddedTrigger(),n.closeMenu()},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(j().I,{icon:v().plusIcon,color:"secondary"}),title:c})}:void 0,!i&&l().test(r,p)?L({actions:n,environment:t,automationStore:s}):void 0]);return h.length>0?{key:"event_section",items:h,render:e=>(0,m.jsx)(P().A,{...e,title:(0,m.jsx)(x().sA,{id:"automationEventTriggerMenu.eventSection.title",defaultMessage:"Event"})})}:void 0}({environment:Z,intl:h,searchInput:V,actions:I,styles:G,hasPageAddedTrigger:z,hasAnyEventConditions:Q,automationStore:i})),[z,Q,h,I,V,G,Z,i]),oe=(0,R().X)("automation_relative_date_trigger"),re=(0,n().K8)((()=>function(e){const{automationTriggerValue:t,automationTriggerMenuStore:o,showTopBorder:r,properties:n,collectionSchema:i,theme:l,actions:s,isRelativeDateTriggerEnabled:u}=e,{specificPropertyChangedFilters:p}=H(t),g=n.map((e=>{if(!p.find((t=>t.property===e)))return function(e){const{automationTriggerMenuStore:t,propertyId:o,collectionSchema:r,theme:n,actions:a,isRelativeDateTriggerEnabled:i}=e,l=r[o];if(!l)return;const s=(0,c().nq)(l),u=i&&"date"===l.type;return{key:o,action:()=>{u||(s?t.pushSettingsItem({type:"propertyChangedFilter",property:o}):(a.addPropertyTrigger({property:o,filter:{operator:"changes_to_any"}}),a.closeMenu()))},render:(e,t)=>u?(0,m.jsx)(q,{menuListItemProps:e,propertySchema:l,propertyId:o,actions:a,parent:t}):(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(d().zB,{icon:l.icon,type:l.type,size:16,theme:n,style:{overflow:"visible"}}),title:l.name,showExtensionArrow:s})}}({propertyId:e,collectionSchema:i,theme:l,automationTriggerMenuStore:o,actions:s,isRelativeDateTriggerEnabled:u})})).filter(a().O9);if(0===g.length)return;return{key:"property_section",items:g,render:e=>(0,m.jsx)(P().A,{...e,topBorder:r,title:(0,m.jsx)(x().sA,{id:"automationEventTriggerMenu.pagePropertiesEditedSection.title",defaultMessage:"Property"})})}}({automationTriggerValue:K,automationTriggerMenuStore:t,showTopBorder:Boolean(te),properties:$,collectionSchema:W,theme:y,actions:I,isRelativeDateTriggerEnabled:oe})),[K,t,te,$,W,y,I,oe]),ne=r.useMemo((()=>{const e=[te,re].filter(a().O9);return 0===e.length?[{key:"none",items:[{key:"none-item",action:()=>{},render:e=>(0,m.jsx)(k().A,{...e,disabled:!0,disabledFeedback:!0,title:(0,m.jsx)(x().sA,{id:"automations.eventTriggerMenu.noResultsItem",defaultMessage:"No results"})})}],render:e=>(0,m.jsx)(P().A,{...e})}]:e}),[te,re]);return(0,m.jsx)(T().A,{...X,header:ee,children:(0,m.jsx)(M().Ay,{type:M().Oh.Vertical,sections:ne,initialFocus:0})})}function L(e){const{actions:t,environment:o,automationStore:r}=e,n=(0,B().V)({environment:o,automationStore:r,triggerType:"recurrence"});return{key:"recurrence",action(){n?t.addEmptyRecurrenceTrigger():N().K(o,{upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"},from:"recurrence_automation"}),t.closeMenu()},render:e=>(0,m.jsx)(K,{...e,automationStore:r})}}const K=r.forwardRef((function(e,t){var r;const{automationStore:a,...i}=e,l=(0,u().IS)((()=>({wrap:{display:"flex",alignItems:"center"},upsellWrap:{marginLeft:6}})),[]),c=(0,s().v3)(),p=(0,n().K8)((()=>(0,B().V)({triggerType:"recurrence",automationStore:a,environment:c})),[a,c]),{spaceId:d,userId:g}=(0,n().K8)((()=>{var e;return{spaceId:a.getSpaceId(),userId:null===(e=o(485966).default.state.currentUserStore)||void 0===e?void 0:e.id}}),[a]),h=null===(r=(0,o(133926)._X)({name:"premium_automations",spaceId:d,userId:g}))||void 0===r?void 0:r.upsell;return(0,m.jsx)(k().A,{...i,ref:t,icon:(0,m.jsx)(j().I,{icon:y,color:"secondary"}),title:(0,m.jsxs)("div",{style:l.wrap,children:[(0,m.jsx)(x().sA,{...D.recurrenceCopy}),p?(0,m.jsx)(o(793613).E,{newBadgeKey:"generalized_recurrence_automations",didUserEngage:!1,keyType:"date"}):h?(0,m.jsx)("div",{style:l.upsellWrap,children:(0,m.jsx)(o(24281).B,{upsell:h,analyticsName:"recurrence_automation"})}):null]})})}));function H(e){let t=!1,o=[];return"event"===(null==e?void 0:e.type)&&(t="any"===e.event.pagePropertiesEdited.type,t||("some"===e.event.pagePropertiesEdited.type?o=e.event.pagePropertiesEdited.some||[]:"all"===e.event.pagePropertiesEdited.type&&(o=e.event.pagePropertiesEdited.all||[]))),{hasAnyPageEditedTrigger:t,specificPropertyChangedFilters:o}}function q(e){const{propertyId:t,propertySchema:o,menuListItemProps:r,actions:n,parent:a}=e,i=(0,u().DP)();return(0,m.jsx)(_().A,{...r,onFocus:a.onFocus,alignmentToOrigin:I().C1.Start,renderOrigin:(e,t)=>(0,m.jsx)(k().A,{...e,ref:t,icon:(0,m.jsx)(d().zB,{icon:o.icon,type:o.type,size:16,theme:i,style:{overflow:"visible"}}),title:o.name}),renderExtension:(e,o)=>(0,m.jsx)(T().A,{...e,menuType:V().gu.Popup,children:(0,m.jsx)(M().Ay,{initialFocus:0,type:M().Oh.Vertical,sections:[{key:"section",render:e=>(0,m.jsx)(P().A,{...e}),items:[{key:"occurs",action:()=>{n.addRelativeDateTrigger({propertyId:t}),n.closeMenu()},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(j().I,{icon:h().clockIcon,color:"secondary"}),title:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:["Occurs"," ",(0,m.jsx)(C().A,{})]})})},{key:"is_edited",action:()=>{n.addPropertyTrigger({property:t,filter:{operator:"changes_to_any"}}),n.closeMenu()},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(j().I,{icon:f().pencilLineIcon,color:"secondary"}),title:"Is edited"})}]}]})})})}var z=()=>o(15552),Y=()=>o(180986);function U(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:a,propertyChangedFilter:i,onClose:l}=e,{updatePropertyTrigger:s}=(0,O().p)(),u=(0,n().K8)((()=>"changes_to_any"===i.operator?[{type:"exact",value:!0},{type:"exact",value:!1}]:(0,z().Ui)(i)&&(0,z().gc)(i)?Array.isArray(i.value)?i.value:[i.value]:[]),[i]),[c,p]=(0,r.useState)(u),d=(0,r.useMemo)((()=>1===c.length?{operator:"checkbox_is",value:c[0]}:{operator:"changes_to_any"}),[c]),g=(0,r.useMemo)((()=>2===c.length||1===c.length&&"partial"),[c]),y=(0,r.useCallback)((e=>{const t=Boolean(c.find((t=>t.value===e)));p(t?c.filter((t=>t.value!==e)):[...c,{type:"exact",value:e}])}),[c]),h=(0,r.useCallback)((()=>{s({anyOptionCheckState:g,propertyId:t,currentFilter:d}),l()}),[g,d,l,t,s]),f=Boolean(c.find((e=>!0===e.value))),v=Boolean(c.find((e=>!1===e.value)));return(0,m.jsx)(Y().A,{type:"default",automationTriggerActionMenuStore:o,onDone:h,onClose:l,sections:[{key:"select",render:e=>(0,m.jsx)(P().A,{...e,topBorder:!0}),items:[{key:"unchecked",render:e=>(0,m.jsx)(k().A,{...e,isChecked:v,isTokenTitle:!0,title:(0,m.jsx)(x().sA,{defaultMessage:"Unchecked",id:"automations.propertyTrigger.checkbox.unchecked"})}),action:()=>y(!1)},{key:"checked",render:e=>(0,m.jsx)(k().A,{...e,isChecked:f,isTokenTitle:!0,title:(0,m.jsx)(x().sA,{defaultMessage:"Checked",id:"automations.propertyTrigger.checkbox.checked"})}),action:()=>y(!0)}]}],headerTitle:(0,m.jsx)(x().sA,{id:"automations.propertyTrigger.checkbox.title",defaultMessage:"{propertyName} set to",values:{propertyName:a.name}})})}var $=()=>o(644518),Q=()=>o(716605),G=()=>o(31448),X=()=>o(103151),Z=()=>o(536992),J=()=>o(575460);function ee(e){let{handleSelectOperator:t,selectedItem:o}=e;const r=(0,s().Y0)(),n=(0,u().IS)((e=>({buttonStyle:{fontSize:r.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,textTransform:"lowercase",color:r.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[r.isMobile]);return(0,m.jsx)(J().A,{style:{height:20},innerButtonStyle:n.buttonStyle,selectedTitle:(0,m.jsx)(x().sA,{...o.text}),renderMenuSections:e=>[{key:"selectNumberOperator",render:e=>(0,m.jsx)(P().A,{...e}),items:Object.values(Z().$R).map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,m.jsx)(k().A,{...e,title:(0,m.jsx)(x().sA,{...o.text})})})))}]})}var te=()=>o(234887),oe=()=>o(907721),re=()=>o(271142);function ne(e){let{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:i,propertySchema:l,propertyId:s,shouldUseDefaultPropertyOperator:c}=e;const p=(0,r.useMemo)((()=>{if(c)return"number"===l.type?"number_equals":"changes_to_any"}),[l.type,c]),d=(0,n().K8)((()=>{if("changes_to_any"!==i.operator&&(0,z().My)(i)&&"is_empty"!==i.operator)return(0,z().gc)(i)?i.value.value:void 0}),[i]),[g,y]=(0,r.useState)((0,Z().Qy)(p||i.operator)),[h,f]=(0,r.useState)(d),v=(0,r.useMemo)((()=>{if((0,a().O9)(h))return{type:"simple",value:(0,Q().hk)(h)}}),[h]),{updatePropertyTrigger:x}=(0,O().p)(),{typecheckResult:S,automationStore:b}=(0,re().EC)(),C=(0,r.useMemo)((()=>(0,$().getAllContextValues)(S)),[S]),k=(0,r.useCallback)((e=>{const t=(0,Q().Me)(null==e?void 0:e.value);f(t)}),[]),A=(0,r.useCallback)((e=>{y(e.value),Z().$R[e.value].hasInput||f(void 0)}),[]),T=(0,r.useCallback)((()=>{const e=(0,a().O9)(h)?{operator:g,value:{type:"exact",value:h}}:{operator:"is_empty"};let t="partial";"changes_to_any"===g?t=!0:"is_empty"===g&&(t=!1),x({anyOptionCheckState:t,propertyId:s,currentFilter:e,propertySchema:l}),o()}),[g,h,o,s,l,x]),M=Z().$R[g],j=(0,u().IS)((e=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"4px",alignItems:"center"},propertyName:{...G().RC}})),[]),{headerDiv:_}=(0,te().A)({currentSimpleFormulaValueTokens:[],formulaTypecheckContextValues:C,onChange:k,onClose:T,value:v,parentRecordStore:b});return(0,m.jsx)(Y().A,{type:"custom",automationTriggerActionMenuStore:t,onDone:T,onClose:o,headerTitle:(0,m.jsxs)("div",{style:j.header,children:[(0,m.jsx)(X().A,{placement:oe().W.Bottom,render:e=>(0,m.jsx)("div",{...e,style:j.propertyName,children:l.name}),renderTooltip:()=>l.name}),(0,m.jsx)(ee,{selectedItem:M,handleSelectOperator:A})]}),subHeaderComponent:M.hasInput&&(0,m.jsx)(P().A,{children:_}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}var ae=()=>o(630714),ie=()=>o(559637);const le=["person_contains","person_does_not_contain","is_empty","changes_to_any"];const se=(0,x().YK)({changesToAny:{id:"automations.propertyTrigger.personField.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"automations.propertyTrigger.personField.isEmpty",defaultMessage:"Is cleared"},personContains:{id:"automations.propertyTrigger.personField.personContainsOption",defaultMessage:"Contains"},personDoesNotContain:{id:"automations.propertyTrigger.personField.personDoesNotContainOption",defaultMessage:"Does not contain"}}),ue={person_contains:{hasInput:!0,text:se.personContains,labelText:se.personContains,value:"person_contains"},person_does_not_contain:{hasInput:!0,labelText:se.personDoesNotContain,text:se.personDoesNotContain,value:"person_does_not_contain"},changes_to_any:{hasInput:!1,text:se.changesToAny,labelText:se.changesToAny,value:"changes_to_any"},is_empty:{hasInput:!1,labelText:se.isEmpty,text:se.isEmpty,value:"is_empty"}};function ce(e){let{handleSelectOperator:t,selectedItem:o}=e;const r=(0,s().Y0)(),n=(0,u().IS)((e=>({buttonStyle:{fontSize:r.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,textTransform:"lowercase",color:r.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[r.isMobile]);return(0,m.jsx)(J().A,{style:{height:20},innerButtonStyle:n.buttonStyle,selectedTitle:(0,m.jsx)(x().sA,{...o.text}),renderMenuSections:e=>[{key:"selectPersonOperator",render:e=>(0,m.jsx)(P().A,{...e}),items:Object.values(ue).map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,m.jsx)(k().A,{...e,title:(0,m.jsx)(x().sA,{...o.text})})})))}]})}var pe=()=>o(560015),de=()=>o(187406),me=()=>o(153642);function ge(e){var t,o;let{automationTriggerMenuStore:i,collectionStore:l,onClose:c,propertyChangedFilter:p,propertySchema:d,propertyId:g,shouldUseDefaultPropertyOperator:y}=e;const h=(0,r.useMemo)((()=>{if(y&&"person"===d.type)return"person_contains"}),[d.type,y]),f=(0,n().K8)((()=>{if("changes_to_any"!==p.operator)return(0,z().I_)(p)&&"is_empty"!==p.operator&&(0,z().gc)(p)?(0,z().Wf)(p):[]}),[p]),[v,S]=(0,r.useState)((()=>{if(f){const e=f.map((e=>{if("exact"===e.type)return e.value})).filter(a().O9);return{action:"replace",value:{type:"simple",value:(0,Q().AH)(e)}}}})),[b,C]=(0,r.useState)(function(e){const t=e;return le.includes(t)?t:"person_contains"}(h||p.operator)),A=(0,s().Y0)(),T=(0,me().V)()??0,M=(0,de().r)()??0,j=(0,r.useMemo)((()=>T+M),[T,M]),_=(0,r.useRef)(),I=(0,r.useRef)(),[w,V]=(0,r.useState)(!f),R=(0,r.useMemo)((()=>{var e;return(0,ae().fromSimpleFormulaArrayValue)(null==v||null===(e=v.value)||void 0===e?void 0:e.value)}),[null==v||null===(t=v.value)||void 0===t?void 0:t.value]),N=(0,n().K8)((()=>{var e;return function(e){const{formulaValue:t,allChecked:o,numTotalActors:r}=e;if(t&&t.length>0){return(0,ae().fromSimpleFormulaArrayValue)(t).length===r||"partial"}if(o)return!0;return!1}({propertySchema:d,formulaValue:null==v||null===(e=v.value)||void 0===e?void 0:e.value,allChecked:w,numTotalActors:j})}),[d,null==v||null===(o=v.value)||void 0===o?void 0:o.value,w,j]),{typecheckResult:B,automationStore:F}=(0,re().EC)(),E=(0,r.useMemo)((()=>({collectionStore:l,property:g,type:"collection"})),[l,g]),D=(0,r.useMemo)((()=>(0,$().getAllContextValues)(B)),[B]),{updatePropertyTrigger:W}=(0,O().p)(),L=(0,r.useCallback)((()=>{const e=_.current||(null==v?void 0:v.value),t=I.current||b,o=e?(0,Q().e5)({textValue:null==e?void 0:e.value,propertySchema:d,blockCreatorPointer:void 0}):void 0,r=o&&0!==o.length?{operator:t,value:o.map((e=>({type:"exact",value:e})))}:{operator:"person_contains"===t&&w?"changes_to_any":"is_empty"};let n="partial";"changes_to_any"===t?n=!0:"is_empty"===t&&(n=!1),W({anyOptionCheckState:n,propertyId:g,currentFilter:r,propertySchema:d}),c()}),[null==v?void 0:v.value,b,d,w,W,g,c]),K=(0,r.useCallback)((e=>{_.current=e,S({action:"replace",value:e}),1===d.limit&&L()}),[L,d.limit]),H=(0,r.useCallback)((()=>{N?(V(!1),R.length>0&&K(void 0)):V(!0)}),[N,R.length,K]),q=(0,r.useCallback)((e=>{I.current=e.value,C(e.value),ue[e.value].hasInput||K(void 0)}),[K]),U=ue[b],Z=(0,u().IS)((e=>({header:{display:"flex",gap:"4px",alignItems:"center",overflow:"hidden"},propertyName:{...G().RC}})),[]),J=U.hasInput,ee=!w||R.length>0,{headerDiv:te,innerComponents:ne}=(0,pe().A)({currentSimpleFormulaValueTokens:R,formulaTypecheckContextValues:D,formulaValueContext:E,isDisabled:!ee,limit:void 0,onChange:K,onClose:c,showClearButton:!0,showGenericHeader:!1,showInputMenuItem:!0,value:null==v?void 0:v.value,parentRecordStore:F});if(!E)return null;const se=[U.hasInput?{key:"any",items:[{key:"any-option-item",action:H,render:e=>(0,m.jsxs)(m.Fragment,{children:[te,(0,m.jsx)(k().A,{onClick:H,focused:!0,icon:(0,m.jsx)(ie().A,{checked:N,size:14,onClick:H}),title:(0,m.jsx)(x().sA,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})]})}],render:e=>(0,m.jsx)(P().A,{...e,topBorder:!1})}:void 0,J?{key:"inner-components",items:[{key:"inner-components-item",action:H,render:e=>ne}],render:e=>A.isMobile?ne:(0,m.jsx)(P().A,{...e,topBorder:!0})}:void 0].filter(a().O9);return(0,m.jsx)(Y().A,{type:"default",automationTriggerActionMenuStore:i,onDone:L,onClose:c,headerTitle:(0,m.jsxs)("div",{style:Z.header,children:[(0,m.jsx)(X().A,{placement:oe().W.Bottom,render:e=>(0,m.jsx)("div",{...e,style:Z.propertyName,children:d.name}),renderTooltip:()=>d.name}),(0,m.jsx)(ce,{selectedItem:U,handleSelectOperator:q})]}),sections:se,customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}var ye=()=>o(293665),he=()=>o(145017);const fe=["relation_contains","relation_does_not_contain","is_empty","changes_to_any"];const ve=(0,x().YK)({changesToAny:{id:"automations.propertyTrigger.relationOperator.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"automations.propertyTrigger.relationOperator.isEmpty",defaultMessage:"Is cleared"},relationContains:{id:"automations.propertyTrigger.relationOperator.relationContainsOption",defaultMessage:"Contains"},relationDoesNotContain:{id:"automations.propertyTrigger.relationOperator.relationDoesNotContain",defaultMessage:"Does not contain"}}),xe={relation_contains:{hasInput:!0,labelText:ve.relationContains,text:ve.relationContains,value:"relation_contains"},relation_does_not_contain:{hasInput:!0,labelText:ve.relationDoesNotContain,text:ve.relationDoesNotContain,value:"relation_does_not_contain"},changes_to_any:{hasInput:!1,text:ve.changesToAny,labelText:ve.changesToAny,value:"changes_to_any"},is_empty:{text:ve.isEmpty,labelText:ve.isEmpty,value:"is_empty",hasInput:!1}};function Se(e){let{handleSelectOperator:t,selectedItem:o}=e;const r=(0,s().Y0)(),n=(0,u().IS)((e=>({buttonStyle:{fontSize:r.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,textTransform:"lowercase",color:r.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[r.isMobile]);return(0,m.jsx)(J().A,{style:{height:20},innerButtonStyle:n.buttonStyle,selectedTitle:(0,m.jsx)(x().sA,{...o.text}),renderMenuSections:e=>[{key:"selectRelationOperator",render:e=>(0,m.jsx)(P().A,{...e}),items:Object.values(xe).map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,m.jsx)(k().A,{...e,title:(0,m.jsx)(x().sA,{...o.text})})})))}]})}var be=()=>o(353313);function Ce(e){var t;let{automationTriggerMenuStore:o,collectionStore:i,onClose:l,propertyChangedFilter:s,propertySchema:c,propertyId:p,shouldUseDefaultPropertyOperator:d}=e;const g=(0,r.useMemo)((()=>{if(d)return"relation"===c.type?"relation_contains":"changes_to_any"}),[c.type,d]),y=(0,n().K8)((()=>"changes_to_any"===s.operator?[]:(0,z().Pq)(s)&&"is_empty"!==s.operator&&(0,z().gc)(s)?(0,z().Rh)(s):[]),[s]),h=(0,n().K8)((()=>{if(i&&c)return(0,ae().setPropertyValueToSimpleFormulaReturnType)(i.getSpaceShardedPointer(),p,c)}),[i,c,p]),f=(0,n().K8)((()=>i.getSpaceId()),[i]),[v,x]=(0,r.useState)(function(e){const t=e;return fe.includes(t)?t:"relation_contains"}(g||s.operator)),[S,b]=(0,r.useState)((()=>{const e=y.map((e=>{if(e.value&&"string"==typeof e.value)return ye().L3.fromSpaceShardRecordId({id:e.value,spaceId:f},he().ev)})).filter(a().O9);return{action:"replace",value:{type:"simple",value:(0,Q().Ap)(e)}}})),C=(0,r.useMemo)((()=>{var e;return(0,ae().fromSimpleFormulaArrayValue)(null==S||null===(e=S.value)||void 0===e?void 0:e.value)}),[null==S||null===(t=S.value)||void 0===t?void 0:t.value]),k=(0,r.useRef)(),{updatePropertyTrigger:A}=(0,O().p)(),{typecheckResult:T,automationStore:M}=(0,re().EC)(),j=(0,r.useMemo)((()=>({collectionStore:i,property:p,type:"collection"})),[i,p]),_=(0,r.useMemo)((()=>(0,$().getAllContextValues)(T)),[T]),I=(0,r.useCallback)((e=>{x(e.value),xe[e.value].hasInput||b(void 0)}),[]),w=xe[v],V=(0,r.useCallback)((()=>{const e=k.current||(null==S?void 0:S.value),t=(0,a().O9)(null==e?void 0:e.value)?(0,Q().n)(null==e?void 0:e.value):void 0,o=t&&0!==t.length?{operator:w.value,value:t.map((e=>({type:"exact",value:e.id})))}:{operator:"is_empty"};A({anyOptionCheckState:"changes_to_any"===w.value,currentFilter:o,propertyId:p,propertySchema:c}),l()}),[null==S?void 0:S.value,l,p,c,w.value,A]),R=(0,r.useCallback)((e=>{k.current=e,b({action:"replace",value:e}),1===c.limit&&V()}),[V,c.limit]),N=(0,u().IS)((e=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"2px",alignItems:"center"},propertyName:{...G().RC}})),[]),{headerDiv:B,innerComponents:F}=(0,be().A)({currentSimpleFormulaValueTokens:C,formulaTypecheckContextValues:_,formulaValueContext:j,onChange:R,onClose:l,showClearButton:!0,showInputMenuItem:!0,collection:"block_array"===(null==h?void 0:h.type)?h.collection:void 0,value:null==S?void 0:S.value,parentRecordStore:M});return(0,m.jsx)(Y().A,{type:"custom",automationTriggerActionMenuStore:o,onDone:V,onClose:l,headerTitle:(0,m.jsxs)("div",{style:N.header,children:[(0,m.jsx)(X().A,{placement:oe().W.Bottom,render:e=>(0,m.jsx)("div",{...e,style:N.propertyName,children:c.name}),renderTooltip:()=>c.name}),(0,m.jsx)(Se,{selectedItem:w,handleSelectOperator:I})]}),subHeaderComponent:w.hasInput&&(0,m.jsx)(P().A,{children:B}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}},children:w.hasInput&&F})}var ke=()=>o(752903),Ae=()=>o(505521);const Te=["enum_contains","enum_does_not_contain","enum_is","enum_is_not","is_empty","changes_to_any"];const Me=(0,x().YK)({changesToAny:{id:"automations.propertyTrigger.selectOperator.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"automations.propertyTrigger.selectOperator.isEmpty",defaultMessage:"Is cleared"},enumContains:{id:"automations.propertyTrigger.selectOperator.enumContainsOption",defaultMessage:"Contains"},enumDoesNotContain:{id:"automations.propertyTrigger.selectOperator.enumDoesNotContain",defaultMessage:"Does not contain"},enumIs:{id:"automations.propertyTrigger.selectOperator.enumIs",defaultMessage:"Is"},enumIsNot:{id:"automations.propertyTrigger.selectOperator.enumIsNot",defaultMessage:"Is not"}}),je={enum_contains:{hasInput:!0,isMulti:!0,isSingle:!1,labelText:Me.enumContains,text:Me.enumContains,value:"enum_contains"},enum_does_not_contain:{hasInput:!0,isMulti:!0,isSingle:!1,labelText:Me.enumDoesNotContain,text:Me.enumDoesNotContain,value:"enum_does_not_contain"},enum_is:{hasInput:!0,isMulti:!1,isSingle:!0,labelText:Me.enumIs,text:Me.enumIs,value:"enum_is"},enum_is_not:{hasInput:!0,isMulti:!1,isSingle:!0,labelText:Me.enumIsNot,text:Me.enumIsNot,value:"enum_is_not"},changes_to_any:{hasInput:!1,isMulti:!0,isSingle:!0,labelText:Me.changesToAny,text:Me.changesToAny,value:"changes_to_any"},is_empty:{hasInput:!1,isMulti:!0,isSingle:!0,labelText:Me.isEmpty,text:Me.isEmpty,value:"is_empty"}};function Pe(e){let{handleSelectOperator:t,selectedItem:o,type:n}=e;const a=(0,s().Y0)(),i=(0,u().IS)((e=>({buttonStyle:{fontSize:a.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,textTransform:"lowercase",color:a.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[a.isMobile]),l=(0,r.useMemo)((()=>{const e="multi_select"===n,t="select"===n;return Object.values(je).filter((o=>e?o.isMulti:t?o.isSingle:void 0))}),[n]);return(0,m.jsx)(J().A,{style:{height:20},innerButtonStyle:i.buttonStyle,selectedTitle:(0,m.jsx)(x().sA,{...o.text}),renderMenuSections:e=>[{key:"selectSelectOperator",render:e=>(0,m.jsx)(P().A,{...e}),items:l.map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,m.jsx)(k().A,{...e,title:(0,m.jsx)(x().sA,{...o.text})})})))}]})}var _e=()=>o(837809),Ie=()=>o(797715);function we(e){const{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:i,propertyId:l,propertySchema:c,shouldUseDefaultPropertyOperator:p}=e,{isMobile:d,isAndroid:g}=(0,s().Y0)(),y=(0,x().tz)(),{updatePropertyTrigger:h}=(0,O().p)(),f=(0,r.useMemo)((()=>{if(p)return"select"===c.type?"enum_is":"multi_select"===c.type?"enum_contains":"changes_to_any"}),[c.type,p]),v=(0,n().K8)((()=>{if("changes_to_any"===i.operator){return(c.options??[]).map((e=>({type:"exact",value:e.value})))}if(!(0,z().v0)(i)&&!(0,z().as)(i))return[];if((0,z().gc)(i)){const e=(c.options??[]).map((e=>e.value));return(Array.isArray(i.value)?i.value:[i.value]).filter((t=>(0,a().O9)(t.value)&&e.includes(t.value)))}return[]}),[c,i]),[b,C]=r.useState(v),[A,T]=(0,r.useState)(function(e){const t=e;return Te.includes(t)?t:"enum_contains"}(f||i.operator)),M=(0,r.useCallback)((e=>{T(e.value)}),[]),j=je[A],_=(0,n().K8)((()=>function(e){const{propertySchema:t,selectedOptions:o}=e;let r=!1,n=!0;const a=t.options??[];for(const i of a){const e=o.some((e=>e.value===i.value));r||=e,n&&=e}return!!n||!!r&&"partial"}({propertySchema:c,selectedOptions:b})),[c,b]),I=r.useMemo((()=>(c.options??[]).map((e=>({type:"exact",value:e.value})))),[c]),w=!0===_?[]:b.map((e=>{if(!e.value||!c.options)return;const t=(0,Q().jy)(c.options,e.value);return t?(0,m.jsx)(_e().O,{format:d?ke().NY.Large:ke().NY.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{const t=S().FF(b,e);C(t)}},t.id):void 0})),[V,R]=r.useState(""),N=(0,Ae().r9)({query:V,propertySchema:c,selectedValues:b,updateValue:e=>{R(""),C(e)},isMobile:d,styles:{},isFormEditorView:!1}),B=(0,u().IS)((e=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"2px",alignItems:"center"},propertyName:{...G().RC}})),[]),F=(0,r.useCallback)((()=>{let e,t="partial";if("changes_to_any"===A)t=!0,e={operator:A};else if("is_empty"===A)t=!1,e={operator:A};else{const o=Array.isArray(b)?b:[b];0===o.length?(t=!1,e={operator:"is_empty"}):e={operator:A,value:o}}h({anyOptionCheckState:t,propertyId:l,currentFilter:e,propertySchema:c}),o()}),[o,l,c,A,b,h]),E=[{key:"search",items:[{key:"input",action:()=>{},render:e=>(0,m.jsx)("div",{style:{...!d&&{paddingTop:0,paddingRight:8,paddingBottom:4,paddingLeft:8}},children:(0,m.jsx)(Ie().Ay,{...e,focusInitial:!0,onClick:void 0,focusAfterAnimation:!0,format:Ie().le.FilterValue,tokens:w,placeholder:_?y.formatMessage({defaultMessage:"Any option",id:"automations.selectPropertyChangedFilter.inputPlaceholder.anyOption"}):y.formatMessage({defaultMessage:"Select one or more options…",id:"automations.selectPropertyChangedFilter.inputPlaceholder.searchPlaceholder"}),onRemoveLastToken:()=>{const e=b.slice(0,b.length-1);C(e)},onClearButtonClick:()=>{C([])},value:V,onChange:e=>{R(e.target.value)},dontShowBorderBottom:g,showClearButton:!0})})}],render:e=>(0,m.jsx)(P().A,{...e})},{key:"any",items:[{key:"any-option-item",action:()=>{!0===_?C([]):!1===_||"partial"===_?C(I):(0,a().HB)(_),R("")},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(ie().A,{checked:_,size:14,onClick:e.onClick}),title:(0,m.jsx)(x().sA,{id:"automations.selectPropertyChangedFilter.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,m.jsx)(P().A,{...e,topBorder:!0})},N.length>0?{key:"items",items:N,render:e=>(0,m.jsx)(P().A,{...e,topBorder:!0})}:void 0].filter(a().O9);return(0,m.jsx)(Y().A,{type:"default",automationTriggerActionMenuStore:t,onDone:F,onClose:o,sections:j.hasInput?E:[],headerTitle:(0,m.jsxs)("div",{style:B.header,children:[(0,m.jsx)(X().A,{placement:oe().W.Bottom,render:e=>(0,m.jsx)("div",{...e,style:B.propertyName,children:c.name}),renderTooltip:()=>c.name}),(0,m.jsx)(Pe,{handleSelectOperator:M,selectedItem:j,type:c.type})]}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}o(107652);var Ve=()=>o(158923),Re=()=>o(128057);function Ne(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:i,propertyChangedFilter:l,onClose:u}=e,{isMobile:c}=(0,s().Y0)(),{updatePropertyTrigger:p}=(0,O().p)(),d=(0,n().K8)((()=>{if("changes_to_any"===l.operator){return(i.groups??[]).map((e=>({type:"is_group",value:e.name})))}return(0,z().H$)(l)&&(0,z().gc)(l)?(0,z().V6)(l):[]}),[i,l]),[g,y]=r.useState(d),h=(0,n().K8)((()=>function(e){const{propertySchema:t,selectedStatusOptions:o}=e,r=t.groups??[],n=t.options??[],a=r.map((e=>(0,Re().Ze)({group:e,options:n,filterValues:o}))),i=a.every((e=>!0===e.groupCheckState)),l=a.some((e=>!1!==e.groupCheckState));return!!i||!!l&&"partial"}({propertySchema:i,selectedStatusOptions:g})),[i,g]),f=r.useMemo((()=>(i.groups??[]).map((e=>({type:"is_group",value:e.name})))),[i]),v=(0,Ve().T)({propertySchema:i,statusFilterValues:g,updateValue:e=>{y(e)},isMobile:c,styles:{},visibleOptions:i.options??[]}),S=(0,r.useCallback)((()=>{const e=0===g.length?{operator:"is_empty"}:{operator:"status_is",value:g};p({anyOptionCheckState:h,propertyId:t,currentFilter:e,propertySchema:i}),u()}),[h,u,t,i,g,p]);return(0,m.jsx)(Y().A,{type:"default",automationTriggerActionMenuStore:o,onDone:S,onClose:()=>{u()},sections:[{key:"any",items:[{key:"any-option-item",action:()=>{!0===h?y([]):!1===h||"partial"===h?y(f):(0,a().HB)(h)},render:e=>(0,m.jsx)(k().A,{...e,icon:(0,m.jsx)(ie().A,{checked:h,size:14,onClick:e.onClick}),title:(0,m.jsx)(x().sA,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,m.jsx)(P().A,{...e})},{key:"items",items:v,render:e=>(0,m.jsx)(P().A,{...e,topBorder:!0})}],headerTitle:(0,m.jsx)(x().sA,{id:"automations.propertyChangedFilterHeader.status.title",defaultMessage:"{propertyName} set to",values:{propertyName:i.name}}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}var Be=()=>o(34662),Fe=()=>o(258146);function Ee(e){let{handleSelectOperator:t,selectedItem:o}=e;const r=(0,s().Y0)(),n=(0,u().IS)((e=>({buttonStyle:{fontSize:r.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,textTransform:"lowercase",color:r.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[r.isMobile]);return(0,m.jsx)(J().A,{style:{height:20},innerButtonStyle:n.buttonStyle,selectedTitle:(0,m.jsx)(x().sA,{...o.text}),renderMenuSections:e=>[{key:"selectTextOperator",render:e=>(0,m.jsx)(P().A,{...e}),items:Object.values(Fe().bK).map((o=>({key:o.value,action:()=>{t(o),e.close()},render:e=>(0,m.jsx)(k().A,{...e,title:(0,m.jsx)(x().sA,{...o.text})})})))}]})}var Oe=()=>o(736708);function De(e){let{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:i,propertySchema:l,propertyId:s,shouldUseDefaultPropertyOperator:c}=e;const p=(0,r.useMemo)((()=>{if(c)return(0,Q().DY)(l.type)?"string_is":"changes_to_any"}),[l.type,c]),d=(0,n().K8)((()=>{if("changes_to_any"!==i.operator&&(0,z().YH)(i)&&"is_empty"!==i.operator)return(0,z().gc)(i)?i.value.value:void 0}),[i]),[g,y]=(0,r.useState)((()=>(0,Fe().mK)(p||i.operator))),[h,f]=(0,r.useState)(d),v=(0,r.useMemo)((()=>{if(h)return{type:"simple",value:Be().x9d(h)}}),[h]),{updatePropertyTrigger:x}=(0,O().p)(),{typecheckResult:S,automationStore:b}=(0,re().EC)(),C=(0,r.useMemo)((()=>(0,$().getAllContextValues)(S)),[S]),k=(0,r.useCallback)((e=>{const t=Be().k4p(null==e?void 0:e.value);f(t.trim()?t:void 0)}),[]),A=(0,r.useCallback)((e=>{y(e.value),Fe().bK[e.value].hasInput||f(void 0)}),[]),T=(0,r.useCallback)((()=>{const e=(0,a().O9)(h)?{operator:g,value:{type:"exact",value:h}}:{operator:"is_empty"};let t="partial";"changes_to_any"===g?t=!0:"is_empty"===g&&(t=!1),x({anyOptionCheckState:t,propertyId:s,currentFilter:e,propertySchema:l}),o()}),[g,h,o,s,l,x]),M=Fe().bK[g],j=(0,u().IS)((e=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"2px",alignItems:"center"},propertyName:{...G().RC}})),[]),{headerDiv:_}=(0,Oe().A)({currentSimpleFormulaValueTokens:[],disableEmojiCommands:!0,disableFormulas:!0,disableFormattingAndMentions:!0,disableMobileActionBar:!0,disableTemplateVariableMentions:!0,formulaTypecheckContextValues:C,onChange:k,onClose:T,value:v,parentRecordStore:b});return(0,m.jsx)(Y().A,{type:"custom",automationTriggerActionMenuStore:t,onDone:T,onClose:o,headerTitle:(0,m.jsxs)("div",{style:j.header,children:[(0,m.jsx)(X().A,{placement:oe().W.Bottom,render:e=>(0,m.jsx)("div",{...e,style:j.propertyName,children:l.name}),renderTooltip:()=>l.name}),(0,m.jsx)(Ee,{selectedItem:M,handleSelectOperator:A})]}),subHeaderComponent:M.hasInput&&(0,m.jsx)(P().A,{children:_}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}function We(e){const{propertyId:t,automationTriggerMenuStore:o,onClose:r}=e,{automationStore:i,collectionStore:l}=(0,F().k)(),s=(0,n().K8)((()=>l.getSchema()),[l])[t],u=(0,n().K8)((()=>i.getTrigger()),[i]);let p=[];"event"===(null==u?void 0:u.type)&&("some"===u.event.pagePropertiesEdited.type?p=u.event.pagePropertiesEdited.some||[]:"all"===u.event.pagePropertiesEdited.type&&(p=u.event.pagePropertiesEdited.all||[]));const d=p.find((e=>e.property===t)),g=d??{property:t,filter:{operator:"changes_to_any"}};if(!s)return null;if(!(0,c().nq)(s))return null;const y=!(0,a().O9)(d);return"multi_select"===s.type||"select"===s.type?(0,m.jsx)(we,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:y}):"status"===s.type?(0,m.jsx)(Ne,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:g.filter,onClose:r}):"checkbox"===s.type?(0,m.jsx)(U,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s}):"person"===s.type?(0,m.jsx)(ge,{automationTriggerMenuStore:o,collectionStore:l,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:y}):"number"===s.type?(0,m.jsx)(ne,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:y}):"email"===s.type||"phone_number"===s.type||"text"===s.type||"title"===s.type||"url"===s.type?(0,m.jsx)(De,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:y}):"relation"===s.type?(0,m.jsx)(Ce,{automationTriggerMenuStore:o,collectionStore:l,onClose:r,propertyChangedFilter:g.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:y}):null}function Le(e){const{initialState:t,buttonPopupParent:o}=e,l=(0,n().K8)((()=>{const e=new(i().AK);return e.setState({insertionPoint:void 0,stack:[t]}),e}),[t]),s=(0,n().K8)((()=>l.getCurrentTab()),[l]),u=(0,r.useCallback)((()=>o.close()),[o]);return s?"eventTriggers"===s.type?(0,m.jsx)(W,{automationTriggerMenuStore:l,onClose:u}):"propertyChangedFilter"===s.type?(0,m.jsx)(We,{propertyId:s.property,automationTriggerMenuStore:l,onClose:u}):(0,a().HB)(s):null}},81085:(e,t,o)=>{o.d(t,{Eo:()=>v,Fz:()=>m,KI:()=>l,M4:()=>u,YW:()=>b,iY:()=>C,mO:()=>g,qE:()=>c,vm:()=>h});var r=()=>o(16456),n=()=>o(807912),a=()=>o(465546);const i=(0,o(653998).YK)({buttonAutomationCurrentUserDescription:{defaultMessage:"The user who clicked this button",id:"automations.contextValue.buttonAutomationCurrentUserDescription"},buttonAutomationCurrentUserName:{defaultMessage:"Whoever clicked",id:"automations.contextValue.buttonAutomationCurrentUserName"},buttonAutomationCurrentUserTooltip:{defaultMessage:"The person who clicked the button",id:"automations.contextValue.buttonAutomationCurrentUserTooltip"},buttonAutomationThisPageDescription:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageDescription"},buttonAutomationThisPageName:{defaultMessage:"This page",id:"automations.contextValue.buttonAutomationThisPageName"},buttonAutomationThisPageTooltip:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageTooltip"},eventAutomationCurrentUserDescription:{defaultMessage:"The user who made the edit that triggered this automation to run.",id:"automations.contextValue.eventAutomationCurrentUserDescription"},eventAutomationCurrentUserName:{defaultMessage:"Whoever triggered",id:"automations.contextValue.eventAutomationCurrentUserName"},eventAutomationCurrentUserTooltip:{defaultMessage:"The person whose action triggered this automation",id:"automations.contextValue.eventAutomationCurrentUserTooltip"},eventAutomationThisPageDescription:{defaultMessage:"The page that was edited to trigger this automation to run.",id:"automations.contextValue.eventAutomationThisPageDescription"},eventAutomationThisPageName:{defaultMessage:"Trigger page",id:"automations.contextValue.eventAutomationThisPageName"},eventAutomationThisPageTooltip:{defaultMessage:"The page that triggered this automation",id:"automations.contextValue.eventAutomationThisPageTooltip"},now:{id:"automations.triggers.now.label",defaultMessage:"Time triggered"},nowDescription:{id:"automations.triggers.now.description",defaultMessage:"The time when this automation begins to run."},nowTooltip:{id:"automations.triggers.now.tooltip",defaultMessage:"The time this automation was triggered"},pageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Page creator"},pageCreatorDescription:{id:"automations.triggers.pageCreator.description",defaultMessage:"The user who created the page that was edited to trigger this automation to run."},pageCreatorTooltip:{id:"automations.triggers.pageCreator.tooltip",defaultMessage:"Person who created page"},today:{id:"automations.triggers.today.label",defaultMessage:"Date triggered"},todayDescription:{id:"automations.triggers.today.description",defaultMessage:"The date when this automation begins to run."},todayTooltip:{id:"automations.triggers.today.tooltip",defaultMessage:"The date this automation was triggered"}});function l(){return(0,a().$y)({source:"global",global:"button_page"})}function s(e,t,o){return{description:o,name:e,tooltip:t,compile:(r,a)=>({description:o?r.formatMessage(o):void 0,id:l(),kind:n().FormulaContextValueKind.ContextValue,name:r.formatMessage(e),tooltipName:r.formatMessage(t),type:{collection:a,type:"block"}}),evaluate:e=>({kind:n().FormulaContextValueKind.ContextValue,id:l(),value:{type:"block",value:e}})}}const u=s(i.buttonAutomationThisPageName,i.buttonAutomationThisPageTooltip,i.buttonAutomationThisPageDescription),c=s(i.eventAutomationThisPageName,i.eventAutomationThisPageTooltip,i.eventAutomationThisPageDescription);function p(){return(0,a().$y)({source:"global",global:"current_user"})}function d(e,t,o){return{description:o,name:e,tooltip:t,compile:r=>({description:o?r.formatMessage(o):void 0,id:p(),kind:n().FormulaContextValueKind.ContextValue,name:r.formatMessage(e),tooltipName:r.formatMessage(t),type:{type:"person"}}),evaluate:e=>({id:p(),kind:n().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const m=d(i.buttonAutomationCurrentUserName,i.buttonAutomationCurrentUserTooltip,i.buttonAutomationCurrentUserDescription),g=d(i.eventAutomationCurrentUserName,i.eventAutomationCurrentUserTooltip,i.eventAutomationCurrentUserDescription);function y(){return(0,a().$y)({source:"global",global:"now"})}const h={description:i.nowDescription,name:i.now,tooltip:i.nowTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:y(),kind:n().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:y(),kind:n().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,r().KQ)(Date.now(),e)}})};function f(){return(0,a().$y)({source:"global",global:"today"})}const v={description:i.todayDescription,name:i.today,tooltip:i.todayTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:f(),kind:n().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:f(),kind:n().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,r().p6)(Date.now(),e)}})};function x(){return(0,a().$y)({source:"global",global:"page_creator"})}function S(e,t){return{description:i.pageCreatorDescription,name:e,tooltip:t,compile(o){return{description:this.description?o.formatMessage(this.description):void 0,id:x(),kind:n().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{type:"person"}}},evaluate:e=>({id:x(),kind:n().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const b=S(i.pageCreator,i.pageCreatorTooltip),C=S(i.pageCreator,i.pageCreatorTooltip)},88937:(e,t,o)=>{o.d(t,{AJ:()=>f,CH:()=>v,Xl:()=>x,qR:()=>y,sF:()=>h,vu:()=>g});var r=o(242343),n=()=>o(803290),a=()=>o(174114),i=()=>o(653998),l=()=>o(273520),s=()=>o(907721),u=()=>o(962373),c=()=>o(179701),p=()=>o(624133),d=()=>o(724175),m=o(163643);function g(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n,propertySchema:i}=e,l=(0,a().IS)((e=>({icon:{fill:e.text.uiRedPrimary},iconWrap:{background:e.tint.uiRed,borderRadius:4},propertyType:{color:e.accentColors.red[700]}})),[]),u=f({propertySchema:i}),c=v();return(0,m.jsx)(d().z$,{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n,propertyType:i.type,styles:l,tooltip:c,tooltipPlacement:s().W.Bottom,children:u})}function y(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n}=e,i=(0,a().IS)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=x();return(0,m.jsx)(d().z$,{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n,styles:i,tooltip:l,children:l})}function h(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,i=(0,c().j)(),s=(0,n().uB)(void 0,u().A),d=(0,r.useCallback)((()=>s.reset()),[s]);return(0,m.jsx)(l().Ay,{buttonPopupStore:s,popupType:i,render:()=>(0,m.jsx)(p().a,{actionId:t,closeMenu:d,propertyId:o}),renderOrigin:a})}function f(e){const{propertySchema:t}=e;return(0,m.jsx)(i().sA,{defaultMessage:'"{propertyName}" property was deleted',id:"updateThisPageUnsupportedPropertyAction.updatedDeletedProperty.elementTitleText",values:{propertyName:t.name}})}function v(){return(0,m.jsx)(i().sA,{defaultMessage:"Restore property or delete to enable this automation",id:"updateThisPageUnsupportedPropertyAction.updatedDeletedProperty.title"})}function x(){return(0,m.jsx)(i().sA,{defaultMessage:"The property was permanently deleted",id:"updateThisPageUnsupportedPropertyAction.permanentlyDeleted.title"})}},89414:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>r,pencilLineSmallIcon:()=>n});o(242343);const r={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"M11.243 3.457a.803.803 0 0 0-1.13 0l-.554.552a.075.075 0 0 0 0 .106l1.03 1.03a.075.075 0 0 0 .107 0l.547-.546a.1.1 0 0 0 .019-.032.804.804 0 0 0-.02-1.11m-2.246 1.22a.075.075 0 0 0-.106 0l-6.336 6.326a1.1 1.1 0 0 0-.237.393l-.27.87v.002c-.062.232.153.466.389.383l.863-.267q.221-.061.397-.239l6.332-6.331a.075.075 0 0 0 0-.106zm-3.355 6.898a.08.08 0 0 0-.053.022l-1.1 1.1a.075.075 0 0 0 .053.128h9.06a.625.625 0 1 0 0-1.25z"})},n=(0,o(680369).wt)("pencilLineSmall",r)},99267:(e,t,o)=>{o.d(t,{m:()=>n});o(242343);var r=o(163643);const n=(0,o(680369).wt)("mention",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M0.870117 8.40625C0.870117 4.01758 3.86426 1.09863 8.14355 1.09863C12.2109 1.09863 15.123 3.68945 15.123 7.6543C15.123 10.293 13.9131 12.1318 11.9443 12.1318C10.8506 12.1318 10.0439 11.5645 9.87988 10.6279H9.79785C9.4082 11.5781 8.62207 12.1318 7.57617 12.1318C5.77148 12.1318 4.53418 10.6143 4.53418 8.42676C4.53418 6.2666 5.76465 4.77637 7.52148 4.77637C8.52637 4.77637 9.36035 5.28906 9.70215 6.12305H9.79102V5.4668C9.79102 5.03613 10.0371 4.77637 10.4473 4.77637C10.8574 4.77637 11.0967 5.03613 11.0967 5.4668V9.85547C11.0967 10.5801 11.4932 11.0039 12.1904 11.0039C13.2363 11.0039 13.8926 9.69141 13.8926 7.74316C13.8926 4.26367 11.3223 2.28125 8.12988 2.28125C4.56836 2.28125 2.18262 4.81055 2.18262 8.44727C2.18262 12.2207 4.69141 14.4629 8.42383 14.4629C9.29883 14.4629 9.94141 14.3398 10.6797 14.1689C10.8164 14.1416 10.9326 14.1279 11.0283 14.1279C11.3428 14.1279 11.5547 14.3398 11.5547 14.6338C11.5547 14.9141 11.3975 15.1533 10.9463 15.3037C10.3242 15.5088 9.31934 15.6523 8.19824 15.6523C3.93262 15.6523 0.870117 12.8975 0.870117 8.40625ZM7.84277 10.9014C8.99805 10.9014 9.73633 9.93066 9.73633 8.41309C9.73633 6.92285 9.00488 5.98633 7.84961 5.98633C6.71484 5.98633 5.99707 6.93652 5.99707 8.44043C5.99707 9.95117 6.70801 10.9014 7.84277 10.9014Z"})})},100096:(e,t,o)=>{o.d(t,{aX:()=>$,OT:()=>Q,qt:()=>Z,h3:()=>X,ot:()=>U,M0:()=>J});var r=o.n(o(309102)),n=o(242343),a=()=>o(237385),i=()=>o(152058),l=()=>o(873895),s=()=>o(803290),u=()=>o(174114),c=()=>o(903012),p=()=>o(199001),d=()=>o(384221),m=()=>o(126451),g=()=>o(105886),y=()=>o(103151),h=()=>o(354148),f=()=>o(622163),v=()=>o(129978),x=()=>o(951920),S=()=>o(907721),b=()=>o(962373),C=()=>o(738355),k=()=>o(653998),A=()=>o(204132),T=()=>o(271142),M=()=>o(765618),j=o(163643);function P(e){let{actionId:t}=e;const{typecheckResult:o}=(0,T().EC)(),{suppressActionErrors:r}=(0,C().b)(),n=(0,s().K8)((()=>{if(A().Q.isSuccess(o)&&!r.includes(t)){return(o.value.actionValidationFailures[t]||[]).length>0}return!1}),[t,r,o]);return{hasTypecheckErrors:n,typecheckErrorMessage:n?(0,j.jsx)(k().sA,{...M().automationErrorMessages.generalErrorMessage}):null}}o(725707),o(491955),o(403517);var _=()=>o(76394);function I(e){let{disabled:t}=e;const{automationStore:o}=(0,T().EC)(),{hideDragHandle:r}=(0,C().b)(),n=(0,s().K8)((()=>o.getActionStores().map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(_().Pe)),[o]);return r||1===n.length||t}var w=()=>o(533666),V=()=>o(680369);const R={viewBox:"0 0 20 20",svg:(0,j.jsx)("path",{d:"m10.6 5.241 1.458-1.458a.625.625 0 1 1 .884.884l-2.5 2.5a.625.625 0 0 1-.884 0l-2.5-2.5a.625.625 0 0 1 .884-.884L9.35 5.191V1.72a.625.625 0 1 1 1.25 0zM2.375 10c0 1.036.84 1.875 1.875 1.875h11.5a1.875 1.875 0 0 0 0-3.75H4.25c-1.036 0-1.875.84-1.875 1.875m1.875-.625h11.5a.625.625 0 1 1 0 1.25H4.25a.625.625 0 0 1 0-1.25m5.308 3.458a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408v3.466a.625.625 0 1 1-1.25 0v-3.516l-1.458 1.458a.625.625 0 1 1-.884-.884z"})},N=(0,V().wt)("rectangleCompressVertical",R),B={viewBox:"0 0 20 20",svg:(0,j.jsx)("path",{d:"M10.442 1.278a.625.625 0 0 0-.884 0l-2.5 2.5a.625.625 0 1 0 .884.884L9.4 3.204v3.52a.625.625 0 0 0 1.25 0v-3.47l1.408 1.408a.625.625 0 1 0 .884-.884zM9.35 13.275v3.466l-1.408-1.408a.625.625 0 1 0-.884.884l2.5 2.5c.244.244.64.244.884 0l2.5-2.5a.625.625 0 0 0-.884-.884L10.6 16.791v-3.516a.625.625 0 1 0-1.25 0M4.5 6.125H8v1.25H4.5a.875.875 0 0 0-.875.875v3.5c0 .483.392.875.875.875H8v1.25H4.5a2.125 2.125 0 0 1-2.125-2.125v-3.5c0-1.174.951-2.125 2.125-2.125m11 6.5H12v1.25h3.5a2.125 2.125 0 0 0 2.125-2.125v-3.5A2.125 2.125 0 0 0 15.5 6.125H12v1.25h3.5c.483 0 .875.392.875.875v3.5a.875.875 0 0 1-.875.875"})},F=(0,V().wt)("rectangleExpandVertical",B);var E=()=>o(273520),O=()=>o(356813),D=()=>o(443252);const W=(0,k().YK)({moreLabel:{id:"automationBaseStepElement.moreActionsMenu.title",defaultMessage:"More"},collapseLabel:{id:"automationBaseStepElement.moreActionsMenu.collapseLabel",defaultMessage:"Collapse"},expandLabel:{id:"automationBaseStepElement.moreActionsMenu.expandLabel",defaultMessage:"Expand"}});function L(e){const{actionMenu:t,disabled:o,buttonPopupStore:r}=e,{device:n}=(0,a().v3)(),i=(0,k().tz)(),l=(0,u().IS)((e=>({container:{display:"flex",gap:1,padding:2,borderRadius:6,boxShadow:`0px 0px 0px 1px ${e.stroke.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===e.mode?.08:.04})`,backgroundColor:e.surface.elevated},iconButton:{height:24,width:24,flexShrink:0,borderRadius:4},moreIcon:{height:V().Ev.sm,width:V().Ev.sm},collapseToggleIcon:{height:V().Ev.default,width:V().Ev.default}})),[]);return(0,j.jsxs)("div",{style:l.container,children:[e.collapsible&&(0,j.jsx)(y().A,{renderTooltip:()=>(0,j.jsx)(k().sA,{...K(e.isCollapsed)}),render:t=>(0,j.jsx)(O().A,{...t,ariaLabel:i.formatMessage(K(e.isCollapsed)),disabled:o,disabledFeedback:o,hasBackground:!0,icon:e.isCollapsed?F:N,iconStyle:l.collapseToggleIcon,style:l.iconButton,onClick:e.onCollapseToggled})}),(0,j.jsx)(E().Ay,{alignmentToOrigin:E().yP.Center,buttonPopupStore:r,originGap:0,placementToOrigin:E().sx.Bottom,popupType:n.isMobile?D().nl.SlideUp:D().nl.Popup,render:()=>t,renderOrigin:e=>(0,j.jsx)(O().A,{...e,ariaLabel:i.formatMessage(W.moreLabel),disabled:o,disabledFeedback:o,hasBackground:!0,icon:w().Y,iconStyle:l.moreIcon,style:l.iconButton})})]})}function K(e){return e?W.expandLabel:W.collapseLabel}const H="automation-list-item-base-step",q="automation-list-item-base-step--drag-disabled",z="automation-list-item-icon",Y="automation-list-item-drag-handle";function U(e){const{actionMenu:t,buttonPopupStore:o,children:r,disabled:i,icon:u,onClick:c,onMouseDown:d,onMouseEnter:m,onMouseLeave:g,subtitle:y,styles:h}=e,{isMobile:f}=(0,a().Y0)(),v=(0,s().uB)(o,b().A),[S,C]=(0,l().A)(),[k,A]=(0,x().B)(),T=(0,s().K8)((()=>v.getState()),[v]),M=!i&&(f||A||C||T.open),P=J({disabled:i,hasActionMenu:Boolean(t),isActionMenuVisible:M,overrideStyles:h}),_=(0,p().Px)(S,k),I=(0,n.useMemo)((()=>({...P.componentWrap,...P.border})),[P.border,P.componentWrap]);return(0,j.jsxs)("div",{className:H,onClick:c,onMouseDown:d,onMouseEnter:m,onMouseLeave:g,ref:_,style:I,children:[(0,j.jsxs)("div",{style:P.headerWrap,children:[u&&(0,j.jsx)("div",{"aria-hidden":"true",style:P.iconContainer,children:(0,j.jsx)("div",{style:P.iconWrap,children:u(P.icon)})}),(0,j.jsx)("div",{style:P.titleWrap,children:r})]}),y&&(0,j.jsx)("div",{style:P.subtitleWrap,children:y}),t&&(0,j.jsx)("div",{style:P.actionMenuWrap,children:(0,j.jsx)(L,{actionMenu:t,buttonPopupStore:v,disabled:i})})]})}function $(e){const{actionMenu:t,buttonPopupStore:o,children:u,disabled:c,icon:y,onBlur:h,onClick:f,onFocus:v,onMouseDown:S,onMouseEnter:C,onMouseLeave:k,styles:A,subtitle:T,hideDragHandle:M}=e,{isMobile:P}=(0,a().Y0)(),[_,w]=(0,i().A)(),[V,R]=(0,l().A)(),[N,B]=(0,x().B)(),F=(0,s().uB)(o,b().A),E=(0,s().K8)((()=>F.getState().open),[F]),O=(0,p().Px)(N,V),D=!c&&(P||B||w||R||E);(0,n.useEffect)((()=>{function e(e){e.state.open||d().blurActiveElement()}return F.addListener(e),()=>{F.removeListener(e)}}),[F]);const W=J({disabled:c,hasActionMenu:Boolean(t),isActionMenuVisible:D,overrideStyles:A}),K=I({disabled:c}),U=Boolean(M||K);return(0,j.jsxs)("div",{className:r()(H,{[q]:c||P||U}),ref:O,style:W.buttonWrap,children:[(0,j.jsxs)(m().A,{disabled:c,disabledFeedback:c,ignoreLocalHoverState:!0,ignoreLocalPressedState:!0,onBlur:h,onClick:f,onFocus:v,onMouseDown:S,onMouseEnter:C,onMouseLeave:k,ref:_,style:W.componentWrap,children:[(0,j.jsxs)("div",{style:W.headerWrap,children:[y&&(0,j.jsxs)("div",{"aria-hidden":"true",style:W.iconContainer,children:[(0,j.jsx)("div",{className:z,style:W.iconWrap,children:y(W.icon)}),!U&&(0,j.jsx)("div",{className:Y,style:W.iconWrap,children:(0,j.jsx)(g().A,{width:20,height:20,hideClickMessage:!0})})]}),(0,j.jsx)("div",{style:W.titleWrap,children:u})]}),T&&(0,j.jsx)("div",{style:W.subtitleWrap,children:T})]}),t&&(0,j.jsx)("div",{style:W.actionMenuWrap,children:(0,j.jsx)(L,{actionMenu:t,buttonPopupStore:F,disabled:c})})]})}function Q(e){return(0,j.jsx)(re,{actionId:e.actionId,canCollapse:e.canCollapse,children:(0,j.jsx)(G,{...e})})}function G(e){const{actionId:t,actionMenu:o,buttonPopupStore:i,children:u,disabled:c,forceShowActionMenu:m,onMouseEnter:g,onMouseLeave:y,styles:h,hideDragHandle:f}=e,{hasTypecheckErrors:v}=P({actionId:t}),S=I({disabled:c}),k=Boolean(f||S),{isMobile:A}=(0,a().Y0)(),[T,M]=(0,l().A)(),[_,w]=(0,x().B)(),V=(0,s().uB)(i,b().A),R=(0,s().K8)((()=>V.getState().open),[V]),{currentDraggingActionId:N}=(0,C().b)(),{isCollapsed:B,canCollapse:F,toggleCollapsed:E}=oe(),O=(0,p().Px)(_,T),D=!c&&(m||A||w||M||R);(0,n.useEffect)((()=>{function e(e){e.state.open||d().blurActiveElement()}return V.addListener(e),()=>{V.removeListener(e)}}),[V]);const W=J({disabled:c,hasActionMenu:Boolean(o),isActionMenuVisible:D,overrideStyles:h}),K=(0,n.useMemo)((()=>({...W.componentWrap,...W.border,...N&&!k?{cursor:"grabbing"}:{}})),[N,W.border,W.componentWrap,k]);return(0,j.jsxs)("div",{className:r()(H,{[q]:c||A||k||v}),onMouseEnter:g,onMouseLeave:y,ref:O,style:K,children:[o&&(0,j.jsx)("div",{style:W.actionMenuWrap,children:(0,j.jsx)(L,{actionMenu:o,buttonPopupStore:V,disabled:c,...F?{collapsible:!0,isCollapsed:B,onCollapseToggled:E}:{collapsible:!1}})}),u]})}function X(e){const{actionId:t,actionRegistryItem:o,children:r,disabled:a,errorMessage:i,onMouseEnter:l,onMouseLeave:s,styles:u}=e,{typecheckErrorMessage:p}=P({actionId:t}),d=i||p,m=I({disabled:a}),h=Boolean(d||m),{canCollapse:f,toggleCollapsed:v}=oe(),x=J({disabled:a,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:{...u,...f?{headerWrap:{cursor:"pointer"}}:{}}}),b=(0,n.useCallback)((()=>{!a&&f&&v()}),[f,a,v]),C=(0,c().qe)(o)?o.display:void 0;return(0,j.jsx)(y().A,{disableTooltip:!d,renderTooltip:()=>d,render:e=>(0,j.jsxs)("header",{onClick:b,onMouseEnter:l,onMouseLeave:s,...e,onFocus:e=>e.stopPropagation(),style:x.headerWrap,role:"button",children:[C&&(0,j.jsxs)("div",{"aria-hidden":"true",style:x.iconContainer,children:[(0,j.jsx)("div",{className:z,style:x.iconWrap,children:(0,j.jsx)(ee,{display:C,isError:Boolean(d),hasSideEffects:o.hasNewReversableEffect})}),!h&&(0,j.jsx)("div",{className:Y,style:x.iconWrap,children:(0,j.jsx)(g().A,{width:20,height:20,hideClickMessage:!0})})]}),(0,j.jsx)("div",{style:x.titleWrap,children:r})]}),placement:S().W.Bottom,delayThreshold:0})}function Z(e){const{children:t,disabled:o,styles:r}=e,{isCollapsed:a}=oe(),{value:i}=(0,v().fJ)(h().fM),l=J({disabled:o,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:r}),[s,u]=(0,n.useState)(!1);if((0,n.useEffect)((()=>{u(!0)}),[a]),!i)return null;const{AnimatePresence:c,motion:p}=i;return(0,j.jsx)(c,{children:!a&&(0,j.jsxs)(p.div,{style:{display:"flex",flexDirection:"column"},initial:!!s&&{height:0},animate:{height:"auto"},exit:{height:0},children:[(0,j.jsx)("div",{style:l.collapsedDivider}),(0,j.jsx)("div",{style:l.bodyWrap,children:t})]})})}function J(e){const{disabled:t,hasActionMenu:o,isActionMenuVisible:r,overrideStyles:n}=e;return(0,u().IS)((e=>({border:{border:"unset",boxShadow:`0px 0px 0px 1px ${e.stroke.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===e.mode?.08:.04})`},buttonWrap:{background:e.surface.elevated,border:"unset",boxShadow:`0px 0px 0px 1px ${e.stroke.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===e.mode?.08:.04})`,overflow:"hidden",position:"relative",...null==n?void 0:n.buttonWrap},componentWrap:{background:e.surface.elevated,display:"flex",flexDirection:"column",paddingInline:12,paddingBlock:12,position:"relative",overflow:"hidden",...t?{cursor:"default",pointerEvents:"none"}:{},...null==n?void 0:n.componentWrap},headerWrap:{display:"flex",flexDirection:"row",gap:8,marginInlineEnd:o?64:0,...t?{opacity:.4}:{},...null==n?void 0:n.headerWrap},iconContainer:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",flexShrink:0},iconWrap:{display:"flex",justifyContent:"center",alignItems:"center",width:20,height:20,...null==n?void 0:n.iconWrap},icon:{fill:e.text.secondary,height:"auto",width:16,...null==n?void 0:n.icon},titleWrap:{display:"flex",alignItems:"start",flex:"1 1 auto",fontSize:14,lineHeight:"20px",minWidth:0,whiteSpace:"pre",flexWrap:"wrap",...null==n?void 0:n.titleWrap},subtitleWrap:{...null==n?void 0:n.subtitleWrap},bodyWrap:{fontSize:14,marginBlockStart:12,marginBlockEnd:2,marginInline:2,marginTop:22,...null==n?void 0:n.bodyWrap},collapsedDivider:{borderTop:`1px solid ${e.stroke.secondary}`,left:0,marginTop:12,position:"absolute",width:"100%"},actionMenuWrap:{flex:"0 0 auto",height:26,position:"absolute",right:8,top:8,zIndex:2,...r?{}:f().Qg}})),[12,t,o,r,n])}function ee(e){const{display:t,hasSideEffects:o,isError:r}=e,n=(0,u().IS)((e=>({iconWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,background:r?e.tint.uiRed:o?e.tint.uiBlue:e.tint.regular,flexShrink:0},icon:{width:14,height:14,fill:r?e.icon.uiRedPrimary:o?e.icon.uiBluePrimary:e.icon.secondary,margin:"0 auto"}})),[o,r]);return(0,j.jsx)("div",{style:n.iconWrap,children:t.icon(n.icon)})}const te=(0,n.createContext)({canCollapse:!1,isCollapsed:!1,toggleCollapsed:()=>{}});function oe(){return(0,n.useContext)(te)}function re(e){const{actionId:t,children:o,canCollapse:r}=e,{collapsedActionIds:a,toggleActionIdCollapsed:i}=(0,C().b)(),l=(0,n.useMemo)((()=>a.includes(t)),[t,a]),s=(0,n.useCallback)((()=>{i(t)}),[t,i]);return(0,j.jsx)(te.Provider,{value:{canCollapse:r,isCollapsed:l,toggleCollapsed:s},children:o})}te.displayName="BaseStepElementCollapseContext"},123098:(e,t,o)=>{o.d(t,{$5:()=>S,JI:()=>x,Ww:()=>f,l5:()=>b});o(725707),o(491955),o(403517),o(242343);var r=()=>o(174114),n=()=>o(716605),a=()=>o(752903),i=()=>o(653998),l=()=>o(76394),s=()=>o(31448),u=()=>o(837809),c=()=>o(809785),p=()=>o(898266),d=()=>o(275334),m=()=>o(387652),g=()=>o(999011),y=o(163643);const h=5;function f(e){const t=(0,i().tz)(),{filter:o,propertySchema:r,onClick:n}=e,a={...s().RC,fontWeight:s().Wy.medium},u=o.value,c=r.name,d=(Array.isArray(u)?u:[u]).map((e=>e.value)).filter(l().O9),m=S({intl:t,isText:!0,limit:h,optionValues:d,propertySchema:r}),f=t.formatList(m,{style:"long",type:"disjunction"}),C=b({filter:o,propertySchema:r});if(!C)return null;const k=x(C)(t,{propertyName:(0,y.jsx)("span",{style:a,children:c}),propertyValues:(0,p().d)(f)});return(0,y.jsx)(g().z,{tooltip:k,onClick:n,children:(0,y.jsx)(v,{...C})})}function v(e){const{filter:t,propertySchema:o}=e,n=(0,i().tz)(),a=t.value,u=o.name,c=(Array.isArray(a)?a:[a]).map((e=>e.value)).filter(l().O9),d=S({intl:n,limit:h,optionValues:c,propertySchema:o}),m=n.formatList(d,{style:"long",type:"disjunction"}),g=(0,r().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium}})),[]),f=b({filter:t,propertySchema:o});if(!f)return null;const v=x(f)(n,{propertyName:(0,y.jsx)("span",{style:g.propertyName,children:u}),propertyValues:(0,p().d)(m)});return(0,y.jsx)("div",{style:g.content,children:v})}function x(e){let{filter:t,propertySchema:o}=e;return"select"===o.type?"enum_is"===t.operator?d().Ee:d().n1:"enum_contains"===t.operator?d().Q$:d().Re}function S(e){let{intl:t,isText:o,limit:r,optionValues:i,propertySchema:l,tokenFormat:s=a().NY.Medium}=e;const p=l.options??[],g=i.map((e=>{const r=(0,n().jy)(p,e);return r?o?r.value:(0,y.jsx)(u().O,{value:r.value,color:r.color,format:s,isSingle:!0,showRemoveButton:!1},r.id):o?(0,d().iy)(t):(0,y.jsx)(m().A,{tokenFormat:s},`missing_option_value_${e}`)}));let h;if(void 0!==r&&g.length>r){const e=g.length-r,t=o?`+${e}`:(0,y.jsx)(c().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");h=[...g.slice(0,r),t]}else h=g;return h}function b(e){const{filter:t,propertySchema:o}=e;if("select"===o.type){if("enum_is"===t.operator||"enum_is_not"===t.operator)return{filter:t,propertySchema:o}}else if("multi_select"===o.type&&("enum_contains"===t.operator||"enum_does_not_contain"===t.operator))return{filter:t,propertySchema:o};return!1}},128192:(e,t,o)=>{o.d(t,{D:()=>r});const r=(0,o(653998).YK)({back:{defaultMessage:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{defaultMessage:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{defaultMessage:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{defaultMessage:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{defaultMessage:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{defaultMessage:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{defaultMessage:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{defaultMessage:"Select one or more options…",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{defaultMessage:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{defaultMessage:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{defaultMessage:"Search for one or more pages…",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{defaultMessage:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"formulas.simpleValuePicker.errorMessage"},personSelect:{defaultMessage:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{defaultMessage:"Search for one or more people…",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},propertyValuePlaceholder:{defaultMessage:"Enter a value",id:"formulas.SimpleFormulaValuePicker.general.propertyValuePlaceholder"},customFormula:{defaultMessage:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{defaultMessage:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{defaultMessage:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},128290:(e,t,o)=>{o.d(t,{P:()=>i});o(242343);var r=()=>o(174114),n=()=>o(916963),a=o(163643);function i(e){let{style:t={},propertySchema:o}=e;const i=(0,r().DP)();return(0,a.jsx)(n().zB,{size:16,theme:i,icon:o.icon,style:{...t,overflow:"visible"},type:o.type})}},146447:(e,t,o)=>{o.d(t,{Y:()=>x});var r=o(242343),n=()=>o(752597),a=()=>o(237385),i=()=>o(803290),l=()=>o(174114),s=()=>o(975392),u=()=>o(76394),c=()=>o(357247),p=()=>o(384221),d=()=>o(205670),m=()=>o(421338),g=()=>o(273520),y=()=>o(653998),h=o(163643);const f=(0,y().YK)({simpleFormulaMentionActionButtonAriaLabel:{id:"formulas.simpleFormulaMentionActionButton.ariaLabel",defaultMessage:"Mentions"},simpleFormulaMentionActionButtonTooltip:{id:"formulas.simpleFormulaMentionActionButton.tooltip",defaultMessage:"Mention a person, page, or date"}});function v(e){const{disabled:t,onClick:n}=e,a=(0,y().tz)(),i=(0,l().IS)((e=>({formulaIcon:{fill:e.mediumIconColor,height:16,width:16},button:{height:20,width:20,borderRadius:4}})),[]),s=(0,r.useCallback)((()=>a.formatMessage(f.simpleFormulaMentionActionButtonTooltip)),[a]),u=(0,r.useCallback)((e=>(0,h.jsx)(o(356813).A,{...e,ariaLabel:a.formatMessage(f.simpleFormulaMentionActionButtonAriaLabel),disabled:t,disabledFeedback:t,icon:o(99267).m,iconStyle:i.formulaIcon,onClick:n,style:i.button})),[t,a,n,i]);return(0,h.jsx)(o(103151).A,{disableTooltip:t,renderTooltip:s,placement:o(907721).W.Bottom,render:u})}const x=r.forwardRef((function(e,t){const{allowedReturnTypes:y,disabled:f,disabledMentionTypes:x,disableEmojiCommands:S,disableFilters:b,disableFormulas:C,disableInsertedDeletedAnnotations:k,disableMentions:A,disableMobileActionBar:T,disableNewLines:M,disableStyleAnnotations:j,formulaInputButtonPopupStore:P,formulaTypecheckContextValues:_,onChange:I,onTextEnter:w,onTextStoreSelect:V,onTextStoreUnselect:R,onTextEsc:N,parentRecordStore:B,placeholder:F,rows:E,shouldShowErrorStyles:O,spaceId:D,style:W,value:L}=e,K=Boolean(f),H=(0,a().v3)(),{isMobile:q}=(0,a().Y0)(),z=(0,r.useRef)(null),Y=(0,i().uB)(P,o(962373).A),[U,$,Q]=r.useMemo((()=>{var e;const t=(null==L?void 0:L.type)??"simple",r=null==L?void 0:L.value;return[t,r,(0,u().O9)(r)?(null===(e=o(34662).q4_(r).match(/\n/g))||void 0===e?void 0:e.length)??0:0]}),[null==L?void 0:L.type,null==L?void 0:L.value]),G="formula"===U,X=(0,r.useMemo)((()=>Q>0||void 0!==E&&E>1),[Q,E]),Z=r.useRef(!1),J=(0,r.useMemo)((()=>{if(I)return function(e){Z.current?Z.current=!1:I({type:U,value:e})}}),[I,U]),{automationStore:ee}=(0,o(271142).YC)(),te=(0,r.useMemo)((()=>ee?{automation_id:[[ee.id]]}:void 0),[ee]),{setValue:oe,store:re}=(0,o(126996).AI)({initialValue:$,onChange:J,properties:te}),ne=(0,i().K8)((()=>re.getValue()),[re]);r.useEffect((()=>{(0,s().n4)($,ne)||(Z.current=!0,oe($))}),[ne,oe,$]);const ae=r.useRef(_);r.useEffect((()=>{(0,s().n4)(_,ae.current)||(ae.current=_,(0,s().n4)($,ne)||(Z.current=!0),oe($))}),[_,ne,oe,$]);const ie=(0,i().K8)((()=>!1!==(0,o(486881).j_)(re)),[re]);r.useEffect((()=>{if(ie)return null==V||V(),function(){null==R||R()}}),[ie,V,R]);const le=(0,r.useMemo)((()=>({...x,reminder:!0})),[x]),se=(0,r.useMemo)((()=>M?w:function(){const e=d().default.state;"editing"===e.mode&&o(84543).createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:H,canUndo:!0,perform:t=>{o(448316).$D({disableEmojiCommands:!0,disableMentions:!0,disableSlashCommands:!0,editorMode:"default",environment:H,multiSelection:e.multiSelection,string:"\n",transaction:t})}}),null==w||w()}),[H,M,w]),ue=(0,r.useCallback)((()=>{const e=d().default.state;"editing"===e.mode&&(0,o(621641).KP)(e.multiSelection)&&e.multiSelection.start.store===re||(p().setSelectionAtEnd({store:re}),n().default.afterNextFlush((()=>{const e=null==z?void 0:z.current,t=null==e?void 0:e.getNode();t&&t.scrollTo({top:t.scrollHeight})})))}),[z,re]),ce=r.useRef(!1),pe=r.useCallback((()=>{ce.current||(c().VN(),o(112892).VN({dismissed:!1}),o(46406).VN()),ce.current=!1,ue()}),[ue]),de=(0,r.useCallback)((e=>null==I?void 0:I(e)),[I]),me=(0,r.useCallback)((e=>{e.stopPropagation(),async function(){ce.current=!0,c().VN(),null==V||V(),ue(),await n().default.afterNextFlush(),c().Gf({environment:H,mentionSectionOrdering:["custom-formula","formula"],mentionTypes:{bot:!0,createPage:!1,date:!0,formulaContextVariable:!0,group:!0,team:!0,heading:!0,inviteUserToPage:!1,inviteUserToWorkspace:!1,page:!0,reminder:!1,templateVariable:!1,user:!0,slackSpecialMention:!1}})}()}),[H,V,ue]),ge=(0,r.useCallback)((e=>{ue(),e.stopPropagation()}),[ue]),ye=(0,r.useCallback)((e=>{if(e.relatedTarget&&(e.currentTarget.contains(e.relatedTarget)||(0,o(495312).Rp)(e.relatedTarget)))return;const t=d().default.getState();if("editing"!==t.mode)return;t.multiSelection.start.store.id===re.id&&p().clear({environment:H})}),[H,re.id]),he=r.useCallback((async()=>{if("formula"===U){await(0,o(523365).Cp)()&&(null==I||I({type:"simple",value:null==L?void 0:L.value}))}else"simple"===U?Y.setState({open:!0}):(0,u().HB)(U)}),[Y,I,null==L?void 0:L.value,U]),fe=(0,r.useCallback)((()=>Y.setState({open:!1})),[Y]),ve=(0,r.useCallback)((()=>ue()),[ue]),xe=(0,r.useCallback)((()=>{ie&&p().clear({environment:H})}),[H,ie]);r.useImperativeHandle(t,(()=>({blur:xe,focus:ve})),[xe,ve]);const Se=(0,o(622286).X)("collections_xws"),be=(0,l().IS)((e=>{const t={whiteSpace:"pre-wrap",lineHeight:"20px",padding:"2px 4px",fontSize:14};return{containerWrap:{width:200,...W},formulaText:{...t,cursor:"pointer"},scroller:{flexGrow:1,height:void 0!==E?`calc(1em * ${1.5*E})`:void 0,maxHeight:"calc(1em * 6)",width:void 0!==E&&E>1||X?"100%":"auto"},text:{...t},textWrap:{cursor:"text",display:"flex",flexWrap:"wrap",justifyContent:"end",opacity:K?.4:void 0,width:"100%"},wrap:{background:e.inputBackground,borderRadius:6,boxShadow:e.inputBoxShadow,boxSizing:"border-box",cursor:"text",padding:2,...O&&{border:`1px solid ${e.text.uiRedPrimary}`,boxShadow:"none"}},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end",padding:"2px 2px 2px 0px"}}}),[K,X,E,O,W]),Ce=!A||!C,ke=A||G,Ae=Se?"cross_space_and_read_permissions":"read_permissions_only";return(0,h.jsx)(g().Ay,{buttonPopupStore:Y,popupType:q?g().z7.SlideUp:g().z7.Popup,render:()=>(0,h.jsx)(o(475077).A,{allowedReturnTypes:y,disabled:K,formulaTypecheckContextValues:_??[],onChange:de,onClose:fe,parentRecordStore:B,restrictUnaccessibleProperties:Ae,spaceId:D,value:L}),renderOrigin:e=>(0,h.jsx)("div",{onClick:ge,style:be.containerWrap,onBlur:ye,children:(0,h.jsx)(m().Y1,{align:"center",className:o(983050).CCX,direction:"vertical",gap:4,style:be.wrap,children:(0,h.jsxs)("div",{style:be.textWrap,children:[(0,h.jsx)(o(142708).H,{ref:z,style:be.scroller,type:o(98508).A.Y,children:"simple"===U?(0,h.jsx)(o(636045).A,{disableComment:!0,disabled:K,disabledMentionTypes:le,disableEmbedMenu:!0,disableEmojiCommands:S,disableFilters:b,disableInsertedDeletedAnnotations:k,disableMentions:A,disableMobileActionBar:T,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableShiftEnter:M,disableSlashCommands:!0,disableStyleAnnotations:j,formulaValueTypes:_??[],inPageFind:o(868199).Os.none,mentionSectionOrdering:["custom-formula","formula"],onDown:s().D_,onEnter:se,onFocus:pe,onTab:s().D_,onUntab:s().D_,onUp:s().D_,onEsc:N,pasteBehavior:"inline",placeholder:F,store:re,style:be.text}):(0,h.jsx)("div",{...e,style:be.formulaText,children:(0,h.jsx)(o(553538).$,{formulaTypecheckContextValues:_,parentRecordStore:B,spaceId:D,value:L})})}),Ce&&(0,h.jsx)("div",{children:(0,h.jsxs)(m().Y1,{direction:"horizontal",gap:2,style:be.actionButtonGroup,children:[!ke&&(0,h.jsx)(v,{disabled:K,onClick:me}),!C&&(0,h.jsx)(o(60010).F,{disabled:K,onClick:he,value:L})]})})]})})})})}))},164634:(e,t,o)=>{o.d(t,{O:()=>r});const r=(0,o(653998).YK)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}})},179701:(e,t,o)=>{o.d(t,{j:()=>i});var r=()=>o(237385),n=()=>o(803290),a=()=>o(443252);function i(e){const t=(0,r().Y0)();return(0,n().K8)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?a().nl.SlideUp:a().nl.Popup),[t,null==e?void 0:e.tabletBehavior])}},180986:(e,t,o)=>{o.d(t,{A:()=>S,r:()=>A});var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(174114),l=()=>o(887508),s=()=>o(969338),u=()=>o(680369),c=()=>o(653998),p=()=>o(31448),d=()=>o(209684),m=()=>o(356813),g=()=>o(935091),y=()=>o(858023),h=()=>o(743668),f=()=>o(640979),v=o(163643);const x=(0,c().YK)({backButtonAriaLabel:{id:"notificationRuleSettingsMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"}});function S(e){const{automationTriggerActionMenuStore:t,customMenuProps:o,headerTitle:r,onClose:n,onDone:a,subHeaderComponent:i,type:l,width:s}=e,u=A({automationTriggerActionMenuStore:t,customMenuProps:o,onClose:n,onDone:a,subHeaderComponent:i,title:r,width:s});return"custom"===l?(0,v.jsx)(C,{...e,menuProps:u}):(0,v.jsx)(b,{...e,menuProps:u})}function b(e){const{sections:t,menuProps:o}=e;return(0,v.jsx)(g().A,{...o,children:(0,v.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:0,sections:t})})}function C(e){const{children:t,menuProps:o}=e;return(0,v.jsx)(g().A,{...o,children:t})}function k(e){const{automationActionMenuStore:t,menuHeaderTitle:o,onDone:r,subHeaderComponent:n}=e,s=(0,c().tz)(),g=(0,a().K8)((()=>t.state.stack.length>1),[t]),y=(0,i().IS)((e=>({header:{display:"flex",alignItems:"center",color:e.text.secondary,fontWeight:p().Wy.medium,fontSize:p().J.UISmall.desktop,padding:8,justifyContent:"space-between"},leadingItems:{display:"flex",alignItems:"center",gap:6,overflow:"hidden",whiteSpace:"nowrap"},iconButtonStyle:{height:u().Ev.default,width:u().Ev.default},iconButtonIconStyle:{width:u().Ev.sm,height:u().Ev.sm}})),[]);return void 0!==o||g?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{style:y.header,children:[(0,v.jsxs)("div",{style:y.leadingItems,children:[g&&(0,v.jsx)(m().A,{ariaLabel:s.formatMessage(x.backButtonAriaLabel),icon:l().v,style:y.iconButtonStyle,iconStyle:y.iconButtonIconStyle,onClick:()=>{t.popSettingsItem()}}),o]}),r&&(0,v.jsx)(d().p,{onClick:r,isBlue:!0,size:"xs",children:(0,v.jsx)(c().sA,{id:"automationTriggerActionMenu.doneButton.title",defaultMessage:"Done"})})]}),n]}):null}function A(e){const{automationTriggerActionMenuStore:t,customMenuProps:o={},onClose:a,onDone:i,subHeaderComponent:l,title:u,width:p}=e,{isMobile:d}=(0,n().Y0)(),g=(0,c().tz)(),y=(0,r.useCallback)((()=>{1===t.getState().stack.length?a():t.popSettingsItem()}),[t,a]);return(0,r.useMemo)((()=>{let e;return e=d?{...o,minWidth:260,menuType:f().gu.Modal,title:u,left:(0,v.jsx)(m().A,{ariaLabel:g.formatMessage(x.backButtonAriaLabel),icon:s().L,onClick:y}),right:(0,v.jsx)(h().DoneMenuText,{}),onClickRight:()=>{null==i||i(),a()},header:l}:{width:p??266,menuType:f().gu.Popup,maxHeight:"50vh",header:(0,v.jsx)(k,{automationActionMenuStore:t,menuHeaderTitle:u,subHeaderComponent:l,onDone:i})},e}),[t,o,g,d,a,i,y,l,u,p])}},234887:(e,t,o)=>{o.d(t,{A:()=>C});o(362833),o(403517);var r=o(242343),n=()=>o(237385),a=(o(725707),o(491955),()=>o(174114)),i=()=>o(807912),l=()=>o(630714),s=()=>o(34662),u=()=>o(653998),c=()=>o(975392),p=()=>o(401382),d=()=>o(128192),m=()=>o(485951),g=o(163643);var y=()=>o(640979),h=()=>o(935091),f=()=>o(858023),v=()=>o(743668),x=()=>o(88271),S=()=>o(24e3),b=()=>o(360234);function C(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:C,onChange:k,onClose:A,showGenericHeader:T=!1,value:M,parentRecordStore:j}=e,P=(0,n().Y0)(),{footer:_,header:I,numberInput:w,valueItems:V}=function(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,onChange:y,onClose:h,value:f}=e,v=(0,u().tz)(),{isMobile:x}=(0,n().Y0)(),S=(0,a().IS)((e=>({inputOuterStyle:{fontSize:"12px",...x?{boxShadow:"none",background:"light"===e.mode?e.white:e.selectLightGray[200],borderRadius:0,minHeight:"45px"}:{}}})),[x]),b=o.filter((e=>"number"===e.type.type)),C=(0,r.useCallback)((e=>{y({type:"simple",value:e})}),[y]),k=(0,r.useCallback)((e=>{C(e),h()}),[C,h]),A=(0,r.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],C(o)}),[C]),T=(0,r.useCallback)((e=>{const t=void 0!==e[0]?(0,l().toSimpleFormulaSingleValue)(e[0]):void 0;k(t)}),[k]),M=c().oE(b.map((e=>{if(e.kind===i().FormulaContextValueKind.ContextValue)return{action:"replace",currentSimpleFormulaValueTokens:t,id:e.id||"",setCurrentTokens:T,value:e}}))),j=(0,r.useMemo)((()=>{const e=t[0],o="string"==typeof e?e:(0,s().q4_)(null==f?void 0:f.value);return(0,g.jsx)(p().Ay,{focusInitial:!x,onChange:A,value:o,type:"number",inputOuterStyle:S.inputOuterStyle,placeholder:v.formatMessage(d().D.propertyValuePlaceholder)})}),[t,A,v,x,S.inputOuterStyle,null==f?void 0:f.value]);return{footer:(0,g.jsx)(m().A,{value:f,onChange:y}),header:v.formatMessage(d().D.genericMenuHeader),numberInput:j,valueItems:M}}({formulaTypecheckContextValues:o,onChange:k,onClose:A,currentSimpleFormulaValueTokens:t,value:M})||{},R=(0,r.useMemo)((()=>V.map((e=>{const{annotation:t,itemAction:r}=(0,b().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,g.jsx)(S().A,{annotation:t,disabled:!1,formulaTypecheckContextValues:o,menuArgs:e,parentRecordStore:j}),action:r}}))),[o,V,j]),N=[];let B;R.length>0&&N.push({key:"textbox",render:e=>(0,g.jsx)(x().A,{...e}),items:R}),B=P.isMobile?{menuType:y().gu.Modal,minWidth:260,onClickRight:A,right:(0,g.jsx)(v().DoneMenuText,{})}:{menuType:y().gu.Popup,maxHeight:"50vh",width:260,footer:_&&(0,g.jsx)(x().A,{topBorder:!0,children:_}),disableHeaderBorder:!0};const F=T&&(0,g.jsx)(x().A,{style:{paddingBottom:0},title:I}),E=(0,g.jsxs)("div",{children:[!P.isMobile&&((null==C?void 0:C.header)||F),w]}),O=(0,g.jsx)(f().Ay,{initialFocus:0,sections:N,type:f().Oh.Vertical});return{headerDiv:E,innerComponents:O,numberMenu:(0,g.jsx)(h().A,{...B,...C,header:E,children:O})}}},237692:(e,t,o)=>{o.d(t,{A:()=>d});o(403517),o(242343);var r=()=>o(237385),n=()=>o(174114),a=()=>o(903012),i=()=>o(653998),l=()=>o(535906),s=()=>o(273520),u=()=>o(88271),c=()=>o(575460),p=o(163643);function d(e){let{action:t,handleOnChange:o}=e;const d=(0,r().Y0)(),m=(0,n().IS)((e=>({buttonStyle:{fontSize:d.isMobile?16:12,height:20,lineHeight:"unset",marginRight:0,paddingLeft:2,paddingRight:2,color:d.isMobile?e.accentColors.gray[900]:e.accentColors.gray[500]}})),[d.isMobile]),y=g[t||a().yP];return(0,p.jsx)(c().A,{alignmentToOrigin:s().yP.Start,innerButtonStyle:m.buttonStyle,selectedTitle:(0,p.jsx)(i().sA,{...y.text}),renderMenuSections:e=>[{key:"ReplaceAddRemoveToggleOperator",render:e=>(0,p.jsx)(u().A,{...e}),items:Object.values(g).map((t=>({key:t.value,action:()=>{e.close(),o(void 0,t.value)},render:e=>(0,p.jsx)(l().A,{...e,title:(0,p.jsx)(i().sA,{...t.text})})})))}]})}const m=(0,i().YK)({replace:{id:"automations.propertyAction.button.replaceWith",defaultMessage:"Replace with..."},append:{id:"automations.propertyAction.button.add",defaultMessage:"Add..."},remove:{id:"automations.propertyAction.button.remove",defaultMessage:"Remove..."},toggle:{id:"automations.propertyAction.button.toggle",defaultMessage:"Toggle..."}}),g={replace:{text:m.replace,value:"replace"},append:{text:m.append,value:"append"},remove:{text:m.remove,value:"remove"},toggle:{text:m.toggle,value:"toggle"}}},258146:(e,t,o)=>{o.d(t,{bK:()=>i,mK:()=>n});const r=["string_is","string_is_not","string_contains","string_does_not_contain","string_starts_with","string_ends_with","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"string_is"}const a=(0,o(653998).YK)({changesToAny:{id:"automations.propertyTrigger.textField.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"automations.propertyTrigger.textField.isEmpty",defaultMessage:"Is cleared"},stringIs:{id:"automations.propertyTrigger.textField.stringIsOption",defaultMessage:"Is set to"},stringIsNot:{id:"automations.propertyTrigger.textField.stringIsNotOption",defaultMessage:"Is not set to"},stringContains:{id:"automations.propertyTrigger.textField.stringContainsOption",defaultMessage:"Contains"},stringDoesNotContain:{id:"automations.propertyTrigger.textField.stringDoesNotContain",defaultMessage:"Does not contain"},stringStartsWith:{id:"automations.propertyTrigger.textField.stringStartsWithOption",defaultMessage:"Starts with"},stringEndsWith:{id:"automations.propertyTrigger.textField.stringEndsWithOption",defaultMessage:"Ends with"}}),i={string_is:{hasInput:!0,text:a.stringIs,value:"string_is"},string_is_not:{hasInput:!0,text:a.stringIsNot,value:"string_is_not"},string_contains:{hasInput:!0,text:a.stringContains,value:"string_contains"},string_does_not_contain:{hasInput:!0,text:a.stringDoesNotContain,value:"string_does_not_contain"},string_starts_with:{hasInput:!0,text:a.stringStartsWith,value:"string_starts_with"},string_ends_with:{hasInput:!0,text:a.stringEndsWith,value:"string_ends_with"},changes_to_any:{hasInput:!1,text:a.changesToAny,value:"changes_to_any"},is_empty:{text:a.isEmpty,value:"is_empty",hasInput:!1}}},265405:(e,t,o)=>{o.d(t,{F:()=>l});var r=o(242343),n=()=>o(644518),a=()=>o(76394),i=()=>o(271142);function l(e){const{actionId:t}=e??{},o=(0,i().YC)();return(0,r.useMemo)((()=>{if(!o.defined)return[];return(0,a().O9)(t)?(0,n().getContextValuesForAction)(o.typecheckResult,t):(0,n().getAllContextValues)(o.typecheckResult)}),[o.defined,o.typecheckResult,t])}},275334:(e,t,o)=>{o.d(t,{$B:()=>p,CH:()=>A,CV:()=>a,Ee:()=>V,Fp:()=>L,HG:()=>T,JQ:()=>f,LK:()=>C,NW:()=>l,Od:()=>j,Oo:()=>s,Pb:()=>d,Pg:()=>M,Q$:()=>N,Re:()=>B,Rn:()=>I,SV:()=>x,T2:()=>P,TF:()=>h,Xr:()=>i,Yx:()=>F,_M:()=>S,_d:()=>D,_f:()=>v,a9:()=>O,cC:()=>k,dd:()=>W,f4:()=>g,f_:()=>m,iy:()=>E,kN:()=>K,n1:()=>R,o7:()=>c,qx:()=>b,rh:()=>w,uW:()=>y,vC:()=>u,vH:()=>H,yR:()=>_});o(725707),o(491955),o(403517);var r=()=>o(716605),n=()=>o(898266);const a=(0,o(653998).YK)({actionCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.dateProperty.single"},actionNumberPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.action.numberPropertySet.title"},actionTextPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.action.textPropertySet.title"},actionPersonPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.personProperty.single"},actionPropertyReplaceWith:{defaultMessage:"Replace {propertyName} with {propertyValue}",id:"automations.action.property.replaceWith"},actionPropertyReplaceWithOthers:{defaultMessage:"Replace {propertyName} with {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}}",id:"automations.action.property.replaceWithOthers"},actionPropertyAdd:{defaultMessage:"Add {propertyValue} to {propertyName}",id:"automations.action.property.add"},actionPropertyAddWithOthers:{defaultMessage:"Add {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} to {propertyName}",id:"automations.action.property.addWithOthers"},actionPropertyRemove:{defaultMessage:"Remove {propertyValue} from {propertyName}",id:"automations.action.property.remove"},actionPropertyRemoveWithOthers:{defaultMessage:"Remove {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} from {propertyName}",id:"automations.action.property.removeWithOthers"},actionPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.property.clear"},actionPropertyToggle:{defaultMessage:"Toggle {propertyValue} in {propertyName}",id:"automations.action.property.toggle"},actionPropertyToggleWithOthers:{defaultMessage:"Toggle {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} in {propertyName}",id:"automations.action.property.toggleWithOthers"},actionRelationPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.relationProperty.single"},actionSelectPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.statusProperty.single"},actionTextPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.textProperty.single"},actionDeletedProperty:{defaultMessage:"Edit a deleted property",id:"automations.action.deletedProperty"},triggerAnyPageAdded:{defaultMessage:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{defaultMessage:"Any property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{defaultMessage:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerAnyPropertyClear:{defaultMessage:"{propertyName} is cleared",id:"automations.trigger.propertyCleared.title"},triggerButtonClicked:{defaultMessage:"<b>Button</b> is clicked",id:"automations.trigger.button.clicked"},triggerCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.trigger.checkboxProperty.checked"},triggerCheckboxPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.checkboxPropertySet.title"},triggerCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.trigger.checkboxProperty.unchecked"},triggerNumberPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.trigger.numberPropertySet.title"},triggerTextPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.trigger.textPropertySet.title"},triggerSelectPropertyIs:{id:"automations.trigger.selectPropertyIs.title",defaultMessage:"{propertyName} is set to {propertyValues}"},triggerSelectPropertyIsNot:{id:"automations.trigger.selectPropertyIsNot.title",defaultMessage:"{propertyName} is not set to {propertyValues}"},triggerMultiSelectPropertyContains:{id:"automations.trigger.multiSelectPropertyContains.title",defaultMessage:"{propertyName} contains {propertyValues}"},triggerMultiSelectPropertyDoesNotContain:{id:"automations.trigger.multiSelectPropertyDoesNotContain.title",defaultMessage:"{propertyName} does not contain {propertyValues}"},triggerStatusPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"},triggerPersonPropertyContainsSingle:{defaultMessage:"{propertyName} contains {propertyValue}",id:"automations.trigger.personPropertySet.singleProperty"},triggerPersonPropertyContainsMultiple:{defaultMessage:"{propertyName} contains any of {propertyValues}",id:"automations.trigger.personPropertySet.multipleProperties"},triggerPersonPropertyDoesNotContainSingle:{defaultMessage:"{propertyName} does not contain {propertyValue}",id:"automations.trigger.personPropertyDoesNotContain.singleProperty"},triggerPersonPropertyDoesNotContainMultiple:{defaultMessage:"{propertyName} does not contain any of {propertyValues}",id:"automations.trigger.personPropertyDoesNotContain.multipleProperties"},triggerRelationPropertyDoesNotContainSingle:{defaultMessage:"{propertyName} does not contain {propertyValue}",id:"automations.trigger.relationProperty.singleDoesNotContain"},triggerRelationPropertyDoesNotContainMultiple:{defaultMessage:"{propertyName} does not contain any of {propertyValue}",id:"automations.trigger.relationProperty.multipleDoesNotContain"},triggerRelationPropertyContainsMultiple:{defaultMessage:"{propertyName} contains any of {propertyValue}",id:"automations.trigger.relationProperty.multiple"},triggerRelationPropertyContainsSingle:{defaultMessage:"{propertyName} contains {propertyValue}",id:"automations.trigger.relationProperty.single"},triggerDeletedPropertyEdit:{defaultMessage:"Deleted property is edited",id:"automations.trigger.deletedPropertyEdited"},deletedPropertyOption:{defaultMessage:"Deleted option",id:"automations.values.deletedPropertyOption"},unknownValue:{defaultMessage:"Unknown value",id:"automations.values.unknownValue"},unknownPropertyTitle:{defaultMessage:"a property",id:"database.viewSettings.automationTab.unknownPropertyTitle"},triggerInvalidConfigurationTitle:{defaultMessage:"Invalid {propertyName} property configuration",id:"automations.trigger.invalidConfiguration"},inlineCustomFormulaDefaultName:{defaultMessage:"My value",id:"automations.formulas.inlineCustomFormulaDefaultName"},triggerRelativeDate:{defaultMessage:"Relative date trigger",id:"automations.trigger.relativeDate.title"}});function i(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionCheckboxPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function l(e){const{propertyName:t}=e;return{...a.actionPropertyClear,values:{propertyName:t}}}function s(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionDatePropertySetSingle,values:{propertyName:t,propertyValue:o}}}function u(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.actionNumberPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function c(e){const{propertyName:t}=e;return{...a.triggerInvalidConfigurationTitle,values:{propertyName:t}}}function p(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.actionTextPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function d(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function m(e){let{elements:t,intl:o}=e;const r=t.length>3?t.length-2:0,a=r>0?2:3,i=o.formatList(t.slice(0,a),{style:"long",type:r>0?"unit":"conjunction"});return{numOthers:r,propertyValue:(0,n().d)(i,{display:"flex"})}}function g(e){const{numOthers:t=0,operator:o,propertyName:r,propertyValue:n}=e;let i;return i=!n||Array.isArray(n)&&0===n.filter((e=>Boolean(e))).length?a.actionPropertyClear:"append"===o?t>0?a.actionPropertyAddWithOthers:a.actionPropertyAdd:"remove"===o?t>0?a.actionPropertyRemoveWithOthers:a.actionPropertyRemove:"toggle"===o?t>0?a.actionPropertyToggleWithOthers:a.actionPropertyToggle:t>0?a.actionPropertyReplaceWithOthers:a.actionPropertyReplaceWith,{...i,values:{propertyName:r,propertyValue:n,numOthers:t}}}function y(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionRelationPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function h(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyContainsSingle,values:{propertyName:t,propertyValue:o}}}function f(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyContainsMultiple,values:{propertyName:t,propertyValue:o}}}function v(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyDoesNotContainSingle,values:{propertyName:t,propertyValue:o}}}function x(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyDoesNotContainMultiple,values:{propertyName:t,propertyValue:o}}}function S(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionSelectPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function b(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionStatusPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function C(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionTextPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function k(e){return e.formatMessage(a.actionDeletedProperty)}function A(e){return e.formatMessage(a.triggerAnyPageAdded)}function T(e){return e.formatMessage(a.triggerAnyPagePropertyEdit)}function M(e){return e.formatMessage(a.triggerDeletedPropertyEdit)}function j(e,t){const{propertyName:o}=t;return e.formatMessage(a.triggerAnyPropertyEdit,{propertyName:o})}function P(e,t){return e.formatMessage(a.triggerCheckboxPropertySet,t)}function _(e,t){const{propertyName:o}=t;return e.formatMessage(a.triggerAnyPropertyClear,{propertyName:o})}function I(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.triggerNumberPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function w(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.triggerTextPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function V(e,t){return e.formatMessage(a.triggerSelectPropertyIs,t)}function R(e,t){return e.formatMessage(a.triggerSelectPropertyIsNot,t)}function N(e,t){return e.formatMessage(a.triggerMultiSelectPropertyContains,t)}function B(e,t){return e.formatMessage(a.triggerMultiSelectPropertyDoesNotContain,t)}function F(e,t){return e.formatMessage(a.triggerStatusPropertySet,t)}function E(e){return e.formatMessage(a.deletedPropertyOption)}function O(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyContainsSingle,values:{propertyName:t,propertyValue:o}}}function D(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyContainsMultiple,values:{propertyName:t,propertyValues:o}}}function W(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyDoesNotContainSingle,values:{propertyName:t,propertyValue:o}}}function L(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyDoesNotContainMultiple,values:{propertyName:t,propertyValues:o}}}function K(e){const{limit:t,optionValues:o,propertySchema:n}=e,a=n.options??[],i=a.length>0,l=o.map((e=>{const t=i?(0,r().jy)(a,e):void 0;return t?{type:"option",value:t}:{type:"deleted",value:e}}));let s=l;if(void 0!==t&&l.length>t){const e=l.length-t;s=[...l.slice(0,t),{type:"truncation",value:`+${e}`}]}return s}function H(e){return e.formatMessage(a.triggerRelativeDate)}},284573:(e,t,o)=>{o.d(t,{x:()=>u});var r=o(242343),n=()=>o(663821),a=()=>o(680369),i=()=>o(31448),l=o(163643);const s={height:"auto",maxWidth:"auto",paddingInline:4},u=(0,r.forwardRef)((function(e,t){const{children:u,disabled:p,hasActionRequired:d,errorIcon:m,icon:g,isCompact:y,isError:h,isSecondary:f,onClick:v,style:x,tooltipMessage:S,dropdownButtonType:b,dropdownIcon:C}=e,k=(0,o(237385).v3)(),A="dropdown"===b,T=(0,o(174114).IS)((e=>({button:{...c(e,{isError:h,hasActionRequired:d,isSecondary:f,dropdownButtonType:b}),gap:2,padding:"0 6px",...y?s:void 0,...A&&{alignItems:"center",height:20,paddingBlock:0,marginBlock:0},...x},children:{...i().RC,lineHeight:"20px",flex:"1 1 auto",display:"grid",gridTemplateColumns:"auto auto",gap:2,...A&&{padding:"0 2px"}},icon:{width:a().Ev.sm,height:a().Ev.sm,marginRight:2,...h?{fill:e.lightErrorText}:void 0},warningIcon:{color:e.errorText,fill:e.errorText,width:a().Ev.sm,height:a().Ev.sm,flex:"0 0 auto",marginRight:2},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:a().Ev.sm,width:a().Ev.sm,...A&&{fill:"unset"}}})),[h,d,f,b,y,A,x]),M=(0,r.useMemo)((()=>g?()=>g(T.icon):void 0),[g,T.icon]),j=(0,r.useCallback)((()=>S??null),[S]),P=(0,r.useCallback)((e=>{o(384221).clear({environment:k}),o(360378).IU({environment:k}),null==v||v(e),e.stopPropagation()}),[k,v]),_=m||o(369678).exclamationMarkTriangleFillSmallIcon,I=h?()=>_(T.warningIcon):M;return(0,l.jsx)(o(103151).A,{delayThreshold:0,disableTooltip:!Boolean(S),placement:o(907721).W.Bottom,render:e=>"dropdown"===b?(0,l.jsxs)(o(800995).A,{...e,variant:h?"secondary":"lightGray",disabled:p,disabledFeedback:p,onClick:P,ref:t,style:T.button,children:[I&&I(),(0,l.jsx)("div",{style:T.children,children:u}),C?C(T.chevronIcon):(0,n().arrowChevronSingleDownSmallIcon)(T.chevronIcon)]}):(0,l.jsxs)(o(209684).p,{...e,icon:h?I:M,disabled:p,disabledFeedback:p,onClick:P,ref:t,shouldShrink:!0,style:T.button,isRed:h,children:[(0,l.jsx)("div",{style:T.children,children:u}),(0,n().arrowChevronSingleDownSmallIcon)(T.chevronIcon)]}),renderTooltip:j})}));function c(e,t){const{isError:o,hasActionRequired:r,isSecondary:n,dropdownButtonType:a}=t;return o?{color:e.errorText,..."dropdown"===a&&{boxShadow:"none"}}:r?{fontWeight:i().Wy.regular,color:e.text.secondary}:n?{color:e.text.secondary}:{fontWeight:i().Wy.regular,color:e.text.primary}}},289051:(e,t,o)=>{o.d(t,{Hn:()=>E,XN:()=>F,pj:()=>w,qj:()=>O});o(362833),o(725707),o(491955),o(500234),o(403517),o(113085);var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(174114),l=()=>o(83544),s=()=>o(706788),u=()=>o(916480),c=()=>o(242103),p=()=>o(668657),d=()=>o(611121),m=()=>o(653998),g=()=>o(975392),y=()=>o(204132),h=()=>o(76394),f=()=>o(818369),v=()=>o(423392),x=()=>o(477784),S=()=>o(944560),b=()=>o(863969),C=()=>o(162339),k=()=>o(773082),A=()=>o(363043),T=()=>o(535906),M=()=>o(401382),j=()=>o(966789),P=()=>o(88271),_=o(163643);const I=(0,m().YK)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Search…"}});function w(e){const{currentNotificationChannels:t,onNotificationChannelSelect:o,onNotificationChannelSelectAll:i,onClose:u,onNewSlackAccountAdded:c,renderMenu:d,channelFilter:f,workflowExternalAuthenticationPointer:A,isMultiSelectMode:w,shouldHideSlackAccountSection:B,shouldShowSelectAllChannels:O,isAllChannels:D,shouldShowImChannels:W}=e,L=(0,n().v3)(),{isMobile:K}=(0,n().Y0)(),H=(0,a().O$)(k().A.completeSlackAuthentications),q=e.currentExternalAuthentication??g().$1(H),z=(0,r.useMemo)((()=>A?{type:"workflow",workflowExternalAuthenticationId:A.id}:q?{type:"external",botId:q.id}:void 0),[A,q]);r.useEffect((()=>{const e=A?null==A?void 0:A.spaceId:null==q?void 0:q.space_id;z&&e&&E({environment:L,spaceId:e,externalAuthConfig:z})}),[L,z,q,A]);const Y=(null==A?void 0:A.id)??(null==q?void 0:q.id),[U,$]=r.useState(""),{loadedChannelsForAccount:Q,isLoading:G}=F(z),X=(0,a().K8)((()=>k().A.integrations.state.find((e=>e.id===s().zG))),[]),Z=(0,b().O)(),J=r.useCallback((e=>{q?o(e,q.parent_id):A&&o(e,A.id),w||u()}),[o,q,A,u,w]),ee=r.useCallback((()=>{const e=q?q.parent_id:null==A?void 0:A.id;e&&i&&i(e),w&&O||u()}),[q,A,w,O,i,u]),te=V(),oe=r.useCallback((e=>{const{channel:o}=e;return{key:o.id,render:e=>(0,_.jsx)(T().A,{...e,icon:N({channel:o,styles:te.icon}),desktopIconStyle:{width:8},title:o.name,isChecked:!D&&(null==t?void 0:t.some((e=>e.id===o.id)))}),action:()=>{J(o)}}}),[te,D,t,J]),{publicChannels:re,privateChannels:ne,personalChannels:ae,imChannels:ie}=r.useMemo((()=>function(e,t){const o=[],r=[],n=[],a=[];e.sort(((e,t)=>e.name.localeCompare(t.name)));for(const i of e)t&&!t(i)||("public"===i.type?o.push(i):"private"===i.type?r.push(i):"me"===i.type?n.push(i):"im"===i.type?a.push(i):(0,h().HB)(i.type));return{publicChannels:o,privateChannels:r,personalChannels:n,imChannels:a}}(Q,f)),[f,Q]),le=r.useCallback((()=>re.map((e=>({menuListItem:oe({channel:e}),channelName:e.name})))),[re,oe]),se=r.useCallback((()=>ne.map((e=>({menuListItem:oe({channel:e}),channelName:e.name})))),[ne,oe]),ue=r.useCallback((()=>ae.map((e=>({menuListItem:oe({channel:e}),channelName:e.name})))),[ae,oe]),ce=r.useCallback((()=>ie.map((e=>({menuListItem:oe({channel:e}),channelName:e.name})))),[ie,oe]),pe=r.useCallback((()=>le().map((e=>{let{menuListItem:t,channelName:o}=e;if(R({channelName:o,query:U}))return t})).filter(h().O9)),[le,U]),de=r.useCallback((()=>se().map((e=>{let{menuListItem:t,channelName:o}=e;if(R({channelName:o,query:U}))return t})).filter(h().O9)),[se,U]),me=r.useCallback((()=>ue().map((e=>{let{menuListItem:t,channelName:o}=e;if(R({channelName:o,query:U}))return t})).filter(h().O9)),[ue,U]),ge=r.useCallback((()=>ce().map((e=>{let{menuListItem:t,channelName:o}=e;if(R({channelName:o,query:U}))return t})).filter(h().O9)),[ce,U]),ye=r.useCallback((()=>q?(0,S().qO)(q).organizationName:"Workflows organization"),[q]),he=r.useCallback((()=>{if(!Y)return[];const e=[],t=pe(),o=de(),r=me(),n=ge(),a=O&&w&&!U&&!G;return a&&e.push({key:"select-all-channels",render:e=>(0,_.jsx)(P().A,{...e}),items:[{key:"all-channels",render:e=>(0,_.jsx)(T().A,{...e,title:(0,_.jsx)(m().sA,{id:"notificationRuleSettings.selectChannelView.selectAllChannels.label",defaultMessage:"All channels"}),isChecked:D}),action:ee}]}),r.length>0&&e.push({key:"personal-channels",render:e=>(0,_.jsx)(P().A,{...e,title:ye(),topBorder:a}),items:r}),t.length>0&&e.push({key:"public-channels",render:e=>(0,_.jsx)(P().A,{...e,topBorder:r.length>0||a,title:0===r.length&&ye()}),items:t}),o.length>0&&e.push({key:"private-channels",render:e=>(0,_.jsx)(P().A,{...e,topBorder:t.length>0||a,title:0===r.length&&t.length>0&&ye()}),items:o}),W&&n.length>0&&e.push({key:"im-channels",render:e=>(0,_.jsx)(P().A,{...e,title:(0,_.jsx)(m().sA,{defaultMessage:"Direct Messages with Notion",id:"imChannels.title"})}),items:n}),e}),[Y,pe,de,me,ge,O,w,ee,D,ye,G,U,W]),fe=(0,C().A)(G,500,300);if(!Y)return null;const ve=[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,_.jsx)("div",{children:(0,_.jsx)(M().Ay,{...e,inputLeft:(0,_.jsx)(M().Zf,{icon:p().q}),inputRight:fe&&(0,_.jsx)(j().A,{style:{marginRight:2}}),showClearButton:!0,placeholder:x().A.formatMessage(I.channelSearchPlaceholder),focusInitial:!K,value:U,onChange:e=>{$(e.target.value)}})})}],render:e=>(0,_.jsx)(P().A,{...e})},...he()];return t||B||!X||ve.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!Z)return;const e=await v().Jq({environment:L,integration:X,spaceId:Z,from:"collection_view_settings"});y().Q.isFail(e)||c()},render:e=>(0,_.jsx)(T().A,{...e,icon:(0,_.jsx)("img",{src:l().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,_.jsx)(m().sA,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,_.jsx)(P().A,{...e,topBorder:!0})}),(0,_.jsx)(_.Fragment,{children:d(ve)})}function V(){return(0,i().IS)((e=>({icon:{marginLeft:8,width:12,height:12,color:e.text.tertiary},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor}})),[])}function R(e){const{channelName:t,query:o}=e;return 0===o.length||t.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0}function N(e){const{channel:t,styles:o}=e;return"private"===t.type?(0,c().S)(o):"me"===t.type||"im"===t.type?(0,u().b)(o):(0,d().E)(o)}const B=15e3;function F(e){return(0,a().K8)((()=>{if(!e)return{loadedChannelsForAccount:[],isLoading:!1};const t=A().c.getStateForBot(e);return{loadedChannelsForAccount:Object.values(t.channels),isLoading:t.fetching}}),[e])}async function E(e){const{environment:t,externalAuthConfig:o,spaceId:r}=e,n=A().c.getStateForBot(o);if(!(n.fetching||Date.now()-n.lastRefreshed<B)){if(A().c.updateStateForBot(o,{fetching:!0,lastRefreshed:Date.now()}),"workflow"===o.type){const e=await f().callApi({eventName:"getExternalNotificationChannels",environment:t,data:{spaceId:r,cursor:void 0,...o}});if("success"===e.type){const t={};for(const o of e.data.channels)t[o.id]=o;A().c.addChannelsForBot(o,t)}}else{let e;for(;;){const n=await f().callApi({eventName:"getExternalNotificationChannels",environment:t,data:{spaceId:r,cursor:e,...o}});if("success"!==n.type){console.error(n.error);break}{const t={};for(const e of n.data.channels)t[e.id]=e;if(A().c.addChannelsForBot(o,t),e=n.data.cursor,!e)break}await new Promise((e=>setTimeout(e,0)))}}A().c.updateStateForBot(o,{fetching:!1})}}const O=r.forwardRef(((e,t)=>{const{channel:o,currentNotificationChannels:r,...n}=e,a=V();return(0,_.jsx)(T().A,{ref:t,...n,icon:N({channel:o,styles:a.icon}),desktopIconStyle:{width:8},title:o.name,isChecked:null==r?void 0:r.some((e=>e.id===o.id))})}));O.displayName="SlackChannelMenuItem"},301148:(e,t,o)=>{o.d(t,{G:()=>l});o(242343);var r=()=>o(174114),n=()=>o(220413),a=()=>o(31448),i=o(163643);function l(e){const{children:t,icon:o,shouldTruncateChildren:l}=e,s=(0,r().IS)((e=>{const t=(0,n().LD)(e,void 0);return{iconWrap:{flex:"0 0 auto"},textWrap:{...l?a().RC:{},flex:"1 1 auto"},wrap:{backgroundColor:t.backgroundColor,borderRadius:12,color:t.textColor,display:"inline-flex",gap:4,minWidth:l?50:void 0,padding:"0 8px"}}}),[l]);return(0,i.jsxs)("span",{style:s.wrap,children:[o&&(0,i.jsx)("span",{"aria-hidden":"true",style:s.iconWrap,children:o}),(0,i.jsx)("span",{style:s.textWrap,children:t})]})}},320856:(e,t,o)=>{o.d(t,{U:()=>n});var r=()=>o(174114);function n(){return(0,r().IS)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[])}},353313:(e,t,o)=>{o.d(t,{A:()=>H});o(362833),o(403517);var r=o(242343),n=()=>o(237385),a=()=>o(174114),i=(o(725707),o(491955),o(500234),()=>o(803290)),l=()=>o(564134),s=()=>o(807912),u=()=>o(465546),c=()=>o(630714),p=()=>o(162901),d=()=>o(34662),m=()=>o(653998),g=()=>o(188877),y=()=>o(975392),h=()=>o(523365),f=()=>o(128192),v=()=>o(485951),x=()=>o(797715),S=()=>o(129978),b=()=>o(509484),C=()=>o(359441),k=()=>o(210466),A=()=>o(237692),T=()=>o(373703),M=()=>o(752903),j=()=>o(82954),P=()=>o(271142),_=o(163643);function I(e){let{handleRemoveToken:t,isDisabled:o,token:a}=e;const i=(0,n().Y0)(),{automationStore:l}=(0,P().EC)(),s=(0,r.useCallback)((()=>{t&&t(a)}),[t,a]),u=(0,d().i$F)(a);if(!u)return null;const c=u.id;return(0,_.jsx)(j().A,{blockId:c,format:i.isMobile?M().NY.Medium:M().NY.Small,isSingle:!1,onClickRemove:s,parentStore:l,shouldShrink:!0,shouldWrap:!1,showRemoveButton:!o},c)}var w=()=>o(640979),V=()=>o(935091),R=()=>o(858023),N=()=>o(975515),B=()=>o(743668),F=()=>o(88271),E=()=>o(24e3),O=()=>o(360234),D=()=>o(145017),W=()=>o(413871),L=()=>o(701513);function K(e){let{annotation:t,isChecked:o,menuArgs:r}=e;const{automationStore:n}=(0,P().EC)(),a=(0,i().K8)((()=>{if((0,c().isAnnotationSimpleValueToken)(t)&&(0,d().jIt)(t))return(0,d().i$F)(t)}),[t]);if(!a)return null;const l=a.id,s=W().Bv.createChildStore(n,{id:l,table:D().ev});return(0,_.jsx)(L().A,{store:s,isChecked:o,hidePath:!0,...r})}function H(e){const{action:t,collection:o,currentSimpleFormulaValueTokens:M,formulaTypecheckContextValues:j,formulaValueContext:P,menuProps:D,onChange:W,onClose:L,showClearButton:H=!1,showFormulaValueItems:q=!1,showGenericHeader:z=!1,showInputMenuItem:Y=!1,showReplaceAddRemoveToggle:U=!1,value:$,parentRecordStore:Q}=e,G=(0,n().Y0)(),X=(0,a().IS)((e=>({genericHeader:{paddingBottom:0},replaceAddRemoveToggleButton:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}})),[]),{footer:Z,header:J,menuListStore:ee,noResultsMessage:te,searchInput:oe,pageItems:re,replaceAddRemoveToggleButton:ne,valueItems:ae}=function(e){var t,o;const{action:a,collection:M,formulaTypecheckContextValues:j,formulaValueContext:P,onChange:w,onClose:V,showClearButton:R,showReplaceAddRemoveToggle:N,unlimitedCurrentSimpleFormulaValueTokens:B,value:F}=e,E=(0,n().v3)(),O=(0,n().Y0)(),D=(0,m().tz)(),{collectionStore:W,property:L}=P,K=(0,h().pg)(P),H=(0,i().K8)((()=>W.getSchema()[L]),[W,L]),q=(0,r.useMemo)((()=>{const e="relation"===(null==H?void 0:H.type)?(0,l().Nv)(H):void 0;return j.filter((t=>(0,u().o5)(t.type,{type:"block",collection:e},!0)))}),[j,H]),[z,Y]=(0,r.useState)(""),U=(0,i().uB)(void 0,k().A),$=(0,i().K8)((()=>!!(W&&L&&H&&(0,l().sO)(H))&&1===H.limit),[W,L,H]),Q=(0,S().fJ)(b().T.searchActions),[G]=(0,p().Yb)((async()=>{const e=z?(0,g().Ay)(z,q,(e=>e.kind===s().FormulaContextValueKind.ContextValue?e.name:"")):q;if("resolved"!==Q.status||!M)return;const t=Q.value,{results:o}=await t.searchPagesInCollection({environment:E,query:z,collectionId:M.id,limit:20,spaceId:M.spaceId,excludeTemplates:!0,source:"simple_formula_value_page_search",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});return{valueResults:e,pageResults:o}}),[z,q,Q.status,Q.value,M,E],{debounce:C().tu}),X=K(B,"first").filter((e=>{if("string"!=typeof e&&"boolean"!=typeof e&&(0,d().jIt)(e)){var t,o;const r=null===(t=(0,d().i$F)(e))||void 0===t?void 0:t.id;if(r&&null!=G&&null!==(o=G.value)&&void 0!==o&&o.pageResults.includes(r))return!0}return!0})),Z=(0,r.useCallback)((()=>{Y(""),U.setState({...U.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[U]),J=(0,r.useCallback)(((e,t)=>{w(e||F,t||a)}),[a,w,F]),ee=(0,r.useCallback)((e=>{const t=K(e,"last");J({type:"simple",value:(0,c().toSimpleFormulaArrayValue)(t)}),Z(),$&&V()}),[K,J,Z,$,V]),te=(0,r.useCallback)((()=>{ee(X.slice(0,X.length-1))}),[X,ee]),oe=(0,r.useCallback)((e=>{null==ee||ee((0,c().simpleFormulaValueWithoutToken)(X,e))}),[X,ee]),re=y().oE(X.map(((e,t)=>"string"==typeof e||"boolean"==typeof e?null:(0,d().s1Y)(e)?(0,_.jsx)(T().A,{formulaTypecheckContextValues:j,handleRemoveToken:oe,isDisabled:!1,token:e},t):(0,d().jIt)(e)?(0,_.jsx)(I,{handleRemoveToken:oe,isDisabled:!1,token:e},t):null))),ne=(0,_.jsx)("div",{style:{...!O.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,_.jsx)(x().Ay,{focus:!O.isMobile||void 0,focusAfterAnimation:!0,format:x().le.FilterValue,tokens:re,placeholder:D.formatMessage(f().D.pageSearchPlaceholder),onRemoveLastToken:te,onClearButtonClick:()=>ee([]),value:z,onChange:e=>Y(e.target.value),dontShowBorderBottom:O.isAndroid,showClearButton:R})}),ae=(0,_.jsx)(v().A,{value:F,onChange:J}),ie=(0,_.jsx)(A().A,{action:a,handleOnChange:J}),le=y().oE(((null===(t=G.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===s().FormulaContextValueKind.ContextValue&&e.id||"",o=Boolean(X.find((e=>(0,c().isAnnotationSimpleValueToken)(e)&&(0,d().s1Y)(e)&&(0,d().iVq)(e).id===t)));return{action:"append",checkType:$?"single":"multi",isChecked:o,currentSimpleFormulaValueTokens:X,id:t,setCurrentTokens:ee,value:e}}))),se=y().oE(((null===(o=G.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(X.find((t=>{var o;return(0,c().isAnnotationSimpleValueToken)(t)&&(0,d().jIt)(t)&&(null===(o=(0,d().i$F)(t))||void 0===o?void 0:o.id)===e})));if(M){const o=(0,d().ld4)(e,M.spaceId);return{action:()=>{ee(t?(0,c().simpleFormulaValueWithoutToken)(X,o):[...X,o])},isChecked:t,checkType:$?"single":"multi",annotation:o,id:e}}}))),ue=[...le,...se];return{footer:ae,header:D.formatMessage(f().D.genericMenuHeader),menuListStore:U,noResultsMessage:0===ue.length&&G.value&&D.formatMessage(f().D.noResults),replaceAddRemoveToggleButton:Boolean(N)&&ie,searchInput:ne,pageItems:se,valueItems:le}}({action:t,collection:o,formulaTypecheckContextValues:j,formulaValueContext:P,onChange:W,onClose:L,showClearButton:H,showReplaceAddRemoveToggle:U,unlimitedCurrentSimpleFormulaValueTokens:M,value:$})||{},ie=[...(0,r.useMemo)((()=>q?ae.map((e=>{const{annotation:t,itemAction:o}=(0,O().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,_.jsx)(E().A,{annotation:t,isChecked:e.isChecked,disabled:!1,formulaTypecheckContextValues:j,menuArgs:o,parentRecordStore:Q}),action:o}})):[]),[j,q,ae,Q]),...(0,r.useMemo)((()=>re?re.map((e=>({key:e.id,render:t=>(0,_.jsx)(K,{annotation:e.annotation,isChecked:e.isChecked,menuArgs:t}),action:e.action}))):[]),[re])],le=[];let se;ie.length>0&&le.push({key:"values",render:e=>(0,_.jsx)(F().A,{...e}),items:ie}),se=G.isMobile?{menuType:w().gu.Modal,right:(0,_.jsx)(B().DoneMenuText,{}),onClickRight:L,minWidth:260,footer:Z&&(0,_.jsx)(F().A,{topBorder:!0,children:Z})}:{menuType:w().gu.Popup,maxHeight:"50vh",width:260,footer:Z&&(0,_.jsx)(F().A,{topBorder:!0,children:Z}),disableHeaderBorder:!0};const ue=z&&(0,_.jsx)(F().A,{style:X.genericHeader,title:J}),ce=(0,_.jsxs)(_.Fragment,{children:[!G.isMobile&&((null==D?void 0:D.header)||ue),Y&&(0,_.jsx)(F().A,{children:oe})]}),pe=(0,_.jsxs)(_.Fragment,{children:[ne&&(0,_.jsx)("div",{style:X.replaceAddRemoveToggleButton,children:ne}),te&&(0,_.jsx)(F().A,{children:(0,_.jsx)(N().A,{title:te})}),ie.length>0&&(0,_.jsx)(R().Ay,{type:R().Oh.Vertical,initialFocus:0,sections:le,store:ee})]});return{headerDiv:ce,innerComponents:pe,relationMenu:(0,_.jsx)(V().A,{...se,...D,header:ce,children:pe})}}},355149:(e,t,o)=>{o.d(t,{Z:()=>c});var r=()=>o(975392),n=()=>o(76394),a=()=>o(427091),i=()=>o(21164),l=()=>o(81085);const s={type:"button",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,contextType:a,getRecordModel:s,intl:u}=e,c=l().Fz.compile(u),p=l().vm.compile(u),d=l().Eo.compile(u),m=t.getParentPointer();let g,y;if("button_block"===a){if(e.pageBlockModel){const t=(0,o(103265).SH)({block:e.pageBlockModel,getRecordModel:s});t&&(g=l().M4.compile(u,t.pointer),y=l().YW.compile(u))}}else if("button_property"===a){const e=s(m);if((null==e?void 0:e.table)!==i().Vl)return{error:new(o(232312).N9)(`Unable to load automation parent: ${o(293665).L3.toKey(m)}`)};g=l().M4.compile(u,e.pointer),y=l().YW.compile(u)}else(0,n().HB)(a);return{value:{valueTypes:(0,r().oE)([c,p,d,g,y])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:n,thisPageBlockModel:i}=t??{},s=i?l().M4.evaluate(i.pointer):void 0,u=null==i?void 0:i.getCreatedByPointer(),c=u?l().YW.evaluate(u):void 0,p=o?l().Fz.evaluate(o):void 0,d=(0,a().P)(),m=l().vm.evaluate(n??d),g=l().Eo.evaluate(n??d);return{value:{values:(0,r().oE)([s,c,p,m,g])}}},isAvailableForContext:e=>!0};o(362833);const u={button:s,event:{type:"event",getCreatePermissions(e){const{parentPointer:t,spacePointer:o}=e;return[{minimumRole:"editor",pointer:t,type:"record_permission"},{minimumRole:"read_and_write",pointer:o,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e,r=[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}],a=t.getTrigger();if("event"===a.type){const e=a.event;(0,n().O9)(e.source)&&"filter"!==e.source.type&&(e.source.type===i().Vl||e.source.type===o(289765).Gy?r.push({minimumRole:"reader",pointer:e.source.pointer,type:"record_permission"}):(0,n().HB)(e.source))}return r},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,intl:o}=e,n=l().mO.compile(o),a=l().iY.compile(o),s=l().vm.compile(o),u=l().Eo.compile(o),c=t.getParentPointer();let p;return c.table===i().Vl&&(p=l().qE.compile(o,c)),{value:{valueTypes:(0,r().oE)([n,a,s,u,p])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:i,thisPageBlockModel:s}=t??{},u=s?l().qE.evaluate(s.pointer):void 0,c=o?l().mO.evaluate(o):void 0,p=(0,a().P)(),d=l().vm.evaluate(i??p),m=null==s?void 0:s.getCreatedByPointer(),g=(0,n().O9)(m)?l().iY.evaluate(m):void 0,y=l().Eo.evaluate(i??p);return{value:{values:(0,r().oE)([u,c,d,y,g])}}},isAvailableForContext:e=>e.hasAccessToSlackAction},recurrence:{type:"recurrence",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{intl:t}=e;return{value:{valueTypes:[l().vm.compile(t),l().Eo.compile(t)]}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserTimeZone:o}=t??{},r=(0,a().P)();return{value:{values:[l().vm.evaluate(o??r),l().Eo.evaluate(o??r)]}}},isAvailableForContext(e){const{automation:t,automationActions:r,hasPremiumAutomations:a}=e;if(t.parent_table===o(145017).ev)return!0;if(t.parent_table===i().Vl){const e=o(220574).RecordMap.create();for(const t of r)e.addModel(t);return!!t.isCompleteSprintAutomation({getRecordModel:o(769884).b4_.fromRecordMap(e)})||a}(0,n().HB)(t.parent_table)}}};function c(e){return u[e]}},360234:(e,t,o)=>{o.d(t,{E:()=>i});o(610931),o(725707),o(500234);var r=()=>o(807912),n=()=>o(630714),a=()=>o(34662);function i(e){const{action:t,currentSimpleFormulaValueTokens:o,onCheckboxClick:i,setCurrentTokens:l,value:s}=e;if(s.kind!==r().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");const u=Boolean(o.find((e=>(0,n().isAnnotationSimpleValueToken)(e)&&(0,a().s1Y)(e)&&(0,a().iVq)(e).id===s.id))),c=(0,a().CA$)({id:s.id});return{annotation:c,isChecked:u,itemAction:()=>{l("append"===t?u?(0,n().simpleFormulaValueWithoutToken)(o,c):[...o,c]:[c]),null==i||i()}}}},363043:(e,t,o)=>{o.d(t,{c:()=>i,m:()=>n});function r(e){switch(e.type){case"external":return`external-${e.botId}`;case"workflow":return`workflow-${e.workflowExternalAuthenticationId}`;case"universal":return`universal-${e.app}-${e.spaceId}`;default:throw(0,o(76394).HB)(e)}}const n={channels:{},fetching:!1,lastRefreshed:0};class a extends(()=>o(129044))().default{getStateForBot(e){const t=r(e);return this.state[t]??n}updateStateForBot(e,t){this.setState({...this.state,[r(e)]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const o=this.getStateForBot(e);this.setState({...this.state,[r(e)]:{...o,channels:{...o.channels,...t}}})}}const i=new a;(0,o(996094).exposeDebugValue)("ExternalNotificationChannelsStore",i)},369678:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkTriangleFillSmallIcon:()=>n,iconDefinition:()=>r});o(242343);const r={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"M9.516 2.825c-.674-1.167-2.358-1.167-3.031 0l-4.677 8.1c-.673 1.167.168 2.625 1.516 2.625h9.353c1.347 0 2.189-1.458 1.515-2.625zM7.9 5.356a.55.55 0 0 1 .55.55v2.5a.55.55 0 0 1-1.1 0v-2.5a.55.55 0 0 1 .55-.55m0 6a.65.65 0 1 1 0-1.3.65.65 0 0 1 0 1.3"})},n=(0,o(680369).wt)("exclamationMarkTriangleFillSmall",r)},373703:(e,t,o)=>{o.d(t,{A:()=>u});o(242343);var r=()=>o(752903),n=()=>o(465546),a=()=>o(34662),i=()=>o(76394),l=()=>o(434406),s=o(163643);function u(e){let{formulaTypecheckContextValues:t,handleRemoveToken:o,isDisabled:u,token:c,style:p,iconSize:d,preventOnClickPropagation:m}=e;const g=(0,a().iVq)(c).id,y=(0,i().O9)(t)?(0,n().IV)(t,g):void 0;return y?(0,s.jsx)(l().F,{value:y,format:r().NY.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!u,style:p,onClickRemove:e=>{m&&(null==e||e.stopPropagation()),o(c,e)}}):null}},387652:(e,t,o)=>{o.d(t,{A:()=>p});o(242343);var r=()=>o(237385),n=()=>o(174114),a=()=>o(752903),i=()=>o(723361),l=()=>o(653998),s=()=>o(809785),u=()=>o(275334),c=o(163643);function p(e){let{key:t,tokenFormat:o=a().NY.Medium,isSingle:p,showRemoveButton:d,onClickRemove:m}=e;const{isMobile:g}=(0,r().Y0)(),y=(0,l().tz)(),h=(0,n().IS)((e=>{const t="light"===e.mode?400:800,o="light"===e.mode?50:200,r="light"===e.mode?700:900;return{tokenValueWrap:{display:"inline-flex",gap:"4px",alignItems:"baseline"},warning:{color:e.accentColors.orange[t],height:"auto",width:g?16:14},warningWrap:{alignSelf:"center"},token:{backgroundColor:e.accentColors.yellow[o]},textWrap:{color:e.accentColors.yellow[r]}}}),[g]);return(0,c.jsx)(s().A,{format:o,isSingle:p??!0,showRemoveButton:d??!1,onClickRemove:m,style:h.token,value:(0,c.jsxs)("span",{style:h.tokenValueWrap,children:[(0,c.jsx)("span",{style:h.warningWrap,children:(0,i().Q)(h.warning)}),(0,c.jsx)("span",{style:h.textWrap,children:(0,u().iy)(y)})]})},t)}},400383:(e,t,o)=>{o.d(t,{A5:()=>w,Ol:()=>V,qM:()=>I});o(725707),o(491955),o(500234);var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(644540),l=()=>o(686752),s=()=>o(836693),u=()=>o(653998),c=()=>o(76394),p=()=>o(337658),d=()=>o(521325),m=()=>o(535906),g=()=>o(935091),y=()=>o(858023),h=()=>o(397791),f=()=>o(88271),v=()=>o(749975),x=()=>o(264022),S=()=>o(73631),b=()=>o(475923),C=()=>o(129978),k=()=>o(56432),A=()=>o(271142),T=()=>o(738355),M=()=>o(830925),j=()=>o(441911),P=()=>o(466207),_=o(163643);function I(e){const{actionId:t,closeMenu:o,propertyId:i}=e,{maybePersistedTransactionActions:l}=(0,T().b)(),{automationStore:s,contextType:c}=(0,A().EC)(),m=(0,v().Ks)(),g=(0,n().v3)(),y=(0,u().tz)(),{value:h}=(0,C().fJ)(S().T.formulas),{value:f}=(0,C().fJ)(p().QV.automationTypecheck),j=(0,M().n)(s),P=(0,a().K8)((()=>null==m?void 0:m.settingsStore),[m]),I=(0,a().K8)((()=>m&&(0,b().ZI)({collectionContextStore:m,timelineViewTab:"timeline"})),[m]),w=(0,a().K8)((()=>{const e=s.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[s,t]),R=(0,r.useCallback)((()=>{w&&h&&f&&(l.createAndCommit({perform:e=>{k().removeAutomationAction({actionStore:w,automationStore:s,automationTypecheckModule:f,contextType:c,environment:g,formulasModule:h,intl:y,isSubscribed:j,transaction:e})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[w,s,o,c,g,y,l,h,f,j]),N=(0,r.useMemo)((()=>{if(P&&I&&i)return async function(){await(0,x().lT)({hasPendingChanges:!0})&&d().a2({collectionSettingsStore:P,item:{type:"property",formatKey:I,property:i}}),null==o||o()}}),[o,P,I,i]);return(0,_.jsx)(V,{onDelete:R,onEdit:N,stepType:"action"})}function w(e){const{closeMenu:t,propertyId:o}=e,n=(0,v().Ks)(),{removePropertyTrigger:i}=(0,P().p)(),l=(0,a().K8)((()=>null==n?void 0:n.settingsStore),[n]),s=(0,a().K8)((()=>n&&(0,b().ZI)({collectionContextStore:n,timelineViewTab:"timeline"})),[n]),u=(0,r.useCallback)((()=>{i(o),null==t||t()}),[t,o,i]),c=(0,r.useMemo)((()=>{if(l&&s&&o)return async function(){await(0,x().lT)({hasPendingChanges:!0})&&d().a2({collectionSettingsStore:l,item:{type:"property",formatKey:s,property:o}}),null==t||t()}}),[t,l,s,o]);return(0,_.jsx)(V,{onDelete:u,onEdit:c,stepType:"trigger"})}function V(e){const{onDelete:t,onEdit:o,onRestore:n,stepType:a}=e,p=(0,j().e)({width:266}),d=(0,r.useMemo)((()=>(0,c().O9)(o)?{action:o,key:"edit-property-menu-item",render:e=>(0,_.jsx)(m().A,{...e,icon:(0,_.jsx)(h().I,{icon:l().pencilLineIcon}),title:(0,_.jsx)(u().sA,{defaultMessage:"Edit property",id:"unsupportedPropertyMenu.editMenuItem.title"})})}:void 0),[o]),v=(0,r.useMemo)((()=>(0,c().O9)(n)?{action:n,key:"restore-property-menu-item",render:e=>(0,_.jsx)(m().A,{...e,icon:(0,_.jsx)(h().I,{icon:i().arrowUTurnUpLeftIcon}),title:(0,_.jsx)(u().sA,{defaultMessage:"Restore property",id:"unsupportedPropertyMenu.restoreMenuItem.title"})})}:void 0),[n]),x=(0,r.useMemo)((()=>(0,c().O9)(t)?{action:t,key:"delete-property-menu-item",render:e=>(0,_.jsx)(m().A,{...e,icon:(0,_.jsx)(h().I,{icon:s().trashIcon}),title:"action"===a?(0,_.jsx)(u().sA,{id:"automationUnsupportedPropertyMenu.deleteAction.title",defaultMessage:"Delete action"}):(0,_.jsx)(u().sA,{id:"automationUnsupportedPropertyMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})}:void 0),[t,a]);return(0,_.jsx)(g().A,{...p,children:(0,_.jsx)(y().Ay,{initialFocus:0,sections:[{key:"actions-section",items:[d,v,x].filter(c().O9),render:e=>(0,_.jsx)(f().A,{...e})}],type:y().Oh.Vertical})})}},403172:(e,t,o)=>{o.d(t,{w5:()=>m,zl:()=>g});o(242343);var r=()=>o(803290),n=()=>o(174114),a=()=>o(752903),i=()=>o(653998),l=()=>o(76394),s=()=>o(31448),u=()=>o(809785),c=()=>o(275334),p=()=>o(258146),d=o(163643);function m(e){const{textValue:t,operator:o,propertySchema:m,messageType:y}=e,h=(0,i().tz)(),f=(0,n().IS)((()=>({content:{alignItems:"center",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium},propertyValue:{...s().RC,paddingBlockStart:4}})),[]),v=(0,r().K8)((()=>function(e){const{textValue:t,operator:o,propertySchema:r,styles:n,messageType:s,intl:m}=e,g=(0,d.jsx)("span",{style:n.propertyName,children:r.name});let y;const h=m.formatMessage(p().bK[o].text).toLocaleLowerCase();"action"===s?y=c().$B({operator:h,propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1})}):"trigger"===s?y=c().rh({operator:h,propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1})}):(0,l().HB)(s);return(0,d.jsx)(i().sA,{...y})}({messageType:y,operator:o,propertySchema:m,styles:f,textValue:t,intl:h})),[y,t,o,m,f,h]);return{tooltipTitle:(0,r().K8)((()=>g({messageType:y,operator:o,propertySchema:m,textValue:t,intl:h})),[y,o,m,t,h]),title:v,styles:f}}function g(e){const{textValue:t,operator:o,propertySchema:r,messageType:n,intl:a}=e,s=r.name;let u;const m=a.formatMessage(p().bK[o].text).toLocaleLowerCase();return"action"===n?u=c().$B({operator:m,propertyName:s,propertyValues:t}):"trigger"===n?u=c().rh({operator:m,propertyName:s,propertyValues:t}):(0,l().HB)(n),(0,d.jsx)(i().sA,{...u})}},403321:(e,t,o)=>{o.d(t,{Iq:()=>P,UW:()=>T,WE:()=>w,eg:()=>I,oE:()=>M,xL:()=>A});o(725707),o(491955),o(403517),o(113085),o(242343);var r=()=>o(237385),n=()=>o(803290),a=()=>o(174114),i=()=>o(15552),l=()=>o(716605),s=()=>o(752903),u=()=>o(465546),c=()=>o(630714),p=()=>o(145017),d=()=>o(34662),m=()=>o(653998),g=()=>o(76394),y=()=>o(31448),h=()=>o(434406),f=()=>o(82954),v=()=>o(92451),x=()=>o(413871),S=()=>o(604104),b=()=>o(387652),C=()=>o(275334),k=o(163643);function A(e){const{automationContextValues:t,messageType:o,propertySchema:i,value:l}=e,s=(0,m().tz)(),u=(0,r().v3)(),c=(0,n().K8)((()=>l?P({automationContextValues:t,limit:i.limit,value:l}):[]),[t,i.limit,l]),p=(0,a().IS)((()=>({content:{alignItems:"center",display:"flex",flex:"1 1 auto",flexWrap:"wrap",minWidth:0,whiteSpace:"pre",lineHeight:1.6},operatorContent:{alignItems:"center",flexWrap:"wrap",gridGap:"1px"},propertyName:{...y().RC,fontWeight:y().Wy.semibold,minWidth:20},propertyValue:{...y().RC,minWidth:40},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:10,width:"100%"},propertyValueListItem:{display:"flex"},and:{marginRight:"4px",marginLeft:"4px"}})),[]),d=(0,n().K8)((()=>{if("action"===o)return function(e){const{intl:t,collectionStore:o,operator:r,propertySchema:n,relationPages:a,styles:i,value:l}=e,s=(0,k.jsx)("span",{style:i.propertyName,children:n.name});let u;const c="formula"===(null==l?void 0:l.type);u=c?(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(m().sA,{...C().uW({propertyName:s,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(S().g,{returnType:{type:"block"}})})})})}):"replace"===r||"append"===r||"remove"===r||"toggle"===r?(0,k.jsx)("div",{style:{...i.content,...i.operatorContent},children:(0,k.jsx)(m().sA,{...C().f4({...C().f_({elements:a.map(((e,t)=>(0,k.jsx)(j,{propertySchema:n,collectionStore:o,value:e},t))),intl:t}),operator:r,propertyName:s})})}):0===a.length?(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(m().sA,{...C().NW({propertyName:s})})}):(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(m().sA,{...C().uW({propertyName:s,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(j,{collectionStore:o,value:a[0],propertySchema:n})})})})});return u}({collectionStore:e.collectionStore,intl:s,operator:e.operator,propertySchema:e.propertySchema,relationPages:c,styles:p,value:e.value});if("trigger"===o){const{collectionStore:t,filter:o,propertySchema:r}=e;return function(e){const{availableTokens:t,collectionStore:o,operator:r,propertySchema:n,relationPages:a,styles:i}=e,l=(0,k.jsx)("span",{style:i.propertyName,children:n.name});let s;if(1===a.length){const e="relation_contains"===r?C().TF:C()._f;s=(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(m().sA,{...e({propertyName:l,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(j,{availableTokens:t,collectionStore:o,propertySchema:n,value:a[0]})})})})})}else{const e="relation_contains"===r?C().JQ:C().SV;s=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(m().sA,{...e({propertyName:l,propertyValue:[]})})}),(0,k.jsx)("ul",{style:i.propertyValueList,children:a.map(((e,r)=>(0,k.jsx)("li",{style:i.propertyValueListItem,children:(0,k.jsx)(j,{availableTokens:t,collectionStore:o,propertySchema:n,value:e})},r)))})]})}return s}({availableTokens:o?I({collectionStore:t,filter:o,propertySchema:r}):void 0,collectionStore:e.collectionStore,operator:e.operator,propertySchema:e.propertySchema,relationPages:c,styles:p})}(0,g().HB)(o)}),[e,s,o,c,p]);return{tooltipTitle:(0,n().K8)((()=>{if("action"===o)return T({collectionStore:e.collectionStore,environment:u,intl:s,operator:e.operator,propertySchema:i,relationPages:c,value:e.value});if("trigger"===o){const{collectionStore:t,filter:o,propertySchema:r}=e;return M({availableTokens:o?I({collectionStore:t,filter:o,propertySchema:r}):void 0,collectionStore:e.collectionStore,environment:u,intl:s,operator:e.operator,propertySchema:e.propertySchema,relationPages:c})}(0,g().HB)(o)}),[e,u,s,o,i,c]),title:d,styles:p}}function T(e){const{collectionStore:t,environment:o,intl:r,operator:n,propertySchema:a,relationPages:i,value:l}=e,s=a.name;if("formula"===(null==l?void 0:l.type))return(0,k.jsx)(m().sA,{...C().uW({propertyName:s,propertyValue:(0,k.jsx)(S().L,{})})});const c=i.map((e=>{if("string"==typeof e){const n=x().Bv.createChildStore(t,{id:e,table:p().ev});return(0,v().tS)({environment:o,intl:r,store:n})}return(0,u().sM)(e)})).filter(g().O9),d=1===c.length?c[0]:r.formatList(c,{style:"long",type:"conjunction"});let y;return y="replace"===n||"append"===n||"remove"===n||"toggle"===n?C().f4({propertyName:s,propertyValue:d,operator:n}):0===c.length?C().NW({propertyName:s}):C().uW({propertyName:s,propertyValue:d}),(0,k.jsx)(m().sA,{...y})}function M(e){const{availableTokens:t,collectionStore:o,environment:r,intl:n,operator:a,propertySchema:i,relationPages:l}=e,s=l.map((e=>{if("string"==typeof e){if(!t||t.some((t=>t.id===e))){const t=x().Bv.createChildStore(o,{id:e,table:p().ev});return(0,v().tS)({environment:r,intl:n,store:t})}return C().iy(n)}return(0,u().sM)(e)})).filter(g().O9),c=i.name,d=1===s.length?s[0]:n.formatList(s,{style:"long",type:"conjunction"});let y;if(1===s.length){y=("relation_contains"===a?C().TF:C()._f)({propertyName:c,propertyValue:d})}else{y=("relation_contains"===a?C().JQ:C().SV)({propertyName:c,propertyValue:d})}return(0,k.jsx)(m().sA,{...y})}function j(e){const{availableTokens:t,collectionStore:o,value:r}=e;return!t||t.some((e=>e.id===r))?"string"==typeof r?(0,k.jsx)(f().A,{blockId:r,format:s().NY.Medium,isSingle:!0,noUnderline:!0,parentStore:o,shouldShrink:!0}):(0,k.jsx)(h().F,{format:s().NY.Medium,isSingle:!0,shouldShrink:!0,value:r}):(0,k.jsx)(b().A,{tokenFormat:s().NY.Medium},`missing_option_value_${r}`)}function P(e){const{automationContextValues:t,limit:o,value:r}=e;if(!r)return[];return(0,c().fromSimpleFormulaArrayValue)(r.value).slice(0,o).map((e=>{if("string"!=typeof e&&"boolean"!=typeof e){if((0,d().s1Y)(e)){const o=(0,d().iVq)(e).id,r=(0,u().IV)(t,o);if(!r)return;return r}if((0,d().jIt)(e)){var o;const t=null===(o=(0,d().i$F)(e))||void 0===o?void 0:o.id;if(!t)return;return t}}})).filter(g().O9)}function _(e){const{collectionStore:t,filter:o}=e,r=(0,i().Rh)(o),n=t.getSpaceId();return r.map((e=>{if(e.value&&"string"==typeof e.value)return{table:"block",id:e.value,spaceId:n}})).filter(g().O9)}function I(e){const{collectionStore:t,filter:o,propertySchema:r}=e,n=_({collectionStore:t,filter:o});return(0,l().bG)({getRecordModel:t.getRecordModel,propertySchema:r,relationValue:n,includeNoAccess:!0})}function w(e){const{collectionStore:t,filter:o}=e,r=_({collectionStore:t,filter:o});return{action:"replace",value:{type:"simple",value:(0,l().Ap)(r)}}}},403323:(e,t,o)=>{o.r(t),o.d(t,{clockSmallIcon:()=>a,iconDefinition:()=>n});o(242343);var r=o(163643);const n={viewBox:"0 0 16 16",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M8 3.955a.625.625 0 0 0-.625.625v2.795H5.12a.625.625 0 1 0 0 1.25H8c.345 0 .625-.28.625-.625V4.58A.625.625 0 0 0 8 3.955"}),(0,r.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},a=(0,o(680369).wt)("clockSmall",n)},434406:(e,t,o)=>{o.d(t,{F:()=>p});o(242343);var r=()=>o(174114),n=()=>o(303472),a=()=>o(807912),i=()=>o(465546),l=()=>o(76394),s=()=>o(822606),u=()=>o(151258),c=o(163643);function p(e){const{value:t,style:o}=e,p=(0,r().DP)(),d=e.iconStyle??{width:12,height:12,marginRight:4},m=(0,i().sM)(t);let g;if(t.kind===a().FormulaContextValueKind.ContextValue&&(0,l().O9)(t.stepNumberForDisplay)){const e=t.stepNumberForDisplay;g=()=>(0,c.jsx)(s().Q,{size:n().H.ExtraSmall,number:e,style:{marginRight:4}})}else{const e=(0,i().Ix)(t.type);if(e){const t=e;g=()=>t(d)}}return(0,c.jsx)(u().Ay,{...e,title:m,renderAvatar:g,shouldShrink:!0,style:{background:p.outlineBlueButtonPressedBackground,color:p.blueColor,padding:"2px 4px",margin:0,...o}})}},453214:(e,t,o)=>{o.d(t,{y:()=>u});var r=()=>o(803290),n=()=>o(145017),a=()=>o(76394),i=()=>o(749975),l=()=>o(378219),s=()=>o(413871);function u(e,t){const o=(0,i().Ks)();return(0,r().K8)((()=>{const r=e.getParentStore();if("button_block"===t){const t=function(e){const t=(0,l().g7)(e);for(const o of t)if(o.table===n().ev&&o.isPageBlock())return o;return}(e);return null==t?void 0:t.getAssociatedCollectionStore()}if("button_property"===t)return null==o?void 0:o.collectionStore();if("event"===t){if(r&&r instanceof s().md)return r}else{if("recurrence"===t)return;if("assistant"===t){if(r&&r instanceof s().md)return r}else(0,a().HB)(t)}}),[e,t,o])}},466207:(e,t,o)=>{o.d(t,{p:()=>b});o(362833),o(725707),o(491955),o(500234),o(403517),o(113085);var r=o(242343),n=()=>o(237385),a=()=>o(114103),i=()=>o(564134),l=()=>o(214144),s=()=>o(653998),u=()=>o(76394),c=()=>o(337658),p=()=>o(759625),d=()=>o(84543),m=()=>o(73631),g=()=>o(137476),y=()=>o(950808),h=()=>o(129978),f=()=>o(56432),v=()=>o(738355),x=()=>o(830925);const S="all";function b(){const{automationStore:e,collectionStore:t,maybePersistedTransactionActions:o}=(0,v().k)(),{value:b}=(0,h().fJ)(c().QV.automationTypecheck),{value:k}=(0,h().fJ)(m().T.formulas),A=(0,n().v3)(),T=(0,s().tz)(),M=(0,x().n)(e),j=(0,r.useMemo)((()=>({automation_id:e.id,collection_id:t.id,builder_type:"modal"})),[e.id,t.id]),P=(0,r.useCallback)((()=>{var t;if(e.isTriggerType("recurrence"))return{currentPropertyTriggers:[],triggerOperator:S};const o=null===(t=e.getTrigger())||void 0===t?void 0:t.event.pagePropertiesEdited,r="some"===(null==o?void 0:o.type)&&o.some,n="all"===(null==o?void 0:o.type)&&o.all,a=(null==o?void 0:o.type)||"some";return r||n?{currentPropertyTriggers:r||n||[],triggerOperator:a}:{currentPropertyTriggers:[],triggerOperator:a}}),[e]),_=(0,r.useCallback)((function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,n=r||S;("none"===r||"any"===r&&t.length>0)&&(n=S),o.createAndCommit({userAction:"automations.removePropertyTrigger",perform:o=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:0===t.length?{type:"none"}:{type:n,[n]:t}}},transaction:o})}})}),[e,o]),I=(0,r.useCallback)((t=>{const{currentPropertyTriggers:r}=P();o.createAndCommit({userAction:"automations.updatePropertyTriggerOperator",perform:o=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:t,[t]:r}}},transaction:o})}})}),[e,P,o]);return{addPropertyTrigger:(0,r.useCallback)((e=>{const{currentPropertyTriggers:o,triggerOperator:r}=P();_([...o,e],r);const n=t.getSchema()[e.property];(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:r,property_types:null!=n&&n.type?[n.type]:[],property_configs:(0,u().O9)(e.filter.operator)&&(0,u().O9)(null==n?void 0:n.type)?[{operator:e.filter.operator,type:null==n?void 0:n.type}]:[]},...j}}})}),[j,t,A,P,_]),updatePropertyTrigger:(0,r.useCallback)((e=>{const{anyOptionCheckState:o,propertyId:r,currentFilter:n,propertySchema:a}=e,{currentPropertyTriggers:l,triggerOperator:s}=P();_((()=>{switch(o){case"partial":return C(l,(e=>e.property===r),(e=>({...e,filter:n})),{property:r,filter:n});case!0:return C(l,(e=>e.property===r),(e=>({...e,filter:{operator:"changes_to_any"}})),{property:r,filter:{operator:"changes_to_any"}});case!1:return(0,i().sS)(a)?C(l,(e=>e.property===r),(e=>({...e,filter:n})),{property:r,filter:n}):l.filter((e=>e.property!==r))}})(),s);const c=t.getSchema()[r];(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:s,property_types:null!=c&&c.type?[c.type]:[],property_configs:(0,u().O9)(n.operator)&&(0,u().O9)(null==c?void 0:c.type)?[{operator:n.operator,type:null==c?void 0:c.type}]:[]},...j}}})}),[j,t,A,P,_]),removePropertyTrigger:(0,r.useCallback)((e=>{const{currentPropertyTriggers:o,triggerOperator:r}=P();_(o.filter((t=>t.property!==e)),r);const n=t.getSchema()[e],a=o.find((t=>t.property===e));(0,g().u4)({environment:A,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"property",condition:r,property_types:null!=n&&n.type?[n.type]:[],property_configs:(0,u().O9)(a)&&(0,u().O9)(a.filter.operator)&&(0,u().O9)(null==n?void 0:n.type)?[{operator:a.filter.operator,type:null==n?void 0:n.type}]:[]},...j}}})}),[j,t,A,P,_]),addPageAddedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addPageAddedTrigger",perform:t=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!0}},transaction:t})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"page"},...j}}})}),[j,e,A,o]),removePageAddedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removePageAddedTrigger",perform:t=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!1}},transaction:t})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"page"},...j}}})}),[j,e,A,o]),addAnyPropertyEditedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addAnyPagePropertyEditedTrigger",perform:t=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:"any"}}},transaction:t})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:"any"},...j}}})}),[j,e,A,o]),removeAnyPropertyEditedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeAnyPropertyEditedTrigger",perform:t=>{d().applyOperation({store:e,operation:{path:["trigger","event"],args:{pagePropertiesEdited:{type:"none"}},pointer:e.pointer,command:"update"},transaction:t})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"property",condition:"any"},...j}}})}),[j,e,A,o]),updateTriggerOperator:I,addEmptyRecurrenceTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addEmptyRecurrenceTrigger",perform:t=>{p().KY({transaction:t,store:e.getKeyStore("trigger"),value:{type:"recurrence",id:l().JW()}}),b&&k&&(0,f().clearInvalidVariables)({environment:A,automationStore:e,automationTypecheckModule:b,contextType:"recurrence",formulasModule:k,intl:T,isSubscribed:M,transaction:t}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"recurrence"},...j}}})}})}),[e,b,k,T,o,j,A,M]),changeRecurrenceSchedule:(0,r.useCallback)((t=>{o.createAndCommit({userAction:"automations.changeRecurrenceSchedule",perform:o=>{p().zv({store:e.getKeyStore("trigger"),data:{recurrence:t?(0,a().convertFromUnpersistedRecurrenceConfig)(t):void 0},transaction:o})}})}),[e,o]),removeRecurrenceTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeRecurrenceTrigger",perform:o=>{p().KY({transaction:o,store:e.getKeyStore("trigger"),value:{type:"event",id:l().JW(),event:(0,y().B0)(t)}})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"recurrence"},...j}}})}),[j,e,t,A,o]),removeRelativeDateTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeRelativeDateTrigger",perform:t=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{relativeDate:void 0}},transaction:t})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"relative_date"},...j}}})}),[j,e,A,o]),addRelativeDateTrigger:(0,r.useCallback)((t=>{o.createAndCommit({userAction:"automations.addRelativeDateTrigger",perform:o=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{relativeDate:{property:t.propertyId,offset:{type:"days",hours:0}}}},transaction:o})}}),(0,g().u4)({environment:A,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"relative_date"},...j}}})}),[j,e,A,o]),updateRelativeDateTrigger:(0,r.useCallback)((t=>{o.createAndCommit({userAction:"automations.updateRelativeDateTrigger",perform:o=>{d().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{relativeDate:{property:t.propertyId,offset:t.offset}}},transaction:o})}})}),[e,o])}}function C(e,t,o,r){let n=!1;const a=e.map((e=>t(e)?(n=!0,o(e)):e));return n||a.push(r),a}},475077:(e,t,o)=>{o.d(t,{A:()=>s});var r=o(242343),n=()=>o(803290),a=()=>o(640979),i=()=>o(523365),l=o(163643);const s=(0,o(129978).Qz)(o(73631).T.formulas,((e,t)=>(0,l.jsx)(u,{...t,formulas:e})));function u(e){const{allowedReturnTypes:t,disabled:s,formulas:u,formulaTypecheckContextValues:c,onBack:p,onChange:d,onClose:m,parentRecordStore:g,restrictUnaccessibleProperties:y,spaceId:h,value:f}=e,v=(0,o(237385).Y0)(),x=(0,r.useCallback)((async()=>{if(p)return void p();if("simple"===(null==f?void 0:f.type))return void m();await(0,i().Cp)()?(d({type:"simple",value:null==f?void 0:f.value}),m()):m()}),[m,d,p,f]),S=(0,r.useCallback)((e=>{void 0!==e&&e[0][0].length?d({type:"formula",value:e}):d(void 0),m()}),[d,m]),b=(0,n().K8)((()=>{const e=(0,o(213517).i)(),r=(0,o(753123).MC)({collectionFeatureGates:e,experimentService:o(836331).default,getRecordModel:g.getRecordModel,loadRecordModel:g.loadRecordModel});return{allowedReturnTypes:t,handleDataRequest:r,restrictUnaccessibleProperties:y,spaceId:h,valueTypes:c,featureGates:e}}),[t,c,g.getRecordModel,g.loadRecordModel,h,y]),C=(0,n().K8)((()=>(0,i().pG)(f)),[f]);return b?(0,l.jsx)(o(935091).A,{disableBottomPadding:!0,disableHeaderBorder:!0,disableScroller:!0,hideMobileTopbar:!0,maxHeight:"unset",menuType:v.isMobile?a().gu.Modal:a().gu.Popup,width:v.isMobile?void 0:740,children:(0,l.jsx)(o(819249).v,{formulas:u,initialCode:C,typecheckContext:b,handleClose:S,handleCancel:x,parentSpaceId:h,disabled:s,focus:!0,evaluationErrors:[],getRecordModel:g.getRecordModel})}):null}},485951:(e,t,o)=>{o.d(t,{A:()=>c});var r=o(242343),n=()=>o(642053),a=()=>o(653998),i=()=>o(535906),l=()=>o(397791),s=()=>o(128192),u=o(163643);function c(e){const{value:t,onChange:o}=e,c=(0,r.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return(0,u.jsx)(i().A,{icon:(0,u.jsx)(l().I,{icon:n().K,color:"secondary"}),title:(0,u.jsx)(a().sA,{...s().D.customFormula}),focused:!1,showExtensionArrow:!0,onClick:c})}},523365:(e,t,o)=>{o.d(t,{Cp:()=>v,aS:()=>h,pG:()=>f,pg:()=>y});o(362833),o(725707),o(491955),o(244387);var r=o(242343),n=()=>o(803290),a=()=>o(564134),i=()=>o(871002),l=()=>o(696443),s=()=>o(531866),u=()=>o(34662),c=()=>o(653998),p=()=>o(76394),d=()=>o(31448),m=()=>o(145046),g=o(163643);function y(e){const t=(0,n().K8)((()=>{if("collection"!==e.type)return;const t=e.collectionStore.getSchema()[e.property];let o;return t&&(0,a().sO)(t)&&(o=t.limit),o}),[e]);return(0,r.useCallback)(((e,o)=>(0,p().O9)(t)?"first"===o?e.slice(0,t):"last"===o?e.slice(-t):void(0,p().HB)(o):e),[t])}function h(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||i().vz,timeFormat:o.time_format||i().CE}:{dateFormat:i().vz,timeFormat:i().CE}}function f(e){if("simple"===(null==e?void 0:e.type)&&e.value){const t=e.value.reduce(((e,t)=>{const o=e.length>0;if((0,u().bHQ)(t))!o&&(0,u()._g9)(t)||e.push((0,u().Ey_)(`"${t[0]}"`));else if((0,u().BEe)(t))e.push((0,u().Ey_)(`"${t[0]}"`));else if((0,u().qXl)(t)){const o=(0,u().uPN)(t),r=(0,u().jhx)(o);if(r){const t=o.filter((e=>!(0,u().jcO)(e)));e.push((0,u().wmz)(r,t))}}return e}),[]),o=(0,u().__s)((0,s().A)(t,(()=>(0,u().Ey_)(" + "))));return o.length>0?o:void 0}return null==e?void 0:e.value}async function v(){const{accept:e}=await m().Gh({acceptButtonType:"outline",acceptColor:void 0,acceptLabel:(0,g.jsx)(c().sA,{id:"formulaInputMenu.handleBack.convert",defaultMessage:"Convert"}),cancelButtonType:"outline",description:(0,g.jsx)(c().sA,{id:"formulaInputMenu.handleBack.description",defaultMessage:"Existing formula content will be lost"}),icon:(0,l().U)({fontWeight:d().Wy.semibold,height:36,width:36}),message:(0,g.jsx)(c().sA,{id:"formulaInputMenu.handleBack.message",defaultMessage:"Convert this variable from a formula to plain text?"})});return e}},533219:(e,t,o)=>{o.d(t,{Mh:()=>x,Zr:()=>f});var r=o(242343),n=()=>o(803290),a=()=>o(174114),i=()=>o(723361),l=()=>o(653998),s=()=>o(31448),u=()=>o(273520),c=()=>o(962373),p=()=>o(179701),d=()=>o(466207),m=()=>o(400383),g=()=>o(10872),y=()=>o(613152),h=o(163643);function f(e){const{propertySchema:t}=e,{property:o}=(0,r.useContext)(y()._B),{removePropertyTrigger:m}=(0,d().p)(),f=(0,a().IS)((e=>({content:{...s().RC,color:e.text.uiRedPrimary,fontWeight:s().Wy.medium,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},propertyName:{color:e.accentColors.red[700],fontWeight:s().Wy.semibold,whiteSpace:"nowrap"}})),[]),x=(0,p().j)(),b=(0,n().uB)(void 0,c().A),C=(0,r.useCallback)((()=>b.reset()),[b]),k=(0,r.useCallback)((()=>{m(o)}),[o,m]),A=function(e){const{propertySchema:t,styles:o}=e;return(0,h.jsx)(l().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation",id:"crossWorkspaceRelationPropertyTrigger.title",values:{propertyName:(0,h.jsx)("span",{style:o.propertyName,children:t.name})}})}({propertySchema:t,styles:f}),T=function(e){const{propertySchema:t}=e;return(0,h.jsx)(l().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation. Cross-workspace features are restricted in automations and will not work.",id:"crossWorkspaceRelationPropertyTrigger.tooltip",values:{propertyName:S({maxLength:20,text:t.name})}})}({propertySchema:t});return(0,h.jsx)(u().Ay,{buttonPopupStore:b,popupType:x,render:()=>(0,h.jsx)(v,{closeMenu:C,propertyId:o}),renderOrigin:e=>(0,h.jsx)(g().X,{...e,icon:i().Q,onDelete:k,styles:f,tooltip:T,children:(0,h.jsx)("div",{style:f.content,children:A})})})}function v(e){const{closeMenu:t,propertyId:o}=e,{removePropertyTrigger:n}=(0,d().p)(),a=(0,r.useCallback)((()=>{n(o),null==t||t()}),[t,o,n]);return(0,h.jsx)(m().Ol,{onDelete:a,stepType:"trigger"})}function x(e){const{propertySchema:t}=e;return(0,h.jsx)(l().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation",id:"crossWorkspaceRelationPropertyTrigger.title",values:{propertyName:t.name}})}function S(e){const{maxLength:t,text:o,truncateCharacter:r}=e,n=r??"…",a=Array.from(o);return a.length<=t?o:`${a.slice(0,t-1).join("")}${n}`}},536992:(e,t,o)=>{o.d(t,{$R:()=>i,Qy:()=>n});const r=["number_does_not_equal","number_equals","number_greater_than","number_greater_than_or_equal_to","number_less_than","number_less_than_or_equal_to","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"number_equals"}const a=(0,o(653998).YK)({changesToAny:{id:"automations.propertyTrigger.numberField.changesToAnyOption",defaultMessage:"Is edited"},numberEquals:{id:"automations.propertyTrigger.numberField.equalsOption",defaultMessage:"="},numberGreaterThanOrEqualTo:{id:"automations.propertyTrigger.numberField.greaterThanOrEqualTo",defaultMessage:"≥"},numberLessThanOrEqualTo:{id:"automations.propertyTrigger.numberField.lessThanOrEqualTo",defaultMessage:"≤"},isEmpty:{id:"automations.propertyTrigger.numberField.isEmpty",defaultMessage:"Is cleared"},numberGreaterThan:{id:"automations.propertyTrigger.numberField.greaterThan",defaultMessage:">"},numberLessThan:{id:"automations.propertyTrigger.numberField.lessThan",defaultMessage:"<"},numberDoesNotEqual:{id:"automations.propertyTrigger.numberField.doesNotEqualOption",defaultMessage:"≠"}}),i={number_equals:{hasInput:!0,text:a.numberEquals,value:"number_equals"},number_does_not_equal:{hasInput:!0,text:a.numberDoesNotEqual,value:"number_does_not_equal"},number_greater_than:{hasInput:!0,text:a.numberGreaterThan,value:"number_greater_than"},number_less_than:{hasInput:!0,text:a.numberLessThan,value:"number_less_than"},number_greater_than_or_equal_to:{hasInput:!0,text:a.numberGreaterThanOrEqualTo,value:"number_greater_than_or_equal_to"},number_less_than_or_equal_to:{hasInput:!0,text:a.numberLessThanOrEqualTo,value:"number_less_than_or_equal_to"},changes_to_any:{hasInput:!1,text:a.changesToAny,value:"changes_to_any"},is_empty:{text:a.isEmpty,value:"is_empty",hasInput:!1}}},553538:(e,t,o)=>{o.d(t,{$:()=>f});var r=o(242343),n=()=>o(16791),a=()=>o(237385),i=()=>o(803290),l=()=>o(174114),s=()=>o(76394),u=()=>o(31448),c=()=>o(211379),p=()=>o(441165),d=()=>o(654548),m=()=>o(129978),g=()=>o(112907),y=()=>o(735347),h=o(163643);function f(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:f,value:v}=e,x=(0,l().IS)((()=>({overflowWrap:{whiteSpace:"inherit"},textWrap:{alignItems:"center",display:"flex",fontFamily:u().vc(n().locale).githubMono}})),[]),S=function(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:u}=e,f=(0,a().v3)(),v=(0,a().Y0)(),x=(0,i().K8)((()=>f.KatexStore.getKatex()),[f]),S=(0,p().Ol)(),b=(0,l().DP)(),{value:C}=(0,m().fJ)(c().y),[k,A]=(0,r.useMemo)((()=>[null==u?void 0:u.value,(null==u?void 0:u.type)??"simple"]),[u]);return(0,i().K8)((()=>{if(!k)return"";if("simple"===A)return(0,d().S5)({disabled:!0,disableDateStyleAnnotations:!1,disableHover:!1,disableInsertedDeletedAnnotations:!1,disableStyleAnnotations:!1,disableSuggestionAnnotations:!1,emojiType:S,environment:f,formulaValueTypes:t,katex:x,parentBlockId:void 0,parentStore:o,renderedPageBlockId:void 0,textValue:{value:k,spaceId:n},theme:b});if("formula"===A){if(C){const e=(0,y()._)({currentUserId:f.currentUser.id,errorRanges:[],getPublicBaseUrlForPage:g().SN(f),isAndroid:v.isAndroid,isMobileNative:v.isMobileNative,isSafariOrIOS:v.isSafari||v.isIOS,isWindows:v.isWindows,parentSpaceId:n,Prism:C,store:o,textValue:k,theme:b,valueTypes:t,hoveredErrorRange:void 0});return(0,h.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}return""}(0,s().HB)(A)}),[C,v.isAndroid,v.isIOS,v.isMobileNative,v.isSafari,v.isWindows,S,f,t,x,o,n,b,A,k])}({formulaTypecheckContextValues:t??[],parentRecordStore:o,spaceId:f,value:v});return(0,h.jsx)("div",{style:x.textWrap,children:(0,h.jsx)("div",{style:x.overflowWrap,children:S})})}},560015:(e,t,o)=>{o.d(t,{A:()=>G});o(362833),o(403517);var r=o(242343),n=()=>o(237385),a=()=>o(174114),i=()=>o(220413),l=(o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(244387),()=>o(752597)),s=()=>o(803290),u=()=>o(564134),c=()=>o(807912),p=()=>o(465546),d=()=>o(630714),m=()=>o(162901),g=()=>o(769884),y=()=>o(34662),h=()=>o(653998),f=()=>o(188877),v=()=>o(975392),x=()=>o(523365),S=()=>o(128192),b=()=>o(485951),C=()=>o(797715),k=()=>o(509484),A=()=>o(359441),T=()=>o(836331),M=()=>o(210466),j=()=>o(237692),P=()=>o(373703),_=()=>o(718522),I=o(163643);var w=()=>o(640979),V=()=>o(935091),R=()=>o(858023),N=()=>o(975515),B=()=>o(743668),F=()=>o(88271),E=()=>o(23082),O=()=>o(24e3),D=()=>o(360234),W=()=>o(950635),L=()=>o(409211),K=()=>o(907721),H=()=>o(535906),q=()=>o(559637),z=()=>o(103151),Y=()=>o(415806),U=()=>o(164634),$=()=>o(320856);function Q(e){let{annotation:t,disabled:o,getRecordModel:r,isSelected:a,menuArgs:i,showPersonCheckbox:l}=e;const u=(0,n().Y0)(),c=(0,$().U)(),p=(0,s().K8)((()=>{if((0,d().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)){const e=(0,y().NcG)(t);return e?(0,W().xC)({pointer:{table:L().oo,id:e},getRecordValue:r}):void 0}}),[t,r]);return null!=p&&p.asActor&&p.table===L().oo?(0,I.jsx)(H().A,{...i,...l?{icon:(0,I.jsx)(q().A,{checked:a,size:14,onClick:i.onClick})}:{},title:o?(0,I.jsx)(z().A,{renderTooltip:()=>(0,I.jsx)(h().sA,{...U().O.maximumPeopleSelectedTooltip}),placement:K().W.Right,render:e=>(0,I.jsx)("div",{style:{width:"100%"},...e,children:(0,I.jsx)(Y().t_,{isSingle:!0,shouldShrink:!0,format:u.isMobile?Y().t_.Format.Large:Y().t_.Format.Medium,userValue:p.asActor})})}):(0,I.jsx)(Y().t_,{isSingle:!0,shouldShrink:!0,format:u.isMobile?Y().t_.Format.Large:Y().t_.Format.Medium,userValue:p.asActor}),disabled:o,style:o?c.disabledMenuItem:void 0,isTokenTitle:!0}):null}function G(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:W,formulaValueContext:L,getRecordModel:K,isDisabled:H,limit:q,menuProps:z,onChange:Y,onClose:U,showClearButton:$=!1,showFormulaValueItems:G=!1,showGenericHeader:X=!1,showInputMenuItem:Z=!1,showPersonCheckbox:J=!1,showReplaceAddRemoveToggle:ee=!1,value:te,parentRecordStore:oe}=e,re=(0,n().Y0)(),ne=(0,a().IS)((e=>({genericHeader:{paddingBottom:0},headerDiv:{paddingBlockEnd:re.isMobile?0:6,borderBlockEnd:re.isMobile?"none":`1px solid ${i().Ay.dividerColor}`},replaceAddRemoveToggleButton:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}})),[re.isMobile]),{errorMessage:ae,footer:ie,header:le,isLoading:se,menuListStore:ue,noResultsMessage:ce,replaceAddRemoveToggleButton:pe,searchInput:de,userItems:me,valueItems:ge}=function(e){var t,o;const{action:a,formulaTypecheckContextValues:i,formulaValueContext:w,isDisabled:V=!1,limit:R,onChange:N,onClose:B,showClearButton:F,showReplaceAddRemoveToggle:E,showSelectedPeople:O,unlimitedCurrentSimpleFormulaValueTokens:D,value:W}=e,L=(0,n().v3)(),K=(0,n().Y0)(),H=(0,h().tz)(),q="collection"===(null==w?void 0:w.type)?w.collectionStore.getRecordModel:g().b4_.constant(void 0),z=(0,x().pg)(w),Y=z(D,"first"),U=(0,r.useMemo)((()=>i.filter((e=>(0,p().o5)(e.type,{type:"person"})))),[i]),[$,Q]=(0,r.useState)(""),G=(0,s().uB)(void 0,M().A),X=(0,s().K8)((()=>{if("collection"!==w.type)return!1;const e=w.collectionStore.getSchema()[w.property];return e&&(0,u().sO)(e)?1===e.limit:void 0}),[w]),[Z]=(0,m().Yb)((async()=>{const e=$?(0,f().Ay)($,U,(e=>e.kind===c().FormulaContextValueKind.ContextValue?e.name:"")):U,t=(0,d().fromSimpleFormulaArrayValue)(null==W?void 0:W.value).reduce(((e,t)=>(t&&(0,d().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)&&e.push(t[1]),e)),[]),o=await k().T.searchActions.load(),r=await o.searchSpaceUsers({environment:L,query:$,membersOnly:!1,limit:20+t.length,shouldUseEdgeCacheRollout:T().default.checkGate({gateName:"edge_cache_helpers"})});let n=0,a=r[n];const i=[];for(;a&&i.length<20;)t.includes(a.id)&&!O||i.push(a.id),n+=1,a=r[n];return{valueResults:e,userResults:i}}),[L,$,O,U,null==W?void 0:W.value],{debounce:A().tu}),J=(0,r.useCallback)((()=>{Q(""),G.setState({...G.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[G]),ee=(0,r.useCallback)(((e,t)=>{N(e||W,t||a)}),[a,N,W]),te=(0,r.useCallback)((e=>{const t=z(e,"last");ee({type:"simple",value:(0,d().toSimpleFormulaArrayValue)(t)}),J()}),[z,ee,J]),oe=(0,r.useCallback)((()=>{te(Y.slice(0,Y.length-1))}),[Y,te]),re=(0,r.useCallback)((e=>{null==te||te((0,d().simpleFormulaValueWithoutToken)(Y,e))}),[Y,te]),ne=Boolean(R&&Y.length>=R),ae=v().oE(Y.map(((e,t)=>"string"==typeof e||"boolean"==typeof e?null:(0,y().rie)(e)?(0,I.jsx)(_().A,{handleRemoveToken:re,token:e},t):(0,y().s1Y)(e)?(0,I.jsx)(P().A,{formulaTypecheckContextValues:i,handleRemoveToken:re,isDisabled:V||ne,token:e},t):null))),ie=new Set(v().oE(Y.map((e=>(0,d().isAnnotationSimpleValueToken)(e)&&(0,y().s1Y)(e)&&(0,y().iVq)(e).id)))),le=new Set(v().oE(Y.map((e=>(0,d().isAnnotationSimpleValueToken)(e)&&(0,y().rie)(e)&&(0,y().NcG)(e))))),se=v().oE(((null===(t=Z.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===c().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!ie.has(t)||O)return{action:"append",currentSimpleFormulaValueTokens:Y,isDisabled:V||ne,id:t,getRecordModel:q,setCurrentTokens:te,value:e}}))),ue=v().oE(((null===(o=Z.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=le.has(e);if(t&&!O)return;const o=(0,y().P4h)(e);return{action:()=>{t?re(o):te([...Y,o]),X&&l().default.afterNextFlush((()=>{B()}))},annotation:o,getRecordModel:q,id:e,isDisabled:V||ne,userId:e,isSelected:t}}))),ce=[...se,...ue],pe=(0,I.jsx)("div",{style:{...!K.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,I.jsx)(C().Ay,{style:{maxHeight:6*parseInt(C().sA,10)},disabled:V||ne,dontShowBorderBottom:K.isAndroid,focus:!K.isMobile||void 0,focusAfterAnimation:!0,format:C().le.FilterValue,onChange:e=>Q(e.target.value),onClearButtonClick:()=>te([]),onRemoveLastToken:oe,placeholder:H.formatMessage(S().D.personSearchPlaceholder),showClearButton:F,tokens:ae,value:$})}),de=(0,I.jsx)(b().A,{value:W,onChange:ee}),me=(0,I.jsx)(j().A,{action:a,handleOnChange:ee});return{errorMessage:Z.error&&H.formatMessage(S().D.somethingWentWrong),footer:de,header:H.formatMessage(S().D.genericMenuHeader),isLoading:!Z.value&&!Z.error,menuListStore:G,noResultsMessage:0===ce.length&&Z.value&&H.formatMessage(S().D.noResults),replaceAddRemoveToggleButton:Boolean(E)&&me,searchInput:pe,userItems:ue,valueItems:se}}({action:t,formulaTypecheckContextValues:W,formulaValueContext:L,isDisabled:H,limit:q,onChange:Y,onClose:U,showClearButton:$,showReplaceAddRemoveToggle:ee,showSelectedPeople:J,unlimitedCurrentSimpleFormulaValueTokens:o,value:te})||{},ye=[...(0,r.useMemo)((()=>ge&&G?ge.map((e=>{const{annotation:t,itemAction:o}=(0,D().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,I.jsx)(O().A,{annotation:t,disabled:e.isDisabled,formulaTypecheckContextValues:W,menuArgs:o,parentRecordStore:oe}),action:o}})):[]),[W,G,ge,oe]),...(0,r.useMemo)((()=>me?me.map((e=>({key:e.userId,render:t=>(0,I.jsx)(Q,{annotation:e.annotation,disabled:e.isDisabled,getRecordModel:K||e.getRecordModel,isSelected:e.isSelected,menuArgs:t,showPersonCheckbox:J}),action:e.action}))):[]),[K,J,me])],he=[];let fe;ye.length>0&&he.push({key:"users",render:e=>(0,I.jsx)(F().A,{...e}),items:ye}),fe=re.isMobile?{menuType:w().gu.Modal,minWidth:260,right:(0,I.jsx)(B().DoneMenuText,{}),onClickRight:U,footer:ie&&(0,I.jsx)(F().A,{topBorder:!0,children:ie})}:{menuType:w().gu.Popup,maxHeight:"50vh",width:260,footer:ie&&(0,I.jsx)(F().A,{topBorder:!0,children:ie}),disableHeaderBorder:!0};const ve=X&&(0,I.jsx)(F().A,{style:ne.genericHeader,title:le}),xe=(0,I.jsxs)("div",{style:ne.headerDiv,children:[!re.isMobile&&((null==z?void 0:z.header)||ve),Z&&de]}),Se=(0,I.jsxs)(I.Fragment,{children:[ae&&(0,I.jsx)(F().A,{children:(0,I.jsx)(N().A,{title:ae})}),!se&&!ae&&pe&&(0,I.jsx)("div",{style:ne.replaceAddRemoveToggleButton,children:pe}),ce&&(0,I.jsx)(F().A,{children:(0,I.jsx)(N().A,{title:ce})}),se&&(0,I.jsx)(F().A,{children:(0,I.jsx)(E().A,{})}),ye.length>0&&(0,I.jsx)(R().Ay,{type:R().Oh.Vertical,initialFocus:0,sections:he,store:ue})]});return{headerDiv:xe,innerComponents:Se,personArrayMenu:(0,I.jsx)(V().A,{...fe,...z,header:xe,children:Se})}}},590467:(e,t,o)=>{o.d(t,{LN:()=>i,W:()=>l,lD:()=>s,zQ:()=>u});o(242343);var r=()=>o(653998),n=()=>o(275334),a=o(163643);const i={checkbox_is_not:"checkbox",checkbox_is:"checkbox",enum_contains:"multi_select",enum_does_not_contain:"multi_select",enum_contains_all:"multi_select",enum_is_not:"select",enum_is:"select",number_does_not_equal:"number",number_equals:"number",number_greater_than_or_equal_to:"number",number_greater_than:"number",number_less_than_or_equal_to:"number",number_less_than:"number",person_contains:"person",person_does_not_contain:"person",relation_contains:"relation",relation_does_not_contain:"relation",status_is_not:"status",status_is:"status",string_contains:"text",string_does_not_contain:"text",string_ends_with:"text",string_is_not:"text",string_is:"text",string_starts_with:"text"},l={phone_number:"text",title:"text",url:"text",email:"text"},s={relation:["relation"],checkbox:["checkbox"],number:["number"],person:["person"],multi_select:["multi_select"],select:["select"],status:["status"],text:["email","phone_number","text","url"]};function u(e){return(0,a.jsx)(r().sA,{...n().o7({propertyName:e.name})})}},604104:(e,t,o)=>{o.d(t,{L:()=>c,g:()=>u});o(242343);var r=()=>o(174114),n=()=>o(309893),a=()=>o(465546),i=()=>o(653998),l=()=>o(275334),s=o(163643);function u(e){const{returnType:t}=e,o=(0,r().DP)(),u=(0,r().IS)((e=>({iconWrap:{display:"inline-block",fill:e.icon.secondary,height:"1em",position:"relative",verticalAlign:"-0.15em",width:"1em"},icon:{width:"100%"}})),[]),c=(0,a().Ix)(t);return(0,s.jsx)(n().R,{icon:(0,s.jsx)("span",{style:u.iconWrap,children:c(u.icon)}),index:0,theme:o,children:(0,s.jsx)(i().sA,{...l().CV.inlineCustomFormulaDefaultName})})}function c(){return(0,s.jsx)(i().sA,{...l().CV.inlineCustomFormulaDefaultName})}},613152:(e,t,o)=>{o.d(t,{Js:()=>he,_B:()=>ye,CD:()=>fe});o(725707),o(491955),o(403517),o(113085);var r=o(242343),n=()=>o(803290),a=()=>o(271142),i=()=>o(453214),l=()=>o(174114),s=()=>o(89414),u=()=>o(653998),c=()=>o(31448),p=()=>o(275334),d=()=>o(466207),m=()=>o(10872),g=o(163643);function y(){const{removeAnyPropertyEditedTrigger:e}=(0,d().p)(),t=(0,u().tz)(),o=(0,l().IS)((()=>({title:{fontWeight:c().Wy.medium}})),[]),r=p().HG(t);return(0,g.jsx)(m().X,{icon:s().pencilLineSmallIcon,onDelete:e,tooltip:r,children:(0,g.jsx)("div",{style:o.title,children:r})})}var h=()=>o(911575),f=()=>o(15552),v=()=>o(564134),x=()=>o(622286),S=()=>o(590467),b=()=>o(738355),C=()=>o(273520),k=()=>o(179701),A=()=>o(69766);function T(e){const{renderOrigin:t,property:o}=e,r=(0,k().j)();return(0,g.jsx)(C().Ay,{popupType:r,renderOrigin:t,render:e=>(0,g.jsx)(A().A,{initialState:{type:"propertyChangedFilter",property:o},buttonPopupParent:e})})}var M=()=>o(649571),j=()=>o(533219),P=()=>o(128290),_=()=>o(999011);function I(e){let{propertySchema:t,onClick:o}=e;return(0,g.jsx)(_().z,{onClick:o,icon:e=>(0,g.jsx)(P().P,{propertySchema:t,style:e}),tooltip:(0,g.jsx)(V,{propertyName:t.name}),children:(0,g.jsx)(w,{propertyName:t.name})})}function w(e){let{propertyName:t}=e;const o=(0,u().tz)(),r=(0,l().IS)((()=>({propertyName:{...c().RC,fontWeight:c().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),n=p().yR(o,{propertyName:(0,g.jsx)("span",{style:r.propertyName,children:t})});return(0,g.jsx)("span",{style:r.wrap,children:n})}function V(e){let{propertyName:t}=e;const o=(0,u().tz)();return(0,g.jsx)(g.Fragment,{children:p().yR(o,{propertyName:t})})}function R(e){let{propertySchema:t,onClick:o}=e;return(0,g.jsx)(_().z,{onClick:o,icon:e=>(0,g.jsx)(P().P,{propertySchema:t,style:e}),tooltip:(0,g.jsx)(B,{propertyName:t.name}),children:(0,g.jsx)(N,{propertyName:t.name})})}function N(e){let{propertyName:t}=e;const o=(0,u().tz)(),r=(0,l().IS)((()=>({propertyName:{...c().RC,fontWeight:c().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),n=p().Od(o,{propertyName:(0,g.jsx)("span",{style:r.propertyName,children:t})});return(0,g.jsx)("span",{style:r.wrap,children:n})}function B(e){let{propertyName:t}=e;const o=(0,u().tz)();return(0,g.jsx)(g.Fragment,{children:p().Od(o,{propertyName:t})})}var F=()=>o(824678);function E(e){const{filter:t,propertySchema:o,onClick:r}=e,{title:n,tooltipTitle:a,styles:i}=(0,F().aR)({numberValue:t.value.value,operator:t.operator,propertySchema:o,messageType:"trigger"});return(0,g.jsx)(_().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:a}),children:(0,g.jsx)("div",{style:i.content,children:n})})}var O=()=>o(756567),D=()=>o(916963),W=()=>o(723361),L=()=>o(76394),K=()=>o(962373),H=()=>o(88937),q=()=>o(624133);function z(e){const{deletedPropertySchema:t}=e,o=null==t?void 0:t.type,{property:a}=(0,r.useContext)(ye),{removePropertyTrigger:i}=(0,d().p)(),s=(0,l().IS)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},iconWrap:{background:e.tint.uiRed,borderRadius:4},propertyType:{color:e.accentColors.red[700]}})),[]),u=(0,k().j)(),p=(0,n().uB)(void 0,K().A),y=(0,r.useCallback)((()=>p.reset()),[p]),h=(0,r.useCallback)((()=>{i(a)}),[a,i]),f=(0,L().O9)(t)?(0,H().AJ)({propertySchema:t}):(0,H().Xl)(),v=(0,L().O9)(t)?(0,H().CH)():(0,H().Xl)();return(0,g.jsx)(C().Ay,{buttonPopupStore:p,popupType:u,render:()=>(0,g.jsx)(q().c,{closeMenu:y,propertyId:a}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,L().O9)(o)?D().LE[o]:W().Q,onDelete:h,styles:s,tooltip:v,children:(0,g.jsx)("div",{style:s.content,children:f})})})}var Y=()=>o(265405),U=()=>o(403321);function $(e){const{filter:t,propertySchema:o,onClick:r}=e,a=(0,Y().F)(),{collectionStore:i}=(0,b().k)(),l=(0,x().X)("collections_xws"),s=(0,n().K8)((()=>i.getSpaceId()),[i]),u=(0,n().K8)((()=>l&&(0,v().o2)(s,o)),[l,o,s]),c=(0,n().K8)((()=>(0,U().WE)({collectionStore:i,filter:t})),[i,t]),{title:p,tooltipTitle:d,styles:m}=(0,U().xL)({automationContextValues:a,filter:t,collectionStore:i,operator:t.operator,propertySchema:o,messageType:"trigger",value:null==c?void 0:c.value});return u?(0,g.jsx)(j().Zr,{propertySchema:o}):(0,g.jsx)(_().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:d}),children:(0,g.jsx)("div",{style:m.content,children:p})})}var Q=()=>o(123098),G=()=>o(834508),X=()=>o(403172);function Z(e){const{filter:t,propertySchema:o,onClick:r}=e,{title:n,tooltipTitle:a,styles:i}=(0,X().w5)({textValue:t.value.value,operator:t.operator,propertySchema:o,messageType:"trigger"});return(0,g.jsx)(_().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:a}),children:(0,g.jsx)("div",{style:i.content,children:n})})}var J=()=>o(206183),ee=()=>o(836693),te=()=>o(535906),oe=()=>o(935091),re=()=>o(858023),ne=()=>o(397791),ae=()=>o(88271),ie=()=>o(441911);function le(e){const{closeMenu:t,propertyId:o}=e,{removePropertyTrigger:n}=(0,d().p)(),a=(0,r.useCallback)((()=>{n(o),null==t||t()}),[t,o,n]),i=(0,ie().e)({width:266}),l=(0,r.useMemo)((()=>({action:a,key:"delete-property-menu-item",render:e=>(0,g.jsx)(te().A,{...e,icon:(0,g.jsx)(ne().I,{icon:ee().trashIcon}),title:(0,g.jsx)(u().sA,{id:"automationUnsupportedOperatorMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})})),[a]);return(0,g.jsx)(oe().A,{...i,children:(0,g.jsx)(re().Ay,{initialFocus:0,sections:[{key:"actions-section",items:[l],render:e=>(0,g.jsx)(ae().A,{...e})}],type:re().Oh.Vertical})})}function se(e){let{filter:t,propertySchema:o}=e;const a=(0,u().tz)(),{property:i}=(0,r.useContext)(ye),{removePropertyTrigger:s}=(0,d().p)(),p=(0,l().IS)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},iconWrap:{background:e.tint.uiRed,borderRadius:4},propertyType:{color:e.accentColors.red[700]}})),[]),y=(0,k().j)(),h=(0,n().uB)(void 0,K().A),f=(0,r.useCallback)((()=>h.reset()),[h]),v=(0,r.useCallback)((()=>{s(i)}),[i,s]),x=function(e){const{propertySchema:t}=e,o=t.type,r=t.name||J().dC[o];return(0,g.jsx)(u().sA,{defaultMessage:'"{propertyTypeDisplayName}" property type is incompatible with this step',id:"updateThisPageUnsupportedOperatorAction.updatedUnsupportedOperator.title",values:{propertyTypeDisplayName:r}})}({propertySchema:o,styles:p}),b=function(e){const{filter:t,intl:o}=e,r=S().LN[t.operator],n=(S().lD[r]||[]).map((e=>J().dC[e])),a=o.formatList(n,{style:"long",type:"disjunction"});return(0,g.jsx)(u().sA,{defaultMessage:"Remove step or restore property to a valid type: {propertiesSupportedList}",id:"updateThisPageUnsupportedOperatorAction.unsupportedOperator.titleList",values:{propertiesSupportedList:a}})}({intl:a,filter:t}),A=o.type;return(0,g.jsx)(C().Ay,{buttonPopupStore:h,popupType:y,render:()=>(0,g.jsx)(le,{closeMenu:f,propertyId:i}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,L().O9)(A)?D().LE[A]:W().Q,onDelete:v,styles:p,tooltip:b,children:(0,g.jsx)("div",{style:p.content,children:x})})})}var ue=()=>o(724175),ce=()=>o(400383);function pe(e){let{propertySchema:t}=e;const{property:o}=(0,r.useContext)(ye),{removePropertyTrigger:a}=(0,d().p)(),i=(0,l().IS)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:e.text.uiRedPrimary},iconWrap:{background:e.tint.uiRed,borderRadius:4},propertyType:{color:e.accentColors.red[700]}})),[]),s=(0,k().j)(),u=(0,n().uB)(void 0,K().A),p=(0,r.useCallback)((()=>u.reset()),[u]),y=(0,r.useCallback)((()=>{a(o)}),[o,a]),h=(0,ue().m9)({propertySchema:t}),f=(0,ue().cn)(),v=t.type;return(0,g.jsx)(C().Ay,{buttonPopupStore:u,popupType:s,render:()=>(0,g.jsx)(ce().A5,{closeMenu:p,propertyId:o}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,L().O9)(v)?D().LE[v]:W().Q,onDelete:y,styles:i,tooltip:f,children:(0,g.jsx)("div",{style:i.content,children:h})})})}function de(e){const{collectionStore:t}=(0,b().k)(),{property:o,filter:r}=e,[a,i]=(0,n().K8)((()=>{var e,r;return[null===(e=t.getSchema())||void 0===e?void 0:e[o],null===(r=t.getDeletedSchema())||void 0===r?void 0:r[o]]}),[t,o]);if(!a)return(0,g.jsx)(z,{deletedPropertySchema:i});if(!(0,h().$0)(a))return(0,g.jsx)(pe,{propertySchema:a});const l=S().W[a.type]||a.type;return"changes_to_any"!==r.operator&&"is_empty"!==r.operator&&r.operator&&S().LN[r.operator]!==l?(0,g.jsx)(se,{propertySchema:a,filter:r}):(0,h().nq)(a)?(0,g.jsx)(ge,{property:o,propertySchema:a,filter:r}):(0,g.jsx)(R,{propertySchema:a})}function me(e){const{filter:t,onClick:o,propertySchema:r}=e,{collectionStore:a}=(0,b().k)(),i=(0,x().X)("collections_xws"),l=(0,n().K8)((()=>i&&(0,v().nC)(r)&&(0,v().o2)(a.getSpaceId(),r)),[a,r,i]);return(0,v().nC)(r)&&l?(0,g.jsx)(j().Zr,{propertySchema:r}):"is_empty"===t.operator?(0,g.jsx)(I,{...e,propertySchema:r}):"changes_to_any"!==t.operator&&(0,f().gc)(t)?"checkbox"===r.type&&(0,f().Ui)(t)?(0,g.jsx)(M().ZZ,{filter:t,onClick:o,propertySchema:r}):"status"===r.type&&(0,f().H$)(t)?(0,g.jsx)(G().y,{filter:t,onClick:o,propertySchema:r}):"select"===r.type&&(0,f().v0)(t)||"multi_select"===r.type&&(0,f().as)(t)?(0,g.jsx)(Q().Ww,{filter:t,onClick:o,propertySchema:r}):"person"===r.type&&(0,f().I_)(t)?(0,g.jsx)(O().h,{filter:t,onClick:o,propertySchema:r}):"number"===r.type&&(0,f().My)(t)?(0,g.jsx)(E,{filter:t,onClick:o,propertySchema:r}):"email"!==r.type&&"phone_number"!==r.type&&"text"!==r.type&&"title"!==r.type&&"url"!==r.type||!(0,f().YH)(t)?"relation"===r.type&&(0,f().Pq)(t)?(0,g.jsx)($,{filter:t,onClick:o,propertySchema:r}):(0,g.jsx)(R,{onClick:o,propertySchema:r}):(0,g.jsx)(Z,{filter:t,onClick:o,propertySchema:r}):(0,g.jsx)(R,{onClick:o,propertySchema:r})}function ge(e){const{filter:t,propertySchema:o,property:n}=e,a=(0,r.useCallback)((e=>(0,g.jsx)(me,{filter:t,onClick:e.onClick,propertySchema:o})),[t,o]);return(0,g.jsx)(T,{renderOrigin:a,property:n})}const ye=(0,r.createContext)({pagePropertiesEdited:[],property:""});function he(){const{automationStore:e,contextType:t}=(0,a().EC)(),o=(0,i().y)(e,t),r=fe(e),l=(0,n().K8)((()=>{var t;if(!e||!e.isTriggerType("event"))return;const o=null===(t=e.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited;return"none"===(null==o?void 0:o.type)?void 0:o}),[e]),s=(0,n().K8)((()=>null==o?void 0:o.getSchema()),[o]);if(!r||!l)return null;if("any"===l.type)return(0,g.jsx)(y,{});if(!s)return null;let u=[];return"all"===l.type?u=l.all??[]:"some"===l.type&&(u=l.some??[]),u?(0,g.jsx)(g.Fragment,{children:u.map((e=>{let{property:t,filter:o}=e;return(0,g.jsx)(ye.Provider,{value:{property:t,pagePropertiesEdited:u},children:(0,g.jsx)(de,{property:t,filter:o})},t)}))}):null}function fe(e){return(0,n().K8)((()=>{if(null==e||!e.isTriggerType("event"))return!1;const t=e.getEventConfiguration(),o=Boolean("none"!==(null==t?void 0:t.pagePropertiesEdited.type)),r=Boolean("all"===(null==t?void 0:t.pagePropertiesEdited.type)&&Boolean(null==t?void 0:t.pagePropertiesEdited.all)),n=Boolean("some"===(null==t?void 0:t.pagePropertiesEdited.type)&&Boolean(null==t?void 0:t.pagePropertiesEdited.some)),a=Boolean("any"===(null==t?void 0:t.pagePropertiesEdited.type));return o&&(r||n||a)}),[e])}ye.displayName="PropertyEditedTriggerContext"},624133:(e,t,o)=>{o.d(t,{a:()=>x,c:()=>S});o(725707),o(500234);var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(653998),l=()=>o(337658),s=()=>o(749975),u=()=>o(73631),c=()=>o(129978),p=()=>o(56432),d=()=>o(271142),m=()=>o(738355),g=()=>o(830925),y=()=>o(466207),h=()=>o(329912),f=()=>o(400383),v=o(163643);function x(e){const{actionId:t,closeMenu:o,propertyId:s}=e,{maybePersistedTransactionActions:y}=(0,m().b)(),{automationStore:x,contextType:S}=(0,d().EC)(),b=(0,n().v3)(),C=(0,i().tz)(),{value:k}=(0,c().fJ)(u().T.formulas),{value:A}=(0,c().fJ)(l().QV.automationTypecheck),T=(0,g().n)(x),M=(0,a().K8)((()=>{const e=x.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[x,t]),j=(0,r.useCallback)((()=>{M&&k&&A&&(y.createAndCommit({perform:e=>{p().removeAutomationAction({actionStore:M,automationStore:x,automationTypecheckModule:A,contextType:S,environment:b,formulasModule:k,intl:C,isSubscribed:T,transaction:e})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[M,x,A,o,S,b,k,C,T,y]),P=(0,h().A)(),_=(0,r.useMemo)((()=>()=>{P&&P(s),null==o||o()}),[o,P,s]);return(0,v.jsx)(f().Ol,{onDelete:j,onRestore:_,stepType:"action"})}function S(e){const{closeMenu:t,propertyId:o}=e,n=(0,s().Ks)(),{removePropertyTrigger:i}=(0,y().p)(),l=(0,a().K8)((()=>null==n?void 0:n.settingsStore),[n]),u=(0,a().K8)((()=>{const e=null==n?void 0:n.collectionStore();return Boolean(!(null!=e&&e.getSchema()[o]))&&Boolean(!(null!=e&&e.getDeletedSchema()[o]))}),[n,o]),c=(0,r.useCallback)((()=>{i(o),null==t||t()}),[t,o,i]),p=(0,h().A)(),d=(0,r.useMemo)((()=>()=>{l&&!u&&(p&&p(o),null==t||t())}),[t,l,p,u,o]);return(0,v.jsx)(f().Ol,{onDelete:c,onRestore:d,stepType:"trigger"})}},644518:(e,t,o)=>{o.r(t),o.d(t,{getAllContextValues:()=>f,getContextValueForActionById:()=>x,getContextValuesForAction:()=>v,typecheckAutomation:()=>y,typecheckAutomationAsync:()=>h});o(362833),o(725707),o(403517),o(113085);var r=()=>o(975392),n=()=>o(204132),a=()=>o(76394),i=()=>o(77408),l=()=>o(465546),s=()=>o(268163),u=()=>o(818713),c=()=>o(232312),p=()=>o(508265),d=()=>o(150992),m=()=>o(355149);function*g(e){const{actionModels:t,automationModel:o,contextType:g,formulasModule:y,runtimeStats:h}=e,f={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}},v=performance.now();let x,S,b;if("button_block"===g||"button_property"===g){if(!o.isButtonType())return{error:new(c().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();b=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else if("event"===g){if(!o.isEventType())return{error:new(c().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();b=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else if("recurrence"===g){if(!o.isRecurrenceType())return{error:new(c().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${g}).`)};const t=o.getTrigger();b=(0,m().Z)(o.getTriggerType()).typecheck(e,t)}else(0,a().HB)(e);if(n().Q.isFail(b))return b;f.valueTypes.push(...r().o8(b.value.valueTypes));for(const a of t){x=void 0,h&&(x=d().hs.getOrCreateAction(h,a.pointer,a.getType()));const t=(0,s().getActionRegistryItem)(a.getType());if(!t){S={error:new(c().oM)({actionId:a.id,message:`Unsupported action type: ${a.getType()}`})};break}const m=performance.now(),g=(0,u().Q)({automationModel:o,formulasModule:y,formulaValueTypes:f.valueTypes}),v=(0,p().HI)(yield*t.resolveExecutionDependencies(g,a));yield*i().q.fetchRecords(v.map((e=>e.pointer))),x&&(x.totalDependencies=v.length,x.getDependenciesDurationMs=Math.trunc(performance.now()-m));const b=t.typecheck(e,a),C=r().o8(f.valueTypes);if(f.actionInputValueTypes[a.id]=C,n().Q.isFail(b)){S=b;break}for(const e of b.value.valueTypes??[]){f.valueTypes.some((t=>(0,l().oH)(e,t)))||f.valueTypes.push(e)}b.value.validationFailures&&b.value.validationFailures.length>0&&(f.actionValidationFailures[a.id]=b.value.validationFailures)}const C=Math.trunc(performance.now()-v);return h&&(h.typecheckStartTime=v,h.typecheckDurationMs=C,h.typecheckSuccess=!(0,a().O9)(S)),S??{value:f}}function y(e){return i().q.runSync(e.getRecordModel,g(e))}async function h(e){return await i().q.runAsync(e.loadRecordModel,g(e))}function f(e){return n().Q.isFail(e)?[]:e.value.valueTypes.slice(0)}function v(e,t){return n().Q.isFail(e)?[]:e.value.actionInputValueTypes[t]??[]}function x(e,t,o){const r=v(e,t);return(0,l().IV)(r,o)}},649571:(e,t,o)=>{o.d(t,{Hk:()=>g,ZZ:()=>d});o(725707),o(491955),o(242343);var r=()=>o(174114),n=()=>o(303707),a=()=>o(660354),i=()=>o(653998),l=()=>o(31448),s=()=>o(301148),u=()=>o(275334),c=()=>o(999011),p=o(163643);function d(e){const t=(0,i().tz)(),{propertySchema:o,filter:r,onClick:n}=e;return(0,p.jsx)(c().z,{onClick:n,tooltip:g({filter:r,intl:t,propertySchema:o}),children:(0,p.jsx)(m,{propertySchema:o,filter:r})})}function m(e){let{propertySchema:t,filter:o}=e;const n=(0,i().tz)(),a=(0,r().IS)((()=>({propertyName:{...l().RC,fontWeight:l().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),s=function(e){const{filter:t,intl:o,propertySchema:r,styles:n}=e,a=r.name,i=t.value,l={propertyName:(0,p.jsx)("span",{style:n.propertyName,children:a}),propertyValues:(0,p.jsx)(y,{checkboxValue:i.value??!1})};return(0,u().T2)(o,l)}({filter:o,intl:n,propertySchema:t,styles:a});return(0,p.jsx)("span",{style:a.wrap,children:s})}function g(e){const{filter:t,intl:o,propertySchema:r}=e,n={propertyName:r.name,propertyValues:!0===t.value.value?(0,p.jsx)(i().sA,{...u().CV.actionCheckboxPropertyChecked}):(0,p.jsx)(i().sA,{...u().CV.actionCheckboxPropertyUnchecked})};return(0,u().T2)(o,n)}function y(e){const{checkboxValue:t}=e,o=!0===t?(0,a().v)({width:12}):(0,n().K)({width:10}),r=!0===t?(0,p.jsx)(i().sA,{...u().CV.actionCheckboxPropertyChecked}):(0,p.jsx)(i().sA,{...u().CV.actionCheckboxPropertyUnchecked});return(0,p.jsx)(s().G,{icon:o,children:r})}},658722:(e,t,o)=>{o.d(t,{H:()=>b,hs:()=>S,oG:()=>v});o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(403517),o(242343);var r=()=>o(803290),n=()=>o(174114),a=()=>o(950635),i=()=>o(716605),l=()=>o(752903),s=()=>o(807912),u=()=>o(34662),c=()=>o(653998),p=()=>o(76394),d=()=>o(31448),m=()=>o(415806),g=()=>o(434406),y=()=>o(604104),h=()=>o(275334),f=o(163643);function v(e){const{messageType:t}=e,o=(0,c().tz)(),a=(0,n().IS)((()=>({content:{display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...d().RC,fontWeight:d().Wy.medium},propertyValue:{...d().RC},propertyValueList:{display:"flex",flexBasis:"100%",listStyle:"none",margin:0,padding:0,width:"100%",columnGap:4,rowGap:4},inlineActorTokenContainer:{...d().RC,paddingBlockStart:1},inlineActorToken:{margin:0,paddingRight:0}})),[]),i=(0,r().K8)((()=>"action"===t?function(e){const{getRecordModel:t,contextValues:o,intl:r,operator:n,propertySchema:a,styles:i,value:l}=e;let s;const u=(0,f.jsx)("span",{style:i.propertyName,children:a.name});if("formula"===(null==l?void 0:l.type))s=n?h().f4({operator:n,propertyName:u,propertyValue:(0,f.jsx)(y().g,{returnType:{type:"person"}})}):h().Pb({propertyName:u,propertyValue:(0,f.jsx)(y().g,{returnType:{type:"person"}})});else{const e=x({getRecordModel:t,propertySchema:a,value:l}),c=k(l,o),p=C({actors:e,values:c,showAsList:!1,styles:i}),d=e.length+c.length;s=n?h().f4({...h().f_({elements:Array.isArray(p)?p:[p],intl:r}),operator:n,propertyName:u}):0===d?h().NW({propertyName:u}):h().Pb({propertyName:u,propertyValue:p})}return(0,f.jsx)(c().sA,{...s})}({getRecordModel:e.getRecordModel,contextValues:e.contextValues,intl:o,propertySchema:e.propertySchema,styles:a,value:e.value,operator:e.operator}):"trigger"===t?function(e){const{actorModels:t,propertySchema:o,styles:r,operator:n}=e;if(!t)return null;const a=(0,f.jsx)("span",{style:r.propertyName,children:o.name}),i=C({actors:t,values:[],styles:r,showAsList:!0});let l;if(1===t.length){l=("person_contains"===n?h().a9:h().dd)({propertyName:a,propertyValues:i})}else{l=("person_contains"===n?h()._d:h().Fp)({propertyName:a,propertyValues:i})}return(0,f.jsx)(c().sA,{...l})}({actorModels:e.actorModels,propertySchema:e.propertySchema,operator:e.operator,styles:a}):void(0,p().HB)(t)),[t,e,o,a]);return{tooltipTitle:(0,r().K8)((()=>"action"===t?S({getRecordModel:e.getRecordModel,contextValues:e.contextValues,intl:o,propertySchema:e.propertySchema,styles:a,value:e.value}):"trigger"===t?b({actorModels:e.actorModels,intl:o,operator:e.operator,propertySchema:e.propertySchema,styles:a}):void(0,p().HB)(t)),[t,e,o,a]),title:i,styles:a}}function x(e){const{getRecordModel:t,propertySchema:o,value:r}=e;return(0,i().e5)({blockCreatorPointer:void 0,propertySchema:o,textValue:null==r?void 0:r.value}).map((e=>(0,a().xC)({getRecordModel:t,pointer:e}))).filter(p().O9)}function S(e){const{getRecordModel:t,contextValues:o,intl:r,operator:n,propertySchema:i,styles:l,value:s}=e;let u;const p=(0,f.jsx)("span",{style:null==l?void 0:l.propertyName,children:i.name});if("formula"===(null==s?void 0:s.type))u=n?h().f4({operator:n,propertyName:p,propertyValue:(0,f.jsx)(y().L,{})}):h().Pb({propertyName:p,propertyValue:(0,f.jsx)(y().L,{})});else{const e=x({getRecordModel:t,propertySchema:i,value:s}),l=e.map((e=>(0,a().lR)(r,e))),c=k(s,o),d=c.map((e=>e.tooltipName??e.name)),m=r.formatList([...l,...d],{style:"long",type:"conjunction"}),g=e.length+c.length;u=n?h().f4({propertyName:p,propertyValue:m,operator:n}):0===g?h().NW({propertyName:p}):h().Pb({propertyName:p,propertyValue:m})}return(0,f.jsx)(c().sA,{...u})}function b(e){const{actorModels:t,intl:o,propertySchema:r,styles:n,operator:i}=e;if(!t)return null;const l=(0,f.jsx)("span",{style:null==n?void 0:n.propertyName,children:r.name}),s=t.map((e=>(0,a().lR)(o,e))),u=o.formatList(s,{style:"long",type:"conjunction"});let p;if(1===t.length){p=("person_contains"===i?h().a9:h().dd)({propertyName:l,propertyValues:u})}else{p=("person_contains"===i?h()._d:h().Fp)({propertyName:l,propertyValues:u})}return(0,f.jsx)(c().sA,{...p})}function C(e){const{actors:t,styles:o,showAsList:r=!0,values:n}=e,a=[...t.map(((e,t)=>(0,f.jsx)(m().Ay,{style:o.inlineActorToken,actor:e,showRemoveButton:!1,format:l().NY.Medium,isSingle:!1},t))),...n.map(((e,t)=>(0,f.jsx)(g().F,{style:o.inlineFormulaValue,format:l().NY.Medium,isSingle:!1,value:e},t)))];return 1===a.length?(0,f.jsx)("div",{style:o.propertyValue,children:a[0]}):r?(0,f.jsx)("ul",{style:o.propertyValueList,children:a.map(((e,t)=>(0,f.jsx)("li",{children:(0,f.jsx)("div",{style:o.propertyValue,children:e},t)},t)))}):a.map(((e,t)=>(0,f.jsx)("div",{style:o.inlineActorTokenContainer,children:e},t)))}function k(e,t){const o=new Set(u().kNd(null==e?void 0:e.value).map((e=>e.id))),r=s().FormulaContextValueKind.ContextValue;return t.filter((e=>e.kind===r)).filter((e=>o.has(e.id)))}},660354:(e,t,o)=>{o.d(t,{v:()=>n});o(242343);var r=o(163643);const n=(0,o(680369).wt)("checkboxSquareChecked",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M2.85742 13.4561H11.1357C12.6123 13.4561 13.3779 12.6904 13.3779 11.2344V2.91504C13.3779 1.45215 12.6123 0.693359 11.1357 0.693359H2.85742C1.38086 0.693359 0.615234 1.45215 0.615234 2.91504V11.2344C0.615234 12.6973 1.38086 13.4561 2.85742 13.4561ZM2.93945 12.1162C2.30371 12.1162 1.95508 11.7812 1.95508 11.1182V3.02441C1.95508 2.36133 2.30371 2.0332 2.93945 2.0332H11.0537C11.6826 2.0332 12.0381 2.36133 12.0381 3.02441V11.1182C12.0381 11.7812 11.6826 12.1162 11.0537 12.1162H2.93945ZM6.26855 10.3115C6.51465 10.3115 6.72656 10.1885 6.87012 9.96973L9.92578 5.19141C10.0146 5.04785 10.0967 4.88379 10.0967 4.72656C10.0967 4.3916 9.7959 4.16602 9.47461 4.16602C9.26953 4.16602 9.08496 4.27539 8.94141 4.50781L6.24121 8.8418L4.96973 7.22168C4.80566 7.00977 4.6416 6.93457 4.43652 6.93457C4.10156 6.93457 3.8418 7.20117 3.8418 7.54297C3.8418 7.70703 3.90332 7.85742 4.01953 8.00098L5.63281 9.96973C5.81738 10.209 6.01562 10.3115 6.26855 10.3115Z"})})},663821:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleDownSmallIcon:()=>n,iconDefinition:()=>r});o(242343);const r={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"m12.76 6.52-4.32 4.32a.62.62 0 0 1-.44.18.62.62 0 0 1-.44-.18L3.24 6.52a.63.63 0 0 1 0-.88c.24-.24.64-.24.88 0L8 9.52l3.88-3.88c.24-.24.64-.24.88 0s.24.64 0 .88"})},n=(0,o(680369).wt)("arrowChevronSingleDownSmall",r)},688142:(e,t,o)=>{o.d(t,{_:()=>Q});o(610931),o(362833),o(725707),o(491955),o(403517);var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(174114),l=()=>o(762847),s=()=>o(807912),u=()=>o(465546),c=()=>o(162901),p=()=>o(870122),d=()=>o(214144),m=()=>o(145017),g=()=>o(21164),y=()=>o(653998),h=()=>o(188877),f=()=>o(975392),v=()=>o(76394),x=()=>o(725460),S=()=>o(535906),b=()=>o(401382),C=()=>o(935091),k=()=>o(932322),A=()=>o(858023),T=()=>o(397791),M=()=>o(701513),j=()=>o(88271),P=()=>o(103151),_=()=>o(24e3),I=()=>o(23082),w=()=>o(749975),V=()=>o(782422),R=()=>o(439111),N=()=>o(906230),B=()=>o(129978),F=()=>o(509484),E=()=>o(359441),O=()=>o(907721),D=()=>o(485966),W=()=>o(210466),L=()=>o(413871),K=()=>o(271142),H=()=>o(441911),q=o(163643);const z=(0,y().YK)({searchInputPlaceholder:{defaultMessage:"Type to search…",id:"automations.AutomationTargetPickerMenu.search.placeholder"},searchInputPlaceholderUrlsAllowed:{defaultMessage:"Type to search or paste a link…",id:"automations.AutomationTargetPickerMenu.search.placeholderUrlsAllowed"}}),Y=5,U=20,$=20;function Q(e){const t=(0,H().e)({maxWidth:360,width:280}),o=(0,r.useMemo)((()=>d().JW()),[]);return(0,q.jsx)(C().A,{...t,children:(0,q.jsx)(Z,{...e,searchSessionId:o})})}const G=Object.values(l().xd).filter((e=>e!==l().xd.form)),X=[l().xd.form];function Z(e){const{formulaTypecheckContextValues:t,includeThisPage:o,onChange:i,onClose:l,parentRecordStore:d,selectedTarget:m,skipCollections:b,skipPages:C,skipVariables:H,spaceId:z,urlBehavior:U}=e,Q=(0,a().uB)(void 0,W().A),Z=(0,K().YC)(),ae=(0,a().K8)((()=>{if(H)return[];if((0,v().O9)(t)&&t.length>0){return Object.values(t).filter((e=>{if(!(0,u().o5)(e.type,{type:"block"}))return!1;if(!o&&"event"===(null==Z?void 0:Z.contextType)&&e.kind===s().FormulaContextValueKind.ContextValue){const t=(0,u().y5)(e.id);return!("global"===t.source&&"button_page"===t.global)}return!0}))}return[]}),[o,H,t,null==Z?void 0:Z.contextType],{useDeepEqual:!0}),[ie]=(0,r.useState)((()=>"url"===(null==m?void 0:m.type)?m.url:"")),[le,se]=(0,r.useReducer)(te,{automationVariables:[],collectionQueryLimit:Y,pageQueryLimit:Y,formQueryLimit:Y,searchTerm:ie});(0,r.useEffect)((()=>{if(le.searchTerm){const e=(0,h().Ay)(le.searchTerm,ae,(e=>e.kind===s().FormulaContextValueKind.ContextValue?e.name:""));se({type:"set_variables",variables:e})}else se({type:"set_variables",variables:ae})}),[le.searchTerm,ae]);const ue=function(e){const{limit:t,searchTerm:o,skip:i}=e,l=(0,n().v3)(),s=(0,a().K8)((()=>(0,V().ao)()),[]),u=(0,a().O$)(D().AppStoreCurrentSpaceStore),p=(0,w().Ks)(),d=(0,a().K8)((()=>null==p?void 0:p.collectionViewBlockStore()),[p]),[m,g]=(0,r.useReducer)(oe,{error:void 0,isLoading:Boolean(i),results:void 0,total:void 0}),y=(0,B().fJ)(F().T.searchActions),[h]=(0,c().Yb)((async()=>{if(i||!s||"resolved"!==y.status)return;const e=y.value,r=await e.searchCollectionsWithRecents({collectionViewBlockStore:d,environment:l,spaceStore:u,limit:t,parentStore:s,query:o,requireEditPermissions:!0,searchSessionId:void 0});return{results:r.results,total:r.total}}),[i,s,y.status,y.value,d,l,u,t,o],{debounce:E().tu});return(0,r.useEffect)((()=>{if("pending"===h.status||"idle"===h.status)g({type:"query_loadstart"});else if("resolved"===h.status){var e,t;g({results:null===(e=h.value)||void 0===e?void 0:e.results,total:null===(t=h.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===h.status?g({error:h.error,type:"query_error"}):(0,v().HB)(h)}),[h]),m}({limit:le.collectionQueryLimit,searchTerm:le.searchTerm,skip:b}),ce=re({limit:le.pageQueryLimit,searchTerm:le.searchTerm,skip:C,spaceId:z,blockTypes:G}),pe=re({limit:le.pageQueryLimit,searchTerm:le.searchTerm,skip:C,spaceId:z,blockTypes:X}),de=(0,v().O9)(U)?(0,R().KX)(le.searchTerm):void 0,me=(0,r.useCallback)((e=>{m&&!f().n4(m,e)?i(e):m?l():i(e)}),[m,i,l]),ge=(0,r.useCallback)((e=>{const t=e.target.value;se({searchTerm:t,type:"set_search_term"}),Q.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[Q]),ye=(0,r.useCallback)((()=>{se({queryLimit:le.collectionQueryLimit+$,type:"set_collection_query_limit"})}),[le.collectionQueryLimit]),he=(0,r.useCallback)((()=>{se({queryLimit:le.pageQueryLimit+$,type:"set_page_query_limit"})}),[le.pageQueryLimit]),fe=(0,r.useCallback)((()=>{se({queryLimit:le.formQueryLimit+$,type:"set_form_query_limit"})}),[le.formQueryLimit]),ve="variable"===(null==m?void 0:m.type)?m.id:void 0,xe="collection"===(null==m?void 0:m.type)?m.collection.id:void 0,Se="page"===(null==m?void 0:m.type)?m.page.id:void 0,be=[],Ce=function(e){const{automationVariables:t,onClick:o,selectedVariableId:r,parentRecordStore:n}=e,a=t.map((e=>{if(e.kind!==s().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");return{action:()=>o({id:e.id,type:"variable"}),key:e.id,render:t=>(0,q.jsx)(_().A,{contextValue:e,isChecked:e.id===r,menuArgs:t,parentRecordStore:n})}}));if(0===a.length)return;return{key:"variable_results",items:a,render:e=>(0,q.jsx)(j().A,{...e,title:(0,q.jsx)(y().sA,{defaultMessage:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})})}}({automationVariables:le.automationVariables,onClick:me,selectedVariableId:ve,parentRecordStore:d});Ce&&be.push(Ce);const ke=function(e){const{urlResult:t,urlBehavior:o,onMenuItemClick:r}=e;if(!t||!o)return;if("notion"===t.type);else{if("web"===t.type||"other"===t.type){const e=[],n={title:t.url,icon:(0,q.jsx)(T().I,{icon:p().globeIcon})};return"allow"===o?e.push({action:()=>{r({type:"url",url:t.url})},key:"url",render:e=>(0,q.jsx)(S().A,{...e,...n})}):"disallow_with_message"===o?e.push({action:()=>{},key:"url",render:e=>(0,q.jsx)(P().A,{placement:O().W.Right,render:t=>(0,q.jsx)(S().A,{...(0,N().A)(t,e),disabled:!0,disabledFeedback:!0,...n}),renderTooltip:()=>(0,q.jsx)(y().sA,{defaultMessage:"Linking to a URL is only allowed if it is the first action in an automation.",id:"automations.AutomationTargetPickerMenu.urlSection.disabledMessage"})})}):(0,v().HB)(o),{key:"url_results",items:e,render:e=>(0,q.jsx)(j().A,{...e,title:(0,q.jsx)(y().sA,{defaultMessage:"Link",id:"automations.AutomationTargetPickerMenu.urlSection.sectionTitle"})})}}(0,v().HB)(t.type)}}({urlResult:de,urlBehavior:U,onMenuItemClick:me});ke&&be.push(ke);const Ae=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:o,onShowMoreItemClick:r,parentRecordStore:n,selectedCollectionId:a}=e;if(t.isLoading)return;let i=[];if(t.error)i.push({action:r,key:"show_more_collection_results",render:e=>(0,q.jsx)(x().A,{...e,caption:(0,q.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0})});else{const e=t.results??[],l=e.length;i=e.map((e=>{const t=L().md.createChildStore(n,{table:g().Vl,id:e});return{action:()=>o({collection:t.getSpaceShardedPointer(),type:"collection"}),key:e,render:o=>(0,q.jsx)(M().A,{...o,isChecked:e===a,store:t})}}));const s=t.total??0,u=Math.max(0,s-l);u>0&&i.push({action:r,key:"show_more_collection_results",render:e=>(0,q.jsx)(ee,{...e,showMoreCount:u})})}if(0===i.length)return;return{key:"collection_results",items:i,render:e=>(0,q.jsx)(j().A,{...e,title:(0,q.jsx)(y().sA,{defaultMessage:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})})}}({collectionQueryResult:ue,onCollectionMenuItemClick:me,onShowMoreItemClick:ye,parentRecordStore:d,selectedCollectionId:xe});Ae&&be.push(Ae);const Te=ne({type:"page",onPageMenuItemClick:me,onShowMoreItemClick:he,queryResult:ce,parentRecordStore:d,selectedPageId:Se});Te&&be.push(Te);const Me=ne({type:"form",onPageMenuItemClick:me,onShowMoreItemClick:fe,queryResult:pe,parentRecordStore:d,selectedPageId:Se});Me&&be.push(Me);const je=ue.isLoading||ce.isLoading||pe.isLoading;let Pe;if(be.length>0)Pe=(0,q.jsx)(A().Ay,{initialFocus:0,sections:be,store:Q,type:A().Oh.Vertical});else if(je){const e=Y+2;Pe=(0,q.jsxs)(j().A,{children:[(0,q.jsx)(I().A,{}),[...Array(e)].map(((e,t)=>(0,q.jsx)(k().Ay,{},t)))]})}else Pe=(0,q.jsx)(x().A,{caption:(0,q.jsx)(y().sA,{defaultMessage:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})});return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(J,{onChange:ge,value:le.searchTerm,urlsAllowed:"allow"===U}),Pe]})}function J(e){const{onChange:t,value:o,urlsAllowed:r}=e,{isMobile:a}=(0,n().Y0)(),l=(0,y().tz)(),s=(0,i().IS)((()=>({section:{paddingBlockStart:0,marginTop:12}})),[]);return(0,q.jsx)(j().A,{style:s.section,children:(0,q.jsx)(b().Ay,{focusInitial:!a||void 0,onChange:t,placeholder:l.formatMessage(r?z.searchInputPlaceholderUrlsAllowed:z.searchInputPlaceholder),showClearButton:!0,value:o??""})})}const ee=(0,r.forwardRef)((function(e,t){const{showMoreCount:r}=e,n=(0,i().IS)((e=>({showMoreButton:{color:e.text.secondary,fill:e.mediumIconColor}})),[]);return(0,q.jsx)(S().A,{...e,icon:(0,q.jsx)(T().I,{icon:o(794484).L}),ref:t,style:n.showMoreButton,title:(0,q.jsx)(y().sA,{defaultMessage:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(r,$)}})})}));function te(e,t){if("set_variables"===t.type)return{...e,automationVariables:t.variables.slice(0)};if("set_search_term"===t.type){const o=t.searchTerm?U:Y;return{...e,collectionQueryLimit:o,pageQueryLimit:o,searchTerm:t.searchTerm}}if("set_collection_query_limit"===t.type){if(e.collectionQueryLimit!==t.queryLimit)return{...e,collectionQueryLimit:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e.pageQueryLimit!==t.queryLimit)return{...e,pageQueryLimit:t.queryLimit}}else if("set_form_query_limit"===t.type){if(e.formQueryLimit!==t.queryLimit)return{...e,formQueryLimit:t.queryLimit}}else(0,v().HB)(t);return e}function oe(e,t){if("query_loadstart"===t.type){if(!e.isLoading)return{...e,isLoading:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,isLoading:!1,results:t.results,total:t.total};if("query_error"===t.type)return{...e,error:t.error,isLoading:!1,results:void 0,total:void 0};(0,v().HB)(t)}return e}function re(e){const{limit:t,searchTerm:o,skip:i,spaceId:l,blockTypes:s}=e,u=(0,n().v3)(),p=(0,a().O$)(D().AppStoreCurrentSpaceStore),[d,m]=(0,r.useReducer)(oe,{error:void 0,isLoading:Boolean(i),results:void 0,total:void 0}),[g]=(0,c().Yb)((async()=>{if(i||!l||!p)return;const e=await F().T.searchActions.load(),r=await e.searchPagesInSpace({boostRecentlyViewedPages:!0,environment:u,excludeTemplates:!0,limit:t,query:o,requireEditPermissions:!1,source:"automation_page_picker",spaceId:l,filterOverrides:{blockTypes:s},spaceStore:p});return{results:r.results.map((e=>e.id)),total:r.total}}),[s,u,t,o,i,l,p],{debounce:E().tu});return(0,r.useEffect)((()=>{if("pending"===g.status||"idle"===g.status)m({type:"query_loadstart"});else if("resolved"===g.status){var e,t;m({results:null===(e=g.value)||void 0===e?void 0:e.results,total:null===(t=g.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===g.status?m({error:g.error,type:"query_error"}):(0,v().HB)(g)}),[g]),d}function ne(e){const{type:t,queryResult:o,onPageMenuItemClick:r,onShowMoreItemClick:n,selectedPageId:a,parentRecordStore:i}=e;if(o.isLoading)return;const l=[];if(o.error)l.push({action:n,key:"show_more_page_results",render:e=>(0,q.jsx)(x().A,{...e,caption:(0,q.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0})});else{const e=(o.results??[]).length;for(const n of o.results??[]){const e=L().Bv.createChildStore(i,{table:m().ev,id:n}),t={key:n,render:t=>(0,q.jsx)(M().A,{...t,isChecked:n===a,store:e}),action:()=>r({page:e.getSpaceShardedPointer(),type:"page"})};l.push(t)}const t=o.total??0,s=Math.max(0,t-e);s>0&&l.push({action:n,key:"show_more_page_results",render:e=>(0,q.jsx)(ee,{...e,showMoreCount:s})})}return 0!==l.length?{key:"page"===t?"page_results":"form_results",items:l,render:e=>(0,q.jsx)(j().A,{...e,title:"page"===t?(0,q.jsx)(y().sA,{defaultMessage:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"}):(0,q.jsx)(y().sA,{defaultMessage:"Forms",id:"automations.AutomationTargetPickerMenu.formsSection.title"})})}:void 0}},700779:(e,t,o)=>{o.d(t,{F:()=>i});o(242343);var r=()=>o(174114),n=()=>o(126451),a=o(163643);function i(e){const{ariaLabel:t,disabled:o,icon:i,onClick:l,title:s}=e,u=(0,r().IS)((e=>({button:{alignItems:"center",border:`1px solid ${e.stroke.secondary}`,borderRadius:10,color:e.text.secondary,display:"flex",gap:8,justifyContent:"flex-start",padding:12},buttonHoveredStyle:{background:e.outlineButtonHoveredBackground},buttonPressedStyle:{background:e.buttonPressedBackground},iconContainer:{fill:e.icon.secondary,width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center"},title:{fontSize:14,lineHeight:"20px"}})),[]);return(0,a.jsxs)(n().A,{ariaLabel:t,disabled:o,disabledFeedback:o,onClick:l,style:u.button,hoveredStyle:u.buttonHoveredStyle,pressedStyle:u.buttonPressedStyle,children:[i&&(0,a.jsx)("div",{"aria-hidden":"true",style:u.iconContainer,children:i}),(0,a.jsx)("div",{style:u.title,children:s})]})}},718522:(e,t,o)=>{o.d(t,{A:()=>m});var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(950635),l=()=>o(630714),s=()=>o(409211),u=()=>o(34662),c=()=>o(415806),p=()=>o(271142),d=o(163643);function m(e){let{handleRemoveToken:t,token:o,style:m,isDisabled:g,preventOnClickPropagation:y}=e;const h=(0,n().Y0)(),{automationStore:f}=(0,p().EC)(),v=(0,a().K8)((()=>{if((0,l().isAnnotationSimpleValueToken)(o)&&(0,u().rie)(o)){const e=(0,u().NcG)(o);if(e)return(0,i().xC)({pointer:{table:s().oo,id:e},getRecordValue:f.getRecordModel})}}),[f.getRecordModel,o]),x=(0,r.useCallback)((()=>{t&&t(o)}),[t,o]);return null!=v&&v.asActor&&v.table===s().oo?(0,d.jsx)(c().Ay,{actor:v,format:h.isMobile?c().Ay.Format.Medium:c().Ay.Format.Small,showRemoveButton:Boolean(t)&&!g,onClickRemove:e=>{y&&(null==e||e.stopPropagation()),x()},shouldShrink:!0,isSingle:!1,style:m},v.id):null}},724175:(e,t,o)=>{o.d(t,{RY:()=>x,cn:()=>k,gI:()=>b,m9:()=>C,z$:()=>S});var r=o(242343),n=()=>o(803290),a=()=>o(174114),i=()=>o(916963),l=()=>o(723361),s=()=>o(653998),u=()=>o(76394),c=()=>o(31448),p=()=>o(273520),d=()=>o(206183),m=()=>o(962373),g=()=>o(179701),y=()=>o(993517),h=()=>o(100096),f=()=>o(400383),v=o(163643);function x(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n,propertySchema:i}=e,l=(0,a().IS)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),s=C({propertySchema:i}),u=k();return(0,v.jsx)(S,{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:n,propertyType:i.type,styles:l,tooltip:u,children:s})}function S(e){const{actionMenu:t,buttonPopupStore:o,children:n,disabled:s,onClick:p,propertyType:d,styles:m,tooltip:g,tooltipPlacement:f}=e,x=(0,a().IS)((e=>({content:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"}})),[]),S=(0,r.useCallback)((e=>(0,v.jsx)(h().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:s,icon:(0,u().O9)(d)?i().LE[d]:l().Q,onClick:p,styles:m,hideDragHandle:!0,children:(0,v.jsx)("div",{style:x.content,children:n})})),[t,o,n,s,p,m,d,x]);return(0,v.jsx)(y().P,{renderOrigin:S,title:g,tooltipPlacement:f})}function b(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,i=(0,g().j)(),l=(0,n().uB)(void 0,m().A),s=(0,r.useCallback)((()=>l.reset()),[l]);return(0,v.jsx)(p().Ay,{buttonPopupStore:l,popupType:i,render:()=>(0,v.jsx)(f().qM,{actionId:t,closeMenu:s,propertyId:o}),renderOrigin:a})}function C(e){const{propertySchema:t}=e,o=t.type,r=d().dC[o];return(0,v.jsx)(s().sA,{defaultMessage:'"{propertyTypeDisplayName}" property type is not supported',id:"updateThisPageUnsupportedPropertyAction.updatedUnsupportedProperty.titleElement",values:{propertyTypeDisplayName:r}})}function k(){return(0,v.jsx)(s().sA,{defaultMessage:"Change property type or delete to enable this automation",id:"updateThisPageUnsupportedPropertyAction.updatedUnsupportedProperty.title"})}},736708:(e,t,o)=>{o.d(t,{A:()=>T});o(362833),o(403517);var r=o(242343),n=()=>o(237385),a=()=>o(174114),i=(o(725707),o(491955),()=>o(807912)),l=()=>o(630714),s=()=>o(653998),u=()=>o(975392),c=()=>o(983050),p=()=>o(146447),d=()=>o(128192),m=()=>o(636045),g=()=>o(126996),y=()=>o(868199),h=()=>o(863969),f=o(163643);var v=()=>o(640979),x=()=>o(935091),S=()=>o(858023),b=()=>o(743668),C=()=>o(88271),k=()=>o(24e3),A=()=>o(360234);function T(e){const{currentSimpleFormulaValueTokens:t,disableEmojiCommands:o,disableFormulas:T,disableFormattingAndMentions:M,disableMobileActionBar:j,disableTemplateVariableMentions:P,formulaTypecheckContextValues:_,menuProps:I,onChange:w,onClose:V,parentRecordStore:R,showGenericHeader:N=!1,value:B}=e,{isMobile:F}=(0,n().Y0)(),{header:E,textInput:O,valueItems:D}=function(e){const{currentSimpleFormulaValueTokens:t,disableEmojiCommands:o,disableFormattingAndMentions:v,disableFormulas:x,disableMobileActionBar:S,disableTemplateVariableMentions:b,formulaTypecheckContextValues:C,onChange:k,onClose:A,parentRecordStore:T,value:M}=e,j=(0,s().tz)(),P=(0,r.useMemo)((()=>C.filter((e=>"text"===e.type.type))),[C]),_=(0,h().O)(),I=(0,r.useCallback)((e=>{k({type:"simple",value:e})}),[k]),w=(0,r.useCallback)((e=>{I(e),A()}),[I,A]),V=(0,r.useCallback)((e=>{const t=void 0!==e[0]?(0,l().toSimpleFormulaSingleValue)(e[0]):void 0;w(t)}),[w]),{store:R}=(0,g().AI)({initialValue:null==M?void 0:M.value,onChange:I}),{isMobile:N}=(0,n().Y0)(),B=(0,a().IS)((e=>({textWrap:{borderRadius:6,lineHeight:"24px",padding:1,...N?{boxShadow:"unset"}:{boxShadow:e.inputBoxShadow,margin:"0 12px"}},simpleFormulaText:{fontSize:12,width:"100%",...N?{padding:"10px"}:{padding:"0px 8px 8px 8px"}},text:{fontSize:12,maxHeight:120,overflow:"auto",...N?{background:"light"===e.mode?e.white:e.selectLightGray[200],margin:0,padding:"10px"}:{background:e.inputBackground,padding:"4px 10px"}}})),[N]),F=u().oE(P.map((e=>{if(e.kind===i().FormulaContextValueKind.ContextValue)return{action:"replace",currentSimpleFormulaValueTokens:t,id:e.id||"",setCurrentTokens:V,value:e}})));let E;return E=_&&T?(0,f.jsx)(p().Y,{...v?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},disabled:!1,disableEmojiCommands:o,disableFormulas:x,disableMobileActionBar:S,disableTemplateVariableMentions:b,formulaTypecheckContextValues:C,onChange:k,onTextEnter:A,parentRecordStore:T,spaceId:_,placeholder:j.formatMessage(d().D.propertyValuePlaceholder),style:B.simpleFormulaText,value:M}):(0,f.jsx)("div",{className:c().CCX,style:B.textWrap,children:(0,f.jsx)(m().A,{disableComment:!0,disabled:!1,disableEmbedMenu:!0,disableEmojiCommands:o,disableMobileActionBar:S,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableSlashCommands:!0,disableTemplateVariableMentions:b,...v?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},onEnter:A,pasteBehavior:"inline",store:R,style:B.text,inPageFind:y().Os.none,placeholder:j.formatMessage(d().D.propertyValuePlaceholder)})}),{header:j.formatMessage(d().D.genericMenuHeader),textInput:E,valueItems:F}}({currentSimpleFormulaValueTokens:t,disableFormulas:T,disableEmojiCommands:o,disableFormattingAndMentions:M,disableMobileActionBar:j,disableTemplateVariableMentions:P,formulaTypecheckContextValues:_,onChange:w,onClose:V,parentRecordStore:R,value:B})||{},W=(0,a().IS)((e=>({header:{...F&&{borderBlockEnd:`1px solid ${e.lightDividerColor}`}}})),[F]),L=(0,r.useMemo)((()=>D.map((e=>{const{annotation:t,itemAction:o}=(0,A().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,f.jsx)(k().A,{annotation:t,disabled:!1,menuArgs:e,parentRecordStore:R}),action:o}}))),[D,R]),K=[];let H;L.length>0&&K.push({key:"textbox",render:e=>(0,f.jsx)(C().A,{...e}),items:L}),H=F?{menuType:v().gu.Modal,right:(0,f.jsx)(b().DoneMenuText,{}),onClickRight:V,minWidth:260}:{menuType:v().gu.Popup,maxHeight:"50vh",width:260,disableHeaderBorder:!0};const q=N&&(0,f.jsx)(C().A,{style:{paddingBottom:0},title:E}),z=(0,f.jsxs)("div",{style:W.header,children:[!F&&((null==I?void 0:I.header)||q),(0,f.jsx)(C().A,{children:O})]}),Y=(0,f.jsx)(S().Ay,{initialFocus:0,sections:K,type:S().Oh.Vertical});return{headerDiv:z,innerComponents:Y,textMenu:(0,f.jsx)(x().A,{...H,...I,header:z,children:Y})}}},738355:(e,t,o)=>{o.d(t,{b:()=>l,k:()=>s});o(610931);var r=o(242343),n=()=>o(803290),a=()=>o(271142),i=()=>o(836471);function l(){return(0,r.useContext)(i().A)}function s(){const{automationStore:e}=(0,a().EC)(),{collectionStore:t,...o}=l(),r=(0,n().K8)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("recurrence")))throw new Error("automationStore is wrong type. Is this called in the wrong type of automation?");return e}),[e]);if(!t)throw new Error("collectionStore is undefined. Is this rendered inside an AutomationEditorContext.Provider?");return{...o,collectionStore:t,automationStore:r}}},756567:(e,t,o)=>{o.d(t,{Y:()=>p,h:()=>c});o(362833),o(725707),o(491955),o(244387),o(242343);var r=()=>o(803290),n=()=>o(950635),a=()=>o(15552),i=()=>o(271142),l=()=>o(658722),s=()=>o(999011),u=o(163643);function c(e){const{filter:t,propertySchema:o,onClick:n}=e,{automationStore:a}=(0,i().EC)(),c=(0,r().K8)((()=>p(t,a.getRecordModel)),[a.getRecordModel,t]),{title:d,tooltipTitle:m,styles:g}=(0,l().oG)({actorModels:c,messageType:"trigger",operator:t.operator,propertySchema:o});return(0,u.jsx)(s().z,{onClick:n,tooltip:(0,u.jsx)("span",{children:m}),children:(0,u.jsx)("div",{style:g.content,children:d})})}function p(e,t){return(0,a().Wf)(e).reduce(((e,o)=>("exact"===o.type&&o.value&&e.push((0,n().xC)({pointer:o.value,getRecordModel:t})),e)),[])}},794772:(e,t,o)=>{o.d(t,{V:()=>l});o(725707),o(491955),o(403517);var r=()=>o(355149),n=()=>o(76394),a=()=>o(485966),i=()=>o(133926);function l(e){var t,o,l,s;const{triggerType:u,environment:c,automationStore:p}=e;if(null==p||!p.isDefined())return!0;const d=(0,r().Z)(u),m=a().default.state,g=(0,i().zD)(c,{name:"premium_automations",spaceId:null===(t=m.currentSpaceStore)||void 0===t?void 0:t.id,userId:null===(o=m.currentUserStore)||void 0===o?void 0:o.id}),y=(0,i().zD)(c,{name:"slack_automation_action",spaceId:null===(l=m.currentSpaceStore)||void 0===l?void 0:l.id,userId:null===(s=m.currentUserStore)||void 0===s?void 0:s.id});return d.isAvailableForContext({automation:p.getModel(),automationActions:p.getActionStores().map((e=>e.getModel())).filter(n().O9),hasPremiumAutomations:g,hasAccessToSlackAction:y})}},800995:(e,t,o)=>{o.d(t,{A:()=>p});var r=o(242343),n=()=>o(220413),a=()=>o(76394),i=o(163643);function l(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonBackground,boxShadow:t.buttonBoxShadow,color:"white"};case"secondary":return{background:n().Ay.frontSecondaryButtonBackground,boxShadow:`\n\t\t\t\t\t0 1px 2px rgba(15, 15, 15, 0.1),\n\t\t\t\t\tinset 0 0 0 1px ${n().Ay.redWithAlpha(.3)}`,color:n().Ay.red};case"tertiary":case"aiTertiary":return{background:n().Ay.white,color:n().Ay.frontTextDark,border:"1px solid rgba(15, 15, 15, 0.15)",width:"100%",boxShadow:"0 1px 2px rgba(15, 15, 15, 0.05)"};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackground,border:`1px solid ${n().Ay.frontQuaternaryButtonBorder}`,boxShadow:"0 1px 2px rgba(15, 15, 15, 0.1)",color:"white"};case"aiPrimary":return{background:"#CA59FF",color:"white"};case"lightGray":return{background:t.tint.regular,color:t.text.secondary};default:(0,a().HB)(e)}}function s(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonHoveredBackground};case"secondary":return{background:n().Ay.frontSecondaryButtonBackgroundHovered};case"tertiary":return{background:"light"===t.mode?t.buttonHoveredBackground:n().Ay.whiteWithAlpha(.8)};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackgroundHovered};case"aiPrimary":case"aiTertiary":return{background:"#C592DD"};case"lightGray":return{background:t.tint.regular,color:t.text.primary};default:(0,a().HB)(e)}}function u(e,t){switch(e){case"primary":return{background:n().Ay.frontBlueButtonPressedBackground};case"secondary":return{background:t.buttonPressedBackground};case"tertiary":return{background:"light"===t.mode?t.buttonPressedBackground:n().Ay.whiteWithAlpha(.85)};case"quaternary":return{background:n().Ay.frontQuaternaryButtonBackgroundPressed};case"aiPrimary":case"aiTertiary":return{background:"#946EA6"};case"lightGray":return{background:t.state.pressed,color:t.text.primary};default:(0,a().HB)(e)}}function c(e,t){const{id:r,children:n,disabledFeedback:a,isFullWidth:c,isLoading:p,onClick:d,style:m,variant:g,...y}=e,h=(0,o(174114).DP)(),f={display:"inline-grid",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:4,fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:o(31448).Wy.medium,...p&&{gridTemplateColumns:"1fr auto 1fr"},transition:"background-color color 150ms ease"};return(0,i.jsx)(o(126451).A,{ref:t,id:r,onClick:d,style:{...f,...l(g,h),...m,...c&&{width:"100%",justifyContent:"center"}},hoveredStyle:s(g,h),pressedStyle:u(g,h),loadingSpinnerStyle:{marginLeft:"auto"},isLoading:p,disabledFeedback:a,...y,children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center"},children:n})})}const p=r.memo(r.forwardRef(c),o(21045).A)},824678:(e,t,o)=>{o.d(t,{VW:()=>g,aR:()=>m});o(242343);var r=()=>o(803290),n=()=>o(174114),a=()=>o(752903),i=()=>o(653998),l=()=>o(76394),s=()=>o(31448),u=()=>o(809785),c=()=>o(275334),p=()=>o(536992),d=o(163643);function m(e){const{numberValue:t,operator:o,propertySchema:m,messageType:y}=e,h=(0,i().tz)(),f=(0,n().IS)((()=>({content:{alignItems:"center",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium},propertyValue:{...s().RC,paddingBlockStart:4}})),[]),v=(0,r().K8)((()=>function(e){const{numberValue:t,operator:o,propertySchema:r,styles:n,messageType:s,intl:m}=e,g=(0,d.jsx)("span",{style:n.propertyName,children:r.name});let y;const h=m.formatMessage(p().$R[o].text).toLocaleLowerCase();"action"===s?y=c().vC({propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1,style:{flex:"none"}}),operator:h}):"trigger"===s?y=c().Rn({propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1,style:{flex:"none"}}),operator:h}):(0,l().HB)(s);return(0,d.jsx)(i().sA,{...y})}({intl:h,messageType:y,numberValue:t,operator:o,propertySchema:m,styles:f})),[y,t,o,m,f,h]);return{tooltipTitle:(0,r().K8)((()=>g({intl:h,messageType:y,numberValue:t,operator:o,propertySchema:m})),[h,y,t,o,m]),title:v,styles:f}}function g(e){const{numberValue:t,operator:o,propertySchema:r,messageType:n,intl:a}=e,s=r.name;let u;const m=a.formatMessage(p().$R[o].text).toLocaleLowerCase();return"action"===n?u=c().vC({propertyName:s,propertyValues:t,operator:m}):"trigger"===n?u=c().Rn({propertyName:s,propertyValues:t,operator:m}):(0,l().HB)(n),(0,d.jsx)(i().sA,{...u})}},834508:(e,t,o)=>{o.d(t,{a:()=>b,y:()=>v});o(725707),o(491955),o(500234),o(403517),o(242343);var r=()=>o(174114),n=()=>o(15552),a=()=>o(716605),i=()=>o(752903),l=()=>o(653998),s=()=>o(76394),u=()=>o(31448),c=()=>o(837809),p=()=>o(809785),d=()=>o(898266),m=()=>o(275334),g=()=>o(387652),y=()=>o(999011),h=o(163643);const f=5;function v(e){const t=(0,l().tz)(),{filter:o,limit:r=f,propertySchema:a,onClick:i}=e,u=a.name,c=(0,n().V6)(o),p=c.map((e=>"is_group"===e.type?e.value:void 0)).filter(s().O9),d=c.map((e=>"is_option"===e.type?e.value:void 0)).filter(s().O9),m=b({intl:t,groupValues:p,limit:r,optionValues:d,propertySchema:a}),g=b({intl:t,isText:!0,groupValues:p,limit:r,optionValues:d,propertySchema:a});return(0,h.jsx)(y().z,{onClick:i,tooltip:(0,h.jsx)(S,{propertyName:u,statusValues:g}),children:(0,h.jsx)(x,{propertyName:u,statusValues:m})})}function x(e){let{propertyName:t,statusValues:o}=e;const n=(0,l().tz)(),a=(0,r().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),i=n.formatList(o,{style:"long",type:"disjunction"});return(0,h.jsx)("div",{style:a.content,children:(0,m().Yx)(n,{propertyName:(0,h.jsx)("span",{style:a.propertyName,children:t}),propertyValues:(0,d().d)(i)})})}function S(e){let{propertyName:t,statusValues:o}=e;const n=(0,l().tz)(),a=(0,r().IS)((()=>({propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),i=n.formatList(o,{style:"long",type:"disjunction"});return(0,h.jsx)(h.Fragment,{children:(0,m().Yx)(n,{propertyName:(0,h.jsx)("span",{style:a.propertyName,children:t}),propertyValues:(0,d().d)(i)})})}function b(e){let{groupValues:t,intl:o,isText:r,limit:n,optionValues:l,propertySchema:u,tokenFormat:d=i().NY.Medium}=e;const y=u.groups||[],f=u.options||[],v=t.map((e=>{const t=y.find((t=>t.name===e));if(t)return r?t.name:(0,h.jsx)(c().q,{format:d,isSingle:!0,value:t.name,color:t.color,groupColor:null==t?void 0:t.color,showRemoveButton:!1,showEllipsis:!1},t.id)})).filter(s().O9),x=l.map((e=>{const t=(0,a().jy)(f,e);if(void 0===t)return r?(0,m().iy)(o):(0,h.jsx)(g().A,{tokenFormat:d},`missing_option_value_${e}`);if(r)return t.value;const n=y.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,h.jsx)(c().q,{format:d,isSingle:!0,value:t.value,color:t.color,groupColor:null==n?void 0:n.color,showRemoveButton:!1,showEllipsis:!0},t.id)})),S=[...v,...x];let b=[];if(void 0!==n&&S.length>n){const e=x.length-n,t=r?`+${e}`:(0,h.jsx)(p().A,{format:i().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");b=[...x.slice(0,n),t]}else b=S;return b}},886087:(e,t,o)=>{o.d(t,{AK:()=>n,ew:()=>a});class r extends(()=>o(129044))().default{getInitialState(){return{insertionPoint:void 0,stack:[]}}getCurrentTab(){return o(975392).HV(this.getState().stack)}getInsertionPoint(){return this.getState().insertionPoint}pushSettingsItem(e){this.update((t=>({...t,stack:[...t.stack,e]})))}popSettingsItem(){this.update((e=>({...e,stack:e.stack.slice(0,e.stack.length-1)})))}replaceSettingsItem(e){this.update((t=>{const o=[...t.stack.slice(0,t.stack.length-1),e];return{...t,stack:o}}))}setInsertionPoint(e){this.update((t=>({...t,insertionPoint:e})))}}class n extends r{}class a extends r{}},898266:(e,t,o)=>{o.d(t,{d:()=>n});o(362833),o(242343);var r=o(163643);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(e))return[e];const o=[];for(const n of e)if("string"==typeof n&&" "!==n[0]){const e=o.pop();o.push((0,r.jsxs)("div",{style:t,children:[e,n]}))}else o.push(n);return o}},929841:(e,t,o)=>{o.d(t,{xB:()=>ne,Kn:()=>ce,ck:()=>le,vV:()=>ie});o(725707),o(113085);var r=o(242343),n=()=>o(237385),a=()=>o(803290),i=()=>o(174114),l=()=>o(263873),s=()=>o(680369),u=()=>o(653998),c=()=>o(76394),p=()=>o(31448),d=()=>o(273520),m=()=>o(356813),g=()=>o(397791),y=(o(491955),o(403517),()=>o(535906)),h=()=>o(88271),f=()=>o(575460),v=o(163643);function x(e){let{disabled:t,handleSelectOperator:o,selectedItem:a}=e;const l=(0,n().Y0)(),s=(0,i().IS)((e=>({buttonWrap:{height:"initial"},buttonStyle:{fontSize:l.isMobile?14:12,height:18,lineHeight:"unset",marginRight:2,marginLeft:2,paddingLeft:2,paddingRight:2,textTransform:"lowercase",fontWeight:p().Wy.semibold,...t?{opacity:"unset",color:"unset"}:{color:e.text.tertiary}},downIconStyle:{...t?{fill:"unset",opacity:"unset"}:{fill:e.text.tertiary}}})),[l.isMobile,t]),c=Object.values(b).filter((e=>e.shown)),m=(0,r.useMemo)((()=>b[a].shown?b[a]:b.all),[a]);return(0,v.jsx)(f().A,{disabled:t,alignmentToOrigin:d().yP.Start,style:s.buttonWrap,innerButtonStyle:s.buttonStyle,downIconStyle:s.downIconStyle,selectedTitle:(0,v.jsx)(u().sA,{...m.text}),renderMenuSections:e=>[{key:"selectTriggerOperator",render:e=>(0,v.jsx)(h().A,{...e}),items:c.map((t=>({key:t.value,action:()=>{o(t.value),e.close()},render:e=>(0,v.jsx)(y().A,{...e,title:(0,v.jsx)(u().sA,{...t.text})})})))}]})}const S=(0,u().YK)({all:{id:"automations.builderModal.propertyTrigger.all",defaultMessage:"All"},any:{id:"automations.builderModal.propertyTrigger.any",defaultMessage:"Any"}}),b={all:{text:S.all,value:"all",shown:!0},some:{text:S.any,value:"some",shown:!0},none:{shown:!1,value:"none"},any:{shown:!1,value:"any"}};var C=()=>o(271142),k=()=>o(179701),A=()=>o(466207),T=()=>o(700779);const M={viewBox:"0 0 20 20",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 1.067 15.176 1.5 1.5 0 0 1-.315-.52l-.246-.676q-.25.02-.506.02a6.375 6.375 0 1 1 6.288-5.318l.439.222c.301.152.519.38.654.64A7.625 7.625 0 0 0 10 2.375"}),(0,v.jsx)("path",{d:"m13.684 15.203-.532-.582-.437 1.149-.32.838a.25.25 0 0 1-.468-.004L9.315 9.418a.25.25 0 0 1 .347-.308l6.501 3.285a.249.249 0 0 1-.027.458l-.534.191-1.4.505 2.852 3.12a.748.748 0 1 1-1.108 1.008l-1.413-1.545z"}),(0,v.jsx)("path",{d:"M14.75 10q0 .14-.008.276l-1.26-.637a3.5 3.5 0 1 0-4.03 3.819l.47 1.291A4.75 4.75 0 1 1 14.75 10"})]})},j=(0,s().wt)("cursorClick",M);var P=()=>o(275334),_=()=>o(10872);function I(){const e=(0,u().tz)(),{automationStore:t}=(0,C().EC)();if(!V(t))return null;const o=e.formatMessage(P().CV.triggerButtonClicked,{b:w});return(0,v.jsx)(_().X,{icon:j,tooltip:o,children:o})}function w(e){return(0,v.jsx)("span",{style:{fontWeight:p().Wy.medium},children:e})}function V(e){return(0,a().K8)((()=>Boolean(null==e?void 0:e.isTriggerType("button"))),[e])}function R(){const{automationStore:e}=(0,C().EC)(),{removePageAddedTrigger:t}=(0,A().p)(),o=(0,u().tz)(),r=(0,i().IS)((()=>({title:{fontWeight:p().Wy.medium}})),[]);if(!N(e))return null;const n=P().CH(o);return(0,v.jsx)(_().X,{icon:l().plusSmallIcon,onDelete:t,tooltip:n,children:(0,v.jsx)("div",{style:r.title,children:n})})}function N(e){return(0,a().K8)((()=>{if(null==e||!e.isTriggerType("event"))return!1;const t=e.getEventConfiguration();return Boolean(null==t?void 0:t.pagesAdded)}),[e])}var B=()=>o(613152),F=()=>o(69766);const E={viewBox:"0 0 16 16",svg:(0,v.jsx)("path",{d:"M8.708 1.978a.625.625 0 0 0-.884.884l.914.913H3.84c-1.14 0-2.065.925-2.065 2.065v4.78a.625.625 0 0 0 1.25 0V5.84c0-.45.365-.815.815-.815h4.898l-.914.913a.625.625 0 0 0 .884.884l1.98-1.98a.625.625 0 0 0 0-.884zM13.6 4.755a.625.625 0 0 0-.625.625v4.78c0 .45-.365.815-.815.815H7.263l.913-.913a.625.625 0 0 0-.884-.884l-1.98 1.98a.625.625 0 0 0 0 .884l1.98 1.98a.625.625 0 1 0 .884-.884l-.913-.913h4.897c1.14 0 2.065-.924 2.065-2.065V5.38a.625.625 0 0 0-.625-.625"})},O=(0,s().wt)("arrowSquareLeftRightSmall",E);var D=()=>o(695951),W=()=>o(748039),L=()=>o(284573),K=()=>o(266263);function H(){const{automationStore:e}=(0,C().EC)(),{removeRecurrenceTrigger:t}=(0,A().p)(),o=(0,i().IS)((e=>({title:{fontWeight:p().Wy.medium,display:"flex",gap:6,alignItems:"center"},badgeContainer:{alignItems:"center",display:"flex"},badge:{backgroundColor:e.tint.regular,color:e.text.secondary,marginLeft:8}})),[]),r=function(e){return(0,a().K8)((()=>Boolean(null==e?void 0:e.isTriggerType("recurrence"))),[e])}(e),n=(0,a().K8)((()=>(0,W().NH)(e)),[e]);return r?(0,v.jsx)(_().X,{icon:O,onDelete:t,children:(0,v.jsxs)("div",{style:o.title,children:[(0,v.jsx)(u().sA,{id:"RecurrenceTrigger.title",defaultMessage:"<span>Every </span>{frequency}",values:{frequency:(0,v.jsx)(q,{}),span:e=>(0,v.jsx)("span",{style:{flex:0},children:e})}}),n&&(0,v.jsx)(D().A,{style:o.badge,content:(0,v.jsx)("div",{style:o.badgeContainer,children:(0,v.jsx)(u().sA,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})})]})}):null}function q(){const e=(0,u().tz)(),{isMobile:t}=(0,n().Y0)(),{automationStore:o}=(0,C().EC)(),{changeRecurrenceSchedule:r}=(0,A().p)(),i=(0,a().K8)((()=>o.getRecurrence()),[o]),l=i?(0,W().LS)({intl:e,recurrence:i}):(0,v.jsx)(u().sA,{id:"RecurrenceTrigger.frequency",defaultMessage:"frequency"}),s=(0,K().$)({recurrence:i,onChange:r,disabled:!1,autoFocusIfNew:!0});return(0,v.jsx)(d().Ay,{...s,popupType:t?d().z7.SlideUp:d().z7.Popup,placementToOrigin:d().sx.Bottom,renderOrigin:e=>(0,v.jsx)(L().x,{...e,isCompact:!0,dropdownButtonType:"dropdown",hasActionRequired:!(0,c().O9)(i),children:l})})}o(610931);var z=()=>o(403323),Y=()=>o(226567),U=()=>o(935091),$=()=>o(858023),Q=()=>o(286404),G=()=>o(640979),X=()=>o(738355),Z=()=>o(551078);const J=(0,u().YK)({hours:{defaultMessage:"hours",id:"RelativeDateTrigger.hours"},days:{defaultMessage:"days",id:"RelativeDateTrigger.days"}}),ee=["hours","days"];function te(e){let{currentValue:t,onSelect:o}=e;const r=(0,u().tz)();return(0,v.jsx)(U().A,{menuType:G().gu.Popup,children:(0,v.jsx)($().Ay,{type:$().Oh.Vertical,initialFocus:ee.indexOf(t),sections:[{key:"main",items:ee.map((e=>({key:e,action:()=>o(e),render:t=>(0,v.jsx)(y().A,{...t,title:r.formatMessage(J[e])})}))),render:e=>(0,v.jsx)(h().A,{...e})}]})})}function oe(){const{automationStore:e,collectionStore:t}=(0,X().k)(),{disabled:o}=(0,X().b)(),{updateRelativeDateTrigger:n,removeRelativeDateTrigger:l}=(0,A().p)(),s=(0,u().tz)(),c=(0,a().K8)((()=>{var o;const r=t.getModel();if(!r||!e.isTriggerType("event"))return;const n=r.getNormalizedSchema(),a=null===(o=e.getEventConfiguration())||void 0===o||null===(o=o.relativeDate)||void 0===o?void 0:o.property;if(!a)return;const i=n[a];return i?i.name:void 0}),[e,t]),m=(0,i().IS)((e=>({container:{display:"flex",alignItems:"center",gap:8},button:{padding:"0 12px"},numberInput:{width:70},before:{color:e.text.secondary},propertyName:{fontWeight:p().Wy.medium}})),[]),g=(0,i().IS)((e=>({headerWrap:{alignItems:"center"}})),[]),y=(0,a().K8)((()=>{var t;return null!=e&&e.isTriggerType("event")?null===(t=e.getEventConfiguration())||void 0===t?void 0:t.relativeDate:null}),[e]),h=(0,r.useCallback)((e=>{if(!y)throw new Error("Relative date trigger not found");const{timeIncrement:t,timeValue:o}=e;let r;r="hours"===t?{type:"hours",hours:-o}:{type:"days",days:-o},n({propertyId:y.property,offset:r})}),[y,n]),f=(0,r.useCallback)((e=>{if(!y)throw new Error("Relative date trigger not found");void 0!==e&&h({timeIncrement:y.offset.type,timeValue:e})}),[h,y]),x=(0,a().K8)((()=>{if(!y)throw new Error("Relative date trigger not found");return-1*(("hours"===y.offset.type?y.offset.hours:y.offset.days)||0)}),[y]),S=(0,r.useCallback)((e=>{if(!y)throw new Error("Relative date trigger not found");h({timeIncrement:e,timeValue:x})}),[h,y,x]),b=(0,r.useCallback)((e=>void 0!==e&&!(e<-1e3||e>1e3)),[]);if(!re(e)||!y)return null;const C=P().vH(s);return(0,v.jsx)(_().X,{icon:z().clockSmallIcon,onDelete:l,tooltip:C,styles:g,children:(0,v.jsxs)("div",{style:m.container,children:[(0,v.jsx)(Z().b,{style:m.numberInput,currentValue:x,onChange:f,extraValidation:b}),(0,v.jsx)(d().Ay,{popupType:d().z7.Popup,render:e=>(0,v.jsx)(te,{currentValue:y.offset.type,onSelect:t=>{S(t),e.close()}}),renderOrigin:e=>(0,v.jsx)(Q().A,{...e,size:"lg",style:m.button,disabled:o,children:s.formatMessage(J[y.offset.type])}),disabled:o}),(0,v.jsx)("span",{style:m.before,children:(0,v.jsx)(u().sA,{id:"automations.RelativeDateTrigger.before",defaultMessage:"before"})}),(0,v.jsx)("span",{style:m.propertyName,children:c}),(0,v.jsx)(Y().A,{})]})})}function re(e){return(0,a().K8)((()=>{if(null==e||!e.isTriggerType("event"))return!1;const t=e.getEventConfiguration();return Boolean(null==t?void 0:t.relativeDate)}),[e])}const ne="automation-list-item automation-list-item-modal",ae=(0,u().YK)({newTriggerLabel:{defaultMessage:"New trigger",id:"collectionSettings.editAutomationView.triggerSection.newPlaceholder"},addTriggerLabel:{defaultMessage:"Add trigger",id:"collectionSettings.editAutomationView.triggerSection.placeholder"},addTriggerAriaLabel:{id:"collectionSettings.editAutomationView.addTrigger.iconButton",defaultMessage:"Add trigger"},builderModalTriggerTitleWithOperatorButton:{defaultMessage:"When {operatorButton} triggers occur",id:"builderModal.editAutomationView.triggerSection.titleWithOperator"},buttonBuilderTriggerTitleOrNoTriggers:{defaultMessage:"When",id:"builderModal.editAutomationView.buttonBuilderTriggerSection.title"}});function ie(){return(0,i().IS)((e=>({wrap:{position:"relative",paddingInline:1},list:{display:"flex",flexDirection:"column"}})),[])}function le(e){const{children:t}=e;return(0,v.jsx)("div",{className:ne,children:t})}function se(e){const{children:t}=e,o=ie();return(0,v.jsx)("div",{style:o.wrap,children:(0,v.jsx)("div",{style:o.list,children:t})})}function ue(e){const{variant:t,hasAnyTriggers:o}=e,n=(0,k().j)(),a=(0,u().tz)(),i=(0,r.useMemo)((()=>({type:"eventTriggers"})),[]);return(0,v.jsx)(d().Ay,{alignmentToOrigin:d().yP.Start,placementToOrigin:d().sx.Bottom,popupType:n,render:e=>(0,v.jsx)(F().A,{initialState:i,buttonPopupParent:e}),renderOrigin:e=>"icon"===t?(0,v.jsx)(m().A,{...e,ariaLabel:a.formatMessage(o?ae.addTriggerLabel:ae.newTriggerLabel),icon:l().plusSmallIcon,iconStyle:{height:s().Ev.sm,width:s().Ev.sm}}):(0,v.jsx)(T().F,{...e,ariaLabel:a.formatMessage(ae.addTriggerAriaLabel),icon:(0,v.jsx)(g().I,{icon:l().plusSmallIcon,size:"sm"}),title:(0,v.jsx)(u().sA,{...o?ae.addTriggerLabel:ae.newTriggerLabel})})})}function ce(e){const{isEditable:t}=e,{isMobile:o}=(0,n().Y0)(),{showAnyPropertyTriggers:r,showButtonClickedTrigger:l,showPageAddedTrigger:s,showRecurrenceTrigger:c,showRelativeDateTrigger:d}=function(){const{automationStore:e}=(0,C().EC)(),t=V(e),o=N(e),r=(0,B().CD)(e),n=(0,a().K8)((()=>Boolean(e.isTriggerType("recurrence"))),[e]),i=re(e);return{showAnyPropertyTriggers:r,showPageAddedTrigger:o,showButtonClickedTrigger:t,showRecurrenceTrigger:n,showRelativeDateTrigger:i}}(),m=r||l||s||c||d,g=!c,y=(0,i().IS)((e=>({section:{display:"flex",flexDirection:"column",gap:4,width:"100%"},header:{alignItems:"center",display:"flex",flexDirection:"row"},title:{color:e.text.tertiary,fontSize:o?14:12,lineHeight:1.3,fontWeight:p().Wy.medium}})),[o]),{contextType:h}=(0,C().EC)(),f="button_property"===h||"button_block"===h;return(0,v.jsxs)("section",{style:y.section,children:[(0,v.jsx)("header",{style:y.header,children:(0,v.jsx)("div",{style:y.title,children:f?(0,v.jsx)(u().sA,{...ae.buttonBuilderTriggerTitleOrNoTriggers}):(0,v.jsx)(pe,{disabled:!t})})}),(0,v.jsxs)(se,{children:[l&&(0,v.jsx)(I,{}),s&&(0,v.jsx)(R,{}),r&&(0,v.jsx)(B().Js,{}),d&&(0,v.jsx)(oe,{}),t&&g&&(0,v.jsx)(ue,{hasAnyTriggers:m,variant:"button"}),c&&(0,v.jsx)(H,{})]})]})}function pe(e){let{disabled:t}=e;const{automationStore:o}=(0,C().EC)(),{updateTriggerOperator:n}=(0,A().p)(),l=(0,a().K8)((()=>{if(null==o||!o.isTriggerType("event"))return"some";const e=o.getEventConfiguration();return(null==e?void 0:e.pagePropertiesEdited.type)||"all"}),[o]),s=(0,a().K8)((()=>{if(null==o||!o.isTriggerType("event"))return 0;const e=o.getEventConfiguration(),t=null==e?void 0:e.pagePropertiesEdited;return t?"any"===t.type||"none"===t.type?0:"all"===t.type?(null===(r=t.all)||void 0===r?void 0:r.length)??0:"some"===t.type?(null===(n=t.some)||void 0===n?void 0:n.length)??0:void(0,c().HB)(t):0;var r,n}),[o]),p=(0,r.useCallback)((e=>{n(e)}),[n]),d=(0,i().IS)((e=>({title:{alignItems:"center",display:"flex",flexWrap:"wrap",height:24}})),[]);return(0,v.jsx)("div",{style:d.title,children:(0,v.jsx)(u().sA,{...s>0?ae.builderModalTriggerTitleWithOperatorButton:ae.buttonBuilderTriggerTitleOrNoTriggers,values:{operatorButton:(0,v.jsx)(x,{disabled:t,handleSelectOperator:p,selectedItem:l})}})})}},993517:(e,t,o)=>{o.d(t,{P:()=>s});var r=o(242343),n=()=>o(174114),a=()=>o(103151),i=()=>o(907721),l=o(163643);function s(e){const{caption:t,disable:o,renderOrigin:s,title:u,tooltipAlignment:c,tooltipPlacement:p,disableTooltip:d}=e,m=(0,n().IS)((e=>({tooltipTitle:{margin:0},tooltipCaption:{color:e.text.contrastSecondary,margin:0}})),[]),g=(0,r.useCallback)((()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{style:m.tooltipTitle,children:u}),(0,l.jsx)("p",{style:m.tooltipCaption,children:t})]})),[t,u,m.tooltipCaption,m.tooltipTitle]);return(0,l.jsx)(a().A,{alignment:c||i().C.Center,delayThreshold:800,disableTooltip:o||d,placement:p||i().W.Bottom,render:s,renderTooltip:g,textWrap:!0})}},999011:(e,t,o)=>{o.d(t,{z:()=>p});var r=o(242343),n=()=>o(803290),a=()=>o(738355),i=()=>o(466207),l=()=>o(10872),s=()=>o(128290),u=()=>o(613152),c=o(163643);function p(e){const{property:t}=(0,r.useContext)(u()._B),{collectionStore:o}=(0,a().k)(),{removePropertyTrigger:p}=(0,i().p)(),d=(0,r.useCallback)((()=>{p(t)}),[t,p]),m=(0,n().K8)((()=>o.getSchema()),[o])[t],g=m?e=>(0,c.jsx)(s().P,{propertySchema:m,style:e}):void 0;return(0,c.jsx)(l().X,{icon:g,onDelete:d,...e,children:e.children})}}}]);