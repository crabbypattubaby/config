"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14358],{78245:(e,n,t)=>{t.d(n,{z:()=>a});t(242343);var s=()=>t(129978),o=t(163643);const i=new(s().O2)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await t.e(79883).then(t.bind(t,824997));return{CollectionItemCover:e}})),a=(0,s()._h)(i,(e=>e.CollectionItemCover),{renderLoading:(e,n)=>{const{coverHeight:s,coverSizeFormat:i,emptyGalleryCoverStyle:a,showEmptyGalleryCover:r}=n;return r?(0,o.jsx)(t(803291).t,{coverHeight:s,coverSizeFormat:i,emptyGalleryCoverStyle:a}):null}})},105429:(e,n,t)=>{t.d(n,{m:()=>o});class s extends(()=>t(129044))().default{getInitialState(){return{type:"uninitialized"}}isWriting(){return"filling"===this.state.type&&!this.state.haveAllBlocksCompletedAutofill&&!this.state.didInterruptStreaming}setIsWriting(e){var n;const{propertySchema:s,stores:o,sessionIdForAnalytics:i}=e,a=o[0].getAssociatedCollectionId()??(null===(n=o[0].getCollectionStore())||void 0===n?void 0:n.id),r=i||t(214144).JW();return this.setState({type:"filling",propertySchema:s,collectionId:a,numBlocksToAutofill:o.length,numBlocksAutofilled:0,sessionId:r,didInterruptStreaming:!1,haveAllBlocksCompletedAutofill:!1}),r}}const o=new s},213255:(e,n,t)=>{t.d(n,{A:()=>i});t(242343);var s=t(163643);const o={viewBox:"0 0 20 20",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M8.65 8.25a.625.625 0 1 0 0 1.25h.725v3.25H8.65a.625.625 0 1 0 0 1.25h2.7a.625.625 0 1 0 0-1.25h-.725V8.875A.625.625 0 0 0 10 8.25zM10.7 6.3a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,s.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,t(680369).wt)("infoCircle",o)},611506:(e,n,t)=>{t.d(n,{p:()=>o});t(242343);var s=t(163643);const o=(0,t(680369).wt)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},665972:(e,n,t)=>{t.r(n),t.d(n,{UniversalQnaModals:()=>Bt});var s=t(242343),o=()=>t(237385),i=()=>t(803290),a=()=>t(162901),r=()=>t(108797),c=()=>t(366470),l=()=>t(863969),d=()=>t(622286),u=()=>t(980936),g=()=>t(873573),p=()=>t(485966),m=()=>t(840024),h=()=>t(836331),v=()=>t(14944),f=()=>t(330469),y=()=>t(133926),x=()=>t(113920),_=()=>t(688522),S=(t(403517),()=>t(174114)),j=()=>t(869570),b=()=>t(653998),C=()=>t(31448),w=()=>t(818369),k=()=>t(437071),A=()=>t(126451),I=()=>t(457197),T=()=>t(922172),M=()=>t(610271),D=()=>t(137476),W=()=>t(392608),F=()=>t(332440),B=()=>t(781937),N=t(163643);function P(){const e=(0,o().v3)(),n=(0,S().IS)((e=>({wrapper:{width:400,gap:16,alignContent:"center"},waitingForConnectionWrapper:{gap:4},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center",padding:4},buttonContainer:{justifyContent:"center"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,i().K8)((()=>"connecting"===u().o.state.currentScreen),[]),a=(0,l().O)();(0,F().n)((async()=>{if(!a)return;if("connecting"!==u().o.state.currentScreen)return;const n=await w().callApi({eventName:"getGithubAIConnectorStatus",environment:e,data:{spaceId:a}});"success"===n.type&&n.data.isConnected&&u().o.setState({...u().o.state,currentScreen:"confirmation"})}),1e3,!0);const r=(0,s.useCallback)((()=>[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:n.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalQna.github.waitingForConnectionNoteHeading1",defaultMessage:"GitHub should open automatically on a new tab."},"note1-1")}),(0,N.jsx)("div",{style:n.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.github.waitingForConnectionNoteBody1",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:n.link,href:u().o.state.authUrl,target:"_blank",children:(0,N.jsx)(b().sA,{id:"universalQna.github.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:n.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.github.workspaceAdminHeading",defaultMessage:"If you are a GitHub organization administrator:"},"note2-2")}),(0,N.jsx)("div",{style:n.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.github.workspaceAdminBody",defaultMessage:"Follow GitHub's instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,N.jsxs)(M().wt,{style:{marginTop:16,gap:4},children:[(0,N.jsx)("div",{style:n.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.github.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,N.jsx)("div",{style:n.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.github.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to install the app. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[n]),c=(0,s.useCallback)((()=>{const n=(0,W().xS)("guides.aiConnectorGithub");(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_connecting_modal",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),e.device.isElectron?k().openExternalUrl(n):window.open(n,"_blank")}),[e]),d=(0,s.useCallback)((()=>{u().o.reset(),(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_connecting_modal",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}})}),[e]);return(0,N.jsx)(T().a,{open:t,showCloseIcon:!0,onDismiss:d,render:()=>(0,N.jsxs)(M().wt,{style:n.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"github",title:(0,N.jsx)(b().sA,{id:"universalQnA.github.followInstructionsFromGithub",defaultMessage:"Follow instructions from GitHub in your browser"})}),(0,N.jsxs)(M().wt,{style:n.waitingForConnectionWrapper,children:[r().map(((e,t)=>(0,N.jsxs)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6,justifyContent:"center"},children:[(0,N.jsx)(I().A,{number:t+1}),(0,N.jsx)("div",{style:n.note,children:e})]},t))),(0,N.jsx)(M().Ye,{style:n.buttonContainer,children:(0,N.jsx)(A().A,{style:{marginTop:16,marginBottom:16,width:120,borderRadius:4},onClick:c,children:(0,N.jsxs)(M().Ye,{style:n.learnMoreButton,children:[(0,N.jsx)(b().sA,{id:"universalSearch.github.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,j().X)({width:16,height:16})]})})})]})]})})}var U=()=>t(167532),z=()=>t(489905),E=()=>t(943066),L=()=>t(86977),K=()=>t(440380),H=()=>t(423559);const G={...K().gp,...H().LA,...(0,b().YK)({subtitleForAnnouncement:{defaultMessage:"Upgrade your plan to use AI Connectors.",id:"NotionAIConnectorUpsellIntroModal.subtitleForAnnouncement"}})};function R(){const e=(0,o().v3)(),n=(0,U().J)(),{currentSpaceStore:t}=(0,i().O$)(p().default),a=null==t?void 0:t.id,r=e.currentUser.id,c=(0,y()._X)({name:"ai_connectors",spaceId:a,userId:r}),l=(0,b().tz)(),d=(0,i().O$)(z().O),u=d.open&&"ai_plan_upsell_admin_intro"===d.modal,g=(0,s.useCallback)((n=>{let{source:t,upsell:s}=n;z().O.setState({open:!1}),"closeButton"!==t&&s&&d.open&&"ai_plan_upsell_admin_intro"===d.modal&&(E().K(e,{from:"ai_connector_ai_upsell_intro_modal",upsell:s}),"generic"!==d.connector&&x().A.setState({...x().A.state,connectorTriggeringUpsell:d.connector,upsellTriggeredAt:Date.now()}))}),[e,d]);if(!u||!c)return null;const m=d.connector;return"sharepoint"===m||"gmail"===m||"microsoftTeams"===m?null:(0,N.jsx)(T().a,{ariaLabel:l.formatMessage(K().vK.title),open:u,render:()=>(0,N.jsx)(L().Y,{messages:G,aiConnectorsFeatureAvailability:c,onDismiss:g,calloutKey:void 0,eventName:"ai_connector_ai_plan_upsell_intro_modal_opened",learnMoreHref:(0,W().xS)("guides.aiConnectors"),connector:m,showNarrowCta:n})})}var O=()=>t(907148);function q(){const{open:e,connector:n}=(0,i().K8)((()=>({open:z().O.state.open&&"progress"===z().O.state.modal,connector:z().O.state.open&&"progress"===z().O.state.modal?z().O.state.connector:"slack"})),[]),t=()=>{z().O.setState({open:!1})};return(0,N.jsx)(O().A,{onConnect:t,onDismiss:t,title:(0,N.jsx)(b().sA,{id:"universalSearchProgressModal.generalizedTitle",defaultMessage:"{connector} is connecting to Notion AI",values:{connector:{slack:"Slack",jira:"Jira",google_drive:"Google Drive",github:"Github",sharepoint:"SharePoint",gmail:"Gmail",microsoftTeams:"Microsoft Teams",linear:"Linear"}[n]}}),connectorType:n,subtitle:(0,N.jsx)(b().sA,{id:"universalSearchProgressModal.subtitle",defaultMessage:"This can take up to 36hr.{br}You’ll be able to get answers soon.",values:{br:(0,N.jsx)("br",{})}}),overridePrimaryMessage:(0,N.jsx)(b().sA,{id:"universalSearchProgressModal.ctaMessage",defaultMessage:"Got it"}),centerNotes:!0,noteStyleOverrides:{fontSize:"14px"},open:e})}var Y=()=>t(37644);const J={...K().gp,...(0,b().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorSalesAssistedRequestModal.title"},subtitleForAnnouncement:{defaultMessage:"Get search results, AI answers, summaries and more without leaving Notion.",id:"NotionAIConnectorSalesAssistedRequestModal.subtitleForAnnouncement"},notifyWorkspaceOwner:{defaultMessage:"Notify your sales representative for access",id:"NotionAIConnectorSalesAssistedRequestModal.notifyWorkspaceOwners"}})};function $(){const e=(0,o().v3)(),{currentSpaceStore:n}=(0,i().O$)(p().default),t=null==n?void 0:n.id,a=e.currentUser.id,r=(0,y()._X)({name:"ai_connectors",spaceId:t,userId:a}),c=(0,b().tz)(),l=(0,i().O$)(z().O),d=l.open&&"sales_assisted_admin_request"===l.modal,u=(0,s.useCallback)((e=>{let{source:n}=e;z().O.setState({open:!1}),"closeButton"!==n&&l.open&&"sales_assisted_admin_request"===l.modal&&(0,Y().cz)()}),[l]);if(!d||!r)return null;const g=l.connector;return"sharepoint"===g||"gmail"===g||"microsoftTeams"===g?null:(0,N.jsx)(T().a,{ariaLabel:c.formatMessage(K().vK.title),open:d,render:()=>(0,N.jsx)(L().Y,{messages:J,aiConnectorsFeatureAvailability:r,onDismiss:u,calloutKey:void 0,eventName:"ai_connector_sales_assisted_intro_modal_opened",learnMoreHref:void 0,connector:g,showNarrowCta:!1})})}var Q=()=>t(961987),V=()=>t(966789),X=()=>t(419933),Z=()=>t(91912),ee=()=>t(871224);function ne(e){const{open:n}=e;return(0,N.jsx)(ee().m,{open:n,onDismiss:()=>{u().o.reset()},connector:"github"})}const te=(0,b().YK)({githubAIConnectorOauthPopupTitle:{defaultMessage:"Connect GitHub AI Connector",id:"githubAIConnector.oauthPopupTitle"}});function se(){const e=(0,s.useMemo)((()=>(0,X().J)("github")),[]),n=(0,s.useMemo)((()=>(0,X().a)("github")),[]),t=(0,o().v3)(),[c,d]=(0,s.useState)("CLOSED"),g=(0,l().O)(),p=(0,i().O$)(u().o),m=(0,i().K8)((()=>u().o.state.sessionId),[]),h=(0,i().K8)((()=>u().o.state.analyticsFrom),[]),v=(0,S().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:C().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,U().J)(),x=(0,y().P9)({name:"ai_connectors",spaceId:g,userId:t.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,W().xS)("guides.aiConnectorGithub");(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),t.device.isElectron?k().openExternalUrl(e):window.open(e,"_blank")}),[t]),j=(0,s.useCallback)((async()=>{if(!g)return;const e=await w().callApi({eventName:"getGithubOrgAuthUrl",environment:t,data:{spaceId:g,isDesktop:t.device.isElectron,sessionId:u().o.state.sessionId}});if("success"!==e.type)return;const n=e.data.url;t.device.isElectron?k().openExternalUrl(n):Q().P(t,{width:800,height:600,url:n,titleMessage:te.githubAIConnectorOauthPopupTitle}),u().o.setState({...u().o.state,authUrl:n,currentScreen:"connecting"})}),[g,t]),[A]=(0,a().Yb)((async()=>{if(!g||"introduction"!==p.currentScreen)return;if(p.githubOrg)return{isGithubConnected:!0};const e=await w().callApi({eventName:"getGithubAIConnectorStatus",environment:t,data:{spaceId:g}});return"success"===e.type?{isGithubConnected:e.data.isConnected}:void 0}),[t,p.currentScreen,p.githubOrg,g]);(0,s.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===A.status?d("OPEN"):d("LOADING"):d("CLOSED")}),[A.status,p.currentScreen]);const I=(0,s.useRef)(!1),F=(0,s.useCallback)((()=>{u().o.reset(),(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_intro_modal",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),I.current=!1}),[t]),B=(0,s.useCallback)((async()=>{await j(),(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"github_ai_connector_auth_url_open",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),u().o.setState({...u().o.state,currentScreen:"connecting"})}),[t,j]);return(0,s.useEffect)((()=>{g&&f&&"resolved"===A.status&&"introduction"===p.currentScreen&&(I.current||((0,D().u4)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"github",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:f,is_ai_eligible:x??!1}}}),I.current=!0))}),[g,t,A.status,p.sessionId,p.analyticsFrom,f,x,p.currentScreen]),g&&"CLOSED"!==c?t.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"github",open:"introduction"===p.currentScreen,onClosed:()=>{u().o.reset()},learnMoreUrl:(0,W().xS)("guides.aiConnectorGithub")}):"LOADING"===c?(0,N.jsx)(T().a,{open:"LOADING"===c,render:()=>(0,N.jsxs)(M().Ye,{style:v.loadingWrapper,children:[(0,N.jsx)(b().sA,{id:"universalQna.github.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,N.jsx)(V().A,{})]})}):p.isConnected?(0,N.jsx)(ne,{open:!0}):f?(0,N.jsx)(O().A,{onConnect:B,onDismiss:F,onLearnMore:_,title:e,connectorType:"github",notes:n,open:"OPEN"===c}):(0,N.jsx)(H().BN,{connector:"github",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,r().resetAiConnectorStatus)("github"),open:"OPEN"===c,messages:K().Sn}):(0,N.jsx)(N.Fragment,{})}var oe=()=>t(288685),ie=()=>t(575015),ae=()=>t(286270),re=()=>t(286404),ce=()=>t(951540),le=()=>t(477784);const de=function(){const e=(0,i().O$)(u().o),[n,t]=(0,s.useState)(!1),a=(0,o().v3)(),r=(0,l().O)(),c=(0,s.useCallback)((()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),u().o.reset()}),[a]),d=(0,s.useCallback)((()=>{t(!1)}),[]),g=(0,S().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:C().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:C().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{width:"100%"}})),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:d,open:n,render:()=>(0,N.jsx)("div",{style:g.confirmWrapper,children:(0,N.jsxs)("div",{style:g.confirmContainer,children:[(0,N.jsx)("div",{style:g.confirmModalTitle,children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.confirmation.title",defaultMessage:"Are your sure?"})}),(0,N.jsx)("div",{style:g.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.confirmation.subTitle",defaultMessage:"Your GitHub data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:g.confirmModalDescription,children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,N.jsxs)(M().wt,{style:g.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:g.confirmDisconnectButton,onClick:async()=>{r&&((0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),await w().callApi({eventName:"disconnectGithub",environment:a,data:{spaceId:r}}),u().o.reset(),t(!1),ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"GitHub disconnected. This can take up to 3 hours.",id:"githubAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,N.jsx)(A().A,{style:g.goBackButton,onClick:d,children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:c,open:"settings"===e.currentScreen,render:()=>(0,N.jsxs)("div",{style:g.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"github",title:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.settingsModalTitle",defaultMessage:"GitHub is connected to Notion AI"}),subtext:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your GitHub repositories."})}),(0,N.jsxs)(M().wt,{style:g.footer,children:[(0,N.jsx)(re().A,{size:"lg",style:g.editChannelsButton,onClick:()=>{var n,t;(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_github_for_edit_selection",integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),window.open(`https://github.com/organizations/${null===(n=e.githubOrg)||void 0===n?void 0:n.name}/settings/installations/${null===(t=e.githubOrg)||void 0===t?void 0:t.installationId}`,"_blank")},children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.editRepos",defaultMessage:"Edit Selected Repositories"})}),(0,N.jsx)(ae().E,{style:g.disconnectButton,onClick:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"github",setup_session_id:u().o.state.sessionId,from:"connection_settings"}}}),t(!0)},children:(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.disconnectGithub",defaultMessage:"Disconnect"})}),(0,N.jsx)(A().A,{style:g.learnMoreButton,onClick:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"github",setup_session_id:u().o.state.sessionId,from:"connection_settings"}}});const e=(0,W().xS)("guides.aiConnectorGithub");window.open(e,"_blank")},children:(0,N.jsxs)(M().Ye,{style:g.learnMoreText,children:[(0,N.jsx)(b().sA,{id:"githubAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,oe().M)(g.externalLinkIcon)]})})]})]})})]})};var ue=()=>t(575813),ge=()=>t(20641);const pe=(0,b().YK)({githubAIConnectorConnectionCompleteListpoint2:{id:"githubAIConnector.connectionComplete.listpoint2",defaultMessage:"Each member of your workspace will be prompted to authenticate to GitHub."}});const me=function(){const e=(0,o().v3)(),n=(0,i().O$)(u().o),t=(0,s.useCallback)((n=>{u().o.setState({...u().o.getInitialState(),isPersonalAuthComplete:!1,status:"in_progress",isConnected:!0}),(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`github_ai_connector_got_it_${n}_click`,integration_type:"github",setup_session_id:u().o.state.sessionId,from:u().o.state.analyticsFrom}}}),ie().D6({label:(0,N.jsx)(b().sA,{id:"aiConnectors.github.acknowledge",defaultMessage:"Started syncing from GitHub. This can take up to 72 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"aiConnectors.github.startedMessageDismiss",defaultMessage:"Close"})})})}),[e]);return(0,N.jsx)(ge().v,{open:"confirmation"===n.currentScreen,connectorType:"github",notes:[(0,N.jsx)(ue().L,{number:1,title:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:pe.githubAIConnectorConnectionCompleteListpoint2,description:{...{...ge().D.defaultPermissionsWillBeRespected,values:{appName:"GitHub"}}}},"item2")],onDismiss:()=>t("dismiss"),onPrimaryButtonClick:()=>t("dismiss")})};var he=()=>t(546709);function ve(){const e=(0,i().K8)((()=>v().d.state.currentScreen),[]);return(0,N.jsx)(ee().m,{open:"already_connected"===e,onDismiss:()=>{v().d.reset()},connector:"google_drive"})}var fe=()=>t(723361),ye=()=>t(229950);function xe(){const[e,n]=s.useState(!1),t=(0,S().IS)((e=>({noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:C().Wy.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),a=(0,o().v3)(),c=(0,l().O)(),d=(0,i().K8)((()=>v().d.state.sessionId),[]),u=(0,i().K8)((()=>v().d.state.currentScreen),[]),g=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),p=(0,i().K8)((()=>h().default.getConfigKey("ingestion","googleDrive").googleAuthUrl),[]),m=(0,i().K8)((()=>h().default.getConfigKey("ingestion","googleDrive").troubleShootingUrl),[]),f=(0,i().K8)((()=>h().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),y=(0,s.useCallback)((async()=>{if(!c)return;var e;await(e=5e3,new Promise((n=>setTimeout(n,e))));const t=await w().callApi({eventName:"connectGoogleDriveForAIIngestion",environment:a,data:{spaceId:c}}),s=e=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:"google_drive",setup_session_id:d,from:g}}})};var o,i,l;"success"===t.type?t.data.connectionSuccess?(s("auth_screen_connected"),v().d.setState({...v().d.state,currentScreen:"connection_complete_screen",availableSyncControlOptions:t.data.syncControlOptions})):((e,t,o)=>{switch(e){case 401:s("auth_screen_not_connected_warning"),n(!0);break;case 403:s("info_screen_connect_not_admin_screen"),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"not_admin_screen",analyticsFrom:g,sessionId:d});break;case 400:"GOOGLE_MAPPING_EXIST"===t&&o?(s("workspace_already_connected"),v().d.setState({...v().d.state,connectedSpaceId:o}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_exist_screen",analyticsFrom:g,sessionId:d})):(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:d});break;default:(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:d})}})(null==t||null===(o=t.data)||void 0===o||null===(o=o.errorResponse)||void 0===o?void 0:o.status,null==t||null===(i=t.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.errorCode,null==t||null===(l=t.data)||void 0===l||null===(l=l.errorResponse)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.spaceId):(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:d})}),[g,a,d,c]),x=(0,s.useCallback)((()=>[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:t.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.waitingForConnectionNoteHeading1",defaultMessage:"Google should open automatically on a new browser tab."},"note1-1")}),(0,N.jsx)("div",{style:t.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.authWaiting",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:t.link,href:p,target:"_blank",onClick:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"google_drive",setup_session_id:d,from:g}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:t.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.workspaceAdminHeading",defaultMessage:"Follow Google’s setup instructions"},"note2-1")}),(0,N.jsx)("div",{style:t.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”. In the next steps, you’ll be able to exclude specific Drives and can always update your selection."},"note2-2")})]},"note-2"),(0,N.jsx)(M().wt,{style:{gap:4},children:(0,N.jsx)("div",{style:t.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[t,p,a,d,g]),_=e?(0,N.jsxs)(M().Ye,{style:t.warningContainer,children:[(0,fe().Q)(t.icon),(0,N.jsx)("div",{style:t.warningText,children:(0,N.jsx)(b().sA,{id:"universalQnA.googleDrive.AuthScreen.warning",defaultMessage:"We couldn’t connect to Google. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,N.jsx)("a",{style:{...t.link,color:"#D7813A"},href:m,target:"_blank",onClick:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:"google_drive",setup_session_id:d,from:g}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,N.jsx)(ye().Q,{title:(0,N.jsx)(b().sA,{id:"universalQnA.googleDrive.AuthScreen",defaultMessage:"Follow instructions from Google in your browser"}),open:"auth_screen"===u,onDismiss:()=>{n(!1),(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"google_drive",setup_session_id:d,from:g}}}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:d})},warningMessage:_,notes:x(),openLearnMoreUrl:()=>{window.open(f)},connectorType:"google_drive",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:y})}var _e=()=>t(519423),Se=()=>t(194568),je=()=>t(741329),be=(t(362833),t(725707),t(491955),t(500234),t(771702),()=>t(30958)),Ce=()=>t(611506),we=()=>t(76394),ke=()=>t(559637),Ae=()=>t(884373),Ie=()=>t(435819);function Te(e){const{onPrimaryButtonClick:n,setShowConfirmModal:t}=e,a=(0,o().v3)(),r=(0,i().O$)(v().d),c=(0,i().K8)((()=>v().d.state.currentScreen),[]),[l,d]=(0,s.useState)(!1),u=(0,S().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]),g=e=>{v().d.setState({...r,currentScreen:e})};return(0,N.jsx)(T().a,{showCloseIcon:!0,open:"select_shared_drives_screen"===c,onDismiss:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_confirm_modal_close",integration_type:"google_drive",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),g("none"),t(!1)},render:()=>(0,N.jsx)("div",{style:u.confirmWrapper,children:(0,N.jsxs)("div",{style:u.confirmContainer,children:[(0,N.jsx)("div",{style:u.confirmModalTitle,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.title",defaultMessage:"Are your sure?"})}),(0,N.jsx)("div",{style:u.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.subTitle",defaultMessage:"Google Drive content will be disconnected and re-connected. This can take up to 36h and AI answers will be unavailable until it’s complete."})}),(0,N.jsxs)(M().wt,{style:u.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isLoading:l,style:u.confirmDisconnectButton,disabled:r.isDisconnecting,onClick:async()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_confirm_button",integration_type:"google_drive",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),d(!0),await n(),d(!1),t(!1),g("none")},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.editModal.confirmDisconnect",defaultMessage:"Confirm"})}),(0,N.jsx)(A().A,{style:u.goBackButton,onClick:()=>{(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_cancel_button",integration_type:"google_drive",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),t(!1)},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.editModal.cancel",defaultMessage:"Cancel"})})]})]})})})}function Me(e){const{drive:n,styles:t,onToggle:s}=e;return(0,N.jsxs)(M().Ye,{gap:8,style:{alignItems:"center",padding:"10px 18px 6px 0px"},children:[(0,N.jsx)(ke().A,{checked:n.checked,checkSize:10,size:14,onClick:()=>s(n.id)}),(0,N.jsx)("div",{style:t.drivesRow,children:`${n.name}`},`${n.id}#3`)]})}function De(e){const{styles:n,onPrimaryButtonClick:t,setShowConfirmModal:a,isFutureItemsChecked:r,setDriveCheckboxItems:c,sharedDriveCheckboxItems:d,setFutureItemsChecked:u}=e,g=(0,i().O$)(v().d),p=(0,i().K8)((()=>v().d.state.sessionId),[]),m=(0,i().K8)((()=>v().d.state.initialSyncState),[]),h=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),f=(0,i().K8)((()=>v().d.state.currentScreen),[]),y=(0,l().O)(),[x,_]=(0,s.useState)(!1),S=(0,o().v3)();if((0,s.useEffect)((()=>{const e=g.availableSyncControlOptions.filter((e=>"shared_drive"===e.type));0===e.length&&"select_shared_drives_screen"===f&&(0,D().u4)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"no_shared_drives",integration_type:"google_drive",setup_session_id:p,from:h}}});const n=g.syncControlSelection;if(!n)return c(e.map((e=>({...e,checked:!0})))),void u(!0);c(e.map((e=>({...e,checked:!n.driveIds||n.driveIds.includes(e.id)})))),u(n.enableSyncingFutureUsersAndDrives)}),[h,S,g,f,c,u,p]),!y)return null;const j=d.find((e=>e.checked)),C=e=>{(0,D().u4)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google_drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),c(d.map((n=>n.id===e?{...n,checked:!n.checked}:n)))},w=d.map((e=>(0,N.jsx)(Me,{drive:e,styles:n,onToggle:C},e.id))).filter(we().O9);return(0,N.jsxs)(M().wt,{children:[(0,N.jsx)(M().Ye,{style:n.selectionWrapper,children:(0,N.jsxs)(M().wt,{style:n.scrollContainer,children:[(0,N.jsx)(Ae().A,{style:{paddingBottom:4},size:4}),(0,N.jsx)(M().Ye,{style:n.rowTitle,children:(0,N.jsxs)(M().Ye,{children:[(0,N.jsx)(M().wt,{children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.allItemsTitle",defaultMessage:"Content owned by users"})}),(0,N.jsx)(M().wt,{style:{paddingLeft:200},children:(0,Ce().p)(n.checkMark)})]})}),(0,N.jsx)(M().Ye,{style:n.rowAdditionalText,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.allItemsSubtext",defaultMessage:"Includes all files owned by users selected in Google Workspace Settings"})}),(0,N.jsx)(Ae().A,{style:{paddingTop:10,paddingBottom:10},size:4}),(0,N.jsx)(M().Ye,{style:n.rowTitle,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesTitle",defaultMessage:"Content in Shared Drives"})}),(0,N.jsx)(M().Ye,{style:n.rowAdditionalText,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesSubtext",defaultMessage:"Includes files in Shared Drives as long as they are owned by users selected in the setting above."})}),(0,N.jsx)(M().Ye,{children:(0,N.jsx)(M().wt,{children:0===w.length?(0,N.jsx)(M().Ye,{style:{...n.rowAdditionalText,fontSize:14,paddingTop:10},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.noSharedDrivesSubtext",defaultMessage:"No Shared Drives found"})}):w})})]})}),(0,N.jsxs)(M().wt,{style:n.footer,children:[(0,N.jsxs)(M().Ye,{style:{gap:4,alignItems:"center",width:"inherit"},children:[(0,N.jsx)(ke().A,{checked:r,checkSize:10,size:14,onClick:()=>{(0,D().u4)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!r).toString()}`,integration_type:"google_drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),u(!r)}}),(0,N.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrives",defaultMessage:"Include Drives created in the future"})})]}),(0,N.jsx)(ce().A,{style:n.continueButton,isLoading:x,disabled:!j,onClick:async()=>{_(!0),"completed"!==m?(await t(),_(!1)):a(!0)},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.confirm",defaultMessage:"Confirm selection"})})]})]})}async function We(e){const{environment:n,spaceId:t}=e,s=p().default.state.currentUserStore,{analyticsFrom:o,sessionId:i}=v().d.state;if("success"===(await w().callApi({eventName:"startGoogleDriveSyncForAIIngestion",environment:n,data:{spaceId:t,setupSessionId:i}})).type){var a;v().d.setState({...v().d.state,initialSyncState:"in_progress",ingestionProgress:1});const e=x().A.state.appsConnectionData.filter((e=>e.id!==be()._u));return x().A.setState({...x().A.state,appsConnectionData:[...e,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==s?void 0:s.getEmail())||"",id:be()._u,connectorNotionId:null==s||null===(a=s.getModel())||void 0===a?void 0:a.id}]}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:o,sessionId:i}),!0}return(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:i}),!1}const Fe=function(){const[e,n]=(0,s.useState)(!1),t=(0,i().K8)((()=>v().d.state.currentScreen),[]),a=(0,o().v3)(),c=(0,l().O)(),d=(0,i().O$)(v().d),u=(0,S().IS)((e=>({wrapper:{width:400},scrollContainer:{overflow:"scroll",paddingRight:20,height:350},rowTitle:{fontSize:12,lineHeight:"16px",letterSpacing:"-0.15px",fontWeight:510,paddingBottom:4},rowAdditionalText:{fontSize:12,lineHeight:"16px",color:e.text.secondary},drivesRow:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:e.shadowMD,padding:"16px 20px 16px 20px",gap:6},continueButton:{fontSize:14,fontWeight:C().Wy.semibold,width:360},selectionWrapper:{marginTop:24,paddingLeft:20,justifyContent:"center",overflow:"auto"},selection:{width:360,height:263,marginBotton:12},checkMark:{width:14,color:e.text.secondary}})),[]),g=(0,i().K8)((()=>v().d.state.sessionId),[]),p=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),[m,h]=(0,s.useState)(!0),[f,y]=(0,s.useState)([]),x=()=>{v().d.setState({...v().d.state,syncControlSelection:{driveIds:[],enableSyncingFutureUsersAndDrives:!1},availableSyncControlOptions:[]})},_=(0,s.useCallback)((async()=>{let e=!0;m&&(e=!1);const n=[];if(f.forEach((t=>{if(t.checked===e){const{checked:e,...s}=t;n.push({...s})}})),(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google_drive",setup_session_id:d.sessionId,from:d.analyticsFrom}}}),!c)return;const t=n,s=await w().callApi({eventName:"patchSyncControlsForGoogleDriveAIIngestion",environment:a,data:{spaceId:c,exclusionList:m?t:[],inclusionList:m?[]:t}}),o="in_progress"===v().d.state.initialSyncState||"completed"===v().d.state.initialSyncState;if("failed"===s.type)return void ie().D6({label:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.failed",defaultMessage:"Cannot edit Google shared drives now. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.failedMessageDismiss",defaultMessage:"Close"})})});const i="success"===s.type&&s.data.syncControlsUpdated||!o&&"success"===s.type&&!s.data.syncControlsUpdated,l=o&&"success"===s.type&&!s.data.syncControlsUpdated;if(i){const e=await We({environment:a,spaceId:c});x(),e&&ie().D6({label:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}else l?(ie().D6({label:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.skip",defaultMessage:"No change made to Google Drive Connection."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.noConfigChangeDismiss",defaultMessage:"Close"})})}),x(),v().d.setState({...v().d.state,initialSyncState:"completed"}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:p,sessionId:g})):(x(),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:g}))}),[p,a,d,m,g,f,c]);return e?(0,N.jsx)(Te,{onPrimaryButtonClick:_,setShowConfirmModal:n}):(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>{(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:g,analyticsFrom:p})},open:"select_shared_drives_screen"===t,render:()=>(0,N.jsxs)("div",{style:u.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:(0,N.jsx)(b().sA,{defaultMessage:"Select Drives to Connect",id:"googleAiConnector.universalQnaSharedDriveSelectorPopup.selectDrivesToConnect"})}),(0,N.jsx)(Ie().A,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(De,{styles:u,onPrimaryButtonClick:_,setShowConfirmModal:n,isFutureItemsChecked:m,setFutureItemsChecked:h,sharedDriveCheckboxItems:f,setDriveCheckboxItems:y})})]})})},Be=Se().w0.google_drive;function Ne(){const e=(0,o().v3)(),n=(0,i().K8)((()=>v().d.state.sessionId),[]),t=(0,l().O)(),a=(0,i().K8)((()=>v().d.state.initialSyncState),[]),c=(0,i().K8)((()=>v().d.state.currentScreen),[]),d=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),u=(0,s.useCallback)((()=>{(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"google_drive",setup_session_id:n,from:d}}}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n})}),[d,e,n]);if("completed"===a||!t)return(0,N.jsx)(N.Fragment,{});const g="in_progress"===a;return(0,N.jsx)(ge().v,{open:"connection_complete_screen"===c,connectorType:"google_drive",notes:[(0,N.jsx)(ue().L,{number:1,title:{...{...ge().D.connectionInProgressTitle,values:{appName:Be}}},description:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Be}}}},"item2")],onEditSettingsClick:g?void 0:async()=>{(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:"google_drive",setup_session_id:n,from:d}}});const s=await w().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:t},headers:(0,_e().WS)({spaceId:t})});if("success"===s.type){var o;const e=(0,je().HB)(null===(o=s.data)||void 0===o?void 0:o.status);v().d.setState({...v().d.state,initialSyncState:e}),"in_progress"===e?(0,r().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"settings_screen"}):"not_started"===e?(0,r().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"select_shared_drives_screen"}):(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:d,sessionId:n})}else(0,r().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"error"})},onPrimaryButtonClick:async()=>{if((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"google_drive",setup_session_id:n,from:d}}}),!t)return;if(g)return void(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n});await We({environment:e,spaceId:t})&&ie().D6({label:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})},onDismiss:u})}var Pe=()=>t(712437),Ue=()=>t(783759);function ze(){const e=(0,i().K8)((()=>v().d.state.currentScreen),[]),n=(0,i().K8)((()=>v().d.state.sessionId),[]),t=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),a=(0,i().K8)((()=>v().d.state.connectedSpaceId),[]),c=(0,o().v3)(),l=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]),d="connection_exist_screen"===e,u=(0,s.useCallback)((async()=>{const e=p().default.state.currentUserRootStore;if(!e)return;(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:"google_drive",setup_session_id:n,from:t}}});const s=e.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await Ue().tR({environment:c,navigationType:"switchingToOrLoadingSpace",pageVisitSource:Pe().y8.AIGoogleDriveQna,spaceViewStore:s,userRootStore:p().default.state.currentUserRootStore,userSettingsStore:p().default.state.currentUserSettingsStore}),v().d.reset(),v().d.setState({...v().d.state,currentScreen:"settings_screen",analyticsFrom:"google_other_workspace",sessionId:n})}),[t,a,c,n]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:d,render:()=>(0,N.jsxs)("div",{style:l.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.connectionExist.title",defaultMessage:"You’ve already connected Google Drive to another Notion workspace."}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.connectionExist.description",defaultMessage:"Currently, only one workspace can be connected to Google Drive. To connect this workspace, please disconnect the existing connection."})}),(0,N.jsx)(M().wt,{style:l.footer,children:(0,N.jsx)(ce().A,{style:l.connectButton,onClick:u,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.connectionExist.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}var Ee=()=>t(259849),Le=()=>t(948955);function Ke(){const e=(0,i().O$)(v().d),n=(0,i().K8)((()=>v().d.state.currentScreen),[]),t=(0,l().O)(),a=(0,i().K8)((()=>h().default.getConfigKey("ingestion","googleDrive").marketplaceAppConfigureUrl),[]),r=(0,i().K8)((()=>v().d.state.sessionId),[]),c=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),d=(0,o().v3)(),u=async()=>{if(!t)return;const e=await async function(e){const{environment:n,spaceId:t}=e,s=await w().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:n,data:{spaceId:t,disconnectReason:"admin_disconnect"}}),o=p().default.state.currentUserStore;if("success"===s.type&&s.data.deletionInitiated){var i;v().d.setState({...v().d.state,currentScreen:"none",isDisconnecting:!0});const e=x().A.state.appsConnectionData.filter((e=>e.id!==be()._u));return x().A.setState({...x().A.state,appsConnectionData:[...e,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==o?void 0:o.getEmail())||"",id:be()._u,connectorNotionId:null==o||null===(i=o.getModel())||void 0===i?void 0:i.id}]}),!0}return v().d.setState({...v().d.state,currentScreen:"error",isDisconnecting:!1}),!1}({environment:d,spaceId:t});e?ie().D6({label:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}):ie().D6({label:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})})},g=n=>{v().d.setState({...e,currentScreen:n})},m=(0,S().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),f=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:t,link:s}=m;return[(0,N.jsxs)(M().wt,{style:e,children:[(0,N.jsx)("div",{style:n,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.heading",defaultMessage:"Google Drive data will be permanently deleted from Notion"},"note1-1")}),(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:e,children:[(0,N.jsx)("div",{style:n,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1")}),(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToGoogleWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{NavigateToGoogleWorkspaceAppsSettings:(0,N.jsx)("a",{style:s,href:a,target:"_blank",onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"google_drive",setup_session_id:r,from:c}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_google_marketplace_app",defaultMessage:"Google Workspace {ArrowIcon}",values:{ArrowIcon:(0,Ee().q)(m.icon)}})})}},"note2-2")})]},"note-2")]}),[m,a,d,r,c]);return"post_disconnect_screen"===n?(0,N.jsx)(Le().A,{onClickGotItBtn:()=>{g("none")},onDismiss:()=>{g("none")},open:"post_disconnect_screen"===n,connectorType:"google_drive",title:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.title",defaultMessage:"Google Drive is Disconnecting from Notion"}),descriptionMessage:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"}),message:(0,N.jsx)("div",{style:m.notesSectionWrapper,children:f().map(((e,n)=>(0,N.jsxs)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,N.jsx)(I().A,{number:n+1}),(0,N.jsx)("div",{style:m.note,children:e})]},n)))})}):(0,N.jsx)(T().a,{showCloseIcon:!0,open:"disconnect_screen"===n,onDismiss:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),g("none")},render:()=>(0,N.jsx)("div",{style:m.confirmWrapper,children:(0,N.jsxs)("div",{style:m.confirmContainer,children:[(0,N.jsx)("div",{style:m.confirmModalTitle,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are your sure?"})}),(0,N.jsx)("div",{style:m.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:m.confirmModalDescription,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})}),(0,N.jsxs)(M().wt,{style:m.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:m.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await u(),g("post_disconnect_screen")},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,N.jsx)(A().A,{style:m.goBackButton,onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),g("settings_screen")},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function He(){const e=(0,i().K8)((()=>v().d.state.currentScreen),[]),n=(0,i().K8)((()=>v().d.state.sessionId),[]),t=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),a=(0,o().v3)(),c=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]),l="error"===e;return(0,s.useEffect)((()=>{l&&(0,D().u4)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google_drive",setup_session_id:n,from:t}}})}),[l,t,n,a]),(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:l,render:()=>(0,N.jsxs)("div",{style:c.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,N.jsx)(M().wt,{style:c.footer,children:(0,N.jsx)(ce().A,{style:c.connectButton,onClick:()=>{(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"})})})]})})}var Ge=()=>t(107640);function Re(){const[e,n]=s.useState(!1),t=(0,o().v3)(),a=(0,s.useMemo)((()=>(0,X().a)("google_drive")),[]),c=(0,s.useMemo)((()=>(0,X().J)("google_drive")),[]),d=(0,l().O)(),u=(0,i().K8)((()=>v().d.state.sessionId),[]),g=(0,i().K8)((()=>v().d.state.currentScreen),[]),p=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),f=(0,i().K8)((()=>m().zD.canUseUniversalGoogleDriveSearchScope()),[]),x=(0,i().K8)((()=>h().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),_=(0,U().J)(),S=t.currentUser.id,j=(0,y().P9)({name:"ai_connectors",spaceId:d,userId:S}),b="info_screen"===g;return(0,s.useEffect)((()=>{b&&f&&(0,D().u4)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google_drive",setup_session_id:u,from:p,is_space_admin:_,is_ai_eligible:j??!1}}})}),[p,t,j,b,_,u,f]),f?t.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"google_drive",open:b,onClosed:()=>{v().d.reset()},learnMoreUrl:x}):_?(0,N.jsx)(O().A,{connectorType:"google_drive",notes:a,onLearnMore:()=>{const e=h().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},onConnect:async()=>{d&&(n(!0),await async function(e,n,t,s){var o,i;(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google_drive",setup_session_id:t,from:s}}});const a=await(0,y().Bw)(e,{name:"ai_connectors",spaceId:n,userId:e.currentUser.id});if(!(0,y().e2)(a))return void(0,Ge().p)({connector:"google_drive",environment:e,analyticsFrom:"google_drive_connect_button",connectorsFeatureAvailability:a});const c=await w().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:n},headers:(0,_e().WS)({spaceId:n})});if("failed"===c.type)return void(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:t});const l=null==c||null===(o=c.data)||void 0===o?void 0:o.status,d=(0,je().HB)(l);if(v().d.setState({...v().d.state,initialSyncState:d,ingestionProgress:null==c||null===(i=c.data)||void 0===i?void 0:i.ingestionProgress}),"success"===c.type&&"in_progress"===d)return(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google_drive",setup_session_id:t,from:s}}}),void(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:s,sessionId:t});if("success"===c.type&&"completed"===d)return(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google_drive",setup_session_id:t,from:s}}}),void(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:s,sessionId:t});(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:"google_drive",setup_session_id:t,from:s}}}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"auth_screen",analyticsFrom:s,sessionId:t});const u=h().default.getConfigKey("ingestion","googleDrive");window.open(u.googleAuthUrl,"_blank"),w().callApi({eventName:"initiateGoogleDriveDelayedIngestion",environment:e,data:{spaceId:n,setupSessionId:t}})}(t,d,u,p),n(!1))},onDismiss:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google_drive",setup_session_id:u,from:p}}}),(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:p,sessionId:u})},title:c,isLoading:e,open:b}):(0,N.jsx)(H().BN,{connector:"google_drive",handleClose:()=>(0,r().resetAiConnectorStatus)("google_drive"),open:b,analyticsFrom:p,setupSessionId:u,messages:K().Fn}):(0,N.jsx)(N.Fragment,{})}function Oe(){const e=(0,i().K8)((()=>v().d.state.currentScreen),[]),n=(0,i().K8)((()=>v().d.state.sessionId),[]),t=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),s=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:"not_admin_screen"===e,render:()=>(0,N.jsxs)("div",{style:s.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can't verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."})}),(0,N.jsx)(M().wt,{style:s.footer,children:(0,N.jsxs)(ce().A,{style:s.connectButton,onClick:()=>{const e=h().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,N.jsx)("div",{style:s.iconWrapper,children:(0,j().X)()})]})})]})})}var qe=()=>t(407257),Ye=()=>t(103151);function Je(e){const{styles:n,events:t,isEditButtonEnabled:s,navigateToScreen:a}=e,r=(0,o().v3)(),c=(0,i().O$)(v().d);return(0,N.jsx)(re().A,{...t,size:"lg",style:n,disabled:!s,onClick:()=>{(0,D().u4)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_drives_button",integration_type:"google_drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),a("select_shared_drives_screen")},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Drives"})})}function $e(e){const{styles:n,events:t,isDisconnectButtonEnabled:s,navigateToScreen:a}=e,r=(0,o().v3)(),c=(0,i().O$)(v().d),d=(0,l().O)(),u=(0,i().K8)((()=>v().d.state.initialSyncState),[]);return(0,N.jsx)(ae().E,{...t,style:n,disabled:!s,onClick:async()=>{if(d)if((0,D().u4)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google_drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),"completed"!==u){if("not_started"===u){if("success"===(await w().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:r,data:{spaceId:d,disconnectReason:"admin_disconnect"}})).type)return void a("none")}a("error")}else a("disconnect_screen")},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})})}const Qe=function(){const e=(0,i().O$)(v().d),n=(0,l().O)(),t=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),c=(0,i().K8)((()=>v().d.state.currentScreen),[]),d=(0,i().K8)((()=>v().d.state.initialSyncState),[]),u=(0,i().K8)((()=>v().d.state.sessionId),[]),[g,p]=(0,s.useState)(!0),[m,f]=(0,s.useState)(!1),[y,x]=(0,s.useState)(!1),[_,j]=(0,s.useState)([]),k=(0,o().v3)();(0,a().Yb)((async()=>{if(!n||!k||"settings_screen"!==c)return;p(!0);let e=d;if("none"===d){var s;const o=await w().callApi({eventName:"getGoogleDriveSyncProgress",environment:k,data:{spaceId:n},headers:(0,_e().WS)({spaceId:n})});if("failed"===o.type)return void(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:t,sessionId:u});const i=null==o||null===(s=o.data)||void 0===s?void 0:s.status;e=(0,je().HB)(i),v().d.setState({...v().d.state,initialSyncState:e})}}),[t,k,d,c,u,n]),(0,a().Yb)((async()=>{if(n&&k&&"settings_screen"===c&&"none"!==d)if("in_progress"===d)p(!1),f(!1),x(!1);else if("completed"===d||"not_started"===d){const e=await w().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:k,data:{spaceId:n}});if("success"===(null==e?void 0:e.type)){const n=e.data;p(!1),f(!0),"not_started"===d?v().d.setState({...v().d.state,availableSyncControlOptions:n.options}):(v().d.setState({...v().d.state,availableSyncControlOptions:n.options,syncControlSelection:n.selection}),j(n.options.filter((e=>n.selection.driveIds.includes(e.id))))),v().d.state.isEditing||"in_progress"===v().d.state.initialSyncState||x(!0)}else f(!1),x(!1),ie().D6({label:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})})}}),[n,k,c,d]);const I=n=>{(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:n,analyticsFrom:e.analyticsFrom,sessionId:e.sessionId})},W=function(e){return(0,S().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},googleDriveDetailsContainer:{fontSize:14,fontWeight:C().Wy.regular,color:n.text.secondary,gap:12},driveNamesContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},moreDrivesContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:C().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:C().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${n.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:C().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:C().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",padding:"4px 0px 4px 0px",alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:n.text.secondary}})),[e])}(g);return(0,N.jsx)(T().a,{showCloseIcon:!0,open:"settings_screen"===c,onDismiss:()=>{(0,D().u4)({environment:k,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),j([]),I("none")},render:()=>{var n,t,s;return(0,N.jsxs)("div",{style:W.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:"completed"===d?(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}):(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle2",defaultMessage:"Google Drive is connecting to Notion AI"})}),g?(0,N.jsx)(M().Ye,{style:W.spinner,children:(0,N.jsx)(V().A,{})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M().Ye,{style:W.settingsWrapper,children:(0,N.jsxs)(M().wt,{style:W.googleDriveDetailsContainer,children:[(0,N.jsx)(M().wt,{children:"completed"===d?(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:_.length?`${_.length} Google Drives`:"Google Drive",futureDrivesMessage:null!==(n=e.syncControlSelection)&&void 0!==n&&n.enableSyncingFutureUsersAndDrives?", including future drives and users.":"."}}):(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom2",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete. "})}),(0,N.jsxs)(M().wt,{children:[(0,N.jsxs)(M().wt,{style:W.driveNamesContainer,children:[(null===(t=e.syncControlSelection)||void 0===t?void 0:t.enableSyncingFutureUsersAndDrives)&&(0,N.jsxs)(M().Ye,{style:W.driveItemWrapper,children:[(0,N.jsx)(M().wt,{style:W.driveIcon,children:(0,qe().E)({width:14,height:14})}),(0,N.jsx)(M().wt,{style:W.driveName,children:(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}),null===(s=_.slice(0,4))||void 0===s?void 0:s.map((e=>(0,N.jsx)("div",{children:(0,N.jsxs)(M().Ye,{style:W.driveItemWrapper,children:[(0,N.jsx)(M().wt,{style:W.driveIcon,children:(0,qe().E)({width:14,height:14})}),(0,N.jsx)(M().wt,{style:W.driveName,children:`${e.name}`})]})},e.id)))]}),(0,N.jsx)(M().Ye,{style:W.moreDrivesContainer,children:_.length-4>0?(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:_.length-4}}):(0,N.jsx)(N.Fragment,{})})]})]})}),(0,N.jsxs)(M().wt,{style:W.footer,children:[y?(0,N.jsx)(Je,{styles:W.disconnectButton,isEditButtonEnabled:y,navigateToScreen:I}):(0,N.jsx)(Ye().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,N.jsx)("div",{style:{width:240},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,N.jsx)(Je,{events:e,styles:W.disconnectButton,isEditButtonEnabled:y,navigateToScreen:I})}),m?(0,N.jsx)($e,{styles:W.disconnectButton,isDisconnectButtonEnabled:m,navigateToScreen:I}):(0,N.jsx)(Ye().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,N.jsx)("div",{style:{width:240},children:(0,N.jsx)(b().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,N.jsx)($e,{events:e,styles:W.disconnectButton,isDisconnectButtonEnabled:m,navigateToScreen:I})})]}),(0,N.jsx)(M().Ye,{style:W.learnMoreSection,children:(0,N.jsx)(A().A,{style:W.learnMoreButton,onClick:()=>{(0,D().u4)({environment:k,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=h().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")})()},children:(0,N.jsxs)(M().Ye,{style:W.learnMoreText,children:[(0,N.jsx)(b().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,oe().M)(W.externalLinkIcon)]})})})]})]})}})};function Ve(){const e=(0,i().K8)((()=>v().d.state.currentScreen),[]),n=(0,i().K8)((()=>v().d.state.sessionId),[]),t=(0,i().K8)((()=>v().d.state.analyticsFrom),[]),s=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>(0,r().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:n,analyticsFrom:t}),open:"service_account_not_added"===e,render:()=>(0,N.jsxs)("div",{style:s.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"google_drive",title:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you'll need to modify a few settings in your Google Workspace."})}),(0,N.jsx)(M().wt,{style:s.footer,children:(0,N.jsxs)(ce().A,{style:s.connectButton,onClick:()=>{const e=h().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,N.jsx)(b().sA,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),(0,N.jsx)("div",{style:s.iconWrapper,children:(0,j().X)()})]})})]})})}function Xe(){const e=(0,i().K8)((()=>f().y.state.currentScreen),[]);return(0,N.jsx)(ee().m,{open:"already_connected"===e,onDismiss:()=>{f().y.reset()},connector:"jira"})}function Ze(){const[e,n]=s.useState(!1),t=(0,o().v3)(),a=(0,S().IS)((e=>({noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:C().Wy.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),c=(0,i().K8)((()=>f().y.state.currentScreen),[]),d=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),u=(0,i().K8)((()=>f().y.state.sessionId),[]),g=(0,i().K8)((()=>p().default.state.currentUserStore),[]),m=(0,l().O)(),v=(0,s.useCallback)((async()=>{if(!m)return;var e;(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"jira",setup_session_id:u,from:d}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));const s=await w().callApi({eventName:"checkNotionToJiraConnection",environment:t,data:{spaceId:m}});"success"===s.type&&s.data.isConnected?(f().y.setState({...f().y.state,currentScreen:"connection_complete_screen",jiraSiteId:s.data.jiraSiteId}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:d,sessionId:u})):n(!0)}),[d,t,u,m]),y=(0,i().K8)((()=>h().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl")),[]),x=(0,i().K8)((()=>h().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);if(!g||!m)return null;const _=e?(0,N.jsxs)(M().Ye,{style:a.warningContainer,children:[(0,fe().Q)(a.icon),(0,N.jsx)("div",{style:a.warningText,children:(0,N.jsx)(b().sA,{id:"universalQnA.jira.AuthScreen.warning",defaultMessage:"We couldn’t connect to Jira. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,N.jsx)("a",{style:{...a.link,color:"#D7813A"},href:x,target:"_blank",onClick:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,N.jsx)(ye().Q,{title:(0,N.jsx)(b().sA,{id:"universalQnA.jira.AuthScreen",defaultMessage:"Follow instructions from Jira in your browser"}),open:"check_connection"===c,onDismiss:()=>{n(!1),(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:u,from:d}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:u})},warningMessage:_,notes:[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:a.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.waitingForConnectionNoteHeading1",defaultMessage:"Jira should open automatically on a new browser tab."},"note1-1")}),(0,N.jsx)("div",{style:a.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.authWaiting2",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:a.link,href:y,target:"_blank",onClick:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:a.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.workspaceAdminHeading",defaultMessage:"Follow Jira’s instructions to connect"},"note2")}),(0,N.jsx)("div",{style:a.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.authWaiting",defaultMessage:"Install the Notion connector in a Jira site of your choice and return to this window"},"note1-2")})]},"note-2"),(0,N.jsx)(M().wt,{style:{gap:4},children:(0,N.jsx)("div",{style:a.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.workspaceAdminHeading2",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(x,"_blank")},connectorType:"jira",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.jira.Button.finishedSetup",defaultMessage:"Check connection"},"note3-1"),onClickPrimaryButton:v})}var en=()=>t(587593),nn=()=>t(84543),tn=()=>t(888484),sn=()=>t(213255),on=()=>t(28210);function an(e){const{connector:n,learnMoreUrl:t,from:a,to:r,subtext:l,onDismiss:d,close:u,onConfirm:g,open:p,title:h}=e,[v,f]=s.useState(!1),y=(0,o().v3)(),x=(0,i().K8)((()=>m().zD.isAiConnectorEnabled(n)),[n]),_=(0,S().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12,justifyContent:"center"},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:C().Wy.regular,fontSize:C().J.UIRegular.desktop,lineHeight:"18px",marginLeft:8},dismissButton:{gap:4,width:"100%",alignItems:"center",fontSize:C().J.UISmall.desktop,color:e.text.primary,justifyContent:"center"},noteHeading:{fontWeight:C().Wy.medium,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:C().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},noteContainer:{backgroundColor:e.fill.blueSecondary,color:e.text.uiBluePrimary,padding:"10px",margin:"10px 20px",borderRadius:8,width:"auto"},connectorInfoContainer:{alignItems:"center",border:"1px solid",borderColor:e.pill.hover.border.white,borderRadius:6,padding:"4px 12px 4px 12px",justifyContent:"space-between"},connectorIconContainer:{justifyContent:"center"},connectorIcon:{width:24,height:24,size:24},verticalHr:{width:12,margin:"2px 0px 2px 0px",transform:"rotate(90deg)"},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"12px 20px 20px 20px",gap:6},connectButton:{width:"100%"}})),[]),j=(0,b().tz)(),w=(0,s.useCallback)((async()=>{f(!0);try{await g()}finally{f(!1)}}),[g,f]);return x?y.device.isMobile?(0,N.jsx)(Z().S,{connectorType:n,open:p,onClosed:()=>c().NT[n].reset(),learnMoreUrl:t}):(0,N.jsx)(T().a,{ariaLabel:j.formatMessage({id:"universalSearch.pendingConnection.ariaLabel",defaultMessage:"Pending connection modal"}),showCloseIcon:null==u?void 0:u.showCloseButton,open:p,onDismiss:null==u?void 0:u.onClose,render:()=>(0,N.jsxs)("div",{style:_.wrapper,children:[(0,N.jsx)(B().b,{connectorType:n,title:h,subtext:l}),(0,N.jsx)(M().Ye,{style:_.selectionContainer,children:(0,N.jsxs)(M().wt,{style:_.waitingForConnectionWrapper,children:[(0,N.jsxs)(M().Ye,{style:_.connectorInfoContainer,children:[(0,N.jsx)(M().Ye,{style:_.connectorIconContainer,children:a.icon(_.connectorIcon)}),(0,N.jsx)(M().Ye,{children:(0,N.jsxs)(M().wt,{style:_.note,children:[(0,N.jsx)("div",{style:_.noteHeading,children:a.title||""}),(0,N.jsx)("div",{style:_.noteBody,children:a.label})]})})]}),(0,N.jsx)("div",{style:_.verticalHr,children:(0,N.jsx)("hr",{})}),(0,N.jsx)("div",{style:_.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.confirmConnection.willConnectToLabel",defaultMessage:"will connect to:"})}),(0,N.jsx)("div",{style:_.verticalHr,children:(0,N.jsx)("hr",{})}),(0,N.jsx)("div",{style:_.connectorInfoContainer,children:(0,N.jsxs)(M().Ye,{children:[(0,N.jsx)(M().wt,{style:_.connectorIconContainer,children:(0,N.jsx)(on().B,{disabled:!0,icon:r.icon,isEmptyPage:!1,title:r.title,size:_.connectorIcon.size,isLarge:!0})}),(0,N.jsxs)(M().wt,{style:_.note,children:[(0,N.jsx)("div",{style:_.noteHeading,children:r.title}),(0,N.jsx)("div",{style:_.noteBody,children:r.label})]})]})})]})}),(0,N.jsxs)(M().Ye,{style:{..._.selectionContainer,..._.noteContainer},children:[(0,N.jsx)(M().wt,{style:_.connectorIconContainer,children:(0,sn().A)(_.connectorIcon)}),(0,N.jsx)(M().Ye,{style:_.note,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.confirmConnectionNoteLabel",defaultMessage:"To connect a different Notion workspace, switch to that workspace and try again."})})]}),(0,N.jsxs)(M().wt,{style:_.footer,children:[(0,N.jsx)(ce().A,{size:"xl",isLoading:v,disabled:v,style:_.connectButton,onClick:w,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.confirmConnection",defaultMessage:"Confirm connection"})}),(0,N.jsx)(re().A,{size:"lg",style:_.dismissButton,onClick:d,children:(0,N.jsx)(b().sA,{id:"universalSearch.integrations.dismissConnectionButton",defaultMessage:"Dismiss"})})]})]})}):null}function rn(){const[e,n]=s.useState(!1),t=(0,o().v3)(),a=(0,i().K8)((()=>f().y.state.currentScreen),[]),c=(0,i().O$)(p().AppStoreCurrentSpaceStore),l=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),d=(0,i().K8)((()=>f().y.state.sessionId),[]),u=(0,i().K8)((()=>p().default.state.currentUserStore),[]),g=(0,i().K8)((()=>{const e=f().y.state.jiraSiteUrl.match(/^https:\/\/([a-zA-Z0-9-]+)\.atlassian\.net/);return e?e[1]:f().y.state.jiraSiteUrl}),[]),m=(0,i().O$)(p().AppStoreCurrentSpaceViewStore),v=(0,i().K8)((()=>p().default.state.currentUserSettingsStore),[]),{spaceId:y,notionIcon:x,notionSpaceName:_}=(0,i().K8)((()=>({spaceId:null==c?void 0:c.getSpaceId(),notionIcon:null==c?void 0:c.getIcon(),notionSpaceName:(null==c?void 0:c.getName())||""})),[c]),S=(0,i().K8)((()=>h().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),j=(0,s.useCallback)((async()=>{if(!y)return;var e;(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"resume_pending_connection_button_clicked",integration_type:"jira",setup_session_id:d,from:l}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));await tn().aiQnaActions.connectSpaceToJiraSite({environment:t,spaceId:y})?(0,r().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:l,sessionId:d}):n(!0)}),[l,t,d,y]),C=(0,s.useCallback)((()=>{v&&m&&(nn().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:t,canUndo:!0,perform:e=>{nn().applyOperation({store:m,operation:{pointer:m.pointer,path:["settings"],command:"update",args:{...m.getSettings(),dismissed_jira_installation_pending_prompt:!0}},transaction:e})}}),(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_dismiss",integration_type:"jira",setup_session_id:d,from:l}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"connection_dismiss_screen",analyticsFrom:l,sessionId:d}))}),[v,m,t,l,d]);if(!u||!c)return null;const w=(0,N.jsx)(b().sA,{id:"universalSearch.jira.confirmConnection.jiraWorkspaceLabel",defaultMessage:"Jira workspace"}),k=(0,N.jsx)(b().sA,{id:"universalSearch.jira.confirmConnection.notionWorkspaceLabel",defaultMessage:"Notion workspace"});return(0,N.jsx)(an,{connector:"jira",close:{showCloseButton:!0,onClose:()=>{n(!1),(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_close",integration_type:"jira",setup_session_id:d,from:l}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:d})}},open:"connection_pending_screen"===a,title:(0,N.jsx)(b().sA,{id:"universalQnA.jira.ConfirmConnectionScreen",defaultMessage:"Confirm Jira connection"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.jira.subtext.confirmConnectionScreen",defaultMessage:"A connection was started from the Jira App Marketplace. Review details below:"}),onDismiss:C,onConfirm:j,from:{icon:en().jiraIcon,title:g,label:w},to:{icon:x,title:_,label:k},learnMoreUrl:S})}const cn=Se().w0.jira;function ln(){const e=(0,o().v3)(),n=(0,i().K8)((()=>f().y.state.currentScreen),[]),t=(0,i().K8)((()=>f().y.state.sessionId),[]),s=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),a=(0,i().K8)((()=>f().y.state.sessionId),[]),c=(0,l().O)();let d=(0,i().K8)((()=>f().y.state.jiraSiteId),[]);const u=(0,i().K8)((()=>f().y.state.jiraSyncState),[]),g="in_progress"===u;return(0,N.jsx)(ge().v,{open:"connection_complete_screen"===n,onDismiss:()=>{(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"jira",setup_session_id:t,from:s}}})},connectorType:"jira",notes:[(0,N.jsx)(ue().L,{number:1,title:{...{...ge().D.connectionInProgressTitle,values:{appName:cn}}},description:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:cn}}}},"item2")],onEditSettingsClick:g?void 0:async()=>{if(!c)return;(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_settings",integration_type:"jira",setup_session_id:t,from:s}}});const n=await(0,r().getJiraAIConnectionStatusAction)({environment:e,spaceId:c});if(n){var o;const e=null===(o=n.connectionState)||void 0===o?void 0:o.status;"in_progress"===e?(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"settings_screen"}):"not_started"===e||"pending_selection"===e?(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"select_projects"}):(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"error"})}else(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"error"})},onPrimaryButtonClick:async()=>{var n,o;if(!c)return;if((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"jira",setup_session_id:t,from:s}}}),g||"completed"===u)return void(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:a,screenToShow:"none"});const i=await(0,r().getJiraAIConnectionStatusAction)({environment:e,spaceId:c});if(d=(null==i?void 0:i.jiraSiteId)??"",d){if("in_progress"===(null==i||null===(n=i.connectionState)||void 0===n?void 0:n.status)||"completed"===(null==i||null===(o=i.connectionState)||void 0===o?void 0:o.status))return ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started.background.3"}),position:"bottom"}),void(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:a,screenToShow:"none"});await(0,r().startJiraBulkIngestionAction)({environment:e,spaceId:c,jiraSiteId:d,sessionId:a}),(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:a,screenToShow:"none"})}else(0,r().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:a,screenToShow:"error"})}})}const dn=(0,b().YK)({note1Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},note2Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Jira Site (optional)"},postDisconnectTitle:{id:"universalSearch.jiraIngestion.post_disconnect_modal.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jiraIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"},disconnectTitle:{id:"universalSearch.jiraIngestion.disconnectModal.title",defaultMessage:"Are your sure?"},disconnectSubTitle:{id:"universalSearch.jiraIngestion.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jiraIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.goBack",defaultMessage:"Go back"}});function un(){const e=(0,S().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:C().Wy.regular,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:C().Wy.medium,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:C().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[n,t]=(0,s.useState)(!1),a=(0,i().O$)(f().y),c=(0,i().K8)((()=>a.jiraSiteId),[a]),d=(0,i().K8)((()=>a.jiraSiteUrl),[a]),u=(0,i().K8)((()=>f().y.state.currentScreen),[]),g=(0,l().O)(),p=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),m=(0,i().K8)((()=>f().y.state.sessionId),[]),h=(0,o().v3)(),v=async()=>{if(!g)return;const e=await async function(e){const{environment:n,spaceId:t,jiraSiteId:s}=e,o=await w().callApi({eventName:"disconnectJiraConnector",environment:n,data:{spaceId:t,jiraSiteId:s}});if("success"===o.type)return ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Jira. This can take up to 3 hours.",id:"jira.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:g,jiraSiteId:c});e&&f().y.setState({...a,jiraSyncState:"disconnecting",isDisconnecting:!0,currentScreen:"post_disconnect_screen"})},y=(0,s.useCallback)((()=>{const{noteBlockWrapper:n,noteHeading:t,noteBody:s,link:o}=e;return[(0,N.jsxs)(M().wt,{style:n,children:[(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{...dn.note1Heading})}),(0,N.jsx)("div",{style:s,children:(0,N.jsx)(b().sA,{...dn.note1Body})})]},"note-1"),(0,N.jsxs)(M().wt,{style:n,children:[(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{...dn.note2Heading})}),(0,N.jsx)("div",{style:s,children:(0,N.jsx)(b().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToJiraSiteSettings} and uninstall the Notion AI app.",values:{NavigateToJiraSiteSettings:(0,N.jsx)("a",{style:o,href:`${d}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,D().u4)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"jira",setup_session_id:m,from:p}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.disconnect_jira_marketplace_app",defaultMessage:"Jira Site {ArrowIcon}",values:{ArrowIcon:(0,Ee().q)(e.icon)}})})}},"note2-2")})]},"note-2")]}),[e,d,h,m,p]);return"post_disconnect_screen"===u?(0,N.jsx)(Le().A,{onClickGotItBtn:()=>{f().y.setState({...a,currentScreen:"none"})},onDismiss:()=>{f().y.setState({...a,currentScreen:"none"})},open:"post_disconnect_screen"===u,connectorType:"jira",title:(0,N.jsx)(b().sA,{...dn.postDisconnectTitle}),descriptionMessage:(0,N.jsx)(b().sA,{...dn.postDisconnectDescription}),message:(0,N.jsx)("div",{style:e.notesSectionWrapper,children:y().map(((n,t)=>(0,N.jsxs)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,N.jsx)(I().A,{number:t+1}),(0,N.jsx)("div",{style:e.note,children:n})]},t)))})}):(0,N.jsx)(T().a,{showCloseIcon:!0,open:"disconnect_screen"===u,onDismiss:()=>{f().y.setState({...a,currentScreen:"none"})},render:()=>(0,N.jsx)("div",{style:e.confirmWrapper,children:(0,N.jsxs)("div",{style:e.confirmContainer,children:[(0,N.jsx)("div",{style:e.confirmModalTitle,children:(0,N.jsx)(b().sA,{...dn.disconnectTitle})}),(0,N.jsx)("div",{style:e.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{...dn.disconnectSubTitle})}),(0,N.jsx)("div",{style:e.confirmModalDescription,children:(0,N.jsx)(b().sA,{...dn.disconnectDescription})}),(0,N.jsxs)(M().wt,{style:e.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:e.confirmDisconnectButton,isLoading:n,onClick:async()=>{(0,D().u4)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"jira",setup_session_id:m,from:p}}}),t(!0),await v(),t(!1)},children:(0,N.jsx)(b().sA,{...dn.primaryButtonLabel})}),(0,N.jsx)(A().A,{style:e.goBackButton,onClick:()=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:a.analyticsFrom,sessionId:a.sessionId})},children:(0,N.jsx)(b().sA,{...dn.goBackButtonLabel})})]})]})})})}var gn=()=>t(336519),pn=()=>t(11639);function mn(e){const{notes:n,connectorType:t,open:o,onDismiss:i,title:a,subText:r,onClickPrimaryButton:c,primaryButtonText:l,warningMessage:d}=e,[u,g]=(0,s.useState)(!1),p=(0,S().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},dismissConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},buttonContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"16px"},primaryButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%"}})),[]),m=(0,b().tz)();return(0,N.jsx)(T().a,{ariaLabel:m.formatMessage({id:"universalSearch.dismissConnection.ariaLabel",defaultMessage:"Dismiss Connection modal"}),showCloseIcon:!0,open:o,onDismiss:i,render:()=>(0,N.jsxs)("div",{style:p.wrapper,children:[(0,N.jsx)(B().b,{connectorType:t,title:a,subtext:r,disconnectFlow:!0}),(0,N.jsx)(M().Ye,{style:p.selectionContainer,children:(0,N.jsx)(M().wt,{children:(0,N.jsxs)(M().wt,{style:p.dismissConnectionWrapper,children:[n.map(((e,n)=>(0,N.jsx)(ue().L,{number:n+1,title:e.title,description:e.description},`note${n}`))),(0,N.jsxs)(M().Ye,{style:p.buttonContainer,children:[d,c&&(0,N.jsx)(ce().A,{isLoading:u,disabled:u,style:p.primaryButton,onClick:()=>{g(!0),c(),g(!1)},children:l})]})]})})})]})})}const hn=(0,b().YK)({connectToJiratitle:{id:"universalSearch.jira.connectToJiraLaterNoteHeading1",defaultMessage:"To connect Jira later:"},connectToJiraDescription:{id:"universalSearch.jira.connectToJiraLaterNote1",defaultMessage:"Go to your {aiConnectorSettingElem} and click on the Jira AI connector."},fullyDisconnectJiraTitle:{id:"universalSearch.jira.toDisconnectJiraCompleteHeading",defaultMessage:"To fully disconnect Jira:"},fullyDisconnectJiraDescription:{id:"universalSearch.jira.toDisconnectJiraCompleteNote",defaultMessage:"Go to your {atlassianDashboardElem} and uninstall the Notion AI app."}});function vn(){const e=(0,o().v3)(),n=(0,S().IS)((e=>({link:{display:"inline",color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,i().K8)((()=>f().y.state.currentScreen),[]),a=(0,i().K8)((()=>m().zD.isAiSettingsTabEnabled()),[]),c=(0,i().O$)(p().AppStoreCurrentSpaceStore),l=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),d=(0,i().K8)((()=>f().y.state.jiraSiteUrl),[]),u=(0,i().K8)((()=>f().y.state.sessionId),[]),g=(0,i().K8)((()=>p().default.state.currentUserStore),[]),h=(0,s.useCallback)((()=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:u})}),[l,u]);if(!g||!c)return null;const v=(0,N.jsx)(A().A,{style:{...n.link,display:"inline"},hoveredStyle:{background:"transparent"},onClick:()=>{(0,pn().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ai_settings_redirect",integration_type:"jira",setup_session_id:u,from:l}}}),f().y.setState({...f().y.state,currentScreen:"none"}),gn().Ow({currentTab:a?"ai":"integrations"})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.aiConnectorsSettingsNote1",defaultMessage:"AI Connectors Settings"})}),y=(0,N.jsx)("a",{style:n.link,href:`${d}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,pn().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_uninstall_marketplace_admin",integration_type:"jira",setup_session_id:u,from:l}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.jiraAdminMarketplace",defaultMessage:"Atlassian admin dashboard"})});return(0,N.jsx)(mn,{title:(0,N.jsx)(b().sA,{id:"universalQnA.jira.DismissedConnectionScreen",defaultMessage:"Connection dismissed"}),subText:(0,N.jsx)(b().sA,{id:"universalSearch.jira.DismissedConnectionScreenLabel",defaultMessage:"Here’s what you should know:"}),open:"connection_dismiss_screen"===t,onDismiss:()=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:u})},notes:[{title:hn.connectToJiratitle,description:{...{...hn.connectToJiraDescription,values:{aiConnectorSettingElem:v}}}},{title:hn.fullyDisconnectJiraTitle,description:{...{...hn.fullyDisconnectJiraDescription,values:{atlassianDashboardElem:y}}}}],connectorType:"jira",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.jira.Button.dismissedConnectionConfirmation",defaultMessage:"Got it"},"note3-1"),onClickPrimaryButton:h,openLearnMoreUrl:void 0})}function fn(){const e=(0,i().K8)((()=>f().y.state.currentScreen),[]),n=(0,i().K8)((()=>f().y.state.sessionId),[]),t=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),s=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]),o="error"===e;return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:o,render:()=>(0,N.jsxs)("div",{style:s.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"jira",title:(0,N.jsx)(b().sA,{id:"universalSearch.jira.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.jira.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,N.jsx)(M().wt,{style:s.footer,children:(0,N.jsx)(ce().A,{style:s.connectButton,onClick:()=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,N.jsx)(b().sA,{id:"universalSearch.jira.error.Dismiss",defaultMessage:"Close"})})})]})})}function yn(){const[e,n]=s.useState(!1),t=(0,s.useMemo)((()=>(0,X().a)("jira")),[]),a=(0,s.useMemo)((()=>(0,X().J)("jira")),[]),c=(0,s.useRef)(!1),d=(0,o().v3)(),u=(0,l().O)(),g=(0,i().K8)((()=>f().y.state.currentScreen),[]),v=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),x=(0,i().K8)((()=>f().y.state.sessionId),[]),_=(0,i().K8)((()=>m().zD.isJiraQnaEnabled()),[]),S=d.currentUser.id,j=(0,y().P9)({name:"ai_connectors",spaceId:u,userId:S}),b=(0,i().K8)((()=>p().default.state.currentUserStore),[]),C=(0,U().J)(),k="info_screen"===g,A=(0,i().K8)((()=>h().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);return(0,s.useEffect)((()=>{u&&C&&"info_screen"===g&&(c.current||((0,D().u4)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:x,from:v,is_space_admin:C,is_ai_eligible:j??!1}}}),c.current=!0))}),[u,d,g,x,v,C,j]),_?d.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"jira",open:k,onClosed:()=>{f().y.reset()},learnMoreUrl:A}):C?(0,N.jsx)(O().A,{connectorType:"jira",notes:t,onLearnMore:()=>{window.open(A,"_blank")},onConnect:async()=>{u&&b&&await async function(e,n,t,s,o,i){(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:s,from:o}}}),i(!0);const a=await(0,r().getJiraAIConnectionStatusAction)({environment:e,spaceId:t});if(a){const{connectionState:n}=a;if("not_started"===n.status){(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_screen_open",integration_type:"jira",setup_session_id:s,from:o}}});if("success"===(await w().callApi({eventName:"addNotionInfoForJiraAIConnection",environment:e,data:{spaceId:t}})).type){(0,r().navigateToJiraUniversalScreen)({screenToShow:"check_connection",analyticsFrom:o,sessionId:s});const n=h().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl");n&&((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"app_install_url_opened",integration_type:"jira",setup_session_id:s,from:o}}}),window.open(n,"_blank"))}}else"pending_selection"===n.status?((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_screen_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:o,sessionId:s})):"in_progress"===n.status||"editing"===n.status?((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:o,sessionId:s})):"completed"===n.status?((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:s})):(0,r().navigateToJiraUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:s})}i(!1)}(d,0,u,x,v,n)},onDismiss:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"jira",setup_session_id:x,from:v}}}),(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:v,sessionId:x}),c.current=!1},title:a,isLoading:e,open:k}):(0,N.jsx)(H().BN,{connector:"jira",handleClose:()=>(0,r().resetAiConnectorStatus)("jira"),open:k,analyticsFrom:v,setupSessionId:x,messages:K().z$}):(0,N.jsx)(N.Fragment,{})}var xn=()=>t(365721),_n=()=>t(975392),Sn=()=>t(59175),jn=()=>t(907721);const bn=(0,b().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function Cn(){const[e,n]=s.useState(""),[t,c]=s.useState(!1),[d,u]=s.useState(!1),g=(0,i().K8)((()=>f().y.state.syncControl),[]),[p,m]=s.useState([]),[h,v]=s.useState(!0),[y,x]=s.useState(!0),[_,j]=s.useState(0),[k,A]=s.useState(!1),I=function(e){return(0,S().IS)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:n.blueColor,width:40,height:40},jiraSmallIcon:{fill:n.blueColor,width:18,height:18},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:C().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:C().Wy.regular,color:n.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:C().Wy.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(d),W=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),F=(0,i().K8)((()=>f().y.state.sessionId),[]),P=(0,i().K8)((()=>f().y.state.jiraSiteId),[]),U=(0,i().K8)((()=>f().y.state.currentScreen),[]),z=(0,o().v3)(),E=(0,l().O)(),L=(0,i().O$)(f().y),K="completed"===(0,i().K8)((()=>f().y.state.jiraSyncState),[]),H=(0,s.useCallback)((async()=>{if(!E)return;(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:F,from:W}}});let e,n=[],t=[];if(y?t=p.filter((e=>!e.checked)).map((e=>({id:e.id,name:e.name}))):n=p.filter((e=>e.checked)).map((e=>({id:e.id,name:e.name}))),c(!0),K)e=await(0,r().startJiraEditFlow)({environment:z,spaceId:E,jiraSiteId:P,inclusionList:n,exclusionList:t});else{var s,o;const i=await(0,r().getJiraAIConnectionStatusAction)({environment:z,spaceId:E});if("in_progress"===(null==i||null===(s=i.connectionState)||void 0===s?void 0:s.status)||"completed"===(null==i||null===(o=i.connectionState)||void 0===o?void 0:o.status))return ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Jira is already syncing. This can take up to 36 hours.",id:"jira.sync.started.background.2"}),position:"bottom"}),void(0,r().navigateToJiraUniversalScreen)({analyticsFrom:W,sessionId:F,screenToShow:"none"});e=await(0,r().startJiraBulkIngestionAction)({environment:z,spaceId:E,jiraSiteId:P,sessionId:F,inclusionList:n,exclusionList:t})}e?(0,r().navigateToJiraUniversalScreen)({analyticsFrom:W,screenToShow:"none",sessionId:F}):(0,r().navigateToJiraUniversalScreen)({analyticsFrom:W,screenToShow:"error",sessionId:F}),c(!1)}),[E,y,z,P,p,W,F,K]),G=(0,s.useCallback)((()=>p.find((e=>e.checked))),[p]),R=(0,s.useCallback)((e=>{const n=p.map((n=>n.id===e?{...n,checked:!n.checked}:n));m(n);const t=n.find((e=>e.checked)),s=n.find((e=>!e.checked));let o=!1;t&&s?o="partial":t&&(o=!0),v(o)}),[p]);(0,s.useEffect)((()=>{"select_projects"===U&&(0===g.inclusionList.length&&0===g.exclusionList.length?v(!0):v("partial"),x(0===g.inclusionList.length))}),[U,g]);const O=(0,s.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),q=(0,s.useCallback)((e=>{const n=p.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[p]),Y=(0,s.useCallback)((async e=>{if(!E)return;A(!0);const n=await w().callApi({eventName:"getJiraProjects",environment:z,data:{spaceId:E,jiraSiteId:P,startAt:e}});if("success"===n.type){m((e=>{const t=n.data.projects.map((e=>{let n=!1;return 0===g.inclusionList.length&&0===g.exclusionList.length?n=!0:g.inclusionList.length>0?n=Boolean(g.inclusionList.find((n=>n.id===e.id))):g.exclusionList.length>0&&(n=!g.exclusionList.find((n=>n.id===e.id))),{...e,checked:n}}));return(0,_n().hS)([...e,...t],(e=>e.id))})),j(n.data.total);const t=e+n.data.projects.length;t>e?Y(t):u(!0)}}),[z,E,P,g]),J=(0,s.useCallback)((()=>(0,N.jsxs)(M().wt,{children:[(0,N.jsxs)(M().Ye,{style:I.channelItem,children:[(0,N.jsx)(Ye().A,{render:e=>(0,N.jsx)("div",{...e,children:(0,N.jsx)(ke().A,{checked:h,checkSize:10,size:14,disabled:!d,onClick:()=>{(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),O()}})}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...bn.disabledTooltip})}),disableTooltip:d}),(0,N.jsxs)("div",{style:I.channelsText,children:[(0,xn().y)(I.jiraSmallIcon),(0,N.jsx)(b().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,N.jsx)(Ae().A,{style:I.divider,size:4}),(0,N.jsxs)(N.Fragment,{children:[d?(0,N.jsx)(N.Fragment,{}):(0,N.jsxs)(M().Ye,{style:I.loadingChannelsWrapper,children:[(0,N.jsx)(V().A,{}),(0,N.jsxs)(M().wt,{children:[(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:p.length,totalProjects:_}})}),(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,N.jsx)(M().wt,{style:I.selectionWrapper,children:(e?p.filter((n=>n.name.toLowerCase().includes(e.toLowerCase()))):p).map((e=>(0,N.jsxs)(M().Ye,{gap:8,style:I.channelItemWrapper,children:[(0,N.jsx)(Ye().A,{render:n=>(0,N.jsx)("div",{...n,children:(0,N.jsx)(ke().A,{checked:q(e.id),disabled:!d,onClick:()=>{(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:q(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),R(e.id)},checkSize:10,size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...bn.disabledTooltip})}),disableTooltip:d}),(0,xn().y)(I.jiraSmallIcon),(0,N.jsx)("div",{style:I.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[I,d,p,_,e,h,z,L.sessionId,L.analyticsFrom,O,q,R]);return(0,a().Yb)((async()=>{E&&P&&"select_projects"===U&&!d&&!k&&await Y(0)}),[E,Y,U,P,d,k]),(0,N.jsx)(T().a,{showCloseIcon:!0,open:"select_projects"===U,onDismiss:()=>{(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:F,from:W}}}),(0,r().navigateToJiraUniversalScreen)({analyticsFrom:W,screenToShow:"none",sessionId:F})},render:()=>(0,N.jsxs)("div",{style:I.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"jira",title:(0,N.jsx)(b().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,N.jsx)(b().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,N.jsx)(Ie().A,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(Ye().A,{textWrap:!0,placement:jn().W.Top,render:t=>(0,N.jsx)("div",{...t,children:(0,N.jsx)(M().Ye,{...t,style:I.searchBarWrapper,children:(0,N.jsx)(Sn().A,{id:"jiraUniversalQnASearchBar",style:I.searchBar,disabled:!d,placeholder:le().A.formatMessage(bn.searchForAProject),value:e,onChange:e=>{n(e.target.value),(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:F,from:W}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...bn.disabledTooltip})}),disableTooltip:d})}),(0,N.jsx)(M().Ye,{style:I.selectionContainer,children:(0,N.jsx)(M().wt,{style:I.selection,children:J()})}),(0,N.jsxs)(M().wt,{style:I.footer,children:[(0,N.jsxs)(M().Ye,{style:I.futureChannelsCheckboxWrapper,children:[(0,N.jsx)(Ye().A,{render:e=>(0,N.jsx)("div",{...e,children:(0,N.jsx)(ke().A,{checked:y,checkSize:10,disabled:!d,size:14,onClick:()=>{(0,D().u4)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:y?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),x(!y)}})}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...bn.disabledTooltip})}),disableTooltip:d}),(0,N.jsx)("div",{style:I.channelsText,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,N.jsx)(Ye().A,{render:e=>(0,N.jsx)("div",{...e,children:(0,N.jsx)(ce().A,{isLoading:t,style:I.connectButton,onClick:H,disabled:!G()||!d,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...bn.disabledTooltip})}),disableTooltip:d})]})]})})}const wn=(0,b().YK)({settingsModalTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle",defaultMessage:"Jira is connected to Notion AI"},settingsModalPendingTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle2",defaultMessage:"Jira is connecting to Notion AI"},settingModalConnectionIsPending:{id:"universalSearch.jiraIngestion.settingsModal.connectionIsPending",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete."},tooltipText:{id:"universalSearch.jiraIngestion.settingsModal.tooltipText",defaultMessage:"You can cancel or modify your settings when the connection is complete. "},learnMoreText:{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"},editProjectsButton:{id:"universalSearch.jiraIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Projects"},disconnectJira:{id:"universalSearch.jiraIngestion.settingsModal.disconnectJira",defaultMessage:"Disconnect"}});function kn(){const[e,n]=(0,s.useState)(!0),[t,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[g,p]=(0,s.useState)(0),m=(0,i().O$)(f().y),v=(0,i().K8)((()=>f().y.state.jiraSiteId),[]),y=(0,o().v3)(),x=(0,l().O)(),_=(0,i().K8)((()=>f().y.state.analyticsFrom),[]),j=(0,i().K8)((()=>f().y.state.currentScreen),[]),w=(0,i().K8)((()=>f().y.state.jiraSyncState),[]),k=(0,i().K8)((()=>h().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),I="completed"===w;(0,a().Yb)((async()=>{if(!x||"settings_screen"!==j)return;if(!I)return void n(!1);n(!0);const[e,t]=await Promise.all([(0,r().getJiraAIConnectionStatusAction)({environment:y,spaceId:x}),(0,r().getJiraSyncControlAction)({environment:y,spaceId:x,jiraSiteId:v})]);e&&t&&(c(t.data.sampleProjects),p(t.data.totalConnectedProjects),u(t.data.isFutureProjectsSyncEnabled),n(!1))}),[x,y,j,v,I]);const W=e=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:e,analyticsFrom:m.analyticsFrom,sessionId:m.sessionId})},F=function(e){return(0,S().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?428:void 0},settingsWrapper:{justifyContent:"center",gap:12},jiraDetailsContainer:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:n.text.secondary,gap:12,paddingBottom:12},projectNameContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{width:"100%"},moreProjectsContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:C().Wy.medium,fontSize:C().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${n.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},projectItemWrapper:{width:"100%",padding:"2px 0px 2px 0px",alignItems:"center"},projectName:{fontSize:C().J.UIRegular.desktop},projectIcon:{width:20,color:n.text.secondary},jiraIcon:{fill:n.blueColor,width:40,height:40},jiraIconSmall:{fill:n.blueColor,width:14,height:14}})),[e])}(e);return(0,N.jsx)(T().a,{showCloseIcon:!0,open:"settings_screen"===j,onDismiss:()=>{(0,r().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:_,sessionId:m.sessionId}),c([]),p(0),u(!1)},render:()=>(0,N.jsxs)("div",{style:F.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"jira",title:I?(0,N.jsx)(b().sA,{...wn.settingsModalTitle}):(0,N.jsx)(b().sA,{...wn.settingsModalPendingTitle})}),e?(0,N.jsx)(M().Ye,{style:F.spinner,children:(0,N.jsx)(V().A,{})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M().Ye,{style:F.settingsWrapper,children:(0,N.jsxs)(M().wt,{style:F.jiraDetailsContainer,children:[(0,N.jsx)(M().wt,{children:I?(0,N.jsx)(b().sA,{id:"universalSearch.jiraIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {jiraCountMessage}{futureProjectsMessage}",values:{jiraCountMessage:g?`${g} Jira Projects`:"Jira Project",futureProjectsMessage:d?", including future projects.":"."}}):(0,N.jsx)(b().sA,{...wn.settingModalConnectionIsPending})}),I?(0,N.jsx)(M().wt,{children:d&&(0,N.jsxs)(M().Ye,{style:F.projectItemWrapper,children:[(0,N.jsx)(M().wt,{style:F.projectIcon,children:(0,xn().y)(F.jiraIconSmall)}),(0,N.jsx)(M().wt,{style:F.projectName,children:(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.jiraIngestion.settingsModal.includeCurrentAndFutureProjects",defaultMessage:"Includes current and future projects"})})})]})}):null,I&&t.map((e=>(0,N.jsx)("div",{children:(0,N.jsxs)(M().Ye,{style:F.projectItemWrapper,children:[(0,N.jsx)(M().wt,{style:F.projectIcon,children:(0,xn().y)(F.jiraIconSmall)}),(0,N.jsx)(M().wt,{style:F.projectName,children:e.name})]})},e.id))),I&&(0,N.jsx)(M().Ye,{style:F.moreProjectsContainer,children:g-3>0?(0,N.jsx)(b().sA,{id:"universalSearch.jiraIngestion.settingsModal.moreProjects",defaultMessage:"... and {moreProjectCount} more",values:{moreProjectCount:g-3}}):(0,N.jsx)(N.Fragment,{})})]})}),(0,N.jsxs)(M().wt,{style:F.footer,children:[I?(0,N.jsx)(An,{styles:F.disconnectButton,isEditButtonEnabled:I,navigateToScreen:W}):(0,N.jsx)(Ye().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,N.jsx)("div",{style:{width:240},children:(0,N.jsx)(b().sA,{...wn.tooltipText})}),render:e=>(0,N.jsx)(An,{events:e,styles:F.disconnectButton,isEditButtonEnabled:I,navigateToScreen:()=>{}})}),I?(0,N.jsx)(In,{styles:F.disconnectButton,isDisconnectButtonEnabled:I,navigateToScreen:W}):(0,N.jsx)(Ye().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,N.jsx)("div",{style:{width:240},children:(0,N.jsx)(b().sA,{...wn.tooltipText})}),render:e=>(0,N.jsx)(In,{events:e,styles:F.disconnectButton,isDisconnectButtonEnabled:I,navigateToScreen:W})})]}),(0,N.jsx)(M().Ye,{style:F.learnMoreSection,children:(0,N.jsx)(A().A,{style:F.learnMoreButton,onClick:()=>{(0,D().u4)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"jira",setup_session_id:m.sessionId,from:m.analyticsFrom}}}),window.open(k,"_blank")},children:(0,N.jsxs)(M().Ye,{style:F.learnMoreText,children:[(0,N.jsx)(b().sA,{...wn.learnMoreText}),(0,oe().M)(F.externalLinkIcon)]})})})]})]})})}function An(e){const{styles:n,events:t,isEditButtonEnabled:s,navigateToScreen:a}=e,r=(0,o().v3)(),c=(0,i().O$)(f().y);return(0,N.jsx)(re().A,{...t,size:"lg",style:n,disabled:!s,onClick:()=>{(0,D().u4)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_projects_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),a("select_projects")},children:(0,N.jsx)(b().sA,{...wn.editProjectsButton})})}function In(e){const{styles:n,events:t,isDisconnectButtonEnabled:s,navigateToScreen:a}=e,r=(0,o().v3)(),c=(0,i().O$)(f().y),d=(0,l().O)();(0,i().K8)((()=>f().y.state.jiraSyncState),[]);return(0,N.jsx)(ae().E,{...t,style:n,disabled:!s,onClick:()=>{d&&((0,D().u4)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),a("disconnect_screen"))},children:(0,N.jsx)(b().sA,{...wn.disconnectJira})})}var Tn=()=>t(216842);function Mn(){const[e,n]=s.useState(!1),[t,c]=s.useState(void 0),d=(0,o().v3)(),u=(0,l().O)(),g=(0,i().K8)((()=>Tn().W.state.currentScreen),[]);(0,a().Yb)((async()=>{if(!u||"authentication_pending"!==g)return;const e=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:d,data:{connector:"linear",authorizationType:"workspace",spaceId:u,sessionId:Tn().W.state.sessionId,client:d.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c(n)}),[d,g,u]);const m=(0,S().IS)((e=>({noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontWeight:C().Wy.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),h=(0,i().K8)((()=>p().default.state.currentUserStore),[]);(0,F().n)((async()=>{if(!u)return;if("authentication_pending"!==Tn().W.state.currentScreen)return;"not_started"!==await(0,r().getLinearConnectorStatus)({environment:d,spaceId:u})&&Tn().W.setState({...Tn().W.state,currentScreen:"confirmation"})}),2e3,!0);const v=(0,s.useCallback)((async()=>{if(!u)return;"not_started"!==await(0,r().getLinearConnectorStatus)({environment:d,spaceId:u})?(0,r().navigateToLinearUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}})}),[d,u]),f=(0,s.useCallback)((()=>{n(!1),(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),Tn().W.reset()}),[d]);if(!h||!u)return null;const y=e?(0,N.jsxs)(M().Ye,{style:m.warningContainer,children:[(0,fe().Q)(m.icon),(0,N.jsx)("div",{style:m.warningText,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.warning",defaultMessage:"We couldn’t connect to Linear. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,N.jsx)("a",{style:{...m.link,color:"#D7813A"},href:(0,W().xS)("guides.aiConnectorLinear"),target:"_blank",onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,N.jsx)(ye().Q,{title:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.title",defaultMessage:"Follow instructions from Linear in your browser"}),open:"authentication_pending"===g,onDismiss:f,warningMessage:y,notes:[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Linear should open automatically on a new browser tab."},"note1-1")}),(0,N.jsx)("div",{style:m.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:m.link,href:t,target:"_blank",onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_linear_auth_url",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.followInstructions",defaultMessage:"Follow Linear’s instructions to connect"},"note2")}),(0,N.jsx)("div",{style:m.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Linear workspace and return to this window"},"note1-2")})]},"note-2"),(0,N.jsx)(M().wt,{style:{gap:4},children:(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,W().xS)("guides.aiConnectorLinear"),"_blank")},connectorType:"linear",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.linear.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:v})}const Dn=Se().w0.linear;function Wn(){const e=(0,o().v3)(),n=(0,b().tz)(),t=(0,i().K8)((()=>Tn().W.state.currentScreen),[]),a=(0,l().O)(),c=(0,s.useCallback)((async()=>{if(!a)return;(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"done_button_clicked",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}});const t=await(0,r().getLinearConnectorStatus)({environment:e,spaceId:a});if(!t)return ie().D6({label:n.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.linear.connectionComplete.retryActionRequest"}),position:"bottom"}),void Tn().W.reset();if(["disconnecting"].includes(t))return ie().D6({label:n.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.linear.connectionComplete.failedToUpdateConnection"}),position:"bottom"}),void Tn().W.reset();if(["in_progress","completed"].includes(t))return void Tn().W.reset();await w().callApi({eventName:"startIngestion",environment:e,data:{connector:"linear",spaceId:a}})?Tn().W.reset():ie().D6({label:n.formatMessage({defaultMessage:"Failed to start sync. Please try again later.",id:"universalSearch.linear.connectionComplete.failedToStartSync"}),position:"bottom"})}),[a,e,n]);return(0,N.jsx)(ge().v,{open:"confirmation"===t,onDismiss:c,connectorType:"linear",notes:[(0,N.jsx)(ue().L,{number:1,title:{...{...ge().D.connectionInProgressTitle,values:{appName:Dn}}},description:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Dn}}}},"item2")],onPrimaryButtonClick:c})}t(113085);const Fn=(0,b().YK)({linearAIConnectorOauthPopupTitle:{defaultMessage:"Connect Linear AI Connector",id:"linearAIConnector.oauthPopupTitle"}});function Bn(){const e=(0,b().tz)(),n=(0,s.useMemo)((()=>(0,X().J)("linear")),[]),t=(0,s.useMemo)((()=>(0,X().a)("linear")),[]),c=(0,o().v3)(),[d,u]=(0,s.useState)("CLOSED"),g=(0,l().O)(),p=(0,i().O$)(Tn().W),m=(0,i().K8)((()=>Tn().W.state.sessionId),[]),h=(0,i().K8)((()=>Tn().W.state.analyticsFrom),[]),v=(0,S().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:C().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,U().J)(),x=(0,y().P9)({name:"ai_connectors",spaceId:g,userId:c.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,W().xS)("guides.aiConnectorLinear");(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),c.device.isElectron?k().openExternalUrl(e):window.open(e,"_blank")}),[c]),j=(0,s.useCallback)((async()=>{if(!g||"introduction"!==p.currentScreen)return null;const e=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:c,data:{connector:"linear",authorizationType:"workspace",spaceId:g,client:c.device.isElectron?"desktop":"web",sessionId:Tn().W.state.sessionId}});if("success"!==e.type)return null;const n=e.data.authorizationUrl;c.device.isElectron?k().openExternalUrl(n):Q().P(c,{width:800,height:600,url:n,titleMessage:Fn.linearAIConnectorOauthPopupTitle})}),[g,c,p.currentScreen]),[A]=(0,a().Yb)((async()=>{if(!g||"introduction"!==p.currentScreen)return;const e=await w().callApi({eventName:"listAIConnectors",environment:c,data:{spaceId:g}});return"success"===e.type?{isLinearConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"linear"===e))}:void 0}),[c,p.currentScreen,g]);(0,s.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===A.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[A.status,p.currentScreen]);const I=(0,s.useRef)(!1),F=(0,s.useCallback)((()=>{Tn().W.reset(),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_linear_intro_modal",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),I.current=!1}),[c]),B=(0,s.useCallback)((async()=>{await j(),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"linear_ai_connector_auth_url_open",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),(0,r().navigateToLinearUniversalScreen)({currentScreen:"authentication_pending"})}),[c,j]);return(0,s.useEffect)((()=>{g&&f&&"resolved"===A.status&&"introduction"===p.currentScreen&&(I.current||((0,D().u4)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"linear",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:f,is_ai_eligible:x??!1}}}),I.current=!0))}),[g,c,A.status,p.sessionId,p.analyticsFrom,f,x,p.currentScreen]),g&&"CLOSED"!==d?c.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"linear",open:"introduction"===p.currentScreen,onClosed:()=>{Tn().W.reset()},learnMoreUrl:(0,W().xS)("guides.aiConnectorLinear")}):"LOADING"===d?(0,N.jsx)(T().a,{ariaLabel:e.formatMessage({id:"linearAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Linear AI connector status"}),open:"LOADING"===d,render:()=>(0,N.jsxs)(M().Ye,{style:v.loadingWrapper,children:[(0,N.jsx)(b().sA,{id:"universalQna.linear.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,N.jsx)(V().A,{})]})}):p.isConnected?null:f?(0,N.jsx)(O().A,{onConnect:B,onDismiss:F,onLearnMore:_,title:n,connectorType:"linear",notes:t,open:"OPEN"===d}):(0,N.jsx)(H().BN,{connector:"linear",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,r().resetAiConnectorStatus)("linear"),open:"OPEN"===d,messages:K().A3}):null}function Nn(){const[e,n]=(0,s.useState)(!1),t=(0,o().v3)(),a=(0,l().O)(),r=(0,b().tz)(),c=(0,i().O$)(Tn().W),d=(0,i().K8)((()=>h().default.getConfigKey("linear_ingestion","clientId")),[]),u=(0,s.useCallback)((()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),Tn().W.reset()}),[t]),g=(0,s.useCallback)((()=>{n(!1)}),[]),p=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},learnMoreButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:C().Wy.medium,fontSize:C().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},editTeamsButton:{width:"100%"}})),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(T().a,{ariaLabel:r.formatMessage({id:"linearAIConnector.settings.title",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:g,open:e,render:()=>(0,N.jsx)("div",{style:p.confirmWrapper,children:(0,N.jsxs)("div",{style:p.confirmContainer,children:[(0,N.jsx)("div",{style:p.confirmModalTitle,children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,N.jsx)("div",{style:p.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.confirmation.subTitle",defaultMessage:"Your Linear data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:p.confirmModalDescription,children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,N.jsxs)(M().wt,{style:p.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:p.confirmDisconnectButton,onClick:async()=>{a&&((0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),await w().callApi({eventName:"disconnectAiConnector",environment:t,data:{spaceId:a,connector:"linear"}}),Tn().W.reset(),n(!1),ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Linear disconnected. This can take up to 3 hours.",id:"linearAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,N.jsx)(A().A,{style:p.goBackButton,onClick:g,children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,N.jsx)(T().a,{ariaLabel:r.formatMessage({id:"linearAIConnector.settings.settingsModalTitle",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:u,open:"settings"===c.currentScreen,render:()=>(0,N.jsxs)("div",{style:p.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"linear",title:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.linearIsConnected",defaultMessage:"Linear is connected to Notion AI"}),subtext:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your Linear issues and projects."})}),(0,N.jsxs)(M().wt,{style:p.footer,children:[(0,N.jsx)(re().A,{size:"lg",style:p.editTeamsButton,onClick:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_linear_for_edit_selection",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:Tn().W.state.analyticsFrom}}}),window.open(`https://linear.app/settings/applications/${d}`,"_blank")},children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.editTeams",defaultMessage:"Edit Selected Teams"})}),(0,N.jsx)(ae().E,{style:p.disconnectButton,onClick:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:"connection_settings"}}}),n(!0)},children:(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.disconnectLinear",defaultMessage:"Disconnect"})}),(0,N.jsx)(A().A,{style:p.learnMoreButton,onClick:()=>{(0,D().u4)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"linear",setup_session_id:Tn().W.state.sessionId,from:"connection_settings"}}});const e=(0,W().xS)("guides.aiConnectorLinear");window.open(e,"_blank")},children:(0,N.jsxs)(M().Ye,{style:p.learnMoreText,children:[(0,N.jsx)(b().sA,{id:"linearAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,oe().M)(p.externalLinkIcon)]})})]})]})})]})}function Pn(){const e=(0,i().K8)((()=>g().F.state.currentScreen),[]);return(0,N.jsx)(ee().m,{open:"already_connected_screen"===e,onDismiss:()=>{g().F.reset()},connector:"microsoftTeams"})}function Un(e){const[n,t]=s.useState(!1),[c,d]=s.useState(void 0),u=(0,o().v3)(),m=(0,l().O)(),h=(0,i().K8)((()=>g().F.state.currentScreen),[]);(0,a().Yb)((async()=>{if(!m||"check_connection_screen"!==h)return;const e=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:u,data:{connector:"microsoftTeams",authorizationType:"workspace",spaceId:m,sessionId:g().F.state.sessionId,client:u.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;d(n)}),[u,h,m]);const v=(0,S().IS)((e=>({noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:C().Wy.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),f=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),y=(0,i().K8)((()=>g().F.state.sessionId),[]),x=(0,i().K8)((()=>p().default.state.currentUserStore),[]);(0,F().n)((async()=>{var e;if(!m)return;if("check_connection_screen"!==g().F.state.currentScreen)return;if(await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:u,spaceId:m,sessionId:y}),"connected_to_another_workspace"===(null===(e=g().F.state.error)||void 0===e?void 0:e.reason))return void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:f,sessionId:y});"not_started"!==g().F.state.connectionStatus&&(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:f,sessionId:y})}),1e3,!0);const _=(0,s.useCallback)((async()=>{var e;if(!m)return;if((0,D().u4)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"microsoftTeams",setup_session_id:y,from:f}}}),await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:u,spaceId:m,sessionId:y}),"connected_to_another_workspace"===(null===(e=g().F.state.error)||void 0===e?void 0:e.reason))return void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:f,sessionId:y});"not_started"!==g().F.state.connectionStatus?(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:f,sessionId:y}):t(!0)}),[f,u,y,m]),j=(0,s.useCallback)((()=>{t(!1),(0,D().u4)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"microsoftTeams",setup_session_id:y,from:f}}}),(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:f,sessionId:y})}),[f,u,y]),k=(0,s.useCallback)((()=>{(0,D().u4)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"microsoftTeams",setup_session_id:y,from:f}}})}),[f,u,y]),A=(0,s.useCallback)((()=>{(0,D().u4)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"microsoftTeams",setup_session_id:y,from:f}}})}),[f,u,y]);if(!x||!m)return null;const I=n?(0,N.jsxs)(M().Ye,{style:v.warningContainer,children:[(0,fe().Q)(v.icon),(0,N.jsx)("div",{style:v.warningText,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.warning",defaultMessage:"We couldn’t connect to Microsoft Teams. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,N.jsx)("a",{style:{...v.link,color:"#D7813A"},href:(0,W().xS)("guides.aiConnectorMicrosoftTeams"),target:"_blank",onClick:k,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,N.jsx)(ye().Q,{title:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.title",defaultMessage:"Follow instructions from Microsoft Teams in your browser"}),open:"check_connection_screen"===h,onDismiss:j,warningMessage:I,notes:[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:v.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Teams should open automatically on a new browser tab."},"note1-1")}),(0,N.jsx)("div",{style:v.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:v.link,href:c,target:"_blank",onClick:A,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:v.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructions",defaultMessage:"Follow Team’s instructions to connect"},"note2")}),(0,N.jsx)("div",{style:v.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Microsoft Teams workspace and return to this window"},"note1-2")})]},"note-2"),(0,N.jsx)(M().wt,{style:{gap:4},children:(0,N.jsx)("div",{style:v.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,W().xS)("guides.aiConnectorMicrosoftTeams"),"_blank")},connectorType:"microsoftTeams",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:_})}var zn=()=>t(209684);const En={google_drive:{displayName:"Google Drive",pageVisitSource:Pe().y8.AIGoogleDriveQna},microsoftTeams:{displayName:"Microsoft Teams",pageVisitSource:Pe().y8.AIMicrosoftTeamsQna},slack:{displayName:"Slack",pageVisitSource:Pe().y8.AISlackQna}},Ln=(0,b().YK)({alreadyConnected:{id:"universalQna.connector.connectedToAnotherSpace.title",defaultMessage:"You’ve already connected {connector} to another Notion workspace."},subTitle:{id:"universalQna.connector.connectedToAnotherSpace.subtitle",defaultMessage:"Currently, only one workspace can be connected to {connector}. To connect this workspace, please disconnect the existing connection."},visitAnotherSpace:{id:"universalQna.connector.connectedToAnotherSpace.visitAnotherSpaceButton",defaultMessage:"Visit the other workspace"},gotIt:{id:"universalQna.connector.connectedToAnotherSpace.gotItButton",defaultMessage:"Got it"}});function Kn(e){let{open:n,onDismiss:t,onNavigateToSpace:i,connector:a,connectedSpaceId:r}=e;const c=(0,o().v3)(),l=(0,b().tz)(),d=En[a],u=(0,S().IS)((e=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16},gotItButton:{marginTop:16,justifyContent:"center"}})),[]),g=(0,s.useCallback)((async()=>{const e=p().default.state.currentUserRootStore;if(!e)return;const n=e.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];n&&(await Ue().tR({environment:c,navigationType:"switchingToOrLoadingSpace",pageVisitSource:d.pageVisitSource,spaceViewStore:n,userRootStore:p().default.state.currentUserRootStore,userSettingsStore:p().default.state.currentUserSettingsStore}),i())}),[c,d.pageVisitSource,i,r]),m=l.formatMessage(Ln.alreadyConnected,{connector:d.displayName});return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:t,open:n,ariaLabel:m,render:()=>(0,N.jsxs)(M().wt,{style:u.container,children:[(0,N.jsx)(B().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,N.jsx)(b().sA,{...Ln.subTitle,values:{connector:d.displayName}}),connectorType:a,title:(0,N.jsx)(b().sA,{...Ln.alreadyConnected,values:{connector:d.displayName}})}),(0,N.jsx)(ce().A,{size:"lg",style:u.tryItButton,onClick:g,children:(0,N.jsx)(b().sA,{...Ln.visitAnotherSpace})}),(0,N.jsx)(zn().p,{size:"lg",style:u.gotItButton,onClick:t,children:(0,N.jsx)(b().sA,{...Ln.gotIt})})]})})}function Hn(){const e=(0,i().K8)((()=>g().F.state.currentScreen),[]),n=(0,i().K8)((()=>{var e;return null===(e=g().F.state.error)||void 0===e?void 0:e.connectedSpaceId}),[]),t=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),o=(0,i().K8)((()=>g().F.state.sessionId),[]);return(0,s.useEffect)((()=>{"connected_to_another_workspace_screen"===e&&(n||(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:t,sessionId:o}))}),[n,t,o,e]),(0,N.jsx)(Kn,{open:"connected_to_another_workspace_screen"===e,onDismiss:()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:t,sessionId:o})},connector:"microsoftTeams",setupSessionId:o,onNavigateToSpace:()=>{g().F.reset()},connectedSpaceId:n??""})}const Gn=Se().w0.microsoftTeams;function Rn(){const e=(0,b().tz)(),n=(0,o().v3)(),t=(0,i().K8)((()=>g().F.state.currentScreen),[]),a=(0,i().K8)((()=>g().F.state.sessionId),[]),c=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),d=(0,l().O)(),u="in_progress"===(0,i().K8)((()=>g().F.state.connectionStatus),[]),p=(0,s.useCallback)((()=>{(0,D().u4)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"microsoftTeams",setup_session_id:a,from:c}}}),(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:c,sessionId:a})}),[c,n,a]),m=(0,s.useCallback)((async()=>{if(!d)return;(0,D().u4)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"microsoftTeams",setup_session_id:a,from:c}}});const t=await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:d});if(!t||!t.microsoftTenantId)return ie().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.connectionComplete.retryActionRequest"}),position:"bottom"}),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"none"});if(["disconnecting","editing"].includes(null==t?void 0:t.connectionStatus))return ie().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartSync"}),position:"bottom"}),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"none"});if(["in_progress","completed"].includes(null==t?void 0:t.connectionStatus))return void(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"none"});await(0,r().getMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:d})||await(0,r().setMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:d,syncControls:{syncFutureTeams:!0,teamsToExcludeFromSync:[],syncPrivateConversations:!0}});await(0,r().startMicrosoftTeamsBulkIngestionAction)({environment:n,spaceId:d})?(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"none"}):ie().D6({label:e.formatMessage({defaultMessage:"Failed to start ingestion. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartIngestion"}),position:"bottom"})}),[d,n,c,a,e]),h=(0,s.useCallback)((async()=>{if(!d)return;(0,D().u4)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_settings",integration_type:"microsoftTeams",setup_session_id:a,from:c}}});const e=await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:d});if(!e||"not_started"===e.connectionStatus)return void(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"error_screen"});const t=e.connectionStatus;"in_progress"!==t&&"editing"!==t?"pending_selection"!==t&&"completed"!==t?(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"error_screen"}):(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"settings_screen"}):(0,r().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:a,currentScreen:"edit_blocked_screen"})}),[c,n,a,d]);return(0,N.jsx)(ge().v,{open:"connection_complete_screen"===t,onDismiss:p,connectorType:"microsoftTeams",notes:[(0,N.jsx)(ue().L,{number:1,title:{...{...ge().D.connectionInProgressTitle,values:{appName:Gn}}},description:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Gn}}}},"item2")],onPrimaryButtonClick:m,onEditSettingsClick:u?void 0:h})}function On(){const e=(0,b().tz)(),n=(0,S().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:C().Wy.regular,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:C().Wy.medium,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:C().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"}})),[]),[t,a]=(0,s.useState)(!1),c=(0,i().K8)((()=>g().F.state.currentScreen),[]),d=(0,l().O)(),u=(0,i().K8)((()=>g().F.state.microsoftTenantId),[]),p=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),m=(0,i().K8)((()=>g().F.state.sessionId),[]),h=(0,o().v3)(),v=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:p,sessionId:m})}),[p,m]),f=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:p,sessionId:m})}),[p,m]),y=(0,s.useCallback)((async()=>{if(a(!0),!d||!u)return void a(!1);(0,D().u4)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"microsoftTeams",setup_session_id:m,from:p}}});const e=await async function(e){const{environment:n,spaceId:t,microsoftTenantId:s}=e,o=await w().callApi({eventName:"disconnectMicrosoftTeams",environment:n,data:{spaceId:t,microsoftTenantId:s}});if("success"===o.type)return ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Microsoft Teams. This can take up to 3 hours.",id:"microsoftTeams.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:d,microsoftTenantId:u});e&&g().F.setState({...g().F.state,connectionStatus:"disconnecting",currentScreen:"post_disconnect_screen"}),a(!1)}),[h,u,d,p,m]),x=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"settings_screen",analyticsFrom:p,sessionId:m})}),[p,m]),_=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:s}=n;return[(0,N.jsxs)(M().wt,{style:e,children:[(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{...qn.note1Heading})}),(0,N.jsx)("div",{style:s,children:(0,N.jsx)(b().sA,{...qn.note1Body})})]},"note-1")]}),[n]);return"post_disconnect_screen"===c?(0,N.jsx)(Le().A,{onClickGotItBtn:f,onDismiss:v,open:"post_disconnect_screen"===c,connectorType:"microsoftTeams",title:(0,N.jsx)(b().sA,{...qn.postDisconnectTitle}),descriptionMessage:(0,N.jsx)(b().sA,{...qn.postDisconnectDescription}),message:(0,N.jsx)("div",{style:n.notesSectionWrapper,children:_().map(((e,t)=>(0,N.jsx)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,N.jsx)("div",{style:n.note,children:e})},t)))})}):(0,N.jsx)(T().a,{showCloseIcon:!0,open:"disconnect_screen"===c,onDismiss:v,render:()=>(0,N.jsx)("div",{style:n.confirmWrapper,children:(0,N.jsxs)("div",{style:n.confirmContainer,children:[(0,N.jsx)("div",{style:n.confirmModalTitle,children:(0,N.jsx)(b().sA,{...qn.disconnectTitle})}),(0,N.jsx)("div",{style:n.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{...qn.disconnectSubTitle})}),(0,N.jsx)("div",{style:n.confirmModalDescription,children:(0,N.jsx)(b().sA,{...qn.disconnectDescription})}),(0,N.jsxs)(M().wt,{style:n.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:n.confirmDisconnectButton,isLoading:t,onClick:y,children:(0,N.jsx)(b().sA,{...qn.primaryButtonLabel})}),(0,N.jsx)(A().A,{style:n.goBackButton,onClick:x,children:(0,N.jsx)(b().sA,{...qn.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(qn.disconnectModalAriaLabel)})}const qn=(0,b().YK)({note1Heading:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.heading",defaultMessage:"Teams data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.microsoftTeams.postDisconnect.title",defaultMessage:"Teams is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.microsoftTeams.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.microsoftTeams.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.microsoftTeams.disconnectModal.subTitle",defaultMessage:"Teams data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.microsoftTeams.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.microsoftTeams.disconnectModal.label",defaultMessage:"Disconnect Microsoft Teams Modal"}}),Yn=(0,b().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function Jn(){const e=(0,b().tz)(),n=(0,i().K8)((()=>g().F.state.currentScreen),[]),t=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]),o=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),a=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:a,open:"edit_blocked_screen"===n,render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"microsoftTeams",title:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.editBlocked.title",defaultMessage:"Connection is in Progress"}),subtext:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.editBlocked.description",defaultMessage:"Editing settings is unavailable until the process is complete. This can take up to 36h"})}),(0,N.jsx)(M().wt,{style:t.footer,children:(0,N.jsx)(ce().A,{style:t.connectButton,onClick:o,children:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.editBlocked.gotItButton",defaultMessage:"Got it"})})})]}),ariaLabel:e.formatMessage(Yn.primedTextInput)})}function $n(){const e=(0,b().tz)(),n=(0,i().K8)((()=>g().F.state.currentScreen),[]),t=(0,i().K8)((()=>g().F.state.sessionId),[]),s=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),o=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]);return(0,N.jsx)(T().a,{open:"error_screen"===n,showCloseIcon:!0,onDismiss:()=>(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:s,sessionId:t}),render:()=>(0,N.jsxs)("div",{style:o.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"microsoftTeams",title:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,N.jsx)(M().wt,{style:o.footer,children:(0,N.jsx)(ce().A,{style:o.connectButton,onClick:()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:s,sessionId:t})},children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.Dismiss",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.microsoftTeams.error.ariaLabel",defaultMessage:"Microsoft Teams error modal"})})}const Qn=(0,b().YK)({microsoftTeamsAIConnectorOauthPopupTitle:{defaultMessage:"Connect Microsoft Teams AI Connector",id:"microsoftTeamsAIConnector.oauthPopupTitle"}});function Vn(){const e=(0,o().v3)(),n=(0,U().J)(),t=(0,l().O)(),a=e.currentUser.id,c=(0,y().P9)({name:"ai_connectors",spaceId:t,userId:a}),d=(0,s.useRef)(!1),u=(0,s.useMemo)((()=>(0,X().a)("microsoftTeams")),[]),p=(0,i().K8)((()=>g().F.state.currentScreen),[]),h=(0,i().K8)((()=>g().F.state.connectionStatus),[]),v=(0,i().K8)((()=>g().F.state.sessionId),[]),f=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),x=(0,i().K8)((()=>m().zD.isMicrosoftTeamsQnaEnabled()),[]);(0,s.useEffect)((()=>{t&&n&&"info_screen"===p&&(d.current||((0,D().u4)({environment:e,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"microsoftTeams",setup_session_id:v,from:f,is_space_admin:n,is_ai_eligible:c??!1}}}),d.current=!0))}),[t,e,p,v,f,n,c]);const _=(0,s.useCallback)((async()=>{if(!t)return;(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_ai_connector_auth_url_open",integration_type:"microsoftTeams",setup_session_id:v,from:f}}});const n=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:e,data:{connector:"microsoftTeams",authorizationType:"workspace",spaceId:t,sessionId:v,client:e.device.isElectron?"desktop":"web"}});if("success"!==n.type)return;const s=n.data.authorizationUrl;e.device.isElectron?k().openExternalUrl(s):Q().P(e,{width:800,height:600,url:s,titleMessage:Qn.microsoftTeamsAIConnectorOauthPopupTitle}),(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"check_connection_screen",analyticsFrom:f,sessionId:v})}),[t,e,f,v]),S=(0,s.useCallback)((()=>{(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_microsoft_teams_intro_modal",integration_type:"microsoftTeams",setup_session_id:v,from:f}}}),d.current=!1,g().F.reset()}),[f,v,e]);(0,s.useCallback)((()=>{"completed"===h&&(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"already_connected_screen",analyticsFrom:f,sessionId:v}),"in_progress"!==h&&"editing"!==h||(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"already_connected_screen",analyticsFrom:f,sessionId:v})}),[h,f,v]);const j=(0,s.useCallback)((()=>{const n=(0,W().xS)("guides.aiConnectorMicrosoftTeams");(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"microsoftTeams",setup_session_id:v,from:f}}}),e.device.isElectron?k().openExternalUrl(n):window.open(n,"_blank")}),[e,f,v]);return x&&t&&"info_screen"===p?e.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"microsoftTeams",open:"info_screen"===p,onClosed:()=>{g().F.reset()},learnMoreUrl:(0,W().xS)("guides.aiConnectorMicrosoftTeams")}):n?(0,N.jsx)(O().A,{connectorType:"microsoftTeams",notes:u,onLearnMore:j,onConnect:_,onDismiss:S,title:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.intro.microsoftTeamsTitle",defaultMessage:"To start, install the Notion AI app in Microsoft Teams"}),open:"info_screen"===p}):(0,N.jsx)(H().BN,{connector:"microsoftTeams",handleClose:()=>g().F.reset(),open:"info_screen"===p,analyticsFrom:f,setupSessionId:v,messages:K().Fj}):null}const Xn=(0,b().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.postEdit.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function Zn(){const e=(0,b().tz)(),n=(0,i().K8)((()=>g().F.state.currentScreen),[]),t=(0,S().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),o=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),a=(0,s.useCallback)((()=>{(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),c=[(0,N.jsx)(M().wt,{children:(0,N.jsx)(b().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint1",defaultMessage:"Teams content is being updated according to your new selection"},"note-1-message")},"note-1"),(0,N.jsx)(M().wt,{children:(0,N.jsx)(b().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 48h and AI answers will be unavailable until it is complete."},"note-2-message")},"note-2")];return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:a,open:"post_edit_screen"===n,render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"microsoftTeams",title:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,N.jsx)(M().wt,{style:t.sectionContainer,children:c.map(((e,n)=>(0,N.jsxs)(M().Ye,{gap:8,style:t.section,children:[(0,N.jsx)(I().A,{number:n+1}),(0,N.jsx)("div",{style:t.note,children:e})]},n)))}),(0,N.jsx)(M().wt,{style:t.bottomSectionContainer,children:(0,N.jsx)(ce().A,{onClick:o,children:(0,N.jsx)(b().sA,{id:"aiConnectors.microsoftTeams.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(Xn.primedTextInput)})}var et=()=>t(127436);function nt(){const[e,n]=(0,s.useState)(!0),[t,c]=(0,s.useState)(!1),[d,u]=s.useState(!0),[p,m]=(0,s.useState)(0),[h,v]=(0,s.useState)(""),[f,y]=(0,s.useState)([]),[x,_]=(0,s.useState)(!1),j=(0,S().IS)((e=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:18,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:e.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:170},channelItemWrapper:{marginTop:12},privateConversationIcon:{width:16,height:16}})),[]),w=(0,o().v3)(),k=(0,b().tz)(),A=(0,l().O)(),I=(0,i().K8)((()=>g().F.state.currentScreen),[]),W=(0,i().K8)((()=>g().F.state.sessionId),[]),F=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),P=(0,i().K8)((()=>g().F.state.connectionStatus),[]);(0,a().Yb)((async()=>{var e;if(!A||"settings_screen"!==I)return;if(!P)return n(!1),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W});if(["in_progress","disconnecting","editing"].includes(P))return n(!1),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W});n(!0);if(!(await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:w,spaceId:A})))return;const t=null===(e=await(0,r().getMicrosoftTeamsSyncControlsAction)({environment:w,spaceId:A}))||void 0===e?void 0:e.configuredSyncControls;if(!t)return;_(t.syncFutureTeams),y([]);const s=[];let o;do{const e=await(0,r().getMicrosoftTeamsTeamsAction)({environment:w,spaceId:A,cursor:o});if(!e)return;o=e.cursor,e.totalTeamCount&&m(e.totalTeamCount);for(const o of e.teams){const{id:e,name:n}=o;t.syncFutureTeams?s.push({id:e,name:n,checked:!t.teamsToExcludeFromSync.includes(e)}):s.push({id:e,name:n,checked:t.teamsToSync.includes(e)})}const n=s.find((e=>e.checked)),i=s.find((e=>!e.checked));let a=!1;n&&i?a="partial":n&&(a=!0),u(a),y([...s])}while(o);n(!1)}),[A,I,P,w,F,W]);const U=(0,s.useCallback)((e=>{const n=f.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[f]),z=(0,s.useCallback)((e=>{const n=f.map((n=>n.id===e?{...n,checked:!n.checked}:n));y(n);const t=n.find((e=>e.checked)),s=n.find((e=>!e.checked));let o=!1;t&&s?o="partial":t&&(o=!0),u(o)}),[f]),E=(0,s.useCallback)((()=>{const e=!d;u(e),y((n=>n.map((n=>({...n,checked:e})))))}),[d]),L=(0,s.useCallback)((()=>f.some((e=>e.checked))),[f]),K=(0,s.useCallback)((()=>{(0,D().u4)({environment:w,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"microsoftTeams",setup_session_id:W,from:F}}}),n(!0),c(!1),u(!0),m(0),v(""),y([]),_(!1),(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W})}),[F,W,w]),H=(0,s.useCallback)((async()=>{if(!A)return;(0,D().u4)({environment:w,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_save_button",integration_type:"microsoftTeams",setup_session_id:W,from:F}}}),c(!0);const e=await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:w,spaceId:A});if(!e)return ie().D6({label:k.formatMessage(tt.retryActionRequest),position:"bottom"}),void c(!1);if("completed"!==e.connectionStatus&&"pending_selection"!==e.connectionStatus)return ie().D6({label:k.formatMessage(tt.alreadySyncing),position:"bottom"}),c(!1),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W});let n;if(x){const e={syncFutureTeams:!0,syncPrivateConversations:!0,teamsToExcludeFromSync:f.filter((e=>!e.checked)).map((e=>e.id))};n=await(0,r().setMicrosoftTeamsSyncControlsAction)({environment:w,spaceId:A,syncControls:e})}else{const e={syncFutureTeams:!1,syncPrivateConversations:!0,teamsToSync:f.filter((e=>e.checked)).map((e=>e.id))};n=await(0,r().setMicrosoftTeamsSyncControlsAction)({environment:w,spaceId:A,syncControls:e})}return n?n.syncControlsUpdated?"pending_selection"===e.connectionStatus?(c(!1),ie().D6({label:k.formatMessage(tt.syncingWithNewSyncControl),position:"bottom"}),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W})):(c(!1),ie().D6({label:k.formatMessage(tt.syncingWithNewSyncControl),position:"bottom"}),void(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"post_edit_screen",analyticsFrom:F,sessionId:W})):(ie().D6({label:k.formatMessage(tt.syncControlNotUpdated),position:"bottom"}),void c(!1)):(ie().D6({label:k.formatMessage(tt.retryActionRequest),position:"bottom"}),void c(!1))}),[A,w,x,F,W,k,f]),G=(0,s.useCallback)((()=>{A&&"not_started"!==P?((0,D().u4)({environment:w,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"microsoftTeams",setup_session_id:W,from:F}}}),"in_progress"===P?(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"error_screen",analyticsFrom:F,sessionId:W}):(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"disconnect_screen",analyticsFrom:F,sessionId:W})):(0,r().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:F,sessionId:W})}),[A,P,F,W,w]),R=(0,s.useCallback)((()=>(0,N.jsxs)(M().wt,{children:[(0,N.jsx)(Ye().A,{render:n=>(0,N.jsxs)(M().Ye,{style:j.channelItem,children:[(0,N.jsx)("div",{...n,children:(0,N.jsx)(ke().A,{disabled:t||e,checked:d,checkSize:10,size:14,onClick:()=>{E()}})}),(0,N.jsx)("div",{style:j.channelsText,children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.settings.allTeamsToggle",defaultMessage:"All teams"})})]}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:280},children:(0,N.jsx)(b().sA,{...tt.disabledTooltip})}),disableTooltip:!(t||e)}),(0,N.jsx)(Ae().A,{style:j.divider,size:4}),(0,N.jsx)(N.Fragment,{children:e?(0,N.jsxs)(M().Ye,{style:j.loadingChannelsWrapper,children:[(0,N.jsx)("div",{children:(0,N.jsx)(V().A,{})}),(0,N.jsxs)(M().wt,{children:[(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.settings.loadedXTeams",defaultMessage:"{teamsFetched} of {totalTeams} teams loaded",values:{teamsFetched:f.length,totalTeams:p}})}),(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.settings.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 teams."})})]})]}):(0,N.jsx)(M().wt,{style:j.selectionWrapper,children:(h?f.filter((e=>e.name.toLowerCase().includes(h.toLowerCase()))):f).map((e=>(0,N.jsxs)(M().Ye,{gap:8,style:j.channelItemWrapper,children:[(0,N.jsx)("div",{children:(0,N.jsx)(ke().A,{disabled:t,checked:U(e.id),onClick:()=>{z(e.id)},checkSize:10,size:14},`${e.id}-checkbox`)}),(0,N.jsx)("div",{style:j.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})})]})),[j,t,e,f,p,h,d,E,U,z]);return(0,N.jsx)(T().a,{open:"settings_screen"===I,showCloseIcon:!0,onDismiss:K,render:()=>(0,N.jsxs)("div",{style:j.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"microsoftTeams",title:(0,N.jsx)(b().sA,{id:"universalSearch.microsoftTeams.settings.title",defaultMessage:"Connection Settings"})}),(0,N.jsx)(Ie().A,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(Ye().A,{textWrap:!0,placement:jn().W.Top,render:n=>(0,N.jsx)("div",{...n,children:(0,N.jsx)(M().Ye,{style:j.searchBarWrapper,children:(0,N.jsx)(Sn().A,{id:"microsoftTeamsUniversalQnASearchBar",style:j.searchBar,placeholder:k.formatMessage(tt.searchBoxPlaceholder),value:h,onChange:e=>{v(e.target.value)},disabled:e},"microsoftTeamsUniversalQnASearchBar")})}),renderTooltip:()=>(0,N.jsx)(b().sA,{...tt.disabledTooltip}),disableTooltip:!e})}),(0,N.jsx)(M().Ye,{style:j.selectionContainer,children:(0,N.jsx)(M().wt,{style:j.selection,children:R()})}),(0,N.jsxs)(M().wt,{style:j.footer,children:[(0,N.jsx)(Ye().A,{textWrap:!0,placement:jn().W.Top,render:n=>(0,N.jsxs)(M().Ye,{style:j.futureChannelsCheckboxWrapper,children:[(0,N.jsx)("div",{...n,children:(0,N.jsx)(ke().A,{disabled:t||e,checked:x,checkSize:10,size:14,onClick:()=>{_(!x)}})}),(0,N.jsx)("div",{style:j.channelsText,children:(0,N.jsx)(b().sA,{...tt.syncFutureTeamsCheckboxLabel})})]}),renderTooltip:()=>(0,N.jsx)(b().sA,{...tt.disabledTooltip}),disableTooltip:!e}),(0,N.jsxs)(M().Ye,{style:j.futureChannelsCheckboxWrapper,children:[(0,N.jsx)("div",{children:(0,et().i)(j.privateConversationIcon)}),(0,N.jsx)("div",{style:j.channelsText,children:(0,N.jsx)(b().sA,{...tt.syncPrivateConversationLabel})})]}),(0,N.jsx)(ce().A,{style:j.connectButton,onClick:H,disabled:t||e||!L()&&!x,children:(0,N.jsx)(b().sA,{...tt.saveButton})}),(0,N.jsx)(re().A,{color:"uiRed",style:j.connectButton,disabled:t||e||"in_progress"===P,onClick:G,children:(0,N.jsx)(b().sA,{...tt.disconnectButton})})]})]}),ariaLabel:k.formatMessage(tt.modalAriaLabel)})}const tt=(0,b().YK)({disabledTooltip:{id:"universalSearch.microsoftTeams.settings.disabledTooltip",defaultMessage:"You can only interact after all teams are loaded"},saveButton:{id:"universalSearch.microsoftTeams.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.microsoftTeams.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.microsoftTeams.settings.modalAriaLabel",defaultMessage:"Microsoft Teams error modal"},searchBoxPlaceholder:{id:"universalSearch.microsoftTeams.settings.searchBoxPlaceholder",defaultMessage:"Search for a Team"},alreadySyncing:{defaultMessage:"Microsoft Teams is already syncing. This can take up to 36 hours.",id:"universalSearch.microsoftTeams.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.settings.retryActionRequest"},syncFutureTeamsCheckboxLabel:{id:"universalSearch.microsoftTeams.settings.syncFutureTeamsCheckboxLabel",defaultMessage:"Include teams created in the future"},syncPrivateConversationLabel:{id:"universalSearch.microsoftTeams.settings.syncPrivateConversationLabel",defaultMessage:"Content in private conversations will only be shown to members who have access to them. Permissions are strictly respected."},syncControlNotUpdated:{id:"universalSearch.microsoftTeams.settings.syncControlNotUpdated",defaultMessage:"No change made to Microsoft Teams Connection."},syncingWithNewSyncControl:{id:"universalSearch.microsoftTeams.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from Microsoft Teams. This can take up to 36 hours."}});var st=()=>t(145652);function ot(){const[e,n]=s.useState(!1),[t,c]=s.useState(void 0),d=(0,o().v3)(),u=(0,l().O)(),g=(0,i().K8)((()=>st().E.state.currentScreen),[]);(0,a().Yb)((async()=>{if(!u||"connecting"!==g)return;const e=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:d,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:u,sessionId:st().E.state.sessionId,client:d.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c(n)}),[d,g,u]);const m=(0,S().IS)((e=>({noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontWeight:C().Wy.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),h=(0,i().K8)((()=>p().default.state.currentUserStore),[]);(0,F().n)((async()=>{if(!u)return;if("connecting"!==st().E.state.currentScreen)return;"not_started"!==await(0,r().getSharepointConnectorStatus)({environment:d,spaceId:u})&&st().E.setState({...st().E.state,currentScreen:"confirmation",connectionDetails:{status:"pending_selection",progress:0}})}),2e3,!0);const v=(0,s.useCallback)((async()=>{if(!u)return;"not_started"!==await(0,r().getSharepointConnectorStatus)({environment:d,spaceId:u})?(0,r().navigateToSharepointUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}})}),[d,u]),f=(0,s.useCallback)((()=>{n(!1),(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),st().E.reset()}),[d]);if(!h||!u)return null;const y=e?(0,N.jsxs)(M().Ye,{style:m.warningContainer,children:[(0,fe().Q)(m.icon),(0,N.jsx)("div",{style:m.warningText,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.warning",defaultMessage:"We couldn’t connect to SharePoint. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,N.jsx)("a",{style:{...m.link,color:"#D7813A"},href:(0,W().xS)("guides.aiConnectorSharepoint"),target:"_blank",onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,N.jsx)(ye().Q,{title:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.title",defaultMessage:"Follow instructions from SharePoint in your browser"}),open:"connecting"===g,onDismiss:f,warningMessage:y,notes:[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"SharePoint should open automatically on a new browser tab."},"note1-1")}),(0,N.jsx)("div",{style:m.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:m.link,href:t,target:"_blank",onClick:()=>{(0,D().u4)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_sharepoint_auth_url",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}})},children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructions",defaultMessage:"Follow SharePoint’s instructions to connect"},"note2")}),(0,N.jsx)("div",{style:m.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a SharePoint workspace and return to this window"},"note1-2")})]},"note-2"),(0,N.jsx)(M().wt,{style:{gap:4},children:(0,N.jsx)("div",{style:m.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,W().xS)("guides.aiConnectorSharepoint"),"_blank")},connectorType:"sharepoint",primaryButtonText:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:v})}const it=Se().w0.sharepoint;function at(){const e=(0,b().tz)(),n=(0,o().v3)(),t=(0,i().K8)((()=>st().E.state.currentScreen),[]),a=(0,l().O)(),c=(0,s.useCallback)((async()=>{if(!a)return;(0,D().u4)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_settings_button_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}});const e=await(0,r().getSharepointConnectorStatus)({environment:n,spaceId:a});e?"in_progress"!==e&&"editing"!==e?"pending_selection"!==e&&"completed"!==e?(0,r().navigateToSharepointUniversalScreen)({currentScreen:"error"}):(0,r().navigateToSharepointUniversalScreen)({currentScreen:"settings"}):(0,r().navigateToSharepointUniversalScreen)({currentScreen:"edit_blocked"}):(0,r().navigateToSharepointUniversalScreen)({currentScreen:"error"})}),[a,n]),d=(0,s.useCallback)((async()=>{if(!a)return;(0,D().u4)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"done_button_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}});const t=await(0,r().getSharepointConnectorStatus)({environment:n,spaceId:a});if(!t)return ie().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.connectionComplete.retryActionRequest"}),position:"bottom"}),void st().E.reset();if(["disconnecting","editing"].includes(t))return ie().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToUpdateConnection"}),position:"bottom"}),void st().E.reset();if(["in_progress","completed"].includes(t))return void st().E.reset();await w().callApi({eventName:"startIngestion",environment:n,data:{connector:"sharepoint",spaceId:a}})?st().E.reset():ie().D6({label:e.formatMessage({defaultMessage:"Failed to start sync. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToStartSync"}),position:"bottom"})}),[a,n,e]);return(0,N.jsx)(ge().v,{open:"confirmation"===t,onDismiss:d,connectorType:"sharepoint",notes:[(0,N.jsx)(ue().L,{number:1,title:{...{...ge().D.connectionInProgressTitle,values:{appName:it}}},description:ge().D.defaultConnectionTime},"item1"),(0,N.jsx)(ue().L,{number:2,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:it}}}},"item2")],onEditSettingsClick:c,onPrimaryButtonClick:d})}function rt(){const e=(0,b().tz)(),n=(0,S().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:C().J.UIRegular.desktop,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:C().Wy.regular,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:C().Wy.medium,fontSize:C().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:e.text.secondary,fontSize:C().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,a]=(0,s.useState)(!1),r=(0,i().K8)((()=>st().E.state.currentScreen),[]),c=(0,l().O)(),d=(0,o().v3)(),u=(0,s.useCallback)((()=>{st().E.reset()}),[]),g=(0,s.useCallback)((()=>{st().E.reset()}),[]),p=(0,s.useCallback)((async()=>{if(a(!0),!c)return void a(!1);const e=await async function(e){const{environment:n,spaceId:t}=e,s=await w().callApi({eventName:"disconnectAiConnector",environment:n,data:{spaceId:t,connector:"sharepoint"}});if("success"===s.type)return ie().D6({label:le().A.getIntl().formatMessage({defaultMessage:"Started disconnecting SharePoint. This can take up to 3 hours.",id:"sharepoint.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:d,spaceId:c});e&&st().E.setState({...st().E.state,status:"disconnecting",currentScreen:"post_disconnect"}),a(!1)}),[d,c]),m=(0,s.useCallback)((()=>{st().E.setState({...st().E.state,currentScreen:"settings"})}),[]),h=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:s}=n;return[(0,N.jsxs)(M().wt,{style:e,children:[(0,N.jsx)("div",{style:t,children:(0,N.jsx)(b().sA,{...ct.note1Heading})}),(0,N.jsx)("div",{style:s,children:(0,N.jsx)(b().sA,{...ct.note1Body})})]},"note-1")]}),[n]);return"post_disconnect"===r?(0,N.jsx)(Le().A,{onClickGotItBtn:g,onDismiss:u,open:"post_disconnect"===r,connectorType:"sharepoint",title:(0,N.jsx)(b().sA,{...ct.postDisconnectTitle}),descriptionMessage:(0,N.jsx)(b().sA,{...ct.postDisconnectDescription}),message:(0,N.jsx)("div",{style:n.notesSectionWrapper,children:h().map(((e,t)=>(0,N.jsx)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,N.jsx)("div",{style:n.note,children:e})},t)))})}):(0,N.jsx)(T().a,{showCloseIcon:!0,open:"disconnect"===r,onDismiss:u,render:()=>(0,N.jsx)("div",{style:n.confirmWrapper,children:(0,N.jsxs)("div",{style:n.confirmContainer,children:[(0,N.jsx)("div",{style:n.confirmModalTitle,children:(0,N.jsx)(b().sA,{...ct.disconnectTitle})}),(0,N.jsx)("div",{style:n.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{...ct.disconnectSubTitle})}),(0,N.jsx)("div",{style:n.confirmModalDescription,children:(0,N.jsx)(b().sA,{...ct.disconnectDescription})}),(0,N.jsxs)(M().wt,{style:n.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:n.confirmDisconnectButton,isLoading:t,onClick:p,children:(0,N.jsx)(b().sA,{...ct.primaryButtonLabel})}),(0,N.jsx)(A().A,{style:n.goBackButton,onClick:m,children:(0,N.jsx)(b().sA,{...ct.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(ct.disconnectModalAriaLabel)})}const ct=(0,b().YK)({note1Heading:{id:"universalSearch.sharepoint.postDisconnect.note_1.heading",defaultMessage:"SharePoint data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.sharepoint.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.sharepoint.postDisconnect.title",defaultMessage:"SharePoint is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.sharepoint.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.sharepoint.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.sharepoint.disconnectModal.subTitle",defaultMessage:"SharePoint data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.sharepoint.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.sharepoint.disconnectModal.label",defaultMessage:"Disconnect SharePoint Modal"}});function lt(){const e=(0,b().tz)(),n=(0,i().K8)((()=>st().E.state.currentScreen),[]),t=(0,S().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:"100%"}})),[]);return(0,N.jsx)(T().a,{open:"error"===n,showCloseIcon:!0,onDismiss:()=>{st().E.reset()},render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"sharepoint",title:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,N.jsx)(M().wt,{style:t.footer,children:(0,N.jsx)(ce().A,{style:t.connectButton,onClick:()=>{st().E.reset()},children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.dismissButton",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.sharepoint.error.ariaLabel",defaultMessage:"SharePoint error modal"})})}function dt(e){const{open:n}=e;return(0,N.jsx)(ee().m,{open:n,onDismiss:()=>{st().E.reset()},connector:"sharepoint"})}const ut=(0,b().YK)({sharepointAIConnectorOauthPopupTitle:{defaultMessage:"Connect SharePoint AI Connector",id:"sharepointAIConnector.oauthPopupTitle"}});function gt(){const e=(0,b().tz)(),n=(0,s.useMemo)((()=>(0,X().J)("sharepoint")),[]),t=(0,s.useMemo)((()=>(0,X().a)("sharepoint")),[]),c=(0,o().v3)(),[d,u]=(0,s.useState)("CLOSED"),g=(0,l().O)(),p=(0,i().O$)(st().E),m=(0,i().K8)((()=>st().E.state.sessionId),[]),h=(0,i().K8)((()=>st().E.state.analyticsFrom),[]),v=(0,S().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:C().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,U().J)(),x=(0,y().P9)({name:"ai_connectors",spaceId:g,userId:c.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,W().xS)("guides.aiConnectorSharepoint");(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),c.device.isElectron?k().openExternalUrl(e):window.open(e,"_blank")}),[c]),j=(0,s.useCallback)((async()=>{if(!g)return;const e=await w().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:c,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:g,client:c.device.isElectron?"desktop":"web",sessionId:st().E.state.sessionId}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c.device.isElectron?k().openExternalUrl(n):Q().P(c,{width:800,height:600,url:n,titleMessage:ut.sharepointAIConnectorOauthPopupTitle}),st().E.setState({...st().E.state,authUrl:n,currentScreen:"connecting"})}),[g,c]),[A]=(0,a().Yb)((async()=>{if(!g||"introduction"!==p.currentScreen)return;const e=await w().callApi({eventName:"listAIConnectors",environment:c,data:{spaceId:g}});return"success"===e.type?{isSharepointConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"sharepoint"===e))}:void 0}),[c,p.currentScreen,g]);(0,s.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===A.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[A.status,p.currentScreen]);const I=(0,s.useRef)(!1),F=(0,s.useCallback)((()=>{st().E.reset(),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_sharepoint_intro_modal",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),I.current=!1}),[c]),B=(0,s.useCallback)((async()=>{await j(),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"sharepoint_ai_connector_auth_url_open",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),st().E.setState({...st().E.state,currentScreen:"connecting"})}),[c,j]);return(0,s.useEffect)((()=>{g&&f&&"resolved"===A.status&&"introduction"===p.currentScreen&&(I.current||((0,D().u4)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"sharepoint",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:f,is_ai_eligible:x??!1}}}),I.current=!0))}),[g,c,A.status,p.sessionId,p.analyticsFrom,f,x,p.currentScreen]),g&&"CLOSED"!==d?c.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"sharepoint",open:"introduction"===p.currentScreen,onClosed:()=>{st().E.reset()},learnMoreUrl:(0,W().xS)("guides.aiConnectorSharepoint")}):"LOADING"===d?(0,N.jsx)(T().a,{ariaLabel:e.formatMessage({id:"sharepointAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading SharePoint AI connector status"}),open:"LOADING"===d,render:()=>(0,N.jsxs)(M().Ye,{style:v.loadingWrapper,children:[(0,N.jsx)(b().sA,{id:"universalQna.sharepoint.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,N.jsx)(V().A,{})]})}):p.isConnected?(0,N.jsx)(dt,{open:!0}):f?(0,N.jsx)(O().A,{onConnect:B,onDismiss:F,onLearnMore:_,title:n,connectorType:"sharepoint",notes:t,open:"OPEN"===d}):(0,N.jsx)(H().BN,{connector:"sharepoint",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,r().resetAiConnectorStatus)("sharepoint"),open:"OPEN"===d,messages:K().oO}):null}const pt=(0,b().YK)({primedTextInput:{id:"aiConnectors.sharepoint.postEdit.primedTextInput",defaultMessage:"Search for content in SharePoint"}});function mt(){const e=(0,b().tz)(),n=(0,i().K8)((()=>st().E.state.currentScreen),[]),t=(0,S().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),o=(0,s.useCallback)((()=>{st().E.reset()}),[]),a=(0,s.useCallback)((()=>{st().E.reset()}),[]),r=[(0,N.jsx)(M().wt,{children:(0,N.jsx)(b().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint1",defaultMessage:"SharePoint content will be updated according to the new selection."},"note-1-message")},"note-1"),(0,N.jsx)(M().wt,{children:(0,N.jsx)(b().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 36 hours and AI answers will be unavailable until it’s complete"},"note-2-message")},"note-2")];return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:a,open:"post_edit"===n,render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"sharepoint",title:(0,N.jsx)(b().sA,{id:"aiConnectors.sharepoint.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,N.jsx)(b().sA,{id:"aiConnectors.sharepoint.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,N.jsx)(M().wt,{style:t.sectionContainer,children:r.map(((e,n)=>(0,N.jsxs)(M().Ye,{gap:8,style:t.section,children:[(0,N.jsx)(I().A,{number:n+1}),(0,N.jsx)("div",{style:t.note,children:e})]},n)))}),(0,N.jsx)(M().wt,{style:t.bottomSectionContainer,children:(0,N.jsx)(ce().A,{onClick:o,children:(0,N.jsx)(b().sA,{id:"aiConnectors.sharepoint.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(pt.primedTextInput)})}function ht(){const[e,n]=(0,s.useState)(!0),[t,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),[g,p]=(0,s.useState)([]),[m,h]=(0,s.useState)([]),[v,f]=(0,s.useState)([]),[y,x]=(0,s.useState)(!0),[_,j]=(0,s.useState)(!1),k=(0,S().IS)((e=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},siteItem:{gap:4,alignItems:"center"},sitesText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureSitesCheckboxWrapper:{gap:12,visibility:"visible"},selectionWrapper:{overflowY:"scroll",maxHeight:170},siteItemWrapper:{marginTop:12}})),[]),A=(0,o().v3)(),I=(0,b().tz)(),W=(0,l().O)(),F=(0,i().K8)((()=>st().E.state.currentScreen),[]),P=(0,i().K8)((()=>{var e;return null===(e=st().E.state.connectionDetails)||void 0===e?void 0:e.status}),[]);(0,a().Yb)((async()=>{if(!W||"settings"!==F)return;if(!P)return n(!1),void st().E.reset();if(["in_progress","disconnecting","editing"].includes(P))return n(!1),void st().E.reset();n(!0);const e=await w().callApi({eventName:"getAllSharepointSites",environment:A,data:{spaceId:W}}),t=await w().callApi({eventName:"getSharepointSelection",environment:A,data:{spaceId:W}});if("failed"===e.type||"failed"===t.type)return;const s=e.data;p(t.data.includedSites),h(t.data.excludedSites),j(t.data.includeFutureSites),f(s),n(!1)}),[W,F,P,A]),(0,s.useEffect)((()=>{const e=v.filter((e=>![...g,...m].includes(e.id)));if(e.length>0){const n=_?e.map((e=>e.id)):[],t=_?[]:e.map((e=>e.id));n.length>0&&p((e=>[...e,...n])),t.length>0&&h((e=>[...e,...t]))}}),[v,_,g,m]),(0,s.useEffect)((()=>{g.length===v.length?x(!0):g.length>0?x("partial"):x(!1)}),[g,v]);const U=(0,s.useCallback)((e=>g.includes(e)),[g]),z=(0,s.useCallback)((e=>{g.includes(e)?(p((n=>n.filter((n=>n!==e)))),h((n=>[...n,e]))):(h((n=>n.filter((n=>n!==e)))),p((n=>[...n,e])))}),[g]),E=(0,s.useCallback)((()=>{g.length>0?(p([]),h(v.map((e=>e.id)))):(p(v.map((e=>e.id))),h([]))}),[g,v]),L=(0,s.useCallback)((()=>g.length>0),[g]),K=(0,s.useCallback)((()=>{st().E.reset()}),[]),H=(0,s.useCallback)((async()=>{if(!W)return;(0,D().u4)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_settings_button_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),c(!0);const e=await(0,r().getSharepointConnectorStatus)({environment:A,spaceId:W});return e?"completed"!==e&&"pending_selection"!==e?(ie().D6({label:I.formatMessage(vt.alreadySyncing),position:"bottom"}),c(!1),void st().E.reset()):(await w().callApi({eventName:"setSharepointSelection",environment:A,data:{spaceId:W,allSites:!0===y,includedSites:g,excludedSites:m,includeFutureSites:_}}),await w().callApi({eventName:"startIngestion",environment:A,data:{connector:"sharepoint",spaceId:W}}),c(!1),ie().D6({label:I.formatMessage(vt.syncingWithNewSyncControl),position:"bottom"}),void(0,r().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"})):(ie().D6({label:I.formatMessage(vt.retryActionRequest),position:"bottom"}),void c(!1))}),[W,A,I,y,g,m,_]),G=(0,s.useCallback)((()=>{W?((0,D().u4)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"sharepoint",setup_session_id:st().E.state.sessionId,from:st().E.state.analyticsFrom}}}),(0,r().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"})):st().E.reset()}),[W,A]),R=(0,s.useCallback)((()=>(0,N.jsxs)(M().wt,{children:[(0,N.jsxs)(M().Ye,{style:k.siteItem,children:[(0,N.jsx)("div",{children:(0,N.jsx)(ke().A,{disabled:t,checked:y,checkSize:10,size:14,onClick:()=>{E()}})}),(0,N.jsx)("div",{style:k.sitesText,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.settings.allSitesToggle",defaultMessage:"All sites"})})]}),(0,N.jsx)(Ae().A,{style:k.divider,size:4}),(0,N.jsx)(N.Fragment,{children:e?(0,N.jsxs)(M().Ye,{style:k.futureSitesCheckboxWrapper,children:[(0,N.jsx)(V().A,{}),(0,N.jsx)("div",{style:k.sitesText,children:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.settings.loadingSites",defaultMessage:"Fetching sites. This can take up to a few minutes based on the number of sites in your account."})})]}):(0,N.jsx)(M().wt,{style:k.selectionWrapper,children:(d?v.filter((e=>(e.name||e.id).toLowerCase().includes(d.toLowerCase()))):v).map((e=>(0,N.jsxs)(M().Ye,{gap:8,style:k.siteItemWrapper,children:[(0,N.jsx)("div",{children:(0,N.jsx)(ke().A,{disabled:t,checked:U(e.id),onClick:()=>{z(e.id)},checkSize:10,size:14},`${e.id}-checkbox`)}),(0,N.jsx)("div",{style:k.sitesText,children:` ${e.name||e.id}`},`${e.id}-label`)]},e.id)))})})]})),[k,t,y,e,d,v,E,U,z]);return(0,N.jsx)(T().a,{open:"settings"===F,showCloseIcon:!0,onDismiss:K,render:()=>(0,N.jsxs)("div",{style:k.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"sharepoint",title:(0,N.jsx)(b().sA,{id:"universalSearch.sharepoint.settings.title",defaultMessage:"Connection Settings"})}),(0,N.jsx)(Ie().A,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)("div",{children:(0,N.jsx)(M().Ye,{style:k.searchBarWrapper,children:(0,N.jsx)(Sn().A,{id:"sharepointUniversalQnASearchBar",style:k.searchBar,placeholder:I.formatMessage(vt.searchBoxPlaceholder),value:d,onChange:e=>{u(e.target.value)},disabled:e},"sharepointUniversalQnASearchBar")})})}),(0,N.jsx)(M().Ye,{style:k.selectionContainer,children:(0,N.jsx)(M().wt,{style:k.selection,children:R()})}),(0,N.jsxs)(M().wt,{style:k.footer,children:[(0,N.jsxs)(M().Ye,{style:k.futureSitesCheckboxWrapper,children:[(0,N.jsx)("div",{children:(0,N.jsx)(ke().A,{disabled:t,checked:_,checkSize:10,size:14,onClick:()=>{j(!_)}})}),(0,N.jsx)("div",{style:k.sitesText,children:(0,N.jsx)(b().sA,{...vt.syncFutureSitesCheckboxLabel})})]}),(0,N.jsx)(ce().A,{style:k.connectButton,onClick:H,disabled:t||e||!L()&&!_,children:(0,N.jsx)(b().sA,{...vt.saveButton})}),(0,N.jsx)(re().A,{color:"uiRed",style:k.connectButton,disabled:t||e||"in_progress"===P,onClick:G,children:(0,N.jsx)(b().sA,{...vt.disconnectButton})})]})]}),ariaLabel:I.formatMessage(vt.modalAriaLabel)})}const vt=(0,b().YK)({saveButton:{id:"universalSearch.sharepoint.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.sharepoint.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.sharepoint.settings.modalAriaLabel",defaultMessage:"SharePoint error modal"},searchBoxPlaceholder:{id:"universalSearch.sharepoint.settings.searchBoxPlaceholder",defaultMessage:"Search for a site"},alreadySyncing:{defaultMessage:"SharePoint is already syncing. This can take up to 36 hours.",id:"universalSearch.sharepoint.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.settings.retryActionRequest"},syncFutureSitesCheckboxLabel:{id:"universalSearch.sharepoint.settings.syncFutureSitesCheckboxLabel",defaultMessage:"Include sites created in the future"},syncingWithNewSyncControl:{id:"universalSearch.sharepoint.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from SharePoint. This can take up to 36 hours."}});var ft=()=>t(421650),yt=()=>t(467586),xt=()=>t(330358);function _t(){const e=(0,o().v3)(),n=(0,U().J)(),t=(0,i().O$)(p().AppStoreCurrentSpaceStore),a=null==t?void 0:t.id,c=e.currentUser.id,l=(0,y()._X)({name:"ai_connectors",spaceId:a,userId:c}),d=(0,b().tz)(),u=(0,i().K8)((()=>z().O.state.open&&"slack_announcement"===z().O.state.modal),[]),g=(0,s.useCallback)((n=>{let{source:t,upsell:s}=n;if(!p().default.state.currentSpaceViewStore||!a)return;const o=(0,yt().vp)(e,a);z().O.setState({...z().O.state,open:!1}),"closeButton"!==t&&(s?o?(xt().A.setState({...xt().A.state,open:!0,openedFrom:"slack_universal_qna_announcement_modal",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),ft().QP(e,{from:"slack_universal_qna_announcement_modal"})):E().K(e,{from:"slack_universal_qna_announcement_modal",upsell:s}):(0,r().navigateToSlackUniversalQnAOnboarding)({analyticsFrom:"slack_universal_qna_announcement_modal"}))}),[e,a]);return l?(0,N.jsx)(T().a,{ariaLabel:d.formatMessage(K().vK.title),open:u,render:()=>(0,N.jsx)(L().Y,{messages:K().vK,aiConnectorsFeatureAvailability:l,onDismiss:g,calloutKey:"ai_slack_ai_connector_announcement",eventName:"ai_slack_universal_qna_announcement_modal_shown",learnMoreHref:(0,W().xS)("guides.aiConnectorSlack"),connector:"slack",showNarrowCta:n})}):null}var St=()=>t(145046);const jt=(0,b().YK)({searchForAChannel:{id:"universalQnA.slack.searchForAChannel",defaultMessage:"Search for a Channel"}});function bt(){const[e,n]=s.useState(""),[t,a]=s.useState(!1),[r,c]=s.useState(!0),[d,u]=s.useState([]),g=(0,s.useRef)(!1),m=(0,o().v3)(),v=(0,l().O)(),f=(0,i().O$)(_().R),y=(0,s.useCallback)((()=>{const e=h().default.getConfigKey("ingestion","slack");window.open(null==e?void 0:e.learnMoreUrl,"_blank")}),[]),k=(0,i().K8)((()=>p().default.getState().currentUserStore),[]),W=(0,s.useCallback)((()=>{g.current=!1,a(!1),n(""),c(!0),u([])}),[]),P=(0,s.useCallback)((async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0;try{const s=await w().callApi({eventName:"getSlackPublicChannels",environment:m,data:{spaceId:e,cursor:t}});if("success"===s.type){u((e=>(0,_n().hS)([...e,...s.data.channels],(e=>e.id))));const n=s.data.cursor;_().R.state.isEditing&&(c(!1),_().R.setState({..._().R.state,isEditing:!1})),n?P(e,0,n):a(!0)}else{if(n>=10)return;setTimeout((()=>{P(e,n+1,t)}),3e4)}}catch{if(n>=10)return;setTimeout((()=>{P(e,n+1,t)}),3e4)}}),[m]),U=(0,s.useCallback)((async()=>{var e;if(_().R.setState({...f,currentScreen:"confirmation"}),W(),!v)return;await w().callApi({eventName:"ingestSlackPublicData",environment:m,data:{spaceId:v,selection:f.selection,setupSessionId:f.sessionId}});const n=x().A.state.appsConnectionData.filter((e=>e.id!==be().e5));x().A.setState({...x().A.state,appsConnectionData:[...n,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==k?void 0:k.getEmail())||"",id:be().e5,connectorNotionId:null==k||null===(e=k.getModel())||void 0===e?void 0:e.id}]}),(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"confirm_slack_public_data_ingestion",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}})}),[k,m,W,f,v]);(0,F().n)((async()=>{if(!v)return;if(!v||g.current||"data-selection"!==f.currentScreen)return;if(f.isEditing)return g.current=!0,void P(v);const e=await w().callApi({eventName:"getConnectedAppsForUniversalQna",environment:m,data:{spaceId:v,sessionId:f.sessionId},headers:(0,_e().WS)({spaceId:v})});if("success"===e.type&&e.data.isError)_().R.setState({...f,currentScreen:"alreadyConnected"});else if("success"===e.type&&e.data.connectedApps.includes("slack-admin")){if(f.isSlackGridAiConnectorEnabled){const e=await w().callApi({eventName:"getUrlForGridSetup",environment:m,data:{spaceId:v}});return void("success"===e.type&&_().R.setState({...f,currentScreen:"confirmation",gridSetupUrl:e.data.url}))}c(!1),g.current=!0,P(v)}}),1e3,"data-selection"===f.currentScreen);const z=function(e,n){return(0,S().IS)((t=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:e?void 0:530},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:t.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:C().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:t.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:C().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:e?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:t.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:t.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:e?"hidden":"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:t.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:n?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:C().Wy.regular,color:t.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:C().Wy.regular,color:t.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:C().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:C().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:C().Wy.regular,color:t.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:t.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:t.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:t.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e,n])}(r,t),E=(0,s.useCallback)((e=>{const{selection:n}=f;return n.allSelected?!n.excludedChannels.includes(e):!!n.selectedChannels.includes(e)}),[f]),L=(0,s.useCallback)((()=>{const{selection:e}=f;return e.allSelected?!(e.excludedChannels.length>0)||"partial":e.selectedChannels.length>0&&"partial"}),[f]),K=(0,s.useCallback)((()=>{const{selection:e}=f;return!!e.allSelected||(!!e.joinFutureChannels||e.selectedChannels.length>0)}),[f]),H=(0,s.useCallback)((()=>[(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:z.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.waitingForConnectionNoteHeading1",defaultMessage:"Slack should open automatically on a new tab."},"note1-1")}),(0,N.jsx)("div",{style:z.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.waitingForConnectionNoteBody1",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,N.jsx)("a",{style:z.link,href:f.authUrl,target:"_blank",children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,N.jsxs)(M().wt,{style:{gap:4},children:[(0,N.jsx)("div",{style:z.noteHeading,children:f.isSlackGridAiConnectorEnabled?(0,N.jsx)(b().sA,{id:"universalSearch.slack.grid.workspaceOrAdminHeading",defaultMessage:"If you are a Slack organization owner or administrator:"},"gridNote2-2"):(0,N.jsx)(b().sA,{id:"universalSearch.slack.workspaceAdminHeading",defaultMessage:"If you are a Slack workspace administrator:"},"note2-2")}),(0,N.jsx)("div",{style:z.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.workspaceAdminBody",defaultMessage:"Follow Slack’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,N.jsxs)(M().wt,{style:{marginTop:16,gap:4},children:[(0,N.jsx)("div",{style:z.noteHeading,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,N.jsx)("div",{style:z.noteBody,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to the connection. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[f,z]),G=(0,s.useCallback)((()=>f.isEditing?(0,N.jsxs)(M().Ye,{style:z.loadingWrapper,children:[(0,N.jsx)(V().A,{}),(0,N.jsx)("div",{style:z.loadingChannels,children:(0,N.jsx)(b().sA,{defaultMessage:"Loading channels",id:"slackChannelSelection.isLoadingChannels"})})]}):r?(0,N.jsxs)(M().wt,{style:z.waitingForConnectionWrapper,children:[H().map(((e,n)=>(0,N.jsxs)(M().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,N.jsx)(I().A,{number:n+1}),(0,N.jsx)("div",{style:z.note,children:e})]},n))),(0,N.jsx)(M().Ye,{style:z.buttonContainer,children:(0,N.jsx)(A().A,{style:{marginTop:16,width:120,borderRadius:6},onClick:y,children:(0,N.jsxs)(M().Ye,{style:z.learnMoreButton,children:[(0,N.jsx)(b().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,j().X)({width:16,height:16})]})})})]}):(0,N.jsxs)(M().wt,{children:[(0,N.jsxs)(M().Ye,{style:z.channelItem,children:[(0,N.jsx)(ke().A,{checked:L(),checkSize:10,size:14,onClick:()=>{(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f.selection.allSelected?"all_channels_deselected":"all_channels_selected",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}),_().R.setState({...f,selection:{...f.selection,allSelected:!f.selection.allSelected,selectedChannels:[],excludedChannels:[]}})}}),(0,N.jsx)("div",{style:z.channelsText,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.slackIngestion.allPublicChannels",defaultMessage:"All public channels"})})]}),(0,N.jsx)(Ae().A,{style:z.divider,size:4}),(0,N.jsxs)(N.Fragment,{children:[t?(0,N.jsx)(N.Fragment,{}):(0,N.jsxs)(M().Ye,{style:z.loadingChannelsWrapper,children:[(0,N.jsx)(V().A,{}),(0,N.jsxs)(M().wt,{children:[(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.slackIngestion.loadedXChannels",defaultMessage:"{channelsCount} channels loaded...",values:{channelsCount:d.length}})}),(0,N.jsx)("div",{children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.slackIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 public channels."})})]})]}),(0,N.jsx)(M().wt,{style:z.selectionWrapper,children:(e?d.filter((n=>n.name.includes(e))):d).map((e=>(0,N.jsxs)(M().Ye,{gap:8,style:z.channelItemWrapper,children:[(0,N.jsx)(ke().A,{checked:E(e.id),onClick:()=>{const{selection:n}=f;(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:E(e.id)?"specific_channel_deselected":"specific_channel_selected",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}),n.allSelected?n.excludedChannels.includes(e.id)?_().R.setState({...f,selection:{...n,excludedChannels:n.excludedChannels.filter((n=>n!==e.id))}}):_().R.setState({...f,selection:{...n,excludedChannels:n.excludedChannels.concat(e.id)}}):_().R.setState({...f,selection:{...n,allSelected:!1,selectedChannels:n.selectedChannels.includes(e.id)?n.selectedChannels.filter((n=>n!==e.id)):n.selectedChannels.concat(e.id),excludedChannels:[]}})},checkSize:10,size:14},`${e.id}-checkbox`),(0,N.jsx)("div",{style:z.channelsText,children:`# ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[f,r,z,L,e,d,t,H,y,m,E]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:async()=>{const{accept:e}=await St().Gh({message:(0,N.jsx)(b().sA,{id:"universalQna.slackChannelSelection.closeConfirm",defaultMessage:"Are you sure you want to dismiss? You will lose all the progress you made."}),acceptLabel:(0,N.jsx)(b().sA,{id:"universalQna.slackChannelSelection.dismiss",defaultMessage:"Dismiss"})});e&&(_().R.reset(),W(),(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_data_selection",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}))},open:"data-selection"===f.currentScreen,render:()=>(0,N.jsxs)("div",{style:z.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"slack",title:!r||f.isEditing?(0,N.jsx)(b().sA,{id:"universalQnA.slack.channelSelectionScreenTitle",defaultMessage:"Select channels to connect"}):(0,N.jsx)(b().sA,{id:"universalQnA.slack.channelSelectionWaitingScreenTitle",defaultMessage:"Follow instructions from Slack in your browser"}),subtext:!r||f.isEditing?(0,N.jsx)(b().sA,{id:"universalQnA.slack.channelSelectionScreenSubtext",defaultMessage:"Connecting more Slack channels will give you more relevant and useful Notion AI responses"}):(0,N.jsx)(N.Fragment,{})}),r?(0,N.jsx)(N.Fragment,{}):(0,N.jsx)(Ie().A,{capture:!0,allowEsc:!0,render:()=>(0,N.jsx)(Ye().A,{textWrap:!0,placement:jn().W.Top,render:t=>(0,N.jsx)("div",{...t,children:(0,N.jsx)(M().Ye,{...t,style:z.searchBarWrapper,children:(0,N.jsx)(Sn().A,{id:"slackUniversalQnASearchBar",style:z.searchBar,placeholder:le().A.formatMessage(jt.searchForAChannel),value:e,onChange:e=>{n(e.target.value),(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_slack_channels",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}})}},"slackUniversalQnASearchBar")})}),renderTooltip:()=>(0,N.jsx)("div",{style:{width:250},children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.searchBarTooltip",defaultMessage:"All channels may not have been searched. Full search will be available once all channels are loaded."})}),disableTooltip:t})}),(0,N.jsx)(M().Ye,{style:z.selectionContainer,children:(0,N.jsx)(M().wt,{style:z.selection,children:G()})}),!r&&(0,N.jsxs)(M().wt,{style:z.footer,children:[(0,N.jsxs)(M().Ye,{style:z.futureChannelsCheckboxWrapper,children:[(0,N.jsx)(ke().A,{checked:f.selection.joinFutureChannels,checkSize:10,size:14,onClick:()=>{(0,D().u4)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f.selection.joinFutureChannels?"dont_join_future_channels":"join_future_channels",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}),_().R.setState({...f,selection:{...f.selection,joinFutureChannels:!f.selection.joinFutureChannels}})}}),(0,N.jsx)("div",{style:z.channelsText,children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.slackIngestion.allFuturePublicChannels",defaultMessage:"Add public channels created in future"})})]}),(0,N.jsx)(ce().A,{style:z.connectButton,onClick:U,disabled:!K(),children:(0,N.jsx)(b().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})]})]})})}const Ct=(0,b().YK)({instruction1:{id:"universalSearch.slack.grid.confirmModalNote1",defaultMessage:"Select your workspaces on your Slack Admin Dashboard"}}),wt=(0,b().YK)({instruction1:{id:"universalSearch.slack.confirmModalNote1",defaultMessage:"Notion AI will join your selected channels in Slack"}});const kt=function(){const e=(0,o().v3)(),n=(0,i().O$)(_().R),t=(0,s.useCallback)((()=>{const e=n.isSlackGridAiConnectorEnabled?Ct:wt;return[(0,N.jsx)(ue().L,{number:1,title:e.instruction1},"item1"),(0,N.jsx)(ue().L,{number:2,title:ge().D.defaultConnectionTime},"item2"),(0,N.jsx)(ue().L,{number:3,title:{...{...ge().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:"Slack"}}}},"item3")]}),[n.isSlackGridAiConnectorEnabled]),a=(0,s.useCallback)((()=>{ie().D6({label:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledge",defaultMessage:"Started syncing from Slack. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}),[]),r=(0,s.useCallback)((()=>{if((0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:n.isSlackGridAiConnectorEnabled?"slack_grid_select_workspaces_clicked":"completion_screen_done",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}}),n.isSlackGridAiConnectorEnabled){const t=n.gridSetupUrl;if(!t)return;e.device.isElectron?k().openExternalUrl(t):window.open(t,"_blank")}else _().R.setState({...n,isPublicSync:!0,inProgress:!0,currentScreen:"none",ingestionProgress:1}),a()}),[e,n,a]),c=(0,s.useCallback)((()=>{_().R.reset(),(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})}),[e,n.analyticsFrom,n.sessionId]);return(0,N.jsx)(ge().v,{open:"confirmation"===n.currentScreen,connectorType:"slack",notes:t(),onDismiss:c,title:n.isSlackGridAiConnectorEnabled?(0,N.jsx)(b().sA,{id:"universalSearch.slack.heresWhatToDoNext",defaultMessage:"Here’s what to do next"}):void 0,onPrimaryButtonClick:r,primaryButtonText:n.isSlackGridAiConnectorEnabled?(0,N.jsx)(b().sA,{id:"universalSearch.integration.girdConfirmIngestion",defaultMessage:"Select Slack workspaces"}):void 0})};const At=function(){const e=(0,i().O$)(_().R),[n,t]=(0,s.useState)(!1),r=(0,o().v3)(),c=(0,l().O)(),[d,u]=(0,s.useState)(!1),[g,m]=(0,s.useState)(!0),[v,f]=(0,s.useState)([]),[y,j]=(0,s.useState)(!1);(0,a().Yb)((async()=>{if(!c||"settings"!==e.currentScreen)return;m(!0);const n=await w().callApi({eventName:"getIngestedSlackChannels",environment:r,data:{spaceId:c}});"success"===n.type&&(m(!1),f(n.data.channels))}),[r,e.currentScreen,c]);const I=(0,s.useCallback)((()=>{const e=h().default.getConfigKey("ingestion","slack"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")}),[]),W=(0,s.useCallback)((()=>{_().R.reset()}),[]),F=(0,s.useCallback)((()=>{t(!1)}),[]),P=(0,s.useCallback)((async()=>{if(!c)return;u(!0);if("success"===(await w().callApi({eventName:"disconnectSlackIngestion",environment:r,data:{spaceId:c,disconnectForWorkspace:!0,disconnectReason:"admin_disconnect"}})).type){var e;_().R.setState({..._().R.state,isDisconnecting:!0});const n=x().A.state.appsConnectionData.filter((e=>e.id!==be().e5)),s=p().default.state.currentUserStore;x().A.setState({...x().A.state,appsConnectionData:[...n,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==s?void 0:s.getEmail())||"",id:be().e5,connectorNotionId:null==s||null===(e=s.getModel())||void 0===e?void 0:e.id}]}),ie().D6({label:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledgeDisconnect",defaultMessage:"Started disconnecting Slack. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),t(!1),_().R.reset()}else u(!1),ie().D6({label:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.disconnectError",defaultMessage:"Failed to disconnect Slack. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,N.jsx)(A().A,{onClick:ie().N2,children:(0,N.jsx)(b().sA,{id:"slackIngestionConfirmModal.ingestion.closeSnackbarError",defaultMessage:"Close"})})})}),[r,c]),U=(0,S().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:C().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:C().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:C().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:C().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:C().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"}})),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:F,open:n,render:()=>(0,N.jsx)("div",{style:U.confirmWrapper,children:(0,N.jsxs)("div",{style:U.confirmContainer,children:[(0,N.jsx)("div",{style:U.confirmModalTitle,children:(0,N.jsx)(b().sA,{id:"slackIngestionSettings.confirmation.title",defaultMessage:"Are your sure?"})}),(0,N.jsx)("div",{style:U.confirmModalSubTitle,children:(0,N.jsx)(b().sA,{id:"slackIngestionSettings.confirmation.subTitle",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,N.jsx)("div",{style:U.confirmModalDescription,children:(0,N.jsx)(b().sA,{id:"slackIngestionSettings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,N.jsxs)(M().wt,{style:U.confirmModalActionButtons,children:[(0,N.jsx)(ce().A,{isRed:!0,style:U.confirmDisconnectButton,disabled:d,onClick:P,children:(0,N.jsx)(b().sA,{id:"slackIngestion.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,N.jsx)(A().A,{style:U.goBackButton,onClick:F,children:(0,N.jsx)(b().sA,{id:"slackIngestion.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:W,open:"settings"===e.currentScreen,render:()=>(0,N.jsxs)("div",{style:U.wrapper,children:[(0,N.jsx)(B().b,{connectorType:"slack",title:(0,N.jsx)(b().sA,{id:"universalSearch.slack.settingsModalTitle",defaultMessage:"Slack is connected to Notion AI"}),subtext:g||e.isSlackGridAiConnectorEnabled?void 0:(0,N.jsx)(b().sA,{id:"universalSearch.slackIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI can answer questions about {channelsCount} public channels in Slack.",values:{channelsCount:v.length}})}),g?(0,N.jsx)(M().Ye,{style:U.spinner,children:(0,N.jsx)(V().A,{})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M().Ye,{style:U.channelDetailsWrapper,children:e.isSlackGridAiConnectorEnabled?(0,N.jsx)(M().wt,{style:U.channelDetailsContainer,children:(0,N.jsx)(b().sA,{id:"slackSettings.grid.note",defaultMessage:"This Notion workspace is connected to Slack Enterprise Grid. Settings can be only configured in the Slack Admin Dashboard."})}):(0,N.jsxs)(M().wt,{style:U.channelDetailsContainer,children:[(0,N.jsx)(M().wt,{style:U.channelNamesContainer,children:v.slice(0,4).map((e=>(0,N.jsx)("div",{children:`# ${e}`},e)))}),v.length-4>0?(0,N.jsx)(M().Ye,{style:U.moreChannelsContainer,children:(0,N.jsx)(b().sA,{id:"universalSearch.slackIngestion.settingsModal.moreChannels",defaultMessage:"{moreChannelsCount} more",values:{moreChannelsCount:v.length-4}})}):(0,N.jsx)(N.Fragment,{})]})}),(0,N.jsxs)(M().wt,{style:U.footer,children:[(0,N.jsx)(re().A,{size:"lg",disabled:y,style:U.editChannelsButton,onClick:async()=>{if(!c)return;if(e.isSlackGridAiConnectorEnabled){j(!0);const e=await w().callApi({eventName:"getUrlForGridSetup",environment:r,data:{spaceId:c}});return"success"===e.type&&(r.device.isElectron?k().openExternalUrl(e.data.url):window.open(e.data.url,"_blank")),void j(!1)}j(!0);const n=await w().callApi({eventName:"getIngestionOptions",environment:r,data:{spaceId:c}});"success"===n.type&&((0,D().u4)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),_().R.setState({...e,currentScreen:"data-selection",selection:{allSelected:n.data.selection.allSelected,selectedChannels:n.data.selection.selectedChannels,excludedChannels:n.data.selection.excludedChannels,joinFutureChannels:n.data.selection.joinFutureChannels},isEditing:!0})),j(!1)},children:y?(0,N.jsxs)(M().Ye,{style:{alignItems:"center",gap:4,fontWeight:C().Wy.regular},children:[(0,N.jsx)(V().A,{}),(0,N.jsx)(b().sA,{id:"slackUniversalSearch.integration.loadingPreviousSelection",defaultMessage:"Loading previous selection"})]}):e.isSlackGridAiConnectorEnabled?(0,N.jsx)(b().sA,{id:"slackUniversalSearch.integration.editTeams",defaultMessage:"Edit settings"}):(0,N.jsx)(b().sA,{id:"slackUniversalSearch.integration.editChannels",defaultMessage:"Edit channels"})}),(0,N.jsx)(ae().E,{style:U.disconnectButton,onClick:()=>{t(!0)},children:(0,N.jsx)(b().sA,{id:"slackUniversalSearch.integration.disconnectSlack",defaultMessage:"Disconnect"})}),(0,N.jsx)(A().A,{style:U.learnMoreButton,onClick:I,children:(0,N.jsxs)(M().Ye,{style:U.learnMoreText,children:[(0,N.jsx)(b().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,oe().M)(U.externalLinkIcon)]})})]})]})]})})]})};var It=()=>t(548694);function Tt(e){const{open:n}=e,t=(0,S().IS)((()=>({loadingWrapper:{padding:20,fontSize:C().J.UISmall.desktop,fontWeight:C().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]);return(0,N.jsx)(T().a,{showCloseIcon:!0,open:n,render:()=>(0,N.jsxs)(M().Ye,{style:t.loadingWrapper,children:[(0,N.jsx)(b().sA,{id:"aiConnectors.common.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,N.jsx)(V().A,{})]})})}function Mt(e){const{open:n}=e;return(0,N.jsx)(ee().m,{open:n,onDismiss:()=>{_().R.reset()},connector:"slack"})}const Dt=(0,b().YK)({slackUniversalSearchOauthPopupTitle:{id:"universalSearch.slack.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"}});function Wt(){var e;const n=(0,s.useMemo)((()=>(0,X().J)("slack")),[]),t=(0,s.useMemo)((()=>(0,X().a)("slack")),[]),c=(0,o().v3)(),d=(0,l().O)(),u=c.currentUser.id,g=(0,y().P9)({name:"ai_connectors",spaceId:d,userId:u}),v=(0,i().K8)((()=>m().zD.state.isAiEnabled()),[]),f=(0,i().O$)(p().AppStoreCurrentSpaceStore),x=(0,i().O$)(_().R),S=(0,i().K8)((()=>h().default.getConfigKey("ingestion","slack").learnMoreUrl),[]),[j]=(0,a().Yb)((async()=>{if(!d||"introduction"!==x.currentScreen)return;const e=await w().callApi({eventName:"getConnectedAppsForUniversalQna",environment:c,data:{spaceId:d},headers:(0,_e().WS)({spaceId:d})});return"success"===e.type?{isPublicConnected:e.data.connectedApps.includes("slack-admin")}:void 0}),[c,x.currentScreen,d]),b=(0,i().K8)((()=>f&&(0,It().oT)(f)),[f]),C=(0,U().J)(),A=!f||!d||(null===(e=j.value)||void 0===e?void 0:e.isPublicConnected)||!v||!b,I="resolved"===j.status&&"introduction"===x.currentScreen,T=C?"proceed_to_slack_data_selection":"contact_workspace_owners";(0,s.useEffect)((()=>{!A&&I&&(C?(0,D().u4)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,is_space_admin:C,is_ai_eligible:g??!1}}}):(0,D().u4)({environment:c,event:{eventName:"universal_qna_request_modal_open",eventProperties:{integration_type:"slack",from:x.analyticsFrom,is_ai_eligible:g??!1}}}))}),[c,A,x.sessionId,x.analyticsFrom,I,C,g]);const M=(0,s.useCallback)((()=>{_().R.reset(),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_intro_modal",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom}}})}),[c,x]);if(!d)return(0,N.jsx)(N.Fragment,{});if(!c.device.isMobile&&A){var W;const e=Boolean(null===(W=j.value)||void 0===W?void 0:W.isPublicConnected);return e?(0,N.jsx)(Mt,{open:I&&e}):(0,N.jsx)(N.Fragment,{})}return c.device.isMobile?(0,N.jsx)(Z().S,{connectorType:"slack",open:"introduction"===x.currentScreen,onClosed:()=>{_().R.reset()},learnMoreUrl:S}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Tt,{open:"introduction"===x.currentScreen&&"resolved"!==j.status}),C?(0,N.jsx)(O().A,{onConnect:async()=>{if(!g)return(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"show_purchase_ai",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom}}}),gn().Ow({openedFrom:"slack_qna_intro_modal",currentTab:"plans"}),void _().R.reset();_().R.setState({..._().R.state,currentScreen:"data-selection"});const e=await w().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:c,data:{spaceId:d,isAdminAuth:!0,isDesktopApp:c.device.isElectron,sessionId:x.sessionId}});"success"===e.type&&(_().R.setState({..._().R.state,authUrl:e.data.url}),c.device.isElectron?k().openExternalUrl(e.data.url):await Q().P(c,{width:800,height:600,url:e.data.url,titleMessage:Dt.slackUniversalSearchOauthPopupTitle}),(0,D().u4)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:T,integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom}}}))},onDismiss:M,onLearnMore:()=>{window.open(S,"_blank")},title:n,connectorType:"slack",notes:t,open:I}):(0,N.jsx)(H().BN,{connector:"slack",handleClose:()=>(0,r().resetAiConnectorStatus)("slack"),open:I,analyticsFrom:x.analyticsFrom,setupSessionId:x.sessionId,messages:K().vK})]})}const Ft=function(){const e=(0,o().v3)(),n=(0,i().O$)(_().R),t=(0,S().IS)((e=>({wrapper:{width:400,padding:24},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:C().Wy.medium,lineHeight:"22px",marginBottom:"24px",textWrap:"balance"},nextStepsWrapper:{width:"100%",justifyContent:"center",color:e.text.secondary},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",gap:12,marginTop:12},gotIt:{fontSize:14,fontWeight:C().Wy.medium,width:"100%"},pickAnother:{fontSize:14,fontWeight:C().Wy.medium,width:"100%",textAlign:"center"}})),[]),a=(0,s.useCallback)((()=>{_().R.reset()}),[]),r=(0,s.useCallback)((()=>{_().R.setState({..._().R.getInitialState(),currentScreen:"introduction"})}),[]);return(0,N.jsx)(T().a,{showCloseIcon:!0,onDismiss:()=>{_().R.reset(),(0,D().u4)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_workspace_already_connected_modal_close",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})},open:"alreadyConnected"===n.currentScreen,render:()=>(0,N.jsxs)("div",{style:t.wrapper,children:[(0,N.jsx)(M().Ye,{style:t.logoSection,children:(0,fe().Q)({width:24,height:24})}),(0,N.jsx)(M().Ye,{style:t.titleWrapper,children:(0,N.jsx)(M().Ye,{style:t.title,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.workspaceAlreadyConnected",defaultMessage:"Slack is already connected to another Notion workspace"})})}),(0,N.jsx)(M().Ye,{style:t.nextStepsWrapper,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.onlyOneWorkspaceCanBeConnected",defaultMessage:"Currently, Slack can be only connected to one workspace at a time"})}),(0,N.jsxs)(M().wt,{style:t.footer,children:[(0,N.jsx)(re().A,{size:"lg",style:t.gotIt,onClick:a,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.gotItOneWorkspaceConnected",defaultMessage:"Got it"})}),(0,N.jsx)(A().A,{style:t.pickAnother,onClick:r,children:(0,N.jsx)(b().sA,{id:"universalSearch.slack.pickDifferentWorkspace",defaultMessage:"Pick a different Slack workspace"})})]})]})})};function Bt(){const e=(0,l().O)(),n=(0,i().K8)((()=>{var e;return null===(e=p().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),t=(0,o().v3)(),S=(0,i().O$)(x().A),j=(0,y().P9)({name:"ai_connectors",spaceId:e,userId:n}),b=(0,i().K8)((()=>m().zD.canUseUniversalGithubSearchScope()),[]),C=(0,i().K8)((()=>m().zD.canUseUniversalGmailSearchScope()),[]),w=(0,i().K8)((()=>m().zD.isJiraQnaEnabled()),[]),k=(0,i().K8)((()=>m().zD.canUseUniversalMicrosoftTeamsSearchScope()),[]),A=(0,i().K8)((()=>m().zD.canUseUniversalSharepointSearchScope()),[]),I=(0,i().K8)((()=>m().zD.canUseUniversalLinearSearchScope()),[]);(0,s.useEffect)((()=>{"introduction"!==u().o.state.currentScreen&&u().o.reset()}),[]);const T=(0,d().X)("install_from_jira_marketplace");return(0,c().ts)(),(0,a().Yb)((async()=>{e&&k&&("info_screen"!==g().F.state.currentScreen&&g().F.reset(),await(0,r().getMicrosoftTeamsAIConnectorStatusAction)({environment:t,spaceId:e}))}),[e,k,t]),(0,s.useEffect)((()=>{const{connectorTriggeringUpsell:e,upsellTriggeredAt:n}=S,t=h().default.getConfigKey("ingestion","upsellMaxDurationInSeconds")||36e5;if(j&&e&&n){if(Date.now()-n>t)return void x().A.reset();switch(e){case"slack":_().R.setState({..._().R.state,currentScreen:"introduction"});break;case"google_drive":v().d.setState({...v().d.state,currentScreen:"info_screen"});break;case"jira":f().y.setState({...f().y.state,currentScreen:"info_screen"});break;case"github":u().o.setState({...u().o.state,currentScreen:"introduction"})}x().A.reset()}}),[S,j]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(H().zK,{}),(0,N.jsx)(R,{}),(0,N.jsx)($,{}),(0,N.jsx)(q,{}),(0,N.jsx)(_t,{}),(0,N.jsx)(Wt,{}),(0,N.jsx)(bt,{}),(0,N.jsx)(kt,{}),(0,N.jsx)(At,{}),(0,N.jsx)(Ft,{}),(0,N.jsx)(Ve,{}),(0,N.jsx)(He,{}),(0,N.jsx)(Re,{}),(0,N.jsx)(Oe,{}),(0,N.jsx)(Qe,{}),(0,N.jsx)(Ke,{}),(0,N.jsx)(Ne,{}),(0,N.jsx)(ve,{}),(0,N.jsx)(xe,{}),(0,N.jsx)(Fe,{}),(0,N.jsx)(ze,{}),C&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(he().p0,{}),(0,N.jsx)(he().O3,{}),(0,N.jsx)(he().HZ,{}),(0,N.jsx)(he().oU,{}),(0,N.jsx)(he().gv,{}),(0,N.jsx)(he().fZ,{}),(0,N.jsx)(he().jP,{}),(0,N.jsx)(he().kH,{}),(0,N.jsx)(he().Zk,{})]}),b&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(se,{}),(0,N.jsx)(P,{}),(0,N.jsx)(me,{}),(0,N.jsx)(de,{})]}),w&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(yn,{}),(0,N.jsx)(Ze,{}),(0,N.jsx)(ln,{}),(0,N.jsx)(un,{}),(0,N.jsx)(kn,{}),(0,N.jsx)(Xe,{}),(0,N.jsx)(Cn,{}),(0,N.jsx)(fn,{}),T&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(rn,{}),(0,N.jsx)(vn,{})]})]}),k&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Vn,{}),(0,N.jsx)(Un,{}),(0,N.jsx)(Rn,{}),(0,N.jsx)(Jn,{}),(0,N.jsx)(Zn,{}),(0,N.jsx)($n,{}),(0,N.jsx)(Pn,{}),(0,N.jsx)(nt,{}),(0,N.jsx)(On,{}),(0,N.jsx)(Hn,{})]}),A&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(gt,{}),(0,N.jsx)(ot,{}),(0,N.jsx)(at,{}),(0,N.jsx)(ht,{}),(0,N.jsx)(rt,{}),(0,N.jsx)(lt,{}),(0,N.jsx)(mt,{})]}),I&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Bn,{}),(0,N.jsx)(Mn,{}),(0,N.jsx)(Wn,{}),(0,N.jsx)(Nn,{})]})]})}},803291:(e,n,t)=>{t.d(n,{t:()=>i});var s=t(242343),o=t(163643);const i=s.memo((function(e){const{coverHeight:n,coverSizeFormat:s,emptyGalleryCoverStyle:i}=e,a=(0,t(174114).IS)((()=>({container:{height:(0,t(869596).F)(n,s),...i}})),[n,s,i]);return(0,o.jsx)("div",{style:a.container})}))},810813:(e,n,t)=>{t.d(n,{p:()=>i});var s=()=>t(84543),o=()=>t(702851);function i(e){const{environment:n,collectionStore:t,performTransaction:i}=e;return s().createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:n,canUndo:!0,perform:e=>{const s=t.getSchema(),a=i(e),r=t.getSchema();return(0,o().H)({environment:n,collectionStore:t,oldSchema:s,newSchema:r,transaction:e}),a}}).performResult}},869596:(e,n,t)=>{t.d(n,{F:()=>o});var s=()=>t(551116);function o(e,n){if(e)return e;switch(n){case"large":return s().A.card.desktop.large.height;case"small":return s().A.card.desktop.small.height;default:return s().A.card.desktop.medium.height}}},942260:(e,n,t)=>{t.r(n),t.d(n,{default:()=>o});class s extends(()=>t(129044))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const o=new s}}]);