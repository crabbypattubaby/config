"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9353],{76311:(e,t,i)=>{i.d(t,{P:()=>d,S:()=>u});i(725707),i(491955),i(403517);var n=()=>i(599932),s=()=>i(657412),r=()=>i(485966),o=()=>i(320168),a=()=>i(235843);const l=i(975392).sg((e=>{let{environment:t,flowId:n,billingData:s,origin:r}=e;i(528643).D2(t,{invite_flow_id:n,billingData:s,invite_origin:r})}),1e3);async function d(e){var t;const{environment:i,event:d,flowId:u,inviteTargetsStore:c,inviteOrigin:p,onInputChanged:v}=e;null==v||v();const g=null===(t=r().default.state.currentSpaceStore)||void 0===t?void 0:t.id,m=g?await o().A.awaitData(i,{spaceId:g}):void 0;c.setState({...c.state,tokenQuery:d.target.value}),l({environment:i,flowId:u,billingData:null==m?void 0:m.billingData,origin:p});const y=d.target.value,{extractedEmails:f,invalidParts:h,newInputValue:x}=(0,n().l2)(y),b=[...await a().Ah(i,f),...h.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!s().P4({inviteTargetsStore:c,target:e}))),S=[...c.state.inviteTargets,...b];c.setState({...c.state,inviteTargets:S,tokenQuery:x})}function u(e){const{targetToRemove:t,inviteTargetsStore:i}=e;if(0===i.state.inviteTargets.length)return;const n=i.state.inviteTargets.filter((e=>e!==t));0===n.length?i.setState({...i.state,inviteTargets:[]}):i.setState({...i.state,inviteTargets:n})}},115912:(e,t,i)=>{i.d(t,{j:()=>l});i(242343);var n=()=>i(803290),s=()=>i(653998),r=()=>i(764227),o=()=>i(305043),a=i(163643);function l(e){let{featureAvailability:t}=e;const i=(0,n().K8)((()=>(0,r().aV)(o().subscriptionDataStoreInstance.state)),[])??0,l={type:"unavailable",limit:{type:"cumulative",total:i,current:i},upsell:{type:"product",product:"plus",limit:{type:"cumulative",current:i,total:"unlimited"},trialability:"none"}};t??=l;const d=t.limit.total,u=t.upsell;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:(0,a.jsx)(s().sA,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {currentLimit, plural, one {{currentLimit} unique guest} other {{currentLimit} unique guests}}.",values:{currentLimit:d}})}),"product"===u.type?(0,a.jsx)("div",{children:(0,a.jsx)(s().sA,{id:"inviteUserButton.modalTooltip.guestLimitLine2upgrade",defaultMessage:"Upgrade to get up to {upsellLimit, plural, one {{upsellLimit} guest} other {{upsellLimit} guests}}",values:{upsellLimit:u.limit.total}})}):(0,a.jsx)(s().sA,{id:"inviteUserButton.modalTooltip.guestLimitLine2contactSales",defaultMessage:"Contact sales to get more guests"})]})}},189588:(e,t,i)=>{i.d(t,{y:()=>G});var n=i(242343),s=()=>i(237385),r=()=>i(174114),o=()=>i(16456),a=()=>i(427091),l=()=>i(409211),d=()=>i(86280),u=()=>i(653998),c=()=>i(31448),p=()=>i(137476),v=()=>i(640979),g=()=>i(836331),m=()=>i(935091),y=()=>i(743668),f=()=>i(538878),h=()=>i(169201),x=()=>i(535906),b=()=>i(88271),S=i(163643);function T(e){const{onClick:t}=e,i=(0,s().v3)().device.isMobile,n=(0,r().IS)((e=>({buttonStyle:{color:e.text.uiRedPrimary,fontSize:i?c().J.UIRegular.mobile:c().J.UIRegular.desktop}})),[i]);return(0,S.jsx)(b().A,{topBorder:!0,children:(0,S.jsx)(x().A,{focused:!1,icon:(0,h().u)({width:14,marginLeft:0}),title:(0,S.jsx)(u().sA,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:n.buttonStyle})})}var C=()=>i(486826),w=()=>i(803290),M=()=>i(782422),_=()=>i(477784),I=()=>i(296814),A=()=>i(297340);const k=(0,u().YK)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function j(e){const{onChange:t,clearCustomDatePicker:i,verificationState:a,addExtraTopPadding:l}=e,d=(0,n.useRef)(e.today),u=(0,n.useRef)(e.today.plus({days:1})),[c,p]=(0,n.useState)(!1),v=(0,w().O$)(M().XX),g="verified"!==a.type||a.isIndefinite?void 0:a.dateTimeRange.end,m=(0,s().Y0)().isMobile,y=(0,r().IS)((e=>({containerStyle:{paddingTop:l?12:4,paddingBottom:12},mobileContainerStyle:{paddingBottom:10},calendar:m?{padding:"16px 14px 16px",borderBottom:`1px solid ${e.regularDividerColor}`,background:e.popoverBackground,marginTop:27,boxShadow:`0 -1px 0 ${e.regularDividerColor}`}:{},input:m?{padding:"16px 0",marginTop:0}:{}})),[l,m]);return(0,S.jsxs)(b().A,{mobileStyle:y.mobileContainerStyle,style:y.containerStyle,disableMobilePadding:!0,children:[(0,S.jsx)(I().A,{placeholder:_().A.formatMessage(k.placeholder),focused:c,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:o().lN(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const n=e.value&&o().Dz(e.value);n?t({range:{start:d.current,end:n.start}}):i()},onFocus:()=>p(!0),onBlur:()=>p(!1),onClearButtonClick:i,hideClearButton:!0,style:y.input}),(0,S.jsx)("div",{style:y.calendar,children:(0,S.jsx)(A().A,{firstDayOfWeek:v,value:(null==g?void 0:g.toMillis())||u.current.toMillis(),selectValue:Boolean(g),onChange:e=>{t({range:{start:d.current,end:C().c9.fromMillis(e)},option:"custom"})},disabledDays:{before:new Date(u.current.toMillis())},className:"notion-date-property-menu"})})]})}i(403517);var R=()=>i(508024),P=()=>i(214263);const U=(0,i(680369).wt)("infinity",{viewBox:"0 0 40 19",svg:(0,S.jsx)("path",{d:"M0.297852 9.42383C0.297852 11.2695 0.65918 12.876 1.38184 14.2432C2.11426 15.6104 3.13477 16.6748 4.44336 17.4365C5.75195 18.1885 7.26562 18.5645 8.98438 18.5645C10.3613 18.5645 11.6504 18.2715 12.8516 17.6855C14.0625 17.0898 15.2881 16.1963 16.5283 15.0049L20 11.6504L23.4717 15.0049C24.7119 16.1963 25.9375 17.0898 27.1484 17.6855C28.3594 18.2715 29.6484 18.5645 31.0156 18.5645C32.7344 18.5645 34.248 18.1885 35.5566 17.4365C36.8652 16.6748 37.8809 15.6104 38.6035 14.2432C39.3359 12.876 39.7021 11.2695 39.7021 9.42383C39.7021 7.57812 39.3359 5.97168 38.6035 4.60449C37.8809 3.2373 36.8652 2.17773 35.5566 1.42578C34.248 0.664062 32.7344 0.283203 31.0156 0.283203C29.6484 0.283203 28.3594 0.581055 27.1484 1.17676C25.9375 1.7627 24.7119 2.65137 23.4717 3.84277L20 7.19727L16.5283 3.84277C15.2881 2.65137 14.0625 1.7627 12.8516 1.17676C11.6504 0.581055 10.3613 0.283203 8.98438 0.283203C7.26562 0.283203 5.75195 0.664062 4.44336 1.42578C3.13477 2.17773 2.11426 3.2373 1.38184 4.60449C0.65918 5.97168 0.297852 7.57812 0.297852 9.42383ZM3.5791 9.42383C3.5791 8.23242 3.80371 7.19727 4.25293 6.31836C4.71191 5.43945 5.34668 4.76074 6.15723 4.28223C6.96777 3.80371 7.91016 3.56445 8.98438 3.56445C9.88281 3.56445 10.752 3.78418 11.5918 4.22363C12.4316 4.66309 13.3154 5.3125 14.2432 6.17188L17.7002 9.42383L14.2285 12.6758C13.3105 13.5352 12.4316 14.1846 11.5918 14.624C10.752 15.0635 9.88281 15.2832 8.98438 15.2832C7.91016 15.2832 6.96777 15.0439 6.15723 14.5654C5.34668 14.0869 4.71191 13.4082 4.25293 12.5293C3.80371 11.6406 3.5791 10.6055 3.5791 9.42383ZM22.2998 9.42383L25.7568 6.17188C26.6846 5.3125 27.5684 4.66309 28.4082 4.22363C29.248 3.78418 30.1172 3.56445 31.0156 3.56445C32.0898 3.56445 33.0322 3.80371 33.8428 4.28223C34.6533 4.76074 35.2832 5.43945 35.7324 6.31836C36.1914 7.19727 36.4209 8.23242 36.4209 9.42383C36.4209 10.6055 36.1914 11.6406 35.7324 12.5293C35.2832 13.4082 34.6533 14.0869 33.8428 14.5654C33.0322 15.0439 32.0898 15.2832 31.0156 15.2832C30.1172 15.2832 29.248 15.0635 28.4082 14.624C27.5684 14.1846 26.6895 13.5352 25.7715 12.6758L22.2998 9.42383Z"})});var B=()=>i(326259),D=()=>i(943066),E=()=>i(872241),L=()=>i(404042),F=()=>i(126451);function q(e){const{verificationState:t,onChange:i,onCustomDateClick:o,showTitle:a,showUpsell:l,isEligibleForBusinessTrial:p}=e,v=(0,s().v3)(),g=(0,u().tz)(),m=v.device.isMobile,y=(0,n.useRef)(e.today),f=(0,r().IS)((e=>({title:{fontSize:m?c().J.UIRegular.mobile:c().J.UIRegular.desktop,color:e.text.primary},disabledTitle:{color:e.text.secondary},disabledCaption:{color:e.text.tertiary},clockIconStyle:{width:14,marginLeft:0,marginTop:2},upsellContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",gap:8,border:`1px solid ${e.regularDividerColor}`,borderRadius:6,margin:"8px 8px 4px",height:36},upsellText:{fontSize:14,color:e.text.primary,fontWeight:c().Wy.medium,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",flex:1},disabledButton:{color:e.text.tertiary}})),[m]),h="expired"===t.type||"none"===t.type?(0,S.jsx)(u().sA,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,S.jsx)(u().sA,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),T="verified"===t.type&&t.isIndefinite,C="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end,w=Boolean(l),M="verification_upsell_item_page_entrypoint",_=(0,n.useCallback)((()=>{(0,D().K)(v,{from:M,upsell:{type:"product",product:"business",limit:{type:"none"},trialability:"none"}})}),[v,M]);return(0,S.jsxs)("div",{children:[!p&&l&&(0,S.jsxs)(F().A,{style:f.upsellContainer,onClick:_,children:[(0,S.jsx)("div",{style:f.upsellText,children:(0,S.jsx)(u().sA,{defaultMessage:"Upgrade to unlock",id:"VerificationExpiryPicker.upsellExperience"})}),(0,S.jsx)(L().A,{subscriptionTier:"business",analyticsName:M})]}),p&&(0,S.jsx)(E().c,{openedFrom:"business_trial_verify_pages_upsell",styleOverrides:{margin:"12px 12px 0px 12px"}}),(0,S.jsxs)(b().A,{title:a&&h,children:[d().yj.map((e=>{const t=C&&d().gj({start:y.current,end:C})===e;return(0,S.jsx)(x().A,{buttonStyle:w?f.disabledButton:void 0,disabled:w,focused:!1,icon:(0,R().P)(f.clockIconStyle),inline:!1,title:(0,S.jsx)("span",{style:w?f.disabledTitle:f.title,children:(0,S.jsx)(u().sA,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:g.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:B().OH({dateTime:d().RD(e,y.current).end,intl:g,shortenDateAndRange:!0})}),captionStyle:w?f.disabledCaption:void 0,isChecked:Boolean(t),onClick:()=>{return t=e,void i({range:{start:y.current,end:y.current.plus({days:t})},option:`${t}d`});var t}},e)})),(0,S.jsx)(x().A,{buttonStyle:w?f.disabledButton:void 0,disabled:w,focused:!1,icon:U({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,S.jsx)("span",{style:w?f.disabledTitle:f.title,children:(0,S.jsx)(u().sA,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>i({option:"indefinite"}),isChecked:T},"indefinite"),(0,S.jsx)(x().A,{buttonStyle:w?f.disabledButton:void 0,disabled:w,focused:!1,icon:(0,P().k)({width:14,marginLeft:0}),title:(0,S.jsx)("span",{style:w?f.disabledTitle:f.title,children:(0,S.jsx)(u().sA,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:o},"custom")]})]})}var O=()=>i(349185),V=()=>i(887561);function G(e){const{verificationValue:t,getRecordModel:i,onChange:p,blockId:g,propertyName:h,onClose:x,showTitle:b,showRemoveVerificationButton:C,showVerificationFooter:w,showCurrentStatusHeader:M,showCustomHeader:_,customHeader:I,showUpsell:A,entrypoint:k,isEligibleForBusinessTrial:R}=e,P=(0,s().v3)(),U=(0,s().Y0)(),B=(0,u().tz)(),[D,E]=(0,n.useState)(!1),L=(0,n.useMemo)((()=>d().B2(t)),[t]),F="verified"===L.type,G=(0,n.useRef)(o().ah((0,a().P)())),W=(0,n.useRef)(o().ah((0,a().P)()).plus({days:1})),K=e=>{var t;const{range:i,option:n}=e,s=null===(t=P.currentUser)||void 0===t?void 0:t.id;if(!s)return;if(null!=i&&i.end&&i.end.toMillis()<W.current.toMillis())return;const r={table:l().oo,id:s},a=i?o().C6.toPersistedDateTimeRange(i):o().C6.toPersistedDateTime(G.current.toMillis()),d="none"===L.type?"add":"update";N(P,{action:d,verification_page_id:g,verification_expiry:i?i.end.toMillis():void 0}),p({value:[r,a],metadata:{action:d,entrypoint:k,expiration:n,expiration_date:i?i.end.toMillis():void 0}})},z=(0,r().IS)((e=>({footerStyle:{borderTop:`1px solid ${e.regularDividerColor}`},headerStyle:{padding:U.isMobile?10:7,paddingLeft:U.isMobile?20:7,background:U.isMobile?e.popoverBackground:e.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`}})),[U.isMobile]);let H={menuType:v().gu.Popup,footer:w&&"none"!==L.type&&!D&&(0,S.jsx)("div",{style:z.footerStyle,children:(0,S.jsx)(O().d,{lastVerifiedDate:F&&L.isIndefinite?L.startDateTime:L.dateTimeRange.start,getRecordModel:i,actorPointer:L.actorPointer})})};U.isMobile&&(H={...H,title:h,menuType:v().gu.Modal,right:(0,S.jsx)(y().DoneMenuText,{}),onClickRight:D?()=>E(!1):x});return(0,S.jsxs)(S.Fragment,{children:[_&&I&&!D?I:_&&D?(0,S.jsx)(f().o,{label:B.formatMessage({id:"verificationPropertyOverlay.verificationMenuHeader.pickDate",defaultMessage:"Pick a date"}),onClickBackButton:()=>E(!1),onClose:()=>x(),width:265,showBottomBorder:!1}):null,(0,S.jsx)(m().A,{...H,header:!D&&M&&"none"!==L.type&&(0,S.jsx)("div",{style:z.headerStyle,children:(0,S.jsx)(V().r,{verificationValue:t,fontSize:U.isMobile?c().J.UIRegular.mobile:void 0})}),children:D?(0,S.jsx)(j,{today:G.current,verificationState:L,onChange:e=>K(e),clearCustomDatePicker:()=>E(!1),addExtraTopPadding:!_}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(q,{today:G.current,verificationState:L,onChange:e=>K(e),onCustomDateClick:()=>E(!0),showTitle:b,showUpsell:A,isEligibleForBusinessTrial:R}),C&&(F||"expired"===L.type)&&(0,S.jsx)(T,{onClick:()=>{N(P,{action:"remove",verification_page_id:g}),p({value:void 0,metadata:{action:"remove",entrypoint:k}})}})]})})]})}function N(e,t){p().vd(e,"verification_update",t),g().default.logEvent("verification_update",t.action)}},250393:(e,t,i)=>{i.d(t,{A:()=>ae});var n=i(242343),s=()=>i(237385),r=()=>i(803290),o=()=>i(174114),a=()=>i(653998),l=()=>i(220413),d=()=>i(975392),u=()=>i(631474),c=()=>i(655830),p=()=>i(103151),v=()=>i(951514),g=()=>i(501673),m=()=>i(997310),y=()=>i(931371),f=(i(403517),()=>i(76311)),h=()=>i(797715),x=()=>i(60020),b=(i(333225),i(494367),i(516262),i(573119),i(240480),i(950443),i(619601),()=>i(752903)),S=()=>i(599932),T=()=>i(76394),C=()=>i(31448),w=()=>i(482570),M=()=>i(556338),_=()=>i(731390),I=()=>i(485966),A=i(163643);const k=function(e){const{store:t,target:n}=e,d=(0,s().Y0)(),u=(0,a().tz)(),c=(0,s().v3)(),v=function(e){const t=(0,o().IS)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...C().RC},base:e?{borderRadius:4}:{}})),[e]);return t}((0,r().K8)((()=>(0,i(268117).FI)()),[])),g=(0,r().K8)((()=>{const e=I().default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),m=(0,M().A)(t),y=(0,_().N)(t),f=(0,r().K8)((()=>{if("invalidUser"===n.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===n.type)return"group";if("existingUser"===n.type&&!Boolean(n.spaceRole)){var s;const e=null===(s=i(765787).W.getData(c,{userId:n.value.id,spaceId:t.getSpaceId()}))||void 0===s?void 0:s.membership_type;n.spaceRole=e?(0,i(242297).$N)(e):"not_in_space"}if(!(0,i(861095).yi)(n))return"member";if(m.isGuestRequestRequired)return"guestRequestRequired";if(m.isStoreInTeam&&!m.teamAllowsGuests)return"teamGuestDisabled";if(!m.isStoreInTeam&&!m.spaceAllowsGuests||m.isStoreInTeam&&!m.teamAllowsGuests&&!m.spaceAllowsGuests)return"spaceGuestDisabled";const r=(0,S().zN)(n.value.email);return r&&g.has(r)?"verifiedDomain":"guest"}),[e.tokenType,n,g,m,c,t]),h=(0,r().K8)((()=>{const e=v.base;switch(f){case"member":case"group":return{...e,...v.normal};case"invalidUser":return{...e,...v.error};case"guest":case"guestRequestRequired":return{...e,...v.guest};case"verifiedDomain":return{...e,...v.verifiedDomain};case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return{...e,...v.disabled};default:(0,T().HB)(f)}}),[f,v]);function k(){switch(n.type){case"newUser":return n.value.email.trim();case"invalidUser":return n.value.text.trim();case"existingUser":return(0,i(14931).c6)(u,n.value);case"group":return(0,i(591130).Pf)({intl:u,groupName:n.value.name});default:(0,T().HB)(n)}}function j(){const e=(0,i(284594).$)({height:16,width:16,color:"#D34F43"});switch(f){case"member":return(0,x().ju)(n)?(0,A.jsx)(w().A,{userValue:n.value,size:16}):(0,x().rP)(n)?(0,A.jsx)(w().A,{size:16,avatar:n.value}):(0,A.jsx)(w().A,{size:16});case"guest":case"guestRequestRequired":return(0,i(279968).h)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,i(21857).G)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,i(932633).o)({height:16,width:16,color:"#53A83F"});case"group":return(0,A.jsx)("div",{style:{height:16,width:16,backgroundColor:l().Ay.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,i(167089).M)({height:12,width:12,color:l().Ay.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,T().HB)(f)}}function R(t){const i=j();let n=k(),s=v.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(n="Guest",s={...s,color:"#DAA340"}):(n="Member",s={...s,color:"#53A83F"})),(0,A.jsxs)("div",{style:v.tokenContent,children:[i,(0,A.jsx)("div",{style:s,children:n})]})}function P(t){var i;t.stopPropagation(),null===(i=e.onClickRemove)||void 0===i||i.call(e)}const U="newUser"===n.type?n.value.email:"invalidUser"===n.type?n.value.text:n.value.id,B="group"!==n.type&&"invalidUser"!==n.type?n.value.email:void 0;return(0,A.jsx)(p().A,{placement:i(907721).W.Top,renderTooltip:()=>function(e){const{tokenType:t,target:i,email:n}=e;return"guest"===t?(0,A.jsx)(a().sA,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?y:"invalidUser"===i.type?(0,A.jsx)(a().sA,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:i.value.text}}):"verifiedDomain"===t&&"group"!==i.type?(0,A.jsx)(a().sA,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is an allowed email domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:i.value.email,br:(0,A.jsx)("br",{}),domain:(0,S().zN)(i.value.email)}}):"group"===i.type?i.value.name||(0,A.jsx)(a().sA,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):n}({tokenType:f,email:B,target:n}),render:t=>(0,A.jsx)("div",{style:v.tokenSpan,...t,children:(0,A.jsx)(i(809785).A,{isSingle:!1,format:d.isMobile?b().NY.Large:b().NY.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:P,disabledFeedback:!0,value:R(f),style:h,shouldWrap:!1})})},U)};const j=function(e){const{flowId:t,store:n,disabled:a,placeholder:u,right:c,focus:p,hideIconColorAndTooltips:v,showEmptyError:g,origin:m,onFocus:y,onSubmit:b,onInputChanged:S}=e,T=(0,s().v3)(),C=(0,s().Y0)(),w=(0,r().uB)(e.inviteTargetsStore,x().Ay),M=(0,r().K8)((()=>w.state.inviteTargets),[w]),_=(0,r().K8)((()=>w.state.tokenQuery),[w]),I=M.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,A.jsx)(k,{store:n,target:e,showRemoveButton:!0,tokenType:v?"member":void 0,onClickRemove:()=>f().S({inviteTargetsStore:w,targetToRemove:e})},t)})),j=(0,o().IS)((e=>({tokenInputMenuItem:{paddingTop:I.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...p&&{background:"none"},...a&&{background:e.inputBackground,color:e.text.secondary,fill:l().Ay.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[p,a,I]);return(0,A.jsx)(h().Ay,{focus:p,focusAfterAnimation:!0,onClick:()=>{C.isMobile||null==y||y()},format:h().le.Share,value:_,onChange:e=>f().P({environment:T,event:e,inviteTargetsStore:w,inviteOrigin:m,flowId:t,onInputChanged:S}),type:"email",tokens:I,disabled:a,autoComplete:"off",placeholder:u,onRemoveLastToken:()=>{w.setState({...w.state,inviteTargets:w.state.inviteTargets.slice(0,-1)})},right:c,showBorder:!0,inputStyle:j.inputInnerStyle,inputAndTokenWrapRightStyle:j.inputAndTokenWrapRight,style:j.tokenInputMenuItem,onSubmit:b,inputFullWidth:!0,message:(0,A.jsx)(i(338221).p,{invalidInvites:(0,d().oE)(M.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:g,styles:j.warningMessage})})};var R=()=>i(420401),P=()=>i(598109),U=()=>i(283826),B=(i(610931),i(725707),i(491955),i(113085),()=>i(446588)),D=()=>i(235843),E=()=>i(951540),L=()=>i(35462),F=()=>i(115912),q=()=>i(467938),O=()=>i(657412),V=()=>i(352723),G=()=>i(187406),N=()=>i(133926),W=()=>i(305043);function K(e){var t;const{store:i,sudoModeStore:o,personPropertyInviteStore:l,onInviteCompleteFn:d,inviteOrigin:c}=e,v=(0,s().v3)(),g=Y(),m=(0,r().uB)(e.inviteTargetsStore,x().Ay),y=(0,r().K8)((()=>l.state.isLoading),[l]),f=(0,n.useCallback)((e=>{l.setState({...l.state,isLoading:e,focus:U().E.NoFocus})}),[l]),[h,b]=(0,n.useState)("member"),S=(0,r().K8)((()=>{const{emailMessage:e}=l.state;return e}),[l]),T=(0,r().K8)((()=>{const{role:e}=l.state;return e}),[l]),C=(0,a().tz)(),w=(0,r().K8)((()=>l.state.flowId),[l]),k=(0,r().O$)(I().AppStoreCurrentSpaceStore),j=(0,r().K8)((()=>i.canEditMembership()),[i]),R=(0,r().K8)((()=>(0,O().U1)({inviteTargetsStore:m})),[m]),E=(0,n.useCallback)((async()=>{await P().handleEnterPress({environment:v,inviteTargetsStore:m,personPropertyInviteStore:l,allowShowEmptyError:!0})}),[v,m,l]),L=(0,n.useCallback)((()=>{const e=(0,O().U1)({inviteTargetsStore:m}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),i=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return V().FC({subscriptionData:W().subscriptionDataStoreInstance.state,newGuestIds:[...t,...i]})}),[m]),K=(0,r().K8)((()=>L()),[L]),Q=(0,r().O$)(W().subscriptionDataStoreInstance),J=(0,G().r)()??0,X=(0,r().K8)((()=>V().LS(Q,J)),[J,Q]),Z=(0,M().A)(i),ee=(0,r().K8)((()=>{if(Z.isGuestRequestRequired)return!1;const e=Z.isStoreInTeam&&!Z.teamAllowsGuests,t=!Z.isStoreInTeam&&!Z.spaceAllowsGuests||Z.isStoreInTeam&&!Z.teamAllowsGuests&&!Z.spaceAllowsGuests,i=R.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&i}),[R,Z]),te=(0,r().K8)((()=>null==k?void 0:k.getRole()),[k]),ie=(0,r().K8)((()=>!(!te||!(0,B().NB)(te))&&!(!k||k.getDisableMembershipRequests())),[te,k]),ne=(0,N().P9)({name:"members",spaceId:null==k?void 0:k.id,userId:null===(t=v.currentUser)||void 0===t?void 0:t.id,amount:1}),se=Boolean(ne&&te&&(0,B().vp)(te));(0,n.useEffect)((()=>{b(se?"member":"guest")}),[se]);const re=(0,_().N)(i),oe=S.length>1e3,ae=(0,n.useCallback)((e=>{const{response:t,shouldDoCompleteFn:i,invitedUserEmails:n,isRequestMember:s}=e;t.success?i&&(u().cI(v,{invited_user_count:n.length,is_success:t.success,can_add_member:se,invite_option:h,origin:c,invite_flow_id:w}),P().showMessageForInviteComplete({success:t.success,invitedUserEmails:n,isRequestMember:s}),f(!1),d(t)):(P().showMessageForInviteComplete({success:t.success,invitedUserEmails:n}),u().cI(v,{invited_user_count:n.length,is_success:t.success,can_add_member:se,invite_option:h,origin:c}))}),[d,w,f,v,h,se,c]),le=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,shouldDoCompleteFn:n}=e;return await P().handleGuestInvite({environment:v,inviteOrigin:c,role:T,emailMessage:S,inviteTargetsStore:m,blockStore:i,sudoModeStore:o,flowId:w,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:n||!1,invitedUserEmails:t})}})}),[v,T,S,i,o,w,m,ae,c]),de=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,disable_invite_email:i,guestInviteResponse:n,shouldDoCompleteFn:s}=e;if(!k)return null;const r=null!=n&&n.success?n.invitedUsers:void 0;await P().handleMemberInvite({environment:v,spaceStore:k,flowId:w,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:s||!1,invitedUserEmails:t})},intl:C,invitedUsers:r,inviteTargetsStore:m,inviteOrigin:c,disable_invite_email:i})}),[k,v,w,m,C,ae,c]),ue=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,guestInviteResponse:n}=e;if(!k)return null;const s=null!=n&&n.success?n.invitedUsers:void 0;s&&await P().handleMemberRequest({environment:v,spaceStore:k,originType:"person_property_invite",intl:C,invitedUsers:s,reasonMessage:void 0,originId:i.id,flowId:w,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:!0,invitedUserEmails:t,isRequestMember:!0})},inviteOrigin:c})}),[v,w,k,C,ae,i,c]),ce=(0,n.useCallback)((async()=>{const e="member"===h,t=m.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void u().N_(v,{invite_stage:"click_invite_button",invite_flow_id:w,error:"No valid input emails"});const i=L();if(f(!0),e)if(i)await de({invitedUserEmails:t,disable_invite_email:!1,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!se&&!ie,i=await le({invitedUserEmails:t,shouldDoCompleteFn:e});se?await de({invitedUserEmails:t,disable_invite_email:!0,guestInviteResponse:i,shouldDoCompleteFn:!0}):ie&&await ue({invitedUserEmails:t,guestInviteResponse:i})}else i?u().N_(v,{invite_stage:"click_invite_button",invite_flow_id:w,error:"Invite guest with guest limitation exceed"}):await le({invitedUserEmails:t,shouldDoCompleteFn:!0});f(!1),m.reset()}),[v,se,ie,h,w,L,m,le,de,ue,f]),pe=(0,n.useCallback)((async()=>{await E();const e=(0,O().U1)({inviteTargetsStore:m}).length;u().u$(v,{invited_user_count:e,invite_option:h,can_add_member:se,origin:c,inviteTargets:m.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:m.state.tokenQuery,invite_flow_id:w}),await ce()}),[v,w,E,ce,h,se,m,c]);let ve;ve=ee?re:oe?(0,A.jsx)(a().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const ge=(0,n.useMemo)((()=>[{key:"member",render:()=>(0,A.jsx)(p().A,{disableTooltip:se||ie,renderTooltip:()=>(0,A.jsx)(a().sA,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,A.jsx)($,{isSelected:"member"===h,inviteOption:"member",events:e})}),isDisabled:!se&&!ie},{key:"guest",render:()=>(0,A.jsx)(p().A,{disableTooltip:!K&&X,renderTooltip:()=>(0,A.jsx)(F().j,{}),render:e=>(0,A.jsx)($,{isSelected:"guest"===h,inviteOption:"guest",events:e})})}]),[h,K,X,ie,se]);return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,A.jsx)("div",{style:g.section,children:(0,A.jsx)(q().A,{items:ge,itemStyle:g.itemStyle,innerStyle:g.innerStyle,value:h,onChange:e=>{b(e),u().ZZ(v,{invite_option:e,invite_flow_id:w,origin:c})}})}),!K&&X||"guest"!==h?(0,A.jsx)(H,{tooltip:ve,disabled:!j||ee||oe,onClick:pe,isLoading:y}):(0,A.jsx)(z,{onClick:()=>{u().j$(v,{invited_user_count:R.length,invite_flow_id:w,origin:c}),D().D6({environment:v,upgradeButtonName:"user_permission_item"})}})]})}function z(e){const{onClick:t}=e;return(0,A.jsx)(p().A,{disableTooltip:!1,renderTooltip:()=>(0,A.jsx)(F().j,{}),render:e=>(0,A.jsx)(E().A,{size:"lg",style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,A.jsx)(a().sA,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function H(e){const{tooltip:t,disabled:i,onClick:n,isLoading:s}=e;return(0,A.jsx)(p().A,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,A.jsx)(E().A,{size:"lg",style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:i,onClick:n,...e,isLoading:s,children:(0,A.jsx)(a().sA,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function $(e){const{isSelected:t,inviteOption:i,events:n}=e,s=Y(),r=t?s.mainTextSelected:s.mainTextUnselected;let o,l;switch(i){case"guest":o=(0,A.jsx)(a().sA,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),l=(0,A.jsx)(a().sA,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":o=(0,A.jsx)(a().sA,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),l=(0,A.jsx)(a().sA,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${i}`)}return(0,A.jsx)("div",{style:s.row,...n,children:(0,A.jsxs)("div",{style:r,children:[o,(0,A.jsx)(L().A,{isSmall:!0,style:s.optionSubtitle,children:l})]})})}function Y(){return(0,o().IS)((e=>({mainTextSelected:{fontWeight:C().Wy.medium,color:e.text.primary,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.text.secondary,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var Q=()=>i(887508),J=()=>i(356813);function X(e){let{handleBackButtonClick:t}=e;const i=(0,o().IS)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,A.jsx)("div",{style:i.container,children:(0,A.jsx)(Z,{onClick:t})})}function Z(e){const{onClick:t}=e,i=(0,a().tz)(),n=(0,o().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:C().Wy.semibold},sendInviteLabel:{fontWeight:C().Wy.medium}})),[]);return(0,A.jsxs)("div",{style:n.topContainer,children:[(0,A.jsx)(J().A,{icon:Q().v,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:i.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,A.jsx)(L().A,{style:n.sendInviteLabel,children:(0,A.jsx)(a().sA,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var ee=()=>i(771619),te=()=>i(59175),ie=()=>i(814059);const ne=d().sg((e=>{let{environment:t,flowId:i,origin:n}=e;u().IT(t,{origin:n,invite_flow_id:i})}),1e3);function se(e){const{inviteTargetsStore:t,personPropertyInviteStore:i,inviteOrigin:o}=e,a=(0,s().v3)(),{focus:l,emailMessage:d}=(0,r().K8)((()=>{const{focus:e,emailMessage:t}=i.state;return{focus:e,emailMessage:t}}),[i]),u=(0,r().K8)((()=>i.state.flowId),[i]),c=(0,n.useCallback)((()=>{t.reset()}),[t]),p=(0,n.useCallback)((e=>{i.setState({...i.state,focus:l,emailMessage:e.target.value}),ne({environment:a,flowId:u,origin:o})}),[a,i,u,o,l]),v=(0,n.useCallback)((()=>{c()}),[c]),g=(0,n.useCallback)((()=>{i.setState({...i.state,focus:U().E.MessageInput,emailMessage:d})}),[i,d]);return(0,A.jsx)(re,{focus:l===U().E.MessageInput,value:d,onFocus:g,onChange:p,onCancel:v,maxLength:1e3,inviteTargetsStore:t})}function re(e){const{focus:t,value:i,maxLength:n,inviteTargetsStore:l,onFocus:d,onChange:u,onCancel:c}=e,p=(0,a().tz)(),v=i.length/n>=.8,g=(0,ee().BS)(i),m=v||g,y=(0,s().Y0)(),f=(0,o().IS)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),h=(0,r().K8)((()=>l.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[l]),x=(0,r().K8)((()=>h.length>0?p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,ie().l)(h)}):p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[p,h]);return(0,A.jsxs)("div",{style:f.container,children:[m&&(0,A.jsx)(oe,{value:i,maxLength:n,shouldShowLengthWarning:v,shouldShowLinkWarning:g}),(0,A.jsx)(te().A,{textarea:!0,focusInitial:!1,format:te().C.Transparent,placeholder:x,maxlength:n,focus:t,value:i,onFocus:d,onChange:u,inputStyle:f.input,onCancel:c,style:f.inputBox,onClick:()=>{y.isMobile||null==d||d()}})]})}function oe(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:i,value:n,maxLength:s}=e,r=(0,o().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,A.jsx)("div",{style:r.container,children:(0,A.jsxs)("div",{style:r.warning,children:[t&&(0,A.jsx)(a().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:s}}),t&&i&&" · ",i&&(0,A.jsx)(a().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function ae(e){const{store:t,handleBackButtonClick:i,onInviteCompleteFn:a,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p}=e,v=(0,r().uB)(void 0,R().A),g=(0,s().v3)(),m=(0,n.useCallback)((async()=>{await P().handleEnterPress({environment:g,inviteTargetsStore:l,personPropertyInviteStore:u,allowShowEmptyError:!1})}),[g,l,u]),y=(0,o().IS)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,A.jsx)(c().A,{debugName:"PersonPropertyInvitePopup",capture:!0,onLeft:d().D_,onRight:d().D_,onSelectAll:d().D_,onRedo:d().D_,onUndo:d().D_,onCut:d().D_,onCopy:d().D_,onPaste:d().D_,onKeypress:d().D_,onDelete:d().D_,onBackspace:d().D_,onTab:d().D_,onEnter:m,children:(0,A.jsxs)("div",{style:y.container,children:[(0,A.jsx)(X,{handleBackButtonClick:i}),(0,A.jsx)("hr",{style:y.horizontalLine}),(0,A.jsx)("div",{style:y.searchBar,children:(0,A.jsx)(le,{store:t,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p})}),(0,A.jsx)(se,{store:t,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p}),(0,A.jsx)("div",{children:(0,A.jsx)(K,{store:t,inviteTargetsStore:l,sudoModeStore:v,onInviteCompleteFn:a,personPropertyInviteStore:u,inviteOrigin:p})})]})})}function le(e){const{store:t,personPropertyInviteStore:i,inviteOrigin:n}=e,d=(0,a().tz)(),c=(0,s().v3)(),f=(0,r().uB)(e.inviteTargetsStore,x().Ay),h=(0,m().r)(),b=(0,y().HI)(),S=(0,g().A)(h),{focus:T,emailMessage:C}=(0,r().K8)((()=>{const{focus:e,emailMessage:t}=i.state;return{focus:e,emailMessage:t}}),[i]),{role:w,showEmptyError:M}=(0,r().K8)((()=>{const{role:e,showEmptyError:t}=i.state;return{role:e,showEmptyError:t}}),[i]),_=(0,r().K8)((()=>t.getType()),[t]),I=(0,r().K8)((()=>i.state.flowId),[i]),k=(0,r().K8)((()=>t.canEditMembership()),[t]),R=(0,o().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:l().Ay.uiGray}})),[]);return h&&b&&S?(0,A.jsx)(p().A,{disableTooltip:k,renderTooltip:()=>{if(!k)return(0,A.jsx)(a().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,A.jsx)("div",{style:{display:"flex"},...e,children:(0,A.jsx)(j,{inviteTargetsStore:f,store:h,disabled:!k,origin:n,flowId:I,focus:T===U().E.InviteInput,showEmptyError:M,onFocus:()=>{i.setState({...i.state,focus:U().E.InviteInput,emailMessage:C||""})},placeholder:d.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>i.setState({...i.state,showEmptyError:!1}),right:(0,A.jsx)(v().Ay,{disabled:!k,role:w,table:"block",type:"user_permission",blockType:_,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:R.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{i.setState({...i.state,role:e}),u().et(c,{invited_role:e,invite_flow_id:I,origin:n})}})})})}):null}},276647:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(242343),s=i(163643);const r=n.forwardRef((function(e,t){let{color:n="primary",...r}=e;const o=(0,i(174114).IS)((e=>{const t="blue"===n?i(220413).Ay.blue:"secondary"===n?e.text.secondary:e.text.primary;return{title:{color:t,fill:t},buttonMenuItem:{...r.style,...r.disabled?{cursor:"not-allowed"}:{}}}}),[r.disabled,n,r.style]);return(0,s.jsx)(i(535906).A,{ref:t,...r,title:(0,s.jsx)("div",{style:o.title,children:r.title}),icon:(0,s.jsx)(i(397791).I,{icon:i(178063).plusIcon,style:{fill:n}}),style:o.buttonMenuItem})}))},283826:(e,t,i)=>{i.d(t,{A:()=>r,E:()=>n});let n=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class s extends(()=>i(129044))().default{getInitialState(){return{flowId:i(214144).JW(),role:"editor",focus:n.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const r=s},338221:(e,t,i)=>{i.d(t,{p:()=>r});i(242343);var n=()=>i(653998),s=i(163643);function r(e){let{invalidInvites:t,showEmptyError:i,styles:r}=e;if(i)return(0,s.jsx)("div",{style:r,children:(0,s.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const o=t[0].value.text;return 1===t.length?(0,s.jsx)("div",{style:r,children:(0,s.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:o}})}):(0,s.jsx)("div",{style:r,children:(0,s.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:o,additionalInvalid:t.length-1}})})}},349185:(e,t,i)=>{i.d(t,{d:()=>u});i(242343);var n=()=>i(237385),s=()=>i(803290),r=()=>i(950635),o=()=>i(326259),a=()=>i(653998),l=()=>i(35462),d=i(163643);function u(e){const{getRecordModel:t,actorPointer:i,lastVerifiedDate:u}=e,c=(0,n().Y0)(),p=(0,a().tz)(),v=(0,s().K8)((()=>(0,r().lR)(p,(0,r().xC)({pointer:i,getRecordModel:t}))),[t,p,i]);return(0,d.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,d.jsx)(l().A,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,d.jsx)(a().sA,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:v}})}),(0,d.jsx)(l().A,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,children:(0,o().OH)({dateTime:u,intl:p})})]})}},396305:(e,t,i)=>{i.d(t,{Ay:()=>Y,Qg:()=>H});i(362833),i(725707),i(491955),i(403517),i(113085);var n=i(242343),s=()=>i(237385),r=()=>i(803290),o=()=>i(950635),a=()=>i(409211),l=()=>i(34662),d=()=>i(653998),u=()=>i(975392),c=()=>i(361837),p=()=>i(640979),v=()=>i(622286),g=()=>i(174114),m=()=>i(599932),y=()=>i(650199),f=()=>i(407152),h=()=>i(631474),x=()=>i(86227),b=()=>i(535906),S=()=>i(273520),T=()=>i(511952),C=()=>i(975515),w=()=>i(397791),M=()=>i(88271),_=()=>i(485966),I=()=>i(60020),A=()=>i(764227),k=()=>i(598109),j=()=>i(283826),R=()=>i(250393),P=i(163643);function U(e){const t=(0,r().uB)(void 0,I().Ay),i=(0,r().uB)(void 0,j().A),{store:o,inputValue:l,intl:u,propertySchemaLimit:p,isLoading:v,handlePersonPropertyMenuChange:U,format:B}=e,D=(0,s().v3)(),E=(0,g().IS)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:L}=(0,s().Y0)(),F=(0,r().K8)((()=>{var e;return null===(e=_().default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),q=(0,r().K8)((()=>i.state.flowId),[i]),{email:O,isEmail:V,inviteButtonTitle:G}=(0,n.useMemo)((()=>{const e=(0,m().qh)(l),t=(0,m().DT)(e),i=u.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),n=u.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?n:i}}),[l,u]),N=(0,n.useCallback)((()=>{V&&O&&k().handlePopupClickWithEmail({email:O,inviteTargetsStore:t}),h().TS(D,{origin:"person_property_invite",invite_flow_id:q})}),[V,q,O,D,t]),W=(0,n.useCallback)((()=>{h().F$(D,{origin:"person_property_invite",invite_flow_id:q})}),[q,D]),K=(0,r().K8)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:i,format:n}=e,s="enterprise"===e.subscriptionTier;if(i||s||!t||(0,c().NN)(n))return!1;return!0}({canAddPermissions:o.canEditMembership(),isMobile:L,subscriptionTier:(0,A().AI)(),format:B});return e&&h().HJ(D,{origin:"person_property_invite",invite_flow_id:q}),e}),[o,q,L,D,B]),z=(0,r().K8)((()=>{if(!(0,c().NN)(B))return(0,x().t)(p)}),[B,p]);return K?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(M().A,{title:(0,P.jsx)(d().sA,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:E.desktopTitleStyle,loading:v,desktopStyle:{paddingBottom:4},children:(0,P.jsx)(C().A,{title:(0,P.jsx)("span",{style:E.messageBodyStyle,children:(0,P.jsx)(d().sA,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:F}})}),titleStyle:E.messageTitleStyle})}),(0,P.jsx)(M().A,{title:(0,P.jsx)(d().sA,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:E.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,P.jsx)(T().A,{focused:!1,stopClickPropagation:!0,popupType:S().z7.Popup,renderOrigin:e=>(0,P.jsx)(b().A,{...e,focused:!1,icon:(0,P.jsx)(w().I,{icon:f().x,color:"primary"}),title:G,right:(0,P.jsx)(w().I,{icon:y().x,size:"sm",color:"secondary"}),textWrapperStyle:E.inviteBodyStyle}),onClick:N,onClose:W,borderRadius:8,render:e=>(0,P.jsx)(R().A,{inviteOrigin:"person_property_invite",store:o,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:i,onInviteCompleteFn:t=>{e.close();const i=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:a().oo,id:e})));U(i)}})})})]}):(0,P.jsx)(M().A,{title:z,loading:v,children:(0,P.jsx)(C().A,{title:(0,P.jsx)(d().sA,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var B=()=>i(509484),D=()=>i(836331),E=()=>i(466139),L=()=>i(342943),F=()=>i(935091),q=()=>i(858023),O=()=>i(415806),V=()=>i(325283),G=()=>i(439146),N=()=>i(818369);var W=()=>i(482570);function K(e){let{environment:t,intl:i,store:n,isSyncedCollection:s,inputValue:r,value:l,format:c,propertySchema:p,handlePersonPropertyMenuAddMentions:v,sectionMenuTitle:g,externalSyncedCollectionType:m}=e;const y=async e=>{if(s&&e.emailAddress){const s=await B().T.searchActions.load(),r=await s.searchSpaceActors({environment:t,query:e.emailAddress,membersOnly:!1,userLocale:i.locale,shouldUseEdgeCacheRollout:D().default.checkGate({gateName:"edge_cache_person_property"}),limit:1});if(1===r.users.length)v([{table:a().oo,id:r.users[0].id}]);else{const i=await async function(e){let{environment:t,externalUser:i,blockPointer:n,externalSyncedCollectionType:s}=e;const r=await N().callApi({eventName:"getOrCreateNotionUserFromExternalUser",environment:t,data:{externalUser:(0,G().Vz)(i,s),blockPointer:n}});if(!(0,V().kX)(r))return"success"===r.type?r.data.notionUser:void 0}({environment:t,externalUser:e,blockPointer:n.pointer,externalSyncedCollectionType:m});i&&v([{table:a().oo,id:i.id}])}}},f={request:{query:r,actors:u().pb(l,o().Pu)},performRequest:async e=>{let{query:i,actors:s}=e;const r=await async function(e){let{environment:t,blockPointer:i,query:n}=e;const s=await N().callApi({eventName:"getExternalUsersForSyncedCollection",environment:t,data:{blockPointer:i,query:n}});return(0,V().kX)(s)?[]:"success"===s.type?s.data.externalUsers:[]}({environment:t,blockPointer:n.pointer,query:i});return{externalUsers:r,type:"externalUsers"}},render:(e,t,i)=>{if(e)return(0,P.jsx)(M().A,{title:g,loading:!i,children:(0,P.jsx)(C().A,{title:(0,P.jsx)(d().sA,{...H.searchErrorMessage})})});if(t&&"externalUsers"!==t.type)return(0,P.jsx)(M().A,{title:g,loading:!i,children:(0,P.jsx)(C().A,{title:(0,P.jsx)(d().sA,{...H.searchErrorMessage})})});const n=u().oE((t&&t.externalUsers||[]).map((e=>{const t=(0,P.jsx)(W().A,{avatar:{email:e.emailAddress,avatarUrl:"",name:e.displayName}});return{key:e.accountId,render:i=>(0,P.jsx)(b().A,{...i,title:e.displayName,caption:e.emailAddress,icon:t}),action:async()=>{await y(e)}}}))),s=u().oE([n.length>0?{key:"external user section",render:e=>(0,P.jsx)(M().A,{...e,title:(0,P.jsx)(d().sA,{defaultMessage:"Select user from Jira",id:"database.personPropertyValue.externalUsers.searchPlaceholder"}),loading:!i}),items:n}:void 0]);return(0,P.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:r.length>0?0:void 0,sections:s})}};return{...f}}var z=()=>i(797715);const H=(0,d().YK)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"},searchErrorMessage:{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"},searchOfflineErrorMessage:{defaultMessage:"Unavailable offline.",id:"database.personPropertyMenu.searchOfflineErrorMessage"}});function $(e){let{tokens:t,disabled:i,onChange:n,value:r,inputValue:o,setInputValue:a}=e;const l=(0,s().Y0)(),u=(0,d().tz)(),c=(0,p().Tf)(),g=(0,v().X)("db_ux_chrome")?{padding:L().QJ.table.token,gap:4}:{padding:"4px 6px",gap:4};return(0,P.jsx)(M().A,{disableDesktopPadding:!0,children:(0,P.jsx)(z().Ay,{focus:!l.isMobile||void 0,focusAfterAnimation:!0,format:z().le.Person,tokens:t,tokenWrapStyle:g,placeholder:u.formatMessage(H.searchForPerson),hideInput:i,onRemoveLastToken:()=>{n({type:"personPropertyMenuUpdateRemovePerson",removedValue:r[r.length-1]})},value:o,onChange:e=>a(e.target.value),dontShowBorderBottom:l.isAndroid||c})})}const Y=function(e){const t=(0,v().X)("db_ux_mobile"),g=(0,s().v3)(),m=(0,s().Y0)(),y=(0,d().tz)(),{disabled:f,value:h,format:S,valueIsUnpersistedDefaultValue:T,onChange:w,propertySchema:_,parentStore:I,onDismiss:A,isTemplatePage:k,insertChar:j,formQuestionStore:R,collectionStore:L}=e,[V,G]=(0,n.useState)((()=>j||"")),N=(0,r().K8)((()=>{if(!(0,c().NN)(S))return(0,x().t)(_.limit)}),[S,_.limit]),W=(0,r().K8)((()=>{const e=_.limit;return(0,c().NN)(S)&&R?(0,i(543396).hm)(_,R.getModel()):e}),[R,S,_]),z=(0,r().K8)((()=>void 0!==W&&h.length>=W),[W,h]),Y=(0,n.useCallback)((e=>{!function(e){let{newMentions:t,tokenLimit:i,value:n,valueIsUnpersistedDefaultValue:s,onChange:r}=e;1===i&&t.length>0?r({type:"personPropertyMenuUpdateReplacePerson",newValue:t[0]}):void 0===i?r(s?{type:"personPropertyMenuUpdateAddPerson",newValues:[...n,...t]}:{type:"personPropertyMenuUpdateAddPerson",newValues:t}):t.length+n.length<=i&&r({type:"personPropertyMenuUpdateAddPerson",newValues:t})}({newMentions:e,tokenLimit:W,value:h,valueIsUnpersistedDefaultValue:T,onChange:w}),G("")}),[w,W,h,T]),{tokens:Q,selectedTemplateAnnotationVariables:J}=(0,r().K8)((()=>{const e=[];return{tokens:h.map((t=>{if((0,l().MMZ)(t))return e.push(t),(0,P.jsx)(E().W,{templateVariableType:t,showRemoveButton:!f,onRemove:()=>{w({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},style:{margin:"0px 6px 6px 0px"}},t);if((0,o().Pu)(t)){const e=(0,o().xC)({pointer:t,getRecordValue:I.getRecordValue});return(0,P.jsx)(O().Ay,{actor:e,format:m.isMobile?O().Ay.Format.Large:O().Ay.Format.Medium,showRemoveButton:!f,onClickRemove:()=>{w({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},shouldShrink:!0,isSingle:!0},t.id)}(0,i(76394).HB)(t)})),selectedTemplateAnnotationVariables:e}}),[m.isMobile,f,w,I.getRecordValue,h]),X=l().Wov.filter((e=>!J.includes(e))),Z=(0,r().K8)((()=>{const e=Boolean(L&&L.isExternallyImportedAndSyncedCollection()&&(null==L?void 0:L.getFormat().external_collection_type)),t=null==L?void 0:L.getFormat().external_collection_type;if((0,i(370639).CS)()&&e&&t)return K({environment:g,intl:y,store:I,isSyncedCollection:e,inputValue:V,value:h,format:S,propertySchema:_,handlePersonPropertyMenuAddMentions:Y,sectionMenuTitle:N,externalSyncedCollectionType:t});const n={request:{query:V,actors:u().pb(h,o().Pu)},performRequest:async e=>{let{query:t,actors:i}=e;const n=await B().T.searchActions.load();return{users:(await n.searchSpaceUsers({environment:g,query:t,membersOnly:!1,limit:20+i.length,placeSelfFirst:""===t||n.isPersonalPronoun(t,y.locale),shouldUseEdgeCacheRollout:D().default.checkGate({gateName:"edge_cache_person_property"})})).filter((e=>!i.some((t=>t.id===e.id)))).slice(0,20),type:"notionUsers"}},render:(e,t,n)=>{if(e){const e=!i(802955).A.state.online;return(0,P.jsx)(M().A,{title:N,loading:!n,children:(0,P.jsx)(C().A,{title:e?(0,P.jsx)(d().sA,{...H.searchOfflineErrorMessage}):(0,P.jsx)(d().sA,{...H.searchErrorMessage})})})}if(t&&"notionUsers"!==t.type)return(0,P.jsx)(M().A,{title:N,loading:!n,children:(0,P.jsx)(C().A,{title:(0,P.jsx)(d().sA,{...H.searchErrorMessage})})});if(t&&0===t.users.length)return(0,P.jsx)(U,{store:I,inputValue:V,intl:y,propertySchemaLimit:_.limit,isLoading:!n,format:S,handlePersonPropertyMenuChange:e=>{Y(e)}});const s=!(z&&W&&W>1),r=u().oE((t&&t.users||[]).map((e=>{const t={key:e.id,render:t=>(0,P.jsx)(i(103151).A,{disableTooltip:s,renderTooltip:()=>(0,P.jsx)(d().sA,{defaultMessage:"To select more, remove selection above",id:"database.personPropertyMenu.limitReached"}),render:n=>(0,P.jsx)(i(698995).A,{...t,actor:(0,o().A7)(e),disabled:!s,disabledFeedback:!s,...n})}),action:()=>{Y([{table:a().oo,id:e.id}])}};return t}))),l=u().oE([r.length>0?{key:"person section",render:e=>(0,P.jsx)(M().A,{...e,title:N,loading:!n}),items:r}:void 0]);return(0,P.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:V.length>0?0:void 0,sections:l})}};return n}),[L,V,h,g,y,I,S,_,Y,N,z,W]),ee=(0,P.jsx)($,{tokens:Q,disabled:f,onChange:w,value:h,inputValue:V,setInputValue:G});let te;return te=m.isMobile?{menuType:p().gu.Modal,title:_.name,...!t&&{right:(0,P.jsx)(i(743668).DoneMenuText,{}),onClickRight:A},header:ee}:{menuType:p().gu.Popup,header:ee,tokenInputHeader:!0,maxHeight:333},f?(0,P.jsx)(F().A,{...te}):(0,P.jsxs)(F().A,{...te,children:[k&&(0,P.jsx)(M().A,{title:(0,P.jsx)(d().sA,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:X.length>0?(0,P.jsx)(n.Fragment,{children:X.map((e=>(0,P.jsx)(b().A,{focused:!1,title:(0,P.jsx)(E().W,{templateVariableType:e}),caption:(0,i(247200).EC)(e,y),inline:!0,onClick:()=>{Y([e])}},`relative-person-shortcut-${e}`)))}):(0,P.jsx)(C().A,{title:(0,P.jsx)(d().sA,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,P.jsx)(i(921637).A,{...Z})]})}},467938:(e,t,i)=>{i.d(t,{A:()=>d});i(403517),i(242343);var n=()=>i(174114),s=()=>i(907721),r=()=>i(126451),o=()=>i(103151),a=i(163643);function l(e){const{isFirst:t,isLast:i,isSelected:l,item:d,itemStyle:u,selectedItemStyle:c,innerStyle:p,children:v,colors:g,onClick:m}=e,{isDisabled:y,tooltip:f}=d,h=(0,n().IS)((e=>{const n=(null==g?void 0:g.selectedOutline)??e.blueColor,s=(null==g?void 0:g.unselectedOutline)??e.selectorBorderUnselected;return{SegmentedItem:{alignItems:"center",background:l?null==g?void 0:g.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:i?3:0,borderColor:l?n:s,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:i?3:0,borderWidth:1,cursor:y?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:l?10:0,...u,...l?c:void 0},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:i?2:0,borderColor:l?n:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:i?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...p}}}),[null==g?void 0:g.selectedBackground,null==g?void 0:g.selectedOutline,null==g?void 0:g.unselectedOutline,t,i,l,y,u,c,p]),x=()=>{m&&m(d.key)};return(0,a.jsx)(o().A,{render:e=>(0,a.jsx)(r().A,{ariaLabel:d.ariaLabel,"aria-pressed":l,onClick:x,style:h.SegmentedItem,disabled:y,...e,children:(0,a.jsx)("div",{style:h.Inner,children:v})}),renderTooltip:()=>(0,a.jsx)("div",{children:f}),disableTooltip:l||void 0===f,placement:s().W.Bottom})}function d(e){const{items:t=[],itemStyle:i,selectedItemStyle:s,innerStyle:r,outerStyle:o,value:d,onChange:u,colors:c}=e,p=(0,n().IS)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%",...o}})),[o]);return 0===t.length?null:(0,a.jsx)("div",{style:p.SegmentedButton,children:t.map(((e,n)=>(0,a.jsx)(l,{isFirst:0===n,isLast:n===t.length-1,isSelected:e.key===d,item:e,itemStyle:i,selectedItemStyle:s,innerStyle:r,colors:c,onClick:u,children:e.render()},e.key)))})}},538878:(e,t,i)=>{i.d(t,{o:()=>p});i(242343);var n=()=>i(237385),s=()=>i(174114),r=()=>i(887508),o=()=>i(653998),a=()=>i(31448),l=()=>i(622163),d=()=>i(238107),u=()=>i(356813),c=i(163643);function p(e){const{label:t,onClickBackButton:i,onClose:p,width:v,showBottomBorder:g}=e,m=(0,n().v3)(),y=(0,o().tz)(),f=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center",gap:4,height:40,width:v??320,paddingLeft:8,paddingRight:8,borderBottom:g?`1px solid ${e.regularDividerColor}`:void 0},backButton:{width:24,height:24},closeButton:{position:"absolute",right:0,marginRight:8,borderRadius:"100%"},menuTitle:{flexGrow:1,fontWeight:a().Wy.semibold,fontSize:(0,l().ny)(m,"UIRegular")}})),[m,g,v]);return(0,c.jsxs)("div",{style:f.container,children:[(0,c.jsx)(u().A,{icon:r().v,ariaLabel:y.formatMessage({id:"verificationMenuHeader.backButton.ariaLabel",defaultMessage:"Back"}),onClick:()=>i(),style:f.backButton}),(0,c.jsx)("div",{style:f.menuTitle,children:t}),(0,c.jsx)(d().A,{onClose:()=>p(),style:f.closeButton})]})}},556338:(e,t,i)=>{i.d(t,{A:()=>a});var n=()=>i(378219),s=()=>i(360482),r=()=>i(548694);function o(e,t){return(0,r().hN)(e)?{isGuestRequestRequired:!0}:t?{isStoreInTeam:!0,teamAllowsGuests:!0,spaceAllowsGuests:!0,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1}}const a=function(e){return(0,i(803290).K8)((()=>{if((0,s().nw)(e))return{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};if(!(0,s()._p)(e))return(0,r().r7)(e)?o(e,void 0):{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};const t=(0,n().Uo)(e),a=(0,n().pp)(e),l=a||i(485966).default.state.currentSpaceStore;if((0,r().r7)(l))return o(l,t);const d=!(null!=a&&a.getDisableGuests());return t?{isStoreInTeam:!0,teamAllowsGuests:!t.getDisableGuests(),spaceAllowsGuests:d,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:d,isGuestRequestRequired:!1}}),[e])}},598109:(e,t,i)=>{i.r(t),i.d(t,{handleEnterPress:()=>_,handleGuestInvite:()=>C,handleMemberInvite:()=>T,handleMemberRequest:()=>w,handlePopupClickWithEmail:()=>I,inviteToSpaceAsMembers:()=>M,showMessageForInviteComplete:()=>A});i(362833),i(725707),i(491955),i(324989),i(403517),i(113085),i(242343);var n=()=>i(599932),s=()=>i(502140),r=()=>i(214144),o=()=>i(446588),a=()=>i(653998),l=()=>i(704082),d=()=>i(450475),u=()=>i(631474),c=()=>i(818369),p=()=>i(919536),v=()=>i(235843),g=()=>i(575015),m=()=>i(814059),y=()=>i(657412),f=()=>i(352723),h=()=>i(111826),x=()=>i(764227),b=()=>i(127776),S=i(163643);async function T(e){const{environment:t,onInviteComplete:i,flowId:n,intl:r,spaceStore:o,invitedUsers:a,inviteTargetsStore:c,inviteOrigin:p,disable_invite_email:v}=e;let g={success:!1};try{g=await M({environment:t,spaceStore:o,invitedUsers:a,from:p,flowId:n,intl:r,inviteTargetsStore:c,disable_invite_email:v}),g.success?u().ke(t,{invited_user_count:Object.keys(g.invitedUsers).length,invite_flow_id:n,origin:p}):(u().N_(t,{invite_stage:"invite_member",invite_flow_id:n,error:g.error}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberInvite"}))}catch(m){const e=(0,l().A)(m);u().N_(t,{invite_stage:"invite_member",invite_flow_id:n,error:e}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberInvite",error:(0,d().convertErrorToLog)(m)})}finally{null==i||i(g)}}async function C(e){const{environment:t,blockStore:i,inviteTargetsStore:a,sudoModeStore:c,onInviteComplete:v,inviteOrigin:g,role:m,emailMessage:h,flowId:x}=e;let b={success:!1};try{if(b=await async function(e){const{environment:t,blockStore:i,sudoModeStore:s,inviteTargetsStore:a,role:l,inviteOrigin:d,emailMessage:u,onInviteStart:c}=e,v=e.flowId||r().JW();if(!(0,o().PW)(l))return{success:!1};const{tokenQuery:g,inviteTargets:m}=a.state;if((0,n().DT)(g.trim())&&0===m.length){const e={type:"newUser",value:{email:g.trim()},source:"email"};y().P4({target:e,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,e],tokenQuery:""})}const h=await f().hb(i,y().U1({inviteTargetsStore:a}));null==c||c();const x=await p().eP({environment:t,store:i,sudoModeStore:s,inviteTargets:h,inviteRole:l,isOnboarding:!1,invite:{inviteFlowId:v,inviteMessage:u,inviteOrigin:d}});return x}({environment:t,blockStore:i,sudoModeStore:c,inviteTargetsStore:a,role:m,emailMessage:h,inviteOrigin:g,flowId:x}),!b.success)return}catch(S){const e=(0,l().A)(S);u().N_(t,{invite_stage:"invite_guest",invite_flow_id:x,error:e}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleGuestInvite",error:(0,d().convertErrorToLog)(S)})}finally{b.success&&u().oU(t,{invited_user_count:Object.keys(b.invitedUsers).length,origin:g,invite_flow_id:x}),null==v||v(b)}return b}async function w(e){const{environment:t,spaceStore:i,originId:n,originType:r,reasonMessage:o,intl:a,flowId:d,onInviteComplete:p,invitedUsers:v,inviteOrigin:y}=e,f=[];let h={success:!1};try{const e=Object.entries(v).map((e=>{let[s,a]=e;return c().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:a,spaceId:i.id,message:o,attributes:{origin_id:n,origin_type:r,origin_table:"block",add_permissions_on_approval:!1}}}).catch((()=>f.push([s,a])))}));await Promise.all(e),h={success:!0,invitedUsers:v,requestedUsers:{}}}catch(x){const e=(0,l().A)(x);return u().N_(t,{invite_stage:"request_member",invite_flow_id:d,error:e}),function(e,t){const i=Object.keys(t);if(0===i.length)return;g().D6({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members"},{users:(0,m().l)(i)})})}(a,v),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberRequest",data:{miscDataToConvertToString:{inviteTargetEmailsWithErrors:f}}}),h}finally{h.success&&u().d6(t,{invited_user_count:Object.keys(h.invitedUsers).length,origin:y,invite_flow_id:d}),null==p||p(h)}return h}async function M(e){const{environment:t,spaceStore:i,from:n,invitedUsers:r,intl:o,flowId:a,onInviteStart:l,inviteTargetsStore:d,disable_invite_email:u}=e,c=function(e){const t=[];if(!e)return t;for(const[i,n]of Object.entries(e))t.push({type:"existingUser",value:{id:n,email:i,version:1}});return t}(r),v=function(e){return e.state.inviteTargets.filter((e=>"newUser"===e.type))}(d),y=[...c];for(const s of v){c.some((e=>e.value.email===s.value.email))||y.push(s)}const f=(0,x().AI)(),S=f&&(0,h().fk)(f)?"editor":e.inviteRole??"read_and_write";let T={success:!1};if(!i.isTeamsEnabled()){if(!(await b().oH({environment:t,flowId:a,trackCreateTeamComplete:!1})))return T}try{null==l||l(),T=await p().eP({environment:t,store:i,inviteTargets:y,inviteRole:S,isOnboarding:!1,invite:{inviteOrigin:n,inviteFlowId:a,disable_invite_email:u}})}catch(C){return function(e,t){0!==t.length&&g().D6({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"{userCount, plural, one {Failed to invite {users} as member} other {Failed to invite {users} as members}}"},{users:(0,m().l)(t.flatMap((e=>e.value.email||[]))),userCount:t.length})})}(o,y),s().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{usersToInviteAsMembers:y}}}),T}return T}async function _(e){const{environment:t,inviteTargetsStore:i,allowShowEmptyError:s,personPropertyInviteStore:r}=e,o=i.state.tokenQuery;if(""===o)return void(0===i.state.inviteTargets.length&&s&&r.setState({...r.state,showEmptyError:!0}));const a=(0,n().C3)(o),l=await v().Ah(t,a);let d=[];0===l.length&&(d=[{type:"invalidUser",value:{text:o}}]);const u=l.filter((e=>!y().P4({inviteTargetsStore:i,target:e}))),c=[...i.state.inviteTargets,...u,...d];i.setState({...i.state,inviteTargets:c,tokenQuery:""})}function I(e){const{email:t,inviteTargetsStore:i}=e,n={type:"newUser",value:{email:t},source:"email"},s=[...i.state.inviteTargets];y().P4({inviteTargetsStore:i,target:n})||s.push(n),i.setState({...i.state,inviteTargets:s})}function A(e){const{success:t,invitedUserEmails:i,isRequestMember:n}=e;t?0!==i.length&&(n?g().D6({label:(0,S.jsx)(a().sA,{id:"shareMenu.inviteSuccess.snackbarMessage.sendMemberRequest",defaultMessage:"Successfully sent request to admin to invite {users}",values:{users:(0,m().l)(i)}})}):g().D6({label:(0,S.jsx)(a().sA,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:(0,m().l)(i)}})})):g().D6({label:(0,S.jsx)(a().sA,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:(0,m().l)(i)}})})}},657412:(e,t,i)=>{i.d(t,{P4:()=>s,U1:()=>o,lW:()=>a});i(362833),i(725707),i(491955),i(113085);var n=()=>i(599932);function s(e){const{target:t,inviteTargetsStore:i}=e;return i.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:"group"===t.type?e.type===t.type&&e.value.group_id===t.value.group_id:e.type===t.type&&e.value.id===t.value.id))}function r(e){return"invalidUser"!==e.type}function o(e){const{inviteTargetsStore:t,includeInputFieldText:i}=e,o=[...t.state.inviteTargets];if(i){const e=function(e){const t=e.state.tokenQuery.trim();if(!(0,n().DT)(t))return;const i={type:"newUser",value:{email:t},source:"email"};return s({target:i,inviteTargetsStore:e})?void 0:i}(t);e&&o.push(e)}return o.filter(r)}function a(e){const{inviteTargetsStore:t,inviteTarget:i}=e;if(s({target:i,inviteTargetsStore:t})){const e=t.state.inviteTargets.filter((e=>"group"===i.type&&"group"===e.type?i.value.group_id!==e.value.group_id:"existingUser"===i.type&&"existingUser"===e.type?i.value.id!==e.value.id:"newUser"!==i.type||"newUser"!==e.type||i.value.email!==e.value.email));return t.setState({...t.state,inviteTargets:e}),!1}return t.setState({inviteTargets:[...t.state.inviteTargets,i],tokenQuery:""}),!0}},731390:(e,t,i)=>{i.d(t,{N:()=>o});i(242343);var n=()=>i(653998),s=()=>i(556338),r=i(163643);function o(e){const t=(0,s().A)(e);return t.isGuestRequestRequired?(0,r.jsx)(n().sA,{id:"contextualInvite.buttonAndTokenTooltip.guestRequestRequired",defaultMessage:"This guest must be approved by a workspace owner first"}):t.isStoreInTeam?t.teamAllowsGuests?void 0:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(n().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine1",defaultMessage:"This teamspace doesn't allow guests."})}),(0,r.jsx)("div",{children:(0,r.jsx)(n().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]}):t.spaceAllowsGuests?void 0:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(n().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine1",defaultMessage:"This workspace doesn't allow guests."})}),(0,r.jsx)("div",{children:(0,r.jsx)(n().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]})}},745454:(e,t,i)=>{i.d(t,{q:()=>r,y:()=>o});var n=()=>i(76394),s=()=>i(137476);function r(e){const{environment:t,blockStore:i,update:r}=e,o=function(e){switch(e){case"add":return"page_verification_enabled";case"update":return"page_verification_edited";case"remove":return"page_verification_disabled";default:(0,n().HB)(e)}}(r.metadata.action),a=i.id,l=i.getAssociatedCollectionId(),d=i.getSpaceId(),u=r.metadata.entrypoint;let c=l?"db":"non_db";if(l){const e=i.getAssociatedCollectionStore();null!=e&&e.isPageTreeCollection()&&(c="wiki")}"page_verification_enabled"===o&&(0,s().u4)({environment:t,event:{eventName:o,eventProperties:{entrypoint:u,page_type:c,page_id:a,collection_id:l,space_id:d,expiration:r.metadata.expiration??void 0,expiration_date:r.metadata.expiration_date??void 0}}}),"page_verification_edited"===o&&(0,s().u4)({environment:t,event:{eventName:o,eventProperties:{entrypoint:u,page_type:c,page_id:a,collection_id:l,space_id:d,expiration:r.metadata.expiration??void 0,expiration_date:r.metadata.expiration_date??void 0}}}),"page_verification_disabled"===o&&(0,s().u4)({environment:t,event:{eventName:o,eventProperties:{entrypoint:u,page_type:c,page_id:a,collection_id:l,space_id:d}}})}function o(e){const{environment:t,blockStore:i,entrypoint:n,action:r}=e,o=i.id,a=i.getAssociatedCollectionId(),l=i.getSpaceId();let d=a?"db":"non_db";if(a){const e=i.getAssociatedCollectionStore();null!=e&&e.isPageTreeCollection()&&(d="wiki")}(0,s().u4)({environment:t,event:{eventName:"page_verification_owner_edited",eventProperties:{entrypoint:n,page_type:d,action:r,page_id:o,collection_id:a,space_id:l}}})}},765787:(e,t,i)=>{i.d(t,{W:()=>s});var n=()=>i(349947);const s=new(i(967203).U)((e=>{let{userId:t,spaceId:i}=e;return`${t}-${i}`}),(async function(e,t){var s;let{userId:r,spaceId:o}=t;const[a,l]=await Promise.all([n().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:i(409211).oo,id:r},userId:r}),n().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,i(242297).i1)({userId:r,spaceId:o}),userId:r})]),d=null===(s=i(485966).default.state.currentSpaceViewStore)||void 0===s||null===(s=s.getModel())||void 0===s?void 0:s.first_joined_space_time,u=null==a?void 0:a.value,c=null==l?void 0:l.value;if(u&&c&&d)return{id:u.id,space_id:c.id,membership_type:c.membership_type,email:u.email,name:u.name,profile_photo:u.profile_photo,onboarding_completed:u.onboarding_completed,first_joined_space_time:d}}));i(996094).exposeDebugValue("UserOnSpaceStore",s)},887561:(e,t,i)=>{i.d(t,{r:()=>g});var n=i(242343),s=()=>i(174114),r=()=>i(822619),o=()=>i(96144),a=()=>i(326259),l=()=>i(86280),d=()=>i(653998),u=()=>i(76394),c=()=>i(31448),p=()=>i(342943),v=i(163643);function g(e){const{verificationValue:t,fontSize:i=p().Mi}=e,g=(0,d().tz)(),m=(0,n.useMemo)((()=>l().B2(t)),[t]),y=m.type,f=(0,s().IS)((e=>({icon:{width:"expired"===y?8:14,height:"expired"===y?9:14,fill:"verified"===y?e.blueColor:e.mediumIconColor},caption:{fontVariantNumeric:"normal",fontWeight:c().Wy.regular,color:e.text.primary,textTransform:"none",letterSpacing:0,marginLeft:6,marginRight:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:i,lineHeight:p().$g},expiredIconContainer:{width:14,height:14,borderRadius:6,border:"1px dashed",borderColor:e.mediumIconColor,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0}})),[y,i]);if("none"===y)return null;let h=null,x=null;const b=f.caption;switch(y){case"verified":h=(0,r().E)({...f.icon}),x=m.isIndefinite?(0,v.jsx)(d().sA,{defaultMessage:"Verified",id:"VerificationPropertyButton.verifiedIndefinitely"}):(0,v.jsx)(d().sA,{defaultMessage:"Until {date}",id:"VerificationPropertyButton.verifiedUntil",values:{date:a().OH({dateTime:m.dateTimeRange.end,intl:g})}});break;case"expired":h=(0,v.jsx)("div",{style:f.expiredIconContainer,children:(0,o().R)({...f.icon})}),x=(0,v.jsx)(d().sA,{defaultMessage:"Expired {timeFromMoment}",id:"VerificationPropertyButton.expired.text",values:{timeFromMoment:l().F7(m.dateTimeRange.end.setLocale(g.locale))}});break;default:(0,u().HB)(y)}return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[h,(0,v.jsx)("div",{style:b,children:x})]})}}}]);