"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22],{6096:(e,t,o)=>{o.r(t),o.d(t,{CollectionChartView:()=>Be});var r=o(242343),i=()=>o(237385),a=()=>o(803290),n=()=>o(577320),l=()=>o(427091),s=()=>o(127314),u=()=>o(3364),c=()=>o(615917),d=()=>o(390263),g=()=>o(948157);var p=()=>o(480183),h=(o(362833),()=>o(571785)),m=()=>o(15552),y=()=>o(128057),v=()=>o(390757);var f=()=>o(475923),x=()=>o(191759),C=()=>o(485966),S=()=>o(802955),b=()=>o(367859),w=()=>o(471256),k=()=>o(774020),R=()=>o(549174),M=()=>o(877905),_=()=>o(76394),T=()=>o(367923),V=()=>o(449748),A=()=>o(61014),P=()=>o(572589),D=()=>o(716605),B=()=>o(653998),L=()=>o(375067),F=()=>o(137476),j=()=>o(876695),K=()=>o(174114),O=()=>o(284594),z=()=>o(907721),E=()=>o(356813),G=()=>o(103151),I=o(163643);function N(e){let{message:t,tooltipMessage:o,tooltipAriaLabel:r}=e;const i=(0,K().IS)((e=>({container:{padding:"8px 4px 8px 14px",borderRadius:20,backgroundColor:e.tint.regular,width:"max-content",margin:"0 auto",marginBottom:20},text:{fontSize:12,textAlign:"center",color:e.text.secondary},iconStyle:{width:14,height:14,fill:e.text.secondary,position:"absolute",bottom:-2},iconContainer:{position:"relative",height:14,width:30}})),[]);return(0,I.jsx)("div",{style:i.container,children:(0,I.jsxs)("div",{style:i.text,children:[t,(0,I.jsx)(G().A,{renderTooltip:()=>o,placement:z().W.Top,render:e=>(0,I.jsx)(E().A,{icon:()=>(0,O().$)(i.iconStyle),ariaLabel:r,style:{...i.iconContainer},disableBackground:!0,...e})})]})})}const H=(0,B().YK)({earliestDates:{defaultMessage:"Only showing earliest {limit} {dateGroupByOption}",id:"charts.limitsWarning.earliestDates"},latestDates:{defaultMessage:"Only showing latest {limit} {dateGroupByOption}",id:"charts.limitsWarning.latestDates"},lowestNumbers:{defaultMessage:"Only showing lowest {limit} values",id:"charts.limitsWarning.lowestNumbers"},highestNumbers:{defaultMessage:"Only showing highest {limit} values",id:"charts.limitsWarning.highestNumbers"},genericLimit:{defaultMessage:"Only showing {limit} options in {propertyName}",id:"charts.limitsWarning.genericLimit"}}),q=(0,B().YK)({addFilters:{defaultMessage:"Add filters to reduce the data range.",id:"charts.limitsWarning.tooltip.addFilters"}}),$=(0,B().YK)({column:{defaultMessage:"Max {limit} bars can be displayed in a chart.",id:"charts.limitsWarning.tooltip.maxDisplay.columnChart"},bar:{defaultMessage:"Max {limit} bars can be displayed in a chart.",id:"charts.limitsWarning.tooltip.maxDisplay.barChart"},line:{defaultMessage:"Max {limit} data points can be displayed in a chart.",id:"charts.limitsWarning.tooltip.maxDisplay.lineChart"},donut:{defaultMessage:"Max {limit} slices can be displayed in a chart.",id:"charts.limitsWarning.tooltip.maxDisplay.donutChart"},subGroups:{defaultMessage:"Max {limit} groups can be displayed in a chart.",id:"charts.limitsWarning.tooltip.maxDisplay.subGroups"}});function W(e,t,o){const r=null==e?void 0:e.type;if((0,P().Ik)(t)&&"relative"===t.groupBy)return H.genericLimit;if("ascending"===o.type)switch(r){case"formula":switch((0,A().getFormulaPropertySchemaResultType)(e)){case"date":return H.earliestDates;case"number":return H.lowestNumbers;default:return H.genericLimit}case"date":case"created_time":case"last_edited_time":case"last_visited_time":return H.earliestDates;case"number":return H.lowestNumbers;default:return H.genericLimit}else{if("descending"!==o.type)return H.genericLimit;switch(r){case"formula":switch((0,A().getFormulaPropertySchemaResultType)(e)){case"date":return H.latestDates;case"number":return H.highestNumbers;default:return H.genericLimit}case"date":case"created_time":case"last_edited_time":case"last_visited_time":return H.latestDates;case"number":return H.highestNumbers;default:return H.genericLimit}}}function Y(e){let{chartConfig:t,chartLimit:o,collectionContextStore:r}=e;const{limitType:i,limit:n}=o,l=(0,B().tz)(),s=(0,a().O$)(r.normalizedSchemaStore);if("results"===i&&"results_reducer"===t.dataConfig.type){const e=(0,D()._g)({schema:s,property:t.dataConfig.nameProperty});return e?(0,I.jsx)(B().sA,{...H.genericLimit,values:{limit:n,propertyName:e.name}}):null}if("groups"===i&&"groups_reducer"===t.dataConfig.type){const e=t.dataConfig.groupBy,o=(0,P().Kq)(e),r=(0,D()._g)({schema:s,property:e.property});if(!r)return null;const i=W(r,e,o);return(0,I.jsx)(B().sA,{...i,values:{limit:n,dateGroupByOption:(0,P().Ik)(e)?l.formatMessage(L().cS[e.groupBy]).toLocaleLowerCase():void 0,propertyName:r.name}})}if("subGroups"===i&&"groups_reducer"===t.dataConfig.type&&(0,h().m)(t)&&t.dataConfig.aggregationConfig.stackOptions){const e=t.dataConfig.aggregationConfig.stackOptions.groupBy,o=(0,P().Kq)(e),r=(0,D()._g)({schema:s,property:e.property});if(!r)return null;const i=W(r,e,o);return(0,I.jsx)(B().sA,{...i,values:{limit:n,dateGroupByOption:(0,P().Ik)(e)?e.groupBy:void 0,propertyName:r.name}})}return null}function X(e){let{chartConfig:t,chartReducerResults:o,loadingProps:n,collectionContextStore:l}=e;const s=(0,B().tz)(),u=function(e){let{chartConfig:t,chartReducerResults:o,collectionContextStore:n}=e;const l=(0,i().v3)(),s=(0,a().K8)((()=>(0,v().hk)()),[]),u=(0,a().K8)((()=>(0,v().dP)()),[]),c=(0,a().K8)((()=>(0,v().H4)()),[]),d=(0,a().K8)((()=>(0,j().sl)(n)),[n]),g=r.useMemo((()=>{let e;return"results_reducer"===t.dataConfig.type&&"results"===(null==o?void 0:o.type)&&o.blockIds.length>=u?e={limitType:"results",limit:u}:"groups_reducer"===t.dataConfig.type&&"groups"===(null==o?void 0:o.type)&&o.results.length>=s?e={limitType:"groups",limit:s}:"groups_reducer"===t.dataConfig.type&&"groups"===(null==o?void 0:o.type)&&o.subGroupResults&&o.subGroupResults.length>=c&&(e={limitType:"subGroups",limit:c}),e}),[t.dataConfig.type,o,s,u,c]);return r.useEffect((()=>{(0,F().u4)({environment:l,event:{eventName:"charts_data_length",eventProperties:{chart_group_length:"groups"===(null==o?void 0:o.type)?o.results.length:void 0,chart_results_length:"results"===(null==o?void 0:o.type)?o.blockIds.length:void 0,chart_sub_group_length:"groups"===(null==o?void 0:o.type)&&o.subGroupResults?o.subGroupResults.length:void 0,chart_data_limit:g,...d}}})}),[g,o,d,l]),g}({chartConfig:t,chartReducerResults:o,collectionContextStore:l});if(void 0===u||n.isInitialLoading||n.isThrottledLoading)return null;const{limitType:c,limit:d}=u;return(0,I.jsx)(N,{message:(0,I.jsx)(Y,{chartConfig:t,collectionContextStore:l,chartLimit:u}),tooltipMessage:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{children:(0,I.jsx)(B().sA,{..."subGroups"===c?$.subGroups:$[t.type],values:{limit:d}})}),(0,I.jsx)("div",{children:(0,I.jsx)(B().sA,{...q.addFilters})})]}),tooltipAriaLabel:s.formatMessage("subGroups"===c?$.subGroups:$[t.type],{limit:d})})}o(725707),o(491955),o(403517),o(113085);var U=()=>o(120082),Q=()=>o(963016),J=()=>o(87797),Z=()=>o(129978);const ee=new(Z().O2)("CollectionChartView",(async()=>await Promise.all([o.e(62475),o.e(3151),o.e(98629),o.e(42838),o.e(27634),o.e(28721),o.e(55717),o.e(88372),o.e(22)]).then(o.bind(o,654818)))),te=(0,Z()._h)(ee,(e=>e.AxisChart));var oe=()=>o(401857),re=()=>o(206183),ie=()=>o(997714),ae=()=>o(569555),ne=()=>o(899498),le=()=>o(880395),se=()=>o(220413),ue=()=>o(855327);const ce=(0,B().YK)({noData:{defaultMessage:"No data",id:"database.chart.multipleSeriesTooltip.noData"},empty:{defaultMessage:"Empty",id:"database.chart.tooltip.empty"},clickToViewData:{defaultMessage:"Click to view data",id:"database.chart.tooltip.clickToViewData"},clickToViewDetails:{defaultMessage:"Click to view details",id:"database.chart.tooltip.clickToViewDetails"}}),de=43;function ge(e){var t;const{chartConfig:o,schema:i,seriesData:n,isClickable:l}=e,s=(0,B().tz)(),u=(0,K().IS)((e=>({defaultContainer:{border:`1px solid ${e.accentColors.gray[100]}`,borderRadius:"8px",backgroundColor:e.cardContentBackground,maxHeight:"375px",maxWidth:"300px",width:"max-content",overflow:"hidden",pointerEvents:"auto",boxShadow:"0px 2px 4px rgb(0, 0, 0, 0.1)"},scrollContainer:{overflow:"auto",padding:"12px",maxHeight:l?375-de+"px":"375px"},clickToSeeDataContainer:{padding:"12px",display:"flex",gap:"6px",alignItems:"center"},clickToSeeDataSeparator:{border:"none",borderTop:`1px solid ${e.stroke.secondary}`,margin:"0 12px"},clickToSeeDataIcon:{width:"14px",height:"14px",color:e.text.tertiary},clickToSeeDataText:{color:e.text.tertiary,fontSize:"12px",lineHeight:"16px"},containerSingleSeries:{padding:"10px 12px"},header:{fontSize:"12px",paddingBottom:"7px",color:e.text.primary,overflowX:"hidden",whiteSpace:"normal",display:"block"},row:{fontSize:"12px",lineHeight:"18px",textAlign:"left",display:"flex",justifyContent:"space-between",gap:"16px"},square:{height:"8px",width:"8px",minWidth:"8px",borderRadius:"1px",borderWidth:"0px",margin:"0 3px",verticalAlign:"top",display:"inline-block"},rowLeft:{display:"inline-block",color:e.text.secondary,overflowX:"hidden",whiteSpace:"normal"},rowLeftContainer:{display:"inline-flex",alignItems:"center",gap:"6px"},rowRight:{color:e.chartRowRightColor},noData:{color:e.text.secondary}})),[l]),c=(0,r.useMemo)((()=>s.formatMessage(ce.noData)),[s]),d=(0,r.useMemo)((()=>({useHTML:!0,shadow:!1,borderWidth:0,backgroundColor:void 0,outside:!1,stickOnContact:!0,hideDelay:100})),[]),g=(0,a().K8)((()=>"donut"===(null==o?void 0:o.type)),[null==o?void 0:o.type]),p=(0,a().K8)((()=>"results_reducer"===(null==o?void 0:o.dataConfig.type)?s.formatMessage(ce.clickToViewDetails):s.formatMessage(ce.clickToViewData)),[null==o?void 0:o.dataConfig.type,s]),m=(0,a().K8)((()=>{var e;return("bar"===(null==o?void 0:o.type)||"column"===(null==o?void 0:o.type))&&("groups_reducer"===o.dataConfig.type&&(!!o.dataConfig.aggregationConfig.stackOptions&&"percent"===(null===(e=o.chartFormat)||void 0===e?void 0:e.axisGroupStyle)))}),[o]),y=(0,a().K8)((()=>{var e,t;if("precision_from_number_property"===(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.numberPrecisionOverride)){const e=null==o?void 0:o.dataConfig;if(!e||"results_reducer"!==e.type)return;const t=(0,D()._g)({schema:i,property:e.valueProperty});return t?(0,ae().i5)(t):void 0}return null==o||null===(t=o.chartFormat)||void 0===t?void 0:t.numberPrecisionOverride}),[null==o||null===(t=o.chartFormat)||void 0===t?void 0:t.numberPrecisionOverride,null==o?void 0:o.dataConfig,i]),v=(0,r.useMemo)((()=>({...d,formatter:function(){const e=this.color??this.series.color;ue().U.setCurrentTooltipPoint(this.point);const{label:t,value:r}=(0,ae().NH)({chartConfig:o,schema:i,highChartsLabel:this.point.name,highChartsValue:this.point.y,isMultiSeries:!1,intl:s,numberPrecisionOverride:y});let a="";g&&this.point.percentage&&(a=` (${(0,ae().l9)(this.point.percentage)}%)`);const n=""===t?s.formatMessage(ce.empty):t;return le().A.renderToStaticMarkup((0,I.jsxs)("div",{style:u.defaultContainer,children:[(0,I.jsx)("div",{style:u.containerSingleSeries,children:(0,I.jsxs)("div",{style:u.row,children:[(0,I.jsxs)("div",{style:u.rowLeftContainer,children:[(0,I.jsx)("div",{style:{...u.square,backgroundColor:he(e)}}),(0,I.jsx)("div",{style:u.rowLeft,children:n})]}),(0,I.jsxs)("div",{style:u.rowRight,children:[r,a]})]})}),l?(0,I.jsx)(pe,{label:p,styles:u}):null]}))}})),[d,o,i,s,y,g,u,l,p]),f=(0,r.useMemo)((()=>({...d,shared:!0,formatter:function(){var e;const t=null===(e=this.points)||void 0===e?void 0:e.filter((e=>!(null==e||!e.y)&&0!==e.y));ue().U.setCurrentTooltipPoint(this.point);("line"===this.series.type||"area"===this.series.type||"areaspline"===this.series.type)&&(null==t||t.sort(((e,t)=>((null==t?void 0:t.y)??0)-((null==e?void 0:e.y)??0))));let r=this.point.name;if(o&&(0,h().m)(o)&&"groups_reducer"===o.dataConfig.type){const e=o.dataConfig,t=e.groupBy,a=(0,D()._g)({schema:i,property:e.groupBy.property});a&&(r=(0,ae().w$)({propertySchema:a,groupByFormat:t,aggregation:o.dataConfig.aggregationConfig.aggregation,highChartsLabel:this.point.name,intl:s}))}return t&&0!==t.length?le().A.renderToStaticMarkup((0,I.jsxs)("div",{style:u.defaultContainer,children:[(0,I.jsxs)("div",{style:u.scrollContainer,children:[(0,I.jsx)("div",{style:u.header,children:r}),t.map((e=>{const t=e.color??e.series.color,{label:r,value:a}=(0,ae().NH)({chartConfig:o,schema:i,highChartsLabel:e.series.name,highChartsValue:e.y??void 0,isMultiSeries:!0,intl:s,numberPrecisionOverride:y});let n="";m&&e.percentage&&(n=` (${(0,ae().l9)(e.percentage)}%)`);const l=""===r?s.formatMessage(ce.empty):r;return(0,I.jsxs)("div",{style:u.row,children:[(0,I.jsxs)("div",{style:u.rowLeftContainer,children:[(0,I.jsx)("div",{style:{...u.square,backgroundColor:he(t)}}),(0,I.jsx)("div",{style:u.rowLeft,children:l})]}),(0,I.jsxs)("span",{style:u.rowRight,children:[a,n]})]},e.key)}))]}),l?(0,I.jsx)(pe,{label:p,styles:u}):null]})):le().A.renderToStaticMarkup((0,I.jsxs)("div",{style:u.defaultContainer,children:[(0,I.jsxs)("div",{style:u.scrollContainer,children:[(0,I.jsx)("div",{style:u.header,children:r}),(0,I.jsx)("div",{style:{...u.row,...u.noData},children:c})]}),l?(0,I.jsx)(pe,{label:p,styles:u}):null]}))}})),[d,o,u,i,s,c,y,m,l,p]);return n?1===n.length?v:f:d}function pe(e){const{label:t,styles:o}=e;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("hr",{style:o.clickToSeeDataSeparator}),(0,I.jsxs)("div",{style:o.clickToSeeDataContainer,children:[(0,ne().n)(o.clickToSeeDataIcon),(0,I.jsx)("div",{style:o.clickToSeeDataText,children:t})]})]})}function he(e){const t=se().OK.colorful[0];return e?"string"==typeof e?e:"pattern"in e?e.pattern.backgroundColor??t:t:t}var me=()=>o(622286);function ye(e){let{collectionContextStore:t,groupedChartReducerResults:o,groupedDataConfig:n,chartFormat:l,timezone:s,loadingProps:u,axisType:c}=e;const d=(0,i().v3)(),p=(0,B().tz)(),m=(0,K().DP)(),y=(0,r.useRef)(!0),f=(0,me().X)("charts_drilldown"),{chartConfig:x,chartErrorStore:C,collectionViewStore:S,collectionViewBlockStore:b,databaseType:w,isMultiSourceView:k}=(0,a().K8)((()=>{const e=t.collectionViewStore(),o=null==e?void 0:e.getChartConfig();return{chartConfig:o&&(0,h().m)(o)&&"groups_reducer"===o.dataConfig.type?o:void 0,chartErrorStore:t.chartErrorStore,collectionViewStore:e,collectionViewBlockStore:t.collectionViewBlockStore(),databaseType:t.databaseType,isMultiSourceView:t.isMultiSourceView}}),[t]),R=(0,a().O$)(t.normalizedSchemaStore),_=(0,a().O$)(t.normalizedFormatStore),T=(0,a().O$)(t.normalizedQueryStore),V=(0,a().O$)(t.temporaryStateStore),A=(0,a().K8)((()=>(0,D()._g)({schema:R,property:n.groupBy.property})),[n.groupBy.property,R]),L=(0,a().K8)((()=>{if(n.aggregationConfig.aggregation.property)return(0,D()._g)({schema:R,property:n.aggregationConfig.aggregation.property})}),[n.aggregationConfig.aggregation,R]),F=(0,a().K8)((()=>null==l?void 0:l.mainSort),[null==l?void 0:l.mainSort]),j=(0,a().K8)((()=>null==l?void 0:l.axisAvatar),[null==l?void 0:l.axisAvatar]),O=(0,a().K8)((()=>{if("side_by_side"===(null==l?void 0:l.axisGroupStyle))return;if(n.aggregationConfig.stackOptions){if(null!=l&&l.axisGroupStyle)return l.axisGroupStyle;if("line"!==(null==x?void 0:x.type))return M().PC.normal}}),[null==x?void 0:x.type,null==l?void 0:l.axisGroupStyle,n.aggregationConfig]),z=(0,a().K8)((()=>A?A.name||re().dC[A.type]:""),[A]),E=(0,a().K8)((()=>{const e=n.aggregationConfig;if((0,U().Iq)(e.aggregation)){return(0,g().TQ)({aggregation:e.aggregation,databaseType:w,intl:p})||""}const t=(0,g().TQ)({aggregation:e.aggregation,databaseType:w,intl:p});return L?`${L.name||re().dC[L.type]} (${t})`:""}),[n.aggregationConfig,w,p,L]),G=(0,a().K8)((()=>(0,M().q_)(x)),[x]),N=!!x&&(0,ie().hu)(x),H=(null==l?void 0:l.hideLegend)||N,q=(0,a().K8)((()=>{const e=null==l?void 0:l.axisGridLine;return!e||("horizontal"===e||"both"===e)}),[l]),$=(0,a().K8)((()=>{const e=null==l?void 0:l.axisGridLine;return!!e&&("vertical"===e||"both"===e)}),[l]),W=(0,a().K8)((()=>(0,v().hk)()),[]),Y=(0,a().K8)((()=>(0,v().H4)()),[]),X=(0,a().K8)((()=>{if(o&&x)return(0,ie().CL)({groupedChartReducerResults:o,chartConfig:x,sortType:"main"})}),[o,x]),Z=(0,a().K8)((()=>{if(!(o&&t&&b&&X))return;const{result:e,xAxisType:r}=function(e){var t;let{collectionContextStore:o,groupedDataConfig:r,groupedChartReducerResults:i,chartFormat:a,timezone:n,theme:l,environment:s,intl:u,getRecordModel:c,getRecordRole:d,renderGroupsFromAggregationArgs:g,groupsLimit:p,subGroupsLimit:h,databaseType:m,schema:y,collectionViewFormat:v}=e;const f=i.aggregationResults;if(!f)return;const x=(0,ie().AY)({groupedDataConfig:r,hideEmptyGroups:Boolean(null==a?void 0:a.axisHideEmptyGroups),mainSort:null==a?void 0:a.mainSort});if("v2"===(null==i?void 0:i.version)){var C;const e=i.results.filter((e=>e.visible)).map((e=>({property:r.groupBy.property,value:e.value}))),t=r.aggregationConfig.stackOptions,a=t?null===(C=i.subGroupResults)||void 0===C?void 0:C.filter((e=>e.visible)).map((e=>({property:t.groupBy.property,value:e.value}))):[];return{result:(0,ie().w7)({collectionContextStore:o,groupedDataConfig:r,groupResults:e,subGroupResults:a,aggregationResults:f,xAxisType:x,timezone:n,environment:s,intl:u,theme:l,groupTotals:g.groupTotals}),xAxisType:x}}const S=(0,P().oH)({schema:y,groupBy:r.groupBy});let b=(0,oe().ck)({groupBy:r.groupBy,schema:y,formatGroups:v[P().V1]||[],schemaGroups:S,reducerResults:i.results,getRecordModel:c,getRecordRole:d,relativeVariableResult:o.relativeVariableStore.state,viewAppConfigUri:m,allowedCollectionStores:o.collectionStoresStore.state,renderGroupsFromAggregationArgs:g});b=b.filter((e=>!(0,P().tx)(e))),b=b.slice(0,p);const w=r.aggregationConfig.stackOptions?(0,P().oH)({schema:y,groupBy:r.aggregationConfig.stackOptions.groupBy}):void 0,k=i.subGroupResults&&null!==(t=r.aggregationConfig.stackOptions)&&void 0!==t&&t.groupBy?(0,oe().ck)({groupBy:r.aggregationConfig.stackOptions.groupBy,schema:y,formatGroups:v.chart_subgroups||[],schemaGroups:w,reducerResults:i.subGroupResults,getRecordModel:c,getRecordRole:d,relativeVariableResult:o.relativeVariableStore.state,viewAppConfigUri:m,allowedCollectionStores:o.collectionStoresStore.state}).filter((e=>!(0,P().tx)(e))).slice(0,h):void 0,R=(0,ie().w7)({collectionContextStore:o,groupedDataConfig:r,groupResults:b,subGroupResults:k,aggregationResults:f,xAxisType:x,timezone:n,environment:s,intl:u,theme:l,groupTotals:g.groupTotals});return{result:R,xAxisType:x}}({collectionContextStore:t,groupedDataConfig:n,groupedChartReducerResults:o,chartFormat:l,timezone:s,theme:m,environment:d,intl:p,getRecordModel:b.getRecordModel,getRecordRole:b.getRecordRole,renderGroupsFromAggregationArgs:X,groupsLimit:W,subGroupsLimit:Y,databaseType:w,schema:R,collectionViewFormat:_})||{};if(!r)return;var i;y.current&&(null===(i=t.databaseItemsVisibleTracker)||void 0===i||i.handleItemsRenderStart(),y.current=!1);const a=o.results.some((e=>(0,Q().bv)(e)?e.visible:e.total>0));return{seriesData:null==e?void 0:e.seriesData,maxValue:(null==e?void 0:e.maxValue)??0,minValue:(null==e?void 0:e.minValue)??0,dataPointsForXAxisLabels:null==e?void 0:e.dataPointsForXAxisLabels,xAxisType:r,reverseXAxis:(0,ie().p4)({xAxisType:r,mainSort:F}),hasData:a}}),[o,W,Y,t,b,n,R,_,w,F,l,s,d,p,m,X],{useDeepEqual:!0}),ee=(0,ae().gc)(null==S?void 0:S.getRecordModel,p,j===M().GL.avatar_name),ne=(0,r.useMemo)((()=>A&&(0,M().fn)(A)&&(void 0===j||j===M().GL.avatar||j===M().GL.avatar_name)),[j,A]),le=(()=>{if(!A)return;if(ne)return ee;if((0,M().JW)(A))return(0,ae().ck)({propertySchema:A,aggregation:n.aggregationConfig.aggregation,intl:p,numberPrecisionOverride:null==l?void 0:l.numberPrecisionOverride});const e="formula"===n.groupBy.type?n.groupBy.groupBy:n.groupBy;return(0,P().Ik)(e)&&(0,M().i8)(A)?(0,ae().jY)({groupBy:e.groupBy,dateFormat:A.date_format,intl:p}):void 0})(),se=(()=>{if(L)return(0,M().JW)(L)?(0,ae().ck)({propertySchema:L,aggregation:n.aggregationConfig.aggregation,intl:p,numberPrecisionOverride:null==l?void 0:l.numberPrecisionOverride}):void 0})(),ue=(e=>{const t=null===(e=n.aggregationConfig.stackOptions)||void 0===e?void 0:e.groupBy;if(H||!t)return;const o="formula"===t.type?t.groupBy:t,r=t.property,i=(0,D()._g)({schema:R,property:r});return i&&(0,P().Ik)(o)&&(0,M().i8)(i)?e=>(0,ae().H$)({dateString:e,dateFormat:i.date_format,groupBy:o.groupBy,intl:p}):void 0})(),ce=(0,r.useCallback)(((e,o)=>{J().Sp({chartConfig:x,collectionViewBlockStore:b,format:_,dataPoint:e,clickEvent:o,schema:R,intl:p,query2:T,temporaryViewState:V,environment:d,collectionContextStore:t})}),[x,b,_,R,V,T,p,d,t]),de=f&&!k?ce:void 0,pe=ge({chartConfig:x,schema:R,seriesData:null==Z?void 0:Z.seriesData,isClickable:Boolean(de)}),he=(0,a().K8)((()=>!(!L||!Z)&&(0,ae()._G)({dataYAxisMax:Z.maxValue,dataYAxisMin:Z.minValue,userYAxisMax:null==l?void 0:l.yAxisMax,userYAxisMin:null==l?void 0:l.yAxisMin,propertySchema:L,aggregation:n.aggregationConfig.aggregation})),[Z,null==l?void 0:l.yAxisMax,null==l?void 0:l.yAxisMin,n.aggregationConfig.aggregation,L]),ye=(0,a().O$)(t.isInPeekRendererStore);r.useEffect((()=>{var e;if(!S)return;const t=null==o?void 0:o.subGroupResults;if(Boolean(x&&(0,h().m)(x)&&"groups_reducer"===x.dataConfig.type&&(null===(e=x.dataConfig.aggregationConfig.stackOptions)||void 0===e?void 0:e.groupBy))&&t){if(1===t.length&&!t[0].value.value){const e=new Map(C.state);return e.set(S.id,"stackBy_property_no_values"),void C.setState(e)}}const r=new Map(C.state);r.delete(S.id),C.setState(r)}),[x,S,null==o?void 0:o.subGroupResults,C]);const ve=(0,r.useCallback)((()=>{t.onItemMount()}),[t]);return(0,I.jsx)(te,{axisType:c,timezone:s,seriesData:(null==Z?void 0:Z.seriesData)||[],hasData:Boolean(null==Z?void 0:Z.hasData),loadingProps:u,xAxisType:null==Z?void 0:Z.xAxisType,xAxisTitle:z,yAxisTitle:E,axisLabelFormat:null==l?void 0:l.axisLabel,colorTheme:null==l?void 0:l.colorTheme,chartHeight:null==l?void 0:l.height,weightColorValue:null==l?void 0:l.weightColorValue,hideLegend:H,showCaption:null==l?void 0:l.showCaption,caption:null==l?void 0:l.caption,showHorizontalGridLines:q,showVerticalGridLines:$,dataLabelsEnabled:G,columnStacking:O,axisHideEmptyGroups:null==l?void 0:l.axisHideEmptyGroups,tooltipOptions:pe,sortReversed:null==Z?void 0:Z.reverseXAxis,dataPointsForXAxisLabels:null==Z?void 0:Z.dataPointsForXAxisLabels,xLabelFormatter:le,disableXAxisAutoRotation:ne,yLabelFormatter:se,dataLabelFormatter:se,stackLabelFormatter:se,legendLabelFormatter:ue,yAxisAllowDecimals:he,dataYAxisMax:null==Z?void 0:Z.maxValue,dataYAxisMin:null==Z?void 0:Z.minValue,userYAxisMax:null==l?void 0:l.yAxisMax,userYAxisMin:null==l?void 0:l.yAxisMin,onLoadEventHandler:ve,isInPeekMode:ye,onSeriesClick:de})}const ve=new(Z().O2)("CollectionChartView",(async()=>await Promise.all([o.e(62475),o.e(3151),o.e(98629),o.e(42838),o.e(27634),o.e(28721),o.e(55717),o.e(88372),o.e(22)]).then(o.bind(o,750522)))),fe=(0,Z()._h)(ve,(e=>e.DonutChart));var xe=()=>o(31448);function Ce(e,t){const o=(0,B().tz)(),r=(0,K().IS)((e=>({name:{maxWidth:"250px",...xe().RC,display:"inline-block",verticalAlign:"middle"},value:{display:"inline-block",verticalAlign:"middle",marginLeft:5}})),[]),i=(0,a().K8)((()=>null==e?void 0:e.chartFormat),[e]);if((null==i?void 0:i.donutDataLabels)!==M().D0.none)return function(){const{label:a,value:n}=(0,ae().NH)({chartConfig:e,schema:t,highChartsLabel:this.point.name,highChartsValue:this.point.y,isMultiSeries:!1,intl:o,numberPrecisionOverride:void 0});let l="";return this.point.percentage&&(l=` (${(0,ae().l9)(this.point.percentage)}%)`),(null==i?void 0:i.donutDataLabels)===M().D0.value?`${n}${l}`:(null==i?void 0:i.donutDataLabels)===M().D0.name?le().A.renderToStaticMarkup((0,I.jsx)("div",{style:r.name,children:a})):(null==i?void 0:i.donutDataLabels)===M().D0.name_and_value?le().A.renderToStaticMarkup((0,I.jsxs)("div",{children:[(0,I.jsx)("div",{style:r.name,children:a}),(0,I.jsx)("div",{style:r.value,children:`${n}${l}`})]})):void 0}}var Se=()=>o(361308),be=()=>o(477784);const we=(0,B().YK)({total:{id:"charts.donut.aggregationValue.total",defaultMessage:"Total"},totalPropertyName:{id:"charts.donut.aggregationValue.totalPropertyName",defaultMessage:"Total {propertyName}"},averagePropertyName:{id:"charts.donut.aggregationValue.averagePropertyName",defaultMessage:"Average {propertyName}"},minPropertyName:{id:"charts.donut.aggregationValue.minPropertyName",defaultMessage:"Min {propertyName}"},maxPropertyName:{id:"charts.donut.aggregationValue.maxPropertyName",defaultMessage:"Max {propertyName}"},medianPropertyName:{id:"charts.donut.aggregationValue.medianPropertyName",defaultMessage:"Median {propertyName}"},uniquePropertyName:{id:"charts.donut.aggregationValue.uniquePropertyName",defaultMessage:"Distinct {propertyName}"}});function ke(e,t,o,i){const a=(0,B().tz)();return(0,r.useMemo)((()=>{if(!e||!o)return;const r=e.aggregationResult,n=(0,D()._g)({schema:i,property:o});if(!r||"number"!==r.type||!n)return;let l;const s=r.value?(0,ae().EN)(r.value,2):void 0;if((0,M().JW)(n)&&"count"!==t&&"unique"!==t){const e=(0,ae().JI)(n)??"number";l=(0,Se().ZV)(s,e,a,"compact")}else l=(0,Se().ZV)(s,"number",a,"compact");let u;const c=n.name;switch(t){case"sum":u=be().A.formatMessage(we.totalPropertyName,{propertyName:c});break;case"average":u=be().A.formatMessage(we.averagePropertyName,{propertyName:c});break;case"min":u=be().A.formatMessage(we.minPropertyName,{propertyName:c});break;case"max":u=be().A.formatMessage(we.maxPropertyName,{propertyName:c});break;case"median":u=be().A.formatMessage(we.medianPropertyName,{propertyName:c});break;case"unique":u=be().A.formatMessage(we.uniquePropertyName,{propertyName:c});break;default:u=be().A.formatMessage(we.total)}return{title:l,subtitle:u}}),[e,t,a,o,i])}function Re(e){let{collectionContextStore:t,groupedChartReducerResults:o,aggregationChartReducerResults:n,groupedDataConfig:l,chartFormat:s,timezone:u,loadingProps:c}=e;const d=(0,i().v3)(),g=(0,B().tz)(),p=(0,K().DP)(),h=(0,r.useRef)(!0),m=(0,me().X)("charts_drilldown"),{collectionViewBlockStore:y,databaseType:f,schema:x,query2:C,chartConfig:S,isMultiSourceView:b}=(0,a().K8)((()=>{var e;const o=null===(e=t.collectionViewStore())||void 0===e?void 0:e.getChartConfig();return{collectionViewBlockStore:t.collectionViewBlockStore(),databaseType:t.databaseType,schema:t.normalizedSchemaStore.state,query2:t.normalizedQueryStore.state,chartConfig:o&&"donut"===o.type&&"groups_reducer"===o.dataConfig.type?o:void 0,isMultiSourceView:t.isMultiSourceView}}),[t]),w=(0,a().K8)((()=>(0,P().oH)({schema:x,groupBy:l.groupBy})),[l,x]),k=(0,a().O$)(t.normalizedFormatStore),R=(0,a().O$)(t.temporaryStateStore),_=(0,a().K8)((()=>(0,v().hk)()),[]),T=(0,a().K8)((()=>{if(o&&S)return(0,ie().CL)({groupedChartReducerResults:o,chartConfig:S,sortType:"main"})}),[o,S]),V=(0,a().K8)((()=>{const e=null==o?void 0:o.aggregationResults;if(!y||!T||!e)return;if("v2"===(null==o?void 0:o.version)){const i=o.results.filter((e=>e.visible)).map((e=>({property:l.groupBy.property,value:e.value}))),a=(0,ie().cN)({collectionContextStore:t,groupedDataConfig:l,groupResults:i,aggregationResults:e,timezone:u,environment:d,intl:g,theme:p,groupTotals:T.groupTotals});var r;if(h.current)null===(r=t.databaseItemsVisibleTracker)||void 0===r||r.handleItemsRenderStart(),h.current=!1;return a}let i=(0,oe().ck)({groupBy:l.groupBy,schema:x,formatGroups:k[P().V1]||[],schemaGroups:w,reducerResults:o.results,getRecordModel:y.getRecordModel,getRecordRole:y.getRecordRole,relativeVariableResult:t.relativeVariableStore.state,viewAppConfigUri:f,allowedCollectionStores:t.collectionStoresStore.state,renderGroupsFromAggregationArgs:T});i=i.filter((e=>!(0,P().tx)(e))),i=i.slice(0,_);const a=(0,ie().cN)({collectionContextStore:t,groupedDataConfig:l,groupResults:i,aggregationResults:e,timezone:u,environment:d,intl:g,theme:p,groupTotals:T.groupTotals});var n;h.current&&(null===(n=t.databaseItemsVisibleTracker)||void 0===n||n.handleItemsRenderStart(),h.current=!1);return a}),[o,l,u,d,g,t,p,y,f,x,w,_,k,T],{useDeepEqual:!0}),A=(0,a().K8)((()=>!(null!=s&&s.donutHideValue)),[null==s?void 0:s.donutHideValue]),L=(0,a().K8)((()=>"count"===l.aggregationConfig.aggregation.aggregator?l.groupBy.property:l.aggregationConfig.aggregation.property),[l]),F=ke(n,l.aggregationConfig.aggregation.aggregator,L,x),j=(0,a().K8)((()=>null==s?void 0:s.valueLabel),[null==s?void 0:s.valueLabel])||(null==F?void 0:F.subtitle),O=(()=>{const e="formula"===l.groupBy.type?l.groupBy.groupBy:l.groupBy,t=(0,D()._g)({schema:x,property:l.groupBy.property});if(t)return(0,P().Ik)(e)&&(0,M().i8)(t)?o=>(0,ae().H$)({dateString:o.toString(),dateFormat:t.date_format,groupBy:e.groupBy,intl:g}):void 0})(),z=Ce(S,x),E=(0,r.useCallback)(((e,o)=>{J().Sp({chartConfig:S,collectionViewBlockStore:y,format:k,dataPoint:e,clickEvent:o,schema:x,intl:g,query2:C,temporaryViewState:R,environment:d,collectionContextStore:t})}),[S,y,k,x,R,C,g,d,t]),G=m&&!b?E:void 0,N=ge({chartConfig:S,schema:x,seriesData:V,isClickable:Boolean(G)}),H=(0,r.useCallback)((()=>{t.onItemMount()}),[t]),q=(0,a().O$)(t.isInPeekRendererStore);return(0,I.jsx)(fe,{timezone:u,seriesData:V||[],title:A?null==F?void 0:F.title:void 0,subtitle:A?j:void 0,loadingProps:c,colorTheme:null==s?void 0:s.colorTheme,chartHeight:null==s?void 0:s.height,weightColorValue:null==s?void 0:s.weightColorValue,hideLegend:null==s?void 0:s.hideLegend,showCaption:null==s?void 0:s.showCaption,caption:null==s?void 0:s.caption,tooltipOptions:N,legendLabelFormatter:O,onLoadEventHandler:H,dataLabelsFormatter:z,isInPeekMode:q,onSeriesClick:G})}function Me(e){let{collectionContextStore:t,resultsChartReducerResults:o,resultsDataConfig:n,chartFormat:l,timezone:s,loadingProps:u,axisType:c}=e;const d=(0,i().v3)(),g=(0,B().tz)(),p=(0,K().DP)(),m=(0,me().X)("charts_drilldown"),y=(0,r.useRef)(!0),{chartConfig:v,collectionViewBlockStore:f,collectionViewStore:x,collectionStore:C,isMultiSourceView:S}=(0,a().K8)((()=>{const e=t.collectionViewStore(),o=null==e?void 0:e.getChartConfig();return{chartConfig:o&&(0,h().m)(o)&&"results_reducer"===o.dataConfig.type?o:void 0,collectionViewBlockStore:t.collectionViewBlockStore(),collectionViewStore:e,collectionStore:t.collectionStore(),isMultiSourceView:t.isMultiSourceView}}),[t]),b=(0,a().O$)(t.normalizedSchemaStore),w=null==l?void 0:l.mainSort,k=(0,a().K8)((()=>{const e=n.nameProperty,t=b[e];return t?t.name||re().dC[t.type]:""}),[n.nameProperty,b]),R=(0,a().K8)((()=>{const e=b[n.valueProperty];return e?`${e.name||re().dC[e.type]}`:""}),[n,b]),_=!!v&&(0,ie().hu)(v),T=(null==l?void 0:l.hideLegend)||_,V=(0,a().K8)((()=>{const e=null==l?void 0:l.axisGridLine;return!e||("horizontal"===e||"both"===e)}),[l]),A=(0,a().K8)((()=>{const e=null==l?void 0:l.axisGridLine;return!!e&&("vertical"===e||"both"===e)}),[l]),P=(0,a().K8)((()=>{if(!n||!t||!f)return;const e="category",r=(0,ie().UX)({collectionContextStore:t,resultsDataConfig:n,resultsChartReducerResults:o,chartType:"axis",xAxisType:e,timezone:s,environment:d,intl:g,theme:p});var i;y.current&&(null===(i=t.databaseItemsVisibleTracker)||void 0===i||i.handleItemsRenderStart(),y.current=!1);const a=o&&o.blockIds.length>0;return{seriesData:null==r?void 0:r.seriesData,maxValue:(null==r?void 0:r.maxValue)??0,minValue:(null==r?void 0:r.minValue)??0,xAxisType:e,reverseXAxis:(0,ie().p4)({xAxisType:e,mainSort:w}),hasData:a}}),[n,t,f,o,s,d,g,p,w],{useDeepEqual:!0}),L=(0,a().K8)((()=>(0,M().q_)(v)),[v]),F=(0,a().K8)((()=>(0,D()._g)({schema:b,property:n.nameProperty})),[n.nameProperty,b]),j=(0,a().K8)((()=>(0,D()._g)({schema:b,property:n.valueProperty})),[n.valueProperty,b]),O=(0,ae().wK)(null==x?void 0:x.getRecordModel,g,s),z=(()=>{if(F)return"title"===F.type?O:void 0})(),E=j?(0,ae().ck)({propertySchema:j,aggregation:void 0,intl:g,numberPrecisionOverride:null==l?void 0:l.numberPrecisionOverride}):void 0,G=(0,a().K8)((()=>!(!j||!P)&&(0,ae()._G)({dataYAxisMax:P.maxValue,dataYAxisMin:P.minValue,userYAxisMax:null==l?void 0:l.yAxisMax,userYAxisMin:null==l?void 0:l.yAxisMin,propertySchema:j,aggregation:void 0})),[P,null==l?void 0:l.yAxisMax,null==l?void 0:l.yAxisMin,j]),N=(0,r.useCallback)((()=>{t.onItemMount()}),[t]),H=(0,r.useCallback)(((e,o)=>{J().sw({collectionStore:C,dataPoint:e,environment:d,clickEvent:o,collectionContextStore:t})}),[C,d,t]),q=m&&!S?H:void 0,$=ge({chartConfig:v,schema:b,seriesData:null==P?void 0:P.seriesData,isClickable:Boolean(q)}),W=(0,a().O$)(t.isInPeekRendererStore);return(0,I.jsx)(te,{axisType:c,timezone:s,seriesData:(null==P?void 0:P.seriesData)||[],hasData:Boolean(null==P?void 0:P.hasData),loadingProps:u,xAxisType:null==P?void 0:P.xAxisType,xAxisTitle:k,yAxisTitle:R,axisLabelFormat:null==l?void 0:l.axisLabel,colorTheme:null==l?void 0:l.colorTheme,chartHeight:null==l?void 0:l.height,weightColorValue:null==l?void 0:l.weightColorValue,hideLegend:T,showCaption:null==l?void 0:l.showCaption,caption:null==l?void 0:l.caption,showHorizontalGridLines:V,showVerticalGridLines:A,dataLabelsEnabled:L,columnStacking:void 0,tooltipOptions:$,sortReversed:null==P?void 0:P.reverseXAxis,xLabelFormatter:z,dataLabelFormatter:E,yLabelFormatter:E,yAxisAllowDecimals:G,dataYAxisMax:null==P?void 0:P.maxValue,dataYAxisMin:null==P?void 0:P.minValue,userYAxisMax:null==l?void 0:l.yAxisMax,userYAxisMin:null==l?void 0:l.yAxisMin,onLoadEventHandler:N,isInPeekMode:W,onSeriesClick:q})}function _e(e){let{collectionContextStore:t,resultsChartReducerResults:o,aggregationChartReducerResults:n,resultsDataConfig:l,chartFormat:s,timezone:u,loadingProps:c}=e;const d=(0,i().v3)(),g=(0,B().tz)(),p=(0,K().DP)(),h=(0,r.useRef)(!0),m=(0,me().X)("charts_drilldown"),{chartConfig:y,collectionViewBlockStore:v,collectionViewStore:f,collectionStore:x,isMultiSourceView:C}=(0,a().K8)((()=>{const e=t.collectionViewStore(),o=null==e?void 0:e.getChartConfig();return{chartConfig:o&&"donut"===o.type&&"results_reducer"===o.dataConfig.type?o:void 0,collectionViewBlockStore:t.collectionViewBlockStore(),collectionViewStore:t.collectionViewStore(),collectionStore:t.collectionStore(),isMultiSourceView:t.isMultiSourceView}}),[t]),S=(0,a().O$)(t.normalizedSchemaStore),b=(0,a().K8)((()=>{var e;if(!o||!v)return;const r=(0,ie().UX)({collectionContextStore:t,resultsDataConfig:l,resultsChartReducerResults:o,chartType:"donut",xAxisType:void 0,timezone:u,environment:d,intl:g,theme:p});var i;h.current&&(null===(i=t.databaseItemsVisibleTracker)||void 0===i||i.handleItemsRenderStart(),h.current=!1);const a=null==r||null===(e=r.seriesData)||void 0===e?void 0:e[0];return[{...a,data:(null==a?void 0:a.data)||[],type:"pie"}]}),[o,v,t,l,u,d,g,p],{useDeepEqual:!0}),w=(0,a().K8)((()=>{if(l.valueProperty)return l.valueProperty}),[l]),k=(0,a().K8)((()=>!(null!=s&&s.donutHideValue)),[null==s?void 0:s.donutHideValue]),R=ke(n,"sum",w,S),M=(0,r.useCallback)((()=>{t.onItemMount()}),[t]),_=(0,ae().wK)(null==f?void 0:f.getRecordModel,g,u),T=(()=>{if("title"===l.nameProperty)return _})(),V=Ce(y,S),A=(0,r.useCallback)(((e,o)=>{J().sw({collectionStore:x,dataPoint:e,clickEvent:o,environment:d,collectionContextStore:t})}),[x,d,t]),P=m&&!C?A:void 0,D=ge({chartConfig:y,schema:S,seriesData:b,isClickable:Boolean(P)}),L=(0,a().O$)(t.isInPeekRendererStore);return(0,I.jsx)(fe,{timezone:u,seriesData:b||[],title:k?null==R?void 0:R.title:void 0,subtitle:k?null==R?void 0:R.subtitle:void 0,loadingProps:c,colorTheme:null==s?void 0:s.colorTheme,chartHeight:null==s?void 0:s.height,weightColorValue:null==s?void 0:s.weightColorValue,hideLegend:null==s?void 0:s.hideLegend,showCaption:null==s?void 0:s.showCaption,caption:null==s?void 0:s.caption,tooltipOptions:D,legendLabelFormatter:T,onLoadEventHandler:M,dataLabelsFormatter:V,isInPeekMode:L,onSeriesClick:P})}var Te=()=>o(975392),Ve=()=>o(162339);function Ae(e){var t;let{collectionContextStore:o,chartConfig:i,timezone:n,reducerRequestType:l,groupedChartReducer:s,aggregationChartReducer:u,resultsChartReducer:c}=e;const{reducer:d,reducerKey:g}=(0,a().K8)((()=>"groups"===l?{reducer:s,reducerKey:R().jJ}:"results"===l?{reducer:c,reducerKey:R().wh}:void(0,_().HB)(l)),[s,l,c]),p=(0,a().K8)((()=>(0,V().x)()),[]),m=(0,T().A)({id:g,reducer:d,collectionContextStore:o,debounceWait:p}),y=(0,a().O$)(o.isFullScreenStore),v=(0,r.useMemo)((()=>{var e;const t=(null==i||null===(e=i.chartFormat)||void 0===e?void 0:e.height)||M().bg.medium;return(0,M().sh)(t)}),[null==i||null===(t=i.chartFormat)||void 0===t?void 0:t.height]),f=(0,a().K8)((()=>{var e;if(void 0!==m)return;const t=o.remoteErrorStore.state;return"msg"!==(null==t?void 0:t.requestSrc)?"RequestTimeoutCancellationError"===(null==t||null===(e=t.errorBody)||void 0===e?void 0:e.name)?"queryCollection_timeout":t?"queryCollection_generic":void 0:void 0}),[o,m]),{loadingProps:x,chartConfigToDisplay:C}=function(e){let{collectionContextStore:t,chartConfig:o,chartReducerResults:i}=e;const n=(0,r.useRef)(void 0),l=(0,r.useRef)(void 0),[s,u]=(0,r.useState)(void 0),c=(0,a().K8)((()=>t.shouldShowSpinnerStore.state),[t],{useDeepEqual:!0}),d=(0,a().K8)((()=>{var e;return void 0===i||Boolean(t.lastRemoteRequestStore.state&&t.remoteRequestStore.state&&!Te().n4(null===(e=t.lastRemoteRequestStore.state.remoteRequest)||void 0===e?void 0:e.source,t.remoteRequestStore.state.source))}),[i,t]),g=(0,a().K8)((()=>t.isFullScreenStore.state),[t]);(0,r.useEffect)((()=>{n.current=o,(t.isClientModeEnabledStore.state||t.isViewSpecificClientModeEnabledStore.state)&&u(o)}),[o,t]),(0,r.useEffect)((()=>{c||(l.current=n.current)}),[c]),(0,r.useEffect)((()=>{l.current=n.current,u(n.current)}),[null==o?void 0:o.type]);const{nameProperty:p,valueProperty:h}=(0,a().K8)((()=>"results_reducer"===(null==o?void 0:o.dataConfig.type)?{nameProperty:o.dataConfig.nameProperty,valueProperty:o.dataConfig.valueProperty}:{}),[null==o?void 0:o.dataConfig]);return(0,r.useEffect)((()=>{l.current=n.current,u(n.current)}),[p,h]),(0,r.useEffect)((()=>{u(c?l.current:n.current)}),[c]),{loadingProps:{isInitialLoading:d,isThrottledLoading:(0,Ve().A)(c,200,0),initialLoadingSvg:(0,r.useCallback)((()=>(0,I.jsx)(k().z,{chartType:null==o?void 0:o.type,showCopy:g})),[null==o?void 0:o.type,g])},chartConfigToDisplay:s}}({collectionContextStore:o,chartConfig:i,chartReducerResults:m});if(f)return(0,I.jsx)(w().A,{chartError:f,collectionSettingsStore:o.settingsStore,chartType:null==i?void 0:i.type});if(C){if(i&&(0,h().m)(i)&&C&&(0,h().m)(C))return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(X,{loadingProps:x,chartConfig:C,chartReducerResults:m,collectionContextStore:o}),(0,I.jsx)(Pe,{collectionContextStore:o,chartConfig:i,chartConfigToDisplay:C,chartReducerResults:m,loadingProps:x,timezone:n,chartHeight:v,isFullScreen:y})]});if("donut"===(null==i?void 0:i.type)&&C&&"donut"===C.type)return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(X,{loadingProps:x,chartConfig:C,chartReducerResults:m,collectionContextStore:o}),(0,I.jsx)(De,{collectionContextStore:o,chartConfig:i,chartConfigToDisplay:C,chartReducerResults:m,timezone:n,loadingProps:x,aggregationChartReducer:u,chartHeight:v,isFullScreen:y})]})}return(0,I.jsx)("div",{style:{height:v,width:"100%"},children:(0,I.jsx)(k().z,{chartType:null==i?void 0:i.type,showCopy:y})})}function Pe(e){let{collectionContextStore:t,chartConfig:o,chartConfigToDisplay:r,chartReducerResults:i,timezone:a,loadingProps:n,chartHeight:l,isFullScreen:s}=e;if(o&&(0,h().m)(o)&&r&&(0,h().m)(r)){if("groups_reducer"===r.dataConfig.type&&(void 0===i||"groups"===(null==i?void 0:i.type)))return(0,I.jsx)(ye,{loadingProps:n,timezone:a,groupedDataConfig:r.dataConfig,chartFormat:o.chartFormat,collectionContextStore:t,groupedChartReducerResults:i,axisType:o.type});if("results_reducer"===r.dataConfig.type&&(void 0===i||"results"===(null==i?void 0:i.type)))return(0,I.jsx)(Me,{loadingProps:n,timezone:a,resultsDataConfig:r.dataConfig,chartFormat:o.chartFormat,collectionContextStore:t,resultsChartReducerResults:i,axisType:o.type})}return(0,I.jsx)("div",{style:{height:l,width:"100%"},children:(0,I.jsx)(k().z,{chartType:null==o?void 0:o.type,showCopy:s})})}function De(e){let{collectionContextStore:t,chartConfig:o,chartConfigToDisplay:r,chartReducerResults:i,timezone:n,loadingProps:l,aggregationChartReducer:s,chartHeight:u,isFullScreen:c}=e;const d=(0,a().K8)((()=>(0,V().x)()),[]),g=(0,T().A)({id:R().nb,reducer:s,collectionContextStore:t,debounceWait:d});return"groups_reducer"!==r.dataConfig.type||void 0!==i&&"groups"!==(null==i?void 0:i.type)?"results_reducer"!==r.dataConfig.type||void 0!==i&&"results"!==(null==i?void 0:i.type)?(0,I.jsx)("div",{style:{height:u,width:"100%"},children:(0,I.jsx)(k().z,{chartType:null==o?void 0:o.type,showCopy:c})}):(0,I.jsx)(_e,{loadingProps:l,timezone:n,resultsDataConfig:r.dataConfig,chartFormat:o.chartFormat,collectionContextStore:t,resultsChartReducerResults:i,aggregationChartReducerResults:g}):(0,I.jsx)(Re,{loadingProps:l,timezone:n,groupedDataConfig:r.dataConfig,chartFormat:o.chartFormat,collectionContextStore:t,groupedChartReducerResults:i,aggregationChartReducerResults:g})}function Be(e){const{collectionContextStore:t,isPreviewing:o,paddingLeft:r,paddingRight:R,headingWidth:M=0}=e,_=(0,i().v3)(),{isMobile:T}=_.device,{collectionViewBlockStore:V,collectionSettingsStore:A,collectionViewStore:P,chartErrorStore:D}=(0,a().K8)((()=>({collectionViewBlockStore:t.collectionViewBlockStore(),collectionSettingsStore:t.settingsStore,collectionViewStore:t.collectionViewStore(),chartErrorStore:t.chartErrorStore})),[t]),B=(0,a().O$)(t.isFullScreenStore),L=(0,a().O$)(t.isInHomeWidgetStore),F=(0,a().K8)((()=>Boolean(t.viewsModuleContextStore.getViewModuleType())),[t]),j=(0,a().K8)((()=>V&&x().A.isBlockInTemplate(V)),[V]),K=(0,a().O$)(t.normalizedFormatStore),O=(0,a().K8)((()=>K.chart_config),[K]),z=(0,a().K8)((()=>{var e;return(null==P?void 0:P.id)&&(null===(e=t.updateFreeChartsResultStore.state.get(P.id))||void 0===e?void 0:e.isPending)}),[t.updateFreeChartsResultStore,P]),{canViewChart:E,canViewChartError:G}=(0,s().f)({collectionContextStore:t}),N=(0,a().K8)((()=>{if(!S().A.state.online)return"offline";const e=(0,n().ye)({chartConfig:O,collectionSchema:t.normalizedSchemaStore.state});if(void 0!==e)return e;const o=P?D.getState().get(P.id):void 0;if(void 0!==o)return o;let r;return j||!G&&E||(r=G??"paywall"),r}),[O,D,t.normalizedSchemaStore,P,E,G,j],{useDeepEqual:!0}),H=(0,a().K8)((()=>"sidebar"===(0,f().DN)(t,T,M)&&A.state.open),[t,A,M,T]),q=(0,a().K8)((()=>{var e;return(null===(e=C().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettingsStore().getKeyStore("time_zone").getValue())||(0,l().P)()}),[]),$=(0,p().x)({chartConfig:O,chartError:N,collectionContextStore:t}),W=function(e){let{chartConfig:t,chartError:o}=e;return(0,a().K8)((()=>{var e,r;if((!o||(0,n().xG)(o))&&t&&"placeholder"!==t.type)if("groups_reducer"===(null===(e=t.dataConfig)||void 0===e?void 0:e.type)){const e=(0,g().p7)(t);if(e)return{type:"aggregation",aggregation:e}}else if("results_reducer"===(null===(r=t.dataConfig)||void 0===r?void 0:r.type))return{type:"aggregation",aggregation:{aggregator:"sum",property:t.dataConfig.valueProperty}}}),[t,o],{useDeepEqual:!0})}({chartConfig:O,chartError:N}),Y=function(e){let{chartConfig:t,chartError:o,collectionContextStore:r}=e;const i=(0,a().K8)((()=>{var e;const o=(0,y().N1)({collectionContextStore:r,applySubitemFilter:!1,filterOutHideSubitemsQuickFilter:!1}),i=t&&(0,h().m)(t)?null===(e=t.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups:void 0,a=t&&(0,h().m)(t)&&"results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:void 0;if(i&&a){const e={property:a,filter:{operator:"is_not_empty"}},t={property:a,filter:{operator:"number_does_not_equal",value:{type:"exact",value:0}}};o.push(e,t)}return(0,m().GV)(o)}),[r,t]),l=(0,a().K8)((()=>(0,v().dP)()),[]);return(0,a().K8)((()=>{if((!o||(0,n().xG)(o))&&t&&"placeholder"!==t.type&&"results_reducer"===t.dataConfig.type)return{type:"results",limit:l,filter:i}}),[o,t,i,l],{useDeepEqual:!0})}({chartConfig:O,chartError:N,collectionContextStore:t}),X=(0,a().K8)((()=>{var e,o;if(O&&"placeholder"!==O.type&&W)return"groups_reducer"===(null==O||null===(e=O.dataConfig)||void 0===e?void 0:e.type)&&$?{reducerRequestType:"groups",groupedChartReducer:$,aggregationChartReducer:W,collectionContextStore:t,chartConfig:O,timezone:q}:"results_reducer"===(null==O||null===(o=O.dataConfig)||void 0===o?void 0:o.type)&&Y?{reducerRequestType:"results",resultsChartReducer:Y,aggregationChartReducer:W,collectionContextStore:t,chartConfig:O,timezone:q}:void 0}),[O,t,$,W,Y,q]),U=(0,d().Zp)();if(!V)return null;let Q;return Q=N&&!(0,n().xG)(N)?"paywall"!==N||!z&&void 0!==E?(0,I.jsx)(w().A,{chartError:N,collectionSettingsStore:t.settingsStore,chartType:null==O?void 0:O.type}):(0,I.jsx)(k().z,{chartType:null==O?void 0:O.type,showCopy:B}):O&&"placeholder"!==O.type&&X?(0,I.jsx)(Ae,{...X}):(0,I.jsx)(w().A,{chartError:O?"data_model_invalid":"chart_config_not_found",collectionSettingsStore:t.settingsStore,chartType:null==O?void 0:O.type}),(0,I.jsx)("div",{style:{paddingLeft:r,paddingRight:R,paddingTop:15},children:(0,I.jsx)(b().A,{store:V,shouldShowHalo:!B&&!L&&!o,canSelect:!B&&!F,disablePointerEvents:null==U?void 0:U.disableAllPointerEvents,analyticsName:"chart",children:(0,I.jsx)(c().A,{animate:{width:H?`calc(100% - ${u().vE}px)`:"100%"},children:Q})})})}},87797:(e,t,o)=>{o.d(t,{Sp:()=>w,sw:()=>k,Iz:()=>R});var r=()=>o(712437),i=()=>o(716605),a=()=>o(10895),n=()=>o(541543),l=()=>o(163182),s=()=>o(137476),u=()=>o(876695),c=(o(725707),o(491955),()=>o(571785)),d=()=>o(768022),g=()=>o(15552),p=()=>o(502140),h=()=>o(427091),m=()=>o(3311),y=()=>o(348124);var v=()=>o(569555),f=()=>o(29869),x=()=>o(502852),C=()=>o(413871),S=()=>o(759625),b=()=>o(865226);function w(e){const{chartConfig:t,collectionViewBlockStore:o,format:r,dataPoint:a,clickEvent:n,schema:f,environment:C,collectionContextStore:S,intl:b,query2:w,temporaryViewState:k}=e;if(!o||"groups_reducer"!==(null==t?void 0:t.dataConfig.type))return;(0,x().SQ)({event:n,context:x().y$.EditorClick});const R=function(e){const{dataPoint:t,propertySchema:o,groupByFormat:r,aggregation:i,intl:a}=e,n=t.name??t.x.toString();if(!o)return n;return(0,v().w$)({propertySchema:o,groupByFormat:r,aggregation:i,highChartsLabel:n,intl:a})}({dataPoint:a,propertySchema:(0,i()._g)({schema:f,property:t.dataConfig.groupBy.property}),groupByFormat:null==t?void 0:t.dataConfig.groupBy,aggregation:null==t?void 0:t.dataConfig.aggregationConfig.aggregation,intl:b}),M=function(e){var t,o;const{chartConfig:r,dataPoint:i,format:a,schema:n,collectionViewBlockStore:l,query2:s,temporaryViewState:u}=e;if(!(r&&"placeholder"!==r.type&&"results_reducer"!==r.dataConfig.type&&r.dataConfig.groupBy&&i&&l&&l.pointer.spaceId))return void p().log({level:"error",from:"chartDrilldownHelpers",type:"chartDrilldownMissingRequiredData",error:{name:"chartDrilldownHelpers",message:"Unexpected error"},data:{miscDataToConvertToString:{chartConfig:r,dataPoint:i,collectionViewBlockStore:l}}});const v=r.dataConfig.groupBy.property,f=(0,y().Q)(l,v),x={type:"table",parent_id:l.pointer.id,parent_table:l.pointer.table,alive:!0,space_id:l.pointer.spaceId,format:{is_unlisted:!0,collection_pointer:null==a?void 0:a.collection_pointer,property_filters:(null==u||null===(t=u.propertyFilters)||void 0===t?void 0:t.value)??(null==a?void 0:a.property_filters),table_properties:f},query2:{...s,filter:(null==u||null===(o=u.combinatorFilter)||void 0===o?void 0:o.value)??(null==s?void 0:s.filter)}};let C;var S;return i.groupFormat&&(C=(0,d().K8)({schema:n,propertyMapping:void 0,groupBy:r.dataConfig.groupBy,group:i.groupFormat,timeZone:(0,h().P)()})),C&&((0,g().dU)(C)?null!==(S=x.query2)&&void 0!==S&&S.filter?x.query2.filter=(0,g().GV)([x.query2.filter,C]):x.query2.filter=C:(0,g().yX)(C)&&(x.format.property_filters=[...x.format.property_filters??[],{filter:C,id:(0,m().Ay)()}])),"groups_reducer"===r.dataConfig.type&&(0,c().m)(r)&&r.dataConfig.aggregationConfig.stackOptions&&(x.format.collection_group_by=function(e){var t;if(null===(t=e.aggregationConfig)||void 0===t||!t.stackOptions)return;const o=e.aggregationConfig.stackOptions.groupBy;return o.hideEmptyGroups=!0,o}(r.dataConfig)),x}({chartConfig:t,format:r,dataPoint:a,schema:f,collectionViewBlockStore:o,query2:w,temporaryViewState:k});if(!M)return;const _=(0,u().sl)(S);(0,s().u4)({environment:C,event:{eventName:"collection_chart_drilldown_click",eventProperties:{..._,drilldown_type:"grouped",from:"chart_data_point"}}}),l().S.openCollectionDrilldownView({collectionViewValue:M,collectionViewBlockStore:o,viewsModuleContext:S.viewsModuleContextStore.state,title:R})}function k(e){var t;const{collectionStore:o,dataPoint:i,clickEvent:a,environment:n,collectionContextStore:l}=e;if(null==i||null===(t=i.pagePointer)||void 0===t||!t.id||!o)return;(0,x().SQ)({event:a,context:x().y$.EditorClick});const c=C().Bv.createChildStore(o,i.pagePointer),d=(0,f().Ay)({store:c,fullyQualified:!1,pageVisitSource:r().y8.Expand,showMoveTo:!1,openInCenterPeek:!0});if(!d)return;const g=(0,u().sl)(l);(0,s().u4)({environment:n,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...g,drilldown_type:"results",from:"chart_data_point"}}}),b().oo({environment:n,url:d})}async function R(e){const{environment:t,collectionViewStore:o,collectionViewBlockStore:r,collectionContextStore:i,acceptMoveToArgs:l,transaction:c,intl:d}=e;if(!o)return;const g=r.getCollectionPointer(),p=S().Wv({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,type:"collection_view",transaction:c}),h=(0,n().t)({environment:t,transaction:c,collectionViewStore:o,collectionViewBlockStore:p,intl:d,copyNameExactly:!0});if(!h)return;h.getFormatStore().getKeyValue("collection_pointer")||S().zv({store:h.getFormatStore().getKeyStore("collection_pointer"),data:g,transaction:c}),S().zv({store:h.getFormatStore(),data:{is_unlisted:null},transaction:c}),await a().Ju({...l,targets:[p],transaction:c});const m=(0,u().sl)(i);return(0,s().u4)({environment:t,event:{eventName:"collection_chart_drilldown_save",eventProperties:{...m,new_collection_view_block_id:p.pointer.id}}}),p}},496794:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var r=o(163643);const i=function(e){const{title:t,href:i,analyticsFrom:a}=e,n=(0,o(237385).v3)();return(0,r.jsx)(o(579494).A,{href:i,onClick:()=>o(598995).FH(n,{from:a}),external:!0,children:(0,r.jsx)(o(44405).A,{icon:o(155342).questionMarkCircleIcon,title:t,isGray:!0})})}},573520:(e,t,o)=>{o.d(t,{h:()=>i});o(242343);var r=o(163643);const i=(0,o(680369).wt)("eye",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},637558:(e,t,o)=>{o.d(t,{A:()=>g});o(725707),o(500234),o(403517);var r=o(242343),i=()=>o(803290),a=()=>o(975392),n=()=>o(273520),l=()=>o(858023),s=()=>o(443252),u=()=>o(88271),c=()=>o(640979),d=o(163643);const g=function(e){let{icon:t,iconStyle:g,title:p,selectedKey:h,onChange:m,onClick:y,popupStyle:v,menuItemOptionsStyle:f,menuStyle:x,disabled:C,collectionContextStore:S,openButtonPopup:b,hideCheck:w,children:k,disableParentClose:R,inputPlaceholder:M,..._}=e;const T=(0,o(237385).Y0)(),V="options"in _?_.options:a().Bq(_.sections),A=V.find((e=>a().n4(e.key,h))),P=(0,i().uB)(void 0,o(962373).A),D=(0,i().O$)(P);return(0,r.useEffect)((()=>{S&&b&&(P.setState({...P.state,open:b}),S.settingsStore.setState({...S.settingsStore.state,openButtonPopup:void 0})),A||o(502140).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,o(450475).convertErrorToLog)("Selected key is invalid.")})})),(0,d.jsx)(n().Ay,{popupType:T.isMobile?s().nl.SlideUp:s().nl.Popup,alignmentToOrigin:n().yP.End,placementToOrigin:n().sx.Bottom,style:v,originGap:0,buttonPopupStore:P,disabled:C,onClick:y,renderOrigin:e=>(0,d.jsx)(o(44405).A,{title:p,showChevron:!0,right:(0,d.jsx)("span",{style:o(31448).RC,children:"input"===(null==A?void 0:A.type)?A.inputValue:null==A?void 0:A.title}),rotateChevron:D.open,disabled:C,icon:t,iconStyle:g,...(0,o(906230).A)(e,_)}),render:e=>{let t;t=T.isMobile?{menuType:c().gu.ActionSheet}:{menuType:c().gu.Popup,width:250,...x};const r=(t,r)=>{if(t.hideOption)return null;let i;return i="input"===t.type?{key:r,render:r=>(0,d.jsx)(o(401382).Ay,{...r,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var o;null===(o=t.onChange)||void 0===o||o.call(t,e.target.value)},onSubmit:o=>{var r;null===(r=t.onSubmit)||void 0===r||r.call(t,t.key,e,t.inputValue),e.close()},placeholder:M,isChecked:!w&&a().n4(t.key,h)}),action:()=>{}}:{key:r,render:e=>(0,d.jsx)(o(535906).A,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:f,isChecked:!w&&a().n4(t.key,h)}),action:()=>{m(t.key,e),R||e.close()}},i},i="sections"in _?_.sections.map(((e,t)=>({key:t,render:e=>(0,d.jsx)(u().A,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:a().oE(e.map(r))}))):[{key:0,render:e=>(0,d.jsx)(u().A,{enableActionSheetTitle:!0,...e}),items:a().oE(V.map(r))}];return(0,d.jsxs)(o(935091).A,{...t,children:[(0,d.jsx)(l().Ay,{type:l().Oh.Vertical,sections:i,initialFocus:0,resetFocusOnMouseOut:!0}),k||null]})}})}},750522:(e,t,o)=>{o.r(t),o.d(t,{DonutChart:()=>f});o(362833),o(725707),o(491955);var r=o(242343),i=()=>o(174114),a=()=>o(877905),n=()=>o(880395),l=()=>o(653998),s=()=>o(975392),u=()=>o(76394),c=()=>o(31448),d=()=>o(114636),g=()=>o(820745),p=()=>o(661317),h=()=>o(545851),m=()=>o(895619),y=o(163643);const v=14;function f(e){const t=(0,l().tz)(),o=(0,i().DP)(),f=e.chartHeight||a().bg.medium,R=e.seriesData.length>0&&e.seriesData[0].data.length>0,M=r.useMemo((()=>R?e.seriesData:[{name:"No data",data:[]}]),[R,e.seriesData]),_=(0,r.useMemo)((()=>(0,g().wW)(e.colorTheme||"auto",Boolean(e.weightColorValue),o)),[e.colorTheme,e.weightColorValue,o]),T=(0,r.useMemo)((()=>(0,a().sh)(f)),[f]),V=e.dataLabelsFormatter?.9:1,A=(T-160)*V,P=(0,r.useMemo)((()=>{const r=e.showCaption?(0,p().I)(e.caption):"";return s().h1((0,h().A)(o),{chart:{type:"pie",height:T,events:{render:function(){const r=this,i=r.container;if(i)if(R){if(e.title){var a;const e=r.title.getBBox();null===(a=r.title)||void 0===a||a.attr({y:v+r.plotTop+(r.plotHeight-e.height)/2})}}else(0,p().h)({intl:t,theme:o,chartType:"donut",container:i,hasData:R,hasBadYAxisRange:!1,isInPeekMode:Boolean(e.isInPeekMode)})},load:e.onLoadEventHandler}},time:{timezone:e.timezone},title:{useHTML:!0,floating:!0,text:void 0},series:M,..._,plotOptions:{pie:{size:A,innerSize:f===a().bg.small||f===a().bg.medium?"85%":"90%",showInLegend:!e.hideLegend,color:R?void 0:"transparent",fillColor:R?"transparent":o.tableDividerColor,states:{inactive:{opacity:1}},dataLabels:{enabled:!!e.dataLabelsFormatter,formatter:e.dataLabelsFormatter}},series:{cursor:e.onSeriesClick?"pointer":void 0,point:{events:{click:function(t){if(e.onSeriesClick){const o=(0,d().V)(e.seriesData,this.x);if(!o)return;e.onSeriesClick(o,t)}}}},marker:{enabled:!1},states:{hover:{halo:null}}}},legend:{enabled:!e.hideLegend,labelFormatter:function(){if(e.legendLabelFormatter){const t=this.index,o=M.length>0?M[0].data[t]:void 0;return e.legendLabelFormatter(this.name,o)}return this.name}},caption:{text:r},tooltip:{...e.tooltipOptions},responsive:{rules:x(A,f)}})}),[e,o,T,M,_,A,f,R,t]),D=(0,i().IS)((e=>({titleStyle:{fontWeight:500,color:e.text.primary,textAlign:"center"},subtitleStyle:{color:e.text.secondary,fontWeight:400,lineHeight:"15px",textAlign:"center",...c().RC}})),[]),B=r.useCallback(((t,o)=>{const r=o||f,i=function(e,t,o){const r=(e||"").split("").filter((e=>","!==e&&"."!==e)),i=5*r.length;if(t&&C(t,o)){const e=t/5-i;return o===a().bg.small||o===a().bg.medium?Math.max(e,S):Math.max(e,b)}if(o===a().bg.extra_large){const e=108-i;return Math.max(e,k)}if(o===a().bg.large){const e=84-i;return Math.max(e,w)}if(o===a().bg.medium){const e=72-i;return Math.max(e,b)}{const e=48-i;return Math.max(e,S)}}(e.title,t,r),l=function(e){if(!e||e===a().bg.small||e===a().bg.medium)return 12;if(e===a().bg.large)return 14;if(e===a().bg.extra_large)return 16;(0,u().HB)(e)}(r),s=function(e,t){if(e&&C(e,t))return.5*e;return t===a().bg.extra_large?400:t===a().bg.large?250:t===a().bg.medium?150:80}(t,r),c=t??200,d=c<50?"":n().A.renderToStaticMarkup((0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,y.jsx)("div",{style:{...D.titleStyle,fontSize:i,lineHeight:`${i+13}px`,maxWidth:s},children:e.title}),e.subtitle&&c>=200?(0,y.jsx)("div",{style:{...D.subtitleStyle,fontSize:l,lineHeight:`${l+3}px`,maxWidth:s},children:e.subtitle}):null]}));return{title:{useHTML:!0,floating:!0,text:R?d:""}}}),[f,e.title,e.subtitle,D.titleStyle,D.subtitleStyle,R]);return(0,y.jsx)(m().A,{loadingProps:e.loadingProps,chartOptions:P,containerHeight:T,getResponsiveChartOptions:B})}function x(e,t){const o=[];return t!==a().bg.extra_large&&t!==a().bg.large||o.push({condition:{maxWidth:e},chartOptions:{plotOptions:{pie:{size:void 0}}}}),o.push({condition:{maxWidth:(0,a().I9)(t)},chartOptions:{plotOptions:{pie:{size:"75%"}}}}),o}function C(e,t){return t===a().bg.extra_large?e-180<(0,a().I9)(t):t===a().bg.large?e-100<(0,a().I9)(t):e<(0,a().I9)(t)}const S=8,b=12,w=18,k=24}}]);