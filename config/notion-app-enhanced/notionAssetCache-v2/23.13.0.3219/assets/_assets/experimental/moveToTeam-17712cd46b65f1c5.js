"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[4876,5834,90871,99171],{41429:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>C,transformBlocks:()=>y,transformIntoColumnList:()=>T});n(403517);var o=()=>n(752597),r=()=>n(762847),c=()=>n(145017),i=()=>n(975392),a=()=>n(551102),s=()=>n(795394),l=()=>n(900635),d=()=>n(759625),u=()=>n(164186),m=()=>n(360378),p=()=>n(384221),v=()=>n(84543),f=()=>n(868068),S=()=>n(189170),k=()=>n(754697),b=()=>n(360482),g=()=>n(836331),I=()=>n(413871),h=()=>n(837694);function y(e){const{environment:t,blocks:n,blockType:h,transaction:y}=e;if(h!==r().xd.transclusionContainer)if(h===r().xd.callout&&g().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const a=i.getRecordStoreUIParent();if(!a||!(0,b().iU)(a))return;const u=a.getRecordStoreUIParent();if(!(u&&u instanceof I().Bv))return;const v=(0,k().Z1)({environment:t,table:c().ev,spaceId:u.getSpaceId()}),f=d().Wv({environment:t,id:v,type:r().xd.callout,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:u.getSpaceId(),format:{callout_version:2}});s().NI({parentStore:a,childStore:f,after:i.id,transaction:o});B({newParentStore:f.getContentStore(),blocks:n,transaction:o}),l().s4({store:f,transaction:o}),p().clear({environment:t}),m().IU({environment:t}),m().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:y});else if(h!==r().xd.columnList)if(h!==r().xd.slide)if((0,r().ZK)(h)){const e=parseInt(h.replace("column","").replace("block","")),r=i().oE(i().Hn(e-1,(()=>S().insertTextBelow({environment:t,blocks:n,transaction:y})))),c=[...n,...r],a=T({environment:t,blocks:c,transaction:y});o().default.afterNextFlush((()=>{p().setSelectionAtStart({store:a[0].getBlockTitleStore()})}))}else for(const r of n)if(r.isCalloutV2()){const e=r.getParentBlockStore();if(e){const c=r.getContentStores();v().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:c.map((e=>e.id)),after:r.id}},transaction:y}),s().zz({parentStore:e.getContentStore(),childStore:r,transaction:y});for(const e of c)f().pd({environment:t,block:e,blockType:h,transaction:y,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{u().dL(t,c.map((e=>e.id)))}))}}else f().pd({environment:t,block:r,blockType:h,transaction:y,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const a=i.getRecordStoreUIParent();if(!a||!(0,b().iU)(a))return;const l=a.getRecordStoreUIParent();if(!(l&&l instanceof I().Bv))return;const u=(0,k().Z1)({environment:t,table:c().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:u,type:r().xd.slide,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});s().NI({parentStore:a,childStore:v,after:i.id,transaction:o});B({newParentStore:v.getContentStore(),blocks:n,transaction:o}),p().clear({environment:t}),m().IU({environment:t}),m().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:y});else T({environment:t,blocks:n,transaction:y});else!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const s=i.getRecordStoreUIParent();if(!s||!(0,b().iU)(s))return;const l=s.getRecordStoreUIParent();if(!l||!(0,b()._p)(l))return;if(!l.isDefined())return;const u=(0,k().Z1)({environment:t,table:c().ev,spaceId:l.getSpaceId()}),v=d().Wv({environment:t,id:u,type:r().xd.transclusionContainer,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId()});a().WH({parentStore:s,insertStore:v,afterStore:i,transaction:o});B({newParentStore:v.getContentStore(),blocks:n,transaction:o}),p().clear({environment:t}),m().IU({environment:t}),m().td({environment:t,stores:[v]})}({environment:t,blocks:n,transaction:y})}function C(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&y({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}function T(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return[];const s=i.recordStoreUIParentStore;if(null==s||!s.valueIs(h()._))return[];const l=(0,k().Z1)({environment:t,table:c().ev,spaceId:i.getSpaceId()}),u=d().Wv({environment:t,id:l,type:r().xd.columnList,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId()}),{childStore:m}=a().nc({parentStore:s,insertStore:u,beforeStore:i,transaction:o});return n.map((e=>{const n=(0,k().Z1)({environment:t,table:c().ev,spaceId:i.getSpaceId()}),l=d().Wv({environment:t,id:n,type:r().xd.column,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId()}),{childStore:u}=a().TF({parentStore:s,childToRemoveStore:e,transaction:o}),{childStore:p}=a().WH({parentStore:m.getContentStore(),insertStore:l,transaction:o}),{childStore:v}=a().WH({parentStore:p.getContentStore(),insertStore:u,transaction:o});return v}))}function B(e){const{newParentStore:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(h()._)&&(a().TF({parentStore:e,childToRemoveStore:r,transaction:o}),a().BC({parentStore:t,appendStore:r,transaction:o}))}}},44250:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function r(e){if(!e||!("askUserToPick"in e))return e}function c(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>r,K$:()=>o,j6:()=>c})},189170:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>w,duplicateBlocksWithMaybeConfirmation:()=>x,insertBlockAbove:()=>_,insertBlockAndEdit:()=>U,insertBlockBelow:()=>R,insertTextAbove:()=>F,insertTextBelow:()=>P});n(358848),n(362833),n(91270);var o=()=>n(752597),r=()=>n(214144),c=()=>n(66460),i=()=>n(975392),a=()=>n(303298),s=()=>n(577701),l=()=>n(983048),d=()=>n(415029),u=()=>n(145046),m=()=>n(111066),p=()=>n(164186),v=()=>n(84543),f=()=>n(732491),S=()=>n(190717),k=()=>n(486963),b=()=>n(590057),g=()=>n(981810),I=()=>n(459742),h=()=>n(816763),y=()=>n(112892),C=()=>n(615661),T=()=>n(182613),B=()=>n(937968);async function x(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:r,callback:c}=e;if(!(0,B().EF)(t))return;const i=await a().VI.duplicateActions.load();let s=n;if(1===n.length){const e=await S().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==c||c());s=e}const d=s.at(0);if(!d)return;const u=(0,k().U)(d);if(u&&(0,g().ls)(d,u))await l().un({blocks:s,environment:t,analyticsFrom:"subitem_duplication",callback:c,collectionContextStore:u});else{const{serverCommitResult:e}=v().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{w({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:r,duplicateActions:i})},transactionTooBigFallback:e=>{w({environment:t,blocks:s,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:r,duplicateActions:i})}});e.then(c)}o().default.afterNextFlush((()=>{m().BM({environment:t})}))}function w(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:r,lastTopLevelBlockStore:a,preventSetSelection:l,duplicateOnlyCollectionSchema:d,duplicateActions:m}=e,v=i().$z(n,(e=>e.getFormat().app_id??e.id)),f=[];return i().jJ(v,(e=>{const n=e[0],i=!n.isTransclusionType(),{blockStores:a,onComplete:l}=m.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:(0,c().e)(n.pointer.spaceId),preferDuplicateLocation:r,options:{addCopyName:(0,h().A)(n),deepCopyTransclusionContainers:i,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),duplicateOnlyCollectionSchema:d}});f.push(...a),l.then((e=>{if("error"===e.status){const n=e.error;s().Rk(n)?s().UK(t,{product:n.clientData.metadata.product}):u().f1(e.errorMessage)}}))})),p().LE({blocksToInsert:f,target:a?[a]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:l}),f}function R(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:c,preventSetSelection:i}=e,a=T().default.getCurrentRecordCache(),s=new(f().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let l;if((0,B().EF)(t)&&n&&a){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:a,from:c,selection:o});s.track(e.pointer,r),l=p().LE({environment:t,blocksToInsert:[e],target:o,transaction:r,replaceEmptyTextBlock:!1,preventSetSelection:i})[0]}else s.fail("invalid_state");return l}function _(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:c,preventSetSelection:i}=e,a=T().default.getCurrentRecordCache();let s;if((0,B().EF)(t)&&n&&a){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:a,from:c,selection:o});s=p().t1({environment:t,blocks:[e],selection:o,transaction:r,preventSetSelection:i})[0]}return s}function U(e){const{environment:t,selection:n,transaction:o}=e,c=R({...e,preventSetSelection:!0});if(c){var i;p().x5({environment:t,insertedStores:[c],isCreated:!0});const e=C().Uv.getMode(c);if("suggest"===e){const e=b().RR(t,o,c);b().tM(o,c,{id:r().JW(),type:"insert",discussionId:e.id}),b().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[c.id]})}"suggest"===e&&null!==(i=c.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==i&&i.isCommentOnly()||p().um({transaction:o,blocks:n})}return c}function P(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:c}=e,i=c?void 0:"text_insert_below",a=R({environment:r,selection:t,createBlockItem:I().ry.text,analyticsFrom:i,transaction:n});return a&&o().default.afterNextFlush((()=>{y().zz({environment:r,blockStore:a,insertedTextBlockLocation:"below"})})),a}function F(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:c}=e,i=c?void 0:"text_insert_below",a=_({environment:r,selection:t,createBlockItem:I().ry.text,analyticsFrom:i,transaction:n});return a&&o().default.afterNextFlush((()=>{y().zz({environment:r,blockStore:a,insertedTextBlockLocation:"above"})})),a}},533639:(e,t,n)=>{n.d(t,{p:()=>o});class o extends(()=>n(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},802789:(e,t,n)=>{n.r(t),n.d(t,{moveToTeamImpl:()=>s});var o=()=>n(975392),r=()=>n(76394),c=()=>n(795394),i=()=>n(578553),a=()=>n(41429);function s(e){let{transaction:t,currentSpaceViewStore:n,teamStore:s,targets:l,location:d,environment:u}=e;const m=n.getTeamsStores(),p=s.getTeamPagesStore();a().maybeTurnCollectionViewIntoCollectionViewPage({environment:u,blocks:l,transaction:t});for(const a of l){const e=o().I6(m,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(a.id)}));(null==e?void 0:e.id)!==s.id&&("append"===d.type?c().NI({parentStore:p,childStore:a,after:d.after,transaction:t}):"prepend"===d.type?c().Ti({parentStore:p,childStore:a,before:d.before,transaction:t}):(0,r().HB)(d),e&&i().Ex({teamStore:e,store:a,transaction:t}))}return s}},994488:(e,t,n)=>{n.d(t,{o:()=>o});n(362833),n(403517);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return e.map((e=>[e]));const c=[];for(const i of e)c.push(...o(n[0],...n.slice(1)).map((e=>[i,...e])));return c}}}]);