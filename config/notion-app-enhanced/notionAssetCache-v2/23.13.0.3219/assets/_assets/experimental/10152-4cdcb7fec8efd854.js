"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10152],{34982:(e,t,o)=>{o.d(t,{V:()=>m,r:()=>g});o(725707),o(491955),o(500234),o(403517);var n=()=>o(572589),r=()=>o(975392),i=()=>o(401857),l=()=>o(477784),a=()=>o(236339),s=()=>o(145046),u=()=>o(84543),c=()=>o(668639),d=()=>o(640390),p=()=>o(304047);function g(e){const{environment:t,collectionContextStore:o,isHidden:g,groupByKey:m,groupsFormatKey:y,currentGroups:v,newGroupIds:f}=e,h=(0,n().H2)(o.normalizedFormatStore.state,m,y),S=h?(0,n().Kq)(h):void 0,C=v.filter((e=>f.indexOf((0,n().Ix)(e))<0)),x=v.filter((e=>f.indexOf((0,n().Ix)(e))>=0)),b=r().Ul(x,(e=>{const t=f.indexOf((0,n().Ix)(e));return t>=0?t:1/0})),A=g?[...C,...b]:[...b,...C];u().createAndCommit({userAction:`collectionGroupActions.handleGroupReorder#${y}`,environment:t,canUndo:!0,perform:e=>{(0,c().y)({sortType:"manual",environment:t,collectionContextStore:o,groupByKey:m,groupsFormatKey:y,transaction:e}),(0,p().o)({collectionContextStore:o,newGroups:A,groupsFormatKey:y,transaction:e})}});const j="board_columns"===y?g?"board_reorder_hidden_groups":"board_reorder_groups":g?"reorder_hidden_groups":"reorder_groups";(0,a().X)({environment:t,collectionContextStore:o,action:j}),h&&S&&function(e){const{environment:t,collectionContextStore:o,groupByKey:n,groupsFormatKey:r,previousGroupBy:a,previousSortType:p}=e;"manual"!==p&&s().ui({message:l().A.formatMessage(d().D.removeGroupSortingConfirmation,{sortType:l().A.formatMessage((0,i().rA)(a,p))}),items:[{label:l().A.formatMessage(d().D.removeGroupSortingButton),color:"red",onAccept:()=>{}},{label:l().A.formatMessage(d().D.removeGroupSortingCancel),onAccept:()=>{u().createAndCommit({userAction:"collectionGroupActions.offerToRemoveGroupSort",environment:t,canUndo:!0,perform:e=>{(0,c().y)({environment:t,collectionContextStore:o,transaction:e,groupByKey:n,groupsFormatKey:r,sortType:p})}})}}],showCancel:!1,keepFocus:!0})}({environment:t,collectionContextStore:o,groupByKey:m,groupsFormatKey:y,previousGroupBy:h,previousSortType:S.type})}function m(e){var t;const{environment:o,collectionContextStore:i,groupByKey:l,groupsFormatKey:s,currentGroups:d,newGroupIds:g,containsAllGroups:m}=e;let y=(null===(t=i.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(s).getValue())??[];y=y.map((e=>{const t={...e};return delete t.emptyHidden,t}));let v=d||y;m||(v=0===y.length?d:y);let f=r().Ul(v,(e=>{const t=g.indexOf((0,n().Ix)(e));return t>=0?t:1/0}));f=f.map((e=>y.find((t=>(0,n().Mn)(e,t)))??e));const[h,S]=r().jB(f,(e=>!e.hidden)),C=[...h,...S];u().createAndCommit({userAction:`collectionGroupActions.handleGroupReorder#${s}`,environment:o,canUndo:!0,perform:e=>{(0,c().y)({sortType:"manual",environment:o,collectionContextStore:i,groupByKey:l,groupsFormatKey:s,transaction:e}),(0,p().o)({collectionContextStore:i,newGroups:C,groupsFormatKey:s,transaction:e})}});let x="reorder_groups";"board_columns"===s?x="board_reorder_groups":"chart_subgroups"===s&&(x="chart_reorder_groups"),(0,a().X)({environment:o,collectionContextStore:i,action:x})}},40516:(e,t,o)=>{o.d(t,{S:()=>r});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M6.328 3c0-.18.145-.325.325-.325h6.694c.18 0 .325.146.325.325v.474c0 .948-.404 1.85-1.112 2.481l-.402.36.19 1.944.039.013a4.325 4.325 0 0 1 2.938 4.097V13c0 .18-.145.325-.325.325h-4.17v3.38a1.1 1.1 0 0 1-.1.46l-.44.956-.063.087a.35.35 0 0 1-.564-.103l-.432-.94a1.1 1.1 0 0 1-.1-.46v-3.38H5A.325.325 0 0 1 4.675 13v-.63a4.325 4.325 0 0 1 2.938-4.098l.039-.013.19-1.945-.402-.359a3.33 3.33 0 0 1-1.112-2.481z"})},r=(0,o(680369).wt)("pinFill",n)},68486:(e,t,o)=>{o.d(t,{I:()=>l});o(403517);var n=()=>o(975392),r=()=>o(84543),i=()=>o(107805);function l(e){const{collectionContextStore:t,environment:o,query:l,property:a,newAggregation:s}=e,u=t.collectionViewStore();if(!u)return;let c=l.aggregations?[...l.aggregations]:[];const d=(l.aggregations||[]).findIndex((e=>e.property===a));c=d<0?n().oE([...c,s]):n().oE(c.map(((e,t)=>d===t?s:e)));const p={...l,aggregations:c};!t.isClientModeEnabledStore.state&&s&&t.asyncAggregationStatusStore.setState({calculating:!0,aggregation:s,changingType:!0}),r().createAndCommit({userAction:"TableAggregationRow.handleTableAggregationChange",environment:o,canUndo:!0,perform:e=>{(0,i().F)({collectionViewStore:u,update:{query2:p},transaction:e})}})}},83497:(e,t,o)=>{o.d(t,{m:()=>s});o(725707),o(491955),o(403517);var n=()=>o(572589),r=()=>o(76394),i=()=>o(236339),l=()=>o(84543),a=()=>o(304047);function s(e){var t;const{environment:o,collectionContextStore:s,currentGroups:u,groupsFormatKey:c,groupFormat:d,action:p}=e,g="toggle_group_pin"===p&&"board_columns"!==c,m=(null===(t=s.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(c).getValue())??[],y=new Map;for(const r of m)y.set((0,n().Ix)(r),r);const v=new Map;for(const r of u)v.set((0,n().Ix)(r),r);const f=u.filter((e=>!y.has((0,n().Ix)(e)))),h=f.length>0?[...m,...f]:m;if(!s.permissionScopesStore.state.canConfigureBlock||g)return h;const S=y.get((0,n().Ix)(d))??v.get((0,n().Ix)(d))??(0,n().QF)(d.property,d.value),C=h.map((e=>(0,n().Mn)(e,S)?"toggle_group_pin"===p?{...S,pinned:!S.pinned||void 0}:"toggle_group_visibility"===p?{...S,hidden:!S.hidden}:((0,r().ub)(p),S):e));return l().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupFormat",environment:o,canUndo:!0,perform:e=>{(0,a().o)({collectionContextStore:s,newGroups:C,groupsFormatKey:c,transaction:e})}}),(0,i().X)({environment:o,collectionContextStore:s,action:"toggle_group_pin"}),C}},108678:(e,t,o)=>{o.d(t,{m:()=>d});var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(521325),a=()=>o(373122),s=()=>o(749975),u=()=>o(273520),c=o(163643);const d=n.memo((function(e){const{store:t,popupType:l,dismissTooltip:a,renderOrigin:d,placementToOrigin:g}=e,m=(0,r().v3)(),y=(0,s().ET)(),v=(0,i().uB)(void 0,o(962373).A),f=(0,n.useCallback)((()=>{(0,o(236339).X)({environment:m,collectionContextStore:y,action:"click_topbar_templates_dropdown"}),a&&a()}),[y,m,a]);return(0,c.jsx)(u().Ay,{popupType:l,placementToOrigin:g,alignmentToOrigin:u().yP.Start,render:()=>(0,c.jsx)(p,{store:t,templateButtonPopupStore:v}),originGap:4,onClick:f,renderOrigin:d,buttonPopupStore:v})}));function p(e){const{store:t,templateButtonPopupStore:u}=e,d=(0,r().v3)(),p=(0,s().ET)(),g=(0,i().K8)((()=>p.collectionStore()),[p]),m=(0,i().K8)((()=>p.settingsStore),[p]),y=(0,i().O$)(o(802955).e),v=(0,i().O$)(p.permissionScopesStore),f=(0,i().K8)((()=>t.isNonEditableState()),[t]),h=(0,o(174114).IS)((e=>({offlineMessage:{fontSize:14,color:e.text.secondary,width:280,padding:8}})),[]),S=(0,n.useCallback)((e=>{a().Ur({userAction:"CollectionViewBlock.handleTemplateEmptyPageClick",collectionViewBlockStore:t,collectionContextStore:p,environment:d,shouldCoerce:!1,from:{createBlock:"cvb_template_empty_page"},templateStore:void 0,useCrdt:!0}),u.reset(),l().os({collectionSettingsStore:m})}),[p,d,t,u,m]),C=(0,n.useCallback)((e=>{a().Ur({environment:d,collectionContextStore:p,collectionViewBlockStore:t,templateStore:e.templateStore,useCrdt:e.useCrdt,isKeyboard:e.isKeyboard,from:{createBlock:"cvb_template",initCollection:"collection_view_block"},shouldCoerce:!0}),u.reset(),l().os({collectionSettingsStore:m})}),[p,d,t,u,m]),x=(0,n.useCallback)((()=>{u.reset()}),[u]);return g?y?(0,c.jsx)(o(954373).D,{isOverlay:!0,collectionStore:g,canConfigureCollection:v.canConfigureCollection,onEmptyPageClick:S,onEmptyEnter:S,onTemplateClick:C,onCancelClick:x,locked:f}):(0,c.jsx)("div",{style:h.offlineMessage,children:(0,c.jsx)(o(653998).sA,{defaultMessage:"Please go online to use a template.",id:"collectionViewBlock.actionBar.offlineTemplatePicker.message"})}):null}},114530:(e,t,o)=>{o.d(t,{d:()=>$});o(725707),o(500234);var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(174114),a=()=>o(950635),s=()=>o(712437),u=()=>o(572589),c=()=>o(564134),d=()=>o(716605),p=()=>o(752903),g=()=>o(575185),m=()=>o(680369),y=()=>o(361308),v=()=>o(242718),f=()=>o(653998),h=()=>o(76394),S=()=>o(31448),C=()=>o(521325),x=()=>o(159809),b=()=>o(314164),A=()=>o(782422),j=()=>o(401857),k=()=>o(953424),M=()=>o(486748),w=()=>o(29869),_=()=>o(622286),I=()=>o(485966),G=()=>o(413871),V=()=>o(436230),B=()=>o(724217),T=()=>o(126451),P=()=>o(273520),F=()=>o(559637),L=()=>o(931085),R=()=>o(28210),E=()=>o(709237),K=()=>o(103151),O=()=>o(415806),z=()=>o(82954),D=()=>o(837809),N=o(163643);const U=Object.freeze({overflow:"hidden",padding:3,borderRadius:4,fontWeight:S().Wy.medium}),H=Object.freeze({overflow:"hidden",padding:3,marginRight:3,borderRadius:4,fontWeight:S().Wy.medium}),$=n.memo((function(e){const{schema:t,groupFormat:n,collectionContextStore:r,isHiddenGroup:l,style:a,uncategorizedIconStyle:s,currentGroups:u,groupBy:d,onChange:p,onClose:g,disabled:m}=e,y=(0,i().uB)(void 0,o(962373).A),v=(0,i().K8)((()=>{const e=r.groupsStore.getGroupState(n);return null==e?void 0:e.groupUiParentStore}),[r,n]),f=(0,i().K8)((()=>{const e=t[n.property];if(e&&(0,c().nC)(e)&&v)return(0,o(755786).LQ)(e,v)}),[t,n,v]),h=t[n.property];if(!h)return null;const S=n.value;if(void 0===S.value)return(0,N.jsx)(ne,{groupFormat:n,schema:t,isHiddenGroup:l,collectionContextStore:r,style:a,uncategorizedIconStyle:s,parentStore:v});if("formula"===S.type){if("formula"!==S.type)return null;const e=S.value;return e?(0,N.jsx)(W,{schema:t,currentGroups:u,groupBy:d,groupFormat:n,onChange:p,onClose:g,disabled:m,style:a,isHiddenGroup:l,collectionContextStore:r,buttonPopupStore:y,parentStore:v,relatedCollectionAppConfigUri:f,groupValue:e,propertySchema:h}):null}return(0,N.jsx)(W,{schema:t,currentGroups:u,groupBy:d,groupFormat:n,onChange:p,onClose:g,disabled:m,style:a,isHiddenGroup:l,collectionContextStore:r,buttonPopupStore:y,parentStore:v,relatedCollectionAppConfigUri:f,groupValue:S,propertySchema:h})}));function W(e){const{groupValue:t,propertySchema:o,schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:d,isHiddenGroup:p,collectionContextStore:g,buttonPopupStore:m,parentStore:y,relatedCollectionAppConfigUri:v}=e;return"select"===t.type||"multi_select"===t.type?(0,N.jsx)(ue,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:d,buttonPopupStore:m,parentStore:y}):"status"===t.type?(0,N.jsx)(Y,{groupFormat:l,schema:n}):(0,u().r4)(t.type)?(0,N.jsx)(ce,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:d,isHiddenGroup:p,buttonPopupStore:m,parentStore:y,groupValue:t}):"relation"===t.type?(0,N.jsx)(ie,{schema:n,groupFormat:l,collectionContextStore:g,style:d,parentStore:y,relatedCollectionAppConfigUri:v,groupValue:t}):"location"===t.type?(0,N.jsx)(re,{style:d,collectionContextStore:g,parentStore:y,groupValue:t}):(0,u()._o)(t.type)?(0,N.jsx)(te,{style:d,groupValue:t}):(0,u().Vs)(t.type)?(0,N.jsx)(de,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:d,buttonPopupStore:m,parentStore:y,groupValue:t}):"number"===t.type?(0,N.jsx)(oe,{style:d,groupValue:t,propertySchema:"number"===o.type?o:void 0}):"checkbox"===t.type?(0,N.jsx)(ee,{style:d,propertySchema:o,groupValue:t}):void(0,h().HB)(t.type)}function Q(e){const{isHiddenGroup:t}=e,o=(0,n.useCallback)((()=>(0,N.jsx)(f().sA,{id:"database.boardView.uncategorizedColumnTooltip",defaultMessage:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",values:{name:null,b:e=>(0,N.jsx)("span",{style:{fontWeight:S().Wy.semibold},children:e})}})),[]),r=(0,n.useCallback)((t=>(0,N.jsx)(q,{...e,tooltipEvents:t})),[e]),i=(0,l().IS)((()=>({container:{width:240}})),[]);return t?(0,N.jsx)(q,{...e,tooltipEvents:void 0}):(0,N.jsx)(K().A,{renderTooltip:o,render:r,style:i.container,textWrap:!0})}function q(e){const{style:t,uncategorizedIconStyle:o,tooltipEvents:n,formattedLabelMessage:r}=e,i=(0,_().X)("db_ux_chrome"),a=(0,l().IS)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingRight:4,whiteSpace:"nowrap",overflow:"hidden",fontWeight:S().Wy.medium,paddingLeft:0,...t},icon:{width:m().Ev.xs,marginLeft:6,marginRight:6,...o},text:{marginLeft:4,...S().RC}})),[t,o]);return(0,N.jsxs)("div",{style:a.container,...n,children:[i?null:(0,g().M)(a.icon),(0,N.jsx)("span",{style:a.text,children:r})]})}function Z(e){const{value:t}=e;return"other"===t.type?(0,N.jsx)(f().sA,{defaultMessage:"Other",id:"database.collectionGroupValue.textGroup.otherValue"}):"alphabet_prefix"===t.type||"exact"===t.type?(0,N.jsx)(N.Fragment,{children:t.value}):void(0,h().HB)(t)}function Y(e){const{groupFormat:t,schema:o}=e,n=(0,l().IS)((()=>({name:{fontWeight:500},status:{fontWeight:500,lineHeight:"normal",overflow:"hidden",paddingRight:6}})),[]),r=o[t.property];if(!r||"status"!==r.type)return null;const i=t.value;if(i.type!==r.type)return null;const{value:a}=i;if(!a)return null;const s=r.options??[],u=r.groups??[];if("by_group"===a.type){const e=u.find((e=>e.name===a.group));return e?(0,N.jsx)(B().RS,{group:e,style:n.name,showIcon:!0,showColor:!0}):null}if("by_option"===a.type){const e=(0,d().jy)(s,a.option),t=e&&u.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)}));return e?(0,N.jsx)("span",{style:n.status,children:(0,N.jsx)(D().q,{format:p().NY.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1,groupColor:null==t?void 0:t.color})}):null}(0,h().HB)(a)}function X(e){const{value:t}=e,o=(0,f().tz)();return(0,N.jsx)(N.Fragment,{children:(0,j().nc)({intl:o,value:t})})}function J(e){const{value:t,format:o}=e,n=(0,f().tz)();return(0,N.jsx)(N.Fragment,{children:(0,j()._T)({intl:n,value:t,format:o})})}function ee(e){const{groupValue:t,propertySchema:o,style:n}=e,r=(0,l().IS)((()=>({container:{...S().RC,fontWeight:S().Wy.medium,marginRight:3,display:"flex",alignItems:"center",...n},checkboxStyle:{display:"inline-flex",marginRight:6}})),[n]);return"checkbox"!==t.type?null:(0,N.jsxs)("div",{style:r.container,children:[(0,N.jsx)(F().A,{checked:t.value,checkSize:10,size:14,disabled:!0,style:r.checkboxStyle}),(0,N.jsx)("span",{children:null==o?void 0:o.name})]})}function te(e){const{groupValue:t,style:o}=e,n=(0,l().IS)((()=>({container:{...H,...S().RC,...o}})),[o]);return t.value&&(0,u().DH)(t)?(0,N.jsx)("div",{style:n.container,children:(0,N.jsx)(X,{value:t.value})}):null}function oe(e){let{groupValue:t,propertySchema:o,style:n}=e;const r=(0,l().IS)((()=>({container:{...H,...n}})),[n]);if("number"!==t.type||!t.value)return null;const i=(null==o?void 0:o.number_format)||y().C4;return(0,N.jsx)("div",{style:r.container,children:(0,N.jsx)(J,{value:t.value,format:i})})}function ne(e){const{groupFormat:t,schema:o,isHiddenGroup:n,collectionContextStore:r,style:l,uncategorizedIconStyle:a,parentStore:s}=e,u=o[t.property],d=(0,i().K8)((()=>r.collectionStore()),[r]),p=(0,i().K8)((()=>!!(null!=d&&d.isDefined()&&u&&(0,c().nC)(u)&&s)&&(0,M().Vu)({collectionStore:d,property:t.property,propertySchema:u,parentStore:s})),[d,t,u,s]);return u?p?(0,N.jsx)(Q,{style:l,uncategorizedIconStyle:a,isHiddenGroup:n,formattedLabelMessage:(0,N.jsx)(f().sA,{...M().zX.sprintUncategorizedGroup,values:{name:u.name}})}):(0,N.jsx)(Q,{style:l,uncategorizedIconStyle:a,isHiddenGroup:n,formattedLabelMessage:(0,N.jsx)(f().sA,{...j().K0.emptyGroupLabel,values:{name:u.name}})}):null}function re(e){const{style:t,collectionContextStore:o,groupValue:r,parentStore:a}=e,u=(0,i().K8)((()=>{var e;return null===(e=o.collectionViewBlockStore())||void 0===e?void 0:e.id}),[o]),c=(0,n.useMemo)((()=>a&&"location"===r.type&&r.value?G().md.createChildStore(a,r.value):void 0),[a,r.type,r.value]),d=(0,i().K8)((()=>null==c?void 0:c.getParentBlockStore()),[c]),p=(0,i().K8)((()=>u&&(0,A().sj)(u)?o.isInHomeWidgetStore.state?s().y8.PersonalHomeTileTasks:s().y8.PersonalHomePageTasks:s().y8.LocationProperty),[u,o]),g=(0,i().K8)((()=>d?(0,w().Ay)({store:d,fullyQualified:!1,pageVisitSource:p}):void 0),[d,p]),m=(0,i().K8)((()=>null==c?void 0:c.getIcon()),[c]),y=(0,l().IS)((()=>({container:{...t,display:"flex"},icon:{marginTop:2,marginRight:6},title:{fontWeight:S().Wy.medium}})),[t]);return"location"===r.type&&r.value&&a&&c?(0,N.jsxs)(L().A,{href:g,style:y.container,ignoreLocalHoverState:!0,children:[(0,N.jsx)(R().B,{disabled:!0,icon:m,size:20,isEmptyPage:!1,style:y.icon}),(0,N.jsx)(E().A,{store:c,underline:!0,style:y.title})]}):null}function ie(e){const{groupValue:t,schema:o,groupFormat:r,collectionContextStore:l,style:a,parentStore:s,relatedCollectionAppConfigUri:d}=e,p=o[r.property],g=(0,n.useMemo)((()=>p&&"relation"===p.type?c().Nv(p):void 0),[p]),m=(0,n.useMemo)((()=>s&&g?G().md.createChildStore(s,g):void 0),[s,g]),y=(0,i().K8)((()=>null==m?void 0:m.isDefined()),[m]);return s&&"relation"===t.type&&p&&"relation"===p.type&&g&&m&&t.value?(0,u().zx)(t.value)?d&&y?(0,N.jsx)(le,{relatedCollectionAppUri:d,groupValueInner:t.value,collectionContextStore:l,collectionPointer:g,targetCollectionStore:m,parentStore:s,style:a}):null:(0,u().WO)(t.value)?(0,N.jsx)(ae,{parentStore:s,groupValueInner:t.value,collectionContextStore:l}):null:null}function le(e){var t;const{relatedCollectionAppUri:o,groupValueInner:a,collectionContextStore:u,collectionPointer:c,targetCollectionStore:d,parentStore:p,style:g}=e,m=(0,f().tz)(),y=(0,r().v3)(),A=a.value.variable,j=(0,i().K8)((()=>d.isDefined()),[d]),M=(0,i().K8)((()=>(0,k().ax)(u,A,c,d)),[u,A,c,d]),_=(0,i().O$)(I().AppStoreMainEditorCurrentBlockStore),G=(0,i().K8)((()=>M?b().wy({environment:y,store:M,mainEditorCurrentBlockStore:_,collectionContextStore:u})??(0,w().Ay)({store:M,pageVisitSource:s().y8.LinkInPage}):void 0),[y,M,_,u]);let V;"current"===A?V=m.formatMessage(x().DZ.tasksCurrentSprintV2ViewNamePrefix):"next"===A?V=m.formatMessage(x().DZ.tasksNextSprintV2ViewNamePrefix):"last"===A?V=m.formatMessage(x().DZ.tasksLastSprintV2ViewNamePrefix):(0,h().HB)(A);const B=null===(t=v().n$[o])||void 0===t?void 0:t[A],T=(0,l().IS)((()=>({noPageStoreContainer:{fontWeight:S().Wy.medium},pageStoreContainer:{display:"flex",alignItems:"center"},text:{fontWeight:S().Wy.medium,marginBottom:.25},linkContainer:{...g,marginLeft:1}})),[g]),P=(0,n.useCallback)((()=>{C().os({collectionSettingsStore:u.settingsStore})}),[u.settingsStore]);if(j){if(!M)return(0,N.jsx)("div",{style:T.noPageStoreContainer,children:(0,N.jsx)(f().sA,{...null==B?void 0:B.messageDescriptor})});if(M)return(0,N.jsxs)("div",{style:T.pageStoreContainer,children:[(0,N.jsxs)("div",{style:T.text,children:[V,":"]}),(0,N.jsx)(L().A,{style:T.linkContainer,innerStyle:H,href:G,onClick:P,children:(0,N.jsx)(z().A,{format:O().Ay.Format.Medium,blockId:M.id,isSingle:!0,shouldShrink:!0,parentStore:p})})]})}return(0,N.jsx)("div",{style:T.text,children:(0,N.jsx)(f().sA,{...null==B?void 0:B.messageDescriptor})})}function ae(e){const{parentStore:t,groupValueInner:o,collectionContextStore:l,style:a}=e,u=(0,r().v3)(),c=G().Bv.createChildStore(t,o),d=(0,i().O$)(I().AppStoreMainEditorCurrentBlockStore),p=(0,i().K8)((()=>b().wy({environment:u,store:c,mainEditorCurrentBlockStore:d,collectionContextStore:l})??(0,w().Ay)({store:c,pageVisitSource:s().y8.LinkInPage})),[u,c,d,l]),g=(0,n.useCallback)((()=>{C().os({collectionSettingsStore:l.settingsStore})}),[l.settingsStore]);return(0,N.jsx)(L().A,{style:a,innerStyle:H,href:p,onClick:g,children:(0,N.jsx)(z().A,{format:O().Ay.Format.Medium,blockId:o.id,isSingle:!0,shouldShrink:!0,parentStore:t})})}function se(e){const{schema:t,currentGroups:o,groupBy:r,groupFormat:i,onChange:l,onClose:a,buttonPopupStore:s,parentStore:u}=e,c=(0,n.useCallback)((e=>{s.reset(),null==l||l(e)}),[s,l]),d=(0,n.useCallback)((()=>{s.reset(),null==a||a()}),[s,a]);return u?(0,N.jsx)(V().p,{groupFormat:i,groupBy:r,currentGroups:o,schema:t,onChange:c,onClose:d,parentStore:u}):null}function ue(e){const{schema:t,currentGroups:o,groupBy:i,groupFormat:a,onChange:s,onClose:u,disabled:g,style:m,buttonPopupStore:y,parentStore:v}=e,{isMobile:f}=(0,r().Y0)(),h=(0,l().IS)((()=>({container:{...H,...m}})),[m]),S=(0,n.useCallback)((e=>{var o;const n=t[a.property];if(!n||!c().lx(n))return null;const r=a.value;if(null===(o=n.options)||void 0===o||!o.length||void 0===r.value||r.type!==n.type)return null;const i=(0,d().jy)(n.options,r.value);return i?(0,N.jsx)(T().A,{style:h.container,disabled:g,...e,children:(0,N.jsx)(D().O,{format:p().NY.Medium,isSingle:!0,value:i.value,color:i.color,showRemoveButton:!1})}):null}),[g,a.property,a.value,t,h.container]),C=(0,n.useCallback)((()=>(0,N.jsx)(se,{schema:t,currentGroups:o,groupBy:i,groupFormat:a,onChange:s,onClose:u,buttonPopupStore:y,parentStore:v})),[t,o,i,a,s,u,y,v]);return(0,N.jsx)(P().Ay,{render:C,renderOrigin:S,disabled:g,buttonPopupStore:y,popupType:f?P().z7.SlideUp:P().z7.Popup,originGap:4})}function ce(e){const{groupValue:t,schema:o,currentGroups:s,groupBy:c,groupFormat:d,onChange:p,onClose:g,disabled:m,style:y,isHiddenGroup:v,buttonPopupStore:f,parentStore:h}=e,{isMobile:S}=(0,r().Y0)(),C=(0,i().K8)((()=>t.value&&(0,u().GG)(t)&&h?(0,a().xC)({pointer:t.value,getRecordValue:h.getRecordValue}):void 0),[t,h]),x=(0,l().IS)((()=>({container:{...H,...y}})),[y]),b=(0,n.useCallback)((e=>C&&null!=C&&C.asActor?(0,N.jsx)(T().A,{style:x.container,disabled:m,...e,children:(0,N.jsx)(O().Ay,{format:O().Ay.Format.Medium,actor:C,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:v,shouldShrink:!0})}):null),[C,m,v,x.container]),A=(0,n.useCallback)((()=>(0,N.jsx)(se,{schema:o,currentGroups:s,groupBy:c,groupFormat:d,onChange:p,onClose:g,buttonPopupStore:f,parentStore:h})),[o,s,c,d,p,g,f,h]);return(0,u().GG)(t)&&t.value&&h&&null!=C&&C.asActor?(0,N.jsx)(P().Ay,{renderOrigin:b,render:A,disabled:m,buttonPopupStore:f,popupType:S?P().z7.SlideUp:P().z7.Popup,originGap:4}):null}function de(e){const{groupValue:t,schema:o,currentGroups:i,groupBy:a,groupFormat:s,onChange:c,onClose:d,disabled:p,style:g,buttonPopupStore:m,parentStore:y}=e,{isMobile:v}=(0,r().Y0)(),f=(0,l().IS)((()=>({container:{...U,...S().RC,...g}})),[g]),h=(0,n.useCallback)((e=>(0,u().kO)(t)&&void 0!==t.value?(0,N.jsx)(T().A,{style:f.container,disabled:p,...e,children:(0,N.jsx)(Z,{value:t.value})}):null),[p,t,f.container]),C=(0,n.useCallback)((()=>(0,N.jsx)(se,{schema:o,currentGroups:i,groupBy:a,groupFormat:s,onChange:c,onClose:d,buttonPopupStore:m,parentStore:y})),[o,i,a,s,c,d,m,y]);return(0,u().kO)(t)&&void 0!==t.value?"exact"===t.value.type?(0,N.jsx)(P().Ay,{renderOrigin:h,render:C,disabled:p,buttonPopupStore:m,popupType:v?P().z7.SlideUp:P().z7.Popup,originGap:4}):(0,N.jsx)("div",{style:U,children:(0,N.jsx)(Z,{value:t.value})}):null}},158082:(e,t,o)=>{o.d(t,{p:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("myTasksLarge",{viewBox:"0 0 48 48",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M21.693 39.17a9.05 9.05 0 0 1-.73 1.238H39.52c1.65 0 2.892-.413 3.727-1.238.835-.824 1.253-2.05 1.253-3.68V19.203c0-1.628-.418-2.855-1.253-3.68-.835-.824-2.078-1.236-3.727-1.236H16.253c-1.66 0-2.908.412-3.744 1.237-.824.814-1.237 2.04-1.237 3.68v5.28c.212-.02.423-.036.635-.047a6.387 6.387 0 0 1 1.269 0c.222.01.438.027.65.048v-5.14c0-.824.211-1.448.634-1.87.423-.424 1.031-.635 1.824-.635h23.188c.783 0 1.39.212 1.824.634.434.423.65 1.047.65 1.872v16.003c0 .825-.216 1.449-.65 1.872-.433.423-1.041.634-1.824.634H22.248a8.47 8.47 0 0 1-.555 1.316ZM15.364 10.082c-.38.381-.629.93-.745 1.65h26.55c-.127-.72-.38-1.269-.761-1.65-.37-.39-.952-.586-1.745-.586H17.125c-.793 0-1.38.195-1.76.586ZM18.52 5.816c-.38.338-.591.846-.634 1.523h20.016c-.053-.677-.275-1.185-.666-1.523-.38-.349-.936-.523-1.665-.523H20.2c-.729 0-1.29.174-1.68.523Z"}),(0,n.jsx)("path",{d:"M9.448 42.073a7.71 7.71 0 0 0 3.11.634c1.088 0 2.12-.211 3.092-.634a8.253 8.253 0 0 0 2.57-1.745 8.123 8.123 0 0 0 1.76-2.57 7.712 7.712 0 0 0 .634-3.108 7.75 7.75 0 0 0-.634-3.124 8.032 8.032 0 0 0-1.729-2.57 8.03 8.03 0 0 0-2.57-1.728 7.75 7.75 0 0 0-3.124-.635 7.71 7.71 0 0 0-3.109.635 7.907 7.907 0 0 0-2.569 1.744 8.253 8.253 0 0 0-1.745 2.57A7.639 7.639 0 0 0 4.5 34.65c0 1.11.211 2.152.634 3.125a8.254 8.254 0 0 0 1.745 2.57 8.03 8.03 0 0 0 2.57 1.728Zm3.807-2.649c-.17.18-.402.27-.698.27-.296 0-.534-.09-.714-.27-.169-.18-.253-.412-.253-.698v-3.108H8.48c-.286 0-.518-.09-.698-.27-.18-.17-.27-.402-.27-.698 0-.296.09-.528.27-.698.18-.18.412-.27.698-.27h3.109v-3.108c0-.285.084-.518.253-.698.18-.18.418-.27.714-.27s.529.09.698.27c.18.18.27.413.27.698v3.109h3.108c.286 0 .518.09.698.27.18.169.27.401.27.697 0 .296-.09.529-.27.698-.18.18-.412.27-.698.27h-3.108v3.108c0 .286-.09.519-.27.698ZM27.229 32.326c.292.341.664.512 1.116.512.514 0 .903-.198 1.166-.592l5.693-8.58c.095-.14.164-.277.21-.413a1.3 1.3 0 0 0 .068-.401c0-.354-.124-.646-.37-.876a1.246 1.246 0 0 0-.901-.352c-.247 0-.456.05-.63.149-.168.094-.328.259-.48.493l-4.78 7.506-2.394-2.868c-.259-.3-.584-.45-.974-.45-.366 0-.668.117-.907.351a1.186 1.186 0 0 0-.357.883c0 .16.024.312.073.456.054.14.15.286.29.438l3.177 3.744Z"})]})})},199892:(e,t,o)=>{o.d(t,{m:()=>u,p:()=>s});o(358848),o(91270),o(725707),o(403517),o(244387);var n=()=>o(572589),r=()=>o(422721),i=()=>o(314164),l=()=>o(836331),a=()=>o(401857);function s(e){const{groupBy:t,schema:o,format:i,groupsFormatKey:s,limit:u,subGroupArgs:c}=e,d=o[t.property];if(!d||!(0,n().Eg)(d))return;const p=i[s]||[],g=(0,a().w9)(t,i);if(l().default.checkGate({gateName:"collection_group_reducer_visible"})){const t=c&&i[c.groupsFormatKey]||[];return{type:"groups",version:"v2",returnHiddenGroups:e.returnHiddenGroups,returnPinnedGroups:e.returnPinnedGroups,groupBy:g,groupSortPreference:p,limit:Math.min(u,r().O3),subGroup:c?{groupBy:c.groupBy,groupSortPreference:t,limit:c.limit}:void 0,aggregation:e.aggregation?{type:"independent",groupAggregation:e.aggregation,subGroupAggregation:null==c?void 0:c.subGroupAggregation}:void 0,blockResults:e.blockResults}}const m=p.reduce(((e,t)=>(0,n().tx)(t)?e+1:e),0);return{type:"groups",version:void 0,groupBy:g,groupSortPreference:p.map((e=>e.value)),limit:u+m}}function u(e){const{isMobile:t,collectionContextStore:o,groupBy:r,subGroupBy:l}=e,a=o.groupsStore,s=(0,i().CG)(o,t),u=a.getAllGroupStates(),c=l?"intersection":"independent",d=o.getViewType(),p=o.normalizedFormatStore.state,g="board"===d?null==p?void 0:p.board_cover:"gallery"===d?null==p?void 0:p.gallery_cover:void 0,m={type:c,defaultLimit:s,loadContentCover:Boolean(g&&"page_content"===g.type),groupOverrides:{}};for(const i of u){const e=i.currentLimit.state;if(e===s)continue;const t=i.groupsPointer;if("independent"!==c||1!==t.length){if("intersection"===c&&2===t.length&&l){const o=t.at(1),i=t.at(0);if(!o||o.value.type!==r.type)continue;if(!i||i.value.type!==l.type)continue;const a=(0,n().AC)(o.value),s=(0,n().AC)(i.value);m.groupOverrides[(0,n().A)([s,a])]={limit:e}}}else{const o=t.at(0);if(!o||o.value.type!==r.type)continue;const i=(0,n().AC)(o.value);m.groupOverrides[i]={limit:e}}}return m}},201562:(e,t,o)=>{o.d(t,{Q1:()=>l,cJ:()=>i,zi:()=>r});o(610931);var n=o(242343);const r=(0,n.createContext)(null);function i(){const e=(0,n.useContext)(r);if(!e)throw new Error("useFormLayoutEditorContext must be used inside FormLayoutEditorContext.Provider");return(0,n.useMemo)((()=>e),[e])}function l(){return(0,n.useContext)(r)}r.displayName="FormLayoutEditorContext"},235786:(e,t,o)=>{o.d(t,{b:()=>v,w:()=>f});var n=()=>o(237385),r=()=>o(803290),i=()=>o(367950),l=()=>o(162901),a=()=>o(528762),s=()=>o(439154),u=()=>o(818369),c=()=>o(129978),d=()=>o(485966),p=()=>o(595922),g=()=>o(172470),m=()=>o(151602);const y=!1;function v(e){var t;const o=null===(t=(0,c().fJ)(s().xl).value)||void 0===t?void 0:t.loadWorkflowTemplateInstances;(0,r().K8)((()=>{if(!o)return;const t=e instanceof p().A?e.collectionStore():e;t&&o(t)}),[o,e])}function f(){const e=(0,n().v3)(),t=(0,r().K8)((()=>{var e;if(function(){const e=g().A.state.initialRenderCompleted;y&&!e&&console.log("Initial page render is not yet completed, delaying refresh of workflow template instances.");return e}())return null===(e=d().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,l().Yb)((async()=>{if(!t)return;(m().A.debug||y)&&console.log("Refreshing workflow template instance map for space",t);const o={table:a().NX,id:t,spaceId:t},n=await u().callApi({eventName:"getWorkflowTemplateInstances",environment:e,data:{spaceId:o.spaceId,scopeTable:o.table,scopeId:o.id,enableInstanceRobustness:!0}});if("success"===n.type){const e=(0,i()._)(o);m().A.setState({...m().A.state,[e]:n.data.instanceMap[e]})}}),[e,t])}},242335:(e,t,o)=>{o.d(t,{V:()=>a,Z:()=>l});o(610931);var n=o(242343),r=o(163643);const i=n.createContext(void 0);function l(e){return(0,r.jsx)(i.Provider,{value:e.value,children:e.children})}function a(){const e=n.useContext(i);if(!e)throw new Error("useChartStore must be used within a ChartContextProvider");return e}i.displayName="ChartContext"},262448:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(242343),r=o(163643);function i(e){const{pageName:t,targetCollectionStore:n,...i}=e,l=(0,o(237385).Y0)(),a=(0,o(803290).K8)((()=>n.getIcon()),[n]),s=(0,o(174114).IS)((e=>({medium:{color:e.text.secondary},dbName:{display:"flex",alignItems:"center",marginLeft:4},title:{marginLeft:o(124176).g1*(l.isRetina?.5:1)},icon:{width:16,fill:e.mediumIconColor}})),[l.isRetina]),u=(0,r.jsxs)("div",{style:s.dbName,children:[(0,r.jsx)(o(28210).B,{disabled:!0,icon:a,isEmptyPage:!1,size:l.isMobile?24:20}),(0,r.jsx)(o(709237).A,{store:n,style:s.title})]});return(0,r.jsx)(o(535906).A,{title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,r.jsx)(o(653998).sA,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,r.jsx)("span",{style:s.medium,children:e}),pageName:(0,r.jsx)("span",{style:{marginLeft:4,marginRight:4},children:t}),databaseNameWithIcon:u}})}),icon:(0,o(339189).W)(s.icon),...i})}const l=n.memo(i)},278107:(e,t,o)=>{o.d(t,{A:()=>a});o(242343);var n=()=>o(237385),r=()=>o(174114),i=()=>o(220413),l=o(163643);const a=function(e){const{color:t}=e;return(0,l.jsx)(o(535906).A,{...e,icon:(0,l.jsx)(s,{color:t}),title:(0,o(58889).mN)(t)})};function s(e){let{color:t}=e;const o=(0,r().DP)(),a=(0,n().v3)(),s=(0,i().LD)(o,t);return(0,l.jsx)("div",{style:{width:a.device.isMobile?24:18,height:a.device.isMobile?24:18,background:s.menuBackgroundColor,color:s.textColor,boxShadow:o.innerBorderBoxShadow,borderRadius:4}})}},303330:(e,t,o)=>{o.d(t,{FG:()=>f,Is:()=>v,Ix:()=>h,jD:()=>S,lF:()=>y});o(362833),o(725707),o(491955),o(500234),o(403517);var n=()=>o(15552),r=()=>o(769884),i=()=>o(314058),l=()=>o(728373),a=()=>o(76394),s=()=>o(84543),u=()=>o(213517),c=()=>o(113805),d=()=>o(933871),p=()=>o(130081),g=()=>o(836331),m=()=>o(332724);function y(e){const{environment:t,layoutStore:o,currentQuestionModule:n,area:r,property:i,filterValue:a,setModuleSelection:u,sessionId:d}=e;s().createAndCommit({userAction:"FormSelectProperty.handleAddConditionalLogic",environment:t,canUndo:!0,perform:e=>{if(!o.getModel())return;const s=(0,l().Ay)(),g=(0,l().Ay)(),m=function(e){var t,o;switch(e.type){case"select":return{operator:"enum_is",value:{type:"exact",value:null===(t=e.value)||void 0===t?void 0:t.value}};case"multi_select":return{operator:"enum_contains",value:{type:"exact",value:null===(o=e.value)||void 0===o?void 0:o.value}};case"checkbox":return{operator:"checkbox_is",value:{type:"exact",value:e.value}}}}(a);(0,p().UQ)({environment:t,transaction:e,layoutStore:o,position:{area:r,moduleId:n.id},updatedModule:{...n,conditionalGroups:[...n.conditionalGroups??[],{id:s,trigger:{property:i,filter:m},children:[]}]}});const y={id:g,type:"placeholder",parentModuleId:n.id,parentConditionalGroupId:s};(0,c().UQ)({environment:t,transaction:e,layoutStore:o,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:s,parentModuleId:n.id},module:y,sessionId:d,isPropertyCreation:!1}),u&&u({type:"existing_module",moduleId:g,isDragging:!1})}})}function v(e){var t;const{environment:o,layoutStore:n,module:r,conditionalGroupId:l,newValue:a}=e,u=(0,i().A)(r.id,n.getModules()),c={...r,conditionalGroups:null===(t=r.conditionalGroups)||void 0===t?void 0:t.map((e=>e.id===l?{...e,trigger:{...e.trigger,filter:a}}:e))};s().createAndCommit({userAction:"FormConditionalLogicModuleRenderer.updateTriggerFilter",environment:o,canUndo:!0,perform:e=>{(0,p().UQ)({environment:o,transaction:e,layoutStore:n,position:{area:u.area,moduleId:r.id},updatedModule:c})}})}function f(e){const{environment:t,parentModule:o,groupId:n,layoutStore:i,collectionContextStore:l,isCollectionEmpty:a,sessionId:u}=e,c=i.getModules().form_conditional_modules??{};s().createAndCommit({userAction:"FormConditionalLogicModuleRenderer.deleteConditionalGroup",environment:t,canUndo:!0,perform:e=>{var d,g;const y=null==i?void 0:i.getModel();if(!i||!y)return;const v=null===(d=o.conditionalGroups)||void 0===d?void 0:d.filter((e=>e.id!==n)),f=null===(g=o.conditionalGroups)||void 0===g?void 0:g.find((e=>e.id===n));if(void 0!==f){for(const o of f.children??[]){const n=c[o];n&&("placeholder"!==n.type?(0,m().B)({environment:t,module:n,sessionId:u,transaction:e,layoutStore:i,collectionContextStore:l,collectionSettingsStore:l.settingsStore,isCollectionEmpty:a,area:"form_conditional_modules",updateParentModule:!1}):s().applyOperation({transaction:e,store:i,operation:r().N4X.deleteModuleInArea({pointer:i.pointer,area:"form_conditional_modules",moduleId:o})}))}(0,p().UQ)({environment:t,transaction:e,layoutStore:i,position:{area:Object.keys(c).includes(o.id)?"form_conditional_modules":"form_layout_schema",moduleId:o.id},updatedModule:{...o,conditionalGroups:v}})}}})}function h(e){const{environment:t,layoutStore:o,formQuestionModule:n,sessionId:r}=e;s().createAndCommit({userAction:"FormConditionalLogicModuleRenderer.deleteConditionalGroup",environment:t,canUndo:!0,perform:e=>{(0,d().U)({environment:t,transaction:e,layoutStore:o,position:{area:"form_conditional_modules",moduleId:n.id}}),(0,c().UQ)({environment:t,transaction:e,layoutStore:o,position:{area:"form_layout_schema",type:"area_relative",location:"end_moveable"},module:{...n,parentModuleId:void 0,parentConditionalGroupId:void 0},sessionId:r,isPropertyCreation:!1})}})}function S(e){const{questionModulesToVisit:t,draftSubmissionPageStore:o,collectionSchema:r,nestedQuestionModules:i,intl:l}=e,s=[],c=o.getModel();if(!c)return[];for(const p of t){s.push(p);const e=p.conditionalGroups;if(e)for(const t of e){var d;const e=t.trigger;if(!(0,n().ts)({filter:e.filter,property:e.property,propertyMapping:void 0,context:{schema:r,userId:void 0,userTimeZone:"",userStartOfWeek:0,relativeVariableResult:void 0,currentPageInRelatedCollection:void 0,intl:l,collectionFeatureGates:(0,u().i)()},depth:0})({block:c,getRecordModel:o.getRecordModel,propertyMapping:void 0,resultCache:new Map,regExpCache:new Map,experimentService:g().default,formulasModule:void 0}))continue;const p=null===(d=t.children)||void 0===d?void 0:d.map((e=>{const t=i[e];if(t&&"formQuestion"===t.type)return t})).filter(a().O9);if(!p||0===p.length)continue;const m=S({questionModulesToVisit:p,draftSubmissionPageStore:o,collectionSchema:r,nestedQuestionModules:i,intl:l});s.push(...m)}}return s}},304047:(e,t,o)=>{o.d(t,{o:()=>r});var n=()=>o(927999);function r(e){const{collectionContextStore:t,newGroups:o,groupsFormatKey:r,transaction:i}=e,l=t.collectionViewStore();l&&n().zA({stores:[l],update:{[r]:o},transaction:i})}},332724:(e,t,o)=>{o.d(t,{B:()=>g});o(610931),o(725707),o(491955);var n=()=>o(769884),r=()=>o(109046),i=()=>o(154956),l=()=>o(521325),a=()=>o(84543),s=()=>o(137476),u=()=>o(933871),c=()=>o(413871),d=()=>o(659030),p=()=>o(956070);function g(e){let{environment:t,module:o,sessionId:n,layoutStore:r,collectionSettingsStore:i,isCollectionEmpty:a,collectionContextStore:s,area:u,transaction:c,updateParentModule:d}=e;const g=s.collectionStore();if(!g)throw new Error("Could not find collection store");const y=r.getModules().form_conditional_modules??{},v=(0,p().Yg)({currentModule:o,nestedModules:y,includePlaceholders:!0}).formQuestionDescendants.filter((e=>e.id!==o.id)),f=s.normalizedSchemaStore.state;for(const l of v)m({environment:t,module:l,sessionId:n,layoutStore:r,isCollectionEmpty:a,collectionContextStore:s,collectionStore:g,area:"form_conditional_modules",transaction:c,schema:f,updateParentModule:!1});m({environment:t,module:o,sessionId:n,layoutStore:r,isCollectionEmpty:a,collectionContextStore:s,collectionStore:g,area:u,transaction:c,schema:f,updateParentModule:d}),l().os({collectionSettingsStore:i})}function m(e){let t,{environment:o,module:l,sessionId:p,layoutStore:g,isCollectionEmpty:m,collectionContextStore:y,collectionStore:v,area:f,transaction:h,updateParentModule:S,schema:C}=e;if("formQuestion"===l.type){var x;if(t=c().c7.createChildStore(g,{table:r().lo,id:l.formQuestionId,spaceId:g.getSpaceId()??""}).getPropertyId(),!t)return;const e=null===(x=C[t])||void 0===x?void 0:x.type;m&&e&&"title"!==e&&i().BJ({environment:o,collectionStore:v,schema:C,property:t,transaction:h}),(0,s().u4)({environment:o,event:{eventName:"delete_form_question",eventProperties:(0,d().YA)({collectionContextStore:y,propertyId:t,questionId:l.id,parentModuleId:S?l.parentModuleId:void 0,area:f,layoutStore:g})}})}S?(0,u().U)({environment:o,position:{area:f,moduleId:l.id},layoutStore:g,sessionId:p,transaction:h}):a().applyOperation({transaction:h,store:g,operation:n().N4X.deleteModuleInArea({pointer:g.pointer,area:f,moduleId:l.id})})}},348124:(e,t,o)=>{o.d(t,{Q:()=>r});o(725707),o(491955),o(500234);var n=()=>o(564134);function r(e,t){const o={property:n().rn,visible:!0,width:276},r={property:t,visible:!0},i=[o,r],l=e.getCollectionViewStores().find((e=>"table"===e.getType())),a=null==l?void 0:l.getFormatStore().getKeyStore("table_properties").getValue();if(!l||!a||0===a.length)return i;const s=a.find((e=>e.property===n().rn))??o;return[s,a.find((e=>e.property===t))??r,...a.filter((e=>e.property!==n().rn&&e.property!==t))]}},433364:(e,t,o)=>{o.d(t,{KD:()=>u,gt:()=>c,i9:()=>s,ll:()=>l,tb:()=>a,x$:()=>i});var n=()=>o(612408),r=()=>o(975392);function i(e,t){return l(c(e,t))}function l(e){return void 0!==e&&(e===n().q_||e===n().YD)}function a(e,t){if(l(t))return;const o=n().c$[e],r=o.steps.findIndex((e=>e.id===t));return-1===r?o.steps[0].id:r===o.steps.length-1?n().q_:o.steps[r+1].id}function s(e,t){const o=c(e,t);if(o&&!l(o))return a(t,o)}function u(e,t){const o=c(e,t);if(o)return function(e,t){const o=n().c$[e];var i;if(l(t))return null===(i=(0,r().HV)(o.steps))||void 0===i?void 0:i.id;const a=o.steps.findIndex((e=>e.id===t));return-1!==a&&0!==a?o.steps[a-1].id:void 0}(t,o)}function c(e,t){var o;if(!e)return;const r=((null===(o=e.getSettings())||void 0===o?void 0:o.tutorials)||{})[t];return void 0===r?n().c$[t].steps[0].id:r}},436230:(e,t,o)=>{o.d(t,{p:()=>O});o(725707),o(403517),o(113085);var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(174114),a=()=>o(950635),s=()=>o(572589),u=()=>o(564134),c=()=>o(52223),d=()=>o(242718),p=()=>o(145017),g=()=>o(21164),m=()=>o(653998),y=()=>o(975392),v=()=>o(76394),f=()=>o(31448),h=()=>o(145046),S=()=>o(749975),C=()=>o(754697),x=()=>o(640979),b=()=>o(509484),A=()=>o(359441),j=()=>o(836331),k=()=>o(210466),M=()=>o(413871),w=()=>o(921637),_=()=>o(435819),I=()=>o(59175),G=()=>o(401382),V=()=>o(935091),B=()=>o(858023),T=()=>o(975515),P=()=>o(951540),F=()=>o(701513),L=()=>o(88271),R=()=>o(262448),E=()=>o(698995),K=o(163643);function O(e){const{onChange:t,currentGroups:o,groupBy:l,groupFormat:a,onClose:u,schema:c,parentStore:d}=e,[p,g]=(0,n.useState)(""),y=(0,i().uB)(void 0,k().A),v=(0,r().Y0)(),f=(0,n.useCallback)((()=>{H({onChange:t,currentGroups:o,groupBy:l,groupFormat:a,inputValue:p,onClose:u})}),[o,l,a,p,t,u]);let h;return(0,n.useEffect)((()=>{var e;a&&("select"===a.value.type||"multi_select"===a.value.type)&&a.value.value?g(a.value.value):a&&(0,s().kO)(a.value)&&"exact"===(null===(e=a.value.value)||void 0===e?void 0:e.type)&&g(a.value.value.value)}),[a]),h=v.isMobile?{menuType:x().gu.Modal,title:a?(0,K.jsx)(m().sA,{defaultMessage:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}):(0,K.jsx)(m().sA,{defaultMessage:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:(0,K.jsx)(m().sA,{defaultMessage:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:(0,K.jsx)(m().sA,{defaultMessage:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:f,onClickLeft:u}:{menuType:x().gu.Popup,width:D(l)?300:240,maxHeight:"50vh"},(0,K.jsx)(_().A,{capture:!0,render:e=>(0,K.jsx)(V().A,{...h,...e,children:(0,K.jsx)(Z,{groupBy:l,schema:c,onChange:t,currentGroups:o,groupFormat:a,onClose:u,parentStore:d,inputValue:p,setInputValue:g,menuListStore:y})})})}function z(){return(0,K.jsx)(m().sA,{defaultMessage:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}function D(e){return"select"===e.type||"multi_select"===e.type||(0,s().Vs)(e.type)}function N(e){let{currentGroups:t,onChange:o,groupFormat:l,onClose:u,inputValue:c,menuListStore:d}=e;const p=(0,r().v3)(),g=(0,m().tz)(),v=(0,i().uB)(d,k().A),[f,S]=(0,n.useState)(c);return(0,K.jsx)(w().A,{request:f,performRequest:e=>async function(e,t){return(await b().T.searchActions.load()).searchSpaceUsers({environment:t,query:e,membersOnly:!1,limit:20,shouldUseEdgeCacheRollout:j().default.checkGate({gateName:"edge_cache_helpers"})})}(e,p),debounce:A().tu,render:(e,n,r)=>{n||(n=[]);const i=y().oE(n.map((e=>({key:e.id,render:t=>(0,K.jsx)(E().A,{actor:(0,a().A7)(e),...t}),action:()=>{const n={type:"person",value:{table:"notion_user",id:e.id}};return l&&y().n4(n,l.value)?(null==u||u(),null):t.some((e=>(0,s().OF)(n,e.value)))?(h().f1((0,K.jsx)(z,{})),null):void o({newGroupValue:n})}}))));let c;return c=r&&n&&0===i.length?(0,K.jsx)(L().A,{children:(0,K.jsx)(T().A,{title:(0,K.jsx)(m().sA,{defaultMessage:"No results",id:"database.noPersonSearchResults.message"})})}):(0,K.jsx)(B().Ay,{type:B().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,K.jsx)(L().A,{...e}),items:i}],store:v}),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(L().A,{children:(0,K.jsx)(G().Ay,{value:f,focus:!0,placeholder:g.formatMessage({defaultMessage:"Search for a person…",id:"database.searchPerson.placeholder"}),onChange:e=>{S(e.target.value),v.setState({...v.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),c]})}})}function U(e,t,o,n,r,i){const l=o[n.property];if(!l||"relation"!==l.type)return null;const a=u().Nv(l);if(!a)return null;const s=M().md.createChildStore(t,a);return s.isDefined()&&i.length>0?{key:"new-page",render:e=>(0,K.jsx)(R().A,{targetCollectionStore:s,pageName:i,...e}),action:()=>{const t=(0,C().Z1)({environment:e,table:p().ev,spaceId:s.getSpaceId()}),o={table:p().ev,id:t,spaceId:s.getSpaceId()};r({newGroupValue:{type:"relation",value:o},newPage:{id:o.id,spaceId:o.spaceId,name:i}})}}:null}function H(e){let{onChange:t,currentGroups:o,groupBy:n,groupFormat:r,inputValue:i,onClose:l}=e;const a=i.trim().replace(/,/g,"");let u;"select"===n.type||"multi_select"===n.type?u={type:n.type,value:a}:(0,s().Vh)(n)&&(u={type:n.type,value:{type:"exact",value:a}}),u&&a?r&&y().n4(u,r.value)?null==l||l():o.some((e=>u&&(0,s().OF)(u,e.value)))?h().f1((0,K.jsx)(z,{})):t({newGroupValue:u}):null==l||l()}function $(e,t,o,n,r,i,l,a,u){const c=null==u?void 0:u.relativeVariableStore.state,p=c&&c[t.id],g=(e,o)=>{const r=M().md.createChildStore(n,t);if(!r.isDefined())return;const i=r.getFormat().app_config_uri;return i&&o?e.formatMessage(d().n$[i][o].messageDescriptor):void 0};return e.map((e=>{const t=M().Bv.createChildStore(n,e);if(t.isTemplate())return;const u=p?(0,d().cE)(t.id,p):void 0;return{key:t.id,render:e=>(0,K.jsx)(F().A,{store:t,titlePrefix:g(r,u),...e}),action:()=>{let t={type:"relation",value:e};u&&(t={type:"relation",value:{type:"relative",value:{type:"builtin",variable:u}}}),l&&y().n4(t,l.value)?null==a||a():o.some((e=>(0,s().OF)(t,e.value)))?h().f1((0,K.jsx)(z,{})):i({newGroupValue:t})}}}))}function W(e){let{onChange:t,currentGroups:o,groupBy:i,groupFormat:a,onClose:s,inputValue:u,setInputValue:d,menuListStore:p}=e;const g=(0,m().tz)(),y=(0,l().DP)(),v=(0,n.useCallback)((()=>H({onChange:t,currentGroups:o,groupBy:i,groupFormat:a,inputValue:u,onClose:s})),[t,o,i,a,u,s]),h=(0,n.useCallback)((e=>function(e,t,o,n,r,i,l){13===e.keyCode?H({onChange:t,currentGroups:o,groupBy:n,groupFormat:r,inputValue:i,onClose:l}):27===e.keyCode&&(null==l||l())}(e,t,o,i,a,u,s)),[t,o,i,a,u,s]),S=(0,n.useCallback)((e=>function(e,t,o){t(e.target.value),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}(e,d,p)),[p,d]),C=(0,r().WS)(),x=a?g.formatMessage({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",defaultMessage:"Rename group"}):g.formatMessage({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",defaultMessage:"New group"});return C?(0,K.jsx)(L().A,{children:(0,K.jsx)(G().Ay,{value:u,focus:!0,selectAll:!0,showClearButton:!1,focusInitial:!0,placeholder:x,onChange:S,onKeyDown:h})}):(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:6,width:"100%",background:y.inputBackground},children:[(0,K.jsx)(I().A,{value:u,focus:!0,selectAll:!0,focusInitial:!0,placeholder:x,onChange:S,onKeyDown:h,format:I().C.Transparent,style:{fontSize:f().J.UIRegular.desktop}}),(0,K.jsxs)(P().A,{onClick:v,children:[(0,K.jsx)(m().sA,{defaultMessage:"Done",id:"database.collectionEditGroupMenu.submitButton.label"}),(0,c().K)({height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2})]})]})}function Q(e){let{parentStore:t,schema:o,groupBy:l,currentGroups:a,onChange:s,groupFormat:c,onClose:d,inputValue:m,setInputValue:y,menuListStore:v}=e;const f=(0,r().v3)(),h=(0,n.useMemo)((()=>{const e=o[l.property];return!(!e||"relation"!==e.type)&&u().Nv(e)}),[l.property,o]);return(0,i().K8)((()=>{if(!h)return!1;return M().md.createChildStore(t,h).isDefined()}),[h,t])&&h?(0,K.jsx)(w().A,{request:m,performRequest:e=>async function(e,t,o,n,r){const i=o[t.property];if(!i||!(0,u().nC)(i))return;const l=i.collection_pointer;if(!l)return;const a=M().md.createChildStore(n,{table:g().Vl,id:l.id});if(await a.load(),!a.isDefined())return;const s=a.getSpaceId(),c=await b().T.searchActions.load();return(await c.searchPagesInCollection({environment:r,query:e,collectionId:l.id,spaceId:s,excludeTemplates:!0,source:"collection_group_value",limit:20,includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1})).results.map((e=>({table:p().ev,id:e,spaceId:s})))}(e,l,o,t,f),debounce:A().tu,render:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return(0,K.jsx)(q,{ready:r,results:n,parentStore:t,schema:o,groupBy:l,currentGroups:a,onChange:s,groupFormat:c,onClose:d,inputValue:m,setInputValue:y,menuListStore:v,collectionPointer:h,environment:f})}}):null}function q(e){let{parentStore:t,schema:o,groupBy:r,currentGroups:l,onChange:a,groupFormat:s,onClose:u,inputValue:c,setInputValue:d,menuListStore:p,results:g,ready:v,collectionPointer:f,environment:h}=e;const C=(0,m().tz)(),x=(0,n.useContext)(S().p2),b=(0,i().K8)((()=>y().oE([...$(g,f,l,t,C,a,s,u,x),U(h,t,o,r,a,c)])),[h,x,f,l,r,s,c,C,a,u,t,g,o]);let A;return A=v&&g&&0===b.length?(0,K.jsx)(L().A,{children:(0,K.jsx)(T().A,{title:(0,K.jsx)(m().sA,{defaultMessage:"No results",id:"database.noRelationSearchResults.message"})})}):(0,K.jsx)(B().Ay,{type:B().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,K.jsx)(L().A,{...e}),items:b}],store:p}),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(L().A,{children:(0,K.jsx)(G().Ay,{value:c,focus:!0,placeholder:C.formatMessage({defaultMessage:"Type to search...",id:"database.searchRelation.placeholder"}),onChange:e=>{d(e.target.value),p.setState({...p.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),A]})}function Z(e){let{groupBy:t,schema:o,onChange:n,currentGroups:r,groupFormat:i,onClose:l,parentStore:a,inputValue:u,setInputValue:c,menuListStore:d}=e;return o[t.property]?"select"===t.type||"multi_select"===t.type?(0,K.jsx)(W,{onChange:n,currentGroups:r,groupBy:t,groupFormat:i,onClose:l,inputValue:u,setInputValue:c,menuListStore:d}):"person"===t.type?(0,K.jsx)(N,{currentGroups:r,onChange:n,groupFormat:i,onClose:l,inputValue:u,menuListStore:d}):"relation"===t.type?(0,K.jsx)(Q,{parentStore:a,schema:o,groupBy:t,currentGroups:r,onChange:n,groupFormat:i,onClose:l,inputValue:u,setInputValue:c,menuListStore:d}):(0,s().Vs)(t.type)?(0,K.jsx)(W,{onChange:n,currentGroups:r,groupBy:t,groupFormat:i,onClose:l,inputValue:u,setInputValue:c,menuListStore:d}):"number"===t.type||"status"===t.type||"date"===t.type||"formula"===t.type||"checkbox"===t.type||"created_time"===t.type||"last_edited_time"===t.type||"created_by"===t.type||"last_edited_by"===t.type||"last_visited_time"===t.type||"location"===t.type?null:void(0,v().HB)(t.type):null}},458988:(e,t,o)=>{o.d(t,{M:()=>d});o(403517);var n=()=>o(569766),r=()=>o(571785),i=()=>o(521325),l=()=>o(759625),a=()=>o(84543),s=()=>o(314164),u=()=>o(934807),c=()=>o(308265);async function d(e){var t;const{environment:o,collectionStore:d,collectionContextStore:p,collectionSettingsStore:g,shouldSkipViewSelection:m}=e,y=p.collectionViewBlockStore(),v=p.collectionViewStore(),f=d.getParentBlockStore();if(!y||!f||!v)return;const h=null===(t=d.getModel())||void 0===t?void 0:t.getNormalizedSchema();if("chart"===v.getType()&&h){const e=v.getFormat(),t=e.chart_config;if(!t)return;const i="placeholder"===t.type?t.placeHolderType:t.type;let s;return(0,r().I)(i)?s=(0,n().EZ)({collectionSchema:h,axisChartType:i}):"donut"===i&&(s=(0,n().ZS)({collectionSchema:h})),a().createAndCommit({userAction:"slashMenu.create.chartViewExistingSource",environment:o,canUndo:!0,perform:t=>{l().zv({store:v.getFormatStore(),transaction:t,data:{...e,hide_linked_collection_name:!0,subitem_display_mode:"flattened",chart_config:s||null}})}}),void g.setState({open:!0,stack:[{type:"main"}]})}if(m)i().a2({collectionSettingsStore:g,item:{type:"main"}});else{await Promise.all([...f.getCollectionViewStores().map((e=>e.load())),...y.getCollectionViewStores().map((e=>e.load()))]);const e=(0,s().Mf)({collectionStore:d,sourceCollectionViewBlockStore:f,currentCollectionViewBlockStore:y,currentCollectionViewStore:v,constraints:(0,u().v)(v.id)});(0,c().ei)()?i().R8({collectionSettingsStore:g,item:{type:"createView"}}):e.length>0?i().a2({collectionSettingsStore:g,item:{type:"duplicateExistingView"}}):i().a2({collectionSettingsStore:g,item:{type:"createView"}})}}},464335:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=()=>o(653998),r=o(163643);const i=function(e){let{on:t,menuListItemProps:i}=e;return(0,r.jsx)(o(725599).A,{...i,on:t,style:{alignItems:"flex-start",paddingTop:8,paddingBottom:8},title:(0,r.jsx)(n().sA,{defaultMessage:"Show large counts as 99+",id:"BoardAggregations.aggregationLimitToggle.title"}),captionStyle:{marginTop:6},shouldWrapCaption:!0,caption:(0,r.jsx)(n().sA,{defaultMessage:"This improves performance for large databases.",id:"BoardAggregations.aggregationLimitToggle.description"})})}},486748:(e,t,o)=>{o.d(t,{$6:()=>s,Vu:()=>a,zX:()=>l});var n=()=>o(65866),r=()=>o(242718),i=()=>o(755786);const l=(0,o(653998).YK)({sprintUncategorizedGroup:{defaultMessage:"Backlog (No {name})",id:"database.sprintDatabaseView.uncategorizedGroupLabel"}});function a(e){const{collectionStore:t,property:o,propertySchema:r,parentStore:l}=e;let a=!1;if(null!=t&&t.isDefined()){const e=t.getPropertyMapping();a=(null==e?void 0:e[n().yx.TaskToSprintRelation])===o}return(0,i().LQ)(r,l)===n().av||a}function s(e){return(0,r().wy)({appUri:e.getFormatStore().getKeyStore("app_config_uri").getValue(),collectionSchema:e.getSchema()})}},575185:(e,t,o)=>{o.d(t,{M:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("collectionInbox",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M11.0918,0 C11.5383,0 11.9307,0.295898 12.0533,0.725586 L13.9615,7.40332 C13.9871,7.49316 14,7.58594 14,7.67871 L14,13 C14,13.5527 13.5522,14 13,14 L1,14 C0.447754,14 0,13.5527 0,13 L0,7.67871 C0,7.58594 0.0129395,7.49316 0.0384521,7.40332 L1.94666,0.725586 C2.06934,0.295898 2.46167,0 2.9082,0 L11.0918,0 Z M4.27271,1.5 C3.83728,1.5 3.45178,1.78223 3.31982,2.19727 L1.91455,6.61328 C1.70947,7.25879 2.1908,7.91699 2.86755,7.91699 L4.70837,7.91699 C4.70837,8.93652 5.16663,10.168 7,10.168 C8.83337,10.168 9.29163,8.93652 9.29163,7.91699 L11.1478,7.89355 C11.8201,7.88477 12.2927,7.22852 12.0876,6.58887 L10.681,2.19531 C10.5485,1.78125 10.1635,1.5 9.72864,1.5 L4.27271,1.5 Z"})})},610509:(e,t,o)=>{o.d(t,{P:()=>l});var n=()=>o(384221),r=()=>o(485966),i=()=>o(413871);function l(e){const{environment:t,collectionContextStore:o}=e;let l=o.collectionStore();const a=o.collectionViewBlockStore();if(!l||!a)return;const{mainEditorCurrentBlockStore:s}=r().default.state;s&&o.isFullScreenStore.state&&(l=i().md.createChildStore(s,l.pointer)),n().selectAllText({environment:t,store:l.getNameStore(),canSelectAllBlocks:!1})}},612408:(e,t,o)=>{o.d(t,{YD:()=>i,c$:()=>n,q_:()=>r});const n={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]}},r="completed",i="dismissed"},619262:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(129044))().default{getInitialState(){return!1}}const r=new n},627683:(e,t,o)=>{o.d(t,{A:()=>l});o(242343);var n=()=>o(635900);o(362833),o(725707),o(244387);var r=o(163643);const i=16;function l(e){const{startPoint:t,endPoint:o,style:i,showArrowHead:l,useRightAngles:u,cornerRadiusOverride:c,handleMouseMove:d,handleMouseLeave:p}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{startPoint:t,startCurvePoint:u?void 0:{x:t.x+n().g_,y:t.y},endPoint:l?{x:o.x-1.5,y:o.y}:o,endCurvePoint:u?void 0:{x:o.x-n().g_,y:o.y},cornerRadiusOverride:c,style:i,handleMouseMove:d,handleMouseLeave:p,children:e.children}),l&&(0,r.jsx)(a,{endPoint:o,style:i})]})}function a(e){const{endPoint:t,style:o}=e;return(0,r.jsx)("polyline",{points:`${t.x-5},${t.y-6} ${t.x},${t.y} ${t.x-5},${t.y+6}`,style:o,fill:"transparent"})}function s(e){const{startPoint:t,startCurvePoint:o,endPoint:n,endCurvePoint:l,style:a,cornerRadiusOverride:s,handleMouseMove:u,handleMouseLeave:c}=e;let d="";d=o&&l?`M ${t.x} ${t.y} L ${o.x} ${o.y} L ${l.x} ${l.y} L ${n.x} ${n.y}`:`M ${t.x} ${t.y} L ${t.x} ${n.y} L ${n.x} ${n.y}`;const p=function(e,t){function o(e,t,o){const r=t.x-e.x,i=t.y-e.y,l=Math.sqrt(r*r+i*i);return n(e,t,Math.min(1,o/l))}function n(e,t,o){return{x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}function r(e,t){e.length>2&&(e[e.length-2]=t.x.toString(),e[e.length-1]=t.y.toString())}function i(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}const l=e.split(/[,\s]/).reduce(((e,t)=>{const o=t.match("([a-zA-Z])(.+)");return o?(e.push(o[1]),e.push(o[2])):e.push(t),e}),[]).reduce((function(e,t){return!isNaN(parseFloat(t))&&e.length?e[e.length-1].push(t):e.push([t]),e}),[]);let a=[];if(l.length>1){const e=i(l[0]);let s=null;"Z"===l[l.length-1][0]&&l[0].length>2&&(s=["L",e.x.toString(),e.y.toString()],l[l.length-1]=s),a.push(l[0]);for(let u=1;u<l.length;u++){const e=a[a.length-1],c=l[u],d=c===s?l[1]:l[u+1];if(d&&e&&e.length>2&&"L"===c[0]&&d.length>2&&"L"===d[0]){const l=i(e),s=i(c),u=i(d),p=o(s,l,t),g=o(s,u,t);r(c,p),a.push(c);const m=n(p,s,.5),y=n(s,g,.5),v=["C",m.x.toString(),m.y.toString(),y.x.toString(),y.y.toString(),g.x.toString(),g.y.toString()];a.push(v)}else a.push(c)}if(s){const e=i(a[a.length-1]);a.push(["Z"]),r(a[0],e)}}else a=l;return a.reduce((function(e,t){return`${e}${t.join(" ")} `}),"")}(d,s||i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:p,style:a,fill:"transparent"}),(u||c)&&(0,r.jsxs)("g",{onMouseMove:u,onMouseLeave:c,children:[(0,r.jsx)("path",{d:p,style:{strokeOpacity:0,strokeWidth:16,pointerEvents:"stroke",cursor:"default"},fill:"transparent"}),e.children]})]})}},668639:(e,t,o)=>{o.d(t,{y:()=>l});var n=()=>o(572589),r=()=>o(236339),i=()=>o(927999);function l(e){const{environment:t,collectionContextStore:o,transaction:l,groupByKey:a,groupsFormatKey:s,sortType:u}=e;if("chart_config"===a)return;const c=(0,n().H2)(o.normalizedFormatStore.state,a,s),d=o.collectionViewStore();if(!c||!d)return;if((0,n().Nf)(c).includes(u)){if("formula"===c.type){const e={...c,groupBy:{...c.groupBy,sort:{type:u}}};i().zA({stores:[d],update:{[a]:e},transaction:l})}else i().zA({stores:[d],update:{[a]:{...c,sort:{type:u}}},transaction:l});(0,r().X)({environment:t,collectionContextStore:o,action:"update_group_sort"})}}},684244:(e,t,o)=>{o.d(t,{d:()=>a});o(362833),o(725707),o(491955),o(500234),o(771702),o(403517);var n=()=>o(803290),r=()=>o(572589),i=()=>o(401857),l=()=>o(622286);function a(e){let{collectionContextStore:t,reducerResult:o,groupBy:a,subGroupBy:s,groupsLimit:u,groupsFormatKey:c,renderGroupsFromAggregationArgs:d,removeUncategorized:p}=e;const g=(0,l().X)("collection_group_reducer_visible");return(0,n().Fy)((()=>{var e;const n=t.normalizedFormatStore.state,l=t.normalizedSchemaStore.state,m=t.collectionViewBlockStore();if(g&&"v2"===(null==o?void 0:o.version)){const e=[],t=[];if(a){var y,v;o.results.forEach((n=>{var i;const l=null===(i=o.pinnedResults)||void 0===i?void 0:i.groupResults.find((e=>(0,r().AC)(e.value)===(0,r().AC)(n.value)));n.visible?e.push({property:a.property,value:n.value,pinned:!!l||void 0}):t.push({property:a.property,value:n.value,hidden:!0,pinned:!!l||void 0})}));const n=(null===(y=o.pinnedResults)||void 0===y?void 0:y.groupResults.map((e=>({property:a.property,value:e.value,pinned:!0,hidden:!e.visible}))))??[];return{version:"v2",currentGroups:[...e,...t],visibleGroups:e,hiddenGroups:t,pinnedGroups:{groups:n,aggregations:(null===(v=o.pinnedResults)||void 0===v?void 0:v.aggregationResults)??{}},hasMore:o.hasMore}}var f;return s?(null===(f=o.subGroupResults)||void 0===f||f.forEach((o=>{o.visible?e.push({property:s.property,value:o.value}):t.push({property:s.property,value:o.value,hidden:!0})})),{version:"v2",currentGroups:[...e,...t],visibleGroups:e,hiddenGroups:t,pinnedGroups:{groups:[],aggregations:{}},hasMore:Boolean(o.hasMoreSubGroups)}):{version:"v2",currentGroups:[],visibleGroups:[],hiddenGroups:[],pinnedGroups:{groups:[],aggregations:{}},hasMore:!1}}if(!a||!m||"v2"===(null==o?void 0:o.version))return{version:"v1",currentGroups:[],visibleGroups:[],hiddenGroups:[],total:0};const h=(0,r().oH)({schema:l,groupBy:a}),S="chart_subgroups"===c&&null!=o&&o.subGroupResults?o.subGroupResults:null==o?void 0:o.results,C=(0,i().ck)({groupBy:a,schema:l,formatGroups:n[c]||[],schemaGroups:h,reducerResults:S,getRecordModel:m.getRecordModel,getRecordRole:m.getRecordRole,relativeVariableResult:t.relativeVariableStore.state,viewAppConfigUri:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri,allowedCollectionStores:t.collectionStoresStore.state,renderGroupsFromAggregationArgs:d,removeUncategorized:p}),x=C.filter((e=>!(0,r().tx)(e))).slice(0,u),b=C.filter((e=>(0,r().tx)(e))),A=o?o.total:0;return{version:"v1",currentGroups:[...x,...b],visibleGroups:x,hiddenGroups:b,total:A}}),[t,g,o,a,c,d,p,u,s])}},762732:(e,t,o)=>{o.d(t,{V:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("subItem",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.88642 2.43778C1.98215 2.3846 2.09567 2.35999 2.22362 2.35999C2.41846 2.35999 2.58374 2.42299 2.71309 2.55179C2.84789 2.67678 2.91386 2.84079 2.91386 3.03655C2.91386 3.161 2.90926 3.28545 2.90008 3.40989C2.8956 3.52687 2.89335 3.66669 2.89335 3.82952C2.89335 4.6672 2.99989 5.34012 3.20906 5.85192C3.42107 6.35987 3.76386 6.73052 4.23921 6.9683C4.72178 7.20285 5.37665 7.32288 6.20897 7.32288H10.9303L12.4002 7.41264L10.2433 5.44074L8.72396 3.8939C8.66786 3.83269 8.6225 3.76177 8.58753 3.68184L8.58532 3.67681C8.55515 3.59133 8.54022 3.50307 8.54022 3.41252C8.54022 3.22504 8.60443 3.06601 8.73414 2.94147C8.86699 2.81372 9.02934 2.74963 9.21678 2.74963C9.40179 2.74963 9.5677 2.81976 9.71223 2.95431L9.71419 2.95614L14.2523 7.49436C14.4062 7.63869 14.4871 7.81019 14.4871 8.00627C14.4871 8.20241 14.4062 8.37593 14.2528 8.52459L9.72696 13.0436C9.57465 13.191 9.40407 13.2698 9.21678 13.2698C9.03026 13.2698 8.86827 13.2086 8.73525 13.0858L8.73305 13.0838C8.60434 12.9551 8.54022 12.7943 8.54022 12.6069C8.54022 12.5163 8.55535 12.4281 8.58551 12.3426C8.61631 12.2554 8.66304 12.1796 8.72601 12.1166L10.2463 10.5689L12.3938 8.61275L10.9258 8.69663L6.14745 8.69651C4.516 8.69651 3.32454 8.32105 2.59311 7.55211C1.86303 6.77991 1.50604 5.55355 1.50604 3.89104C1.50604 3.68942 1.51062 3.50571 1.51983 3.34C1.52904 3.17413 1.54527 3.03558 1.56915 2.92552C1.58898 2.82668 1.62376 2.73465 1.67362 2.64989C1.72566 2.56142 1.79795 2.48982 1.88642 2.43778Z"})})},791503:(e,t,o)=>{function n(e){const{dateRangeStart:t,dateRangeEnd:o,collectionContextStore:n}=e;n.dateRangeStartStore.setState(t),n.dateRangeEndStore.setState(o)}o.d(t,{r:()=>n})},808532:(e,t,o)=>{o.d(t,{A:()=>x});o(362833),o(725707),o(771702),o(403517),o(242343);var n=()=>o(120082),r=()=>o(653998),i=()=>o(975392),l=()=>o(995331),a=()=>o(86607),s=()=>o(640979),u=()=>o(906230),c=()=>o(907721),d=()=>o(464335),p=()=>o(535906),g=()=>o(935091),m=()=>o(858023),y=()=>o(743668),v=()=>o(88271),f=()=>o(103151),h=()=>o(350208),S=o(163643);const C=(0,r().YK)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"}});const x=(0,r().j4)((function(e){let{onClose:t,property:i,schema:l,currentAggregation:u,source:c,noneText:d,intl:f,onChange:x}=e;const b=(0,o(237385).v3)(),{device:M}=b;let w;w=M.isMobile?{menuType:s().gu.Modal,title:(0,S.jsx)(r().sA,{defaultMessage:"Table aggregation",id:"database.mobilePropertyAggregationMenu.title"}),right:(0,S.jsx)(y().DoneMenuText,{}),onClickRight:t}:{menuType:s().gu.Popup,width:200};const[_,I]=function(e){let{property:t,schema:o,source:r,intl:i,onChange:l,environment:u,currentAggregation:c,noneText:d}=e;const f=[];let x=0,b=0;const{device:M}=u,w=function(e,t,o,r,i){const l={},a=null==i?void 0:i.enforceMaxAggregationLimit,s=null==i?void 0:i.aggregator,u=t[e];if(!u)return{};const c=e=>o(e,a);for(const d of n().VD)l[d]=A(d===s,d,c);if((0,n().wG)(u))for(const d of n().CG)l[d]=A(d===s,d,c);if((0,n().OC)(u))for(const d of n().Sn)l[d]=A(d===s,d,c);if((0,n().fo)(u))for(const d of n().zE)l[d]=A(d===s,d,c);if((0,n().s_)(u))for(const d of n().QO)l[d]=A(d===s,d,c);if((0,n().q0)(u))for(const d of n().nJ)l[d]=j(e,d,i,t,o,r);if((0,n().pe)(u))for(const d of n().A3)l[d]=A(d===s,d,c);return l}(t,o,l,u,c);f.push({key:"none",render:e=>(0,S.jsx)(p().A,{...e,isChecked:!c,title:d||i.formatMessage(C.noneText)}),action:()=>l(void 0)});let _="tableAggregation"===r?1:2;return Object.entries(n().Kn).forEach((e=>{let[t,o]=e;const i=[];for(const l of o)if(w[l]){if("show_unique"===l)switch(r){case"tableAggregation":continue;case"rollupPropertyMenu":f.splice(1,0,w[l]),(null==c?void 0:c.aggregator)===l&&(x=1);continue}i.push(w[l]),(c&&(0,n().ET)(null==c?void 0:c.aggregator)&&c.aggregator.operator===l||(null==c?void 0:c.aggregator)===l)&&(x=_,b=i.length-1)}const u=[];if("count_aggregations"===t&&"tableAggregation"===r&&u.push({key:"limitToggleSection",render:e=>(0,S.jsx)(v().A,{...e}),items:[k(c,l)]}),u.push({key:"aggregations",render:e=>(0,S.jsx)(v().A,{topBorder:!0,...e}),items:i}),i.length>0){_++;const e=a().jA[t],o={key:e,render:(t,o)=>(0,S.jsx)(h().A,{...t,disableDefaultClick:!0,onFocus:o.onFocus,renderOrigin:(t,o)=>(0,S.jsx)(p().A,{...t,ref:o,title:e}),renderExtension:(t,n)=>{let r;return r=M.isMobile?{menuType:s().gu.Modal,title:e,right:(0,S.jsx)(y().DoneMenuText,{}),onClickRight:n.close,...t}:{menuType:s().gu.Popup,width:250,...t},(0,S.jsx)(g().A,{...r,children:(0,S.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:b,sections:u,onAccept:(e,t,r)=>{n.close(),o.onAccept&&o.onAccept(e,t,r)}})})}}),action:()=>null};f.push(o)}})),[f,x]}({property:i,schema:l,source:c,intl:f,onChange:x,environment:b,currentAggregation:u,noneText:d});return(0,S.jsx)(g().A,{...w,children:(0,S.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:I??0,sections:[{key:0,render:e=>(0,S.jsx)(v().A,{...e}),items:_}],onAccept:t})})}));function b(e){let{isSelected:t,aggregationType:o,label:n,props:r}=e;const i=a().cx[o];return(0,S.jsx)(f().A,{placement:c().W.Right,delayThreshold:0,render:e=>(0,S.jsx)(p().A,{title:n,isChecked:t,...(0,u().A)(e,r)}),renderTooltip:()=>(0,S.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[i&&(0,S.jsx)("img",{src:(0,l().L)(i),style:{borderRadius:4,width:140,marginTop:4}}),a().fp[o]]})},r.key)}function A(e,t,o){const n=a().zY[t],r=a().cx[t];return{key:n,render:o=>(0,S.jsx)(f().A,{placement:c().W.Right,delayThreshold:0,render:t=>(0,S.jsx)(p().A,{title:n,isChecked:e,...(0,u().A)(t,o)}),renderTooltip:()=>(0,S.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[r&&(0,S.jsx)("img",{src:(0,l().L)(r),style:{borderRadius:4,width:140,marginTop:4}}),a().fp[t]]})},o.key),action:()=>{o(t)}}}function j(e,t,o,r,l,u){const{device:c}=u,d=a().zY[t],f=i().oE(function(e,t,o,r,i){const l=r[t];if(!l||"status"!==l.type)return;const a=l.groups;return a?a.map((t=>{const r=(e&&(0,n().ET)(e.aggregator)&&e.aggregator.operator===o&&e.aggregator.groupName===t.name)??!1;return{key:`${o}${t.name}`,render:e=>(0,S.jsx)(b,{isSelected:r,aggregationType:o,label:t.name,props:e}),action:()=>{i({operator:o,groupName:t.name})}}})):void 0}(o,e,t,r,l));let C=0;if(o&&(0,n().ET)(null==o?void 0:o.aggregator)&&o.aggregator.operator===t){const e=o.aggregator.groupName,n=f.findIndex((o=>o.key===`${t}${e}`));-1!==n&&(C=n)}return{key:t,render:(e,t)=>(0,S.jsx)(h().A,{...e,onFocus:t.onFocus,renderOrigin:e=>(0,S.jsx)(p().A,{...e,title:d}),renderExtension:(e,o)=>{let n;return n=c.isMobile?{menuType:s().gu.Modal,title:d,right:(0,S.jsx)(y().DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:s().gu.Popup,width:200,...e},(0,S.jsx)(g().A,{...n,children:(0,S.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:C,sections:[{key:"groups",render:e=>(0,S.jsx)(v().A,{...e}),items:f}],onAccept:t.onAccept})})}}),action:()=>null}}function k(e,t){const o=Boolean(null==e?void 0:e.enforceMaxAggregationLimit);return{key:"aggregationLimitToggle",render:e=>(0,S.jsx)(d().A,{on:o,menuListItemProps:e}),action:()=>{t(e?e.aggregator:"count",!o)}}}},853100:(e,t,o)=>{o.d(t,{A:()=>n});const n=(0,o(653998).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"}})},861334:(e,t,o)=>{o.d(t,{U:()=>l});var n=()=>o(759625),r=()=>o(84543),i=()=>o(787404);function l(e){const{viewToDuplicateStore:t,collectionContextStore:o,collectionViewStore:l,environment:a,temporaryStore:s}=e,u=o.collectionStore(),c=t.getType();if(!c||!u)return;const d=t.getName(),p=t.getPageSort(),g=t.getFormat(),m=t.getKeyStore("query2").getValue();r().createAndCommit({userAction:"CollectionSettingsDuplicateExistingView.duplicateViewSettings",environment:a,canUndo:!0,perform:e=>{n().zv({store:s??l,data:{name:d,type:c,page_sort:p,format:{...g,collection_pointer:u.pointer},query2:m},transaction:e})}}),(0,i().S)({collectionContextStore:o})}},912468:(e,t,o)=>{o.d(t,{Q:()=>p,d:()=>g});o(725707),o(491955);var n=()=>o(768022),r=()=>o(15552),i=()=>o(572589),l=()=>o(427091),a=()=>o(348124),s=()=>o(163182),u=()=>o(137476),c=()=>o(876695),d=()=>o(485966);function p(e){return`${i().RO}_${e}`}function g(e){var t,o,i;const{collectionContextStore:p,environment:g,groupFormat:m,groupBy:y,temporaryViewState:v,title:f}=e,h=p.collectionViewBlockStore();if(!h)return;const S=p.normalizedSchemaStore.state,C=p.normalizedFormatStore.state,x=p.normalizedQueryStore.state,b=(null===(t=d().default.state.currentUserSettingsStore)||void 0===t?void 0:t.getSettingsStore().getKeyStore("time_zone").getValue())||(0,l().P)(),A=(0,n().K8)({schema:S,groupBy:y,group:m,propertyMapping:void 0,timeZone:b});if(!A)return;const j=y.property,k=(0,a().Q)(h,j),M=(null===(o=v.combinatorFilter)||void 0===o?void 0:o.value)??(null==x?void 0:x.filter),w={type:"table",parent_id:h.pointer.id,parent_table:h.pointer.table,alive:!0,space_id:h.getSpaceId(),format:{is_unlisted:!0,collection_pointer:C.collection_pointer,table_properties:k,property_filters:(null==v||null===(i=v.propertyFilters)||void 0===i?void 0:i.value)??(null==C?void 0:C.property_filters)},query2:{...x,filter:M?(0,r().GV)([M,A]):(0,r().GV)([A])}},_=(0,c().sl)(p);(0,u().u4)({environment:g,event:{eventName:"collection_chart_drilldown_click",eventProperties:{..._,drilldown_type:"grouped",from:"board_pinned_group"}}}),s().S.openCollectionDrilldownView({collectionViewValue:w,collectionViewBlockStore:h,viewsModuleContext:p.viewsModuleContextStore.state,title:f})}},954373:(e,t,o)=>{o.d(t,{D:()=>A});o(725707),o(107652),o(491955),o(403517);var n=o(242343),r=()=>o(237385),i=()=>o(803290),l=()=>o(174114),a=()=>o(712437),s=()=>o(653998),u=()=>o(352211),c=()=>o(373122),d=()=>o(84543),p=()=>o(31448),g=o(163643);const m=n.memo((function(e){const{prefix:t,collectionName:o}=e,n=(0,l().IS)((e=>({container:{display:"flex",alignItems:"center",fontWeight:p().Wy.medium,color:e.text.secondary,paddingLeft:8,paddingRight:8},databaseTitle:{...p().RC}})),[]);return(0,g.jsxs)("div",{style:n.container,children:[t,(0,g.jsxs)("span",{style:n.databaseTitle,children:[" ",o]})]})}));var y=()=>o(29869),v=()=>o(640979);const f=n.memo((function(e){const t=(0,r().v3)(),i=(0,s().tz)(),a=(0,l().IS)((e=>({link:{borderRadius:6,height:24,width:24,display:"flex"},button:{height:24,width:24,fill:e.icon.tertiary},icon:{width:20,height:20}})),[]),u=(0,n.useCallback)((()=>{o(598995).FH(t,{from:e.helpButtonContext})}),[t,e.helpButtonContext]);return(0,g.jsx)(o(579494).A,{href:e.href,external:!0,style:a.link,onClick:u,children:(0,g.jsx)(o(356813).A,{icon:o(155342).questionMarkCircleIcon,style:a.button,iconStyle:a.icon,ariaLabel:i.formatMessage({id:"helpButton.ariaLabel",defaultMessage:"Help"})})})}));var h=()=>o(955751),S=()=>o(401382),C=()=>o(858023),x=()=>o(88271);const b=(0,s().YK)({filterPlaceholder:{id:"collectionPicker.searchBarFilter.text",defaultMessage:"Filter…"}}),A=n.memo((function(e){const{collectionStore:t,isOverlay:a,onEmptyEnter:u,onEmptyPageClick:c,onCancelClick:d,canConfigureCollection:p,locked:m,onTemplateClick:y}=e,f=(0,r().Y0)(),[h,S]=(0,n.useState)(""),C=(0,i().uB)(void 0,o(210466).A),b=(0,i().K8)((()=>t.getTemplatePageStores().filter((e=>e.getAlive()))),[t]),A=(0,i().K8)((()=>b.every((e=>e.isReady()))),[b]),w=(0,i().K8)((()=>a&&null!=h&&h.length?(0,o(188877).Ay)(h,b,(e=>String(e.getProperties().title)??"")):b),[b,h,a]),_=(0,l().IS)((e=>({container:{fontSize:14,padding:f.isMobile?"12px 16px":"0 12px 4px 12px",color:e.text.tertiary,wordBreak:"keep-all",...f.isMobile&&{background:e.contentBackground,boxShadow:`0 1px 0 ${e.regularDividerColor}`,marginBottom:1}}})),[f.isMobile]);if(!A)return null;if(a){const e=b.length>6,n=f.isMobile?{menuType:v().gu.Modal,title:(0,g.jsx)(s().sA,{defaultMessage:"Database templates",id:"database.mobileTemplatesMenu.title"}),left:(0,g.jsx)(o(743668).CancelMenuText,{}),onClickLeft:d}:{menuType:v().gu.Popup,width:360};return(0,g.jsxs)(o(935091).A,{...n,header:(0,g.jsx)(j,{collectionStore:t}),children:[0===b.length&&(0,g.jsx)(x().A,{children:(0,g.jsx)("div",{style:_.container,children:(0,g.jsx)(s().sA,{defaultMessage:"Replicate page formats inside this database with templates.",id:"database.emptyTemplatesList.info"})})}),e?(0,g.jsx)(k,{templateInputValue:h,setTemplateInputValue:S}):null,(0,g.jsx)(M,{collectionStore:t,onEmptyEnter:u,onEmptyPageClick:c,onCancelClick:d,canConfigureCollection:p,isOverlay:a,locked:m,onTemplateClick:y,menuListStore:C,templateInputValue:h,filteredTemplatePageStores:w,draggable:!(e&&h)})]})}return(0,g.jsx)(M,{collectionStore:t,onEmptyEnter:u,onEmptyPageClick:c,onCancelClick:d,canConfigureCollection:p,isOverlay:a,locked:m,onTemplateClick:y,menuListStore:C,templateInputValue:h,filteredTemplatePageStores:w,draggable:!0})})),j=n.memo((function(e){const{collectionStore:t}=e,{isMobile:n}=(0,r().Y0)(),a=(0,s().tz)(),u=(0,o(622286).X)("db_ux_chrome"),c=(0,o(308265).BG)(),d=(0,i().K8)((()=>(0,o(202193).Qo)({intl:a,collectionStore:t,isDBUXChromeEnabled:u,isWorkflowsAppContainerEnabled:c})),[t,a,u,c]),p=(0,l().IS)((()=>({container:{marginTop:6}})),[]);return n?null:(0,g.jsx)(o(932322).Ay,{style:p.container,title:(0,g.jsx)(m,{prefix:(0,g.jsx)(s().sA,{id:"database.templatesList.templatesFor",defaultMessage:"Templates for"}),collectionName:d}),right:(0,g.jsx)(f,{helpButtonContext:"collection_templates_menu",href:(0,o(392608).xS)("guides.databaseTemplates")})})})),k=n.memo((function(e){const{templateInputValue:t,setTemplateInputValue:i}=e,{isMobile:a,isAndroid:u}=(0,r().Y0)(),c=(0,s().tz)(),d=(0,n.useCallback)((e=>i(e.currentTarget.value)),[i]),p=(0,l().IS)((()=>({container:{margin:a?0:"10px 0"},input:{...u&&{borderBottom:"none"}}})),[u,a]);return(0,g.jsx)("div",{style:p.container,children:(0,g.jsx)(S().Ay,{value:t,focusInitial:!a||void 0,placeholder:c.formatMessage(b.filterPlaceholder),showClearButton:!0,inputLeft:(0,g.jsx)(S().Zf,{icon:o(842940).J}),onChange:d,style:p.input})})})),M=n.memo((function(e){const{filteredTemplatePageStores:t,draggable:l,collectionStore:s,onEmptyEnter:p,onEmptyPageClick:m,onCancelClick:v,canConfigureCollection:f,isOverlay:S,locked:b,onTemplateClick:A,menuListStore:j,templateInputValue:k}=e,M=(0,r().v3)(),{isMobile:_}=(0,r().Y0)(),I=(0,n.useContext)(o(749975).p2),G=(0,n.useContext)(o(282131).n),V=(0,i().K8)((()=>(0,o(937968).EF)(M)),[M]),B=(0,n.useCallback)((e=>{j.unsetFocus(),d().createAndCommit({userAction:"CollectionTemplatePicker.handleCollectionTemplatesReorder",environment:M,canUndo:!0,perform:t=>c().lU({collectionStore:s,newTemplateIds:e,transaction:t})})}),[M,s,j]),T=(0,n.useCallback)((()=>{var e;V&&(p(),u().ki(M,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:!0,collection_id:s.id,collection_view_id:null==I||null===(e=I.collectionViewStore())||void 0===e?void 0:e.id}))}),[M,s,p,I,V]),P=(0,n.useCallback)((e=>{V&&(m(e.event),u().ki(M,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:"keydown"===e.event.type,...I&&(0,o(876695).sl)(I)}))}),[V,I,M,m]),F=(0,n.useCallback)((()=>{var e;if(!V)return;const{performResult:t}=d().createAndCommit({userAction:"CollectionTemplatePicker.newPage",environment:M,canUndo:!0,perform:e=>c().bI({environment:M,collectionStore:s,transaction:e,title:k})});if(t){const{mainEditorCurrentBlockStore:e}=o(485966).default.state,n=e?(0,y().Ay)({store:e,peekViewBlockId:t.id,fullyQualified:!1,pageVisitSource:a().y8.Create}):(0,y().Ay)({store:t,fullyQualified:!1,pageVisitSource:a().y8.Create});G?G(n):o(865226).oo({environment:M,url:n})}u().er(M,{collection_id:s.id,collection_view_id:null==I||null===(e=I.collectionViewStore())||void 0===e?void 0:e.id}),null==v||v()}),[V,M,s,I,k,v,G]),L=(0,n.useMemo)((()=>({key:"create-template",render:e=>(0,g.jsx)(w,{isOverlay:S,locked:b,menuListItemProps:e}),action:F})),[F,S,b]),R=(0,i().K8)((()=>null==I?void 0:I.defaultPageTemplateStore.state),[I]),E=(0,i().K8)((()=>({key:"empty",render:e=>0===t.length||""!==k?null:(0,g.jsx)(h().K,{collectionStore:s,canConfigureCollection:f,isOverlay:S,templateStore:void 0,isMobile:_,locked:b||!f,draggable:!0,isDefault:void 0===(null==R?void 0:R.id),onCancelClick:v,...e}),action:P})),[f,s,null==R?void 0:R.id,_,P,S,b,v,k,t.length]),K=(0,n.useCallback)((e=>{const t=e.getAutomationStore(),r=null!=t&&t.isActive()?t.getRecurrence():void 0,i=t&&!t.canEdit(),a="disabled_duplication"===(null==t?void 0:t.getStatus())||"disabled_inactive_space"===(null==t?void 0:t.getStatus()),u={key:e.id,render:t=>(0,n.createElement)(h().K,{...t,key:e.id,isOverlay:S,collectionStore:s,canConfigureCollection:f,templateStore:e,isMobile:_,locked:b,onCancelClick:v,draggable:l,isDefault:(null==R?void 0:R.id)===e.id,recurrence:r,recurrenceDisabled:a,recurrenceButtonDisabled:i}),action:t=>{V&&A({templateStore:e,isKeyboard:"keydown"===t.event.type,useCrdt:(0,o(236907).D8)(s.getSpaceStore())})}};return u}),[f,V,s,null==R?void 0:R.id,l,_,S,b,v,A]),O=(0,i().K8)((()=>{const e=t.map((e=>e.id)),n=[0!==t.length?{key:"templates",render:t=>{if(0===t.children.length)return null;const n=t.children.slice(0,t.children.length-1),r=t.children[t.children.length-1];return(0,g.jsx)(x().A,{...t,disableDesktopPadding:!S,disableMobileBorders:!0,children:(0,g.jsxs)(g.Fragment,{children:[_||b||!f?n.map(((e,t)=>n[t])):(0,g.jsx)(o(97787).Ay,{direction:"vertical",keys:e,disabled:!l,renderKey:t=>n[e.indexOf(t)],onDrop:B}),r]})})},items:[...t.map(K),E]}:null,f?{key:"create-template",render:e=>(0,g.jsx)(x().A,{topBorder:S,disableDesktopPadding:!S,disableMobileBorders:!0,...e}),items:[L]}:null];return n.filter((e=>null!==e))}),[t,K,E,f,L,S,_,b,l,B]);return(0,g.jsx)(C().Ay,{type:C().Oh.Vertical,store:j,sections:O,onEmptyEnter:T,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,resetFocusOnMouseOut:!0})})),w=n.forwardRef((function(e,t){const{menuListItemProps:n,isOverlay:r,locked:i}=e,l=(0,g.jsx)(s().sA,{defaultMessage:"New template",id:"database.templateView.newTemplateButton"});return r?(0,g.jsx)(o(276647).o,{title:l,color:"secondary",...n}):(0,g.jsx)(o(568344).J,{title:l,icon:(0,o(178063).plusIcon)(),type:"new_template",format:r?"collection-overlay":"page-menu-item",locked:i,...n})}))},981814:(e,t,o)=>{o.d(t,{j:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("parentItem",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.29662 5.47368L7.33167 4.11653L6.30839 5.24265L4.22625 7.32458C4.16064 7.39019 4.0821 7.43856 3.99288 7.47024C3.90958 7.5013 3.82192 7.51646 3.73089 7.51646C3.54036 7.51646 3.37427 7.45062 3.24187 7.31823L3.23992 7.31628C3.11249 7.18353 3.04999 7.01804 3.04999 6.82921C3.04999 6.63758 3.12598 6.46746 3.2656 6.32285L3.26711 6.32129L7.4749 2.10083C7.62016 1.9509 7.79567 1.87 7.99651 1.87C8.19734 1.87 8.37284 1.95089 8.51809 2.10079L12.7355 6.32457C12.8705 6.46954 12.943 6.63917 12.943 6.82921C12.943 7.01927 12.8775 7.18502 12.7458 7.31725C12.617 7.45083 12.4522 7.51646 12.2621 7.51646C12.1706 7.51646 12.0814 7.50115 11.995 7.47068L11.9926 7.4698C11.9069 7.43769 11.8313 7.38908 11.7668 7.32458L9.6802 5.238L8.65635 4.11153L8.69652 5.47736L8.69011 9.81896C8.69011 10.5736 8.80303 11.157 9.01808 11.5793C9.2312 11.9935 9.55909 12.2887 10.0079 12.4675L10.0088 12.4678C10.4652 12.6536 11.062 12.7499 11.8051 12.7499C11.952 12.7499 12.0793 12.7478 12.1871 12.7436C12.303 12.7393 12.417 12.7372 12.5287 12.7372C12.7186 12.7372 12.8855 12.7955 13.0191 12.9179C13.1612 13.0441 13.2287 13.2138 13.2287 13.4117C13.2287 13.5394 13.2018 13.6569 13.1388 13.7556C13.0846 13.8467 13.0093 13.919 12.9157 13.9718C12.8317 14.0256 12.7415 14.0631 12.6459 14.0833C12.5373 14.1068 12.4035 14.12 12.2469 14.1243C12.0973 14.1286 11.931 14.1307 11.748 14.1307C10.2678 14.1307 9.14333 13.8104 8.40142 13.144C7.6536 12.4723 7.29657 11.3702 7.29657 9.87609L7.29662 5.47368Z"})})},988360:(e,t,o)=>{o.d(t,{N:()=>r});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M6.653 2.375A.625.625 0 0 0 6.028 3v.474A3.62 3.62 0 0 0 7.24 6.179l.289.258-.157 1.603a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08H15c.345 0 .625-.28.625-.625v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625zm1.42 2.871c-.468-.417-.75-1-.79-1.621h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.293 3.197v.006h-8.75v-.006c0-1.447.922-2.733 2.293-3.197l.237-.08a.63.63 0 0 0 .422-.531l.227-2.318a.63.63 0 0 0-.206-.528z"})},r=(0,o(680369).wt)("pin",n)}}]);