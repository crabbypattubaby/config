"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[48979],{2921:(e,s,i)=>{i.d(s,{p:()=>o});var t=()=>i(294997),n=()=>i(378219);function o(e){const{spaceVisibleUserMap:s,store:i,userId:o}=e,r=s.get(o);if(!r||"none"!==r.role)return;if(!r.isTeamGuest)return"guest";const a=n().Uo(i),l=null==a?void 0:a.getModel();if(!l)return"guest";return(0,t().CG)({team:l,userId:o})?"team_level_guest":"guest"}},10456:(e,s,i)=>{i.d(s,{A:()=>C});i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(174114),r=()=>i(769884),a=()=>i(409211),l=()=>i(14931),d=()=>i(653998),m=()=>i(781007),c=()=>i(932322),u=()=>i(35462),p=()=>i(482570),g=()=>i(758103),h=()=>i(647242),b=()=>i(455831),f=()=>i(622286),v=()=>i(485966),y=()=>i(670682);var x=()=>i(268117),S=()=>i(895048),I=()=>i(849340),P=i(163643);function j(e){const{userValue:s,guestLabel:i,isRedesignEnabled:t}=e;return(0,P.jsx)(c().Ay,{title:(0,P.jsx)(_,{userValue:s,guestLabel:i}),caption:(0,P.jsx)(M,{userValue:s,isRedesignEnabled:t}),icon:(0,P.jsx)(A,{userValue:s}),desktopIconStyle:{marginLeft:16}})}function A(e){const{userValue:s,isInvited:i}=e,r=(0,t().Y0)().isMobile,a=(0,n().K8)((()=>(0,x().FI)()),[]),l=(0,o().IS)((e=>({iconPlaceholder:{height:r&&a?S().Bj:S().Ev,width:r&&a?S().Bj:S().Ev,borderRadius:20},invitedIcon:{borderRadius:20,outlineColor:e.accentColors.gray[300]}})),[r,a]);return s?(0,P.jsx)(p().A,{borderStyle:i?"dashed":void 0,iconStyle:i?l.invitedIcon:void 0,userValue:s,size:r&&a?S().Bj:S().Ev}):(0,P.jsx)(w,{style:l.iconPlaceholder})}function _(e){const{userValue:s,guestLabel:i}=e,t=(0,d().tz)(),r=(0,n().K8)((()=>(0,x().FI)()),[]),a=(0,n().K8)((()=>{const{currentUserStore:e}=v().default.state;return!!e&&(!!s&&e.id===s.id)}),[s]),c=(0,o().IS)((e=>({titlePlaceholder:{height:8,width:81,borderRadius:4},titleYouIndicator:{color:r?"dark"===e.mode?e.text.secondary:e.text.tertiary:e.text.secondary}})),[r]);if(!s)return(0,P.jsx)(w,{style:c.titlePlaceholder});const p=(0,l().c6)(t,s);return(0,P.jsx)(P.Fragment,{children:p?(0,P.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,P.jsx)(u().A,{className:"notranslate",children:a?(0,P.jsx)(d().sA,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:p,youIndicatorText:e=>(0,P.jsx)("span",{style:c.titleYouIndicator,children:e})}}):p}),i&&(0,P.jsx)(m().Q,{labelType:i,shouldUseTabStyle:r})]}):(0,P.jsx)(d().sA,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function M(e){const{userValue:s,isRedesignEnabled:i,permissionRole:n}=e,{isMobile:r}=(0,t().Y0)(),a=(0,o().IS)((()=>({subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10}})),[]);if(i&&r&&n){const e=(0,g().R)({type:"user_permission",role:n,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:i}).label;return(0,P.jsx)(u().A,{isSmall:!0,children:(0,P.jsx)(d().sA,{...e})})}return null!=s&&s.email?(0,P.jsx)(u().A,{isSmall:!0,children:s.email}):(0,P.jsx)(w,{style:a.subtitlePlaceholder})}function w(e){const s=(0,o().IS)((s=>({placeholder:{...e.style,background:s.lightDividerColor}})),[e.style]);return(0,P.jsx)("div",{style:s.placeholder})}function k(e){const{userValue:s,permissionItem:i,store:t}=e,n=(0,d().tz)(),o=r().Bj6.fromValue(a().oo,s),l=null==o?void 0:o.getDisplayName(n),m=!(null!=s&&s.onboarding_completed||null!=s&&s.mobile_onboarding_completed),c=(0,I().z)({permissionItem:i,targetType:"user",targetName:l,store:t});return m?(0,P.jsx)(d().sA,{defaultMessage:"User has not yet created an account",id:"blockPermissionsSettings.notOnboarded.message"}):c||null}const C=function(e){const{store:s,userPermission:o,spaceVisibleUserMap:r,fromPermissionWrapper:l}=e,d=(0,t().v3)().device.isMobile,m=(0,n().K8)((()=>(0,x().FI)()),[]),c=(0,n().K8)((()=>i(413871).LU.createChildStore(s,{table:a().oo,id:o.permissionItem.user_id}).getValue()),[s,o.permissionItem.user_id]),u=function(){const e=(0,n().O$)(v().AppStoreCurrentSpaceStore),s=(0,y().f_)({spaceId:null==e?void 0:e.id}),i=(0,n().K8)((()=>{if(!e)return!1;const i=(0,h().AI)(s);return(0,b().dL)(i)||(0,b().Pg)(i)}),[e,s]),t=(0,f().X)("personal_sharing_distinguish_guest_type");return i&&t}(),p=(0,n().K8)((()=>{const e=(null==c?void 0:c.onboarding_completed)||(null==c?void 0:c.mobile_onboarding_completed);return null==c||!c.id||!e&&u?null!=c&&c.id&&!e&&u?"invited":void 0:(0,i(2921).p)({spaceVisibleUserMap:r,userId:c.id,store:s})}),[s,r,c,u]),g="invited"===p;return(0,P.jsx)("div",{children:(0,P.jsx)(S().Ay,{store:s,permissionItem:o.permissionItem,from:o.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,P.jsx)(A,{userValue:c,isInvited:g}),title:(0,P.jsx)(_,{userValue:c,guestLabel:p}),subtitle:g?void 0:(0,P.jsx)(M,{userValue:c,isRedesignEnabled:m,permissionRole:o.permissionItem.role}),selectHeader:m&&d?(0,P.jsx)(j,{userValue:c,guestLabel:p,isRedesignEnabled:m}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:l,roleItemOverrides:e.roleItemOverrides,nonInheritedTooltip:m&&!e.tooltip?(0,P.jsx)(k,{userValue:c,permissionItem:o.permissionItem,store:s}):e.tooltip,menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs})},o.permissionItem.user_id)}},22097:(e,s,i)=>{i.d(s,{x:()=>r});i(725707),i(771702);var t=()=>i(803290),n=()=>i(111826),o=()=>i(305043);function r(){return(0,t().K8)((()=>{const e=o().subscriptionDataStoreInstance.state,s=e?n().Be(e):[],i=new Map;return s.forEach((e=>{i.set(e.userId,e)})),i}),[])}},28251:(e,s,i)=>{i.d(s,{u:()=>d});i(242343);var t=()=>i(653998),n=()=>i(145046),o=()=>i(919536),r=()=>i(84543),a=()=>i(990616),l=i(163643);async function d(e){const{environment:s,useSudoMode:i,store:d}=e,m={type:"restoreTeamPermissions",permissionChanges:[]},{accept:c}=await n().Gh({message:(0,a().r6)(m),acceptLabel:(0,a().QU)(m),cancelLabel:(0,l.jsx)(t().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"})});c&&r().createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:s,canUndo:!0,useSudoMode:i,perform:e=>{o().zE({environment:s,store:d,transaction:e})}})}},48150:(e,s,i)=>{i.d(s,{a:()=>o});var t=i(242343),n=i(163643);const o=t.forwardRef(((e,s)=>{const t=(0,i(174114).IS)((s=>({buttonStyle:{paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2,width:"100%",marginLeft:0,background:"transparent",...e.buttonStyle},menuItemStyle:{gap:6,background:"transparent",...e.style},innerContainer:{marginLeft:0,paddingLeft:0,minWidth:"auto",color:e.disabled?s.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:s.text.secondary,margin:0,...e.rightStyle}})),[e.disabled,e.rightStyle,e.buttonStyle,e.style]);return(0,n.jsx)(i(535906).A,{role:"button",...e,ref:s,style:t.menuItemStyle,buttonStyle:t.buttonStyle,textWrapperStyle:t.innerContainer,desktopIconStyle:t.desktopIconStyle,rightStyle:t.rightStyle})}));o.displayName="SiteSettingButtonMenuItem"},53857:(e,s,i)=>{i.r(s),i.d(s,{GeneralAccessPermissionSection:()=>$e,InheritedPermissionsListV2:()=>Ye,default:()=>Ze});i(333225),i(494367),i(516262),i(573119),i(240480),i(950443),i(619601),i(725707),i(107652),i(491955),i(500234),i(771702),i(403517);var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(162901),l=()=>i(519423),d=()=>i(446588),m=()=>i(409211),c=()=>i(14931),u=()=>i(653998),p=()=>i(975392),g=()=>i(441288),h=()=>i(818369),b=()=>i(88271),f=()=>i(352723),v=()=>i(591130),y=()=>i(967454),x=()=>i(622286),S=()=>i(931371),I=()=>i(98508),P=()=>i(485966),j=()=>i(736953),A=()=>i(836331),_=()=>i(413871),M=()=>i(432809),w=()=>i(636208),k=()=>i(22097),C=()=>i(422340),T=()=>i(328207),R=()=>i(10456),B=()=>i(482421),N=()=>i(174427),D=()=>i(870122),L=()=>i(680369),E=()=>i(758103),W=()=>i(983050),O=()=>i(111664),K=()=>i(867739),U=()=>i(962373),F=()=>i(880026),z=()=>i(234467),G=()=>i(895048),V=()=>i(436599),H=i(163643);const q={type:"public_permission",role:"none",is_public_share_link:!1};function Y(e){const{store:s,spacePermission:i,publicPermission:a,trustedDomainPermission:l,showTrustedDomainPermission:m,permissionItemArgs:c,fromPermissionWrapper:u,isRestricted:p}=e,{permissionItem:g,from:h}=a,{location:b,sudoModeStore:f}=c,v=(0,n().v3)(),{isMobile:y}=(0,n().Y0)(),x=(0,o().uB)(void 0,U().A),S=(0,o().K8)((()=>!v.currentUser.isLoggedIn()),[v.currentUser]),I="none"!==i.permissionItem.role,P=(0,N().v)(g)?g:{...g,...q},j=(0,t.useCallback)((()=>{x.setState({open:!0})}),[x]),_=(0,t.useCallback)((async e=>{const i=(0,d().Yi)(h)!==s.id;if("string"!=typeof e||!(e in d().TE))return!1;const t=(0,O().u)(g,e),n=await(0,F().Hc)({environment:v,store:s,oldPermissionItem:g,newPermissionItem:t,wasInherited:i,location:b,sudoModeStore:f});return A().default.logEvent("public_share_link_role_updated",e),n}),[v,s,g,h,b,f]),M=(0,t.useCallback)((async e=>{const i=(0,d().Yi)(h)!==s.id,t={...g,expiration_timestamp:e};return await(0,F().Hc)({environment:v,store:s,oldPermissionItem:g,newPermissionItem:t,wasInherited:i,location:b,sudoModeStore:f})}),[v,s,g,h,b,f]),w=(0,r().IS)((e=>({container:{width:"100%"},linkExpirationContainer:y?{minHeight:0}:{},linkExpirationButton:y?{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,width:void 0,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.stroke.secondary,background:e.surface.elevated}:{padding:0}})),[y]),k=(0,t.useMemo)((()=>[{role:"none",prefixItem:{key:"link-expiration",render:e=>(0,H.jsx)("div",{...e,children:(0,H.jsx)(K().A,{permissionItem:g,hideIcon:!0,onChange:M,focused:!1,buttonStyle:w.linkExpirationButton,style:w.linkExpirationContainer})}),action:()=>{}}}]),[g,M,w.linkExpirationButton,w.linkExpirationContainer]);return(0,H.jsx)("div",{style:w.container,className:W().VRj,children:(0,H.jsx)(G().Ay,{store:s,permissionItem:P,from:h,shouldDisable:S,fromPermissionWrapper:u,onClick:j,onChange:_,roleItemOverrides:k,icon:(0,H.jsx)($,{}),title:(0,H.jsx)(z().o,{store:s,spacePermission:i,showTrustedDomainPermission:m,trustedDomainPermission:l,publicPermission:a,showPublicShareLinkPermission:!0,isRestricted:p,permissionItemArgs:c,fromPermissionWrapper:u,buttonPopupStore:x,hideHoverStyles:!1,isDisplayOnly:c.shouldDisable??!1,title:(0,H.jsx)(Q,{}),onlyShowPrivateSpaceVisibility:I}),subtitle:y?(0,H.jsx)(X,{role:g.role}):void 0,upgradeButtonName:"public_share_link_item",isRemovableOverride:!0,renderTitleWithoutUILabelWrapper:!0,...c})})}function $(){const e=(0,n().v3)().device.isMobile,s=(0,r().IS)((()=>({globeIcon:{width:e?24:L().Ev.default,height:e?24:L().Ev.default}})),[e]);return(0,H.jsx)(V().A,{type:"square",iconType:"function",iconFn:D().globeIcon,iconStyle:s.globeIcon,isMobile:e})}function Q(){const e=(0,r().IS)((()=>({title:{fontSize:14,whiteSpace:"normal"}})),[]);return(0,H.jsx)("div",{style:e.title,children:(0,H.jsx)(u().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.permissionItem.title"})})}function X(e){const{role:s}=e;return(0,n().v3)().device.isMobile?(0,H.jsx)(u().sA,{...(0,E().R)({type:"public_permission",role:s,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0,isPublicShareLink:!0}).label}):null}var J=()=>i(259738),Z=()=>i(477988);function ee(e){const{store:s,spacePermission:i,showSpacePermission:t,trustedDomainPermission:n,showTrustedDomainPermission:o,publicPermission:r,showSitePublicPermission:a,showPublicShareLinkPermission:l,permissionItemArgs:d,isRestricted:m}=e,c=(0,N().v)(r.permissionItem);return(0,H.jsxs)(H.Fragment,{children:[t&&se(i,r,l)&&(0,H.jsx)(Z().A,{store:s,spacePermission:i,publicPermission:r,showPublicShareLinkPermission:l&&!c,trustedDomainPermission:n,showTrustedDomainPermission:o,permissionItemArgs:d,fromPermissionWrapper:"permission_list",isRestricted:m,shouldShowPublicShareLinkTooltip:!c}),l&&c&&(0,H.jsx)(Y,{store:s,spacePermission:i,publicPermission:r,trustedDomainPermission:n,showTrustedDomainPermission:o,permissionItemArgs:d,fromPermissionWrapper:"permission_list",isRestricted:m}),a&&r&&(0,H.jsx)(J().P,{store:s,publicPermissionItem:r,permissionItemArgs:d})]})}function se(e,s,i){return!i||("none"!==e.permissionItem.role||"none"===e.permissionItem.role&&!(0,N().v)(s.permissionItem))}var ie=()=>i(222787),te=()=>i(232376),ne=()=>i(439510),oe=()=>i(496505),re=()=>i(55144),ae=()=>i(155342),le=()=>i(21164),de=()=>i(793613),me=()=>i(103151),ce=()=>i(907721),ue=(i(362833),i(113085),()=>i(916963)),pe=()=>i(77654);const ge={viewBox:"0 0 20 20",svg:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("path",{d:"M10 5.875c.345 0 .625.28.625.625v2.875H13.5a.625.625 0 1 1 0 1.25h-2.875V13.5a.625.625 0 1 1-1.25 0v-2.875H6.5a.625.625 0 1 1 0-1.25h2.875V6.5c0-.345.28-.625.625-.625"}),(0,H.jsx)("path",{d:"M8.497 2.222c.83-.83 2.176-.83 3.005 0l6.276 6.275c.83.83.83 2.176 0 3.006l-6.275 6.275c-.83.83-2.176.83-3.006 0l-6.275-6.275a2.125 2.125 0 0 1 0-3.006zm2.122.884a.875.875 0 0 0-1.238 0L3.106 9.38a.875.875 0 0 0 0 1.238l6.275 6.275a.875.875 0 0 0 1.238 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},he=(0,L().wt)("plusDiamond",ge);var be=()=>i(84543),fe=()=>i(209684),ve=()=>i(535906),ye=()=>i(273520),xe=()=>i(858023),Se=()=>i(951540),Ie=()=>i(951514);function Pe(e){let{store:s,collectionStore:i,calculatedPermissions:r,permissionItemArgs:a,disabled:l}=e;const d=(0,o().uB)(void 0,U().A),{isMobile:m}=(0,n().Y0)(),c=(0,t.useCallback)((e=>(0,H.jsx)(je,{buttonPopupEvents:e,disabled:l,collectionStore:i})),[l,i]);return i?(0,H.jsx)(ye().Ay,{popupType:m?ye().z7.BottomSheet:ye().z7.Popup,forceInitialInbound:!0,buttonPopupStore:d,renderOrigin:c,originGap:m?void 0:8,style:{},onClick:()=>{},render:e=>(0,H.jsx)(_e,{blockStore:s,collectionStore:i,onCreateRuleComplete:()=>e.close()}),onDismiss:()=>{},onClose:()=>{}}):null}function je(e){let{buttonPopupEvents:s,disabled:i,collectionStore:t}=e;const{isMobile:a}=(0,n().Y0)(),l=(0,r().IS)((e=>({button:{height:"unset",padding:"6px 8px"},textContainer:{display:"flex",flexDirection:"column",paddingLeft:10},buttonSubtitle:{color:e.text.tertiary},iconContainer:{background:e.tint.uiBlue},icon:{fill:e.icon.uiBluePrimary}})),[]),d=(0,o().K8)((()=>t.getPropertyPermissionItems({filterOutInvalidItems:!0}).length>0),[t]);return(0,H.jsxs)(fe().p,{...s,mobileFeedback:a,style:l.button,disabled:i,disabledFeedback:i,children:[(0,H.jsx)(V().A,{type:"square",iconType:"function",iconFn:he,containerStyle:l.iconContainer,iconStyle:l.icon,isMobile:a}),(0,H.jsxs)("div",{style:l.textContainer,children:[(0,H.jsx)("span",{children:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.title",defaultMessage:"Add new rule"})}),!d&&(0,H.jsx)("span",{style:l.buttonSubtitle,children:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.subtitle",defaultMessage:"Ex. Anyone selected in Assignees should have edit access"})})]})]})}const Ae=12;function _e(e){let{blockStore:s,collectionStore:i,onCreateRuleComplete:a}=e;const{isMobile:l}=(0,n().Y0)(),d=(0,n().v3)(),m=(0,o().K8)((()=>i.getSchema()),[i]),c=(0,o().K8)((()=>i.getPropertyPermissionItems({filterOutInvalidItems:!0})),[i]),p=(0,t.useMemo)((()=>m?Object.entries(m).filter((e=>{let[s,i]=e;return"person"===(null==i?void 0:i.type)})).map((e=>{let[s,i]=e;return s})):[]),[m]),g=(0,r().DP)(),h=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",width:l?"100%":"320px",margin:Ae},divider:{borderTop:`1px solid ${e.fill.graySecondary}`,margin:`0 -${Ae}px`,width:`calc(100% + ${2*Ae}px)`},popupTitle:{color:e.text.secondary,fontWeight:500,fontSize:14,lineHeight:"20px"},roleSelectButton:{display:"flex",justifyContent:"space-between",background:e.surface.wash,border:`1px solid ${e.text.quaternary}`,marginTop:12,marginBottom:10},createRuleButton:{width:"100%"},noPropertiesAvailableMenuItem:{color:e.text.tertiary}})),[l]),[f,v]=t.useState("read_and_write"),[y,x]=t.useState(void 0),S=(0,t.useCallback)((()=>{if(!i||!y)return;const e=(0,_().G_)(i,i.pointer,"permissions");a(),be().createAndCommit({userAction:"AddNewPropertyPermissionPopup.onCreateRule",environment:d,canUndo:!0,perform:s=>{be().applyOperation({store:e,operation:{pointer:e.pointer,command:"setPermissionItem",path:e.path,args:{type:"collection_property_permission",property_info:y,role:f}},transaction:s})}})}),[i,d,y,f,a]),I=(0,t.useMemo)((()=>{const e=c.some((e=>"page_creator"===e.property_info.type)),s=[];for(const i of p){if(c.some((e=>"person"===e.property_info.type&&e.property_info.property_id===i)))continue;const e=null==m?void 0:m[i];e&&s.push({key:i,action:()=>{x({type:"person",property_id:i})},render:s=>(0,H.jsx)(ve().A,{...s,title:e.name,icon:(0,H.jsx)(ue().zB,{type:e.type,icon:e.icon,size:20,theme:g,style:{fill:g.icon.primary}}),isChecked:"person"===(null==y?void 0:y.type)&&(null==y?void 0:y.property_id)===i,focused:s.focused,buttonStyle:{padding:0}})})}e||s.push({key:"page_creator",action:()=>{x({type:"page_creator"})},render:e=>(0,H.jsx)(ve().A,{...e,title:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.pageCreator",defaultMessage:"Created by"}),icon:(0,pe().personCircleFillIcon)({width:20}),isChecked:"page_creator"===(null==y?void 0:y.type),focused:e.focused,buttonStyle:{padding:0}})}),0===s.length&&s.push({key:"no_available_properties",action:()=>{},render:e=>(0,H.jsx)(ve().A,{...e,style:h.noPropertiesAvailableMenuItem,disabled:!0,title:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.noPropertiesMessage",defaultMessage:"No available properties"})})});return[{key:"options_section",items:s,render:e=>(0,H.jsx)(b().A,{...e,style:{paddingLeft:0,paddingRight:0,paddingTop:8,paddingBottom:8}})}]}),[m,c,p,y,h.noPropertiesAvailableMenuItem,g]);return(0,H.jsxs)("div",{style:h.container,children:[(0,H.jsx)("div",{children:(0,H.jsx)("div",{style:h.popupTitle,children:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.title",defaultMessage:"Grant access to anyone in..."})})}),(0,H.jsx)("div",{children:(0,H.jsx)(xe().Ay,{type:xe().Oh.Vertical,initialFocus:void 0,sections:I})}),(0,H.jsx)("div",{style:h.divider}),(0,H.jsx)("div",{children:(0,H.jsx)(Ie().Ay,{table:"collection",type:"collection_property_permission",role:f,upgradeButtonName:"collection_property_permissions",onChange:e=>{v(e)},buttonStyle:h.roleSelectButton,availableRoleItems:["editor","read_and_write","comment_only","reader"].map((e=>({role:e})))})}),(0,H.jsx)(Se().A,{disabled:!y,style:h.createRuleButton,onClick:S,children:(0,H.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.createButton",defaultMessage:"Create rule"})})]})}var Me=()=>i(427240);const we={viewBox:"0 0 20 20",svg:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("path",{d:"M9.834 13.113a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.142-6.874c1.408 0 2.792.934 2.792 2.361 0 .84-.509 1.527-1.176 1.933l-.77.524.002.001a.9.9 0 0 0-.406.723.625.625 0 0 1-1.25 0c0-.706.368-1.352.945-1.751l.003-.002.799-.546.027-.018c.394-.24.576-.566.576-.864 0-.493-.552-1.111-1.542-1.111-.84 0-1.401.477-1.513.925A.625.625 0 0 1 7.25 8.11c.287-1.15 1.478-1.872 2.726-1.872"}),(0,H.jsx)("path",{d:"M8.498 2.221c.83-.83 2.175-.83 3.005 0l6.275 6.277c.83.83.83 2.175 0 3.005l-6.275 6.275c-.83.83-2.175.83-3.005 0L2.22 11.503a2.125 2.125 0 0 1 0-3.005zm2.12.885a.875.875 0 0 0-1.237 0L3.106 9.381a.875.875 0 0 0 0 1.238l6.275 6.275a.875.875 0 0 0 1.238 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},ke=(0,L().wt)("questionDiamond",we);var Ce=()=>i(76394);function Te(e){const{collectionStore:s,disabled:i}=e,t=(0,o().K8)((()=>s.getPropertyPermissionItems({filterOutInvalidItems:!1})),[s]);return 0===t.length?null:(0,H.jsx)(H.Fragment,{children:t.map(((e,t)=>(0,H.jsx)(Re,{collectionStore:s,permissionItem:e,disabled:i},t)))})}function Re(e){let{collectionStore:s,permissionItem:i,disabled:a}=e;const l=(0,n().v3)().device.isMobile,d=(0,o().K8)((()=>s.getSchema()),[s]),m=(0,r().IS)((e=>({errorText:{color:e.text.orangeSecondary},errorStateIcon:{fill:e.icon.orangeSecondary},errorStateIconContainer:{background:e.fill.orangeSecondary}})),[]),c=i.property_info.type,p=(0,o().K8)((()=>{if("person"===c){const e=i.property_info.property_id,s=d[e];return s?"person"!==s.type?"incorrect_property_type":void 0:"property_not_found"}}),[c,d,i]),g=(0,r().DP)(),h=(0,o().K8)((()=>{switch(c){case"page_creator":return(0,H.jsx)(V().A,{type:"square",iconType:"function",iconFn:Me().peopleFillIcon,isMobile:l,iconStyle:{width:18,height:18}});case"person":const e=i.property_info.property_id,s=d[e];return"property_not_found"===p?(0,H.jsx)(V().A,{type:"square",iconType:"function",iconFn:pe().personCircleFillIcon,isMobile:l,iconStyle:m.errorStateIcon,containerStyle:m.errorStateIconContainer}):"incorrect_property_type"===p?(0,H.jsx)(V().A,{type:"square",iconType:"function",iconFn:ke,isMobile:l,iconStyle:m.errorStateIcon,containerStyle:m.errorStateIconContainer}):s?(0,H.jsx)(V().A,{type:"square",iconType:"element",element:(0,H.jsx)(ue().zB,{type:s.type,icon:s.icon,size:18,theme:g})}):null}}),[c,l,m.errorStateIconContainer,m.errorStateIcon,i.property_info,d,p,g]),b=(0,t.useMemo)((()=>{switch(c){case"page_creator":return(0,H.jsx)(u().sA,{defaultMessage:"Page creator",id:"propertyPermissions.pageCreator.label"});case"person":const e=i.property_info.property_id,s=null==d?void 0:d[e];return"property_not_found"===p?(0,H.jsx)("div",{style:m.errorText,children:(0,H.jsx)(u().sA,{defaultMessage:"Missing property",id:"propertyPermissionItem.person.missingProperty.label"})}):"incorrect_property_type"===p?(0,H.jsx)("div",{style:m.errorText,children:(0,H.jsx)(u().sA,{defaultMessage:"Incorrect property type",id:"propertyPermissionItem.person.incorrectPropertyType.label"})}):(0,H.jsx)(u().sA,{defaultMessage:"Anyone in {propertyName}",id:"propertyPermissions.personProperty.label",values:{propertyName:(null==s?void 0:s.name)??""}});default:(0,Ce().HB)(c)}}),[c,i,d,p,m.errorText]);return(0,H.jsx)(G().Ay,{store:s,permissionItem:i,from:{table:le().Vl,collectionId:s.id},icon:h,title:b,upgradeButtonName:"collection_property_permissions",isRemovableOverride:!0,shouldDisable:a})}function Be(e){let{blockStore:s,calculatedPermissions:i,permissionItemArgs:t}=e;const n=(0,o().K8)((()=>{const e=s.getParentStore(),i=s.getCollectionStoreIfSingleSource();return(null==e?void 0:e.table)===le().Vl?{renderMode:"page_in_collection",collectionStore:e}:i?{renderMode:"collection",collectionStore:i}:void 0}),[s]),a=(0,o().K8)((()=>{var e;return null==n||null===(e=n.collectionStore)||void 0===e?void 0:e.canAdmin()}),[n]),l=(0,o().K8)((()=>"collection"!==(null==n?void 0:n.renderMode)||!a),[a,null==n?void 0:n.renderMode]),d=(0,o().K8)((()=>((null==n?void 0:n.collectionStore.getPropertyPermissionItems({filterOutInvalidItems:!0}))||[]).length>0),[n]),m=(0,o().K8)((()=>{var e;return null==n||null===(e=n.collectionStore)||void 0===e?void 0:e.isPageTreeCollection()}),[n]),c=(0,r().IS)((e=>({helpIcon:{width:14,height:14,color:e.icon.tertiary,marginLeft:-2}})),[]);return!(null!=n&&n.collectionStore)||m||!d&&"page_in_collection"===(null==n?void 0:n.renderMode)?null:(0,H.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingLeft:8,paddingRight:8,paddingBottom:8},children:[(0,H.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,H.jsx)("span",{style:{paddingTop:2},children:(0,H.jsx)(ie().E3,{})}),(0,H.jsx)(me().A,{renderTooltip:()=>(0,H.jsx)(u().sA,{id:"collectionPropertyPermissionsSection.tooltip",defaultMessage:"Ex. Anyone selected in Assignees should have edit access"}),placement:ce().W.Top,render:e=>(0,H.jsx)("div",{...e,children:(0,ae().questionMarkCircleIcon)(c.helpIcon)})}),"collection"===(null==n?void 0:n.renderMode)&&(0,H.jsx)(de().E,{newBadgeKey:"collection_property_permissions",didUserEngage:!1,keyType:"date"})]}),(0,H.jsx)(Te,{collectionStore:n.collectionStore,disabled:l}),"collection"===(null==n?void 0:n.renderMode)&&(0,H.jsx)(Pe,{store:s,collectionStore:n.collectionStore,calculatedPermissions:i,permissionItemArgs:t,disabled:l})]})}var Ne=()=>i(145017),De=()=>i(28210),Le=()=>i(709237),Ee=()=>i(378219);function We(e){const{store:s,isExpanded:a,numberOfPeopleInvited:l,inheritedPermissionRole:d,permissionItemArgs:m,onToggle:c}=e,p=(0,n().v3)(),g=p.device.isMobile,h=(0,o().K8)((()=>(0,Ee().fU)(s)[1]),[s]),[b,f]=t.useState(!1),v=(0,o().K8)((()=>{const e=(0,Ee().fU)(s)[1];if(e instanceof _().h4)return{icon:(0,H.jsx)(i(424339).x,{disabled:!0,store:e,size:g?G().Bj:G().Ev}),title:e.getName()};if(e instanceof _().Bv){if("page"===e.getType()){const s=e.isEmptyPage();return{icon:(0,H.jsx)(De().B,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:s}),title:(0,H.jsx)(Le().A,{shouldWrap:!0,store:e}),fromTable:Ne().ev,fromId:e.id}}return"collection_view"===e.getType()||"collection_view_page"===e.getType()?{icon:(0,H.jsx)(De().B,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:e.isDefined()}),title:(0,H.jsx)(Le().A,{shouldWrap:!0,store:e}),fromTable:Ne().ev,fromId:e.id}:void 0}}),[s,g]),y=(0,t.useCallback)((()=>f(!0)),[]),x=(0,t.useCallback)((()=>f(!1)),[]),S=(0,r().IS)((e=>({mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${a?90:0}deg)`,transition:"transform 150ms ease"},roleButton:{color:e.text.secondary,fontSize:(0,w().kx)({environment:p,isRedesignEnabled:!0})},selectContainer:{opacity:a?0:1},loadingSubtitleContainer:{display:"flex",alignItems:"center"},placeholderSubtitle:{height:12,width:14,borderRadius:4,marginRight:2}})),[p,a]),I={type:"display_only_inherited_permission",role:d??"access"};return v?(0,H.jsx)(G().Ay,{icon:v.icon&&(0,H.jsx)(i(769094).A,{onClick:c,expanded:a,hovered:b,children:(0,H.jsx)(V().A,{type:"circle",iconType:"element",element:v.icon,isMobile:g})}),store:s,permissionItem:I,onMouseEnter:y,onMouseLeave:x,from:{table:Ne().ev,blockId:v.fromId?v.fromId:s.id},title:g?(0,H.jsxs)("div",{style:S.mobileTitleContainer,children:[(0,H.jsx)("div",{style:S.mobileTextContainer,children:(0,H.jsx)(u().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:v.title}})}),(0,H.jsx)("div",{style:S.mobileChevronIcon,children:(0,i(855470).V)({height:12,width:12})})]}):(0,H.jsx)(u().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:v.title}}),subtitle:l?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(u().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person} other {{numberOfPeopleInvited} people}}",values:{numberOfPeopleInvited:l}}),g&&(0,H.jsxs)(H.Fragment,{children:[" 路 ",(0,H.jsx)(u().sA,{...(0,E().R)({type:I.type,role:I.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0}).label})]})]}):(0,H.jsxs)("div",{style:S.loadingSubtitleContainer,children:[(0,H.jsx)(i(517198).A,{style:S.placeholderSubtitle}),(0,H.jsx)(u().sA,{id:"inheritedPermissionItem.subtitle.people",defaultMessage:"people",values:{numberOfPeopleInvited:l}}),g&&(0,H.jsxs)(H.Fragment,{children:[" 路 ",(0,H.jsx)(u().sA,{...(0,E().R)({type:I.type,role:I.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0}).label})]})]}),inheritedTooltip:l&&l>0?(0,H.jsx)(u().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited.tooltip",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person has } other {{numberOfPeopleInvited} people have}} access through the parent page {inlineIconAndName}",values:{numberOfPeopleInvited:l,inlineIconAndName:(0,H.jsx)(i(129663).A,{store:h,useInvertedColors:!0})}}):null,upgradeButtonName:"team_permission_item",onClick:c,permissionRoleSelect:(0,H.jsx)("div",{style:S.selectContainer,children:(0,H.jsx)(E().Y,{type:I.type,role:I.role,icon:i(688322).d,disabled:!0,buttonStyle:S.roleButton,table:Ne().ev,isCurrentUser:!1,from:"shareMenu"})}),isCollapsible:!0,style:e.style,...m}):null}const Oe=t.memo(We);var Ke=()=>i(269280),Ue=()=>i(31448),Fe=()=>i(35462);const ze=(0,u().YK)({commenter:{id:"permissionsLevelBanner.commenter.labelV2",defaultMessage:"You can only comment on this page"},reader:{id:"permissionsLevelBanner.reader.labelV2",defaultMessage:"You can only view this page"}});function Ge(e){let{store:s,role:i}=e;const o=(0,n().v3)(),{isMobile:a}=(0,n().Y0)(),[l,d]=(0,t.useState)("noRequest"),m=(0,x().X)("share_menu_inheritance_banner");(0,Ke().l)((()=>{g().VJ(o,{share_menu_session_id:C().Ay.state.sessionId,role:i})}));const c=(0,r().IS)((e=>({container:{...(0,w().kJ)({theme:e,inheritanceBannerEnabled:m,isMobile:a}),display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},bannerLabel:{display:"flex"},pendingAccessRequestLabel:{color:e.text.tertiary},accessRequestLabel:{color:e.text.uiBluePrimary},accessRequestButton:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:Ue().Wy.medium,flexShrink:0,borderRadius:4,paddingLeft:6,paddingRight:6,margin:-4,height:24}})),[a,m]),p=(0,t.useCallback)((async()=>{var e;if("reader"!==i&&"comment_only"!==i)return;const t=await h().callApi({eventName:"requestAccess",environment:o,data:{type:"current-actor-to-block",block:{id:s.id,spaceId:s.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:i},message:void 0}});"success"===t.type&&t.data.request?(d("requested"),g().T_(o,{request_access_type:"page",previous_access_level:i,requested_access_level:"read_and_write",requestId:t.data.requestId})):"failed"===t.type&&"UserRateLimitResponse"===(null===(e=t.body)||void 0===e?void 0:e.name)&&d("rateLimited")}),[o,i,s]),b=function(e){switch(e){case"comment_only":return ze.commenter;case"reader":return ze.reader;case"editor":case"read_and_write":case"none":case"membership_admin":case"content_only_editor":return null;default:(0,Ce().HB)(e)}}(i);return b?(0,H.jsxs)("div",{style:c.container,children:[(0,H.jsx)("div",{style:c.bannerBodyContainer,children:(0,H.jsx)(Fe().A,{style:c.bannerLabel,isMultiline:!0,isSmall:m,children:(0,H.jsx)(u().sA,{...b})})}),(0,H.jsx)(fe().p,{isBlue:!0,style:c.accessRequestButton,onClick:p,disabled:"noRequest"!==l,children:(0,H.jsx)(Fe().A,{isSmall:m,style:"noRequest"===l?c.accessRequestLabel:c.pendingAccessRequestLabel,children:"requested"===l?(0,H.jsx)(u().sA,{defaultMessage:"Requested edit access",id:"permissionsLevelBanner.requestPermission.accessRequestedV2"}):"rateLimited"===l?(0,H.jsx)(u().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,H.jsx)(u().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}):null}var Ve=()=>i(874039);function He(e){let{dividerType:s,scrollerStore:i}=e;const n=(0,o().K8)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),a=(0,y().CR)(n),l=(0,y().yE)(n),d=(0,y().o7)(n),m=(0,t.useMemo)((()=>{if("top"===s)return l>0;return Math.ceil(l+d+10)<Math.floor(a)}),[s,d,a,l]),c=(0,r().IS)((e=>({divider:{opacity:m?1:0,height:1,borderTop:`1px solid ${e.regularDividerColor}`,padding:"0px 16px",transition:"opacity 200ms",margin:"0px 16px"}})),[m]);return(0,H.jsx)("div",{style:c.divider})}function qe(e){let{store:s,calculatedPermissions:i,permissionItemArgs:t}=e;const{showTeamPermission:n,mostPermissiveAncestorTeamGuestItem:o,mostPermissiveAncestorTeamMemberItem:r,mostPermissiveAncestorTeamOwnerItem:a,pagePermissionUIModel:l}=i;return(0,H.jsxs)(H.Fragment,{children:[n&&a&&r&&(0,H.jsx)(re().A,{store:s,blockTeamOwnerPermission:a,blockTeamMemberPermission:r,blockTeamGuestPermission:o,permissionItemArgs:t}),Xe({store:s,mostPermissiveTeamPermissions:l.mostPermissiveTeamPermissions,permissionItemArgs:t})]})}function Ye(e){const{store:s,permissionItemArgs:i,inheritedPagePermissions:o}=e,l=(0,n().v3)(),[d,m]=t.useState(!1),{mostPermissiveGroupPermissions:c,mostPermissiveUserPermissions:u}=o,p=function(e){var s,i;const{mostPermissiveGroupPermissions:t,mostPermissiveUserPermissions:n}=e;let o="access";const r=(null===(s=n[0])||void 0===s?void 0:s.permissionItem.role)||(null===(i=t[0])||void 0===i?void 0:i.permissionItem.role)||"access",a=!(n.length>0)||n.every((e=>e.permissionItem.role===r)),l=!(t.length>0)||t.every((e=>e.permissionItem.role===r));a&&l&&(o=r);return o}(o),[{value:b}]=(0,a().Yb)((async()=>{const e=P().default.state.currentSpaceStore;return e?await async function(e){let{environment:s,mostPermissiveUserPermissions:i,mostPermissiveGroupPermissions:t,spaceStore:n}=e;const o=new Set;for(const{permissionItem:a}of i)o.add(a.user_id);const r=new Set;for(const{permissionItem:a}of t)r.add(a.group_id);if(r.size>0){const e=await h().callApi({eventName:"getSpacePermissionGroupMembers",environment:s,data:{groupIds:Array.from(r),spaceId:n.id}});if("success"===e.type)for(const[,{userIds:s}]of Object.entries(e.data.groupUsersMap)){const e=s.filter((e=>{var s;return null===(s=(0,S().sE)(n,e))||void 0===s?void 0:s.isMember()}));for(const s of e)o.add(s)}}return o.size}({environment:l,mostPermissiveUserPermissions:u,mostPermissiveGroupPermissions:c,spaceStore:e}):0}),[l,c,u]),f=Je(o),v=(0,r().IS)((()=>({inheritedPagePermissionsContainer:f?{paddingLeft:w().zr}:{}})),[f]);return(0,H.jsxs)(H.Fragment,{children:[f&&(0,H.jsx)(Oe,{store:s,isExpanded:d,onToggle:()=>{m((e=>!e)),g().lD(l,{share_menu_session_id:C().Ay.state.sessionId,type:"inherited_page"})},numberOfPeopleInvited:b??0,inheritedPermissionRole:p,permissionItemArgs:i,style:e.style}),d&&(0,H.jsx)("div",{style:v.inheritedPagePermissionsContainer,children:(0,H.jsx)(Qe,{store:s,pagePermissions:o,numberPermissionsAlreadyRendered:0,permissionItemArgs:i,forceExpanded:!0,isInherited:!0})})]})}function $e(e){let{store:s,calculatedPermissions:i,permissionItemArgs:t}=e;const{showSpacePermission:n,mostPermissiveTrustedDomainItem:o,mostPermissiveSpaceItem:r,mostPermissivePublicItem:a,showSitePublicPermission:l,showPublicShareLinkPermission:d,showTrustedDomainPermission:m,showRestrictedPermissionBanner:c}=i;return(0,H.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingTop:12,paddingLeft:8,paddingRight:8,paddingBottom:8},children:[(0,H.jsx)(ie().nc,{}),(0,H.jsx)(ee,{store:s,spacePermission:r,showSpacePermission:n,publicPermission:a,showSitePublicPermission:l,showPublicShareLinkPermission:d,trustedDomainPermission:o,showTrustedDomainPermission:m,permissionItemArgs:t,fromPermissionWrapper:"permission_list",isRestricted:c})]})}function Qe(e){const s=(0,u().tz)(),i=(0,o().K8)((()=>{const e=P().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),t=(0,n().v3)(),r=t.currentUser.id,{store:d,pagePermissions:g,numberPermissionsAlreadyRendered:b,permissionItemArgs:y,forceExpanded:x,isInherited:S}=e,{showUserPermissions:I,mostPermissiveGroupPermissions:M,mostPermissiveUserPermissions:w}=g,C=(0,k().x)(),[{value:N}]=(0,a().Yb)((async()=>{const e=await h().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:t,data:{spaceId:i,userIds:w.map((e=>e.permissionItem.user_id))},headers:(0,l().WS)({cellId:void 0,spaceId:i})});return"success"===e.type?e.data.userToGroupMap:{}}),[t,i,w],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3}),D=(0,o().K8)((()=>{const e=A().default.checkGate({gateName:"dont_load_users"}),i=I&&!e?function(e){const{mostPermissiveUserPermissions:s,spaceVisibleUserMap:i,userToPermissionGroupIds:t}=e,n={};return s.forEach((s=>{const o=(0,f().ex)({userId:s.permissionItem.user_id,store:e.store,userPermissionGroupIds:new Set((null==t?void 0:t[s.permissionItem.user_id])??[])}),r=_().LU.createChildStore(e.store,{table:m().oo,id:s.permissionItem.user_id}),a=r.getModel();let l;r.isReady()&&a&&(l=(0,c().c6)(e.intl,a)),n[s.permissionItem.user_id]=(0,H.jsx)(R().A,{store:e.store,userPermission:s,selectFooter:(0,H.jsx)(Ve().n,{targetName:l,targetType:"user",mostPermissivePermissions:o}),showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:i,fromPermissionWrapper:"permission_list"},s.permissionItem.user_id)})),n}({store:d,mostPermissiveUserPermissions:w,permissionItemArgs:y,spaceVisibleUserMap:C,userToPermissionGroupIds:N??{},intl:s}):{};return p().oE(Object.keys(i).map((e=>{const t=_().LU.createChildStore(d,{table:m().oo,id:e}),n=t.getModel();if(t.isReady()&&n)return{title:(0,c().c6)(s,n),isSelfPermission:Boolean(r)&&t.id===r,permissionItem:i[e]}})))}),[I,d,w,y,C,s,r,N]),L=(0,o().K8)((()=>{const e=i?function(e){const{spaceId:s,mostPermissiveGroupPermissions:i,isInherited:t}=e,n={},o=new Set(j().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return i.forEach((i=>{const r=i.permissionItem.group_id;o.has(r)&&(n[r]=(0,H.jsx)(T().A,{store:e.store,groupPermission:i,spaceId:s,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list",disableExpansion:t}))})),n}({store:d,spaceId:i,mostPermissiveGroupPermissions:M,permissionItemArgs:y,isInherited:S}):{};return Object.keys(e).map((i=>{const t=j().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===i));return{title:t?(0,v().Pf)({intl:s,groupName:t.group.name}):"",isSelfPermission:!1,permissionItem:e[i]}}))}),[s,S,M,y,i,d]);D.sort(((e,s)=>e.isSelfPermission?-1:s.isSelfPermission?1:e.title.localeCompare(s.title))),L.sort(((e,s)=>e.title.localeCompare(s.title)));const E=[...D,...L].map((e=>{let{permissionItem:s}=e;return s})),W=E.length;if(0===W)return null;const O=Math.max(4,7-b);return!x&&W>O?(0,H.jsxs)(H.Fragment,{children:[E.slice(0,2),(0,H.jsx)(B().A,{permissions:E.slice(2)})]}):(0,H.jsx)(H.Fragment,{children:E})}function Xe(e){const{store:s,mostPermissiveTeamPermissions:i,permissionItemArgs:t}=e;return i.map((e=>d().nl(e.permissionItem)?(0,H.jsx)(oe().A,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):d().un(e.permissionItem)?(0,H.jsx)(te().A,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,H.jsx)(ne().A,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}function Je(e){return e.mostPermissiveUserPermissions.length>0||e.mostPermissiveGroupPermissions.length>0}const Ze=function(e){const s=(0,n().v3)(),{device:a}=s,l=a.isMobile,{store:m,permissionItemArgs:c,calculatedPermissions:u,showPermissionInheritanceBanner:p}=e,{sudoModeStore:h}=c,v=(0,o().uB)(void 0,i(580257).A),{pagePermissionUIModel:y,showRestrictedPermissionBanner:S,showSpacePermission:P,showSitePublicPermission:j,showTeamPermission:A}=u,{inheritedPermissions:_,pagePermissions:w}=(0,M().kT)({store:m,pagePermissionUIModel:y,currentUserId:s.currentUser.id}),k=Je(w),C=Je(_),T=(0,o().K8)((()=>!(0,M().Aj)({store:m})),[m]),R=a.isMobile?I().A.None:I().A.Y,B=(0,r().IS)((()=>({scroller:{paddingLeft:l?20:0,paddingRight:l?20:0}})),[l]);(0,t.useEffect)((()=>{g().Fn({environment:s,calculatedPermissions:u})}),[]);const N=Number(P)+Number(j),D=N+Number(A)+Number(C),L=(0,o().K8)((()=>e.showFooter??!a.isMobile??!0),[a.isMobile,e.showFooter]),E=(0,x().X)("collection_property_permissions"),W=(0,o().K8)((()=>{const e=(0,i(782422)._m)(s);if(!e)return;const t=(0,f().zt)({userId:e.id,store:m}).role;return t&&(0,d().PW)(t)?t:void 0}),[s,m]),O=(0,o().K8)((()=>m.getSpaceId()),[m]),K=(0,i(133926).P9)({name:"block_read_and_write_role",spaceId:O,userId:s.currentUser.id}),U=(0,o().K8)((()=>!(!W||"none"===W)&&(K&&!d().p2(W)&&(0,i(29116).jH)(m.getSystemBlockTypeStore().getValue()))),[W,K,m]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(He,{dividerType:"top",scrollerStore:v}),(0,H.jsxs)(i(142708).H,{type:R,style:B.scroller,store:v,children:[U&&W?(0,H.jsx)(Ge,{store:m,role:W}):(0,H.jsx)(i(433638).A,{store:m,showRestrictedPermissionBanner:S,showPermissionInheritanceBanner:p,sudoModeStore:h}),(0,H.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{padding:"0px 8px"},children:[k&&(0,H.jsx)(Qe,{store:m,pagePermissions:w,numberPermissionsAlreadyRendered:D,permissionItemArgs:c,forceExpanded:!(C||u.showTeamPermission)}),C&&(0,H.jsx)(Ye,{store:m,inheritedPagePermissions:_,permissionItemArgs:c}),(0,H.jsx)(qe,{store:m,calculatedPermissions:u,permissionItemArgs:c}),T&&(0,H.jsx)(i(954889).A,{store:m})]})]}),(0,H.jsx)(He,{dividerType:"bottom",scrollerStore:v}),N>0&&!a.isMobile&&(0,H.jsx)($e,{store:m,calculatedPermissions:u,permissionItemArgs:c}),E&&(0,H.jsx)(Be,{blockStore:m,calculatedPermissions:u,permissionItemArgs:c}),L&&(0,H.jsx)(i(391431).A,{store:m,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:u,permissionItemArgs:c})]})}},55144:(e,s,i)=>{i.d(s,{A:()=>p});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(653998),l=()=>i(517198),d=()=>i(758103),m=i(163643);function c(e){let{teamName:s,isRedesignEnabled:i}=e;return s?i?(0,m.jsx)(a().sA,{defaultMessage:"People in {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccessV2",values:{teamName:s}}):(0,m.jsx)(a().sA,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:s}}):i?(0,m.jsx)(a().sA,{defaultMessage:"People in a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hiddenV2"}):(0,m.jsx)(a().sA,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function u(e){let{membersCount:s,isRedesignEnabled:i,teamPermissionItem:t}=e;const{isMobile:o}=(0,n().Y0)(),c=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",gap:2}})),[]),u=s?(0,m.jsx)("div",{children:(0,m.jsx)(a().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.memberCount.subtitle",values:{membersCount:s}})}):(0,m.jsxs)("div",{style:c.container,children:[(0,m.jsx)(l().A,{style:{height:12,width:14,borderRadius:4,marginRight:2,marginLeft:2}}),(0,m.jsx)(a().sA,{defaultMessage:"people",id:"blockPermissionsSettings.teamPermission.subtitle.people",values:{membersCount:s}})]});return i?o?(0,m.jsxs)("div",{style:c.container,children:[u,t&&(0,m.jsxs)(m.Fragment,{children:[" 路 ",(0,m.jsx)(a().sA,{...(0,d().R)({type:t.type,role:t.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0}).label})]})]}):(0,m.jsxs)("div",{style:c.container,children:[(0,m.jsx)(a().sA,{defaultMessage:"Teamspace",id:"blockPermissionsSettings.teamPermission.subtitle.teamspace"})," 路 ",u]}):u}const p=function(e){let{store:s,blockTeamMemberPermission:l,blockTeamOwnerPermission:p,blockTeamGuestPermission:g,permissionItemArgs:h}=e;const b=(0,n().v3)(),f=b.device.isMobile,[v,y]=(0,t.useState)(!1),[x,S]=(0,t.useState)(!1),{permissionItem:I}=l,P=(0,o().O$)(i(485966).AppStoreCurrentSpaceStore),j=(0,o().K8)((()=>(0,i(268117).FI)()),[]),A=(0,o().K8)((()=>{var e;return i(446588).gl(I)?I.team_id:null===(e=i(378219).Uo(s))||void 0===e?void 0:e.id}),[I,s]),_=p.permissionItem.role,M=I.role,w={type:"display_only_overview_permission",role:_===M?M:"none"===M||"none"===_?"limited":"access"},{teamStore:k,teamIsDefined:C,teamName:T}=(0,o().K8)((()=>{if(!P||!A)return{undefined:void 0};const e=i(413871).h4.createChildStore(P,{table:i(218357).yK,id:A,spaceId:P.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[P,A]),R=(0,o().K8)((()=>{if(void 0!==k)return(0,i(904697).getTeamMemberCountAndSampleUserIds)(k)}),[k]),{membersCount:B,totalMembersAndGuestsCount:N,ownersCount:D,teamGuestsCount:L}=void 0!==R?{membersCount:R.memberCount,totalMembersAndGuestsCount:R.memberCountWithGuests,ownersCount:R.ownerCount,teamGuestsCount:R.memberCountWithGuests-R.memberCount}:{membersCount:0,totalMembersAndGuestsCount:void 0,ownersCount:0,teamGuestsCount:0},E=(0,o().K8)((()=>{if(!P)return!1;return!P.getDisableTeamGuests()&&((null==k||!k.isDefault())&&(0,i(307542).Qd)())}),[P,k]),W=(0,t.useCallback)((()=>y(!0)),[]),O=(0,t.useCallback)((()=>y(!1)),[]),K=(0,t.useCallback)((()=>{const e=!1===x;if(S(!x),e){if(!k)return;i(441288).lD(b,{share_menu_session_id:i(422340).Ay.state.sessionId,type:"team",team_id:k.id})}}),[b,x,S,k]),U=(0,r().IS)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:x?"block":"none"},roleButton:{color:e.text.secondary,fontSize:(0,i(636208).kx)({environment:b,isRedesignEnabled:j})},mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${x?90:0}deg)`,transition:"transform 150ms ease"}})),[x,b,j]),F=j?null:(0,i(457774).B)(U.icon);if(!k)return null;const z=C?(0,m.jsx)(i(560033).A,{store:k}):(0,i(156259).s)(),G=j?(0,m.jsx)(i(769094).A,{expanded:x,hovered:v,onClick:K,children:z}):z;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i(895048).Ay,{store:s,permissionItem:w,from:l.from,onMouseEnter:W,onMouseLeave:O,icon:G,title:f&&j?(0,m.jsxs)("div",{style:U.mobileTitleContainer,children:[(0,m.jsx)("div",{style:U.mobileTextContainer,children:(0,m.jsx)(c,{teamName:T,isRedesignEnabled:j})}),(0,m.jsx)("div",{style:U.mobileChevronIcon,children:(0,i(855470).V)({height:12,width:12})})]}):(0,m.jsx)(c,{teamName:T,isRedesignEnabled:j}),subtitle:C&&(0,m.jsx)(u,{membersCount:N,isRedesignEnabled:j,teamPermissionItem:w}),nonInheritedTooltip:j?(0,m.jsx)(a().sA,{id:"TeamPermissionItem.access",defaultMessage:"People in the {inlineIconAndName} teamspace",values:{inlineIconAndName:(0,m.jsx)(i(129663).A,{store:k,useInvertedColors:!0})}}):null,upgradeButtonName:"team_permission_item",onClick:K,permissionRoleSelect:x?F:(0,m.jsx)(d().Y,{type:w.type,role:w.role,icon:i(688322).d,disabled:!0,buttonStyle:U.roleButton,table:i(145017).ev,isCurrentUser:!1,from:"shareMenu"}),isCollapsible:!0,...h}),(0,m.jsxs)("div",{style:U.teamPermissionsContainer,children:[p&&(0,m.jsx)(i(496505).A,{store:s,permissionItemArgs:h,blockTeamOwnerPermission:p,teamOwnersCount:D,fromPermissionWrapper:"expandable_permission"}),l&&(0,m.jsx)(i(439510).A,{store:s,permissionItemArgs:h,blockTeamPermission:l,teamMembersCount:B,fromPermissionWrapper:"expandable_permission"}),E&&g&&(0,m.jsx)(i(232376).A,{store:s,permissionItemArgs:h,blockTeamGuestPermission:g,teamGuestsCount:L,fromPermissionWrapper:"expandable_permission"})]})]})}},95434:(e,s,i)=>{i.d(s,{Gm:()=>a,NR:()=>l,eo:()=>r});i(725707),i(491955),i(242343);var t=()=>i(653998),n=()=>i(424339),o=i(163643);const r=i(680369).Ev.default,a=[{key:"private",title:e=>{let{isShareMenuRedesignEnabled:s,type:i}=e;return s&&"full"===i?(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.inviteOnlyFullLength",defaultMessage:"Only people invited"}):(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"})},caption:()=>(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:e=>{let{style:s,isShareMenuRedesignEnabled:t}=e;return(0,i(127436).i)(t?{...s,marginTop:1}:s)}},{key:"unlisted",title:e=>{let{spaceName:s,isShareMenuRedesignEnabled:i}=e;return i?(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLinkRedesign",defaultMessage:"Anyone at {spaceName} with the link",values:{spaceName:s}}):(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:s}})},caption:e=>{let{isShareMenuRedesignEnabled:s}=e;return s?(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityCaption.anyoneWithLinkRedesign",defaultMessage:"Workspace members can access with the link"}):(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"})},icon:e=>{let{style:s,isShareMenuRedesignEnabled:t}=e;return(0,i(718799).w)(t?{...s,marginTop:1}:s)}},{key:"open",title:e=>{let{spaceName:s}=e;return(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:s}})},caption:e=>{let{isShareMenuRedesignEnabled:s}=e;return s?(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspaceV2",defaultMessage:"Workspace members can access and discover in search"}):(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"})},icon:e=>{let{style:s,isShareMenuRedesignEnabled:t,spaceStore:a,teamspaceIconSize:l}=e;return t?(0,o.jsx)(n().x,{disabled:!0,store:a,size:l,style:{marginLeft:(r-l)/2,marginRight:(r-l)/2}}):(0,i(939654).w)(s)}},{key:"open_unlisted_hybrid",title:e=>{let{spaceName:s,visibility:i}=e;return"unlisted"===i?(0,o.jsx)(t().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:s}}):(0,o.jsx)(t().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:s}})},caption:()=>{},icon:e=>{let{spaceStore:s,teamspaceIconSize:i}=e;return(0,o.jsx)(n().x,{disabled:!0,store:s,size:i,style:{marginLeft:(r-i)/2,marginRight:(r-i)/2}})}}];function l(e,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a.filter((n=>{let{key:o}=n;return i||t?"private"===o:e&&s?"private"===o||"open_unlisted_hybrid"===o:"private"===o||"open"===o||"unlisted"===o}))}},111664:(e,s,i)=>{i.d(s,{u:()=>n});var t=()=>i(975392);function n(e,s){const i=(0,t().o8)(e);i.role=s;const{is_site:n}=i;return"none"===s?n?{...i,role:"reader",is_public_share_link:!1}:{...i,is_public_share_link:!1}:{...i,is_public_share_link:!0}}},132634:(e,s,i)=>{i.d(s,{l:()=>p});i(242343);var t=()=>i(803290),n=()=>i(174114),o=()=>i(14931),r=()=>i(653998),a=()=>i(28210),l=()=>i(482570),d=()=>i(895048),m=i(163643);const c=i(173864).QT,u=16;function p(e){let{ownerStores:s,teamStore:i,isSmall:o=!1}=e;const r=o?c:d().Ev,l=o?10:u,p=(0,n().IS)((e=>({container:{position:"relative",width:r,height:r},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[r]),{teamName:h,teamIcon:b}=(0,t().K8)((()=>({teamName:i.getName(),teamIcon:i.getIcon()})),[i]),f=e=>(0,m.jsx)(a().B,{disabled:!0,title:h,icon:b,isEmptyPage:!1,size:e});return 0===s.length?f(r):(0,m.jsxs)("div",{style:p.container,children:[(0,m.jsx)(g,{isSmall:o,store:s[0]}),(0,m.jsx)("div",{style:p.teamBadge,children:f(l)})]})}function g(e){let{store:s,isSmall:i=!1,style:u={}}=e;const p=(0,r().tz)(),g=i?c:d().Ev,h=(0,n().IS)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...u}})),[g,u]),b=(0,t().K8)((()=>null!=s&&s.isDefined()?(0,o().c6)(p,null==s?void 0:s.getModel()):void 0),[p,s]),f=b?(0,m.jsx)(l().A,{avatarShouldShowShadow:!0,userStore:s,size:g}):(0,m.jsx)(a().B,{bucket:"public",disabled:!0,isEmptyPage:!1,title:b,size:g,icon:void 0});return(0,m.jsx)("div",{style:h.icon,children:f})}},173864:(e,s,i)=>{i.d(s,{BA:()=>u,QT:()=>c,jN:()=>d,mZ:()=>m});i(403517);var t=i(242343),n=()=>i(174114),o=()=>i(209684),r=()=>i(884373),a=()=>i(582295),l=i(163643);const d=15,m=8,c=20;function u(e){const s=(0,n().IS)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a().a,{title:e.title,style:s.title}),(0,l.jsx)(o().p,{onClick:e.onClick,style:s.button,children:(0,l.jsx)(p,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a().a,{title:e.title,style:s.title}),(0,l.jsx)(p,{...e})]})}function p(e){let{title:s,rows:i,hideDividers:o=!1,itemStyle:a,onClick:c}=e;const u=(0,n().IS)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:m,paddingBottom:m,...a},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[a]);return(0,l.jsx)("div",{style:{...u.container},children:(0,l.jsx)("ul",{style:u.list,children:i.map(((e,s)=>(0,l.jsxs)(t.Fragment,{children:[!o&&s>0&&(0,l.jsx)(r().A,{size:1,innerStyle:u.divider}),(0,l.jsx)("li",{style:u.listItem,children:e},s)]},s)))})})}},197447:(e,s,i)=>{i.d(s,{A:()=>n});class t extends(()=>i(129044))().default{getInitialState(){return{trustedDomainPointers:[],enabledTrustedEmailDomains:[],trustedDomains:[],lastEmitData:{value:-1,spaceId:void 0}}}getForSpace(e){if(!e)return;const{enabledTrustedEmailDomains:s,trustedDomainPointers:i,trustedDomains:t,lastEmitData:n}=this.state;return n.spaceId===e.id?{enabledTrustedEmailDomains:s,trustedDomainPointers:i,trustedDomains:t}:void 0}shouldRefetchTrustedDomains(e){let{currentSpaceId:s,emitValue:i}=e;const{spaceId:t,value:n}=this.state.lastEmitData;return s!==t||i!==n}}const n=t},222787:(e,s,i)=>{i.d(s,{Ay:()=>h,E3:()=>p,G0:()=>c,jV:()=>g,nc:()=>u});i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(174114),r=()=>i(653998),a=()=>i(31448),l=()=>i(35462),d=()=>i(268117),m=i(163643);function c(){return(0,m.jsx)(g,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function u(){return(0,m.jsx)(g,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.generalAccessAttribution",defaultMessage:"General access"})})}function p(){return(0,m.jsx)(g,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution",defaultMessage:"Permission rules"})})}function g(e){const{children:s}=e,{WindowSizeStore:i}=(0,t().v3)(),{isMobile:r}=(0,t().Y0)(),c=(0,n().K8)((()=>(0,d().FI)()),[]),{paddingLeft:u,paddingRight:p}=(0,n().K8)((()=>{const e=c?r?0:8:14;return{paddingLeft:i.getSafePaddingLeftCSS(e),paddingRight:i.getSafePaddingRightCSS(e)}}),[i,r,c]),g=(0,o().IS)((e=>({label:{color:e.text.secondary,fontWeight:a().Wy.medium,paddingLeft:u,paddingRight:p,paddingTop:c?0:8,paddingBottom:c?4:6,overflow:"visible",textWrap:"wrap",...c&&r?{fontSize:15,paddingTop:0,color:e.text.secondary}:{}}})),[r,c,u,p]);return(0,m.jsx)(l().A,{isSmall:!0,style:g.label,children:s})}const h=function(e){const{store:s}=e,{parentStore:t,canAccessParent:o}=(0,n().K8)((()=>(0,i(432809).iG)({store:s})),[s]);return o?(0,m.jsx)(g,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,m.jsx)(i(550171).i,{navigableParentStore:t})}})}):(0,m.jsx)(g,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})}},232376:(e,s,i)=>{i.d(s,{A:()=>u});i(242343);var t=()=>i(803290),n=()=>i(174114),o=()=>i(758989),r=()=>i(653998),a=()=>i(895048),l=i(163643);function d(e){const{teamName:s,isCompact:i}=e;return i?(0,l.jsx)(r().sA,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):s?(0,l.jsx)(r().sA,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:s}}):(0,l.jsx)(r().sA,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function m(e){let{teamGuestsCount:s,isCompact:i,isRedesignEnabled:t}=e;return i&&!t||0===s?null:(0,l.jsx)(r().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamGuestPermission.subtitle",values:{membersCount:s}})}function c(e){const{teamName:s}=e,i=(0,n().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,l.jsx)("div",{style:i.tooltip,children:(0,l.jsx)(r().sA,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:s},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const u=function(e){let{store:s,blockTeamGuestPermission:r,isExternalTeam:u,fromPermissionWrapper:p,teamGuestsCount:g,permissionItemArgs:h}=e;const{isMobile:b}=(0,i(237385).Y0)(),f=(0,t().K8)((()=>(0,i(268117).FI)()),[]),{permissionItem:v}=r,y=(0,t().O$)(i(485966).AppStoreCurrentSpaceStore),x=(0,t().K8)((()=>{var e;return i(446588).un(v)?v.team_id:null===(e=i(378219).Uo(s))||void 0===e?void 0:e.id}),[v,s]),{teamStore:S,teamIsDefined:I,teamName:P,teamIcon:j}=(0,t().K8)((()=>{if(!y||!x)return{};const e=i(413871).h4.createChildStore(y,{table:i(218357).yK,id:x,spaceId:y.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon()}:{}}),[y,x]),A=(0,t().K8)((()=>{if(g)return g;if(void 0!==S){const e=(0,i(904697).getTeamMemberCountAndSampleUserIds)(S);if(void 0!==e)return e.memberCountWithGuests-e.memberCount}}),[S,g]),_=!u,M=(0,n().IS)((()=>({container:{width:"100%"}})),[]);if(!S)return null;const w=j&&o().T8(j.icon)?o().VA(j.icon):"gray",k=j?{...j,icon:`/icons/user-circle_${w}.svg`}:void 0;return(0,l.jsx)("div",{style:M.container,className:i(983050).rkF,children:(0,l.jsx)(a().Ay,{isCompact:_,store:s,permissionItem:v,icon:f?(0,l.jsx)(i(969836).A,{size:b&&f?a().Bj:a().Ev}):I?(0,l.jsx)(i(424339).x,{disabled:!0,store:S,size:b&&f?a().Bj:a().Ev,icon:k}):(0,i(156259).s)(),title:(0,l.jsx)(d,{teamName:P,isCompact:_}),nonInheritedTooltip:(0,l.jsx)(c,{teamName:P}),from:r.from,subtitle:I&&(0,l.jsx)(m,{teamGuestsCount:A??0,isCompact:_,isRedesignEnabled:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:p,...h})})}},234467:(e,s,i)=>{i.d(s,{o:()=>u});var t=i(242343),n=()=>i(803290),o=()=>i(443252),r=()=>i(477784),a=()=>i(907721),l=()=>i(268117),d=i(163643);const m=new(i(380123).R)({key:"spacePermissionRedesignCallout",namespace:i(146325).Bq,important:!0,trackingType:"necessary"}),c=(0,i(653998).YK)({calloutTitle:{defaultMessage:"Simpler sharing and access control",id:"spacePermissionVisibilityPicker.calloutTitle"},calloutBody:{defaultMessage:"Anyone with link and Everyone at {spaceName} are now combined. After updating general access, use the next dropdown to control who can find this page.",id:"spacePermissionVisibilityPicker.calloutBody"}}),u=t.memo((function(e){let{store:s,spacePermission:u,showTrustedDomainPermission:p,trustedDomainPermission:g,publicPermission:h,showPublicShareLinkPermission:b,isRestricted:f,permissionItemArgs:v,hideHoverStyles:y,buttonPopupStore:x,isDisplayOnly:S,handleSpacePermissionChange:I,title:P,onlyShowPrivateSpaceVisibility:j}=e;const A=(0,i(237385).v3)().device.isMobile,_=(0,i(838517).i0)(s),M=(0,i(263370).X)(),w=(0,n().K8)((()=>(0,l().FI)()),[]),k=(0,n().K8)((()=>(0,l().sh)()),[]),C=(0,n().K8)((()=>s.canAdmin()),[s]),T=!C||S||_,[R,B]=(0,t.useState)(!1);(0,t.useEffect)((()=>{w&&k&&(m.getState()||(B(!0),m.setState(!0)))}),[w,k]);const N=(0,i(835074).L)((()=>x.setState({...x.state,open:!0})),[x],i(502852).y$.PermissionItemClick),D=(0,i(174114).IS)((e=>({origin:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:6,marginLeft:-6,height:void 0,paddingTop:4,paddingBottom:4,maxWidth:250},icon:{width:10,marginLeft:4,fill:e.mediumIconColor,display:"inline"},privacyMenu:{...!A&&{width:330,borderRadius:10},...A&&{maxWidth:"100%"}},title:{fontSize:14,whiteSpace:"normal"},mobileButton:{display:"flex",alignItems:"center",whiteSpace:"normal",marginBottom:4,height:void 0}})),[A]);return T?(0,d.jsx)("div",{style:D.title,children:P}):(0,d.jsx)(i(273520).Ay,{renderOrigin:e=>A?(0,d.jsx)("div",{style:D.title,...e,children:(0,d.jsxs)("div",{style:D.mobileButton,children:[P,(0,i(855470).V)(D.icon)]})}):(0,d.jsxs)(i(209684).p,{style:D.origin,hoveredStyle:y?{background:"unset"}:void 0,pressedStyle:y?{background:"unset"}:void 0,disabled:T,...e,children:[(0,d.jsx)(i(501578).j,{children:P}),C?(0,i(575681)._)(D.icon):null]}),disabled:T,onClick:N,buttonPopupStore:x,style:D.privacyMenu,alignmentToOrigin:a().C.Start,popupType:A?o().nl.BottomSheet:o().nl.Popup,render:e=>u?(0,d.jsx)(o().Ay,{popupType:o().nl.Popup,open:R,placementToOrigin:a().W.Left,enableOutsideClickDismiss:!0,onDismiss:()=>{B(!1)},originGap:4,render:()=>(0,d.jsx)(i(944238).P,{title:r().A.formatMessage(c.calloutTitle),body:r().A.formatMessage(c.calloutBody,{spaceName:M}),onDismiss:()=>{B(!1)}}),origin:(0,d.jsx)(i(507012).q,{store:s,spacePermission:u,parentCloseCallback:e.close,showTrustedDomainPermission:p,trustedDomainPermission:g,publicPermission:h,showPublicShareLinkPermission:b,isRestricted:f,sudoModeStore:v.sudoModeStore,location:v.location,permissionItemArgs:v,handleSpacePermissionChange:I,onlyShowPrivateSpaceVisibility:j})}):null})}))},259738:(e,s,i)=>{i.d(s,{P:()=>v});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(279968),l=()=>i(653998),d=()=>i(441288),m=()=>i(209684),c=()=>i(622163),u=()=>i(186438),p=()=>i(422340),g=()=>i(895048),h=i(163643);function b(e){let{}=e;const s=(0,n().v3)(),{device:o}=s,a=(0,t.useCallback)((()=>{p().Ay.update((e=>({...e,tab:p().QC.Publish,display:p().pP.Publish})))}),[]),d=(0,r().IS)((e=>({container:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:o.isMobile?28:1},link:{textDecoration:"underline",display:"inline"}})),[o.isMobile]);return(0,h.jsx)(i(35462).A,{style:d.container,isMultiline:!0,isSmall:!0,children:(0,h.jsx)(l().sA,{id:"publicItemFooter.caption",defaultMessage:"Anyone on the web can access this published page 路 <link>Site settings</link>",values:{link:e=>(0,h.jsx)(i(579494).A,{style:d.link,onClick:a,children:e})}})})}const f=t.memo(b);function v(e){let{store:s,publicPermissionItem:i,permissionItemArgs:a}=e;const b=(0,n().v3)(),[v,x]=(0,t.useState)(!1),S=(0,o().K8)((()=>s.canAdmin()),[s]),I=(0,o().K8)((()=>!(0,u().g)()),[]),P=(0,t.useCallback)((()=>{p().Ay.update((e=>({...e,tab:p().QC.Publish,display:p().pP.Publish})))}),[]),j=(0,t.useCallback)((()=>{const e=!1===v;x(!v),e&&d().lD(b,{share_menu_session_id:p().Ay.state.sessionId,type:"public_link"})}),[b,v,x]),A=(0,r().IS)((e=>({link:{textDecoration:"underline",fontSize:(0,c().ny)(b,"UISmall"),color:e.text.secondary,paddingTop:0,paddingBottom:0,height:20,paddingLeft:4,paddingRight:4,marginTop:-4,marginLeft:-4,overflow:"hidden"},linkUILabelStyle:{overflow:"unset"}})),[b]);return(0,h.jsx)(g().Ay,{store:s,permissionItem:i.permissionItem,from:i.from,nonInheritedTooltip:(0,h.jsx)(l().sA,{id:"publicLinkPermissionItem.tooltip",defaultMessage:"Anyone on the web can access this published page"}),icon:(0,h.jsx)(y,{}),title:(0,h.jsx)(l().sA,{defaultMessage:"Anyone with published link",id:"publicLinkPermissionItem.title"}),subtitle:I&&(0,h.jsx)(m().p,{style:A.link,onClick:P,children:S?(0,h.jsx)(l().sA,{defaultMessage:"Edit site settings",id:"publicLinkPermissionItem.manageSettings"}):(0,h.jsx)(l().sA,{defaultMessage:"View site settings",id:"publicLinkPermissionItem.viewSettings"})}),selectFooter:(0,h.jsx)(f,{}),subtitleStyle:A.linkUILabelStyle,onClick:j,upgradeButtonName:"public_permission_item",...a})}function y(){const e=(0,r().IS)((e=>({backgroundContainer:{background:e.regularDividerColor,width:32,height:32,borderRadius:4,display:"flex",justifyContent:"center",alignItems:"center"},globeIcon:{width:22,fill:e.icon.secondary}})),[]);return(0,h.jsx)("div",{style:e.backgroundContainer,children:(0,a().h)(e.globeIcon)})}},263370:(e,s,i)=>{i.d(s,{X:()=>l});var t=()=>i(237385),n=()=>i(803290),o=()=>i(653998),r=()=>i(548694),a=()=>i(485966);function l(){const e=(0,t().v3)(),s=(0,o().tz)();return(0,n().K8)((()=>{const{currentSpaceStore:i}=a().default.state;return i?(0,r().GK)(e,i):s.formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"})}),[e,s])}},277011:(e,s,i)=>{i.d(s,{g:()=>I});i(242343);var t=()=>i(237385),n=()=>i(174114),o=()=>i(83544),r=()=>i(568262),a=()=>i(653998),l=()=>i(127086),d=()=>i(836880),m=()=>i(209684),c=()=>i(273520),u=()=>i(516267),p=()=>i(397791),g=()=>i(673411),h=()=>i(622286),b=()=>i(284551),f=()=>i(785061),v=()=>i(466321),y=()=>i(204507),x=()=>i(422340),S=i(163643);function I(e){const{shouldShowSlackImportContactsButton:s,shouldShowGoogleImportContactsButton:i,emailMessage:o,inviteTargetsStore:r,isRedesignEnabled:a,flowId:u,originStyle:p={},containerStyle:I={},source:A,titleStyle:_={}}=e,M=(0,t().v3)(),w=(0,n().IS)((e=>({importContactsContainer:{height:36,bottom:0,width:"100%",pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary}})),[]),k=(0,f().Hc)(),C=(0,h().X)("disconnect_contact_import"),T=e=>{C?y().L.setState({open:!0,type:e}):(x().Ay.setState({...x().Ay.state,tab:x().QC.Share,display:x().pP.Invite,focus:x().yZ.Search,source:e,emailMessage:o}),r.setState({...r.state,tokenQuery:""}))};if(s&&i){const e=(0,b().C)({onClickAuthenticated:T,hideChevronIcon:a,containerStyle:k.importListButtonContainer,buttonStyle:k.importListButton,flowId:u});return(0,S.jsx)(c().Ay,{popupType:v().n.Popup,alignmentToOrigin:c().yP.Start,placementToOrigin:c().sx.Left,render:()=>(0,S.jsx)(g().A,{importListItems:e}),originGap:12,renderOrigin:e=>(0,S.jsx)("div",{style:{...w.importContactsContainer,...I},children:(0,S.jsx)(m().p,{style:{...w.importContactsButton,...p},onClick:()=>{e.onClick(),d().V(M,{source:A})},children:(0,S.jsx)("div",{style:k.labelContainer,children:a?(0,S.jsx)(P,{titleStyle:_}):(0,S.jsx)(j,{})})})})})}return s?(0,S.jsx)(l().Xx,{onClickAuthenticated:()=>T(x().NL.Slack),title:a?(0,S.jsx)(P,{titleStyle:_}):(0,S.jsx)(j,{}),containerStyle:w.importContactsContainer,buttonStyle:a?w.importContactsButtonV2:w.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:u,loadContacts:!0,hideChevronIcon:a}):null}function P(e){const{titleStyle:s={}}=e,i=(0,n().IS)((e=>({integrationName:{display:"flex"},importContactsButtonTitle:{display:"flex",alignItems:"center",fill:e.text.primary,gap:8,...s}})),[s]);return(0,S.jsxs)("div",{style:i.importContactsButtonTitle,children:[(0,S.jsx)("div",{style:i.integrationName,children:(0,S.jsx)(p().I,{color:"secondary",icon:r().R})}),(0,S.jsx)(a().sA,{defaultMessage:"Import contacts",id:"importContactsButton.importContacts.label"})]})}function j(){const e=(0,n().IS)((()=>({integrationName:{display:"flex"},integrationIcon:{marginRight:4}})),[]),s=(0,S.jsxs)("div",{style:e.integrationName,children:[(0,S.jsx)(u().A,{type:"image_url",imageURL:o().A.images.externalIntegrations.slackIconPng,size:18,imageStyle:e.integrationIcon}),(0,S.jsx)(a().sA,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,S.jsx)(a().sA,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:s}})}},328207:(e,s,i)=>{i.d(s,{A:()=>A});i(725707),i(500234),i(403517);var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(83544),l=()=>i(162901),d=()=>i(653998),m=()=>i(31448),c=()=>i(818369),u=()=>i(482570),p=()=>i(388128),g=()=>i(84979),h=()=>i(591130),b=()=>i(485966),f=()=>i(268117),v=()=>i(895048),y=()=>i(332126),x=i(163643);function S(e){const{group:s,store:i,groupPermission:t}=e,a=(0,n().v3)(),d=(0,o().O$)(b().AppStoreCurrentSpaceStore),[{value:m}]=(0,l().Yb)((async()=>{const e=await c().callApi({eventName:"getSpacePermissionGroupMembers",environment:a,data:{groupIds:[s.group_id],spaceId:s.space_id}});if("success"===e.type){var i;const t=null===(i=e.data.groupUsersMap[s.group_id])||void 0===i?void 0:i.userIds,{limitedUserStores:n}=(0,h().gA)({userIds:t,limit:void 0,spaceStore:d});return n}}),[d,a,s.group_id,s.space_id]),u=(0,r().IS)((e=>({container:{paddingLeft:16}})),[]);return(0,x.jsx)("div",{style:u.container,children:null==m?void 0:m.map((e=>(0,x.jsx)("div",{children:(0,x.jsx)(I,{userStore:e,store:i,groupPermission:t})},e.id)))})}function I(e){const{userStore:s,store:i,groupPermission:t}=e,r=(0,n().v3)(),{isMobile:a}=r.device,l=(0,d().tz)(),m=(0,o().K8)((()=>(0,f().FI)()),[]),c=(0,o().K8)((()=>s.getDisplayName(l)),[l,s]),p=(0,o().K8)((()=>s.getEmail()),[s]);return(0,x.jsx)(v().Ay,{store:i,permissionItem:{type:"display_only_group_member_permission"},from:t.from,icon:(0,x.jsx)(u().A,{userStore:s,avatarShouldShowShadow:!1,size:a&&m?v().Bj:v().Ev,hasTooltip:!1}),title:c||p,subtitle:p,upgradeButtonName:"permission_groups"})}function P(e){const{group:s}=e,i=(0,d().tz)(),t=(0,h().Pf)({intl:i,groupName:s.name});return(0,x.jsx)(d().sA,{defaultMessage:"People in {groupName} have access to the page",values:{groupName:t},id:"blockPermissionsSettings.groupPermission.tooltipV2"})}function j(e){const{group:s}=e,i=(0,d().tz)(),t=(0,h().Pf)({intl:i,groupName:s.name});return(0,x.jsx)(p().Q,{group:s,limit:15,noMembersMessage:(0,x.jsx)(g().A,{imageURL:a().A.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,x.jsx)(d().sA,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,x.jsx)("span",{style:{fontWeight:m().Wy.bold},children:e}),groupName:t},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const A=function(e){const{store:s,groupPermission:a,spaceId:l,fromPermissionWrapper:m,disableExpansion:c}=e,{isMobile:u}=(0,n().Y0)(),p=(0,d().tz)(),[g,I]=(0,t.useState)(!1),[A,_]=(0,t.useState)(!1),M=(0,o().K8)((()=>(0,f().FI)()),[]),{group:w,memberCount:k}=(0,o().K8)((()=>{const{currentSpaceStore:e}=b().default.state;if(!e)return{};return{...i(736953).A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===a.permissionItem.group_id))}}),[a.permissionItem.group_id]),C=(0,o().K8)((()=>!c&&(!(!w||!k||0===k)&&M)),[c,w,M,k]),T=(0,t.useCallback)((()=>I(!0)),[]),R=(0,t.useCallback)((()=>I(!1)),[]),B=(0,t.useCallback)((()=>{C&&_(!A)}),[A,C]),N=(0,r().IS)((e=>({mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${A?90:0}deg)`,transition:"transform 150ms ease"},mobileTitleContainer:{display:"flex",alignItems:"center"}})),[A]);if(!w)return null;const D=(0,h().Pf)({intl:p,groupName:w.name}),L=w.icon&&!M&&(0,x.jsx)(i(28210).B,{disabled:!0,title:D,icon:w.icon?{pointer:{table:"space",id:l},icon:w.icon}:void 0,isEmptyPage:!1,size:18}),E=C?(0,x.jsx)(i(769094).A,{expanded:A,hovered:g,onClick:B,children:(0,x.jsx)(y().A,{groupIcon:w.icon,isRedesignEnabled:M,spaceId:l})}):(0,x.jsx)(y().A,{groupIcon:w.icon,isRedesignEnabled:M,spaceId:l});return(0,x.jsxs)("div",{style:{fontWeight:400},className:i(983050).HlM,children:[(0,x.jsx)(v().Ay,{onMouseEnter:T,onMouseLeave:R,onClick:C?B:void 0,isCollapsible:C,store:s,permissionItem:a.permissionItem,from:a.from,icon:E,title:(0,x.jsxs)("div",{style:N.mobileTitleContainer,children:[D,C&&u&&(0,x.jsx)("div",{style:N.mobileChevronIcon,children:(0,i(855470).V)({height:12,width:12})})]}),tag:L,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:e.tooltip?e.tooltip:M?(0,x.jsx)(P,{group:w}):(0,x.jsx)(j,{group:w}),subtitle:M&&u?(0,x.jsxs)("div",{children:[(0,x.jsx)(d().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:k}})," 路 ",(0,x.jsx)(d().sA,{...(0,i(758103).R)({type:"group_permission",role:a.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:M}).label})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)(d().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," 路 ",(0,x.jsx)(d().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:k}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:m,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs}),A&&(0,x.jsx)(S,{group:w,store:s,groupPermission:a})]},w.id)}},332126:(e,s,i)=>{i.d(s,{A:()=>l});var t=i(242343),n=()=>i(895048),o=()=>i(436599),r=i(163643);function a(e){let{groupIcon:s,isRedesignEnabled:t,spaceId:a}=e;const{isMobile:l}=(0,i(237385).Y0)(),d=(0,i(174114).IS)((e=>({icon:{fill:e.icon.secondary}})),[]);return s&&t&&a?(0,r.jsx)(o().A,{type:"circle",iconType:"recordIcon",icon:{icon:s,pointer:{table:i(528762).NX,id:a}},isMobile:l}):t?(0,r.jsx)(o().A,{type:"circle",iconType:"function",iconFn:i(591090).$,iconStyle:d.icon,isMobile:l}):(0,r.jsx)(i(969836).A,{size:l&&t?n().Bj:n().Ev})}const l=t.memo(a)},363721:(e,s,i)=>{i.d(s,{Bw:()=>l,V0:()=>g});i(725707),i(491955),i(403517);var t=()=>i(76394),n=()=>i(528643),o=()=>i(137476),r=()=>i(995625),a=()=>i(138385);function l(e){const{environment:s,internalDomains:i,inviteResults:o,destination:l,metadata:g}=e;0!==o.length&&(function(e){var s;const{addedPermissions:i,environment:t,internalDomains:o,metadata:a,destination:l}=e;if(0===i.length)return;const d=i.map((e=>e.invite.inviteTarget)),m=i.map((e=>e.blockPermissionItem)),u=i.filter(c).filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId));n().Jg(t,{domainType:(0,r().FX)(),internal_domains:o??[],invite_flow_id:a.inviteFlowId,invite_message_length:(null===(s=a.inviteMessage)||void 0===s?void 0:s.length)??0,invite_origin:a.inviteOrigin,invite_targets:d,invitee_ids_with_internal_domain:u,invitee_ids_with_internal_domain_enforced:[],is_onboarding:!1,is_space:!1,permission_items:m,role:l.blockRole,share_menu_session_id:a.shareMenuSessionId})}({addedPermissions:o.filter(u),environment:s,internalDomains:i,destination:l,metadata:g}),function(e){var s;const{createdMembers:i,environment:t,internalDomains:o,metadata:a,destination:l}=e;if(0===i.length)return;const d=i.map((e=>e.invite.inviteTarget)),m=i.map((e=>e.spacePermissionItem)),c=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId)),u=i.filter((e=>e.wasInternalDomainEnforced)).map((e=>e.inviteeUserId));if(n().Jg(t,{domainType:(0,r().FX)(),internal_domains:o??[],invite_flow_id:a.inviteFlowId,invite_message_length:(null===(s=a.inviteMessage)||void 0===s?void 0:s.length)??0,invite_origin:a.inviteOrigin,invite_targets:d,invitee_ids_with_internal_domain:c,invitee_ids_with_internal_domain_enforced:u,is_onboarding:!1,is_space:!0,permission_items:m,role:l.spaceRole,share_menu_session_id:a.shareMenuSessionId}),u.length>0){const e=o?o.map((e=>e.url)):[];n().hp(t,{invite_flow_id:a.inviteFlowId,invite_origin:a.inviteOrigin,user_ids:u,internal_domains:e})}}({createdMembers:o.filter(p),environment:s,internalDomains:i,destination:l,metadata:g}),function(e){const{createdGuestRequests:s,environment:i,destination:o,metadata:r}=e;if(0===s.length)return;const a=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9);n().xF(i,{internal_guest_enforcement:!1,invite_flow_id:r.inviteFlowId,is_bot:!1,is_internal_domain:a.length>0,invitee_emails_with_internal_domain:a,invitee_emails_with_internal_domain_enforced:[],role:o.blockRole,space_role:o.spaceRole,user_count:s.length})}({createdGuestRequests:o.filter(d),environment:s,destination:l,metadata:g}),function(e){const{createdMemberRequests:s,environment:i,destination:o,metadata:r}=e;if(0===s.length)return;const l=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9),d=s.filter((e=>e.wasInternalDomainEnforced)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9);n().RH(i,{from:"share_menu",invite_flow_id:r.inviteFlowId,invite_space_role_selection:a().NJ.workspace_member,is_bot:!1,is_internal_domain:l.length>0,internal_guest_enforcement:d.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:d,role:o.blockRole,space_role:o.spaceRole,user_count:s.length})}({createdMemberRequests:o.filter(m),environment:s,destination:l,metadata:g}))}function d(e){return"createdGuestRequest"===e.type}function m(e){return"createdMemberRequest"===e.type}function c(e){return"addedUserPermission"===e.type}function u(e){return!(!c(e)&&!function(e){return"addedGroupPermission"===e.type}(e))}function p(e){return"createdMember"===e.type}function g(e){let{environment:s,spaceId:i,pageId:t,pageVisibility:n,hasTrustedDomainPermission:r,hasPublicShareLinkPermission:a,shareMenuSessionId:l}=e;(0,o().u4)({environment:s,event:{eventName:"general_access_menu_open",eventProperties:{spaceId:i,pageId:t,pageVisibility:n,hasTrustedDomainPermission:r,hasPublicShareLinkPermission:a,shareMenuSessionId:l}}})}},391431:(e,s,i)=>{i.d(s,{A:()=>$});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(268117),l=(i(725707),i(500234),()=>i(198654)),d=()=>i(653998),m=()=>i(31448),c=()=>i(273520),u=()=>i(286404),p=()=>i(103151),g=()=>i(838517),h=()=>i(263370),b=()=>i(907721),f=()=>i(485966),v=()=>i(962373),y=()=>i(755769),x=()=>i(804345),S=()=>i(507012),I=()=>i(95434),P=i(163643);const j=16;function A(e){const{store:s,spacePermission:i}=e,n=(0,o().K8)((()=>s.canAdmin()),[s]),A=(0,g().i0)(s),_=(0,g().ty)(s),M=(0,h().X)(),w=(0,o().K8)((()=>(0,a().FI)()),[]),k=(0,o().K8)((()=>(0,a().sh)()),[]),C=(0,x().W)(i.permissionItem,k),T=(0,x().W)(i.permissionItem,!1),R=(0,o().K8)((()=>{const e=f().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),B=(0,o().uB)(void 0,v().A),N=(0,t.useRef)(null),D=(0,I().NR)(w,k),L=(0,r().IS)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.text.secondary,paddingLeft:12,maxWidth:380},title:{...m().RC},icon:{fill:e.text.secondary,width:j}})),[]);return R?(0,P.jsx)(c().Ay,{buttonPopupStore:B,popupType:c().z7.Popup,popupWrapStyle:L.popup,renderOrigin:e=>{const s=D.find((e=>e.key===C));return s?(0,P.jsx)(p().A,{placement:b().W.Bottom,alignment:b().C.Start,disableTooltip:n&&!A&&!_,renderTooltip:()=>n?A?(0,P.jsx)(d().sA,{defaultMessage:"Restore page from trash to change the privacy setting",id:"linkSharingPill.disabledTooltip.message.pageInTrash"}):_?(0,P.jsx)(d().sA,{defaultMessage:"Resolve pending edits to change the privacy setting",id:"linkSharingPill.disabledTooltip.message.hasAIEdits"}):void 0:(0,P.jsx)(d().sA,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:i=>(0,P.jsxs)(u().A,{...e,size:"lg",ref:N,style:L.button,icon:e=>s.icon({isShareMenuRedesignEnabled:w,spaceStore:R,style:e,teamspaceIconSize:j}),iconStyle:L.icon,disabled:!n||A||_,disabledFeedback:!0,...i,children:[(0,P.jsx)("div",{style:L.title,children:s.title({type:"shortened",spaceName:M,isShareMenuRedesignEnabled:w,visibility:T,isSearchableToggleEnabled:k})}),n&&(0,l().b)(L.chevron)]})}):null},placementToOrigin:y().UV.Bottom,alignmentToOrigin:y().MY.Start,sameWidthAsOrigin:!0,render:s=>(0,P.jsx)(S().q,{...e,parentCloseCallback:()=>s.close(),trustedDomainPermission:e.trustedDomainPermission})}):null}var _=()=>i(457774),M=()=>i(615917),w=()=>i(209684),k=()=>i(35462);function C(e){const{store:s,spacePermission:i}=e,n=(0,o().K8)((()=>(0,a().FI)()),[]),m=(0,o().K8)((()=>(0,a().sh)()),[]),c=(0,x().W)(i.permissionItem,m),u=(0,x().W)(i.permissionItem,!1),p=(0,I().NR)(n,m),b=(0,o().K8)((()=>s.canAdmin()),[s]),v=(0,g().i0)(s),y=(0,g().ty)(s),j=(0,h().X)(),A=(0,o().K8)((()=>{const e=f().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[C,T]=(0,t.useState)(!1),R=(0,r().IS)((s=>({chevron:{width:12,fill:s.mediumIconColor,marginLeft:"auto"},button:{height:42,color:s.text.secondary,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:s.regularIconColor,width:32,height:32,backgroundColor:s.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:e.showTrustedDomainPermission?250:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[e.showTrustedDomainPermission]),B=p.find((e=>e.key===c));return B&&A?(0,P.jsxs)("div",{style:R.container,children:[(0,P.jsxs)(w().p,{style:R.button,icon:e=>B.icon({style:e,spaceStore:A,isShareMenuRedesignEnabled:n,teamspaceIconSize:32}),iconStyle:R.icon,disabled:!b||v||y,disabledFeedback:!0,onClick:()=>T(!C),children:[(0,P.jsxs)("div",{children:[(0,P.jsx)(k().A,{isSmall:!0,children:(0,P.jsx)(d().sA,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,P.jsx)(k().A,{children:B.title({type:"shortened",spaceName:j,isShareMenuRedesignEnabled:n,visibility:u,isSearchableToggleEnabled:m})})]}),b&&(C?(0,l().b)(R.chevron):(0,_().B)(R.chevron))]}),(0,P.jsx)(M().A,{visible:C,animate:R.animation,initial:R.enterAnimation,exit:R.exitAnimation,children:(0,P.jsx)(S().q,{...e,parentCloseCallback:()=>T(!1)})})]}):null}var T=()=>i(712437),R=()=>i(718799),B=()=>i(680369),N=()=>i(446588),D=()=>i(234151),L=()=>i(91472),E=()=>i(951540),W=()=>i(927685),O=()=>i(137476),K=()=>i(29869);function U(e){const s=(0,n().v3)(),{device:t,WindowSizeStore:a}=s,l=(0,o().K8)((()=>({left:a.getSafePaddingLeftCSS(8),right:a.getSafePaddingRightCSS(12)})),[a]),m=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",width:t.isMobile?"100%":void 0,height:t.isMobile?44:32,paddingTop:t.isMobile?12:4,paddingBottom:t.isMobile?12:4,paddingLeft:l.left,paddingRight:l.right},questionMarkCircleSmall:{width:B().Ev.sm,height:B().Ev.sm,fill:t.isMobile?e.mediumIconColor:e.lightIconColor}})),[t.isMobile,l]);return(0,P.jsx)(i(579494).A,{href:(0,i(392608).xS)("guides.sharing"),onClick:()=>i(598995).FH(s,{from:"sharing"}),style:{width:t.isMobile?"100%":void 0},external:!0,children:(0,P.jsxs)(w().p,{mobileFeedback:t.isMobile,size:"sm",style:{...m.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,P.jsx)("div",{style:{marginLeft:t.isMobile?2:0,marginRight:t.isMobile?8:6},children:(0,i(350492).questionMarkCircleSmallIcon)(m.questionMarkCircleSmall)}),(0,P.jsx)(k().A,{isMobile:t.isMobile,isSecondaryColor:!t.isMobile,children:(0,P.jsx)(d().sA,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}U.displayName="LearnAboutSharingLink";const F=U;function z(e){const{store:s,buttonPopupStore:i,events:t}=e,l=(0,n().v3)(),{device:c,mobileNative:u}=l,p=c.isMobile,g=(0,o().K8)((()=>(0,a().FI)()),[]),h=(0,r().IS)((e=>({button:{flex:1,height:36,minHeight:36,...g?{borderRadius:12,marginTop:12}:{},...g&&p?{minHeight:48,fontSize:m().J.UIRegular.mobile}:{}}})),[g,p]);return(0,P.jsx)(E().A,{onClick:()=>{var e;c.isMobileNative?function(e){const{store:s,mobileNative:i}=e,t=(0,D().kb)({schemeUrl:(0,K().Ay)({store:s,pageVisitSource:T().y8.CopyLink}),baseUrl:W().A.domainBaseUrl});i&&i.share(t)}({store:s,mobileNative:u}):H({store:s,buttonPopupStore:i,environment:l});const t=null===(e=s.getCollectionStore())||void 0===e?void 0:e.id,n=s.getParentCollectionIdUpToTwoLevels();Y(l,{collection_id:t,parent_collection_id:n})},style:h.button,...t,children:c.isMobileNative?(0,P.jsx)(d().sA,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,P.jsx)(d().sA,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function G(e){const{store:s,buttonPopupStore:i,events:t,trustedDomainPermissionItem:l}=e,m=(0,n().v3)(),c=(0,o().K8)((()=>(0,a().FI)()),[]),p=(0,r().IS)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.text.primary,marginLeft:"auto"},icon:{width:B().Ev.default,height:B().Ev.default,fill:c?e.mediumIconColor:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.text.primary},redesignButton:{paddingLeft:10,paddingRight:12,paddingTop:6,paddingBottom:6,color:e.text.primary,justifyContent:"center",borderRadius:6}})),[c]);return c?(0,P.jsxs)(u().A,{size:"lg",onClick:()=>{var e;H({store:s,buttonPopupStore:i,environment:m,keepPopupOpen:!0});const t=null===(e=s.getCollectionStore())||void 0===e?void 0:e.id,n=s.getParentCollectionIdUpToTwoLevels();Y(m,{collection_id:t,parent_collection_id:n,trusted_domain_permission_role:l.role})},style:p.redesignButton,...t,children:[(0,R().w)(p.icon),(0,P.jsx)(k().A,{style:p.label,children:(0,P.jsx)(d().sA,{id:"blockPermissionsSettings.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]}):(0,P.jsxs)(w().p,{size:"sm",onClick:()=>{var e;H({store:s,buttonPopupStore:i,environment:m});const t=null===(e=s.getCollectionStore())||void 0===e?void 0:e.id,n=s.getParentCollectionIdUpToTwoLevels();Y(m,{collection_id:t,parent_collection_id:n,trusted_domain_permission_role:l.role})},style:p.button,...t,children:[(0,R().w)(p.icon),(0,P.jsx)(k().A,{isSmall:!0,style:p.label,children:(0,P.jsx)(d().sA,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function V(e){const{calculatedPermissions:s,isRedesignEnabled:i,spaceName:t}=e,n=s.mostPermissivePublicItem.permissionItem;if((0,N().Tt)(n.role))return(0,P.jsx)(d().sA,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const o=s.mostPermissiveSpaceItem.permissionItem;return(0,N().Tt)(o.role)?i&&t?(0,P.jsx)(d().sA,{defaultMessage:"Anyone at {spaceName} can access with this link",id:"blockPermissionsSettings.workspacePermissions.tooltipV2",values:{spaceName:t}}):(0,P.jsx)(d().sA,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):s.permissionItemsCount>1?i?(0,P.jsx)(d().sA,{defaultMessage:"Only people invited to this page can access with this link",id:"blockPermissionsSettings.userPermissions.tooltipV2"}):(0,P.jsx)(d().sA,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,P.jsx)(d().sA,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function H(e){const{store:s,buttonPopupStore:i,environment:t,keepPopupOpen:n}=e,o=(0,K().Ay)({store:s,pageVisitSource:T().y8.CopyLink}),r=await L().R.clipboardActions.load();await r.copyString({environment:t,stringValue:o,copiedMessage:r.clipboardMessages.copiedLinkToClipboard}),i&&!n&&i.setState({open:!1})}const q=function(e){const{store:s,buttonPopupStore:t,calculatedPermissions:l}=e,{device:d}=(0,n().v3)(),m=(0,h().X)(),c=(0,o().K8)((()=>(0,a().FI)()),[]),u=(0,o().uB)(void 0,i(60020).Ay),g=(0,i(226518).J)(),f=(0,o().K8)((()=>!!g&&"replace_sharing"===i(836331).default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[g]),v=(0,r().IS)((e=>({tooltip:{width:280},importContactsContainer:{boxShadow:"none",padding:0},importContactsButton:{width:"fit-content"},importContactsButtonTitle:{color:e.text.secondary,fontWeight:"normal"}})),[]);return(0,P.jsxs)(P.Fragment,{children:[c&&!d.isMobile&&(f?(0,P.jsx)(i(277011).g,{shouldShowSlackImportContactsButton:!0,shouldShowGoogleImportContactsButton:!0,emailMessage:"",inviteTargetsStore:u,isRedesignEnabled:c,emailMessageOpen:!1,source:"learn_about_sharing",originStyle:v.importContactsButton,containerStyle:v.importContactsContainer,titleStyle:v.importContactsButtonTitle}):(0,P.jsx)(F,{})),(0,P.jsx)(p().A,{delayThreshold:c?500:0,placement:b().W.Bottom,renderTooltip:()=>(0,P.jsx)(V,{calculatedPermissions:l,isRedesignEnabled:c,spaceName:m}),textWrap:!0,style:v.tooltip,render:e=>d.isMobile?(0,P.jsx)(z,{store:s,buttonPopupStore:t,events:e}):(0,P.jsx)(G,{store:s,buttonPopupStore:t,events:e,trustedDomainPermissionItem:l.mostPermissiveTrustedDomainItem.permissionItem})})]})};function Y(e,s){O().vd(e,"copy_link_from_permissions_setting",s)}const $=function(e){const{isMobile:s}=(0,n().Y0)(),t=(0,o().K8)((()=>(0,a().FI)()),[]),l=(0,r().IS)((e=>({container:{display:"flex",alignItems:s?"normal":"center",flexDirection:s?"column":"row",justifyContent:"space-between",padding:t?s?"16px 20px 20px":"12px 12px":"8px 14px",...t?{borderTop:s?`0.5px solid ${e.stroke.primary}`:`1px solid ${e.stroke.secondary}`}:{boxShadow:`0 -1px 0 ${e.regularDividerColor}`}}})),[s,t]),{mostPermissiveSpaceItem:d,mostPermissiveTrustedDomainItem:m,showTrustedDomainPermission:c,mostPermissivePublicItem:u,showPublicShareLinkPermission:p,showRestrictedPermissionBanner:g}=e.calculatedPermissions;return(0,P.jsx)("div",{style:l.container,children:s?t?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(i(53857).GeneralAccessPermissionSection,{store:e.store,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs}),(0,P.jsx)(q,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(C,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:d,isRestricted:g,showTrustedDomainPermission:c,trustedDomainPermission:m,publicPermission:u,showPublicShareLinkPermission:p,permissionItemArgs:e.permissionItemArgs}),(0,P.jsx)(q,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]}):t?(0,P.jsx)(q,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(A,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:d,isRestricted:g,showTrustedDomainPermission:c,trustedDomainPermission:m,publicPermission:u,showPublicShareLinkPermission:p,permissionItemArgs:e.permissionItemArgs}),(0,P.jsx)(q,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})}},423411:(e,s,i)=>{i.d(s,{H:()=>o,U:()=>n});var t=i(242343);const n=(0,t.createContext)(new(i(197447).A));function o(){return(0,t.useContext)(n)}n.displayName="TrustedDomainsContext"},433638:(e,s,i)=>{i.d(s,{A:()=>ie});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(944498),a=()=>i(268117),l=()=>i(432809),d=()=>i(174114),m=()=>i(712437),c=()=>i(486540),u=()=>i(653998),p=()=>i(539174),g=()=>i(931085),h=()=>i(28210),b=()=>i(709237),f=()=>i(431551),v=()=>i(35462),y=()=>i(29869),x=()=>i(378219),S=()=>i(320462),I=()=>i(413871),P=()=>i(628854),j=()=>i(880026),A=()=>i(914798),_=()=>i(636208),M=()=>i(422340),w=i(163643);function k(e){const{store:s,sudoModeStore:i}=e,a=(0,n().v3)(),{isMobile:l}=(0,n().Y0)(),m=(0,o().K8)((()=>function(e){const{store:s,environment:i}=e;return r().Uo6([r().Km9,r().AU6(r().oy3)])({environment:i,blocks:[s],publicEditMode:void 0})}({store:s,environment:a})),[s,a]),u=(0,o().K8)((()=>s.isRestricted()),[s]),p=(0,o().K8)((()=>x().fU(s)[1]),[s]),g=(0,o().K8)((()=>(0,c().wD)(x().E(p))),[p]),h=(0,t.useCallback)((async()=>{const e=!!i&&i.shouldSaveTransactionWithSudoMode(s);if(s.isDefined()&&p)if(u){const i=s.getPermissionItems(),t=(0,c().Cd)(s.getModel(),i,g);await(0,A().b)({environment:a,useSudoMode:e,store:s,permissionChanges:t,from:"inheritance_banner",shareMenuSessionId:M().Ay.state.sessionId,isRedesignEnabled:!0,parentStore:p})}else await(0,j().Dw)({environment:a,useSudoMode:e,store:s,permissionItem:void 0,fromPermissionWrapper:"inheritance_banner",isRedesignEnabled:!0,shouldInherit:!1})}),[a,i,s,u,p,g]),b=(0,d().IS)((e=>({container:{...(0,_().kJ)({theme:e,inheritanceBannerEnabled:!0,isMobile:l}),paddingLeft:12,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:8},labelContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},rightContainer:{flexShrink:0}})),[l]);return!m&&u?null:p?g.length<2?null:(0,w.jsxs)("div",{style:b.container,children:[(0,w.jsx)("div",{style:b.labelContainer,children:(0,w.jsx)(v().A,{isMultiline:!0,isSmall:!0,children:(0,w.jsx)(C,{store:s,navigableParentStore:p,showToggle:m})})}),m&&(0,w.jsx)("div",{style:b.rightContainer,children:(0,w.jsx)(f().A,{on:!u,onClick:h})})]}):null}function C(e){let{store:s,navigableParentStore:i,showToggle:t}=e;const r=(0,n().v3)(),a=(0,o().K8)((()=>{if(i instanceof I().Bv)return(0,y().Ay)({store:i,fullyQualified:!1,pageVisitSource:m().y8.ShareMenu})}),[i]),l=(0,o().K8)((()=>i.getIcon()),[i]),c=(0,d().IS)((e=>({recordContainer:{display:"inline",alignItems:"center"},title:{display:"inline"},recordIcon:{display:"inline-block",marginRight:2,verticalAlign:"text-bottom"}})),[]),f=(0,w.jsxs)("div",{style:c.recordContainer,children:[(0,w.jsx)(h().B,{disabled:!0,icon:l,size:14,isEmptyPage:!1,style:c.recordIcon}),(0,w.jsx)(g().A,{inline:!0,underline:!0,onClick:()=>{i instanceof I().h4&&(P().F2({environment:r,teamId:i.id,tab:S().p.Members,from:"share_menu"}),p().ks(r,{store:i,option:"view",from:"share_menu"}))},href:a,style:c.recordContainer,children:(0,w.jsx)(b().A,{shouldWrap:!0,store:i,style:c.title})})]});return t?(0,w.jsx)(u().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.switchLabel",defaultMessage:"Share with everyone who has access to {parentPageTitle}",values:{parentPageTitle:f}}):(0,w.jsx)(u().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.readOnlyLabel",defaultMessage:"Shared with everyone who has access to {parentPageTitle}",values:{parentPageTitle:f}})}var T=()=>i(550171),R=(i(725707),i(491955),()=>i(514438)),B=()=>i(755564),N=()=>i(533666),D=()=>i(954397),L=()=>i(218357),E=()=>i(76394),W=()=>i(31448),O=()=>i(126451),K=()=>i(535906),U=()=>i(273520),F=()=>i(356813),z=()=>i(935091),G=()=>i(858023),V=()=>i(397791),H=()=>i(88271),q=()=>i(640979),Y=()=>i(622163),$=()=>i(907721),Q=()=>i(28251);function X(e){const{showRestoreButton:s,store:i,type:t,sudoModeStore:r}=e,a=(0,n().v3)(),{isMobile:l}=(0,n().Y0)(),m=(0,o().K8)((()=>x().fU(i)[1]),[i]),c=(0,o().K8)((()=>i.canAdmin()),[i]),u=(0,d().IS)((e=>({banner:{...(0,_().kJ)({theme:e,inheritanceBannerEnabled:!1,isMobile:l}),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:(0,Y().ny)(a,"UIRegular"),lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"}})),[a,l]);return c?l?(0,w.jsxs)("div",{style:u.banner,children:[(0,w.jsxs)("div",{style:u.content,children:["restricted"===t&&(0,w.jsx)("div",{style:u.iconContainer,children:(0,w.jsx)(V().I,{icon:R().r,color:"secondary"})}),(0,w.jsx)(v().A,{style:u.label,isMultiline:!0,children:(0,w.jsx)(J,{type:t,navigableParentStore:m,showRestoreButton:s,store:i})})]}),s&&(0,w.jsx)(Z,{type:t,store:i,sudoModeStore:r})]}):(0,w.jsxs)("div",{style:u.banner,children:[(0,w.jsxs)("div",{style:u.content,children:["restricted"===t&&(0,w.jsx)("div",{style:u.iconContainer,children:(0,w.jsx)(V().I,{icon:R().r,color:"secondary"})}),(0,w.jsx)(v().A,{style:u.label,isMultiline:!0,children:(0,w.jsx)(J,{store:i,type:t,navigableParentStore:m,showRestoreButton:s})})]}),s&&(0,w.jsx)(Z,{type:t,store:i,sudoModeStore:r})]}):null}function J(e){const{store:s,type:i,navigableParentStore:t}=e,r=(0,n().v3)(),a=(0,o().K8)((()=>{if(t instanceof I().Bv)return(0,y().Ay)({store:t,fullyQualified:!1,pageVisitSource:m().y8.ShareMenu})}),[t]),l=(0,o().K8)((()=>t instanceof I().h4),[t]),c=(0,o().K8)((()=>t.getIcon()),[t]),f=(0,o().K8)((()=>s.isCollectionView()?"database":"page"),[s]),v=(0,d().IS)((e=>({recordContainer:{display:"inline",alignItems:"center",gap:2,marginLeft:2},title:{display:"inline"},recordIcon:{display:"inline-block",marginRight:2,verticalAlign:"text-bottom"}})),[]),x=t instanceof I().h4?(0,w.jsx)(g().A,{inline:!0,underline:!0,onClick:()=>{P().F2({environment:r,teamId:t.id,tab:S().p.Members,from:"permission_item"}),p().ks(r,{store:t,option:"view",from:"share_menu"})},children:(0,w.jsx)(b().A,{shouldWrap:!0,maxLength:30,store:t,style:v.title})}):(0,w.jsxs)("div",{style:v.recordContainer,children:[c&&(0,w.jsx)(h().B,{disabled:!0,icon:c,size:14,isEmptyPage:!1,style:v.recordIcon}),(0,w.jsx)(g().A,{inline:!0,href:a,style:v.recordContainer,children:(0,w.jsx)(b().A,{shouldWrap:!1,maxLength:30,store:t,style:v.title,underline:!0})})]});switch(i){case"elevated":return l?"database"===f?(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:x}}):(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:x}}):"database"===f?(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the parent page {parentPageTitle}",values:{parentPageTitle:x}}):(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the parent page {parentPageTitle}",values:{parentPageTitle:x}});case"restricted":return l?"database"===f?(0,w.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:x}}):(0,w.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBanner.label",defaultMessage:"Share settings on this page are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:x}}):"database"===f?(0,w.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:x}}):(0,w.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBanner.label",defaultMessage:"Share settings on this page are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:x}});default:(0,E().HB)(i)}}function Z(e){const{type:s,store:i,sudoModeStore:t}=e,r=(0,n().v3)(),{isMobile:a}=(0,n().Y0)(),l=(0,u().tz)(),g=(0,o().K8)((()=>!!t&&t.shouldSaveTransactionWithSudoMode(i)),[i,t]),h=(0,o().K8)((()=>(0,x().fU)(i)[1]),[i]),b=h.table===L().yK,f=(0,o().K8)((()=>{if(h instanceof I().Bv)return(0,y().Ay)({store:h,fullyQualified:!1,pageVisitSource:m().y8.ShareMenu})}),[h]),v=(0,d().IS)((e=>({icon:{fill:e.icon.secondary,height:16,width:16},mobileRestoreButton:{fontSize:(0,Y().ny)(r,"UIRegular"),fontWeight:W().Wy.medium,flexShrink:0,borderRadius:4,paddingLeft:4,paddingRight:4,color:e.text.uiBluePrimary}})),[r]),j=[b?{key:"showTeamSettings",render:e=>(0,w.jsx)(K().A,{...e,icon:(0,w.jsx)(V().I,{icon:D().slidersIcon}),title:(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"})}),action:()=>{h.table===L().yK&&(P().F2({environment:r,teamId:h.id,tab:S().p.Members,from:"permission_item"}),p().ks(r,{store:h,option:"view",from:"share_menu"}))}}:f?{key:"showParentPageSettings",render:e=>(0,w.jsx)(K().A,{...e,icon:(0,w.jsx)(V().I,{icon:D().slidersIcon}),title:(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"}),href:f}),action:()=>{}}:void 0,{key:"restore",action:async()=>{if("elevated"===s)await(0,Q().u)({environment:r,useSudoMode:g,store:i});else if("restricted"===s){if(!i.isDefined())return;const e=i.getPermissionItems(),s=x().fU(i)[1];if(!s)return;const t=(0,c().wD)(x().E(s)),n=(0,c().Cd)(i.getModel(),e,t);await(0,A().b)({environment:r,useSudoMode:g,store:i,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:M().Ay.state.sessionId,isRedesignEnabled:!0,parentStore:s})}else(0,E().HB)(s)},render:e=>(0,w.jsx)(K().A,{...e,title:(0,w.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.restoreSettings.label",defaultMessage:"Restore settings"}),icon:(0,w.jsx)(V().I,{icon:B().N})})}].filter(E().O9),_=[{key:"all",render:e=>(0,w.jsx)(H().A,{...e}),items:j}];return a?(0,w.jsx)(O().A,{style:v.mobileRestoreButton,onClick:async()=>{if("elevated"===s)await(0,Q().u)({environment:r,useSudoMode:g,store:i});else if("restricted"===s){if(!i.isDefined())return;const e=i.getPermissionItems(),s=x().fU(i)[1];if(!s)return;const t=(0,c().wD)(x().E(s)),n=(0,c().Cd)(i.getModel(),e,t);await(0,A().b)({environment:r,useSudoMode:g,store:i,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:M().Ay.state.sessionId,isRedesignEnabled:!0,parentStore:s})}else(0,E().HB)(s)},children:(0,w.jsx)(u().sA,{defaultMessage:"Restore",id:"pageShareMenu.restoreParentPagePermissionsBanner.restore.mobile.label"})}):(0,w.jsx)(U().Ay,{render:()=>(0,w.jsx)(z().A,{menuType:q().gu.Popup,children:(0,w.jsx)(G().Ay,{type:G().Oh.Vertical,sections:_,initialFocus:void 0})}),renderOrigin:e=>(0,w.jsx)(F().A,{icon:N().Y,iconStyle:v.icon,ariaLabel:l.formatMessage({id:"pageShareMenu.restorePagePermissionsBanner.restoreOptionsButton.label",defaultMessage:"See restore permissions options"}),...e}),popupType:U().z7.Popup,placementToOrigin:$().W.Bottom,alignmentToOrigin:$().C.End})}function ee(e){const{store:s}=e,i=(0,n().v3)(),t=(0,o().K8)((()=>function(e){const{store:s,environment:i}=e;return r().or([r().Km9,r().Uo6([r()._mr,r().AU6(r().Km9)])])({environment:i,blocks:[s],publicEditMode:void 0})}({store:s,environment:i})),[s,i]);return(0,o().K8)((()=>(0,a().FI)()),[])?(0,w.jsx)(X,{type:"restricted",showRestoreButton:t,store:s,sudoModeStore:e.sudoModeStore}):(0,w.jsx)(T().A,{type:"unrestrict",showRestoreButton:t,store:s,sudoModeStore:e.sudoModeStore})}function se(e){const{store:s}=e,i=(0,o().K8)((()=>(0,l().le)({store:s})),[s]),t=(0,o().K8)((()=>(0,a().FI)()),[]);return i?t?(0,w.jsx)(X,{type:"elevated",showRestoreButton:!1,store:s,sudoModeStore:e.sudoModeStore}):(0,w.jsx)(T().A,{type:"restore-team",showRestoreButton:!1,store:s,sudoModeStore:e.sudoModeStore}):null}const ie=function(e){const{store:s,showRestrictedPermissionBanner:i,showPermissionInheritanceBanner:t}=e,{canAccessParent:n}=(0,o().K8)((()=>(0,l().iG)({store:s})),[s]);return n?t?(0,w.jsx)(k,{store:s,sudoModeStore:e.sudoModeStore}):i?(0,w.jsx)(ee,{store:s,sudoModeStore:e.sudoModeStore}):(0,w.jsx)(se,{store:s,sudoModeStore:e.sudoModeStore}):null}},439510:(e,s,i)=>{i.d(s,{A:()=>g});i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(174114),r=()=>i(218357),a=()=>i(653998),l=()=>i(758103),d=()=>i(895048),m=i(163643);function c(e){let{teamName:s,isCompact:i,isRedesignEnabled:t}=e;return i&&t?(0,m.jsx)(a().sA,{defaultMessage:"Members",id:"blockPermissionsSettings.permissionItem.teamAccessV3"}):i&&s?(0,m.jsx)(a().sA,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):s?(0,m.jsx)(a().sA,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:s}}):(0,m.jsx)(a().sA,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function u(e){let{isCompact:s,membersCount:i,isRedesignEnabled:n,permissionItem:o}=e;const{isMobile:d}=(0,t().Y0)();return s&&!n||0===i?null:d&&n&&o?(0,m.jsxs)("div",{children:[(0,m.jsx)(a().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:i}})," 路 ",(0,m.jsx)(a().sA,{...(0,l().R)({type:o.type,role:o.role,table:r().yK,isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0}).label})]}):(0,m.jsx)(a().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:i}})}function p(e){const{teamName:s}=e,i=(0,o().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,m.jsx)("div",{style:i.tooltip,children:(0,m.jsx)(a().sA,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:s},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const g=function(e){let{store:s,blockTeamPermission:a,isExternalTeam:l,fromPermissionWrapper:g,teamMembersCount:h,permissionItemArgs:b}=e;const{isMobile:f}=(0,t().Y0)(),v=(0,n().K8)((()=>(0,i(268117).FI)()),[]),{permissionItem:y}=a,x=(0,n().O$)(i(485966).AppStoreCurrentSpaceStore),S=(0,n().K8)((()=>{var e;return i(446588).gl(y)?y.team_id:null===(e=i(378219).Uo(s))||void 0===e?void 0:e.id}),[y,s]),{teamStore:I,teamIsDefined:P,teamName:j}=(0,n().K8)((()=>{if(!x||!S)return{};const e=i(413871).h4.createChildStore(x,{table:r().yK,id:S,spaceId:x.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[x,S]),A=!l,_=(0,n().K8)((()=>{return h||(void 0!==I?null===(e=(0,i(904697).getTeamMemberCountAndSampleUserIds)(I))||void 0===e?void 0:e.memberCount:void 0);var e}),[I,h]),M=(0,o().IS)((()=>({container:{width:"100%"}})),[]);return I?(0,m.jsx)("div",{style:M.container,className:i(983050).rkF,children:(0,m.jsx)(d().Ay,{isCompact:A,store:s,permissionItem:a.permissionItem,from:a.from,icon:v?(0,m.jsx)(i(969836).A,{size:f&&v?d().Bj:d().Ev}):P?(0,m.jsx)(i(424339).x,{disabled:!0,store:I,size:f&&v?d().Bj:d().Ev}):(0,i(156259).s)(),title:(0,m.jsx)(c,{teamName:j,isCompact:A,isRedesignEnabled:v}),nonInheritedTooltip:(0,m.jsx)(p,{teamName:(0,m.jsx)(i(129663).A,{store:I,useInvertedColors:!0})}),subtitle:P&&(0,m.jsx)(u,{membersCount:_??0,isCompact:A,isRedesignEnabled:v,permissionItem:a.permissionItem}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:g,...b})}):null}},474536:(e,s,i)=>{i.d(s,{P:()=>l});var t=()=>i(803290),n=()=>i(76394),o=()=>i(378219),r=()=>i(533625),a=()=>i(485966);function l(e){let{store:s}=e;return(0,t().K8)((()=>{const e=(0,r().h)({blockId:s.id,setting:"publicAccess"});if((0,n().O9)(e))return e;const i=a().default.state.currentSpaceStore,t=(0,o().Uo)(s);return t?{disabled:Boolean(t.getDisablePublicAccess()),disabledBy:"team"}:!t&&null!=i&&i.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}),[s])}},477988:(e,s,i)=>{i.d(s,{A:()=>D});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(718799),l=()=>i(127436),d=()=>i(446588),m=()=>i(653998),c=()=>i(76394),u=()=>i(758103),p=()=>i(535906),g=()=>i(431551),h=i(163643);function b(e){const{permissionItem:s,onToggle:i,focused:t}=e,a=(0,m().tz)(),{isMobile:l}=(0,n().Y0)(),d=(0,o().K8)((()=>Boolean(s)&&!Boolean(s.unlisted_timestamp)),[s]),c=(0,r().IS)((e=>({visibilityToggle:{display:"flex",alignItems:"start",justifyContent:"space-between",marginLeft:12,paddingLeft:4},buttonMenuItemStyleMobile:{backgroundColor:e.surface.elevated,paddingTop:12,paddingBottom:12,marginRight:12,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.stroke.secondary,width:"100%"}})),[]),u=a.formatMessage({id:"spacePermissionItem.visibilityPicker.unlistedToggle",defaultMessage:"Hide in search"});return(0,h.jsx)("div",{children:(0,h.jsx)(p().A,{onClick:i,focused:t,style:l?c.buttonMenuItemStyleMobile:{},title:u,shouldWrapTitle:!0,right:(0,h.jsx)("div",{style:l?{}:c.visibilityToggle,children:(0,h.jsx)(g().A,{disabled:!1,on:!d,onClick:i})})})})}var f=()=>i(983050),v=()=>i(548694),y=()=>i(153642),x=()=>i(522105),S=()=>i(485966),I=()=>i(836331),P=()=>i(171521),j=()=>i(268117),A=()=>i(432809),_=()=>i(234467),M=()=>i(895048),w=()=>i(436599),k=()=>i(560033);function C(e){let{visibility:s,spaceStore:i}=e;const t=(0,n().v3)(),r=(0,o().K8)((()=>(0,v().GK)(t,i)),[t,i]),a=(0,o().K8)((()=>(0,j().FI)()),[]),l=(0,o().K8)((()=>(0,j().sh)()),[]);switch(s){case"private":return(0,h.jsx)(m().sA,{id:"spacePermissionVisibilityPicker.private",defaultMessage:"Only people invited"});case"unlisted":return l?(0,h.jsx)(m().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:r}}):a?(0,h.jsx)(m().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLinkV2",defaultMessage:"Anyone at {spaceName} with the link",values:{spaceName:r}}):(0,h.jsx)(m().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:r}});case"open":case"open_unlisted_hybrid":return(0,h.jsx)(m().sA,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:r}});default:(0,c().HB)(s)}}const T=new(i(380123).R)({key:"shareMenuRoleSelectCalloutCount",namespace:i(146325).Bq,important:!0,trackingType:"necessary"});function R(e){let{visibility:s,spaceStore:i,isRedesignEnabled:t,isSearchableToggleEnabled:n,isMobile:o}=e;const d=(0,r().IS)((e=>({lockIcon:{width:o&&t?24:18,height:o&&t?24:18},linkIcon:{width:17,height:17,...t?void 0:{fill:e.mediumIconColor}}})),[o,t]);return"private"===s?t?(0,h.jsx)(w().A,{type:"square",iconType:"function",iconFn:l().i,iconStyle:d.lockIcon,isMobile:o}):(0,h.jsx)(k().A,{store:i}):"unlisted"===s?n?(0,h.jsx)(k().A,{store:i}):t?(0,h.jsx)(w().A,{type:"square",iconType:"function",iconFn:a().w,iconStyle:d.linkIcon,isMobile:o}):(0,a().w)(d.linkIcon):"open"===s||"open_unlisted_hybrid"===s?(0,h.jsx)(k().A,{store:i}):void(0,c().HB)(s)}function B(e){let{store:s,spacePermission:i,showTrustedDomainPermission:t,trustedDomainPermission:r,publicPermission:a,showPublicShareLinkPermission:l,isRestricted:d,permissionItemArgs:c,fromPermissionWrapper:u,buttonPopupStore:p,visibility:g,isRedesignEnabled:b,spaceStore:f,hideHoverStyles:y,isDisplayOnly:x,handleSpacePermissionChange:S}=e;const I=(0,n().v3)(),P=(0,o().K8)((()=>(0,v().GK)(I,f)),[I,f]);return b?(0,h.jsx)(_().o,{store:s,spacePermission:i,showTrustedDomainPermission:t,trustedDomainPermission:r,publicPermission:a,showPublicShareLinkPermission:l,isRestricted:d,permissionItemArgs:c,fromPermissionWrapper:u,buttonPopupStore:p,hideHoverStyles:y,isDisplayOnly:x,handleSpacePermissionChange:S,title:(0,h.jsx)(C,{visibility:g,spaceStore:f})}):"unlisted"===g?(0,h.jsx)(m().sA,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}):(0,h.jsx)(m().sA,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:P}})}function N(){const e=(0,y().V)()??1;return(0,h.jsx)(m().sA,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:e}})}const D=function(e){let{showTrustedDomainPermission:s,trustedDomainPermission:a,isRestricted:l,publicPermission:c,showPublicShareLinkPermission:p,shouldShowPublicShareLinkTooltip:g,...y}=e;const{store:_,spacePermission:w,fromPermissionWrapper:k}=y,C=(0,n().v3)(),D=C.device.isMobile,L=(0,t.useRef)(null),E=(0,o().K8)((()=>(0,j().FI)()),[]),W=(0,o().K8)((()=>(0,j().sh)()),[]),O=(0,o().uB)(void 0,i(962373).A);(0,t.useEffect)((()=>{g&&(0,i(689248).HH)(C,x().n)}),[C,g]);const K=d().Ni(w.permissionItem)&&"none"!==w.permissionItem.role,U=(0,P().QX)(w),F=(0,d().Tt)((null==a?void 0:a.permissionItem.role)??"none"),z=(0,d().Tt)((null==c?void 0:c.permissionItem.role)??"none"),G=(0,o().O$)(S().AppStoreCurrentSpaceStore),V=(0,o().K8)((()=>{const e=S().default.state.currentSpaceStore;return null==e||!e.isDefined()}),[]),H=(0,o().K8)((()=>{const e=S().default.state.currentSpaceStore;return!!e&&(0,v().IL)(e)}),[]),q=(0,o().K8)((()=>(0,A().WG)()),[]),Y=(0,o().K8)((()=>I().default.checkGate({gateName:"domain_link_sharing_redesign_override",disableExposureLogging:!0})||"on"===I().default.getEligibleGroup({experimentId:"domain_link_sharing_redesign",defaultGroup:"control"})),[]),$=(0,i(423411).H)(),Q=(0,o().K8)((()=>{var e;return null==$||null===(e=$.getForSpace(G))||void 0===e?void 0:e.trustedDomains}),[$,G]),X=(0,o().K8)((()=>(0,i(401574).Hb)({space:null==G?void 0:G.getModel(),trustedDomains:Q,enableTrustedDomainPermissionRedesign:Y})),[G,Q,Y]),J=(0,o().K8)((()=>!!G&&_.isTopLevelWorkspacePage(G.id)),[_,G]),Z=(0,o().K8)((()=>{const e=(0,A().QJ)({store:_});return e?(0,i(804345).W)(e):"private"}),[_]),ee=!q&&s&&F&&!z,se=(0,t.useCallback)((e=>{"none"===e&&F&&a&&(0,i(642546).p)({trustedDomainPermission:a,store:_,environment:C,sudoModeStore:y.permissionItemArgs.sudoModeStore,location:y.permissionItemArgs.location})}),[C,F,y.permissionItemArgs.location,y.permissionItemArgs.sudoModeStore,_,a]),ie=(0,o().K8)((()=>T.getState()??0),[]),[te,ne]=(0,t.useState)(!1),oe=(0,t.useCallback)((e=>{let{before:s,after:i}=e;if(!E||!W)return;let t=!1;const n=(0,P().QX)(s),o=(0,P().QX)(i);"private"===n&&"private"!==o&&ie<3&&(t=!0,T.setState(ie+1)),ne(t)}),[ie,E,W]),re=(0,t.useCallback)((()=>{E&&O.setState({open:!0})}),[E,O]),ae=(0,t.useCallback)((async()=>{const e=w.permissionItem,s=(0,i(975392).mg)(e);let t;"unlisted"===("open"===U?"unlisted":"open")?(s.unlisted_timestamp=Date.now(),t="open"===Z):(delete s.unlisted_timestamp,t=!1);const n=w.from,o=(0,d().Yi)(n),r=!(n.table===_.table&&o===_.id);t=t&&!J&&!l,await(0,i(880026).Hc)({oldPermissionItem:e,newPermissionItem:s,wasInherited:r,environment:C,store:_,restrictingVisibility:t,sudoModeStore:y.permissionItemArgs.sudoModeStore,location:y.permissionItemArgs.location})}),[C,w,J,y.permissionItemArgs,U,_,l,Z]),le=(0,r().IS)((e=>({container:{width:"100%"},preRedesignLinkIconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),de=(0,t.useMemo)((()=>W?[{role:"none",prefixItem:{key:"can-find-in-search-toggle",render:e=>(0,h.jsx)(i(103151).A,{placement:i(907721).W.Left,renderTooltip:()=>(0,h.jsx)("div",{style:{width:250,whiteSpace:"normal"},children:(0,h.jsx)(m().sA,{defaultMessage:"Hide this page in search results from users without the link or who havent visited it before",id:"spacePermissionItem.unlistedToggle.tooltip"})}),render:s=>(0,h.jsx)("div",{...e,...s,children:(0,h.jsx)(b,{permissionItem:w.permissionItem,onToggle:ae,focused:e.focused})})}),action:()=>{}}}]:[]),[w,ae,W]),me="private"===U&&E;if(!G)return null;if(V)return H&&E?(0,h.jsx)("div",{style:le.container,className:K?void 0:f().VRj,children:(0,h.jsx)(M().Ay,{store:_,permissionItem:w.permissionItem,from:w.from,icon:(0,h.jsx)(R,{visibility:U,spaceStore:G,isRedesignEnabled:E,isSearchableToggleEnabled:W,isMobile:C.device.isMobile}),iconStyle:E||"unlisted"!==U?void 0:le.preRedesignLinkIconContainer,title:(0,h.jsx)(B,{store:_,spaceStore:G,spacePermission:w,showTrustedDomainPermission:s,trustedDomainPermission:a,publicPermission:c,showPublicShareLinkPermission:p,isRestricted:!0,permissionItemArgs:y.permissionItemArgs,fromPermissionWrapper:k,buttonPopupStore:O,visibility:U,isRedesignEnabled:E,hideHoverStyles:me,isDisplayOnly:!0,handleSpacePermissionChange:oe}),subtitle:D&&!me?(0,h.jsx)(m().sA,{...(0,u().R)({type:"space_permission",role:w.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:E}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:k,isRemovableOverride:!0,hideRoleSelectButton:me,renderTitleWithoutUILabelWrapper:E,...y.permissionItemArgs,shouldDisable:!0})}):null;const ce=q&&(null==X?void 0:X.length)>0&&("open"===U||"unlisted"===U),ue=ce?(0,h.jsx)(m().sA,{defaultMessage:"Anyone with a {trustedDomain} email can also view this page",id:"blockPermissionsSettings.spacePermission.trustedDomainTooltip",values:{trustedDomain:X[0]}}):E||"open"!==U||D?void 0:(0,h.jsx)(m().sA,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x().M,{originRef:L,onPrimaryButtonClick:re}),(0,h.jsxs)("div",{style:le.container,className:K?void 0:f().VRj,ref:L,children:[(0,h.jsx)(M().Ay,{store:_,permissionItem:w.permissionItem,from:w.from,icon:(0,h.jsx)(R,{visibility:U,spaceStore:G,isRedesignEnabled:E,isSearchableToggleEnabled:W,isMobile:C.device.isMobile}),iconStyle:E||"unlisted"!==U?void 0:le.preRedesignLinkIconContainer,title:(0,h.jsx)(B,{store:_,spaceStore:G,spacePermission:w,showTrustedDomainPermission:s,trustedDomainPermission:a,publicPermission:c,showPublicShareLinkPermission:p,isRestricted:l,permissionItemArgs:y.permissionItemArgs,fromPermissionWrapper:k,buttonPopupStore:O,visibility:U,isRedesignEnabled:E,hideHoverStyles:me,isDisplayOnly:y.permissionItemArgs.shouldDisable??!1,handleSpacePermissionChange:oe}),selectHeader:E&&D?(0,h.jsx)(i(932322).Ay,{title:(0,h.jsx)(B,{store:_,spaceStore:G,spacePermission:w,showTrustedDomainPermission:s,trustedDomainPermission:a,publicPermission:c,showPublicShareLinkPermission:p,isRestricted:l,permissionItemArgs:y.permissionItemArgs,fromPermissionWrapper:k,buttonPopupStore:O,visibility:U,isRedesignEnabled:E,hideHoverStyles:me,isDisplayOnly:!0,handleSpacePermissionChange:oe}),icon:(0,h.jsx)(R,{visibility:U,spaceStore:G,isRedesignEnabled:E,isSearchableToggleEnabled:W,isMobile:C.device.isMobile}),desktopIconStyle:{marginLeft:16}}):void 0,onClick:E?re:void 0,inheritedTooltip:ce?ue:void 0,nonInheritedTooltip:ue,subtitle:E||"unlisted"===U?E&&D&&!me?(0,h.jsx)(m().sA,{...(0,u().R)({type:"space_permission",role:w.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:E}).label}):void 0:(0,h.jsx)(N,{}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:k,onChangeSuccess:se,isRemovableOverride:!0,hideRoleSelectButton:me,renderTitleWithoutUILabelWrapper:E,roleItemOverrides:de,openRoleSelectMenuOnRender:te,...y.permissionItemArgs}),ee&&(0,h.jsx)(i(688174).A,{store:_,trustedDomainPermission:a,permissionItemArgs:y.permissionItemArgs,fromPermissionWrapper:k,renderStyle:"permissionItem"})]})]})}},482421:(e,s,i)=>{i.d(s,{A:()=>g});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(711361),l=()=>i(653998),d=()=>i(126451),m=()=>i(35462),c=()=>i(268117),u=()=>i(636208),p=i(163643);function g(e){let{permissions:s}=e;const i=(0,n().v3)().device.isMobile,[g,h]=(0,t.useState)(!1),b=(0,o().K8)((()=>(0,c().FI)()),[]),f=(0,r().IS)((e=>({button:{width:"100%",display:g?"none":"inline-flex",padding:8,...b&&{alignItems:"center",...(0,u().wo)({isMobile:i}),width:"calc(100% - 16px)",height:48}},icon:{width:14,transform:"rotate(90deg)",fill:e.lightIconColor},list:{display:g?"block":"none"},dotsIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",...b?{width:32,marginRight:(0,u().qj)({isMobile:i})}:{width:36+(0,u().qj)({isMobile:i})}}})),[i,b,g]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d().A,{onClick:()=>h(!0),style:f.button,children:[(0,p.jsx)("div",{style:f.dotsIconContainer,children:(0,a()._)(f.icon)}),(0,p.jsx)(m().A,{isSmall:!b,isSecondaryColor:!0,children:b?(0,p.jsx)(l().sA,{id:"blockPermissionsSettings.permissionsList.expandButtonV2",defaultMessage:"See {count} more",values:{count:s.length}}):(0,p.jsx)(l().sA,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:s.length}})})]}),(0,p.jsx)("div",{style:f.list,children:s})]})}},496505:(e,s,i)=>{i.d(s,{A:()=>y});i(403517),i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(174114),r=()=>i(156259),a=()=>i(218357),l=()=>i(409211),d=()=>i(653998),m=()=>i(758103),c=()=>i(413871),u=()=>i(132634),p=()=>i(895048),g=i(163643);function h(e){const{store:s,teamOwners:i,teamStore:t,teamName:n}=e;if(n){const e=i.map((e=>c().LU.createChildStore(s,{table:l().oo,id:e})));return(0,g.jsx)(u().l,{teamStore:t,ownerStores:e})}return(0,r().s)()}function b(e){let{teamName:s,isCompact:i,isRedesignEnabled:t}=e;return i&&t?(0,g.jsx)(d().sA,{defaultMessage:"Owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV3"}):i&&s?(0,g.jsx)(d().sA,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:s}}):s?(0,g.jsx)(d().sA,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:s}}):(0,g.jsx)(d().sA,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function f(e){let{teamOwnersCount:s,isCompact:i,isRedesignEnabled:n,permissionItem:o}=e;const{isMobile:r}=(0,t().Y0)();return i&&!n||0===s?null:r&&n&&o?(0,g.jsxs)("div",{children:[(0,g.jsx)(d().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:s}})," 路 ",(0,g.jsx)(d().sA,{...(0,m().R)({type:o.type,role:o.role,table:a().yK,isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:!0}).label})]}):(0,g.jsx)(d().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:s}})}function v(e){const{teamName:s}=e,i=(0,o().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,g.jsx)("div",{style:i.tooltip,children:(0,g.jsx)(d().sA,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:s},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const y=function(e){let{store:s,blockTeamOwnerPermission:r,isExternalTeam:l,fromPermissionWrapper:d,teamOwnersCount:m,permissionItemArgs:u}=e;const{isMobile:y}=(0,t().Y0)(),x=(0,n().K8)((()=>(0,i(268117).FI)()),[]),{permissionItem:S}=r,I=(0,n().O$)(i(485966).AppStoreCurrentSpaceStore),P=(0,n().K8)((()=>{var e;return i(446588).nl(S)?S.team_id:null===(e=i(378219).Uo(s))||void 0===e?void 0:e.id}),[S,s]),{teamStore:j,teamName:A,teamOwners:_}=(0,n().K8)((()=>{if(!I||!P)return{undefined:void 0};const e=c().h4.createChildStore(I,{table:a().yK,id:P,spaceId:I.id});return{teamStore:e,teamName:e.getName(),teamOwners:e.getOwnerUserIds()}}),[I,P]),M=!l,w=(0,n().K8)((()=>{return m||(void 0!==j?null===(e=(0,i(904697).getTeamMemberCountAndSampleUserIds)(j))||void 0===e?void 0:e.ownerCount:void 0);var e}),[j,m]),k=(0,o().IS)((()=>({container:{width:"100%"}})),[]);return j?(0,g.jsx)("div",{style:k.container,className:i(983050).D3T,children:(0,g.jsx)(p().Ay,{isCompact:M,store:s,permissionItem:r.permissionItem,from:r.from,icon:x?(0,g.jsx)(i(969836).A,{size:y&&x?p().Bj:p().Ev}):(0,g.jsx)(h,{store:s,teamName:A,teamStore:j,teamOwners:_}),title:(0,g.jsx)(b,{teamName:A,isCompact:M,isRedesignEnabled:x}),nonInheritedTooltip:(0,g.jsx)(v,{teamName:(0,g.jsx)(i(129663).A,{store:j,useInvertedColors:!0})}),subtitle:(0,g.jsx)(f,{teamOwnersCount:w??0,isCompact:M,isRedesignEnabled:x,permissionItem:r.permissionItem}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:d,...u})}):null}},503880:(e,s,i)=>{i.d(s,{D:()=>n});i(242343);var t=i(163643);const n=(0,i(680369).wt)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,t.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})})},507012:(e,s,i)=>{i.d(s,{q:()=>G});i(725707),i(491955),i(403517);var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(174114),a=()=>i(446588),l=()=>i(174427),d=()=>i(653998),m=()=>i(76394),c=()=>i(31448),u=()=>i(535906),p=()=>i(935091),g=()=>i(858023),h=()=>i(88271),b=()=>i(35462),f=()=>i(640979),v=()=>i(263370),y=()=>i(880026),x=()=>i(111664);var S=()=>i(485966),I=()=>i(501578),P=()=>i(423411),j=()=>i(363721),A=()=>i(642546),_=()=>i(804345),M=()=>i(268117),w=()=>i(432809),k=()=>i(622286),C=()=>i(997010);var T=()=>i(422340),R=()=>i(279968),B=()=>i(103151),N=()=>i(772074),D=()=>i(474536),L=()=>i(907721),E=()=>i(836331),W=i(163643);function O(e){const{store:s,publicPermission:i,permissionItemArgs:o,menuListItemProps:m,onClose:c}=e,{permissionItem:p,from:g}=i,{sudoModeStore:h,location:b}=o,f=(0,n().v3)(),{isPhone:v,isMobile:S}=(0,n().Y0)(),I=(0,l().v)(i.permissionItem),P=(0,D().P)({store:s}),j=P.disabled,A=(0,t.useCallback)((async()=>{const e=(0,a().Yi)(g),i=(0,x().u)(p,"reader");await(0,y().Hc)({oldPermissionItem:p,newPermissionItem:i,wasInherited:e!==s.id,environment:f,store:s,sudoModeStore:h,location:b}),E().default.logEvent("public_share_link_created"),c()}),[f,s,p,g,h,b,c]),_=(0,r().IS)((e=>({menuItemIcon:{height:16,width:16,fill:e.icon.secondary,...j&&{fill:e.icon.tertiary}},menuItemDesktopIconStyle:{...S?{marginTop:5,marginBottom:4,marginLeft:13,marginRight:6}:{marginLeft:0},alignSelf:"center"},menuItemContainer:{minHeight:28,marginBottom:2,lineHeight:"unset",...v&&{paddingTop:N().T3,paddingBottom:N().T3},color:e.text.primary,...j&&{color:e.text.tertiary}}})),[S,v,j]);let M;return j&&"space"===P.disabledBy&&(M=(0,W.jsx)(d().sA,{defaultMessage:"Workspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledWorkspace"})),j&&"team"===P.disabledBy&&(M=(0,W.jsx)(d().sA,{defaultMessage:"Teamspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledTeamspace"})),(0,W.jsx)(B().A,{renderTooltip:e=>M,placement:L().W.Bottom,disableTooltip:!j,render:e=>(0,W.jsx)(u().A,{...m,...e,title:(0,W.jsx)(d().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.menuItem.title"}),shouldWrapTitle:!0,shouldWrapCaption:!0,style:_.menuItemContainer,icon:(0,R().h)(_.menuItemIcon),desktopIconStyle:_.menuItemDesktopIconStyle,isChecked:I,disabled:j,onClick:A})})}var K=()=>i(688174),U=()=>i(95434);const F=[{key:"trustedDomain",title:()=>{},caption:()=>{},icon:()=>{}}],z={key:"publicShareLink",title:()=>{},caption:()=>{},icon:()=>{}};function G(e){const{store:s,spacePermission:i,sudoModeStore:R,location:B,isRestricted:N,trustedDomainPermission:D,publicPermission:L,showPublicShareLinkPermission:E,parentCloseCallback:G,handleSpacePermissionChange:H,permissionItemArgs:q,onlyShowPrivateSpaceVisibility:Y}=e,$=(0,n().v3)(),{isMobile:Q,isTablet:X}=(0,n().Y0)(),J=(0,o().K8)((()=>(0,M().FI)()),[]),Z=(0,o().K8)((()=>(0,M().sh)()),[]),ee=(0,o().O$)(S().AppStoreCurrentSpaceStore),se=(0,_().W)(i.permissionItem,Z),ie=(0,_().W)(i.permissionItem,!1),te=i.from,ne=(0,a().Yi)(te),oe=!(te.table===s.table&&ne===s.id),re=(0,o().K8)((()=>{const{currentSpaceStore:e}=S().default.state;return!!e&&s.isTopLevelWorkspacePage(e.id)}),[s]),ae=(0,v().X)(),le=(0,o().K8)((()=>{const e=w().QJ({store:s});return e?(0,_().W)(e):"private"}),[s]),de=(0,a().Tt)((null==D?void 0:D.permissionItem.role)??"none"),me=(0,P().H)(),ce=(0,o().K8)((()=>(0,w().pQ)({trustedDomainsStore:me})),[me]),ue=function(){const e=(0,k().X)("personal_sharing_hide_workspace_permission"),s=(0,k().X)("sharing_anyone_with_the_link");return(0,C().X)()&&e&&s}(),pe=(0,U().NR)(J,Z,Y,ue);(0,t.useEffect)((()=>{null!=ee&&ee.id&&j().V0({environment:$,spaceId:ee.id,pageId:s.id,pageVisibility:ie,hasTrustedDomainPermission:de,hasPublicShareLinkPermission:!(null==L||!L.permissionItem)&&(0,l().v)(L.permissionItem),shareMenuSessionId:T().Ay.state.sessionId})}),[null==ee?void 0:ee.id,s.id,ie,de,$,L]);const ge=(0,o().K8)((()=>(0,w().WG)()),[]),he=ce&&D&&!de&&!ge?[...pe,...F]:E?[...pe,z]:pe,be=(0,t.useCallback)((async()=>{let e=ie;"private"===ie&&(e="open");const t=i.permissionItem,n=V(t,ie,e);await(0,y().o5)({oldPermissionItem:t,newRole:n,wasInherited:oe,environment:$,store:s,sudoModeStore:R,location:B,restrictingVisibility:!1}),G()}),[$,oe,B,G,ie,i.permissionItem,s,R]),fe=(0,r().IS)((e=>({icon:{fill:Q?e.regularIconColor:J?e.text.primary:e.text.secondary,width:U().eo},iconContainer:{...Q?{marginLeft:13,marginTop:5,marginBottom:4}:{marginLeft:J?0:9},...J?{marginRight:0}:{alignSelf:"center"},...Z?{alignSelf:"center"}:{}},selectedTitle:J?{}:{fontWeight:c().Wy.semibold},titleStyle:J&&Q?{marginLeft:4}:{},mobileScroller:{...J?{background:e.surface.wash}:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24}},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"},sectionMenuItem:{...J&&!Q?{paddingTop:4,paddingBottom:4}:{},...J&&Q?{overflow:"hidden",background:e.buttonBackground,borderRadius:12,marginLeft:16,marginRight:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary,padding:void 0}:{}},menuList:{...J&&Q?{width:"100%",margin:"0 auto"}:{}},header:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:e.surface.wash,paddingTop:12,paddingBottom:20},headerLabel:{fontSize:16,fontWeight:c().Wy.semibold}})),[Q,J,Z]);if(!ee)return null;const ve=!!L&&(0,l().v)(L.permissionItem);return(0,W.jsx)(p().A,{menuType:f().gu.Popup,disableScroller:!0,scrollerStyle:Q?fe.mobileScroller:{},height:Q&&J?X?"100%":"50vh":void 0,minWidth:Q&&J?"100%":void 0,maxWidth:Q&&J?"100%":void 0,maxHeight:Q&&J?"100%":void 0,header:Q&&J?(0,W.jsx)("div",{style:fe.header,children:(0,W.jsx)(b().A,{style:fe.headerLabel,children:(0,W.jsx)(d().sA,{defaultMessage:"General access",id:"PermissionRoleSelect.Header.GeneralAccess"})})}):void 0,children:(0,W.jsx)(g().Ay,{type:g().Oh.Vertical,initialFocus:void 0,style:Q&&J?fe.menuList:void 0,sections:[{key:"visibilityOptions",render:e=>(0,W.jsx)(h().A,{...e,disableDesktopPadding:Q,style:fe.sectionMenuItem}),items:he.map(((e,t)=>{const n=e.key;if("trustedDomain"===n)return D?{key:"trusted_domain_item",action:async()=>{},render:e=>(0,W.jsx)(K().A,{store:s,trustedDomainPermission:D,permissionItemArgs:q,renderStyle:"permissionSelectOption",selectTrustedDomainHandler:be,menuListItemProps:e})}:void 0;if("publicShareLink"===n)return L?{key:"public_share_link",action:()=>{},render:e=>(0,W.jsx)(O,{store:s,publicPermission:L,permissionItemArgs:q,menuListItemProps:e,onClose:G})}:void 0;const o=function(e,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>3?arguments[3]:void 0;if(t)return!1;if(e===s)return!0;if(i&&("unlisted"===e&&"open"===s||"open"===e&&"unlisted"===s))return!0;return!1}(se,n,Z,ve),r=t!==U().Gm.length-1,a={...J?{minHeight:28}:{},...Q?fe.mobileButton:{},...Q&&r?fe.mobileButtonDivider:{},...J&&r&&!Q&&{marginBottom:2}},l=e.caption({isShareMenuRedesignEnabled:J});return{key:n,render:s=>(0,W.jsx)(u().A,{title:J?(0,W.jsx)(b().A,{isMultiline:!0,children:e.title({spaceName:ae,isShareMenuRedesignEnabled:!0,type:"full",visibility:ie,isSearchableToggleEnabled:Z})}):(0,W.jsx)(I().j,{tooltipStyle:{maxWidth:200},children:e.title({spaceName:ae,isShareMenuRedesignEnabled:!1,type:"full"})}),caption:Z?void 0:(0,W.jsx)(b().A,{isSmall:!0,isMultiline:!0,style:fe.caption,children:l}),icon:e.icon({style:fe.icon,spaceStore:ee,isShareMenuRedesignEnabled:J,teamspaceIconSize:20}),desktopIconStyle:fe.iconContainer,titleStyle:{...fe.titleStyle,...o&&!Q?fe.selectedTitle:{}},isChecked:o,buttonStyle:{borderRadius:6},style:a,shouldWrapTitle:J,...s}),action:async()=>{if(o)return;const e=i.permissionItem,t={type:"space_permission",role:V(e,ie,n)};"unlisted"===n&&(t.unlisted_timestamp=Date.now());const r=function(e,s){if(e===s)return!1;switch(s){case"open":case"open_unlisted_hybrid":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,m().HB)(s)}}(le,n)&&!N&&!re,a=await(0,y().Hc)({oldPermissionItem:e,newPermissionItem:t,wasInherited:oe,environment:$,store:s,sudoModeStore:R,location:B,restrictingVisibility:r,trustedDomainsLoggingData:{trustedDomainsPointers:null==me?void 0:me.state.trustedDomainPointers,hasTrustedDomainPermission:de,isTrustedDomainItemEnabled:ce}});a&&H&&H({before:e,after:t}),a&&D&&"private"===n&&de&&(0,A().p)({trustedDomainPermission:D,store:s,environment:$,sudoModeStore:R,location:B}),a&&"private"===n&&L&&ve&&function(e){const{environment:s,store:i,publicPermission:t,wasInherited:n,location:o,sudoModeStore:r}=e,a=t.permissionItem,l=(0,x().u)(a,"none");(0,y().Hc)({environment:s,store:i,oldPermissionItem:a,newPermissionItem:l,wasInherited:n,location:o,sudoModeStore:r})}({environment:$,store:s,publicPermission:L,wasInherited:oe,location:B,sudoModeStore:R}),G()}}})).filter(m().O9)}]})})}function V(e,s,i){return"private"===i?"none":"private"===s?"editor":e.role}},522105:(e,s,i)=>{i.d(s,{M:()=>b,n:()=>h});i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(870122),r=()=>i(653998),a=()=>i(762436),l=()=>i(822493),d=()=>i(610271),m=()=>i(689248),c=()=>i(266963),u=()=>i(907721),p=()=>i(836331),g=i(163643);const h="public_share_link_tooltip";function b(e){const{originRef:s,onPrimaryButtonClick:i}=e,b=(0,t().v3)(),f=(0,n().K8)((()=>c().default.isVisible(h)),[]);return(0,g.jsx)(a().B,{shouldShow:f,calloutId:h,children:(0,g.jsx)(l().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:s,placementToOrigin:"bottom",alignmentToOrigin:u().C.Start,numSteps:1,header:(0,g.jsxs)(d().wt,{gap:10,children:[(0,o().globeIcon)({height:20,width:20}),(0,g.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.header",defaultMessage:"Share your page with anyone"})]}),content:(0,g.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.content",defaultMessage:"You can now change your page settings to collaborate with anyone on the web with the link"}),finalButtonContent:(0,g.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.finalButtonContent",defaultMessage:"Try it out"}),onPrimaryButtonClick:()=>{m().a(b,h),p().default.logEvent("public_share_link_tutorial_try_it_out_clicked"),i()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{m().a(b,h),p().default.logEvent("public_share_link_tutorial_closed")}})})}},550171:(e,s,i)=>{i.d(s,{A:()=>w,i:()=>C});i(242343);var t=()=>i(237385),n=()=>i(803290),o=()=>i(174114),r=()=>i(712437),a=()=>i(486540),l=()=>i(218357),d=()=>i(653998),m=()=>i(76394),c=()=>i(31448),u=()=>i(539174),p=()=>i(209684),g=()=>i(931085),h=()=>i(709237),b=()=>i(103151),f=()=>i(35462),v=()=>i(29869),y=()=>i(378219),x=()=>i(914798),S=()=>i(28251),I=()=>i(320462),P=()=>i(907721),j=()=>i(413871),A=()=>i(628854),_=()=>i(422340),M=i(163643);function w(e){const{showRestoreButton:s,store:i,type:r,sudoModeStore:a}=e,l=(0,t().v3)(),{isMobile:d}=(0,t().Y0)(),m=(0,n().K8)((()=>y().fU(i)[1]),[i]),u=(0,n().K8)((()=>({paddingLeft:l.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:l.WindowSizeStore.getSafePaddingLeftCSS(14)})),[l]),p=(0,o().IS)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},label:{display:"inline",marginLeft:d?14:0,color:d?"#CF8807":e.text.secondary,fontWeight:d?c().Wy.regular:c().Wy.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[d,u]);return d?(0,M.jsxs)("div",{style:p.mobileContainer,children:[(0,M.jsx)(f().A,{isMultiline:!0,isSmall:!0,style:p.label,children:(0,M.jsx)(T,{type:r,navigableParentStore:m,showRestoreButton:s})}),s&&(0,M.jsx)(k,{store:i,type:r})]}):(0,M.jsx)("div",{style:p.container,children:(0,M.jsxs)("div",{style:p.banner,children:[(0,M.jsx)("div",{style:p.iconContainer,children:R[r](p.icon)}),(0,M.jsxs)("div",{children:[(0,M.jsx)(f().A,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:p.label,children:(0,M.jsx)(T,{type:r,navigableParentStore:m,showRestoreButton:s})}),s&&(0,M.jsx)("span",{style:p.buttonContainer,children:(0,M.jsx)(k,{store:i,type:r,sudoModeStore:a})})]})]})})}function k(e){const{type:s,store:i,sudoModeStore:r}=e,{isMobile:l}=(0,t().Y0)(),u=(0,n().K8)((()=>!!r&&r.shouldSaveTransactionWithSudoMode(i)),[i,r]),g=(0,o().IS)((e=>({button:{color:l?"#CF8807":e.text.primary,fontWeight:c().Wy.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),h=(0,t().v3)();if("restore-team"===s){const e=async()=>{await(0,S().u)({environment:h,useSudoMode:u,store:i})};return(0,M.jsx)(b().A,{style:g.tooltip,placement:P().W.Bottom,renderTooltip:()=>(0,M.jsx)(d().sA,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:s=>(0,M.jsx)("span",{...s,children:(0,M.jsx)(p().p,{isGray:!0,size:"xs",style:g.button,onClick:e,children:(0,M.jsx)(d().sA,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===s){const e=async()=>{if(!i.isDefined())return;const e=i.getPermissionItems(),s=y().fU(i)[1];if(!s)return;const t=(0,a().wD)(y().E(s)),n=(0,a().Cd)(i.getModel(),e,t);await(0,x().b)({environment:h,useSudoMode:u,store:i,permissionChanges:n,from:void 0,shareMenuSessionId:_().Ay.state.sessionId,isRedesignEnabled:!1,parentStore:s})};return(0,M.jsx)(p().p,{isGray:!0,size:"xs",style:g.button,onClick:e,children:(0,M.jsx)(d().sA,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,m().HB)(s)}function C(e){const{navigableParentStore:s,maxLength:i,showUnderline:a}=e,{isMobile:d}=(0,t().Y0)(),m=(0,t().v3)(),c=(0,o().IS)((e=>({linkBox:{color:e.text.secondary},title:{display:"inline"}})),[]),p=(0,n().K8)((()=>{if(s instanceof j().Bv)return(0,v().Ay)({store:s,fullyQualified:!1,pageVisitSource:r().y8.ShareMenu})}),[s]);if(!s)return null;const b=d&&s.table===l().yK;return(0,M.jsx)(g().A,{disabled:b,style:b?void 0:c.linkBox,underline:a&&!b,inline:!0,onClick:s.table===l().yK?()=>{s.table===l().yK&&A().F2({environment:m,teamId:s.id,tab:I().p.Members,from:"permission_item"}),u().ks(m,{store:s,option:"view",from:"share_menu"})}:void 0,href:p,children:(0,M.jsx)(h().A,{shouldWrap:!0,maxLength:i,store:s,style:c.title})})}function T(e){const{type:s,navigableParentStore:i,showRestoreButton:n}=e,{isMobile:o}=(0,t().Y0)(),r=(0,M.jsx)(C,{navigableParentStore:i,maxLength:o||!n?void 0:30,showUnderline:!0});switch(s){case"restore-team":return(0,M.jsx)(d().sA,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:r}});case"unrestrict":return o?(0,M.jsx)(d().sA,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:r}}):(0,M.jsx)(d().sA,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:r}});default:(0,m().HB)(s)}}const R={unrestrict:i(791976).T,"restore-team":i(670481).G}},560033:(e,s,i)=>{i.d(s,{A:()=>l});var t=i(242343),n=()=>i(803290),o=()=>i(895048),r=i(163643);function a(e){let{store:s}=e;const t=(0,i(237385).v3)(),a=t.device.isMobile,l=(0,n().K8)((()=>(0,i(268117).FI)()),[]),d=(0,n().K8)((()=>{var e,n;return s instanceof i(413871).SL?null===(e=(0,i(548694).c2)(t,s))||void 0===e?void 0:e.icon:null===(n=s.getIcon())||void 0===n?void 0:n.icon}),[t,s]),m=(0,i(174114).IS)((e=>({teamOrSpaceIcon:(0,i(636208).iM)({theme:e,size:a&&l?o().Bj:o().Ev,useLargeBorderRadius:l,useLightBackgroundColor:l,icon:d}),iconBoxStyles:l?{color:e.mediumIconColor}:{}})),[d,a,l]),{innerEmojiOrFlatIconSize:c,innerInitialSize:u}=function(e){let{isRedesignEnabled:s,baseSize:i}=e;return s?{innerEmojiOrFlatIconSize:.65*i,innerInitialSize:.75*i}:{innerEmojiOrFlatIconSize:.78*i,innerInitialSize:i}}({isRedesignEnabled:l,baseSize:a&&l?o().Bj:o().Ev});return(0,r.jsx)(i(424339).x,{disabled:!0,store:s,size:a&&l?o().Bj:o().Ev,iconContainerStyles:m.teamOrSpaceIcon,iconBoxStyles:m.iconBoxStyles,innerEmojiOrFlatIconSize:c,innerInitialSize:u})}const l=t.memo(a)},582295:(e,s,i)=>{i.d(s,{a:()=>r});i(242343);var t=()=>i(174114),n=()=>i(31448),o=i(163643);function r(e){let{title:s,subtitle:i,style:r}=e;const a=(0,t().IS)((e=>({base:{width:"100%"},title:{fontWeight:n().Wy.medium,color:e.text.primary,fontSize:14},subtitle:{fontWeight:n().Wy.regular,color:e.text.secondary,fontSize:12}})),[]);return(0,o.jsxs)("div",{style:{...a.base,...r},children:[(0,o.jsx)("div",{style:a.title,children:s}),i&&(0,o.jsx)("div",{style:a.subtitle,children:i})]})}},642546:(e,s,i)=>{i.d(s,{p:()=>r,T:()=>a});var t=()=>i(171521),n=()=>i(432809);var o=()=>i(880026);async function r(e){let{trustedDomainPermission:s,store:i,environment:t,sudoModeStore:r,location:a}=e;const l=i.isRestricted(),d=(0,n().$d)({permissionItem:s,store:i})&&!l,m=d&&"none"!==s.permissionItem.role&&!l;return await(0,o().o5)({oldPermissionItem:s.permissionItem,newRole:"none",wasInherited:d,environment:t,store:i,sudoModeStore:r,location:a,restrictingVisibility:m})}async function a(e){let{trustedDomainPermission:s,store:i,environment:n,sudoModeStore:r,location:a,fromPermissionWrapper:l}=e;const d="reader",m=(0,t().ek)({permissionItem:s,store:i}),c=s.permissionItem.role===d?"none":d;return await(0,o().o5)({oldPermissionItem:s.permissionItem,newRole:c,wasInherited:m,environment:n,store:i,sudoModeStore:r,location:a,fromPermissionWrapper:l})}},688174:(e,s,i)=>{i.d(s,{A:()=>b});var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=i(163643);const a=(0,i(680369).wt)("peopleSquare",{viewBox:"0 0 14 18",svg:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M3.151 17.172c-.738 0-1.296-.19-1.674-.567-.379-.374-.568-.926-.568-1.655V7.212c0-.734.19-1.288.568-1.661.378-.374.936-.56 1.674-.56h7.698c.733 0 1.29.186 1.668.56.382.373.574.927.574 1.66v7.74c0 .724-.182 1.275-.547 1.654-.365.378-.873.567-1.524.567H3.15zm.082-1.347h7.698a.756.756 0 00.58-.253c.156-.164.233-.412.233-.745V7.321c0-.328-.086-.574-.26-.738-.168-.169-.41-.253-.724-.253H3.233c-.319 0-.562.084-.731.253-.164.164-.246.41-.246.738v7.506c0 .333.082.581.246.745.169.169.412.253.731.253zM2.42 3.91c.045-.328.157-.58.335-.759.182-.177.456-.266.82-.266h6.795c.365 0 .636.089.814.266.182.178.298.431.348.76H2.42zm1.176-1.99c.018-.309.118-.544.3-.703.183-.16.438-.24.766-.24h4.621c.333 0 .588.08.766.24.182.16.285.394.307.704h-6.76zm2.85 14.103a.392.392 0 01-.328-.177c-.086-.114-.13-.283-.13-.506 0-.274.073-.554.219-.841.146-.287.356-.554.629-.8.278-.246.61-.444.998-.595a3.561 3.561 0 011.32-.232c.615 0 1.15.119 1.606.355.456.237.813.531 1.073.882.26.356.408.711.444 1.067a.98.98 0 01-.088.41.668.668 0 01-.301.314c-.142.082-.338.123-.588.123H6.446zm2.707-3.937c-.273 0-.524-.073-.752-.219a1.735 1.735 0 01-.553-.595 1.727 1.727 0 01-.205-.84c0-.306.068-.581.205-.828.136-.246.319-.44.547-.58a1.4 1.4 0 01.758-.22c.27 0 .518.071.745.213.228.14.41.335.547.58.142.242.212.518.212.828 0 .31-.068.59-.205.84a1.655 1.655 0 01-.547.602 1.367 1.367 0 01-.752.219zm-4.327.772c.274 0 .527.03.759.09.232.054.44.136.622.245a3.209 3.209 0 00-.759.985 2.647 2.647 0 00-.266 1.148c0 .255.047.488.143.697H2.898c-.319 0-.544-.086-.676-.26a1.054 1.054 0 01-.192-.642c.01-.355.132-.706.37-1.053.236-.346.562-.633.977-.861.42-.232.902-.349 1.45-.349zm0-.683c-.355 0-.663-.14-.923-.417a1.47 1.47 0 01-.39-1.032 1.353 1.353 0 01.39-1.005c.265-.274.572-.41.923-.41.356 0 .663.136.923.41.26.269.39.601.39.998 0 .41-.13.756-.39 1.039-.26.278-.567.417-.923.417z"})})});var l=()=>i(653998),d=()=>i(35462),m=()=>i(502852),c=()=>i(772074),u=()=>i(436599);function p(e){let{store:s,trustedDomainPermission:d,fromPermissionWrapper:p,permissionItemArgs:b,renderStyle:f,menuListItemProps:v,selectTrustedDomainHandler:y}=e;const x=(0,n().v3)(),S=x.device.isMobile,{isPhone:I}=(0,n().Y0)(),P=(0,i(263370).X)(),j=(0,o().K8)((()=>(0,i(268117).FI)()),[]),A=(0,o().O$)(i(485966).AppStoreCurrentSpaceStore),_=(0,i(423411).H)(),{workspaceTrustedDomain:M,numberOfTrustedDomains:w}=(0,o().K8)((()=>{if(_){var e;const s=(null===(e=_.getForSpace(A))||void 0===e?void 0:e.enabledTrustedEmailDomains)??[];return{workspaceTrustedDomain:s.length>0?s[0]:"",numberOfTrustedDomains:s.length}}return{workspaceTrustedDomain:"",numberOfTrustedDomains:0}}),[A,_]),k=(0,t.useCallback)((async e=>{await(0,m().s7)({event:e,context:m().y$.ToggleTrustedDomainPermission,callback:async()=>{await(0,i(642546).T)({trustedDomainPermission:d,store:s,environment:x,sudoModeStore:b.sudoModeStore,location:b.location,fromPermissionWrapper:p})}})}),[d,s,x,b,p]),C=(0,i(174114).IS)((e=>({container:I?{background:e.popoverBackground}:{},icon:{width:24,height:24,...!j&&{fill:e.mediumIconColor}},iconContainer:j?{}:{backgroundColor:e.lightDividerColor,borderRadius:32},menuItemContainer:{...!I&&{paddingTop:c().Lh,paddingBottom:c().Lh}},menuIcon:{height:16,width:16,fill:e.icon.secondary},menuIconContainer:{marginLeft:S?13:j?6:9,...j?{marginRight:6}:{alignSelf:"center"}},menuItemText:{lineHeight:"unset",...I&&{paddingTop:c().T3,paddingBottom:c().T3},color:e.text.primary}})),[S,I,j]),T=(0,r.jsx)(g,{workspaceTrustedDomain:M,numberOfTrustedDomains:w,renderStyle:f,spaceName:P}),R=(0,r.jsx)(h,{workspaceTrustedDomain:M,numberOfTrustedDomains:w});return"permissionSelectOption"===f?(0,r.jsx)("div",{style:C.container,children:(0,r.jsx)(i(535906).A,{...v,title:T,caption:R,buttonStyle:C.menuItemContainer,shouldWrapTitle:!0,shouldWrapCaption:!0,style:C.menuItemText,icon:a({...C.menuIcon}),desktopIconStyle:C.menuIconContainer,onClick:async e=>{await(async e=>{"permissionSelectOption"===f&&await k(e)})(e)},badge:(0,r.jsx)(i(862185).A,{})})}):(0,r.jsx)(i(895048).Ay,{upgradeButtonName:"trusted_domain_item",store:s,permissionItem:d.permissionItem,from:d.from,icon:j?(0,r.jsx)(u().A,{type:"square",iconType:"function",iconFn:a,iconStyle:C.icon,isMobile:S}):a(C.icon),iconStyle:C.iconContainer,title:T,selectHeader:j&&S?(0,r.jsx)(i(932322).Ay,{title:T,icon:(0,r.jsx)(u().A,{type:"square",iconType:"function",iconFn:i(51082).P,iconStyle:C.icon,isMobile:S}),desktopIconStyle:{marginLeft:16}}):void 0,nonInheritedTooltip:void 0,subtitle:S&&j?(0,r.jsx)(l().sA,{...(0,i(758103).R)({type:"trusted_domain_permission",role:d.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1,isRedesignEnabled:j}).label}):void 0,fromPermissionWrapper:p,isRemovableOverride:!0,...b})}function g(e){let{workspaceTrustedDomain:s,numberOfTrustedDomains:i,renderStyle:t,spaceName:n}=e;return"permissionItem"===t?s&&1===i?(0,r.jsx)(l().sA,{id:"trustedDomainItem.titleWithSpecificDomain.label",defaultMessage:"People with a {workspaceTrustedDomain} email address",values:{workspaceTrustedDomain:s}}):(0,r.jsx)(l().sA,{id:"trustedDomainItem.titleWhenNoSpecificDomain",defaultMessage:"People with a trusted email address",values:{workspaceTrustedDomain:s}}):s&&1===i?(0,r.jsx)(l().sA,{id:"trustedDomainItem.titleWithSpecificDomain.mobileLabel",defaultMessage:"Everyone with a {workspaceTrustedDomain} email address",values:{spaceName:n,workspaceTrustedDomain:s}}):(0,r.jsx)(l().sA,{id:"trustedDomainItem.titleWithSpecificDomain",defaultMessage:"Everyone with a trusted email address",values:{spaceName:n}})}function h(e){let{workspaceTrustedDomain:s,numberOfTrustedDomains:i}=e;return s&&1===i?(0,r.jsx)(d().A,{isSmall:!0,isMultiline:!0,style:{whiteSpace:"normal"},children:(0,r.jsx)(l().sA,{id:"trustedDomainItem.captionWithSpecificDomain.label",defaultMessage:"Workspace members and people with a {workspaceTrustedDomain} email address can access",values:{workspaceTrustedDomain:s}})}):(0,r.jsx)(d().A,{isSmall:!0,isMultiline:!0,style:{whiteSpace:"normal"},children:(0,r.jsx)(l().sA,{id:"trustedDomainItem.captionWhenNoSpecificDomain",defaultMessage:"Workspace members and People with a trusted email address can access",values:{workspaceTrustedDomain:s}})})}const b=t.memo(p)},688322:(e,s,i)=>{i.d(s,{d:()=>n});i(242343);var t=i(163643);const n=(0,i(680369).wt)("expandThin",{viewBox:"0 0 16 16",svg:(0,t.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})})},755564:(e,s,i)=>{i.d(s,{N:()=>n});i(242343);const t={viewBox:"0 0 20 20",svg:(0,i(163643).jsx)("path",{d:"M6.337 3.05a.625.625 0 0 0-.003.885L8.828 6.44a.625.625 0 1 0 .886-.882L8.287 4.125H10A5.875 5.875 0 1 1 4.125 10a.625.625 0 1 0-1.25 0A7.125 7.125 0 1 0 10 2.875H8.285l1.44-1.432a.625.625 0 0 0-.882-.886z"})},n=(0,i(680369).wt)("arrowCircleSpinCounterClockwise",t)},769094:(e,s,i)=>{i.d(s,{A:()=>r});var t=i(242343),n=i(163643);function o(e){let{onClick:s,hovered:o,expanded:r,children:a}=e;const l=(0,i(237385).Y0)().isMobile,[d,m]=t.useState(!1),c=(0,t.useCallback)((()=>m(!0)),[]),u=(0,t.useCallback)((()=>m(!1)),[]),p=(0,i(174114).IS)((e=>{const s=(0,i(636208).iM)({theme:e,size:26,useLargeBorderRadius:!0,useLightBackgroundColor:!0}),t={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",top:"auto",left:"auto",opacity:o?1:0,transition:"opacity 150ms ease, background 150ms ease",...s,width:24,height:24,borderRadius:4};return{container:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},chevronButton:{...t,background:"unset"},chevronContainerHovered:{...t,background:s.background},childrenContainer:{opacity:o?0:1,transition:"opacity 200ms"},chevronIconInnerContainer:{background:"unset",height:24,width:24,borderRadius:4},chevronIcon:{transform:`rotate(${r?90:0}deg)`,transition:"transform 150ms ease",width:16,height:16}}}),[r,o]);return l?(0,n.jsx)(n.Fragment,{children:a}):(0,n.jsxs)("div",{style:p.container,onMouseEnter:c,onMouseLeave:u,children:[(0,n.jsx)(i(126451).A,{disabled:!1,style:d?p.chevronContainerHovered:p.chevronButton,onClick:s,children:(0,n.jsx)(i(436599).A,{type:"square",iconType:"function",iconFn:i(855470).V,containerStyle:p.chevronIconInnerContainer,iconStyle:p.chevronIcon,isMobile:l})}),(0,n.jsx)("div",{style:p.childrenContainer,children:a})]})}const r=t.memo(o)},804345:(e,s,i)=>{function t(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"none"===e.role?"private":s?"open_unlisted_hybrid":e.unlisted_timestamp?"unlisted":"open"}i.d(s,{W:()=>t})},849340:(e,s,i)=>{i.d(s,{z:()=>b});i(725707),i(500234),i(242343);var t=()=>i(803290),n=()=>i(174114),o=()=>i(218357),r=()=>i(653998),a=()=>i(76394),l=()=>i(31448),d=()=>i(709237),m=()=>i(378219),c=()=>i(736953),u=()=>i(413871),p=()=>i(424339),g=()=>i(949961),h=i(163643);function b(e){let{permissionItem:s,targetType:i,targetName:b,store:f}=e;const v=(0,n().IS)((()=>({groupOrTeamName:{fontWeight:l().Wy.bold}})),[]),y=(0,t().K8)((()=>{var e;if("group_permission"!==s.type)return;const i=null===(e=c().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===s.group_id)))||void 0===e?void 0:e.group.name;return i?(0,h.jsx)("span",{style:v.groupOrTeamName,children:i}):void 0}),[s,v.groupOrTeamName]),x=(0,t().K8)((()=>{var e;if("team_permission"!==s.type&&"explicit_team_permission"!==s.type&&"team_owner_permission"!==s.type&&"explicit_team_owner_permission"!==s.type&&"explicit_team_guest_permission"!==s.type)return;const i="team_permission"===s.type||"team_owner_permission"===s.type?null===(e=(0,m().Uo)(f))||void 0===e?void 0:e.id:s.team_id;if(!i)return;const t=u().h4.createChildStore(f,{table:o().yK,id:i,spaceId:f.getSpaceId()});return(0,h.jsxs)("span",{style:{...v.groupOrTeamName,display:"inline-flex",gap:4},children:[(0,h.jsx)(p().x,{store:t,size:14,style:{margin:1}}),(0,h.jsx)(d().A,{store:t,shouldWrap:!0})]})}),[s,f,v.groupOrTeamName]);if("none"===s.role)return;const S=(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.withoutUserName",defaultMessage:"Access is from the {permissionItemName}",values:{permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}});if("group"===i&&"group_permission"===s.type)return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithGroupName",defaultMessage:"The {targetGroupName} group has access to this page",values:{targetGroupName:b}}):(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithoutGroupName",defaultMessage:"This group has access to this page"});if("user"===i&&("user_permission"===s.type||"exclusive_user_permission"===s.type))return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:b}}):void 0;switch(s.type){case"space_permission":return b&&"user"===i?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithUserName",defaultMessage:"{targetUserName} has access from the {permissionItemName} setting on this page",values:{targetUserName:b,permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}}):b&&"group"===i?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithGroupName",defaultMessage:"The {targetGroupName} group has access from the {permissionItemName} setting on this page",values:{targetGroupName:b,permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}}):S;case"space_owner_permission":return S;case"team_permission":case"explicit_team_permission":return"user"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.member.teamWithUserName",defaultMessage:"{targetUserName} has access as a member of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):"group"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:b,teamspaceName:x}}):S;case"team_owner_permission":case"explicit_team_owner_permission":return"user"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.owner.teamWithUserName",defaultMessage:"{targetUserName} has access as an owner of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):"group"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:b,teamspaceName:x}}):S;case"explicit_team_guest_permission":return b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.guest.teamWithUserName",defaultMessage:"{targetUserName} has access as a guest of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):S;case"group_permission":return b&&y?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithUserName",defaultMessage:"{targetUserName} has access as a member of the {groupName} group",values:{targetUserName:b,groupName:y}}):S;case"user_permission":case"exclusive_user_permission":return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:b}}):void 0;case"bot_permission":case"deleted_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"collection_property_permission":return;default:return void(0,a().ub)(s)}}},867739:(e,s,i)=>{i.d(s,{A:()=>R});i(362833),i(403517);var t=i(242343),n=()=>i(16791),o=()=>i(237385),r=()=>i(803290),a=()=>i(174114),l=()=>i(846581),d=()=>i(446588),m=()=>i(653998),c=()=>i(141666),u=()=>i(535906),p=()=>i(273520),g=()=>i(935091),h=()=>i(858023),b=()=>i(397791),f=()=>i(88271),v=()=>i(35462),y=()=>i(297340),x=()=>i(350208),S=()=>i(782422),I=()=>i(640979),P=()=>i(755769),j=()=>i(943066),A=()=>i(404042),_=()=>i(111826),M=i(163643);function w(e,s){const{permissionItem:t,hideIcon:n,onChange:r,buttonStyle:a}=e,l=(0,o().Y0)();return(0,M.jsx)(i(511952).A,{...e,popupType:l.isMobile?p().z7.SlideUp:p().z7.Popup,renderOrigin:o=>(0,M.jsx)(i(48150).a,{...(0,i(906230).A)(e,o),ref:s,title:(0,M.jsx)(m().sA,{defaultMessage:"Link expires",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!n&&(0,M.jsx)(b().I,{icon:i(934889).clockIcon,color:"secondary"}),right:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(k,{permissionItem:t}),(0,M.jsx)(b().I,{icon:i(663821).arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]}),buttonStyle:a}),alignmentToOrigin:P().MY.End,placementToOrigin:P().UV.Bottom,render:e=>(0,M.jsx)(C,{value:t.expiration_timestamp,onChange:r,onClose:()=>{e.close()}})})}function k(e){const{permissionItem:s}=e,i=(0,m().tz)(),t=(0,a().IS)((e=>({container:{color:e.text.secondary}})),[]);if(!s.expiration_timestamp||(0,d().OA)(s))return(0,M.jsx)(v().A,{style:t.container,children:(0,M.jsx)(m().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})});const o=l().jE(s.expiration_timestamp,n().locale,i);return(0,M.jsx)(v().A,{style:t.container,children:o})}function C(e){const{value:s,onChange:i,onClose:l}=e,d=(0,o().v3)(),p=d.device,b=(0,r().K8)((()=>!_().qC()),[]),v=(0,r().K8)((()=>_().Si(d)),[d]),y=(0,t.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(i(e),l())}),[i,l]),x=(0,a().IS)((e=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:e.text.tertiary}})),[]),S=function(){const e=Date.now(),s=e+c().pT,i=e+c().nD,t=e+7*c().nD;return[{key:"none",time:void 0,title:(0,M.jsx)(m().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:s,title:(0,M.jsx)(m().sA,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(n().locale,{hour:"numeric",minute:"numeric"}).format(s)},{key:"day",time:i,title:(0,M.jsx)(m().sA,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(n().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)},{key:"week",time:t,title:(0,M.jsx)(m().sA,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(n().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}().map((e=>({key:e.key,action:()=>{y(e.time)},render:s=>(0,M.jsx)(u().A,{...s,title:e.title,titleStyle:b?x.disabledText:{},caption:e.caption,captionStyle:b?x.disabledText:{},disabled:b})}))),P=[{key:"predefined-expiration",render:e=>(0,M.jsx)(f().A,{...e}),items:S},{key:"custom-expiration",render:e=>(0,M.jsx)(f().A,{...e,topBorder:!0}),items:[T(y,s,b,x.disabledText)]}];return v&&b&&P.push({key:"upgrade-for-expiration",render:e=>(0,M.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>{j().K(d,{from:"public_permission_item_expiration",upsell:{type:"product",product:v,limit:{type:"none"},trialability:"none"}})},render:e=>(0,M.jsx)(u().A,{...e,focused:e.focused,title:(0,M.jsxs)("div",{style:x.disabledContainer,children:[(0,M.jsx)(m().sA,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,M.jsx)(A().A,{subscriptionTier:v,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,M.jsx)(g().A,{menuType:p.isMobile?I().gu.ActionSheet:I().gu.Popup,width:271,children:(0,M.jsx)(h().Ay,{type:h().Oh.Vertical,initialFocus:void 0,sections:P})})}function T(e,s,i){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{key:"custom",action:()=>{window.parent.close()},render:(n,o)=>(0,M.jsx)(x().A,{...n,renderOrigin:e=>(0,M.jsx)(u().A,{...e,disabled:i,title:(0,M.jsx)(m().sA,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:i?t:{}}),onFocus:o.onFocus,disableDefaultClick:!0,renderExtension:(t,n)=>(0,M.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,M.jsx)(y().A,{...t,firstDayOfWeek:S().XX.state,value:s||Date.now(),onChange:s=>{e(s),n.close()},disabledDays:i||{before:new Date}})})})}}const R=t.forwardRef(w)},874039:(e,s,i)=>{i.d(s,{Ay:()=>T,n:()=>M});i(725707),i(491955);var t=i(242343),n=()=>i(803290),o=()=>i(174114),r=()=>i(486540),a=()=>i(446588),l=()=>i(145017),d=()=>i(409211),m=()=>i(653998),c=()=>i(76394),u=()=>i(884373),p=()=>i(35462),g=()=>i(477784),h=()=>i(863969),b=()=>i(413871),f=()=>i(328207),v=()=>i(10456),y=()=>i(949961),x=()=>i(849340),S=i(163643);function I(e){let{blockStore:s,permissionItem:i,inviteTarget:t,mostPermissivePermissions:n,spaceVisibleUserMap:o,permissionItemArgs:r,...a}=e;return"group"===t.type?(0,S.jsx)(j,{inviteTarget:t,blockStore:s,permissionItem:i,mostPermissivePermissions:n,permissionItemArgs:r,menuListItemProps:a}):"existingUser"===t.type?(0,S.jsx)(P,{inviteTarget:t,blockStore:s,permissionItem:i,mostPermissivePermissions:n,permissionItemArgs:r,spaceVisibleUserMap:o,menuListItemProps:a}):((0,c().ub)(t),null)}function P(e){let{inviteTarget:s,blockStore:i,permissionItem:t,mostPermissivePermissions:o,spaceVisibleUserMap:r,permissionItemArgs:a,menuListItemProps:c}=e;const u=(0,m().tz)(),p=(0,n().K8)((()=>b().LU.createChildStore(i,{table:d().oo,id:s.value.id}).getDisplayName(u)||void 0),[i,u,s]),g=(0,x().z)({permissionItem:t,targetType:"user",targetName:p,store:i}),h="user_permission"===(null==o?void 0:o[0].permissionItem.type)?o[0]:{from:{table:l().ev,blockId:i.id},permissionItem:{role:t.role,type:"user_permission",user_id:s.value.id}};return(0,S.jsx)(v().A,{store:i,userPermission:h,showInherited:!1,selectFooter:(0,S.jsx)(M,{targetName:p,targetType:"user",mostPermissivePermissions:o}),spaceVisibleUserMap:r,permissionItemArgs:a,tooltip:g,menuListItemProps:c})}function j(e){let{inviteTarget:s,blockStore:i,permissionItem:t,mostPermissivePermissions:o,permissionItemArgs:d,menuListItemProps:m}=e;const u=(0,h().O)(),p=s.value.name,g=(0,x().z)({permissionItem:t,targetType:"group",targetName:p,store:i}),b=(0,n().K8)((()=>function(e){var s;let{targetType:i,targetName:t,mostPermissivePermissions:n}=e;const o=null==n||null===(s=n.filter("user"===i?w:k))||void 0===s?void 0:s[0];if(!o)return[];const l=(0,a().PW)(o.permissionItem.role)?o.permissionItem.role:"none";if("none"===l)return[];return A.map((e=>{if((0,r().sO)(e,l))return;return{role:e,disabledInfo:{isDisabled:!0,disabledMessage:(0,S.jsx)(C,{targetType:i,permissionItem:o.permissionItem,targetName:t})}}})).filter(c().O9)}({targetType:"group",targetName:p,mostPermissivePermissions:o})),[o,p]),v="group_permission"===(null==o?void 0:o[0].permissionItem.type)?o[0]:{from:{table:l().ev,blockId:i.id},permissionItem:{role:t.role,type:"group_permission",group_id:s.value.group_id}};return u?(0,S.jsx)(f().A,{store:i,groupPermission:v,spaceId:u,showInherited:!1,isRemovableOverride:!0,permissionItemArgs:d,tooltip:g,roleItemOverrides:b,menuListItemProps:m}):null}const A=["none","reader","comment_only","content_only_editor","read_and_write","membership_admin","editor"],_={none:g().A.formatMessage(r().Sf.noAccessDescription),reader:g().A.formatMessage(r().Sf.canReadDescription),comment_only:g().A.formatMessage(r().Sf.canCommentDescription),content_only_editor:g().A.formatMessage(r().Sf.canEditContentDescription),read_and_write:g().A.formatMessage(r().Sf.canEditDescription),membership_admin:g().A.formatMessage(r().Sf.membershipAdminDescription),editor:g().A.formatMessage(r().Sf.fullAccessDescription)};function M(e){var s;let{targetType:i,targetName:t,mostPermissivePermissions:n}=e;const l=(0,o().IS)((e=>({divider:{color:`${e.regularDividerColor}`},label:{marginLeft:12,marginRight:12,paddingTop:8,paddingBottom:8}})),[]),d=null==n||null===(s=n.filter("user"===i?w:k))||void 0===s?void 0:s[0];if(!d)return null;const c=(0,a().PW)(d.permissionItem.role)?d.permissionItem:void 0;if(!c||!c.role||"string"!=typeof c.role||"none"===c.role)return null;const h=_[c.role]||g().A.formatMessage(r().Sf.defaultAccessLabel);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u().A,{dividerColor:l.divider.color,size:1}),(0,S.jsx)(p().A,{style:l.label,isSmall:!0,isMultiline:!0,children:(0,S.jsx)(m().sA,{id:"permissionsItem.generalAccess",defaultMessage:"{userName} will still have {accessLevel} from the {permissionItemName}",values:{permissionItemName:(0,S.jsx)(y()._,{permissionItem:c}),userName:t,accessLevel:h}})})]})}function w(e){switch(e.permissionItem.type){case"space_permission":case"space_owner_permission":case"team_permission":case"team_owner_permission":case"explicit_team_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"group_permission":return!0;case"bot_permission":case"deleted_permission":case"exclusive_user_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"user_permission":case"collection_property_permission":return!1;default:return(0,c().ub)(e.permissionItem),!1}}function k(e){switch(e.permissionItem.type){case"space_permission":case"space_owner_permission":case"team_permission":case"team_owner_permission":case"explicit_team_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":return!0;case"group_permission":case"bot_permission":case"deleted_permission":case"exclusive_user_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"user_permission":case"collection_property_permission":return!1;default:return(0,c().ub)(e.permissionItem),!1}}function C(e){let{permissionItem:s,targetType:i,targetName:t}=e;return t&&"user"===i?(0,S.jsx)(m().sA,{id:"searchTargetPermissionItem.disabledMessage",defaultMessage:"To restrict {targetUserName}s access, modify the {permissionItemName} setting on this page",values:{targetUserName:t,permissionItemName:(0,S.jsx)(y()._,{permissionItem:s})}}):t&&"group"===i?(0,S.jsx)(m().sA,{id:"searchTargetPermissionItem.disabledMessageForGroup",defaultMessage:"To restrict the {targetGroupName} groups access, modify the {permissionItemName} setting on this page",values:{targetGroupName:t,permissionItemName:(0,S.jsx)(y()._,{permissionItem:s})}}):(0,S.jsx)(m().sA,{id:"searchTargetPermissionItem.disabledMessageWithoutName",defaultMessage:"To restrict access, modify the {permissionItemName} setting on this page",values:{permissionItemName:(0,S.jsx)(y()._,{permissionItem:s})}})}const T=t.memo(I)},914798:(e,s,i)=>{i.d(s,{b:()=>g});i(242343);var t=()=>i(535225),n=()=>i(680369),o=()=>i(653998),r=()=>i(31448),a=()=>i(145046),l=()=>i(919536),d=()=>i(84543),m=()=>i(129663),c=()=>i(35462),u=()=>i(990616),p=i(163643);async function g(e){const{environment:s,useSudoMode:i,store:g,permissionChanges:h,from:b,shareMenuSessionId:f,isRedesignEnabled:v,parentStore:y}=e,x={type:"restore",permissionChanges:h},S=x.permissionChanges.length>0;(v?!S||(await a().Gh({message:(0,u().r6)(x,v),description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c().A,{isSmall:!0,isMultiline:!0,children:(0,p.jsx)(o().sA,{id:"restrictedPermissionConfirmationModal.relink.caption",defaultMessage:"The following settings will be restored to match {parentName}",values:{parentName:(0,p.jsx)(m().A,{store:y,style:{fontWeight:r().Wy.regular},useInvertedColors:!1,maxLength:45})}})}),(0,p.jsx)(u().f2,{openState:x})]}),acceptColor:"blue",acceptLabel:(0,u().QU)(x,v),icon:(0,t().G)({height:n().Ev.xl,width:n().Ev.xl})})).accept:(await a().Gh({message:(0,u().r6)(x),acceptLabel:(0,u().QU)(x),cancelLabel:(0,p.jsx)(o().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,p.jsx)(u().f2,{openState:x})})).accept)&&(g.getPermissionItemsStore().canAdmin()?d().createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:s,canUndo:!0,useSudoMode:i,perform:e=>{l().P8({environment:s,store:g,transaction:e,from:b,shareMenuSessionId:f})}}):l().YD({environment:s,store:g,from:b,shareMenuSessionId:f}))}},939654:(e,s,i)=>{i.d(s,{w:()=>o});i(242343);var t=i(163643);const n={viewBox:"0 0 20 20",svg:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("path",{d:"M4.075 3.3A2.125 2.125 0 0 0 1.95 5.425V16.75c0 .345.28.625.625.625h2.6V13.6a.55.55 0 0 1 .55-.55h3.6a.55.55 0 0 1 .55.55v3.775H13.1V5.425A2.125 2.125 0 0 0 10.975 3.3zm1.875 4a.675.675 0 1 1 0-1.35.675.675 0 0 1 0 1.35m.675 1.575a.675.675 0 1 1-1.35 0 .675.675 0 0 1 1.35 0M5.95 11.8a.675.675 0 1 1 0-1.35.675.675 0 0 1 0 1.35m3.825-5.175a.675.675 0 1 1-1.35 0 .675.675 0 0 1 1.35 0M9.1 9.55a.675.675 0 1 1 0-1.35.675.675 0 0 1 0 1.35m.675 1.575a.675.675 0 1 1-1.35 0 .675.675 0 0 1 1.35 0"}),(0,t.jsx)("path",{d:"M8.775 17.375h-2.5V14.15h2.5zm5.425 0v-8.45h1.725c1.174 0 2.125.951 2.125 2.125v5.7c0 .345-.28.625-.625.625zm1.82-4.675a.675.675 0 1 0 0-1.35.675.675 0 0 0 0 1.35m.675 1.575a.675.675 0 1 0-1.35 0 .675.675 0 0 0 1.35 0"})]})},o=(0,i(680369).wt)("teamspaceFill",n)},949961:(e,s,i)=>{i.d(s,{_:()=>g});i(725707),i(500234);var t=i(242343),n=()=>i(237385),o=()=>i(803290),r=()=>i(218357),a=()=>i(653998),l=()=>i(76394),d=()=>i(379356),m=()=>i(485966),c=()=>i(736953),u=()=>i(413871),p=i(163643);function g(e){let{permissionItem:s}=e;const i=(0,n().v3)(),{organizationOwnerRecordCache:g}=(0,t.useContext)(d().N),h=(0,o().O$)(m().AppStoreCurrentSpaceStore),b=(0,o().K8)((()=>null==h?void 0:h.getName()),[h]),f=(0,o().K8)((()=>{var e;if("group_permission"!==s.type)return;const i=s.group_id;return null===(e=c().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===i)))||void 0===e?void 0:e.group.name}),[s]),v=(0,o().K8)((()=>{if("explicit_team_permission"!==s.type&&"explicit_team_owner_permission"!==s.type)return;const e=s.team_id;return new(u().h4)(i,{id:e,table:r().yK},{inMemoryRecordCache:g}).getName()}),[s,i,g]);switch(s.type){case"space_permission":return h?(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.spacePermission",defaultMessage:"{name} workspace",values:{name:b}}):null;case"space_owner_permission":case"user_permission":case"bot_permission":case"exclusive_user_permission":case"public_permission":case"deleted_permission":case"restricted_permission":case"trusted_domain_permission":case"collection_property_permission":return null;case"explicit_team_permission":case"team_permission":return(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.teamPermission",defaultMessage:"{name} teamspace",values:{name:v}});case"team_owner_permission":case"explicit_team_owner_permission":return(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.teamOwnersPermission",defaultMessage:"{name} teamspace",values:{name:v}});case"explicit_team_guest_permission":return(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.teamGuestsPermission",defaultMessage:"Team guests"});case"group_permission":return f?(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.groupPermission",defaultMessage:"{groupName} group",values:{groupName:f}}):(0,p.jsx)(a().sA,{id:"searchTargetPermissionItem.groupPermissionWithoutName",defaultMessage:"Group"});default:return(0,l().ub)(s),null}}},954889:(e,s,i)=>{i.d(s,{A:()=>o});i(242343);var t=()=>i(653998),n=i(163643);const o=function(e){const{store:s}=e,o=(0,i(174114).IS)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),r={table:i(145017).ev,blockId:s.id};return(0,n.jsx)(i(895048).Ay,{icon:(0,i(503880).D)(o.icon),iconStyle:o.iconContainer,title:(0,n.jsx)(t().sA,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,n.jsx)(t().sA,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,n.jsx)(n.Fragment,{}),store:s,permissionItem:{type:"display_only_hidden_permission"},from:r,upgradeButtonName:"team_permission_item"})}}}]);