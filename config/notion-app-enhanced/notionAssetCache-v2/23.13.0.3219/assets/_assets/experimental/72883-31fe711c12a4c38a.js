"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[72883],{23735:(e,t,o)=>{o.d(t,{o:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("arrowRightRounded",{viewBox:"0 0 16 13",svg:(0,n.jsx)("path",{d:"M15.3828 6.85156C15.3828 7.09635 15.2917 7.3099 15.1094 7.49219L9.95312 12.6328C9.77083 12.8099 9.5651 12.8984 9.33594 12.8984C9.09635 12.8984 8.89583 12.8203 8.73438 12.6641C8.57812 12.5078 8.5 12.3125 8.5 12.0781C8.5 11.9583 8.52083 11.8464 8.5625 11.7422C8.60938 11.638 8.67188 11.5469 8.75 11.4688L10.5 9.70312L13.4141 7.04688L13.6875 7.54688L10.9766 7.70312H1.48438C1.22396 7.70312 1.01302 7.625 0.851562 7.46875C0.695312 7.30729 0.617188 7.10156 0.617188 6.85156C0.617188 6.59635 0.695312 6.39062 0.851562 6.23438C1.01302 6.07292 1.22396 5.99219 1.48438 5.99219H10.9766L13.6875 6.15625L13.4141 6.66406L10.5 4L8.75 2.22656C8.67188 2.14844 8.60938 2.0599 8.5625 1.96094C8.52083 1.85677 8.5 1.74219 8.5 1.61719C8.5 1.38281 8.57812 1.1875 8.73438 1.03125C8.89583 0.875 9.09635 0.796875 9.33594 0.796875C9.45052 0.796875 9.5599 0.820312 9.66406 0.867188C9.76823 0.914062 9.86719 0.984375 9.96094 1.07812L15.1094 6.21094C15.2917 6.39323 15.3828 6.60677 15.3828 6.85156Z"})})},227083:(e,t,o)=>{o.d(t,{Jz:()=>l,in:()=>s,yh:()=>a});o(725707),o(491955),o(403517);var n=()=>o(803290),r=()=>o(543396),i=()=>o(76394);const a=(0,o(653998).YK)({unsupportedPublicQuestionType:{defaultMessage:"This question type cannot be used in public forms.",id:"useNewQuestionPropertyMenuItems.invalidPublicQuestionType"},relatedCollectionNotPublic:{defaultMessage:"Only relations to public databases are supported in public forms.",id:"formEditorQuestion.relatedCollectionNotPublic"},editorPlaceholder:{defaultMessage:"Respondent's answer",id:"formEditorQuestion.editorPlaceholder"},viewerEmptyPlaceholder:{defaultMessage:"Your answer",id:"formEditorQuestion.viewerEmptyPlaceholder"}});function s(e){let{layoutStore:t,collectionStore:o}=e;const a=(0,n().K8)((()=>o?t.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:o.getSchema()})??[]:[]),[t,o]),s=(0,n().K8)((()=>a.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(i().O9)),[a]);return(0,n().K8)((()=>{if(!o)return[];const e=o.getSchema();if(!t.getModel())return[];return(0,i().WP)(e).map((e=>{let[t,o]=e;if(o&&(0,r().Sg)(o)&&!s.includes(t))return t})).filter(i().O9)}),[o,t,s])}const l=[{key:"unlimited",title:"Unlimited",type:"button"},{key:"1",title:"1",type:"button"},{key:"2",title:"2",type:"button"},{key:"3",title:"3",type:"button"},{key:"4",title:"4",type:"button"},{key:"5",title:"5",type:"button"},{key:"10",title:"10",type:"button"}]},432945:(e,t,o)=>{o.d(t,{B:()=>d,I:()=>l});var n=()=>o(963644),r=()=>o(154956),i=()=>o(445322),a=()=>o(196916),s=()=>o(84543);async function l(e){let{theme:t,collectionContextStore:o,environment:n,property:r,from:a,schema:s,onDeleteCompleted:l,...c}=e;await i().q({environment:n,collectionContextStore:o,property:r,handleDeleteAccept:async()=>{await d({collectionContextStore:o,environment:n,property:r,schema:s,from:a,...c}),null==l||l()},theme:t,from:a})}async function d(e){const{collectionContextStore:t,environment:o,property:i,schema:l,from:d,...c}=e,p=t.collectionStore();if(!p)return;const u=p.getSchema()[i];await s().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await r().PF({environment:o,collectionStore:p,schema:l,property:i,transaction:e}),c.updateFrozenColumn&&a().sp({environment:o,collectionContextStore:t,currentIndex:c.columnIndex,entrypoint:c.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),u&&(0,n().i)({environment:o,collectionContextStore:t,property_type:u.type,from:d,property:i})}},445322:(e,t,o)=>{o.d(t,{q:()=>f});o(362833),o(242343);var n=()=>o(653998),r=()=>o(31448),i=()=>o(190717),a=()=>o(709237),s=()=>o(755786),l=()=>o(471979),d=()=>o(823301),c=()=>o(727528),p=()=>o(626911),u=()=>o(145046),m=()=>o(84543),y=o(163643);async function f(e){const{environment:t,collectionContextStore:o,property:f,handleDeleteAccept:g}=e,v=o.collectionStore();if(!v)return;if(v.isTypedProperty(f)){if(await i().nD({environment:t,property:f,collectionContextStore:o,theme:e.theme,from:e.from}))return}const C=(0,c().R5)({environment:t,collectionStore:v,propertyId:f});if(C.length>0){if((0,d().E_)({environment:t,collectionStore:v,propertyId:f,compoundTemplateInstancesToDelete:C,collectionContextStore:o,from:e.from}))return}else if(((0,l().k$)(f)||(0,l().Do)({collectionStore:v,propertyId:f}))&&(0,l().aF)(v)&&(0,l().Io)()){if((0,d().I5)({environment:t,collectionStore:v,propertyId:f,collectionContextStore:o,from:e.from}))return}const h=o.normalizedSchemaStore.state,S=h[f],b=s().pg(o,S);await(null==b?void 0:b.load());const I=b&&s().D5(o,f,b),M=b&&s().uf(b),w=b&&v.id===b.id,A=[{label:(0,y.jsx)(n().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let _;if(I&&v&&M&&!w&&A.push({label:(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{m().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(S&&"relation"===S.type&&S.property&&b){const o=S.property,n=b.getSchema();p().C4({environment:t,collectionStore:b,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:v.isSyncedCollection()&&!b.isSyncedCollection()?{enabled:!1}:S.autoRelate,transaction:e})}p().t$({environment:t,collectionStore:v,property:f,transaction:e})}})}}),"auto_increment_id"===(null==S?void 0:S.type))_=s().me(h)?(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==S?void 0:S.type)){const e=s().AX(h);if(e){const t=e.connectedRelation.automation;t&&t[f]&&(_=(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else b&&M&&!w&&I&&(_=(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,y.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.medium},store:b})}}));u().ui({message:(0,y.jsx)("span",{children:(0,y.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,y.jsx)(a().A,{style:{display:"inline",fontWeight:r().Wy.bold},shouldWrap:!0,store:v})}})}),description:_,showCancel:!0,keepFocus:!0,items:A,mode:"wide"})}},571060:(e,t,o)=>{o.d(t,{x:()=>l});var n=()=>o(237385),r=()=>o(803290),i=()=>o(174114),a=()=>o(441165),s=()=>o(654548);function l(e){let{textStore:t,parentStore:o,spaceId:l,disabled:d=!1}=e;const c=(0,n().v3)(),p=(0,i().DP)(),u=(0,a().Ol)(),m=(0,r().K8)((()=>c.KatexStore.getKatex()),[c.KatexStore]);return(0,r().K8)((()=>{const e=null==t?void 0:t.getValue();return e&&l&&o?s().S5({environment:c,textValue:{value:e,spaceId:l},parentStore:o,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:!0,disabled:d,theme:p,disableLinks:d,emojiType:u,katex:m,formulaValueTypes:[]}):null}),[d,u,c,m,o,l,t,p])}},680645:(e,t,o)=>{o.r(t),o.d(t,{FORMS_SHARE_CALLOUT_KEY:()=>J,changeFormClosedState:()=>ce,changeFormSubmissionPermissions:()=>pe,createAndFocusCollectionFormEditorView:()=>ne,createCollectionFormEditorView:()=>re,createDummyFormPage:()=>fe,createFormInPrivate:()=>ie,createFormQuestion:()=>se,createFormQuestionAndUpdateOrCreateModule:()=>de,createModuleForNewlyDuplicatedProperty:()=>le,createResponsesCollectionView:()=>ae,handleUpdateFormQuestionName:()=>ee,incrementAndTrackUserFormsCreated:()=>X,maybeAlertAboutUnsupportedPublicQuestions:()=>ge,maybeSyncQuestionNameToPropertyName:()=>te,remapQuestionToNewProperty:()=>ye,toggleAnonymousFormSubmissionState:()=>ue,toggleNotionBrandingState:()=>me});o(610931),o(362833),o(725707),o(491955),o(500234),o(771702),o(403517),o(242343);var n=()=>o(174114),r=()=>o(712437),i=()=>o(762847),a=()=>o(543396),s=()=>o(564134),l=()=>o(716605),d=()=>o(488587),c=()=>o(427091),p=()=>o(23735),u=o(163643);const m=(0,o(680369).wt)("collectionForm",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M5.50195 4.75635C5.37435 4.75635 5.26953 4.71305 5.1875 4.62646C5.10547 4.53988 5.06445 4.43734 5.06445 4.31885C5.06445 4.1958 5.10547 4.09326 5.1875 4.01123C5.26953 3.9292 5.37435 3.88818 5.50195 3.88818H10.5059C10.6289 3.88818 10.7314 3.9292 10.8135 4.01123C10.8955 4.09326 10.9365 4.1958 10.9365 4.31885C10.9365 4.43734 10.8955 4.53988 10.8135 4.62646C10.7314 4.71305 10.6289 4.75635 10.5059 4.75635H5.50195ZM5.50195 7.0874C5.37435 7.0874 5.26953 7.04639 5.1875 6.96436C5.10547 6.87777 5.06445 6.77295 5.06445 6.6499C5.06445 6.53141 5.10547 6.43115 5.1875 6.34912C5.26953 6.26709 5.37435 6.22607 5.50195 6.22607H10.5059C10.6289 6.22607 10.7314 6.26709 10.8135 6.34912C10.8955 6.43115 10.9365 6.53141 10.9365 6.6499C10.9365 6.77295 10.8955 6.87777 10.8135 6.96436C10.7314 7.04639 10.6289 7.0874 10.5059 7.0874H5.50195ZM5.50195 9.42529C5.37435 9.42529 5.26953 9.38428 5.1875 9.30225C5.10547 9.22021 5.06445 9.11995 5.06445 9.00146C5.06445 8.87842 5.10547 8.77588 5.1875 8.69385C5.26953 8.60726 5.37435 8.56396 5.50195 8.56396H7.92188C8.04948 8.56396 8.1543 8.60726 8.23633 8.69385C8.31836 8.77588 8.35938 8.87842 8.35938 9.00146C8.35938 9.11995 8.31836 9.22021 8.23633 9.30225C8.1543 9.38428 8.04948 9.42529 7.92188 9.42529H5.50195ZM2.13867 13.1577V2.84229C2.13867 2.10856 2.32552 1.55257 2.69922 1.17432C3.07292 0.791504 3.62663 0.600098 4.36035 0.600098H11.6406C12.3743 0.600098 12.9281 0.791504 13.3018 1.17432C13.6755 1.55257 13.8623 2.10856 13.8623 2.84229V13.1577C13.8623 13.896 13.6755 14.4543 13.3018 14.8325C12.9281 15.2108 12.3743 15.3999 11.6406 15.3999H4.36035C3.62663 15.3999 3.07292 15.2108 2.69922 14.8325C2.32552 14.4543 2.13867 13.896 2.13867 13.1577ZM3.48535 13.0757C3.48535 13.3901 3.56738 13.6317 3.73145 13.8003C3.89551 13.9689 4.14388 14.0532 4.47656 14.0532H11.5312C11.8639 14.0532 12.1123 13.9689 12.2764 13.8003C12.4404 13.6317 12.5225 13.3901 12.5225 13.0757V2.93115C12.5225 2.61214 12.4404 2.36833 12.2764 2.19971C12.1123 2.02653 11.8639 1.93994 11.5312 1.93994H4.47656C4.14388 1.93994 3.89551 2.02653 3.73145 2.19971C3.56738 2.36833 3.48535 2.61214 3.48535 2.93115V13.0757Z"})});var y=()=>o(84525),f=()=>o(33715),g=()=>o(996151),v=()=>o(220574),C=()=>o(632627),h=()=>o(145017),S=()=>o(289765),b=()=>o(109046),I=()=>o(968410),M=()=>o(34662),w=()=>o(653998),A=()=>o(728373),_=()=>o(31448),x=()=>o(154956),T=()=>o(415029),P=()=>o(145046),F=()=>o(927999),Q=()=>o(759625),E=()=>o(191756),k=()=>o(163875),N=()=>o(84543),D=()=>o(658388),L=()=>o(871856),R=()=>o(259897),V=()=>o(137476),B=()=>o(900921),j=()=>o(206183),H=()=>o(754697),z=()=>o(477784),U=()=>o(689248),q=()=>o(113805),W=()=>o(130081),O=()=>o(485966),G=()=>o(836331),K=()=>o(976603),Z=()=>o(937968),Y=()=>o(659030);const $=(0,w().YK)({responsesViewName:{id:"formEditorActions.responsesViewName",defaultMessage:"Responses"},newFormViewName:{id:"formEditorActions.newFormViewName",defaultMessage:"Form builder"},formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}}),J="forms_share_form_tooltip";function X(e,t){const{currentUserSettingsStore:o}=O().default.state;if(!o)return;const n=function(){const{currentUserSettingsStore:e}=O().default.state;if(!e)return;return e.getSettingsStore().getKeyStore("user_forms_created_count").getValue()??0}();void 0!==n&&(D().mJ({userSettingsStore:o,transaction:t,data:{user_forms_created_count:n+1}}),function(e,t){(0,V().u4)({environment:e,event:{eventName:"form_created",eventProperties:{user_total_form_count:t.userFormsCreatedCount}}})}(e,{userFormsCreatedCount:n+1})),G().default.logEvent("form_created")}function ee(e){var t;const{questionStore:o,newName:n,environment:r,collectionStore:i,collectionSchema:a,collectionContextStore:s}=e,l=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!l)throw new Error("No property ID found for question");N().createAndCommit({userAction:"formQuestion.changeName",environment:r,canUndo:!0,perform:e=>{var t,r;const d=null===(t=o.getConfig())||void 0===t?void 0:t.name;if(!d)return;const p=(0,C().r4)({textValue:d,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:z().A.getIntl()})===(null===(r=a[l])||void 0===r?void 0:r.name);N().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","name"],command:"set",args:[[n]]},transaction:e}),o.shouldSyncQuestionNameToPropertyName()&&(p&&!(0,j().fE)({property:l,collectionContextStore:s,newValue:n})?x().YO({collectionStore:i,property:l,name:n,transaction:e}):N().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!1},transaction:e}))}})}function te(e){var t;const{questionStore:o,environment:n,collectionStore:r,collectionContextStore:i}=e,a=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!a)throw new Error("No property ID found for question");N().createAndCommit({userAction:"formQuestion.changeName",environment:n,canUndo:!0,perform:e=>{if(!o.shouldSyncQuestionNameToPropertyName())return;const t=o.getNameStore().getValue();if(!t)return;const n=(0,C().r4)({textValue:t,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:z().A.getIntl()}),s=(0,j().fE)({property:a,collectionContextStore:i,newValue:n})?(0,d().Q)(n):n;x().YO({collectionStore:r,property:a,name:s,transaction:e})}})}function oe(){const e=(0,n().IS)((e=>({container:{display:"flex",flexDirection:"column"},iconGroup:{display:"flex",flexDirection:"row",justifyContent:"center",color:e.icon.secondary,alignItems:"center"},dialogTitle:{fontSize:16,fontWeight:_().Wy.semibold,lineHeight:"22px",marginTop:12,marginBottom:12},dialogDescription:{color:e.text.secondary,fontSize:14,lineHeight:"20px"}})),[]);return(0,u.jsxs)("div",{style:e.container,children:[(0,u.jsxs)("div",{style:e.iconGroup,children:[(0,y().K)({width:24}),(0,p().o)({width:16,marginLeft:16,marginRight:14}),m({width:24})]}),(0,u.jsx)("span",{style:e.dialogTitle,children:(0,u.jsx)(w().sA,{defaultMessage:"Auto-create form questions based on existing properties?",id:"NewFormOnExistingCollectionDialogTitle.message"})}),(0,u.jsx)("span",{style:e.dialogDescription,children:(0,u.jsx)(w().sA,{defaultMessage:"Only supported property types will create new questions.",id:"NewFormOnExistingCollectionDialogTitle.description"})})]})}function ne(e){const{environment:t,collectionContextStore:o,transaction:n}=e,r=o.collectionViewBlockStore(),i=o.collectionStore();if(!r||!i)return;const s=o.normalizedSchemaStore.state,l=re({environment:t,collectionViewBlockStore:r,schema:s,transaction:n,initializeWithAllDefaultQuestions:!1});if(!l)return;(0,R().t)({environment:t,collectionContextStore:o,collectionViewId:l.newViewId,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state});const d=l.layoutStore,c=Object.keys(s).filter((e=>{const t=s[e];return"title"!==e&&t&&(0,a().Sg)(t)}));c.length>0&&c.length<=Y().eb&&P().ui({showCancel:!1,keepFocus:!1,message:(0,u.jsx)(oe,{}),mode:"wide",items:[{label:(0,u.jsx)(w().sA,{defaultMessage:"Create {numQuestions, plural, one {1 question} other {{numQuestions} questions}}",id:"formEditorActions.createQuestions.primaryAction",values:{numQuestions:c.length}}),color:"blue",buttonType:"solid",onAccept(){N().createAndCommit({environment:t,userAction:"formActions.autoCreateFormQuestionsForExistingDatabase",canUndo:!0,perform:e=>{for(const n of c)le({type:"formQuestion",environment:t,module:void 0,transaction:e,layoutStore:d,collectionStore:i,propertyId:n,position:{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},collectionContextStore:o,shouldLogEvent:!0,autoCreatedFromExistingDatabase:!0,duplicateModuleMapping:new Map,propertyIdMapping:new Map,sessionId:(0,A().Ay)()})}})}},{label:(0,u.jsx)(w().sA,{defaultMessage:"Start from scratch",id:"formEditorActions.createQuestions.secondary"}),color:"gray",buttonType:"plain",onAccept(){}}]})}function re(e){const{environment:t,collectionViewBlockStore:o,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}=e;if(!o)return;const l=o.getSpaceId(),{formBlockStore:d,layoutStore:c}=function(e){var t;const{environment:o,spaceId:n,inMemoryRecordCache:r,transaction:i,schema:l,initializeWithAllDefaultQuestions:d}=e,c=Object.keys(l).find((e=>{var t;return"multi_select"===(null===(t=l[e])||void 0===t?void 0:t.type)})),p=Boolean(d&&void 0!==c),u=(0,H().Z1)({environment:o,table:h().ev,spaceId:n}),m=(0,H().Z1)({environment:o,table:b().lo,spaceId:n}),y=p?(0,H().Z1)({environment:o,table:b().lo,spaceId:n}):void 0,f=Q().Wv({id:u,environment:o,type:"form",permissions:(0,a().eb)(),inMemoryRecordCache:r,transaction:i}),v=Q().eC({environment:o,table:I().zx,value:{space_id:n,parent_table:h().ev,parent_id:f.id,modules:(0,g().oP)(m,y)},inMemoryRecordCache:r,transaction:i});var C,S;F().zA({stores:[f],update:{form_layout_pointer:{id:v.id,spaceId:n,table:I().zx}},transaction:i}),se({environment:o,questionId:m,spaceId:n,layoutId:v.id,propertyId:s().rn,initialQuestionTitle:(null===(t=l[s().rn])||void 0===t?void 0:t.name)??"",inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1,logData:{area:"form_layout_schema",layoutStore:v}}),p&&y&&c&&se({environment:o,questionId:y,spaceId:n,layoutId:v.id,propertyId:c,initialQuestionTitle:(null===(C=l[c])||void 0===C?void 0:C.name)??"",existingFormQuestionConfig:{propertyId:c,name:[[(null===(S=l[c])||void 0===S?void 0:S.name)??""]],propertyTypeSpecificConfig:{multi_select:{maxSelectionCount:1}}},inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1,logData:{area:"form_layout_schema",layoutStore:v}});return{formBlockStore:f,layoutStore:v}}({environment:t,spaceId:l,inMemoryRecordCache:o.inMemoryRecordCache,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}),p=(0,L().i)({environment:t,collectionViewBlockStore:o,collectionView:{type:"form_editor",parent_id:o.id,parent_table:h().ev,alive:!0,space_id:l,name:z().A.formatMessage($.newFormViewName),format:{form_block_pointer:{id:d.id,spaceId:l,table:h().ev}}},transaction:n});return Q().zv({store:d,data:{parent_id:p.id,parent_table:S().Gy,alive:!0},transaction:n}),K().A.setState({openTooltip:p.id}),U().HH(t,J),X(t,n),{newViewId:p.id,layoutStore:c,formId:d.id}}function ie(e){const{environment:t,navigateToFormBuilder:o}=e,{currentSpaceStore:n,currentSpaceViewStore:i}=O().default.state;if(!n||!i)return;if(!(0,Z().EF)(t))return void(0,Z().QY)(t);if(!(n&&n.canEdit()&&i))return;const a=n.id,s=t.idCreator.getSpaceIdCreatorSync(a);N().createAndCommit({environment:t,userAction:"formActions.createAndNavigateToFormInPrivate",canUndo:!0,perform:e=>{var l;const{targetBlockStore:d}=T().j({environment:t,sourceBlockId:"root",targetBlockPointer:(0,H().zP)({environment:t,table:h().ev,spaceId:a}),sourceBlockSubtree:(0,v().partialRecordMapToRecordMap)(B().mT({isInline:!0,name:(0,M().x9d)(z().A.formatMessage($.formDatabaseTitle))})),targetRecordCache:n.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:s}),c=d.getCollectionStore(),p=null==c||null===(l=c.getModel())||void 0===l?void 0:l.getNormalizedSchema(),u=d;if(!p)throw new Error("Schema not found");re({environment:t,transaction:e,collectionViewBlockStore:u,schema:p,initializeWithAllDefaultQuestions:!0}),ae({environment:t,transaction:e,collectionViewBlockStore:u,schema:p}),k().yM({environment:t,spaceStore:n,spaceViewStore:i,pageStore:d,isPrivate:!0,transaction:e,location:{type:"prepend"}}),o&&E().uK({environment:t,store:d,pageVisitSource:r().y8.CreateFormDeepLink})}})}function ae(e){const{environment:t,collectionViewBlockStore:o,transaction:n}=e,r=o.getSpaceId(),i=Object.keys(e.schema).find((t=>{var o;return"created_by"===(null===(o=e.schema[t])||void 0===o?void 0:o.type)}));(0,L().i)({environment:t,collectionViewBlockStore:o,collectionView:{type:"table",parent_id:o.id,parent_table:h().ev,alive:!0,name:z().A.formatMessage($.responsesViewName),space_id:r,format:{table_properties:[{property:"title",visible:!0},...i?[{property:i,visible:!0}]:[]],table_wrap:!0,collection_pointer:o.getCollectionPointer()}},transaction:n})}function se(e){const{environment:t,questionId:o,spaceId:n,layoutId:r,propertyId:i,initialQuestionTitle:a,inMemoryRecordCache:s,transaction:l,shouldSyncQuestionNameToPropertyName:d,collectionContextStore:c,shouldLogEvent:p=!0,autofocusTitle:u,existingFormQuestionConfig:m,autoCreatedFromExistingDatabase:y}=e;Q().vt({environment:t,table:b().lo,args:{id:o,space_id:n,parentPointer:{id:r,table:I().zx,spaceId:n},config:{...m,propertyId:i,name:[[a]],shouldSyncQuestionNameToPropertyName:d}},inMemoryRecordCache:s,transaction:l}),p&&(0,V().u4)({environment:t,event:{eventName:"add_form_question",eventProperties:{...(0,Y().YA)({collectionContextStore:c,propertyId:i,questionId:o,area:e.logData.area,parentModuleId:e.logData.parentModuleId,layoutStore:e.logData.layoutStore}),auto_created_from_existing_database:Boolean(y)}}}),u&&u.autofocusedQuestionTextStore.autofocusQuestionTitle({questionId:o})}function le(e){const{type:t,module:o,environment:n,transaction:r,layoutStore:i,position:a,duplicateModuleMapping:s,shouldLogEvent:l=!0,collectionContextStore:d,sessionId:c}=e;let p;const u=o&&s.get(o.id)||(0,A().Ay)();if("formQuestion"===t){var m;const{collectionStore:t,propertyId:c,autofocusTitle:y,existingFormQuestionConfig:g,autoCreatedFromExistingDatabase:v,propertyIdMapping:C}=e,h=t.getSchema()[c];if(!h)throw new Error(`No schema found for property ${c}`);const S=g?(0,M().q4_)(null==g?void 0:g.name):h.name,I=i.getSpaceId(),w=(0,H().Z1)({environment:n,table:b().lo,spaceId:I});if(!(0,f().uW)(a.area))throw new Error("Module is not allowed in this area");se({environment:n,questionId:w,spaceId:I,layoutId:i.id,propertyId:c,initialQuestionTitle:S,inMemoryRecordCache:i.inMemoryRecordCache,transaction:r,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:l,logData:{area:a.area,parentModuleId:null==o?void 0:o.parentModuleId,layoutStore:i},collectionContextStore:d,autofocusTitle:y,existingFormQuestionConfig:g,autoCreatedFromExistingDatabase:v}),p={type:"formQuestion",id:u,formQuestionId:w,...o?{parentModuleId:s.get(o.parentModuleId??"")??o.parentModuleId,parentConditionalGroupId:o.parentConditionalGroupId,conditionalGroups:null===(m=o.conditionalGroups)||void 0===m?void 0:m.map((e=>({...e,trigger:{...e.trigger,property:C.get(e.trigger.property)??e.trigger.property},children:[]})))}:{}}}else p={type:"placeholder",id:u,parentModuleId:s.get(o.parentModuleId??""),parentConditionalGroupId:o.parentConditionalGroupId};return(0,q().UQ)({environment:n,transaction:r,layoutStore:i,position:a,module:p,sessionId:c,isPropertyCreation:!1}),{moduleId:u}}function de(e){const{environment:t,transaction:o,layoutStore:n,propertyId:r,initialQuestionTitle:i,moduleId:a,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d,area:c,sessionId:p}=e,u=n.getModel();if(!u)throw new Error("Layout model cannot be undefined");const m=n.getSpaceId(),y=(0,H().Z1)({environment:t,table:b().lo,spaceId:m});se({environment:t,questionId:y,spaceId:m,layoutId:u.id,propertyId:r,initialQuestionTitle:i,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d,logData:{area:c,parentModuleId:"form_conditional_modules"===c?e.parentModuleId:void 0,layoutStore:n}});const f={type:"formQuestion",id:a??(0,A().Ay)(),formQuestionId:y,..."form_conditional_modules"===c?{parentModuleId:e.parentModuleId,parentConditionalGroupId:e.parentConditionalGroupId}:{}};return a?(0,W().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:c,moduleId:a},updatedModule:f}):"form_conditional_modules"===c&&(0,q().UQ)({environment:t,transaction:o,layoutStore:n,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e.parentConditionalGroupId,parentModuleId:e.parentModuleId},module:f,sessionId:p,isPropertyCreation:!1}),{updatedModuleId:f.id,formQuestionId:y}}function ce(e){let{environment:t,formBlockStore:o,isClosed:n}=e;o.getIsFormClosed()!==n&&N().createAndCommit({userAction:"formActions.changeFormClosedState",environment:t,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),is_form_closed:n}},transaction:e})}})}function pe(e){let{environment:t,formBlockStore:o,permissions:n}=e;o.getFormSubmissionPermissions()!==n&&N().createAndCommit({userAction:"formActions.changeFormSubmissionPermissions",environment:t,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),submission_permissions:n}},transaction:e})}})}function ue(e){let{environment:t,formBlockStore:o}=e;const n=o.getIsFormAnonymousSubmissionEnabled();N().createAndCommit({userAction:"formActions.changeAnonymousFormSubmissionState",environment:t,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),anonymous_submissions:!n}},transaction:e})}})}function me(e){var t;let{environment:o,formBlockStore:n}=e;const r=n.getSiteStore();if(!r)return;const i=(null===(t=r.getHeader())||void 0===t?void 0:t.hideWatermark)??!1;N().createAndCommit({userAction:"formBlockStore.publicForm.toggleNotionBranding",environment:o,canUndo:!0,perform:e=>{N().applyOperation({store:r,operation:{pointer:r.pointer,path:["header","hideWatermark"],command:"set",args:!i},transaction:e})}})}function ye(e){let{environment:t,newPropertyId:o,formQuestionStore:n}=e;N().createAndCommit({userAction:"formQuestion.remapQuestionToNewProperty",environment:t,canUndo:!0,perform:e=>{N().applyOperation({store:n,operation:{pointer:n.pointer,path:["config","propertyId"],command:"set",args:o},transaction:e})}})}function fe(e){const{environment:t,collectionSchema:o,temporaryRecordCache:n,spaceId:r,collectionId:a,formMode:s}=e,l={};Object.keys(o).forEach((e=>{l[e]=(0,M().x9d)("")}));const{performResult:d}=N().createAndCommit({environment:t,userAction:"formActions.createDummyFormPage",perform:e=>{const o=Q().Wv({environment:t,type:i().xd.page,inMemoryRecordCache:n,transaction:e,spaceId:r,properties:{...l}});return Q().zv({store:o,data:{alive:"viewer"===s,parent_id:a,parent_table:"collection"},transaction:e}),o},canUndo:!1});return d}async function ge(e){const{environment:t,formBlockStore:o,collectionSchema:n,theme:r,onAccept:i}=e;if(!n)return;const a=(0,Y().Dx)(o),s=(null==a?void 0:a.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:n}))??[],d=[];if(s.forEach((e=>{const o=e.getPropertyId();if(!o)return;const r=(0,l()._g)({schema:n,property:o}),i=null==r?void 0:r.type;if(!i)return;(0,Y().CK)({environment:t,propertyType:i,propertySchema:r,isPublicForm:!0})&&d.push(e)})),0===d.length)return void i();const p=d.map(((e,t)=>{const o=(0,C().r4)({textValue:e.getNameStore().getValue(),getRecordModel:e.getRecordModel,deterministic:!0,userTimeZone:(0,c().P)(),intl:z().A.getIntl()}),n=t===d.length-1;return(0,u.jsx)("div",{style:{fontSize:14,textAlign:"start",padding:"8px 12px",borderBottom:n?void 0:`1px solid ${r.lightDividerColor}`},children:o},e.id)})),{accept:m}=await P().Gh({message:(0,u.jsx)(w().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.message",defaultMessage:"These questions are not supported in public forms and will not be shown to respondents:"}),description:(0,u.jsx)("div",{style:{borderRadius:6,border:`1px solid ${r.lightDividerColor}`,width:"calc(100% + 24px)",marginLeft:-12,marginTop:12,maxHeight:210,overflow:"auto"},children:p}),acceptLabel:(0,u.jsx)(w().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.acceptLabel",defaultMessage:"Got it"}),acceptColor:"blue",cancelButtonType:"plain",mode:"wide"});m&&i()}},749351:(e,t,o)=>{o.d(t,{O:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("parentChildRelation",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{fillRule:"evenodd",d:"M6 6.75a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5m.625 1.171a2.501 2.501 0 1 0-1.25 0V11A3.625 3.625 0 0 0 9 14.625h3.079a2.5 2.5 0 1 0 0-1.25H9A2.375 2.375 0 0 1 6.625 11zM14.5 15.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})})},800057:(e,t,o)=>{o.d(t,{s:()=>a});const n={id:"pageLayoutEditor.property",defaultMessage:"Property",description:"Label for the property section in the page layout editor"},r={id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Heading",description:"Label for the titleWithIcon section in the page layout editor"},i={id:"pageLayoutEditor.collectionView",defaultMessage:"Database View",description:"Label for the form submit button section in the form page layout editor"},a=(0,o(653998).YK)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Property group"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Content"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"},views:{id:"pageLayoutEditor.views",defaultMessage:"Views"},viewsMain:{id:"pageLayoutEditor.views",defaultMessage:"Views"},relationsGroup:{id:"pageLayoutEditor.relationsGroup",defaultMessage:"Relations group"},formTitle:{id:"pageLayoutEditor.formTitle",defaultMessage:"Form Title"},formQuestion:{id:"pageLayoutEditor.formQuestion",defaultMessage:"Form Question"},formSubmit:{id:"pageLayoutEditor.formSubmit",defaultMessage:"Form Submit"},placeholder:{id:"pageLayoutEditor.placeholder",defaultMessage:"New"},recentActivity:{id:"pageLayoutEditor.recentActivity",defaultMessage:"Recent activity"},collaborators:{id:"pageLayoutEditor.collaborators",defaultMessage:"Top collaborators"},teamspaces:{id:"pageLayoutEditor.teamspaces",defaultMessage:"Teamspaces"},normalizedTitleWithIcon:r,titleWithIcon:r,deleted_property:n,property_number:n,property_title:n,property_person:n,property_file:n,property_text:n,property_checkbox:n,property_url:n,property_email:n,property_phone_number:n,property_created_by:n,property_last_edited_by:n,property_button:n,property_select:n,property_multi_select:n,property_status:n,property_date:n,property_created_time:n,property_last_edited_time:n,property_last_visited_time:n,property_relation:n,property_rollup:n,property_formula:n,property_auto_increment_id:n,property_location:n,property_verification:n,property_geo_point:n,property:n,collectionView:i,collectionViewV2:i})},804750:(e,t,o)=>{o.d(t,{b:()=>r});o(242343);var n=o(163643);const r=(0,o(680369).wt)("plusMedium",{viewBox:"0 0 16 16",svg:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M2 8a.77.77 0 01.237-.566.762.762 0 01.566-.244h4.394V2.803a.77.77 0 01.237-.566A.773.773 0 018 2c.225 0 .416.079.573.237a.773.773 0 01.237.566V7.19h4.387c.22 0 .409.081.566.244A.773.773 0 0114 8a.781.781 0 01-.237.573.785.785 0 01-.566.23H8.81v4.401a.764.764 0 01-.237.56A.781.781 0 018 14a.773.773 0 01-.566-.237.764.764 0 01-.237-.559V8.803H2.803a.785.785 0 01-.566-.23A.781.781 0 012 8z"})})})},935889:(e,t,o)=>{o.d(t,{$:()=>l});var n=o(242343),r=()=>o(803290),i=()=>o(982415),a=()=>o(397791),s=o(163643);const l=n.memo(n.forwardRef((function(e,t){let{collectionContextStore:l,property:d,iconTransformer:c=(e=>e),getTitleOverride:p,...u}=e;const{isMobile:m}=(0,o(237385).Y0)(),y=(0,r().K8)((()=>l.collectionStore()),[l]),f=(0,r().K8)((()=>null==y?void 0:y.getDatabaseType()),[y]),g=(0,r().K8)((()=>Boolean(y&&f&&o(283759).jP((0,o(414997).appConfigs)(),f,d,y))),[y,f,d]),v=(0,n.useCallback)((e=>(0,i().eF)(f,e)),[f]),C=(0,n.useCallback)((e=>(0,s.jsx)(o(535906).A,{...u,...e,disabled:g,disabledFeedback:g,title:(null==p?void 0:p({isRequiredProperty:g}))??(0,s.jsx)(o(653998).sA,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:m&&g?(0,i().eF)(f):null,icon:c(g?(0,s.jsx)("div",{...e,children:(0,s.jsx)(a().I,{icon:o(127436).i})}):(0,s.jsx)(a().I,{icon:o(836693).trashIcon})),isRedOnHover:!0})),[f,p,c,m,g,u]);return(0,s.jsx)(o(103151).A,{placement:o(907721).W.Left,disableTooltip:!g,renderTooltip:v,render:C})})))},976603:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(129044))().default{getInitialState(){return{openTooltip:void 0}}}const r=new n}}]);