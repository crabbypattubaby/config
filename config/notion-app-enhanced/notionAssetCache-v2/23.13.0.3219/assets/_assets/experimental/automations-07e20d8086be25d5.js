"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[11097,22542,79665,89693,90871],{3364:(e,t,o)=>{o.d(t,{Ay:()=>j,iZ:()=>A,vE:()=>C});var n=o(242343),i=()=>o(862510),a=()=>o(174114),r=()=>o(887508),l=()=>o(81322),s=()=>o(653998),c=()=>o(31448),u=()=>o(521325),d=()=>o(126451),p=()=>o(356813),m=()=>o(935091),g=()=>o(743668),y=()=>o(701270),h=()=>o(502852),f=()=>o(640979),v=()=>o(495312),x=()=>o(639659),b=o(163643);const S=(0,s().YK)({back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}}),C=290,A=400;function k(e){let{children:t,title:o,desktopTitleType:n,settingsStackLength:i,handleClose:u,handleBackArrowClick:m,hideDesktopHeader:g,hasBackStack:h}=e;const f=(0,x().a)(),v=(0,s().tz)(),C=(0,a().IS)((e=>({hiddenDesktopHeaderDiv:{height:0},nonHiddenDesktopHeaderDiv:{display:"flex",alignItems:f?"top":"center",padding:f?"0px 14px 6px 14px":"14px 16px 6px 16px",height:f?void 0:42},arrowButton:{marginRight:8,marginLeft:-2,height:22},arrowIcon:{width:16,height:16},title:{flexGrow:1,fontWeight:f?c().Wy.medium:c().Wy.semibold,fontSize:f?16:14,lineHeight:f?"24px":void 0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18,flexShrink:0},closeButtonHover:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.text.secondary}})),[f]),A=!f;return(0,b.jsxs)(b.Fragment,{children:[g?(0,b.jsx)("div",{style:C.hiddenDesktopHeaderDiv}):(0,b.jsxs)("div",{style:C.nonHiddenDesktopHeaderDiv,children:[(i>1||h)&&(0,b.jsx)(p().A,{icon:r().v,style:C.arrowButton,iconStyle:C.arrowIcon,onClick:m,ariaLabel:v.formatMessage(S.back)}),"sectionHeader"===n?(0,b.jsx)(y().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",customStyles:{flexGrow:1},children:o}):(0,b.jsx)("span",{style:C.title,children:o}),A&&(0,b.jsx)(d().A,{onClick:u,style:C.closeButton,hoveredStyle:C.closeButtonHover,children:(0,l().V)(C.closeIcon)})]}),t]})}function M(e,t){let{children:a,footer:r,header:l,unconstrainedWidth:s,desktopWidth:c,title:d,desktopTitleType:p,collectionSettingsStore:y,fullHeight:S,hideDesktopHeader:A,menuScrollerStyle:M,innerContentWrapperStyle:j,disableScroller:T,handleBackArrowClick:I,hasBackStack:w,handleClose:_}=e;const P=(0,o(237385).Y0)(),B=(0,o(749975).Ks)(),R=(0,f().Tf)(),V=(0,x().a)(),{currentTab:E,settingsStackLength:D,hideHeader:F}=(0,o(803290).K8)((()=>{const e=y.state;return{currentTab:(0,o(155352).S)(y),settingsStackLength:e.stack.length,hideHeader:e.hideSettingsHeader}}),[y]),O=(0,n.useCallback)((()=>{var e;I?I():u().yl({collectionSettingsStore:y,keepPreviousRef:"form_editor"===(null==B||null===(e=B.collectionViewStore())||void 0===e?void 0:e.getType())})}),[I,y,B]),N=(0,n.useCallback)((e=>{_?_(e):(0,h().SQ)({event:e,context:h().y$.CollectionSettingsClick,callback:()=>{u().os({collectionSettingsStore:y})}})}),[_,y]),L=(0,n.useCallback)((e=>{(0,v().rW)(e.target)||(0,v().iX)(e.target)||(0,v().u2)(e.target)||o(521972).g.state.isOpen||N(e)}),[N]);if(!E)return null;let W;if(P.isMobile)W={disableScroller:T,menuType:f().gu.Modal,title:d,left:D>1?(0,b.jsx)(g().MobileModalBackButton,{}):void 0,onClickLeft:D>1?O:void 0,scrollerStyle:M,innerRef:t,right:R?void 0:(0,b.jsx)(g().DoneMenuText,{}),onClickRight:R?void 0:N};else{const e=s||c?void 0:V?280:C;W={disableScroller:T,menuType:f().gu.Popup,minWidth:V?280:C,width:c,maxHeight:S?"100%":"80vh",...e&&{maxWidth:e},onClickOutside:L,scrollerStyle:{flexGrow:0,...M},header:!F&&(0,b.jsx)(k,{settingsStackLength:D,handleClose:N,handleBackArrowClick:O,hasBackStack:w,hideDesktopHeader:A,title:d,desktopTitleType:p,children:l}),paddingTop:F?6:0,footer:r,innerRef:t}}const z=(0,b.jsxs)(b.Fragment,{children:[P.isMobile&&l,a,P.isMobile&&r]});return S?(0,b.jsx)(i().Y,{direction:"vertical",children:(0,b.jsx)(m().A,{...W,children:z})}):(0,b.jsx)(o(435819).A,{capture:!0,allowMobileAutoScroll:!0,allowEsc:!0,render:e=>(0,b.jsx)(i().Y,{direction:"vertical",children:(0,b.jsx)(m().A,{...W,...e,children:(0,b.jsx)("div",{style:j,children:z})})})})}const j=(0,n.forwardRef)(M)},17384:(e,t,o)=>{o.r(t),o.d(t,{arrowUpRightSquareSmallIcon:()=>a,iconDefinition:()=>i});o(242343);var n=o(163643);const i={viewBox:"0 0 16 16",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M6.898 5.025a.575.575 0 1 0 0 1.15h2.114l-3.969 3.968a.575.575 0 0 0 .814.814l3.968-3.969v2.114a.575.575 0 0 0 1.15 0V5.6a.575.575 0 0 0-.575-.575z"}),(0,n.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},a=(0,o(680369).wt)("arrowUpRightSquareSmall",i)},23082:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=function(){return(0,n.jsx)(o(932322).Ay,{title:(0,n.jsx)(o(966789).A,{})})}},24281:(e,t,o)=>{o.d(t,{B:()=>h});o(242343);var n=()=>o(237385),i=()=>o(803290),a=()=>o(174114),r=()=>o(653998),l=()=>o(220413),s=()=>o(76394),c=()=>o(31448),u=()=>o(678523),d=()=>o(103151),p=()=>o(907721),m=()=>o(485966),g=()=>o(943066),y=o(163643);function h(e){let{upsell:t,mobileStyle:o,desktopStyle:h,analyticsName:f,onClick:v,disableTooltip:x}=e;const b=(0,a().DP)(),S=(0,n().v3)(),{device:C}=S,A=(0,i().K8)((()=>{const{currentSpaceStore:e}=m().default.state;return null==e?void 0:e.canAdmin()}),[]),k=(0,i().K8)((()=>function(e,t){if("product"!==e.type)return{};switch(e.product){case"plus":case"business":case"enterprise":return{color:t.blueColor,background:"light"===t.mode?l().Ay.diffBackground:"rgba(35, 131, 226, 0.2)",fontWeight:c().Wy.medium};default:return{}}}(t,b)),[t,b]);if("product"!==t.type)return null;if(C.isMobileNative)return null;const M=(()=>{switch(t.product){case"personal":return(0,y.jsx)(r().sA,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"});case"plus":return(0,y.jsx)(r().sA,{defaultMessage:"Plus ↗",id:"upgradeButton.plus.textWithArrow"});case"business":return(0,y.jsx)(r().sA,{defaultMessage:"Business ↗",id:"upgradeButton.business.textWithArrow"});case"enterprise":return(0,y.jsx)(r().sA,{defaultMessage:"Enterprise ↗",id:"upgradeButton.enterprise.textWithArrow"});case"ai":return(0,y.jsx)(r().sA,{defaultMessage:"AI ↗",id:"upgradeButton.ai.textWithArrow"});case"sites_custom_hostnames":return(0,y.jsx)(r().sA,{defaultMessage:"Custom Hostnames ↗",id:"upgradeButton.sites_custom_hostnames.textWithArrow"});default:t.product,(0,s().HB)(t.product)}})();return C.isMobile||!A?(0,y.jsx)(u().A,{mobileStyle:o,children:M}):(0,y.jsx)(d().A,{delayThreshold:120,disableTooltip:x,placement:p().W.Bottom,renderTooltip:()=>(0,y.jsx)("div",{style:{maxWidth:500},children:(0,y.jsx)(r().sA,{defaultMessage:"Upgrade to use this feature.",id:"premiumFeatureUpgradeButton.upgrade.tooltip"})}),originGap:6,render:e=>(0,y.jsx)(u().A,{desktopStyle:h,innerStyle:k,onClick:e=>function(e,t,o,n,i){g().K(n,{from:t,upsell:o}),i&&i(e)}(e,f,t,S,v),...e,children:M})})}},40357:(e,t,o)=>{o.d(t,{A:()=>x});o(362833),o(242343);var n=()=>o(237385),i=()=>o(762847),a=()=>o(908568),r=()=>o(386311),l=()=>o(34662),s=()=>o(653998),c=()=>o(762763),u=()=>o(91472),d=()=>o(759625),p=()=>o(84543),m=()=>o(640979),g=()=>o(331516),y=()=>o(935091),h=()=>o(858023),f=()=>o(88271),v=o(163643);function x(e){const{store:t,parentBlockStore:o,onAccept:x,token:b,href:S,hoverData:C}=e,A=(0,n().v3)(),k=[];return k.push({key:0,render:e=>(0,v.jsx)(f().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"copy link",render:e=>(0,v.jsx)(g().A,{...e,title:(0,v.jsx)(s().sA,{id:"linkMention.copyLink",defaultMessage:"Copy Link"}),svg:a().n}),action:async()=>{if(!t)return;if(!b)return;const e=await u().R.clipboardActions.load(),o=e.clipboardMessages.copiedLinkToClipboard,n=S;e.copyString({environment:A,stringValue:n,copiedMessage:o})}}]}),k.push({key:1,render:e=>(0,v.jsx)(f().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"convert to bookmark",render:e=>(0,v.jsx)(g().A,{...e,title:(0,v.jsx)(s().sA,{id:"linkMention.convertToBookmark",defaultMessage:"Turn into preview"}),svg:r().I}),action:()=>{t&&b&&p().createAndCommit({userAction:"LinkMentionMenu.convertToBookmark",environment:A,canUndo:!0,perform:e=>{if(C){const n=d().Wv({environment:A,type:i().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:C&&C.title?l().x9d(C.title):l().x9d(S),link:l().x9d(S),description:C&&C.description?l().x9d(C.description):void 0},format:{bookmark_cover:C.thumbnail_url,bookmark_icon:C.favicon_url?C.favicon_url:C.icon_url},transaction:e,spaceId:t.pointer.spaceId});c().ed({environment:A,parentBlockStore:o,blockStore:n,token:b,transaction:e})}else{const n=d().Wv({environment:A,type:i().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:l().x9d(S),link:l().x9d(S)},transaction:e,spaceId:t.pointer.spaceId});c().ed({environment:A,parentBlockStore:o,blockStore:n,token:b,transaction:e})}}})}}]}),(0,v.jsx)(y().A,{menuType:m().gu.Popup,children:(0,v.jsx)(h().Ay,{type:h().Oh.Vertical,initialFocus:void 0,onAccept:x,sections:k,style:{paddingTop:3,paddingBottom:3}})})}},42635:(e,t,o)=>{o.r(t),o.d(t,{eyeFillSmallIcon:()=>a,iconDefinition:()=>i});o(242343);var n=o(163643);const i={viewBox:"0 0 16 16",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M9.219 8.002a1.22 1.22 0 1 1-2.439 0 1.22 1.22 0 0 1 2.439 0"}),(0,n.jsx)("path",{d:"M.914 7.44a1.21 1.21 0 0 0 0 1.128c1.282 2.442 3.987 4.1 7.086 4.1s5.804-1.658 7.086-4.1a1.21 1.21 0 0 0 0-1.128C13.804 4.997 11.099 3.34 8 3.34S2.196 4.997.914 7.44M8 10.628a2.626 2.626 0 1 1 .001-5.251A2.626 2.626 0 0 1 8 10.627"})]})},a=(0,o(680369).wt)("eyeFillSmall",i)},44250:(e,t,o)=>{function n(e){return!(!e||"askUserToPick"in e)}function i(e){if(!e||!("askUserToPick"in e))return e}function a(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}o.d(t,{DK:()=>i,K$:()=>n,j6:()=>a})},48150:(e,t,o)=>{o.d(t,{a:()=>a});var n=o(242343),i=o(163643);const a=n.forwardRef(((e,t)=>{const n=(0,o(174114).IS)((t=>({buttonStyle:{paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2,width:"100%",marginLeft:0,background:"transparent",...e.buttonStyle},menuItemStyle:{gap:6,background:"transparent",...e.style},innerContainer:{marginLeft:0,paddingLeft:0,minWidth:"auto",color:e.disabled?t.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:t.text.secondary,margin:0,...e.rightStyle}})),[e.disabled,e.rightStyle,e.buttonStyle,e.style]);return(0,i.jsx)(o(535906).A,{role:"button",...e,ref:t,style:n.menuItemStyle,buttonStyle:n.buttonStyle,textWrapperStyle:n.innerContainer,desktopIconStyle:n.desktopIconStyle,rightStyle:n.rightStyle})}));a.displayName="SiteSettingButtonMenuItem"},49743:(e,t,o)=>{o.d(t,{g:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("addPerson",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M9.48242 7.91211C10.8076 7.91211 11.8352 6.77783 11.8352 5.35718C11.8352 4.00391 10.7908 2.84717 9.48242 2.84717C8.17407 2.84717 7.12964 4.00952 7.13525 5.36279C7.14087 6.77783 8.16284 7.91211 9.48242 7.91211ZM9.48242 8.87231C8.7356 8.87231 8.04492 8.99585 7.44409 9.22046C8.23022 9.95044 8.72437 10.9836 8.72437 12.1235C8.72437 12.511 8.66821 12.8872 8.55591 13.2466H12.8684C13.969 13.2466 14.3171 12.8479 14.3171 12.2302C14.3171 10.804 12.3967 8.87231 9.48242 8.87231ZM4.74316 15.1895C6.42212 15.1895 7.80347 13.7969 7.80347 12.1235C7.80347 10.4558 6.42212 9.06885 4.74316 9.06885C3.06982 9.06885 1.68286 10.4558 1.68286 12.1235C1.68286 13.7969 3.06982 15.1895 4.74316 15.1895ZM4.74316 14.1675C4.41187 14.1675 4.18726 13.9429 4.18726 13.6172V12.6907H3.27197C2.94629 12.6907 2.72168 12.4661 2.71606 12.1292C2.71045 11.7979 2.93506 11.5732 3.27197 11.5732H4.18726V10.6636C4.18726 10.3379 4.41187 10.1133 4.74316 10.1077C5.08008 10.1021 5.30469 10.3267 5.30469 10.6636V11.5732H6.22559C6.55127 11.5732 6.77588 11.7979 6.77588 12.1292C6.77588 12.4661 6.55127 12.6907 6.22559 12.6907H5.30469V13.6172C5.30469 13.9429 5.08008 14.1675 4.74316 14.1675Z"})})},59177:(e,t,o)=>{o.d(t,{L:()=>we,g:()=>M});o(725707),o(500234);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(564134),l=()=>o(716605),s=()=>o(752903),c=()=>o(465546),u=()=>o(630714),d=()=>o(34662),p=()=>o(204132),m=()=>o(76394),g=()=>o(387652),y=()=>o(100183),h=()=>o(718522),f=()=>o(271142),v=()=>o(559637),x=()=>o(699773),b=()=>o(82954),S=()=>o(837809),C=()=>o(434406),A=()=>o(523365),k=o(163643);function M(e){const{token:t,disabled:o,setCurrentTokens:n,currentSimpleFormulaValueTokens:M,context:j,parentRecordStore:T}=e,I=(0,i().Y0)(),{typecheckResult:w}=(0,f().YC)(),_=(0,a().K8)((()=>{if("collection"===j.type)return(0,A().aS)(j)}),[j]),P=(0,a().K8)((()=>{if("collection"===j.type)return j.collectionStore.getSchema()[j.property]}),[j]);if("string"==typeof t){if(!P||!(0,r().DQ)(P))return null;const e=(0,l().jy)((null==P?void 0:P.options)??[],t);if(!e)return(0,k.jsx)(g().A,{isSingle:!1,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},`deleted_option_value_${t}`);const i={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!o,format:I.isMobile?s().NY.Medium:s().NY.Small,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}};if((0,r().DD)(P)){var B;const t=null===(B=P.groups)||void 0===B||null===(B=B.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===B?void 0:B.color;return(0,k.jsx)(S().q,{...i,groupColor:t})}return(0,k.jsx)(S().O,{...i})}if("boolean"==typeof t)return(0,k.jsx)(v().A,{checked:t,disabled:!0,size:16,checkSize:12,style:{marginBottom:6}},t.toString());if((0,d().rie)(t))return(0,k.jsx)(h().A,{handleRemoveToken:o?void 0:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},token:t});if((0,d().s1Y)(t)){const e=(0,d().iVq)(t).id,i=w&&p().Q.isSuccess(w)?(0,c().IV)(w.value.valueTypes,e):void 0;return i?(0,k.jsx)(C().F,{value:i,format:s().NY.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},style:{margin:"0 6px 6px 0"}}):null}if((0,d().qsB)(t)){const e=M[0],t=e&&(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().qsB)(e)?(0,d().K7D)(e):void 0;return t&&_?(0,k.jsx)(x().A,{value:t,dateFormat:_.dateFormat,timeFormat:_.timeFormat,style:{marginBottom:6}}):null}if((0,d().jIt)(t)){const e=(0,d().v55)(t);return e?(0,k.jsx)(b().A,{format:I.isMobile?s().NY.Medium:s().NY.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:T,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},e):null}if((0,d().iz3)(t))return(0,k.jsx)(y().A,{token:t});(0,m().HB)(t)}o(358848),o(91270);var j=()=>o(512040),T=()=>o(498248);function I(){const e=(0,f().YC)(),{menuStore:t}=(0,n.useContext)(T().S),{automationActionId:o,insertionPoint:i}=(0,a().K8)((()=>{const e=null==t?void 0:t.getCurrentTab();return{automationActionId:"eventActionProperty"===(null==e?void 0:e.type)?e.actionId:void 0,insertionPoint:null==t?void 0:t.getInsertionPoint()}}),[t]),r=(0,a().K8)((()=>{var t;return o?null===(t=e.automationStore)||void 0===t?void 0:t.findActionStoreById(o):function(e,t){if(!e)return;const o=e.getActionIds(),n=e.getActionStores();if(!t)return;if("beforeActionId"in t){const e=o.indexOf(t.beforeActionId)-1;return e<=0?n.at(0):n.at(e)}if("afterActionId"in t){const e=o.indexOf(t.afterActionId);if(-1===e)return;return n.at(e+1)}(0,m().HB)(t)}(e.automationStore,i)}),[o,i,e.automationStore]);(0,n.useEffect)((()=>{if(e.defined&&p().Q.isSuccess(e.typecheckResult)){const{automationStore:t,contextType:o,typecheckResult:n}=e;return j().A.focus({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r}),function(){j().A.blur({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r})}}}),[r,e])}var w=()=>o(863969),_=()=>o(622286),P=()=>o(475077),B=()=>o(234887),R=()=>o(560015),V=()=>o(353313),E=(o(362833),o(403517),()=>o(174114)),D=(o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(491955),o(244387),()=>o(752597)),F=()=>o(807912),O=()=>o(653998),N=()=>o(188877),L=()=>o(975392),W=()=>o(128192),z=()=>o(485951),K=()=>o(797715),H=()=>o(210466),U=()=>o(237692);function Y(e){let{disabled:t,handleRemoveToken:o,propertySchema:a,token:c}=e;const u=(0,i().Y0)(),d=(0,n.useCallback)((()=>{o&&o(c)}),[o,c]);if("string"!=typeof c||!a||!(0,r().DQ)(a))return null;const p=(0,l().jy)((null==a?void 0:a.options)??[],c);if(!p)return(0,k.jsx)(g().A,{isSingle:!1,showRemoveButton:!t,onClickRemove:d},`deleted_option_value_${c}`);if((0,r().DD)(a)){var m;const e=null===(m=a.groups)||void 0===m||null===(m=m.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(p.id)})))||void 0===m?void 0:m.color;return(0,k.jsx)(S().q,{color:p.color,format:u.isMobile?s().NY.Medium:s().NY.Small,groupColor:e,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}return(0,k.jsx)(S().O,{color:p.color,format:u.isMobile?s().NY.Medium:s().NY.Small,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}var G=()=>o(640979),q=()=>o(935091),X=()=>o(858023),$=()=>o(975515),J=()=>o(743668),Q=()=>o(88271),Z=()=>o(24e3),ee=()=>o(360234),te=()=>o(535906);function oe(e){let{isChecked:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r}=e;const l=(0,i().Y0)();return(0,k.jsx)(te().A,{...n,..."single"===o?{isChecked:t}:{},..."multi"===o?{icon:(0,k.jsx)(v().A,{checked:t,size:14,onClick:a})}:{},title:(0,k.jsx)(S().O,{value:r.value,color:r.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:l.isMobile?s().NY.Large:s().NY.Small}),isTokenTitle:!0})}function ne(e){let{isChecked:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r,group:l}=e;const c=(0,i().Y0)();return(0,k.jsx)(te().A,{...n,..."single"===o?{isChecked:t}:{},..."multi"===o?{icon:(0,k.jsx)(v().A,{checked:t,size:14,onClick:a})}:{},title:(0,k.jsx)(S().q,{color:r.color,format:c.isMobile?s().NY.Large:s().NY.Small,groupColor:null==l?void 0:l.color,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:r.value},r.value),isTokenTitle:!0})}function ie(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,menuProps:g,onChange:y,onClose:h,showClearButton:f=!1,showInputMenuItem:v=!1,showReplaceAddRemoveToggle:x=!1,type:b,value:S,parentRecordStore:C}=e,A=(0,i().Y0)(),M=(0,E().IS)((e=>({replaceAddRemoveToggleButton:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}})),[]),{footer:j,groupedItems:T,menuListStore:I,noResultsMessage:w,replaceAddRemoveToggleButton:_,searchInput:P,selectItems:B,valueItems:R}=function(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:g,onClose:y,showClearButton:h,showReplaceAddRemoveToggle:f,type:v,value:x}=e,[b,S]=(0,n.useState)(""),C=(0,a().uB)(void 0,H().A),A=(0,i().Y0)(),M=(0,O().tz)(),{collectionStore:j,property:T}=s,I=(0,a().K8)((()=>j.getSchema()[T]),[j,T]),w=I&&(0,r().DD)(I),_=(0,a().K8)((()=>w?I.groups??[]:[]),[w,I]),P=(0,a().K8)((()=>I&&(0,r().DQ)(I)&&I.options||[]),[I]),B=(0,n.useMemo)((()=>l.filter((e=>(0,c().o5)(e.type,{type:"select",collection:v.collection,property:v.property})))),[l,v.collection,v.property]),R=(0,a().K8)((()=>({valueResults:b?(0,N().Ay)(b,B,(e=>e.kind===F().FormulaContextValueKind.ContextValue?e.name:"")):B,selectResults:b?(0,N().Ay)(b,P,(e=>e.value)):P})),[b,B,P]),V=(0,n.useCallback)((()=>{S(""),C.setState({...C.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[C]),E=(0,n.useCallback)(((e,o)=>{g(e||x,o||t)}),[t,g,x]),G=(0,n.useCallback)((()=>{p&&D().default.afterNextFlush((()=>{y()}))}),[p,y]),q=(0,n.useCallback)((e=>{E({type:"simple",value:p?(0,u().toSimpleFormulaSingleValue)(e[0]):(0,u().toSimpleFormulaArrayValue)(e)}),G(),V()}),[E,p,G,V]),X=(0,n.useCallback)((()=>{q(o.slice(0,o.length-1))}),[o,q]),$=(0,n.useCallback)((e=>{q((0,u().simpleFormulaValueWithoutToken)(o,e))}),[o,q]),J=(0,n.useMemo)((()=>L().oE(o.map(((e,t)=>(0,k.jsx)(Y,{disabled:!1,handleRemoveToken:$,propertySchema:I,token:e},`select_option_token_${t}`))))),[o,$,I]),Q=(0,n.useMemo)((()=>new Set(L().oE(o.map((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().s1Y)(e)&&(0,d().iVq)(e).id))))),[o]),Z=(0,n.useMemo)((()=>L().oE((R.valueResults??[]).map((e=>{const t=e.kind===F().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!Q.has(t))return{action:p?"replace":"append",currentSimpleFormulaValueTokens:o,onCheckboxClick:G,id:t,isStatusProperty:Boolean(w),setCurrentTokens:q,value:e}})))),[Q,o,G,p,w,R.valueResults,q]),ee=p?"single":"multi",te=(0,n.useMemo)((()=>L().oE(R.selectResults??[]).reduce(((e,t)=>{const n=Boolean(o.find((e=>"string"==typeof e&&e===t.value)));return e[t.id]={isChecked:n,checkType:ee,group:void 0,id:t.id,isStatusProperty:Boolean(w),onCheckboxClick:()=>{q(p?n?[]:[t.value]:n?(0,u().simpleFormulaValueWithoutToken)(o,t.value):[...o,t.value]),p&&D().default.afterNextFlush((()=>{y()}))},option:t},e}),{})),[ee,o,p,w,y,R.selectResults,q]),oe=(0,n.useMemo)((()=>Object.values(te)),[te]),ne=(0,n.useMemo)((()=>_.map((e=>({items:(e.optionIds??[]).map((e=>te[e])).filter(m().O9),group:e})))),[te,_]),ie=_.length>0&&0===ne.length||0===_.length&&0===oe.length,ae=(0,k.jsx)("div",{style:{...!A.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,k.jsx)(K().Ay,{dontShowBorderBottom:A.isAndroid,focus:!A.isMobile||void 0,focusAfterAnimation:!0,format:K().le.FilterValue,onChange:e=>S(e.target.value),onClearButtonClick:()=>q([]),onRemoveLastToken:X,placeholder:M.formatMessage(W().D.searchPlaceHolder),showClearButton:h,tokens:J,value:b})}),re=(0,k.jsx)(z().A,{value:x,onChange:E}),le=(0,k.jsx)(U().A,{action:t,handleOnChange:E});return{footer:re,groupedItems:ne,menuListStore:C,noResultsMessage:ie&&M.formatMessage(W().D.noResults),replaceAddRemoveToggleButton:Boolean(f)&&le,searchInput:ae,selectItems:oe,valueItems:Z}}({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:y,onClose:h,showClearButton:f,showReplaceAddRemoveToggle:x,type:b,value:S})||{},V=(0,n.useMemo)((()=>R.map((e=>{const{annotation:t,itemAction:o}=(0,ee().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,k.jsx)(Z().A,{annotation:t,disabled:!1,formulaTypecheckContextValues:l,menuArgs:e,parentRecordStore:C}),action:o}}))),[l,R,C]),{groupedMenuItems:te,selectMenuItems:ie}=(0,n.useMemo)((()=>{let e=[],t=[];return T.length>0?e=T.map((e=>{let{group:t,items:o}=e;return{key:t.name,render:e=>(0,k.jsx)(Q().A,{...e,title:t.name,topBorder:!0}),items:o.map((e=>({key:e.id,render:t=>(0,k.jsx)(ne,{...t,isChecked:e.isChecked,checkType:e.checkType,group:e.group,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick})))}})):t=B.map((e=>({key:e.id,render:t=>(0,k.jsx)(oe,{...t,isChecked:e.isChecked,checkType:e.checkType,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick}))),{groupedMenuItems:e,selectMenuItems:t}}),[T,B]),ae=[...V,...ie];let re,le=[];ae.length>0&&le.push({key:"options",render:e=>(0,k.jsx)(Q().A,{...e}),items:ae}),te.length>0&&(le=[...le,...te]),re=A.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(J().DoneMenuText,{}),onClickRight:h,footer:j&&(0,k.jsx)(Q().A,{topBorder:!0,children:j})}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,footer:j&&(0,k.jsx)(Q().A,{topBorder:!0,children:j}),disableHeaderBorder:!0};const se=(0,k.jsxs)(k.Fragment,{children:[!A.isMobile&&(null==g?void 0:g.header),v&&(0,k.jsx)(Q().A,{children:P})]});return(0,k.jsxs)(q().A,{...re,header:se,children:[_&&(0,k.jsx)("div",{style:M.replaceAddRemoveToggleButton,children:_}),w&&(0,k.jsx)(Q().A,{children:(0,k.jsx)($().A,{title:w})}),le.length>0&&(0,k.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:le,store:I})]})}var ae=()=>o(736708),re=(o(113085),o(610931),()=>o(950635)),le=()=>o(145017),se=()=>o(409211),ce=()=>o(907721),ue=()=>o(413871),de=()=>o(701513),pe=()=>o(103151),me=()=>o(415806);const ge=(0,O().YK)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}});function ye(e){const{args:t,isChecked:o,checkType:n,context:g,disabled:h,onCheckboxClick:x,parentRecordStore:b,token:C}=e,A=(0,i().Y0)(),M=(0,a().K8)((()=>{if((0,u().isAnnotationSimpleValueToken)(C)&&(0,d().rie)(C)){const e=(0,d().NcG)(C);if(e)return(0,re().xC)({pointer:{table:se().oo,id:e},getRecordValue:b.getRecordModel})}}),[b.getRecordModel,C]),j=(0,a().K8)((()=>g.collectionStore.getSchema()[g.property]),[g]),T=(0,a().K8)((()=>j&&(0,r().DQ)(j)?j.options??[]:[]),[j]),I=(0,a().K8)((()=>j&&(0,r().DD)(j)?j.groups??[]:[]),[j]),{typecheckResult:w}=(0,f().YC)(),_=(0,E().IS)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[]),P=Boolean(j&&(0,r().DD)(j)),B="single"===n?{isChecked:o}:"multi"===n?{icon:(0,k.jsx)(v().A,{style:h?_.disabledMenuItem:void 0,checked:o,size:14,onClick:x,disabled:h})}:{};if("string"==typeof C){if(P){const e=(0,l().jy)(T,C),o=I.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?(0,k.jsx)(te().A,{...t,...B,title:(0,k.jsx)(S().q,{format:A.isMobile?s().NY.Large:s().NY.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},C),isTokenTitle:!0,disabled:h,style:h?_.disabledMenuItem:void 0,...t}):null}{const e=(0,l().jy)(T,C);return e?(0,k.jsx)(te().A,{...t,...B,title:(0,k.jsx)(S().O,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:A.isMobile?s().NY.Large:s().NY.Small}),isTokenTitle:!0,disabled:h,style:h?_.disabledMenuItem:void 0,...t}):null}}if("boolean"==typeof C)return null;if((0,d().rie)(C))return null!=M&&M.asActor&&M.table===se().oo?(0,k.jsx)(te().A,{...t,...B,title:h?(0,k.jsx)(pe().A,{renderTooltip:()=>(0,k.jsx)(O().sA,{...ge.maximumPeopleSelectedTooltip}),placement:ce().W.Right,render:e=>(0,k.jsx)("div",{style:{width:"100%"},...e,children:(0,k.jsx)(me().t_,{isSingle:!0,shouldShrink:!0,format:A.isMobile?me().t_.Format.Large:me().t_.Format.Medium,userValue:M.asActor})})}):(0,k.jsx)(me().t_,{isSingle:!0,shouldShrink:!0,format:A.isMobile?me().t_.Format.Large:me().t_.Format.Medium,userValue:M.asActor}),disabled:h,style:h?_.disabledMenuItem:void 0,isTokenTitle:!0}):null;if((0,d().s1Y)(C)){const e=(0,d().iVq)(C).id,n=w&&p().Q.isSuccess(w)?(0,c().IV)(w.value.valueTypes,e):void 0;return n?(0,k.jsx)(Z().A,{isChecked:o,contextValue:n,disabled:Boolean(h),menuArgs:t,parentRecordStore:b}):null}if((0,d().qsB)(C))return null;if((0,d().jIt)(C)){const e=(0,d().v55)(C);if(!e)return null;const n=ue().Bv.createChildStore(b,{id:e,table:le().ev});return(0,k.jsx)(de().A,{store:n,isChecked:o,hidePath:!0,...t})}if((0,d().iz3)(C))return(0,k.jsx)(y().A,{token:C});(0,m().HB)(C)}function he(e){const{currentSimpleFormulaValueTokens:t,value:o,setCurrentTokens:n,action:i,context:a,checkType:r,onCheckboxClick:l,isDisabled:s,parentRecordStore:c}=e;if(o.kind!==F().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");const p=Boolean(t.find((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().s1Y)(e)&&(0,d().iVq)(e).id===o.id))),m=(0,d().CA$)({id:o.id}),g=()=>{n("append"===i?p?(0,u().simpleFormulaValueWithoutToken)(t,m):[...t,m]:[m]),null==l||l()};return{key:o.id,render:e=>(0,k.jsx)(ye,{disabled:s,token:m,args:e,isChecked:p,checkType:r,context:a,onCheckboxClick:g,parentRecordStore:c}),action:g}}function fe(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,O().tz)(),m=(0,i().Y0)(),g=a.filter((e=>"checkbox"===e.type.type)),y=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),h=(0,n.useCallback)((e=>{y(e),s()}),[y,s]),f=L().oE(g.map((e=>he({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:h,action:"replace",context:t,checkType:"single",parentRecordStore:c})))),v=[],x=o.some((e=>!0===e)),b=[...f,...[{key:0,render:e=>(0,k.jsx)(te().A,{title:(0,k.jsx)(O().sA,{...W().D.unchecked}),isChecked:!x,...e}),action:()=>{h([!1])}},{key:1,render:e=>(0,k.jsx)(te().A,{title:(0,k.jsx)(O().sA,{...W().D.checked}),isChecked:x,...e}),action:()=>{h([!0])}}]],S=void 0!==(null==r?void 0:r.header)?r.header:(0,k.jsx)(Q().A,{style:{paddingBottom:0},title:p.formatMessage(W().D.genericMenuHeader)}),C=Boolean(S);v.push({key:"checkbox",render:e=>(0,k.jsx)(Q().A,{...e,topBorder:C}),items:b});const A=(0,k.jsx)(Q().A,{topBorder:!0,children:(0,k.jsx)(z().A,{onChange:l,value:d})});let M;M=m.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(J().DoneMenuText,{}),onClickRight:s,footer:A}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,disableHeaderBorder:!0,header:S,footer:A};const j={...M,...r,header:m.isMobile?null:S};return(0,k.jsx)(q().A,{...j,children:(0,k.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:v})})}var ve=()=>o(348588),xe=()=>o(397791),be=()=>o(871002),Se=()=>o(969338),Ce=()=>o(205207),Ae=()=>o(782422),ke=()=>o(129978),Me=()=>o(209684),je=()=>o(356813);function Te(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:i,onClose:r,setCurrentTokens:l,setInDatePicker:s}=e,c=o[0],p=c&&(0,u().isAnnotationSimpleValueToken)(c)&&d().qsB(c)?d().K7D(c):void 0,m=(0,O().tz)(),g=(0,a().O$)(Ae().XX),y=(0,n.useCallback)((()=>{s(!1)}),[s]),h=(0,n.useCallback)((e=>{e&&(0,be().kC)(e)?l([d().Ww9(e)]):l([])}),[l]),f=(0,E().IS)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.text.secondary,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),v=(0,a().K8)((()=>(0,A().aS)(t)),[t]);return(0,k.jsx)(ke().u2,{dependency:Ce().cm,children:e=>{let{DatePropertyMenu:t}=e;return(0,k.jsx)(t,{firstDayOfWeek:g,value:p,canConfigureCollection:!1,onChangeValue:h,dateFormat:v.dateFormat,timeFormat:v.timeFormat,onDismiss:r,disabled:i,shouldShowReminder:!1,header:(0,k.jsxs)("div",{style:f.header,children:[(0,k.jsx)(je().A,{ariaLabel:m.formatMessage(W().D.back),icon:Se().L,onClick:y,style:f.iconWrap,iconStyle:f.icon}),(0,k.jsx)("span",{style:f.title,children:(0,k.jsx)(O().sA,{...W().D.pickADate})}),(0,k.jsx)(Me().p,{onClick:r,isBlue:!0,children:(0,k.jsx)(J().DoneMenuText,{})})]}),isTemplatePage:!1})}})}function Ie(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,O().tz)(),m=(0,i().Y0)(),[g,y]=(0,n.useState)(!1),h=a.filter((e=>"date"===e.type.type)),f=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),v=(0,n.useCallback)((e=>{f(e),s()}),[f,s]),x=(0,n.useCallback)((()=>{y(!0)}),[]),b=(0,n.useCallback)((()=>{f([]),s()}),[f,s]);if(g)return(0,k.jsx)(Te,{context:t,currentSimpleFormulaValueTokens:o,disabled:!1,onClose:s,setCurrentTokens:f,setInDatePicker:y});const S=void 0!==(null==r?void 0:r.header)?r.header:(0,k.jsx)(Q().A,{style:{paddingBottom:0},title:p.formatMessage(W().D.genericMenuHeader)}),C=L().oE(h.map((e=>he({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:v,parentRecordStore:c,action:"replace",context:t,checkType:"single"})))),A=[];if(C.length>0){const e=Boolean(S);A.push({key:"values",render:t=>(0,k.jsx)(Q().A,{topBorder:e,...t}),items:C})}const M=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Q().A,{topBorder:!0,children:[(0,k.jsx)(te().A,{icon:(0,k.jsx)(xe().I,{icon:ve().D,color:"secondary"}),title:(0,k.jsx)(O().sA,{...W().D.pickADate}),focused:!1,showExtensionArrow:!0,onClick:x}),(0,k.jsx)(z().A,{onChange:l,value:d})]}),o.length>0&&(0,k.jsx)(Q().A,{topBorder:!0,children:(0,k.jsx)(te().A,{title:(0,k.jsx)(O().sA,{...W().D.clear}),focused:!1,onClick:b})})]});let j;j=m.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(J().DoneMenuText,{}),onClickRight:s,footer:M}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,footer:M,disableHeaderBorder:!0};const T={...j,...r,header:m.isMobile?null:S};return(0,k.jsx)(q().A,{...T,children:(0,k.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:0,sections:A})})}function we(e){const{action:t,allowedFormulaReturnTypes:o,currentSimpleFormulaValueTokens:i,disableEmojiCommands:a,disableFormattingAndMentions:r,disableMobileActionBar:l,disableTemplateVariableMentions:s,formulaTypecheckContextValues:c,formulaValueContext:u,limit:d,menuProps:p,onChange:g,onClose:y,parentRecordStore:h,showClearButton:f,showInputMenuItem:v,showReplaceAddRemoveToggle:x,type:b,value:S}=e;I();const C="formula"===(null==S?void 0:S.type),A=(0,w().O)(),M=n.useCallback((()=>{g({type:"simple",value:null==S?void 0:S.value})}),[g,null==S?void 0:S.value]),j=(0,_().X)("collections_xws")?"cross_space_and_read_permissions":"read_permissions_only";return C&&A?(0,k.jsx)(P().A,{allowedReturnTypes:o,disabled:!1,formulaTypecheckContextValues:c,onBack:M,onChange:g,onClose:y,parentRecordStore:h,restrictUnaccessibleProperties:j,spaceId:A,value:S}):"person_array"===b.type?(0,k.jsx)(Be,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,formulaValueContext:u,limit:d,menuProps:p,onChange:g,onClose:y,showClearButton:f??!0,showInputMenuItem:v??!0,showFormulaValueItems:!0,showGenericHeader:!0,showReplaceAddRemoveToggle:x,showPersonCheckbox:x,getRecordModel:h.getRecordModel,value:S,parentRecordStore:h}):"collection"!==u.type?null:"text"===b.type?(0,k.jsx)(Pe,{currentSimpleFormulaValueTokens:i,disableEmojiCommands:a,disableFormattingAndMentions:r,disableMobileActionBar:l,disableTemplateVariableMentions:s,formulaTypecheckContextValues:c,menuProps:p,onChange:g,onClose:y,parentRecordStore:h,showGenericHeader:!0,value:S}):"number"===b.type?(0,k.jsx)(_e,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,menuProps:p,onChange:g,onClose:y,showGenericHeader:!0,value:S,parentRecordStore:h}):"checkbox"===b.type?(0,k.jsx)(fe,{context:u,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,menuProps:p,onChange:g,onClose:y,parentRecordStore:h,value:S}):"date"===b.type?(0,k.jsx)(Ie,{context:u,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,menuProps:p,onChange:g,onClose:y,parentRecordStore:h,value:S}):"block_array"===b.type?(0,k.jsx)(Re,{action:t,collection:"block_array"===b.type?b.collection:void 0,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,formulaValueContext:u,menuProps:p,onChange:g,onClose:y,showClearButton:f??!0,showFormulaValueItems:!0,showGenericHeader:!0,showInputMenuItem:v??!0,showReplaceAddRemoveToggle:x,value:S,parentRecordStore:h}):"select"===b.type?(0,k.jsx)(ie,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,formulaValueContext:u,isSingle:!0,menuProps:p,onChange:g,onClose:y,showClearButton:f??!0,showInputMenuItem:v??!0,type:b,value:S,parentRecordStore:h}):"select_array"===b.type?(0,k.jsx)(ie,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:c,formulaValueContext:u,isSingle:!1,menuProps:p,onChange:g,onClose:y,showClearButton:f??!0,showInputMenuItem:v??!0,showReplaceAddRemoveToggle:x,type:b,value:S,parentRecordStore:h}):void(0,m().HB)(b)}function _e(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s}=e;const{numberMenu:c}=(0,B().A)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s});return c}function Pe(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s}=e;const{textMenu:c}=(0,ae().A)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s});return c}function Be(e){let{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:y,value:h,parentRecordStore:f}=e;const{personArrayMenu:v}=(0,R().A)({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:y,value:h,parentRecordStore:f});return v}function Re(e){let{action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:y}=e;const{relationMenu:h}=(0,V().A)({action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:y});return h}},63463:(e,t,o)=>{e.exports=o.p+"edfba4a6d1ff7acd.png"},67558:(e,t,o)=>{o.d(t,{VY:()=>l,ZJ:()=>a,u3:()=>r});var n=()=>o(496985);class i extends(()=>o(129044))().default{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const a=new i,r=new(n().default)((()=>!1!==a.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),l=new(n().default)((()=>!1!==a.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},82954:(e,t,o)=>{o.d(t,{A:()=>V});var n=o(242343),i=()=>o(803290),a=()=>o(502852),r=()=>o(752597),l=()=>o(384221),s=()=>o(755786),c=()=>o(126451),u=()=>o(709237),d=o(163643);function p(e){const{blockStore:t,titleStyle:o,shouldWrap:i,recordTitleRef:a,disableTooltip:p}=e,m=(0,n.useRef)({getNode:()=>a.current}),g=(0,n.useCallback)((e=>{r().default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const o=e.getValue(),n=o?o[0][0].length:0,i={start:{index:n,store:e},end:{index:n,store:e}};l().setMultiSelection({multiSelection:i})}))}),[t]);return(0,d.jsx)(c().A,{style:{height:s().d0+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:g,children:(0,d.jsx)(u().A,{store:t,underline:!0,shouldWrap:i,style:o,ref:m,disableTooltip:p})})}var m=()=>o(653998),g=()=>o(975392),y=()=>o(868199),h=()=>o(477784),f=()=>o(636045);const v=(0,m().YK)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function x(e){const{blockStore:t,clickTitleBehavior:o,onTitleEnter:n,onTitleEsc:a}=e,r="edit"===o,l=(0,i().K8)((()=>t.getBlockTitleStore()),[t]);return(0,d.jsx)(f().A,{store:l,disabled:!r,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:n,onEsc:a,onTab:g().D_,placeholder:h().A.formatMessage(v.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:y().Os.none})}var b=()=>o(237385),S=()=>o(34662),C=()=>o(448316);const A=function(e){const{store:t,style:r,disableLinks:l,disableHover:s,isAndroid:c,externalIntegrations:u,canEdit:p,shouldWrap:g,tokenFormat:y}=e,h=(0,n.useRef)(null),f=(0,m().tz)(),v=(0,b().v3)(),x=(0,o(174114).DP)(),{isExternalIntegrationPageType:A,blockType:k,blockId:M,blockModel:j}=(0,i().K8)((()=>{const e=t.getModel();return{isExternalIntegrationPageType:Boolean(null==e?void 0:e.isType(o(762847).xd.externalObjectInstancePage)),blockType:t.getType(),blockId:t.id,blockModel:e}}),[t]),T=(0,i().K8)((()=>o(284320).A.getState()),[]),I=(0,n.useCallback)((()=>{if(!h||!h.current)return;const e=(0,S().bMp)(t.id),o=(0,S().wmz)(e);return{textValue:[o],tokenIndex:0,textToken:o,node:h.current}}),[h,t.id]),w=(0,n.useCallback)((e=>{if(s)return;const o=I(),n=t.getTitleStore();n&&o&&C().xE({environment:v,event:e,interactiveToken:o,store:n,canEdit:p})}),[s,I,t,v,p]),_=(0,n.useCallback)((e=>{const o=I(),n=t.getTitleStore();n&&o&&!s&&C().HH({environment:v,event:e,interactiveToken:o,store:n,canEdit:p})}),[I,t,s,v,p]),P=t.getRecordModel,B=M,R=(0,o(441165).FN)(v),V=o(927685).A.domainBaseUrl,E=v.currentUser.id,D=!l,F=(0,i().K8)((()=>{if(j)return(0,o(123047).gA)({blockModel:j,shouldWrap:g,index:0,style:r,disableHover:s,disableLinks:l,isAndroid:c,theme:x,getRecordModel:P,currentUserId:E,baseUrl:V,emojiType:R,externalIntegrations:u,classNames:[],intl:f,emojiData:T,stopLinkPropagation:D,tokenFormat:(0,o(250786).Ug)(y)})}),[j,g,r,s,l,c,x,P,E,V,R,u,f,T,D,y]);return B?"external_object_instance_page"!==k?null:A?(0,d.jsx)("span",{ref:h,onMouseOver:w,onMouseOut:_,onClick:D?a().kV:void 0,style:{width:"100%"},children:F}):null:null};function k(e){const{blockStore:t,shouldWrap:n,style:a,disableLinks:r,format:l}=e,s=(0,i().K8)((()=>(0,o(809811).q7)(t.getSyncedUri())),[t]),c=(0,i().O$)(o(773082).A.integrations),u=(0,b().v3)();return(0,d.jsx)(A,{shouldWrap:n,store:t,style:a,disableHover:r||!s,disableLinks:r||!s,isAndroid:u.device.isAndroid,externalIntegrations:c,canEdit:!0,tokenFormat:l})}var M=()=>o(219322);function j(e){const{format:t,showRemoveButton:n,onClickRemove:i}=e,{height:a,closeIconSize:r}=M().U[t];return n?(0,d.jsx)(c().A,{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"center",width:a,height:a,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,o(388732).l)({width:r,height:r,opacity:.5})}):null}var T=()=>o(712437),I=()=>o(314164),w=()=>o(749975),_=()=>o(29869),P=()=>o(485966);var B=()=>o(621641),R=()=>o(205670);const V=(0,n.forwardRef)((function(e,t){const{parentStore:a,blockId:r,shouldWrap:l,format:s,showRemoveButton:c,clickTitleBehavior:u,onClickRemove:p,titleStyle:m,onTitleEnter:g,onTitleEsc:y,index:h,noUnderline:f,disableTooltip:v,disableLinks:x}=e,b=o(413871).Bv.createChildStore(a,{table:o(145017).ev,id:r}),{style:S}=(0,M().t)(e),C=(0,n.useRef)(null),A=(0,n.useRef)(null),T="peek"===u;(0,n.useImperativeHandle)(t,(()=>b),[b]);const I=(0,i().K8)((()=>"external_object_instance_page"===b.getType()),[b]);if((0,o(731991).W)(b))return null;if(I)return(0,d.jsx)(k,{shouldWrap:l,blockStore:b,style:S,disableLinks:x,format:s});const w=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o(957881).w,{format:s,blockStore:b,clickTitleBehavior:u,shouldWrap:l}),(0,d.jsx)(D,{blockStore:b,recordTitleRef:C,clickTitleBehavior:u,shouldWrap:l,titleStyle:m,noUnderline:f,onTitleEnter:g,onTitleEsc:y,index:h,disableTooltip:v})]});return(0,d.jsxs)("div",{style:S,ref:A,children:[T?(0,d.jsx)(E,{blockStore:b,relationTokenStyle:S,children:w}):w,(0,d.jsx)(j,{showRemoveButton:c,onClickRemove:p,format:s})]})}));function E(e){let{blockStore:t,relationTokenStyle:r,children:l}=e;const{blockUrlPage:s,blockUrlPeek:c}=function(e){const t=(0,b().v3)(),o=(0,w().Ks)(),n=(0,i().K8)((()=>(0,_().Ay)({store:e,fullyQualified:!1,pageVisitSource:T().y8.LinkInPage})),[e]);return{blockUrlPeek:(0,i().K8)((()=>{const{mainEditorCurrentBlockStore:n}=P().default.state;return I().wy({environment:t,store:e,mainEditorCurrentBlockStore:n,collectionContextStore:o,fullyQualified:!1})}),[t,e,o]),blockUrlPage:n}}(t),u=(0,n.useMemo)((()=>({display:r.display,height:r.height,alignItems:r.alignItems})),[r]);return(0,d.jsx)(o(579494).A,{href:s,metaHref:c,onClick:a().kV,style:u,children:l})}function D(e){const{blockStore:t,clickTitleBehavior:n,onTitleEnter:a,onTitleEsc:r,index:l,recordTitleRef:s,titleStyle:c,shouldWrap:u,noUnderline:m,disableTooltip:g}=e,y=(0,o(248584).Sm)(t),h="edit"===n&&!y,f=function(e){return(0,i().K8)((()=>{var t;const o=R().default.state;return"editing"===o.mode&&(null===(t=(0,B().H7)(o.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}(t);return h?f&&a&&l?(0,d.jsx)(x,{blockStore:t,clickTitleBehavior:n,onTitleEnter:a,onTitleEsc:r}):(0,d.jsx)(p,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:u,disableTooltip:g}):(0,d.jsx)(o(399631).Y,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:u,noUnderline:m,disableTooltip:g})}},85208:(e,t,o)=>{o.d(t,{g:()=>l});o(242343);var n=()=>o(403026),i=()=>o(281030),a=o(163643);const r=16/(0,i().N)("small");function l(e){const{variant:t}=e,o=function(e){return(0,i().N)(e)*r}(t);return(0,a.jsx)(a.Fragment,{children:(0,n().X)({width:o,pointerEvents:"none"})})}},96718:(e,t,o)=>{o.d(t,{l:()=>a});var n=()=>o(706788);const i={[n().e1]:"collection_connected_property_figma",[n().Hd]:"collection_connected_property_google_drive",[n().ob]:"collection_connected_property_github",[n().k0]:"collection_connected_property_zendesk",[n().bh]:"collection_synced_database_github",[n().MN]:"collection_synced_database_asana",[n().Fo]:"collection_synced_database_gitlab",[n().me]:"collection_synced_database_jira",[n().F6]:"collection_synced_database_jira_workspace",[n().Fv]:"collection_synced_database_jira_datacenter"};function a(e){if(e)return i[e]}},100183:(e,t,o)=>{o.d(t,{A:()=>d});o(242343);var n=()=>o(174114),i=()=>o(752903),a=()=>o(246169),r=()=>o(237434),l=()=>o(167089),s=()=>o(34662),c=()=>o(151258),u=o(163643);function d(e){let{handleRemoveToken:t,token:o,type:d,format:p,style:m,isDisabled:g}=e;const y=(0,s().GCe)(o).name,h=(0,n().DP)();if(!y)return null;let f;switch(d){case"person":f=l().M;break;case"email":f=r().J;break;default:f=a().y}return(0,u.jsx)(c().Ay,{title:y,renderAvatar:e=>f({width:e,height:e,padding:2,marginRight:6}),style:{background:h.accentColors.gray[75],padding:"2px 4px",...m},showRemoveButton:Boolean(t)&&!g,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},format:p??i().NY.Small,shouldShrink:!0,isSingle:!1})}},105886:(e,t,o)=>{o.d(t,{A:()=>s,q:()=>l});var n=o(242343),i=()=>o(653998),a=()=>o(514799),r=o(163643);const l=300,s=(0,n.forwardRef)((function(e,t){const s=(0,i().tz)(),c=(0,o(486905).Jj)(),u=(0,o(174114).IS)((t=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",cursor:e.disableDrag?"pointer":"grab",width:e.width??a().Z,height:e.height??a().S,borderRadius:4,fill:c?t.icon.secondary:t.lightIconColor,...e.style},text:{color:t.text.contrastSecondary}})),[e.disableDrag,e.width,e.height,e.style,c]);const{onClick:d}=e,p=(0,n.useCallback)((e=>{d&&(e.preventDefault(),d(e))}),[d]),m=(0,n.useCallback)((n=>(0,r.jsx)(o(126451).A,{ref:t,ariaLabel:s.formatMessage({id:"dragHandleButton.ariaLabel",defaultMessage:"Drag"}),role:e.role,style:u.buttonStyle,onClick:e.onClick,onContextMenu:p,disallowTabbing:e.disallowTabbing,...n,children:(0,o(916809).i)({width:14,height:14,...e.iconStyle})})),[p,s,e.disallowTabbing,e.iconStyle,e.onClick,e.role,t,u.buttonStyle]);return e.disableTooltip?m({}):(0,r.jsx)(o(103151).A,{placement:e.tooltipPlacement??o(907721).W.Bottom,delayThreshold:l,renderTooltip:function(){return(0,r.jsxs)("div",{style:{textAlign:"center"},children:[!e.disableDrag&&(0,r.jsx)(i().sA,{defaultMessage:"Drag <medium>to move</medium>",id:"dragHandleButton.dragPrompt.text",values:{medium:e=>(0,r.jsx)("span",{style:u.text,children:e})}}),!e.hideClickMessage&&(0,r.jsx)("div",{children:(0,r.jsx)(i().sA,{defaultMessage:"Click <medium>to open menu</medium>",id:"dragHandleButton.clickPrompt.text",values:{medium:e=>(0,r.jsx)("span",{style:u.text,children:e})}})})]})},render:m})}))},130081:(e,t,o)=>{o.d(t,{UQ:()=>m,gL:()=>y});o(610931),o(725707),o(500234),o(771702);var n=()=>o(810111),i=()=>o(769884),a=()=>o(33715),r=()=>o(220865),l=()=>o(846287),s=()=>o(996151),c=()=>o(946854),u=()=>o(293665),d=()=>o(927999),p=()=>o(84543);function m(e){let{environment:t,transaction:o,layoutStore:n,position:s,updatedModule:c,sessionId:u}=e;const d=a().Zm[s.area],m=n.getRawModules();if("form_conditional_modules"===d){const e=null==m?void 0:m[d];if(!(null==e?void 0:e[s.moduleId]))throw new Error("Unable to find module being updated.");return void p().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){p().applyOperation({transaction:e,store:n,operation:i().N4X.updateModuleInArea({pointer:n.pointer,area:d,module:(0,r().Lv)(c)})})},userAction:"BuilderLayoutModules.updateModule"})}if(!m)throw new Error("Unable to find modules");const g=(0,l().LC)(m,(e=>e.id===s.moduleId));if(!g||g.area!==d)throw new Error("Unable to find module being updated.");p().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){p().applyOperation({transaction:e,store:n,operation:i().N4X.updateModuleInArea({pointer:n.pointer,module:(0,r().Lv)(c),..."views_main_tab_modules"===g.area?{area:g.area,viewId:g.viewId}:{area:g.area}})})},userAction:"BuilderLayoutModules.updateModule"})}function g(e){var t,o,n;let{collectionStore:i,layoutStore:a}=e;const r=new Map,l=i.getFormat(),s=[...null===(t=a.getModules())||void 0===t?void 0:t.page_main,...null===(o=a.getModules())||void 0===o?void 0:o.page_details],u=new Map;null===(n=l.property_visibility)||void 0===n||n.forEach((e=>{u.set(e.property,e)})),s.forEach((e=>{if(!(0,c()._Q)(e))return(0,c().gx)(e)?(r.set(e.propertyId,{property:e.propertyId}),void u.set(e.propertyId,{property:e.propertyId,visibility:"show"})):void 0;e.propertyIds.forEach((e=>{r.set(e,{property:e}),u.set(e,{property:e,visibility:"show"})}))}));const d=i.getNormalizedPropertyGroups();var p;d?d.forEach((e=>{var t;null===(t=e.propertyIds)||void 0===t||t.forEach((e=>{r.has(e)||r.set(e,{property:e})}))})):null===(p=l.collection_page_properties)||void 0===p||p.forEach((e=>{r.has(e.property)||r.set(e.property,e)}));return{propertiesFormat:Array.from(r.values()),propertyVisibility:Array.from(u.values())}}function y(e){let{environment:t,transaction:o,collectionStore:a,layoutStore:r}=e;const{propertiesFormat:l,propertyVisibility:m}=g({collectionStore:a,layoutStore:r});p().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){const t=r.getBlockChildrenPointers(),o=r.getFormat(),g=r.firstModuleOfType("viewsMain");g&&(0,c().y6)(g)&&t.find((e=>u().L3.isEqual(e,g.collection_view_block_pointer)))&&p().applyOperation({transaction:e,store:r,operation:i().N4X.removeBlockChild(r.pointer,g.collection_view_block_pointer.id)});const y=null==o?void 0:o.previousViewsMainCollectionViewBlockPointer,h=y&&t.find((e=>u().L3.isEqual(e,y)));h&&p().applyOperation({transaction:e,store:r,operation:i().N4X.removeBlockChild(r.pointer,h.id)}),p().applyOperation({transaction:e,store:r,operation:i().N4X.setModulesByAreas(r.pointer,(0,s().K5)())}),p().applyOperation({transaction:e,store:r,operation:i().N4X.deleteFormat(r.pointer)});const f=a.getFormat(),{page_section_visibility:v}=f;d().zA({stores:[a],update:{property_groups:void 0,collection_page_properties:l,property_visibility:m,...v?{page_section_visibility:n().Zi}:void 0},transaction:e})},userAction:"BuilderLayoutModules.resetLayoutToDefault"})}},130935:(e,t,o)=>{o.d(t,{_:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("layout",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.39999 2.19999C2.28953 2.19999 2.19999 2.28953 2.19999 2.39998V11.5999C2.19999 11.7103 2.28953 11.7999 2.39999 11.7999H4.99997C5.11042 11.7999 5.19997 11.7103 5.19997 11.5999V2.39998C5.19997 2.28953 5.11042 2.19999 4.99997 2.19999H2.39999ZM1 2.39998C1 1.6268 1.62679 1 2.39999 1H4.99997C5.77316 1 6.39995 1.6268 6.39995 2.39998V11.5999C6.39995 12.3731 5.77316 12.9999 4.99997 12.9999H2.39999C1.62679 12.9999 1 12.3731 1 11.5999V2.39998ZM9 8.80036C8.88954 8.80036 8.8 8.88991 8.8 9.00036V11.6003C8.8 11.7108 8.88954 11.8003 9 11.8003H11.6C11.7105 11.8003 11.8 11.7108 11.8 11.6003V9.00036C11.8 8.88991 11.7105 8.80036 11.6 8.80036H9ZM7.60001 9.00036C7.60001 8.22717 8.2268 7.60037 9 7.60037H11.6C12.3731 7.60037 13 8.22717 13 9.00036V11.6003C13 12.3736 12.3731 13.0003 11.6 13.0003H9C8.2268 13.0003 7.60001 12.3736 7.60001 11.6003V9.00036ZM8.79994 2.39998C8.79994 2.28953 8.88949 2.19999 8.99994 2.19999H11.5999C11.7104 2.19999 11.7999 2.28953 11.7999 2.39998V4.99997C11.7999 5.11043 11.7104 5.19996 11.5999 5.19996H8.99994C8.88949 5.19996 8.79994 5.11043 8.79994 4.99997V2.39998ZM8.99994 1C8.22675 1 7.59995 1.6268 7.59995 2.39998V4.99997C7.59995 5.77316 8.22675 6.39995 8.99994 6.39995H11.5999C12.3731 6.39995 12.9999 5.77316 12.9999 4.99997V2.39998C12.9999 1.6268 12.3731 1 11.5999 1H8.99994Z"})})},137696:(e,t,o)=>{o.d(t,{$X:()=>a,H8:()=>r,x2:()=>i});var n=()=>o(76394);function i(e){return"event"===e||"recurrence"===e}function a(e){const t=e.getTrigger();return(0,n().O9)(t)&&i(t.type)}function r(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,n().HB)(e)}},151028:(e,t,o)=>{o.d(t,{Ud:()=>z});o(725707),o(491955),o(403517);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(911575),s=()=>o(100160),c=()=>o(903012),u=()=>o(539032),d=()=>o(630714),p=()=>o(21164),m=()=>o(653998),g=()=>o(975392),y=()=>o(76394),h=()=>o(759625),f=()=>o(384221),v=()=>o(421338),x=()=>o(535906),b=()=>o(273520),S=()=>o(59175),C=()=>o(935091),A=()=>o(858023),k=()=>o(88271),M=()=>o(146447),j=()=>o(708029),T=()=>o(213517),I=()=>o(836331),w=()=>o(271142),_=()=>o(765618),P=()=>o(459845),B=()=>o(738355),R=()=>o(982008),V=()=>o(265405),E=()=>o(441911),D=()=>o(179701),F=()=>o(284573),O=()=>o(643919),N=()=>o(981793),L=o(163643);const W=(0,m().YK)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},toggleActionLabel:{id:"automations.AutomationActionSetPropertiesSection.toggleAction.label",defaultMessage:"Toggle"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"},automationActionPropertyDeleted:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyDeleted",defaultMessage:"This property was deleted"},automationActionPropertyUnsupported:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyUnsupported",defaultMessage:"This property is unsupported"}});function z(e){const{actionStore:t,collectionStore:o,disabled:r,showSetPropertyActions:l}=e,s=(0,i().v3)(),{automationStore:c}=(0,w().EC)(),{maybePersistedTransactionActions:u}=(0,B().b)(),d=(0,a().K8)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.values)??{}}),[t]),p=(0,a().K8)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.properties)??[]}),[t]),m=(0,n.useCallback)((e=>{const o=p.concat([e]),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",perform:e=>{K({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),g=(0,n.useCallback)(((e,o)=>{const n=p.indexOf(e);if(-1===n)return;const i=p.slice(0);i[n]=o;const a={...d,[o]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",perform:e=>{K({configStore:t.getConfigStore(),properties:i,transaction:e,values:a})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),y=(0,n.useCallback)((e=>{const o=p.filter((t=>t!==e)),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",perform:e=>{K({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),h=(0,n.useCallback)(((e,o)=>{const n={...d,[e]:o};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",perform:e=>{K({configStore:t.getConfigStore(),properties:p,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[d,u,s,t,c,p]);return(0,L.jsx)(H,{actionStore:t,collectionStore:o,disabled:r,onPropertyAdd:m,onPropertyChange:g,onPropertyRemove:y,onPropertyValueChange:h,showSetPropertyActions:l})}function K(e){const{configStore:t,properties:o,transaction:n,values:i}=e;h().zv({store:t,data:{properties:o,values:i},transaction:n})}function H(e){const{actionStore:t,collectionStore:o,onPropertyAdd:n,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,disabled:u,showSetPropertyActions:d}=e,p=(0,r().IS)((e=>({addPropertyRow:{display:"flex",alignItems:"center"}})),[]),m=(0,a().K8)((()=>t.getConfigStore().getKeyStore("properties").getValue()??[]),[t]),g=(0,a().K8)((()=>(0,l().m7)({collectionFormat:o.getFormat(),collectionSchema:o.getSchema(),filter:e=>{let[t]=e;return!m.includes(t)},spaceId:o.getSpaceId(),restrictCrossSpace:I().default.checkGate({gateName:"collections_xws"})})),[o,m]),y=0===g.length;return(0,L.jsxs)(L.Fragment,{children:[m.length>0&&(0,L.jsx)(U,{actionStore:t,availablePropertyIds:g,collectionStore:o,disabled:u,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:d}),!u&&!y&&(0,L.jsx)("div",{style:p.addPropertyRow,children:(0,L.jsx)(O().l,{availablePropertyIds:g,currentValue:void 0,collectionStore:o,onChange:n,disabled:u,alreadyHaveProperties:m.length>0})})]})}function U(e){const{actionStore:t,availablePropertyIds:o,collectionStore:n,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:u,disabled:d}=e,{isMobile:p}=(0,i().Y0)(),m=p,g=(0,r().IS)((()=>({wrap:{alignItems:"start",columnGap:4,display:"grid",gridTemplateColumns:m?"100%":"160px 1fr",minWidth:0,rowGap:m?4:8},propertyValue:{...m?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...m?{fontSize:14,marginBlockEnd:0}:{}}})),[m]),[y,h]=(0,a().K8)((()=>{const e=t.getConfig();return[(null==e?void 0:e.properties)??[],(null==e?void 0:e.values)??{}]}),[t]);return(0,L.jsx)("div",{style:g.wrap,children:y.map(((e,i)=>{const a=i===y.length-1;return(0,L.jsx)(Y,{actionStore:t,availablePropertyIds:o,collectionStore:n,disabled:d,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,property:e,showSetPropertyActions:u,value:h[e],valueStyle:a?g.lastPropertyValue:g.propertyValue},e)}))})}function Y(e){const{actionStore:t,availablePropertyIds:o,collectionStore:i,disabled:g,onPropertyChange:y,onPropertyRemove:h,onPropertyValueChange:f,property:x,showSetPropertyActions:b,value:C,valueStyle:A}=e,k={type:"collection",collectionStore:i,property:x},M=(0,m().tz)(),j=(0,r().IS)((e=>({propertyName:{display:"flex"},propertyValue:{display:"flex",gap:4,minWidth:50,...A},propertyValueInput:{minWidth:50}})),[A]),I=(0,n.useMemo)((()=>{if("title"===x)return M.formatMessage(W.titlePlaceholder)}),[M,x]),P=(0,a().K8)((()=>i.getSchema()[x]||i.getDeletedSchema()[x]),[i,x]),R=(0,a().K8)((()=>Boolean(!i.getSchema()[x])),[i,x]),E=(0,a().K8)((()=>{if(P)return(0,d().setPropertyValueToSimpleFormulaReturnType)({table:p().Vl,id:i.id,spaceId:i.getSpaceId()},x,P)}),[i,P,x]),D=(0,n.useMemo)((()=>{if(P&&(0,l().I3)(P))return P.type}),[P]),F=(0,n.useMemo)((()=>P&&!(0,l().I3)(P)),[P]),z=null==C?void 0:C.value,K=(0,a().K8)((()=>(0,c().tz)(C)),[C]),{automationStore:H}=(0,w().EC)(),U=(0,a().K8)((()=>H.getSpaceId()),[H]),Y=(0,V().F)({actionId:t.id}),q=(0,a().K8)((()=>{if(D&&U)return(0,d().analyzeSimpleFormulaOrFormulaSync)({context:{allowedReturnTypes:l().Yy[D],handleDataRequest:(0,u().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:U,valueTypes:Y.slice(0),featureGates:(0,T().i)()},value:null==C?void 0:C.value})}),[t.getRecordModel,Y,U,D,null==C?void 0:C.value]),{suppressActionErrors:X}=(0,B().b)(),J=(0,n.useMemo)((()=>!X.includes(t.id)),[X,t]),{errorMessage:Q}=(0,_().useErrorComponentForAction)({actionId:t.id,errorKey:x,shouldShow:J}),Z=(0,n.useCallback)((e=>{y(x,e)}),[y,x]),ee=(0,n.useCallback)((()=>h(x)),[h,x]),te=(0,n.useCallback)((e=>{f(x,e)}),[f,x]),oe=(0,n.useCallback)((e=>{te({action:e,value:z})}),[z,te]),ne=(0,n.useCallback)((e=>{te({action:K,value:e})}),[K,te]);if(!U)return null;const ie=function(e){if("email"===e||"phone_number"===e||"url"===e)return{disableEmojiCommands:!0,disableFormattingAndMentions:!0};return{}}(D);let ae;return R?ae=(0,L.jsx)(m().sA,{...W.automationActionPropertyDeleted}):F?ae=(0,L.jsx)(m().sA,{...W.automationActionPropertyUnsupported}):Q&&(ae=Q),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{style:j.propertyName,children:(0,L.jsx)(O().l,{availablePropertyIds:o,currentValue:x,collectionStore:i,onChange:Z,disabled:g,onRemove:ee,errorMessage:ae})}),(0,L.jsxs)("div",{style:j.propertyValue,children:[!R&&b&&P&&s().M[P.type]&&(0,L.jsx)(G,{disabled:g,onChange:oe,value:K}),R?(0,L.jsx)(S().A,{disabled:!0,placeholder:M.formatMessage(W.automationActionPropertyDeleted)}):F?(0,L.jsx)(S().A,{disabled:!0,placeholder:M.formatMessage(W.automationActionPropertyUnsupported)}):D&&E?(0,L.jsxs)(v().Y1,{direction:"vertical",gap:7,style:j.propertyValueInput,children:[(0,L.jsx)($,{...ie,analyzedFormulaOutput:q,automationActionStore:t,disabled:g,disableMobileActionBar:!0,disableTemplateVariableMentions:!0,simpleFormulaContext:k,formulaTypecheckContextValues:Y,onChange:ne,parentRecordStore:t,placeholder:I,propertyType:D,spaceId:U,type:E,value:null==C?void 0:C.value}),q&&(0,L.jsx)(N().J,{analyzedFormulaOutput:q})]}):null]})]})}function G(e){const{disabled:t,onChange:o,value:n}=e,i=(0,r().IS)((e=>({button:{boxShadow:e.inputBoxShadow,minWidth:120}})),[]),a=(0,D().j)();return(0,L.jsx)(b().Ay,{popupType:a,alignmentToOrigin:b().yP.End,placementToOrigin:b().sx.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,L.jsx)(F().x,{...e,disabled:t,style:i.button,dropdownButtonType:"button",children:(0,L.jsx)(X,{action:n})}),render:e=>(0,L.jsx)(q,{onChange:o,parent:e,value:n})})}function q(e){const{value:t,onChange:o,parent:n}=e,i=(0,E().e)({width:250}),a=g().oE(c().Au.map(((e,i)=>({key:i,render:o=>(0,L.jsx)(x().A,{...o,disabled:!1,title:(0,L.jsx)(X,{action:e}),isChecked:t===e}),action:()=>{e!==t&&o(e),n.close()}}))));return(0,L.jsx)(C().A,{...i,children:(0,L.jsx)(A().Ay,{type:A().Oh.Vertical,sections:[{key:0,render:e=>(0,L.jsx)(k().A,{enableActionSheetTitle:!0,...e}),items:a}],initialFocus:0})})}function X(e){const{action:t}=e;return"replace"===t?(0,L.jsx)(m().sA,{...W.replaceActionLabel}):"append"===t?(0,L.jsx)(m().sA,{...W.appendActionLabel}):"remove"===t?(0,L.jsx)(m().sA,{...W.removeActionLabel}):"toggle"===t?(0,L.jsx)(m().sA,{...W.toggleActionLabel}):void(0,y().HB)(t)}function $(e){const{analyzedFormulaOutput:t={},automationActionStore:o,disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,parentRecordStore:g,placeholder:y,propertyType:h,simpleFormulaContext:v,spaceId:x,type:b,value:S}=e,{parseErrors:C=[],typeErrors:A=[]}=t,k=C.length>0||A.length>0,{onTextStoreSelect:T,onTextStoreUnselect:I}=(0,R().W)(o),w=(0,r().IS)((e=>({input:{width:"100%"}})),[]),_=(0,i().v3)(),P=(0,n.useCallback)((()=>{f().clear({environment:_})}),[_]);return"text"===b.type?(0,L.jsx)(M().Y,{allowedReturnTypes:l().Yy[h],disabled:a,disableEmojiCommands:s,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,onTextStoreSelect:T,onTextStoreUnselect:I,onTextEsc:P,parentRecordStore:g,spaceId:x,placeholder:y,style:w.input,shouldShowErrorStyles:k,value:S}):"number"===b.type?(0,L.jsx)(M().Y,{allowedReturnTypes:l().Yy[h],disabled:a,disableEmojiCommands:!0,disableInsertedDeletedAnnotations:!0,disableMentions:!0,disableMobileActionBar:!0,disableStyleAnnotations:!0,formulaTypecheckContextValues:p,onChange:m,onTextStoreSelect:T,onTextStoreUnselect:I,onTextEsc:P,parentRecordStore:g,spaceId:x,style:w.input,shouldShowErrorStyles:k,value:S}):(0,L.jsx)(j().U,{allowedReturnTypes:l().Yy[h],disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,parentRecordStore:g,placeholder:y,simpleFormulaContext:v,spaceId:x,type:b,value:S})}},151258:(e,t,o)=>{o.d(t,{Ay:()=>m,mI:()=>d,vb:()=>p});o(242343);var n=()=>o(174114),i=()=>o(752903),a=()=>o(388732),r=()=>o(653998),l=()=>o(31448),s=()=>o(126451),c=o(163643);const u=(0,r().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),d=i().NY,p={[i().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[i().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:16},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[i().NY.Inline]:{height:20,fontSize:14,closeIconSize:8,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:10,avatarSize:20}};function m(e){let{avatarSize:t,format:o,isSingle:i,onClickRemove:d,renderAvatar:m,showRemoveButton:g,shouldShrink:y,style:h,title:f}=e;const v=(0,r().tz)(),{height:x,fontSize:b,margin:S,marginEditState:C,closeIconSize:A,avatarSize:k}=p[o],M=t??k,j=(0,n().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:y?1:0,minWidth:0,height:x,borderRadius:6,fontSize:b,lineHeight:"120%",margin:i?0:g?C:S,...h}})),[b,x,i,S,C,y,g,h]);return(0,c.jsxs)("div",{style:j.root,children:[null==m?void 0:m(M),(0,c.jsx)("div",{className:"notranslate",style:{...l().RC},children:f}),g?(0,c.jsx)(s().A,{ariaLabel:void 0!==f?v.formatMessage(u.removeTokenLabel,{title:f}):v.formatMessage(u.removeTokenLabelGeneric),onClick:d,style:{display:"flex",alignItems:"center",justifyContent:"center",width:x,height:x,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,a().l)({width:A,height:A,opacity:.5})}):null]})}},151602:(e,t,o)=>{o.d(t,{A:()=>a});class n extends(()=>o(129044))().default{getInitialState(){return{}}}const i=new n;o(996094).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",i);const a=i},153642:(e,t,o)=>{o.d(t,{V:()=>a});var n=()=>o(803290),i=()=>o(485966);function a(){return(0,n().K8)((()=>{const{currentSpaceStore:e}=i().default.state;return(null==e?void 0:e.getMemberCountFromPublicSpaceData())??void 0}),[])}},155342:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,questionMarkCircleIcon:()=>a});o(242343);var n=o(163643);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M9.978 7.154c-.804 0-1.333.456-1.438.874a.625.625 0 0 1-1.213-.303c.28-1.121 1.44-1.82 2.65-1.82 1.365 0 2.714.905 2.714 2.298 0 .812-.49 1.477-1.13 1.872l-.755.516a.84.84 0 0 0-.381.677.625.625 0 1 1-1.25 0c0-.688.36-1.318.921-1.706l.003-.002.784-.535.014-.008c.374-.228.544-.537.544-.814 0-.459-.517-1.049-1.463-1.049m.662 6.336a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,n.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},a=(0,o(680369).wt)("questionMarkCircle",i)},157699:(e,t,o)=>{o.d(t,{c:()=>a});o(725707),o(324989),o(113085);var n=()=>o(803290),i=()=>o(405317);function a(e){const{automationStores:t,slackActionFeatureAvailability:o}=e,a=(0,n().K8)((()=>function(e,t){var o;return(0,i().e2)(e)&&"sunset"===(null==e||null===(o=e.expiry)||void 0===o?void 0:o.type)&&t}(o,function(e){const{automationStores:t}=e,o=null==t?void 0:t.flatMap((e=>null==e?void 0:e.getActionStores()));if(!o)return!1;return o.some((e=>"slack_notification"===(null==e?void 0:e.getType())))}({automationStores:t}))),[t,o]);return a}},170582:(e,t,o)=>{o.d(t,{r:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10 2.355a2.35 2.35 0 0 0-2.253 1.686 5.06 5.06 0 0 0-2.803 4.527v1.189c0 .919-.334 1.806-.939 2.498l-.818.935c-.881 1.007-.166 2.583 1.173 2.583h3.02a2.65 2.65 0 0 0 5.24 0h3.02c1.339 0 2.054-1.576 1.173-2.583l-.818-.935a3.8 3.8 0 0 1-.939-2.498v-1.19a5.06 5.06 0 0 0-2.803-4.526A2.35 2.35 0 0 0 10 2.355m1.5 13.418a1.55 1.55 0 0 1-2.998 0zM8.909 4.564A1.104 1.104 0 0 1 10 3.605c.556 0 1.017.415 1.091.96l.049.353.329.138a3.81 3.81 0 0 1 2.337 3.512v1.189c0 1.221.444 2.401 1.248 3.32l.818.936a.307.307 0 0 1-.232.51H4.36a.308.308 0 0 1-.232-.51l.818-.935a5.04 5.04 0 0 0 1.248-3.321v-1.19c0-1.58.963-2.936 2.337-3.511l.33-.138z"})},i=(0,o(680369).wt)("bell",n)},178063:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,plusIcon:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10 3.59a.66.66 0 0 1 .66.66v5.09h5.09a.66.66 0 0 1 0 1.32h-5.09v5.09a.66.66 0 0 1-1.32 0v-5.09H4.25a.66.66 0 0 1 0-1.32h5.09V4.25a.66.66 0 0 1 .66-.66"})},i=(0,o(680369).wt)("plus",n)},187406:(e,t,o)=>{o.d(t,{r:()=>l});var n=()=>o(237385),i=()=>o(803290),a=()=>o(548694),r=()=>o(485966);function l(){const e=(0,n().v3)();return(0,i().K8)((()=>{const{currentSpaceStore:t}=r().default.state;if(t)return(0,a().fD)({environment:e,spaceId:t.id})}),[e])}},194585:(e,t,o)=>{o.d(t,{n:()=>k,z:()=>C});o(610931),o(242343);var n=()=>o(803290),i=()=>o(174114),a=()=>o(505966),r=()=>o(73658),l=()=>o(916963),s=()=>o(758989),c=()=>o(242978),u=()=>o(584044),d=()=>o(130935),p=()=>o(40642),m=()=>o(76394),g=()=>o(511441),y=()=>o(327665),h=()=>o(622286),f=()=>o(328653),v=()=>o(940445),x=o(163643);const b=16;function S(e){let{icon:t,theme:o,size:n,style:a}=e;const l=(0,i().IS)((e=>({icon:{fill:(0,f().d)(t,e).icon.primary,...a}})),[t,a]);return(0,x.jsx)(r().p,{icon:t,theme:o,size:n,style:l.icon})}function C(e){var t;let{template:o,size:n,iconStyle:r}=e;const l=n??b,y=(0,i().IS)((()=>({icon:{width:l,height:l,...r}})),[l,r]),h=(0,i().DP)();if((0,a().cB)(o.templateId))return(0,u().L)(y.icon);const{type:f}=o;switch(f){case"property":return(0,x.jsx)(A,{template:o,iconSize:l,styles:y});case"collection_view":return(0,x.jsx)(g().h,{viewIcon:null===(t=o.value.format)||void 0===t?void 0:t.collection_view_icon,viewType:o.value.type,color:"lightGray",style:y.icon});case"layout":return(0,x.jsx)(x.Fragment,{children:(0,d()._)(y.icon)});case"block":return(0,x.jsx)(x.Fragment,{children:(0,p().b)(y.icon)});case"collection":case"compound":const e="collection"===o.type?o.value.targetCollection.icon:o.icon;if(!(0,s().T8)(e))throw new Error("Only Notion static icons are allowed for template icons");return(0,x.jsx)(S,{icon:e,theme:h,size:l,style:y.icon});case"automation":return(0,x.jsx)(x.Fragment,{children:(0,c().v)(y.icon)});default:(0,m().HB)(f)}}function A(e){let{template:t,iconSize:o,styles:a}=e;const r=(0,i().DP)(),s=(0,h().X)("nds_default_property_noticon"),c=(0,n().K8)((()=>{const{relatedCollectionTemplateId:e}=t;if("relation"===t.value.type&&e){return v().globalWorkflowTemplates.fromIdOfType({templateId:e,type:"collection"}).value.targetCollection.icon}return t.value.icon}),[t]);return(0,x.jsx)(l().zB,{type:t.value.type,icon:c,size:o,style:a.icon,theme:r,isDefaultNoticonEnabled:s})}function k(e){let{template:t,backgroundSize:o}=e;const n=(0,i().IS)((e=>({iconContainer:{background:M({theme:e,template:t})[30]},icon:{fill:M({theme:e,template:t})[400]}})),[t]);return(0,x.jsx)(y().y,{backgroundColor:n.iconContainer.background,backgroundSize:o,icon:(0,x.jsx)(C,{template:t,iconStyle:n.icon})})}function M(e){let{theme:t,template:o}=e;const{type:n}=o;switch(n){case"collection_view":case"automation":return t.accentColors.blue;case"property":return"relation"===o.value.type?t.accentColors.yellow:t.accentColors.red;case"layout":return t.accentColors.orange;case"block":return t.accentColors.purple;case"compound":return t.accentColors.green;case"collection":return t.accentColors.pink;default:(0,m().HB)(n)}}},201147:(e,t,o)=>{o.d(t,{Fe:()=>a,wm:()=>r});const n={property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,property_geo_point:!0,deleted_property:!1,relationsGroup:!0,formSubmit:!0,formQuestion:!0,formTitle:!0,placeholder:!0,transcript:!0,cover:!1,normalizedTitleWithIcon:!1,properties:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,views:!0,viewsMain:!1,recentActivity:!1,collaborators:!1,teamspaces:!1},i={property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,property_geo_point:!0,deleted_property:!1,formSubmit:!1,formQuestion:!1,formTitle:!1,placeholder:!1,transcript:!1,cover:!1,normalizedTitleWithIcon:!1,properties:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,relationsGroup:!0,editor:!1,views:!1,viewsMain:!1,recentActivity:!1,collaborators:!1,teamspaces:!1};function a(e){return n[e.type]}function r(e){return i[e.type]}},205207:(e,t,o)=>{o.d(t,{Li:()=>M,iD:()=>k,yA:()=>_,V6:()=>h,_n:()=>b,Yk:()=>j,rD:()=>C,w_:()=>B,xX:()=>x,Gx:()=>R,fs:()=>P,VT:()=>v,fA:()=>S,LX:()=>I,l:()=>w,L:()=>A,kb:()=>f,Sh:()=>T,cm:()=>y});o(242343);var n=()=>o(803290),i=()=>o(653998),a=()=>o(640979),r=()=>o(462156),l=()=>o(485966),s=()=>o(366691),c=()=>o(935091),u=()=>o(443252),d=o(163643);function p(e){const t=(0,n().O$)(s().F);return(0,d.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"half",trapFocus:!0,open:t.isOpen,render:()=>(0,d.jsx)(m,{menuState:t}),onDismiss:()=>{s().F.setState({isOpen:!1})}})}function m(e){const t=(0,n().O$)(l().AppStoreMainEditorCurrentBlockStore);if(!e.menuState.isOpen)return null;if(t){const e={menuType:a().gu.Modal,title:(0,d.jsx)(i().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"})};return(0,d.jsx)(c().A,{...e,children:(0,d.jsx)(r().t,{store:t})})}return null}var g=()=>o(129978);const y=new(g().O2)("menus",(async()=>{const[{default:e},{TopbarPageAnalyticsOptOutMenu:t},{default:n},{default:i},{default:a},{default:r},{default:l},{default:s},{default:c},{default:u},{default:d},{SidebarTeamModal:m},{SidebarCreateTeamModal:g},{CreateTeamFromPageConfirmModal:y},{CollectionTypedDatabaseMigrationModal:h},{default:f},{default:v},{default:x}]=await Promise.all([Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,693240)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,667253)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,260276)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,492251)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,232780)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,811130)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,202900)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,644587)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,858385)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,569177)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,670029)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,950234)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,651873)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,203716)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,810504)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,820994)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,469973)),Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(9304),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(16471),o.e(90825),o.e(37353),o.e(29151),o.e(16908),o.e(22900),o.e(49889),o.e(97727),o.e(85128),o.e(83700),o.e(95555),o.e(58823),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(48632),o.e(90625),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(81768),o.e(71104),o.e(2804),o.e(82850),o.e(84778),o.e(69914),o.e(11341),o.e(92011),o.e(19361),o.e(63327),o.e(26090),o.e(38482),o.e(12341),o.e(50984),o.e(47864),o.e(40828),o.e(76007),o.e(5023),o.e(90978),o.e(65554),o.e(53571),o.e(66885),o.e(21194),o.e(67780),o.e(96933),o.e(87598),o.e(23063),o.e(84341),o.e(3965),o.e(93052),o.e(67200),o.e(6463),o.e(98071),o.e(45620),o.e(96453),o.e(8081),o.e(25368),o.e(38546),o.e(80759),o.e(67183),o.e(45354),o.e(82720),o.e(83181),o.e(68455),o.e(28773),o.e(76074),o.e(78917),o.e(72883),o.e(1440),o.e(45986),o.e(67378),o.e(9353),o.e(91137),o.e(21864),o.e(52181),o.e(92924),o.e(66406),o.e(19167),o.e(55717),o.e(10152),o.e(40186),o.e(73738),o.e(70584),o.e(97074),o.e(48979),o.e(91957),o.e(76026),o.e(67262),o.e(29616),o.e(75681)]).then(o.bind(o,276004))]);return{CustomizePageMenuRenderer:e,TopbarPageAnalyticsOptOutMenu:t,ImportModal:n,ExportModal:i,PageTemplateModal:a,GoogleAuthPromptModal:r,StudentNotEligibleModal:l,CookieModal:s,ForkPagePopup:c,DatePropertyMenu:u,ReportPageModal:d,SidebarCreateTeamModal:g,SidebarTeamModal:m,CreateTeamFromPageConfirmModal:y,CollectionTypedDatabaseMigrationModal:h,OpenInDesktopAppPopup:f,BlockMenu:v,ImportIntoNewPageModal:x,MobilePageBacklinksMenuRenderer:p}})),h=(0,g()._h)(y,(e=>e.CustomizePageMenuRenderer)),f=(0,g()._h)(y,(e=>e.TopbarPageAnalyticsOptOutMenu)),v=(0,g()._h)(y,(e=>e.PageTemplateModal)),x=(0,g()._h)(y,(e=>e.ImportModal)),b=(0,g()._h)(y,(e=>e.ExportModal)),S=(0,g()._h)(y,(e=>e.ReportPageModal)),C=(0,g()._h)(y,(e=>e.GoogleAuthPromptModal)),A=(0,g()._h)(y,(e=>e.StudentNotEligibleModal)),k=(0,g()._h)(y,(e=>e.CookieModal)),M=(0,g()._h)(y,(e=>e.BlockMenu)),j=(0,g()._h)(y,(e=>e.ForkPagePopup)),T=(0,g()._h)(y,(e=>e.CollectionTypedDatabaseMigrationModal)),I=(0,g()._h)(y,(e=>e.SidebarCreateTeamModal)),w=(0,g()._h)(y,(e=>e.SidebarTeamModal)),_=(0,g()._h)(y,(e=>e.CreateTeamFromPageConfirmModal)),P=(0,g()._h)(y,(e=>e.OpenInDesktopAppPopup)),B=(0,g()._h)(y,(e=>e.ImportIntoNewPageModal)),R=(0,g()._h)(y,(e=>e.MobilePageBacklinksMenuRenderer))},207762:(e,t,o)=>{o.d(t,{Ay:()=>c,Jy:()=>s,vU:()=>l});o(403517);var n=o(242343),i=()=>o(640979),a=o(163643);function r(e){let{tabs:t,selectedIndex:r,onChange:c,separatorIndexes:u,right:d,style:p,rightStyle:m,tabStyle:g,tabTitleStyle:y,selectedTabTitleStyle:h,tabBorderStyle:f,selectedTabStyle:v,readOnly:x,hideTabBorder:b,idPrefix:S,hideTabIndexes:C}=e;const A=(0,n.useContext)(i().xu),{device:k,WindowSizeStore:M}=(0,o(237385).v3)(),{safePaddingLeft:j,safePaddingRight:T}=(0,o(803290).K8)((()=>({safePaddingLeft:M.getSafePaddingLeftCSS(16),safePaddingRight:M.getSafePaddingRightCSS(16)})),[M]),I=(0,o(174114).IS)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.text.secondary,...g},o=`inset 0 -1px 0 ${e.regularDividerColor}`,n=A.menuType===i().gu.Popup,a={fontSize:16,paddingTop:2,paddingLeft:n?16:j,paddingRight:n?16:T,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:b?void 0:o,...k.isMobile?a:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...p},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},tab:t,selectedTab:{...t,position:"relative",color:e.text.primary,...v},border:{borderBottom:`2px solid ${e.text.primary}`,position:"absolute",bottom:0,left:8,right:8,...f},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.text.secondary,...m}}}),[A.menuType,k.isMobile,m,j,T,v,p,f,g,b]);return(0,a.jsxs)("div",{className:"hide-scrollbar",style:I.container,role:"tablist",children:[t.map(((e,t)=>{if(null!=C&&C.includes(t))return null;const i=t===r;return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)("div",{style:i?I.selectedTab:I.tab,children:[(0,a.jsx)(o(209684).p,{role:"tab",style:{...y,...i?h:{}},onClick:()=>c(t),disabled:x,mobileFeedback:k.isMobile,isLightGray:!Boolean(i),"aria-selected":i,id:l(S,t),"aria-controls":s(S,t),children:e}),i&&(0,a.jsx)("div",{style:I.border})]},`tabButton-${t}`),u&&u.includes(t)&&(0,a.jsx)("div",{style:I.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),d&&(0,a.jsx)("div",{style:I.rightContainer,children:d})]})}function l(e,t){if(e)return`${e}-tab-${t}`}function s(e,t){if(e)return`${e}-tabpanel-${t}`}const c=n.memo(r)},219322:(e,t,o)=>{o.d(t,{U:()=>l,t:()=>s});var n=()=>o(174114),i=()=>o(752903),a=()=>o(31448),r=()=>o(755786);const l={[i().NY.ExtremeSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function s(e){let{format:t,shouldShrink:o,shouldWrap:s,isSingle:u,style:d,clickTitleBehavior:p}=e;const m="edit"===p;return(0,n().IS)((()=>{const{fontSize:e,margin:n}=l[t],p=m?r().d0:l[t].height;return{style:{...s?{display:"inline",lineHeight:1.5,borderRadius:4}:c({height:p}),fontSize:e,fontWeight:a().Wy.medium,minWidth:o?0:"auto",margin:u?0:n,...t===i().NY.Inline&&{overflow:"hidden"},...d}}}),[t,o,s,u,m,d])}function c(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}},224281:(e,t,o)=>{o.d(t,{Jv:()=>v,Zr:()=>x,Rl:()=>b,mA:()=>f});var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(564134),s=()=>o(916963),c=()=>o(88442),u=()=>o(136239),d=()=>o(622286),p=()=>o(966789),m=o(163643);function g(){const e=(0,r().DP)();return(0,m.jsx)("span",{style:{marginLeft:6,fontSize:11,padding:"1px 4px",borderRadius:4,display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1,color:"light"===e.mode?e.accentColors.blue[500]:e.accentColors.blue[600]},children:(0,m.jsx)(p().A,{legacySize:14})})}var y=()=>o(870896);const h=function(){return(0,m.jsx)(o(695951).A,{color:"purple",style:{marginLeft:6,padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1},content:(0,m.jsx)(o(653998).sA,{defaultMessage:"AI",id:"database.property.aiAutofillEnabledIndicator"})})};const f=n.memo((function(e){const{propertySchema:t,showIcon:n,showDragIcon:a,hideName:l,badge:s,style:c,iconStyle:d,iconSize:p,dragHandleStyle:g,className:y,labelSizeVariant:h}=e,f=(0,i().v3)(),{device:v}=f,x=v.isMobile?16:14,S=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",lineHeight:"120%",minWidth:0,fontSize:x,...c},iconWrapper:{display:"grid",justifyContent:"center",alignItems:"center",marginRight:l?void 0:"small"===h||a?4:6,...d},dragHandle:{gridColumn:1,gridRow:1,opacity:a?1:0,transition:`opacity ${u().bM}`},itemIcon:{gridColumn:1,gridRow:1,opacity:a?0:1,transition:`opacity ${u().bM}`},dragIcon:{fill:e.icon.secondary}})),[x,l,d,h,a,c]);return(0,m.jsxs)("div",{className:y,style:S.container,children:[n&&(0,m.jsxs)("div",{style:S.iconWrapper,children:[(0,m.jsx)("div",{style:S.itemIcon,children:(0,m.jsx)(b,{propertySchema:t,iconSize:p,iconStyle:d})}),(0,m.jsx)("div",{style:S.dragHandle,children:(0,m.jsx)(o(369515).A,{style:g,iconSize:12,iconStyle:S.dragIcon})})]}),!l&&(0,m.jsx)("div",{style:{...o(31448).RC},children:t.name}),s]})}));function v(e){const{propertySchema:t}=e,o=(0,i().v3)();return(0,a().K8)((()=>(0,c().O0)(o)&&l().$M(t)&&l().om(t)),[o,t])?(0,m.jsx)(h,{}):null}function x(e){let{propertyId:t,collectionContextStore:o}=e;return(0,a().K8)((()=>{var e;const n=null===(e=o.collectionStore())||void 0===e?void 0:e.id;if(!n)return!1;const i=y().d.state.collectionsProperties[n];return!!i&&"Loading"===i[t]}),[o,t])?(0,m.jsx)(g,{}):null}function b(e){const{propertySchema:t,iconSize:o,iconStyle:n}=e,{isMobile:a}=(0,i().Y0)(),l=(0,r().DP)(),c=(0,d().X)("nds_default_property_noticon"),u=a?18:16;return(0,m.jsx)(s().zB,{type:t.type,icon:t.icon,size:o||u,theme:l,style:n,isDefaultNoticonEnabled:c})}},229419:(e,t,o)=>{o.d(t,{C8:()=>p,Dz:()=>s,GC:()=>g,GL:()=>y,YY:()=>m,dM:()=>u,h9:()=>c,jX:()=>l,oF:()=>d,uj:()=>r});var n=()=>o(129978);const i={JiraSyncInfoPopup:new(n().O2)("JiraSyncInfoPopup",(async()=>await Promise.all([o.e(75134),o.e(68744)]).then(o.bind(o,917262)))),ImproveJiraSyncPopup:new(n().O2)("ImproveJiraSyncPopup",(async()=>await Promise.all([o.e(75134),o.e(2686)]).then(o.bind(o,800444)))),JiraDCAuthModal:new(n().O2)("JiraDCAuthModal",(async()=>await o.e(28763).then(o.bind(o,114124)))),ExternalImportAndSyncIndicator:new(n().O2)("ExternalImportAndSyncIndicator",(async()=>await o.e(98288).then(o.bind(o,988714)))),JiraSyncedAllProjectsTooltip:new(n().O2)("JiraSyncedAllProjectsTooltip",(async()=>await o.e(21446).then(o.bind(o,374415)))),JiraSyncedAllIssuesTooltip:new(n().O2)("JiraSyncedAllIssuesTooltip",(async()=>await o.e(21446).then(o.bind(o,374415)))),JiraSyncedDatabaseViewsAndFiltersTooltip:new(n().O2)("JiraSyncedDatabaseViewsAndFiltersTooltip",(async()=>await o.e(21446).then(o.bind(o,374415)))),JiraSyncSourceTooltip:new(n().O2)("JiraSyncSourceTooltip",(async()=>await o.e(21446).then(o.bind(o,374415)))),JiraSyncedSettingsToSetupProjectsAndIssuesTooltip:new(n().O2)("JiraSyncedSettingsToSetupProjectsAndIssuesTooltip",(async()=>await o.e(21446).then(o.bind(o,374415))))},a={JiraSyncTeamSpaceModal:new(n().O2)("JiraSyncTeamSpaceModal",(async()=>Promise.all([o.e(96159),o.e(56188)]).then(o.bind(o,35705))))},r=(0,n()._h)(a.JiraSyncTeamSpaceModal,(e=>e.default)),l=(0,n()._h)(i.JiraSyncedAllProjectsTooltip,(e=>e.JiraSyncedAllProjectsTooltip)),s=(0,n()._h)(i.JiraDCAuthModal,(e=>e.default)),c=(0,n()._h)(i.JiraSyncedAllIssuesTooltip,(e=>e.JiraSyncedAllIssuesTooltip)),u=(0,n()._h)(i.JiraSyncedDatabaseViewsAndFiltersTooltip,(e=>e.JiraSyncedDatabaseViewsAndFiltersTooltip)),d=(0,n()._h)(i.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip,(e=>e.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip)),p=(0,n()._h)(i.JiraSyncSourceTooltip,(e=>e.JiraSyncSourceTooltip)),m=(0,n()._h)(i.JiraSyncInfoPopup,(e=>e.JiraSyncInfoPopup)),g=(0,n()._h)(i.ImproveJiraSyncPopup,(e=>e.ImproveJiraSyncPopup)),y=(0,n()._h)(i.ExternalImportAndSyncIndicator,(e=>e.ExternalImportAndSyncIndicator));(0,o(680369).xh)("jira",{default:{loader:()=>o.e(60677).then(o.bind(o,832398)),size:20},small:{loader:()=>o.e(60677).then(o.bind(o,832398)),size:16},mini:{loader:()=>o.e(60677).then(o.bind(o,832398)),size:14},large:{loader:()=>o.e(60677).then(o.bind(o,832398)),size:24}})},231556:(e,t,o)=>{o.d(t,{M:()=>g,z:()=>y});o(242343);var n=()=>o(237385),i=()=>o(803290),a=()=>o(174114),r=()=>o(723361),l=()=>o(653998),s=()=>o(31448),c=()=>o(421338),u=()=>o(701270),d=()=>o(146447),p=()=>o(981793),m=o(163643);function g(e){const{analyzedFormulaOutput:t,labelMessageDescriptor:o,isOptional:g,errorMessageDescriptor:h}=e,f=(0,l().tz)(),v=(0,i().K8)((()=>(0,p().L)(f,null==t?void 0:t.parseErrors,null==t?void 0:t.typeErrors)),[t,f]),{isMobile:x}=(0,n().Y0)(),b=(0,a().IS)((e=>({inputLabel:{display:"flex",alignItems:"center",color:e.text.secondary,fontSize:x?s().J.UIRegular.mobile:s().J.UIRegular.desktop,lineHeight:x?s().K_.UIRegular.mobile:s().K_.UIRegular.desktop,fontWeight:s().Wy.regular},messageInput:{width:"100%"},warningIcon:{color:e.errorText,fill:e.errorText,height:12,flex:"0 0 auto",width:12,display:"flex",marginRight:4},inputLabelInner:{flex:"1 1 auto",...(h||v)&&{color:e.text.uiRedPrimary,fontWeight:s().Wy.medium}},warningError:{color:e.text.uiRedPrimary}})),[h,v,x]);return(0,m.jsxs)(c().Y1,{direction:"vertical",gap:6,children:[(0,m.jsxs)("label",{style:b.inputLabel,children:[v&&(0,r().Q)(b.warningIcon),(0,m.jsxs)("div",{style:b.inputLabelInner,children:[(0,m.jsx)(l().sA,{...o}),g&&(0,m.jsx)(y,{})]})]}),(0,m.jsxs)(c().Y1,{direction:"vertical",gap:6,children:[(0,m.jsx)(d().Y,{...e,style:b.messageInput,shouldShowErrorStyles:Boolean(v)||e.shouldShowErrorStyles}),v&&(0,m.jsx)(p().J,{analyzedFormulaOutput:t}),!v&&h&&(0,m.jsx)(u().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:b.warningError,children:(0,m.jsx)(l().sA,{...h})})]})]})}function y(){const e=(0,a().IS)((e=>({optionalLabel:{color:e.text.tertiary,marginLeft:4}})),[]);return(0,m.jsx)("span",{style:e.optionalLabel,children:(0,m.jsx)(l().sA,{defaultMessage:"{openParenthesis}Optional{closeParenthesis}",id:"automations.SimpleFormulaTextInputWithError.optionalLabel",values:{openParenthesis:"(",closeParenthesis:")"}})})}},235112:(e,t,o)=>{o.d(t,{M:()=>i});o(242343);const n={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"m4.148 2.661-.23-.269a.55.55 0 1 0-.836.716L4.1 4.294C2.727 5.017 1.61 6.113.914 7.44a1.21 1.21 0 0 0 0 1.128c1.282 2.443 3.987 4.1 7.086 4.1a8.4 8.4 0 0 0 2.854-.493l1.228 1.433a.55.55 0 0 0 .84-.71L4.152 2.666zm1.227 5.34c0-.598.2-1.15.537-1.591l.963 1.123q-.092.218-.094.469a1.22 1.22 0 0 0 1.511 1.184l.963 1.123a2.626 2.626 0 0 1-3.88-2.307m7.475 3.122a7.4 7.4 0 0 0 2.236-2.556 1.21 1.21 0 0 0 0-1.128C13.804 4.997 11.099 3.34 8 3.34a8.5 8.5 0 0 0-1.68.166l1.605 1.87H8a2.626 2.626 0 0 1 2.582 3.101z"})},i=(0,o(680369).wt)("eyeSlashFillSmall",n)},235786:(e,t,o)=>{o.d(t,{b:()=>h,w:()=>f});var n=()=>o(237385),i=()=>o(803290),a=()=>o(367950),r=()=>o(162901),l=()=>o(528762),s=()=>o(439154),c=()=>o(818369),u=()=>o(129978),d=()=>o(485966),p=()=>o(595922),m=()=>o(172470),g=()=>o(151602);const y=!1;function h(e){var t;const o=null===(t=(0,u().fJ)(s().xl).value)||void 0===t?void 0:t.loadWorkflowTemplateInstances;(0,i().K8)((()=>{if(!o)return;const t=e instanceof p().A?e.collectionStore():e;t&&o(t)}),[o,e])}function f(){const e=(0,n().v3)(),t=(0,i().K8)((()=>{var e;if(function(){const e=m().A.state.initialRenderCompleted;y&&!e&&console.log("Initial page render is not yet completed, delaying refresh of workflow template instances.");return e}())return null===(e=d().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,r().Yb)((async()=>{if(!t)return;(g().A.debug||y)&&console.log("Refreshing workflow template instance map for space",t);const o={table:l().NX,id:t,spaceId:t},n=await c().callApi({eventName:"getWorkflowTemplateInstances",environment:e,data:{spaceId:o.spaceId,scopeTable:o.table,scopeId:o.id,enableInstanceRobustness:!0}});if("success"===n.type){const e=(0,a()._)(o);g().A.setState({...g().A.state,[e]:n.data.instanceMap[e]})}}),[e,t])}},236089:(e,t,o)=>{o.d(t,{s:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M9.792 2.41a.6.6 0 0 0-.234.148l-5.4 5.4a.625.625 0 1 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 1 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},i=(0,o(680369).wt)("arrowStraightUp",n)},239296:(e,t,o)=>{o.d(t,{c:()=>i});var n=o(242343);function i(){const[e,t]=(0,n.useState)(void 0),o=(0,n.useCallback)((e=>t(e.id)),[]),i=(0,n.useCallback)((()=>t(void 0)),[]);return(0,n.useMemo)((()=>({currentDraggingActionId:e,onActionDragStart:o,onActionDragEnd:i})),[e,i,o])}},242103:(e,t,o)=>{o.d(t,{S:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("locked",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},242978:(e,t,o)=>{o.d(t,{v:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},261603:(e,t,o)=>{o.d(t,{nR:()=>u,m$:()=>l,m4:()=>s,Dy:()=>c,it:()=>d,FZ:()=>m});o(242343);var n=()=>o(129978),i=o(163643);function a(e){const{shouldShowSpinner:t,collectionSettingsProps:n}=e;return(0,i.jsx)(o(3364).Ay,{collectionSettingsStore:n.collectionSettingsStore,fullHeight:n.fullHeight,hideDesktopHeader:n.hideDesktopHeader,children:t&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden",paddingBottom:20},children:(0,i.jsx)(o(966789).A,{})})})}const r=new(n().O2)("collectionSettings",(()=>Promise.all([o.e(96159),o.e(75134),o.e(43380),o.e(96346),o.e(36192),o.e(55373),o.e(62475),o.e(3151),o.e(44711),o.e(98629),o.e(53321),o.e(58550),o.e(90825),o.e(22900),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(18895),o.e(78708),o.e(28721),o.e(4422),o.e(28866),o.e(67435),o.e(17989),o.e(76181),o.e(59794),o.e(72832),o.e(90280),o.e(26483),o.e(33813),o.e(2804),o.e(84778),o.e(69914),o.e(26090),o.e(12341),o.e(47864),o.e(90978),o.e(87598),o.e(84341),o.e(6463),o.e(25368),o.e(80759),o.e(68455),o.e(28773),o.e(72883),o.e(1440),o.e(45986),o.e(91137),o.e(92924),o.e(19167),o.e(55717),o.e(10152),o.e(73738),o.e(70584),o.e(97074),o.e(99108)]).then(o.bind(o,282826)))),l=(0,n()._h)(r,(e=>e.CollectionSettings),{renderLoading:(e,t)=>(0,i.jsx)(a,{shouldShowSpinner:e,collectionSettingsProps:t})}),s=(0,n()._h)(r,(e=>e.CollectionSettingsButtonOptions)),c=(0,n()._h)(r,(e=>e.CollectionSettingsPropertyTypeMenuItem)),u=(0,n()._h)(r,(e=>e.CollectionEditButtonAutomationOption)),d=(0,n()._h)(r,(e=>e.CollectionSettingsSaveAsAppButton)),p=new(n().O2)("TableHeaderPropertyCreationMenu",(()=>Promise.all([o.e(96159),o.e(96346),o.e(36192),o.e(55373),o.e(36209),o.e(92845),o.e(71718),o.e(48486),o.e(83324),o.e(63077),o.e(41870),o.e(90966),o.e(88552),o.e(90214),o.e(74562),o.e(8184),o.e(28271),o.e(17254),o.e(89693),o.e(68455),o.e(43935)]).then(o.bind(o,784676)))),m=(0,n()._h)(p,(e=>e.TableHeaderPropertyCreationMenu))},268974:(e,t,o)=>{o.d(t,{B:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})})},270946:(e,t,o)=>{o.d(t,{w:()=>ke,J:()=>Me});var n=o(242343),i=()=>o(803290),a=()=>o(465546),r=()=>o(271142),l=(o(610931),o(725707),o(491955),()=>o(237385)),s=()=>o(174114),c=()=>o(268163),u=()=>o(644518),d=()=>o(15552),p=()=>o(157316),m=()=>o(752903),g=()=>o(653998),y=()=>o(76394),h=()=>o(31448),f=()=>o(759625),v=()=>o(84543),x=()=>o(982415),b=()=>o(273520),S=()=>o(709237),C=()=>o(434406),A=()=>o(749975),k=()=>o(137476),M=()=>o(950808),j=()=>o(962373),T=()=>o(413871),I=()=>o(765618),w=()=>o(459845),_=()=>o(738355),P=()=>o(265405),B=()=>o(179701),R=()=>o(698548),V=()=>o(151028),E=()=>o(284573),D=()=>o(688142),F=()=>o(100096),O=()=>o(44405),N=()=>o(511575),L=()=>o(799772),W=()=>o(935091),z=()=>o(88271),K=()=>o(441911),H=o(163643);function U(e){const{filter:t,onChange:o,onClose:a,collectionStore:r}=e,l=(0,A().Ks)(),s=(0,i().K8)((()=>r.getSchema()),[r]),c=(0,K().e)({minWidth:300,tabletBehavior:"actionSheet"}),u=(0,n.useCallback)(((e,t)=>o(t)),[o]),p=(0,n.useCallback)((()=>{o(void 0),a()}),[o,a]);return(0,H.jsxs)(W().A,{...c,children:[(0,H.jsx)(L().i,{children:(0,H.jsx)(N().tY,{collectionViewId:"Automation.FilterMenu",collectionContextStore:l,collectionViewType:"table",combinatorFilter:t||d().AY,index:0,level:0,onChange:u,parentStore:r,schema:s})}),(0,H.jsx)(z().A,{topBorder:!0,children:(0,H.jsx)(O().A,{title:(0,H.jsx)(g().sA,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:p})})]})}const Y=(0,g().YK)({multipleTargetsFilter:{defaultMessage:"<span>Edit </span>{filterPicker}",id:"automations.UpdatePagesAction.multipleTargetsFilter"},multipleTargetsPicker:{defaultMessage:"<span>in </span>{targetPicker}",id:"automations.UpdatePagesAction.multipleTargetsPicker"},singleTarget:{defaultMessage:"<span>Edit </span>{targetPicker}",id:"automations.UpdatePagesAction.singleTarget"}});function G(e){const{actionStore:t}=e,o=(0,l().v3)(),{automationStore:a,typecheckResult:s}=(0,r().EC)(),{disabled:d,suppressActionErrors:m}=(0,_().b)(),h=(0,i().K8)((()=>t.getTargetStore()),[t]),x=(0,i().K8)((()=>a.isTriggerType("button")),[a]),b=(0,A().Ks)(),S=(0,i().K8)((()=>Q(t,(0,u().getAllContextValues)(s))),[t,s]),C=(0,i().K8)((()=>{var e;const o=t.getCollectionTargetStore(),n=null==o||null===(e=o.getKeyStore("filter"))||void 0===e?void 0:e.getValue();if(n)return(0,p().SK)(n,(null==S?void 0:S.getSchema())||{})}),[t,S]),k=(0,i().K8)((()=>{const e=t.getVariableTargetStore();if(e)return e.getValue();const o=t.getCollectionTargetStore();if(o){const e=o.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[t]),T=(0,i().K8)((()=>{if(!k||"variable"!==k.type)return!1;const e=(0,u().getContextValueForActionById)(s,t.id,k.id),o=null==e?void 0:e.type;return!!o&&("block"===o.type||"array"===o.type&&"block"===o.of.type)}),[t.id,k,s]),P=(0,i().uB)(void 0,j().A),B=(0,n.useCallback)((()=>P.reset()),[P]),E=(0,n.useMemo)((()=>(0,H.jsx)(R().z,{actionStore:t,closeMenu:B})),[t,B]),D=(0,n.useMemo)((()=>!m.includes(t.id)),[m,t]),O=(0,i().K8)((()=>{if(S)return D&&!(0,M().bI)({actionStore:t,collectionStore:S,typecheckResult:s})?(0,H.jsx)(g().sA,{...I().automationErrorMessages.actionIncompleteErrorMessage}):void 0}),[t,S,D,s]),{errorMessage:N,errorIcon:L}=(0,I().useErrorComponentForAction)({actionId:t.id,shouldShow:D,errorKeys:["target","collection","block"]}),{errorMessage:W,errorIcon:z}=(0,I().useErrorComponentForAction)({actionId:t.id,errorKey:"filter",shouldShow:D}),K=(0,i().K8)((()=>(0,y().O9)(t.getConfigStore().getKeyStore("target").getValue())),[t]),U=(0,n.useCallback)((e=>{v().createAndCommit({userAction:"UpdatePagesAction.filterChange",environment:o,canUndo:!0,perform:t=>{f().zv({data:{filter:e},store:h,transaction:t})}}),(0,w().UB)(o,{automationStore:a,automationActionStore:t})}),[t,a,o,h]),Y=(0,n.useCallback)((e=>{let n;if("collection"===e.type)n="UpdatePageAction.updateCollection";else if("variable"===e.type)n="UpdatePageAction.updateVariable";else{if("page"===e.type||"property"===e.type||"formula"===e.type||"url"===e.type)throw new Error("Not implemented yet.");(0,y().HB)(e)}v().createAndCommit({userAction:n,environment:o,canUndo:!0,perform:o=>{f().zv({data:{properties:null,target:e,values:null},store:t.getConfigStore(),transaction:o})}}),(0,w().UB)(o,{automationStore:a,automationActionStore:t})}),[o,a,t]),G=Boolean(d),$=(0,c().getActionRegistryItem)("update_pages");return(0,H.jsx)(A().RI,{value:x?void 0:b,children:(0,H.jsxs)(F().OT,{actionMenu:E,buttonPopupStore:P,disabled:G,actionId:t.id,canCollapse:K,children:[(0,H.jsx)(F().h3,{actionId:t.id,actionRegistryItem:$,disabled:G,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"grid",gridTemplateColumns:"auto 1fr"}},errorMessage:N||W||O,children:T||!S?(0,H.jsx)(q,{actionStore:t,disabled:G,errorMessage:N,errorIcon:L,onTargetChange:Y,value:k}):(0,H.jsx)(X,{actionStore:t,collectionStore:S,disabled:G,errorMessage:N,errorIcon:L,filterErrorIcon:z,filterErrorMessage:W,filter:C,onFilterChange:U,onTargetChange:Y,value:k})}),S&&(0,H.jsx)(F().qt,{disabled:G,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,H.jsx)(V().Ud,{actionStore:t,collectionStore:S,disabled:G,showSetPropertyActions:!0})})]})})}function q(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a,errorIcon:r}=e,l=(0,s().IS)((()=>({b:{fontWeight:h().Wy.medium},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,H.jsx)("div",{style:l.title,children:(0,H.jsx)(g().sA,{...Y.singleTarget,values:{b:e=>(0,H.jsx)("b",{style:l.b,children:e}),targetPicker:(0,H.jsx)(J,{actionStore:t,disabled:o,errorMessage:n,errorIcon:r,onChange:i,value:a}),span:e=>(0,H.jsx)("span",{style:l.span,children:e})}})})}function X(e){const{actionStore:t,collectionStore:o,disabled:n,errorMessage:i,errorIcon:a,filterErrorMessage:r,filterErrorIcon:l,filter:c,onFilterChange:u,onTargetChange:d,value:p}=e,m=(0,s().IS)((()=>({span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:m.title,children:[(0,H.jsx)(g().sA,{...Y.multipleTargetsFilter,values:{filterPicker:(0,H.jsx)($,{collectionStore:o,disabled:n,errorMessage:r,errorIcon:l,filter:c,onChange:u}),span:e=>(0,H.jsx)("span",{style:m.span,children:e})}})," "]}),(0,H.jsx)("div",{style:m.title,children:(0,H.jsx)(g().sA,{...Y.multipleTargetsPicker,values:{targetPicker:(0,H.jsx)(J,{actionStore:t,disabled:n,errorMessage:i,errorIcon:a,onChange:d,value:p}),span:e=>(0,H.jsx)("span",{style:m.span,children:e})}})})]})}function $(e){var t;const{collectionStore:o,disabled:a,errorMessage:r,filter:l,onChange:s,errorIcon:c}=e,u=(0,i().uB)(void 0,j().A),p=(0,B().j)({tabletBehavior:"slideUp"}),m=(0,n.useCallback)((()=>u.reset()),[u]),y=(0,i().K8)((()=>{const e=o.getModel(),t=null==e?void 0:e.getDatabaseType();return(0,x().oj)(t)}),[o]),h=(null==l||null===(t=l.filters)||void 0===t?void 0:t.length)||0;return(0,H.jsx)(b().Ay,{alignmentToOrigin:b().yP.Center,disabled:a,originGap:0,placementToOrigin:b().sx.Bottom,popupType:p,renderOrigin:e=>(0,H.jsx)(E().x,{...e,disabled:a,isCompact:!0,errorIcon:c,onClick:t=>{e.onClick(t),0===h&&s(d().Lx)},dropdownButtonType:"dropdown",isError:Boolean(r),tooltipMessage:r,children:h>0?(0,H.jsx)(g().sA,{defaultMessage:"{itemType} that match {ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.UpdatePagesAction.FilterPicker.withRules",values:{itemType:y,ruleCount:h}}):(0,H.jsx)(g().sA,{defaultMessage:"all {itemType}",id:"automations.UpdatePagesAction.FilterPicker.noRules",values:{itemType:y}})}),render:()=>(0,H.jsx)(U,{collectionStore:o,disabled:a,filter:l,onChange:s,onClose:m})})}function J(e){const{actionStore:t,disabled:o,errorMessage:a,onChange:s,value:c,errorIcon:d}=e,p=(0,l().v3)(),{automationStore:h,typecheckResult:f}=(0,r().EC)(),v=(0,P().F)({actionId:t.id}),x=(0,i().K8)((()=>{if("collection"===(null==c?void 0:c.type))return T().md.createChildStore(t,c.collection)}),[t,c]),A=(0,i().K8)((()=>{if(f&&c&&"variable"===c.type)return(0,u().getContextValueForActionById)(f,t.id,c.id)}),[f,c,t.id]),M=(0,i().uB)(void 0,j().A),I=(0,B().j)(),_=(0,n.useCallback)((()=>M.reset()),[M]),R=(0,n.useCallback)((e=>{s(e),_(),(0,w().CM)(((o,n,i)=>{const a=(0,w().zc)({automationActionStore:t,formulasModule:o,formulaAnalyticsModule:n,simpleFormulasModule:i});(0,y().O9)(a)&&(0,k().u4)({environment:p,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})}))}),[s,_,t,p]);return(0,H.jsx)(b().Ay,{buttonPopupStore:M,popupType:I,alignmentToOrigin:b().yP.Center,placementToOrigin:b().sx.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,H.jsx)(E().x,{...e,disabled:o,isCompact:!0,isError:Boolean(a),errorIcon:d,hasActionRequired:!Boolean(c||A),dropdownButtonType:"dropdown",children:(0,y().O9)(x)?(0,H.jsx)(S().A,{store:x,style:{paddingBlock:1}}):A?(0,H.jsx)(C().F,{format:m().NY.Medium,isSingle:!0,value:A,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,H.jsx)(g().sA,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,H.jsx)(D()._,{formulaTypecheckContextValues:v,onChange:R,onClose:_,parentRecordStore:h,selectedTarget:c,skipPages:!0})})}function Q(e,t){const o=e.getTargetStore().getValue();if(o){if("collection"===o.type)return T().md.createChildStore(e,o.collection);if("variable"===o.type){if(!t)return;const n=(0,a().IV)(t,o.id);if(n)return(0,M().A8)(n,e)}else{if("page"===o.type)return;(0,y().HB)(o)}}}var Z=()=>o(911575),ee=()=>o(903012),te=()=>o(564134),oe=()=>o(622286),ne=()=>o(498248),ie=()=>o(641383),ae=()=>o(400383),re=()=>o(724175);function le(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:a}=e,r=(0,s().IS)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=function(e){const{propertySchema:t,styles:o}=e,n=t.name;return(0,H.jsx)(g().sA,{defaultMessage:"{propertyName} is a cross-workspace relation",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.title",values:{propertyName:(0,H.jsx)("span",{style:o.propertyType,children:n})}})}({propertySchema:a,styles:r}),c=function(e){const{propertySchema:t}=e,o=t.name;return(0,H.jsx)(g().sA,{defaultMessage:"{propertyName} is a cross-workspace relation. Cross-workspace features are restricted in automations and will not work.",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.text",values:{propertyName:o}})}({propertySchema:a});return(0,H.jsx)(re().z$,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertyType:a.type,styles:r,tooltip:c,children:l})}function se(e){const{actionId:t,renderOrigin:o}=e,a=(0,B().j)(),r=(0,i().uB)(void 0,j().A),l=(0,n.useCallback)((()=>r.reset()),[r]);return(0,H.jsx)(b().Ay,{buttonPopupStore:r,popupType:a,render:()=>(0,H.jsx)(ae().qM,{actionId:t,closeMenu:l}),renderOrigin:o})}var ce=()=>o(916396),ue=()=>o(88937),de=()=>o(522313),pe=(o(403517),()=>o(167089)),me=()=>o(658722),ge=()=>o(993517);function ye(e){const{action:t,actionMenu:o,buttonPopupStore:i,disabled:a,onClick:l,propertySchema:s,value:c}=e,{automationStore:d,typecheckResult:p}=(0,r().EC)(),m=(0,n.useMemo)((()=>(0,u().getAllContextValues)(p)),[p]),{title:g,tooltipTitle:y,styles:h}=(0,me().oG)({getRecordModel:d.getRecordModel,contextValues:m,messageType:"action",operator:t,propertySchema:s,value:c}),f=(0,n.useCallback)((e=>(0,H.jsx)(F().aX,{...e,actionMenu:o,buttonPopupStore:i,disabled:a,icon:pe().M,onClick:l,children:(0,H.jsx)("div",{style:h.content,children:g})})),[o,i,a,l,h.content,g]);return(0,H.jsx)(ge().P,{renderOrigin:f,title:y})}var he=()=>o(403768),fe=()=>o(403321);function ve(e){const{action:t,actionMenu:o,automationActionStore:i,buttonPopupStore:a,collectionStore:r,disabled:l,onClick:s,propertySchema:c,value:u}=e,d=(0,P().F)({actionId:i.id}),{tooltipTitle:p,title:m}=(0,fe().xL)({automationContextValues:d,collectionStore:r,messageType:"action",operator:t,propertySchema:c,value:u}),g=(0,n.useCallback)((e=>(0,H.jsx)(F().aX,{...e,actionMenu:o,buttonPopupStore:a,disabled:l,icon:he().H,onClick:s,children:m})),[o,a,l,s,m]);return(0,H.jsx)(ge().P,{renderOrigin:g,title:p})}var xe=()=>o(576992),be=()=>o(350826),Se=()=>o(950065);function Ce(e){var t;const{actionStore:o}=e,{disabled:a}=(0,_().b)(),[r,l]=(0,i().K8)((()=>[o.id,o.getConfig()]),[o]),s=(0,P().F)({actionId:r}),c=(0,i().K8)((()=>Q(o,s)),[o,s]),u=(0,i().K8)((()=>null==c?void 0:c.getSchema()),[c]),d=(0,i().K8)((()=>null==c?void 0:c.getDeletedSchema()),[c]),p=(0,i().uB)(void 0,j().A),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,H.jsx)(R().z,{actionStore:o,closeMenu:m})),[o,m]),y=(0,oe().X)("collections_xws"),h=((null==l?void 0:l.properties)??[])[0],f=null==u?void 0:u[h],v=null==d?void 0:d[h],x=null==l||null===(t=l.values)||void 0===t?void 0:t[h],b=Boolean(a),S={automationActionStore:o,actionMenu:g,buttonPopupStore:p,disabled:b,value:null==x?void 0:x.value};return!f&&v?(0,H.jsx)(ue().sF,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(ue().vu,{...e,...S,propertySchema:v})}):f||v?f&&c?(0,Z().I3)(f)?"person"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(ye,{...e,...S,propertySchema:f,action:(0,ee().tz)(x)})}):"status"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(be().II,{...e,...S,propertySchema:f})}):"select"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(xe().w$,{...e,...S,propertySchema:f})}):"multi_select"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(de().j,{...e,...S,propertySchema:f,action:(0,ee().tz)(x)})}):"date"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(ce().m,{...e,...S,propertySchema:f,valueContext:{collectionStore:c,property:h,type:"collection"}})}):"relation"===f.type&&y&&(0,te().o2)(c.pointer.spaceId,f)?(0,H.jsx)(se,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(le,{...e,...S,propertySchema:f})}):"relation"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(ve,{...e,...S,collectionStore:c,propertySchema:f,action:(0,ee().tz)(x)})}):"checkbox"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(ie().zH,{...e,...S,propertySchema:f})}):"title"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().EJ,{...e,...S,propertySchema:f})}):"text"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().Zd,{...e,...S,propertySchema:f})}):"email"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().ef,{...e,...S,propertySchema:f})}):"url"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().Vj,{...e,...S,propertySchema:f})}):"number"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().T7,{...e,...S,propertySchema:f})}):"phone_number"===f.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(Se().Jx,{...e,...S,propertySchema:f})}):null:(0,H.jsx)(re().gI,{actionId:o.id,propertyId:h,renderOrigin:e=>(0,H.jsx)(re().RY,{...e,...S,propertySchema:f})}):null:(0,H.jsx)(ue().sF,{actionId:o.id,renderOrigin:e=>(0,H.jsx)(ue().qR,{...e,...S})})}function Ae(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,B().j)(),l=(0,i().uB)(void 0,j().A),s=(0,n.useCallback)((()=>l.reset()),[l]),c=(0,n.useMemo)((()=>({actionId:t,propertyId:o,type:"eventActionProperty"})),[t,o]);return(0,H.jsx)(b().Ay,{buttonPopupStore:l,popupType:r,render:()=>(0,H.jsx)(ne().A,{initialState:c,onClose:s}),renderOrigin:a})}function ke(e){const{actionStore:t}=e,{contextType:o}=(0,r().YC)();return(0,i().K8)((()=>Me(o,t)),[t,o])?(0,H.jsx)(Ce,{...e}):(0,H.jsx)(G,{...e})}function Me(e,t){var o;if(!t.isType("update_pages"))return!1;const n=t.getConfig(),i="variable"===(null==n||null===(o=n.target)||void 0===o?void 0:o.type)?(0,a().y5)(n.target.id):void 0;return"event"===e&&i&&"global"===i.source&&"button_page"===i.global}},271142:(e,t,o)=>{o.d(t,{EC:()=>C,To:()=>S,YC:()=>A,or:()=>b,u:()=>x});o(610931);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(496985),l=()=>o(232312),s=()=>o(653998),c=()=>o(76394),u=()=>o(337658),d=()=>o(73631),p=()=>o(137696),m=()=>o(129978),g=()=>o(113800),y=()=>o(830925),h=o(163643);const f=new WeakMap,v=(0,n.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});v.displayName="AutomationContext";function x(e){const{automationStore:t,children:o,contextType:n}=e,x=(0,i().v3)(),b=(0,s().tz)(),{value:S}=(0,m().fJ)(d().T.formulas),{value:C}=(0,m().fJ)(u().QV.automationTypecheck),A=(0,y().n)(t),k=(0,a().K8)((()=>{if(!S)return{error:new(l().N9)("Missing formulas dependency")};if(!C)return{error:new(l().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:o,automationTypecheckModule:n,contextType:i,formulasModule:a,intl:l,isSubscribed:s}=e,u=f.get(o);if(u)return u;{const e=new(r().default)((()=>{const e=o.getTriggerType();let r=i;return(0,c().O9)(e)&&(0,p().x2)(e)&&(r=(0,p().H8)(e)),(0,g().Z)({environment:t,automationStore:o,automationTypecheckModule:n,contextType:r,formulasModule:a,intl:l,isSubscribed:s})}),{debugName:"automationContextTypecheckResultCachedStore"});return f.set(o,e),e}}({environment:x,automationStore:t,automationTypecheckModule:C,contextType:n,formulasModule:S,intl:b,isSubscribed:A});return e.state}),[x,t,C,n,S,b,A]);return(0,h.jsx)(v.Provider,{value:{automationStore:t,typecheckResult:k,contextType:n,defined:!0},children:o})}function b(e){const{automationStore:t,children:o}=e,n=(0,a().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,h.jsx)(x,{automationStore:t,contextType:(0,p().H8)(n??"event"),children:o})}function S(e){var t;return null===(t=f.get(e))||void 0===t?void 0:t.state}function C(){const e=n.useContext(v);if(!1===e.defined)throw new Error("No automation context found!");return e}function A(){return n.useContext(v)}},276647:(e,t,o)=>{o.d(t,{o:()=>a});var n=o(242343),i=o(163643);const a=n.forwardRef((function(e,t){let{color:n="primary",...a}=e;const r=(0,o(174114).IS)((e=>{const t="blue"===n?o(220413).Ay.blue:"secondary"===n?e.text.secondary:e.text.primary;return{title:{color:t,fill:t},buttonMenuItem:{...a.style,...a.disabled?{cursor:"not-allowed"}:{}}}}),[a.disabled,n,a.style]);return(0,i.jsx)(o(535906).A,{ref:t,...a,title:(0,i.jsx)("div",{style:r.title,children:a.title}),icon:(0,i.jsx)(o(397791).I,{icon:o(178063).plusIcon,style:{fill:n}}),style:r.buttonMenuItem})}))},279150:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);function i(e){const t={display:"inline-block",minWidth:e.size,minHeight:e.size};return"x"===e.axis?t.minHeight=1:"y"===e.axis&&(t.minWidth=1),(0,n.jsx)("div",{style:t})}},280704:(e,t,o)=>{o.d(t,{b:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("plusThick",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})},299924:(e,t,o)=>{o.d(t,{j:()=>n});const n=(0,o(680369).xh)("arrowUpRight",{default:{loader:()=>o.e(43274).then(o.bind(o,388521))},small:{loader:()=>o.e(30720).then(o.bind(o,405211))},mini:{loader:()=>o.e(37972).then(o.bind(o,945151))},large:{loader:()=>o.e(49172).then(o.bind(o,715775))}})},305948:(e,t,o)=>{o.d(t,{eJ:()=>y,ew:()=>g,ml:()=>u,rA:()=>p,yI:()=>m,zf:()=>d});o(403517);var n=()=>o(975392),i=()=>o(76394),a=()=>o(61014),r=()=>o(86335),l=()=>o(479056),s=()=>o(465546);function c(e){switch(e){case"checkbox":return"boolean";case"number":return"number";case"text":return"text";case"date":return"date";case"array":return"array";case"block":return"block";case"person":return"person";case"select":return"select";case"function":return"function";case"unknown":return"unknown";case"undefined":return"undefined";default:(0,i().HB)(e)}}function u(e){switch(e.type){case l().M9.InvalidCharacter:return{...r().x0.InvalidCharacter,values:{errorCharacter:e.character}};case l().M9.UnclosedStringLiteral:return r().x0.UnclosedStringLiteral;case l().M9.UnclosedComment:return r().x0.UnclosedComment;case l().M9.TokenExpected:return{...r().x0.TokenExpected,values:{expectedToken:e.token}};case l().M9.StringLiteralContainsToken:return r().x0.StringLiteralContainsToken;case l().M9.ExpressionExpected:return r().x0.ExpressionExpected;case l().M9.PropertyTokenOrFunctionExpected:return r().x0.PropertyTokenOrFunctionExpected;case l().M9.EndOfInputExpected:return r().x0.EndOfInputExpected;case l().M9.UnexpectedError:return r().x0.UnexpectedError;case l().M9.TooDeeplyNested:return r().x0.TooDeeplyNested;default:(0,i().HB)(e)}}function d(e){switch(e.type){case l().IA.FunctionCallArgumentWrongType:case l().IA.FunctionCallUnexpectedArgument:return e.argument;default:return e.node}}function p(e,t){let o;switch(t.type){case l().IA.ThisRowTypeNotFound:o=r().Xz.ThisRowTypeNotFound;break;case l().IA.ThisRowNotBlockWithCollection:o=r().Xz.ThisRowNotBlockWithCollection;break;case l().IA.MissingPropertyOnThisRow:o={...r().Xz.MissingPropertyOnThisRow,values:{propertyName:t.property}};break;case l().IA.MissingContextVariable:{const e=(0,s().ix)(t.token)?t.token.contextValueId:t.token.valueId;o={...r().Xz.MissingContextVariable,values:{valueId:e}}}break;case l().IA.MissingBlock:o={...r().Xz.MissingBlock,values:{blockId:t.token.blockId}};break;case l().IA.CallingNotFunction:o={...r().Xz.CallingNotFunction,values:{expressionType:c(t.callee.type.type)}};break;case l().IA.FunctionCallTooFewArguments:o={...r().Xz.FunctionCallTooFewArguments,values:{minNumParameters:t.minNumParameters,functionName:t.libraryFunction.name,numArguments:t.numArguments}};break;case l().IA.FunctionCallUnexpectedArgument:o={...r().Xz.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().IA.FunctionCallArgumentWrongType:o={...r().Xz.FunctionCallArgumentWrongType,values:{argumentType:c(t.argument.type.type),functionName:t.libraryFunction.name}};break;case l().IA.MemberPropertyMismatchCollection:o={...r().Xz.MemberPropertyMismatchCollection,values:{propertyName:t.token.property}};break;case l().IA.MemberPropertyMissing:o={...r().Xz.MemberPropertyMissing,values:{propertyName:t.property}};break;case l().IA.MemberPropertyTargetNotBlock:o=r().Xz.MemberPropertyTargetNotBlock;break;case l().IA.MemberPropertyTypeInvalid:o={...r().Xz.MemberPropertyTypeInvalid,values:{propertyName:t.propertyName,propertyType:t.propertyType}};break;case l().IA.UndefinedIdentifier:o={...r().Xz.UndefinedIdentifier,values:{identifier:t.node.text}};break;case l().IA.UnifiedFunctionCannotFindFunction:o={...r().Xz.UnifiedFunctionCannotFindFunction,values:{functionName:t.name}};break;case l().IA.UnifiedFunctionNoArguments:o={...r().Xz.UnifiedFunctionNoArguments,values:{functionName:t.libraryFunction.name}};break;case l().IA.UnifiedFunctionTargetWrongType:o={...r().Xz.UnifiedFunctionTargetWrongType,values:{functionName:t.libraryFunction.name,targetType:c(t.expression.type.type)}};break;case l().IA.CannotRelativelyCompareTypes:o={...r().Xz.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case l().IA.CannotDoMathOnType:o={...r().Xz.CannotDoMathOnType,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case l().IA.UnaryMinusOnNonNumber:o={...r().Xz.UnaryMinusOnNonNumber,values:{type:c(t.expression.type.type)}};break;case l().IA.IdentifierExpected:o=r().Xz.IdentifierExpected;break;case l().IA.FunctionCallExpected:o={...r().Xz.FunctionCallExpected,values:{functionName:t.functionName}};break;case l().IA.RenamedIdentifier:o={...r().Xz.RenamedIdentifier,values:{identifier:t.identifier,renamedTo:t.renamedTo}};break;case l().IA.RemovedFunction:o={...r().Xz.RemovedFunction,values:{functionName:t.functionName,alternative:t.alternative}};break;case l().IA.ContextVariableNotBlockWithCollection:o={...r().Xz.ContextVariableNotBlockWithCollection,values:{valueId:t.token.contextValueId}};break;case l().IA.MissingPropertyOnContextVariable:o={...r().Xz.MissingPropertyOnContextVariable,values:{propertyName:t.property,valueId:t.token.contextValueId}};break;case l().IA.BlockPropertyTypeInvalid:o={...r().Xz.BlockPropertyTypeInvalid,values:{propertyName:t.propertyName}};break;case l().IA.DisallowedReturnType:{const n=t.allowedReturnTypes.map((t=>e.formatMessage((0,a().getHumanReadableType)(t)).toLocaleLowerCase()));o={...r().Xz.DisallowedReturnType,values:{allowedReturnType:e.formatList(n,{style:"long",type:"conjunction"}),allowedReturnTypeCount:t.allowedReturnTypes.length,returnType:e.formatMessage((0,a().getHumanReadableType)(t.returnType)).toLocaleLowerCase()}};break}case l().IA.CrossSpacePropertyNotSupported:o={...r().Xz.CrossSpacePropertyNotSupported};break;default:(0,i().HB)(t)}return{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}}function m(e,t){let o;switch(t.type){case l().uW.MissingThisRow:o=r().X8.MissingThisRow;break;case l().uW.MissingSchemaPropertyOnThisRow:o={...r().X8.MissingSchemaPropertyOnThisRow,values:{propertyName:t.property}};break;case l().uW.ThisRowBlockPropertyMismatchCollection:o=r().X8.ThisRowBlockPropertyMismatchCollection;break;case l().uW.MissingContextVariable:o={...r().X8.MissingContextVariable,values:{valueId:t.valueId}};break;case l().uW.IdentifierNotFound:o={...r().X8.IdentifierNotFound,values:{identifier:t.node.text}};break;case l().uW.CannotRelativelyCompareTypes:o={...r().X8.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType),rhsType:c(t.rhsType)}};break;case l().uW.CannotDoMathOnType:o={...r().X8.CannotDoMathOnType,values:{valueType:c(t.valueType)}};break;case l().uW.CannotCallNonFunction:o={...r().X8.CannotCallNonFunction,values:{calleeType:c(t.calleeType)}};break;case l().uW.UnifiedFunctionPropertyNotFound:o={...r().X8.UnifiedFunctionPropertyNotFound,values:{functionName:t.node.name}};break;case l().uW.LibraryFunctionExecutionError:const n=t.error instanceof l().x4?t.error:void 0;o=(null==n?void 0:n.info.type)===l().v3.DateInvalidDurationUnit?{...r().gW.DateInvalidDurationUnit,values:{functionName:t.libraryFunction.name,invalidUnit:n.info.invalidUnit}}:(null==n?void 0:n.info.type)===l().v3.CannotUseToNumberOnList?{...r().gW.CannotUseToNumberOnList}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToNonInteger?{...r().gW.CannotRoundToNonInteger,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToTooManyDecimalPlaces?{...r().gW.CannotRoundToTooManyDecimalPlaces,values:{precision:n.info.precision}}:{...r().X8.LibraryFunctionExecutionError,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallTooFewArguments:o={...r().X8.FunctionCallTooFewArguments,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallUnexpectedArgument:o={...r().X8.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallArgumentWrongType:o={...r().X8.FunctionCallArgumentWrongType,values:{functionName:t.libraryFunction.name,argumentType:c(t.argumentType)}};break;case l().uW.AccessingPropertyOnNonBlock:o=r().X8.AccessingPropertyOnNonBlock;break;case l().uW.MissingDataDependencyBlock:o={...r().X8.MissingDataDependencyBlock,values:{blockId:t.blockPointer.id}};break;case l().uW.MissingDataDependencyPerson:o={...r().X8.MissingDataDependencyPerson,values:{personId:t.personPointer.id}};break;case l().uW.MemberPropertyMismatchCollection:o=r().X8.MemberPropertyMismatchCollection;break;case l().uW.MissingPropertyOnSchemaForMemberProperty:o=r().X8.MissingPropertyOnSchemaForMemberProperty;break;case l().uW.UnaryMinusOnNonNumber:o={...r().X8.UnaryMinusOnNonNumber,values:{expressionType:c(t.expressionType)}};break;case l().uW.UnexpectedRecoveryNode:o=r().X8.UnexpectedRecoveryNode;break;case l().uW.UnexpectedError:o=r().X8.UnexpectedError;break;case l().uW.DepthExceeded:o=r().X8.DepthExceeded;break;case l().uW.CycleDetected:o=r().X8.CycleDetected;break;case l().uW.DownstreamParseFailure:o=r().X8.DownstreamParseFailure;break;case l().uW.MaxEvaluationTimeExceeded:o=r().X8.MaxEvaluationTimeExceeded;break;case l().uW.MissingSchemaPropertyOnCollection:o={...r().X8.MissingSchemaPropertyOnCollection,values:{collectionId:t.collectionId,propertyName:t.property}};break;case l().uW.ContextVariableWrongType:o={...r().X8.ContextVariableWrongType,values:{expectedType:t.expectedType,propertyType:t.resultType,valueId:t.valueId}};break;case l().uW.DisallowedValueType:{const n=t.allowedValueTypes.map((t=>e.formatMessage((0,a().getHumanReadableType)(t)).toLocaleLowerCase()));o={...r().Xz.DisallowedReturnType,values:{allowedValueType:e.formatList(n,{style:"long",type:"conjunction"}),allowedValueTypeCount:t.allowedValueTypes.length,valueType:e.formatMessage((0,a().getHumanReadableValueType)(t.expressionValue)).toLocaleLowerCase()}};break}default:(0,i().HB)(t)}return(0,s().li)(t)?{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}:o}function g(e){const t=null==e?void 0:e.values;return[n().cJ(e,"values"),t]}function y(e){return e.type===l().uW.DepthExceeded||e.type===l().uW.CycleDetected||e.type===l().uW.MaxEvaluationTimeExceeded||e.type===l().uW.LibraryFunctionExecutionError}},311308:(e,t,o)=>{o.d(t,{r:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("bell",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},327665:(e,t,o)=>{o.d(t,{y:()=>a});o(242343);var n=()=>o(174114),i=o(163643);function a(e){let{icon:t,backgroundColor:o,backgroundSize:a}=e;const r=(0,n().IS)((e=>({iconContainer:{height:a??28,width:a??28,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",background:o??e.tint.regular}})),[o,a]);return(0,i.jsx)("div",{style:r.iconContainer,children:t})}},328653:(e,t,o)=>{o.d(t,{d:()=>a});var n=()=>o(758989);const i={light:{gray:{stroke:{secondary:"rgba(84, 72, 49, 0.15)"},fill:{primary:"rgba(84, 72, 49, 0.15)",secondary:"rgba(84, 72, 49, 0.08)",tertiary:"rgba(84, 72, 49, 0.04)"},text:{primary:"#1D1B16"}},red:{stroke:{secondary:"rgba(244, 171, 159, 0.40)"},fill:{primary:"rgba(244, 171, 159, 0.40)",secondary:"rgba(244, 171, 159, 0.40)",tertiary:"rgba(243, 136, 118, 0.07)"},text:{primary:"#5D1715"}},brown:{stroke:{secondary:"rgba(210, 162, 141, 0.35)"},fill:{primary:"rgba(210, 162, 141, 0.35)",secondary:"rgba(210, 162, 141, 0.17)",tertiary:"rgba(210, 162, 141, 0.07)"},text:{primary:"#442A1E"}},orange:{stroke:{secondary:"rgba(224, 124, 57, 0.27)"},fill:{primary:"rgba(224, 124, 57, 0.27)",secondary:"rgba(224, 124, 57, 0.15)",tertiary:"rgba(224, 124, 57, 0.07)"},text:{primary:"#49290E"}},yellow:{stroke:{secondary:"rgba(236, 191, 66, 0.39)"},fill:{primary:"rgba(236, 191, 66, 0.39)",secondary:"rgba(215, 177, 24, 0.15)",tertiary:"rgba(215, 177, 24, 0.07)"},text:{primary:"#402C1B"}},green:{stroke:{secondary:"rgba(123, 183, 129, 0.27)"},fill:{primary:"rgba(123, 183, 129, 0.27)",secondary:"rgba(123, 183, 129, 0.15)",tertiary:"rgba(123, 183, 129, 0.07)"},text:{primary:"#1C3829"}},blue:{stroke:{secondary:"rgba(93, 165, 206, 0.27)"},fill:{primary:"rgba(93, 165, 206, 0.27)",secondary:"rgba(95, 167, 208, 0.15)",tertiary:"rgba(91, 166, 209, 0.07)"},text:{primary:"#183347"}},purple:{stroke:{secondary:"rgba(168, 129, 197, 0.27)"},fill:{primary:"rgba(168, 129, 197, 0.27)",secondary:"rgba(204, 170, 229, 0.15)",tertiary:"rgba(206, 175, 229, 0.07)"},text:{primary:"#412454"}},pink:{stroke:{secondary:"rgba(225, 136, 179, 0.27)"},fill:{primary:"rgba(225, 136, 179, 0.27)",secondary:"rgba(235, 159, 196, 0.15)",tertiary:"rgba(231, 147, 188, 0.07)"},text:{primary:"#4C2337"}}},dark:{gray:{stroke:{secondary:"rgba(255, 255, 255, 0.09)"},fill:{primary:"rgba(255, 255, 255, 0.13)",secondary:"rgba(255, 255, 255, 0.09)",tertiary:"rgba(255, 255, 255, 0.03)"},text:{primary:"rgba(255, 255, 255, 0.81)"}},red:{stroke:{secondary:"rgba(222, 85, 85, 0.25)"},fill:{primary:"rgba(222, 85, 84, 0.30)",secondary:"rgba(222, 85, 84, 0.30)",tertiary:"rgba(222, 85, 88, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},brown:{stroke:{secondary:"rgba(184, 101, 69, 0.25)"},fill:{primary:"rgba(184, 101, 68, 0.30)",secondary:"rgba(184, 101, 68, 0.30)",tertiary:"rgba(184, 101, 72, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},orange:{stroke:{secondary:"rgba(233, 126, 37, 0.20)"},fill:{primary:"rgba(233, 126, 36, 0.30)",secondary:"rgba(233, 126, 36, 0.30)",tertiary:"rgba(233, 126, 40, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},yellow:{stroke:{secondary:"rgba(179, 129, 61, 0.20)"},fill:{primary:"rgba(231, 161, 55, 0.30)",secondary:"rgba(231, 161, 55, 0.30)",tertiary:"rgba(162, 105, 50, 0.10)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},green:{stroke:{secondary:"rgba(45, 153, 100, 0.20)"},fill:{primary:"rgba(45, 153, 100, 0.30)",secondary:"rgba(45, 153, 100, 0.30)",tertiary:"rgba(45, 153, 100, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},blue:{stroke:{secondary:"rgba(51, 126, 169, 0.20)"},fill:{primary:"rgba(51, 126, 169, 0.33)",secondary:"rgba(51, 126, 169, 0.33)",tertiary:"rgba(51, 126, 169, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},purple:{stroke:{secondary:"rgba(155, 97, 211, 0.18)"},fill:{primary:"rgba(155, 97, 211, 0.28)",secondary:"rgba(155, 97, 211, 0.28)",tertiary:"rgba(155, 97, 211, 0.08)"},text:{primary:"rgba(255, 255, 255, 0.87)"}},pink:{stroke:{secondary:"rgba(220, 76, 145, 0.22)"},fill:{primary:"rgba(220, 76, 145, 0.30)",secondary:"rgba(220, 76, 145, 0.30)",tertiary:"rgba(220, 76, 145, 0.06)"},text:{primary:"rgba(255, 255, 255, 0.87)"}}}};function a(e,t){const o=(0,n().VA)(e),a="lightgray"===o?"gray":o;return{...i[t.mode][a],icon:{primary:n().l8[t.mode][a]}}}},333212:(e,t,o)=>{o.d(t,{Lq:()=>n,WK:()=>a,nh:()=>i});const n=40,i=48,a=60},345022:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=function(e){let{style:t,styleParentContainer:i,isTriColored:a}=e;const r=(0,o(653998).tz)();return(0,n.jsxs)("div",{"aria-valuetext":r.formatMessage({id:"loadingDots.label",defaultMessage:"Loading..."}),role:"progressbar",className:"loading-dots",style:{...i},children:[(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#F6C050"}}}),(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#ED6A5F"}}}),(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#5F9CDB"}}})]})}},350492:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,questionMarkCircleSmallIcon:()=>a});o(242343);var n=o(163643);const i={viewBox:"0 0 16 16",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.98 4.456c-1.044 0-2.053.604-2.298 1.584a.575.575 0 1 0 1.116.279c.083-.334.513-.713 1.183-.713.79 0 1.204.49 1.204.85 0 .219-.134.47-.443.658l-.011.006-.67.458-.003.002a1.82 1.82 0 0 0-.803 1.488.575.575 0 1 0 1.15 0c0-.193.102-.4.306-.541l.642-.44c.554-.342.982-.92.982-1.63 0-1.22-1.179-2-2.354-2m-.118 5.688a.775.775 0 1 0 0 1.55.775.775 0 0 0 0-1.55"}),(0,n.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},a=(0,o(680369).wt)("questionMarkCircleSmall",i)},350826:(e,t,o)=>{o.d(t,{II:()=>h,qC:()=>f});var n=o(242343),i=()=>o(803290),a=()=>o(174114),r=()=>o(630714),l=()=>o(960194),s=()=>o(653998),c=()=>o(31448),u=()=>o(275334),d=()=>o(993517),p=()=>o(100096),m=()=>o(834508),g=()=>o(604104),y=o(163643);function h(e){const{actionMenu:t,buttonPopupStore:o,disabled:h,onClick:v,propertySchema:x,value:b}=e,S=(0,s().tz)(),C=(0,a().IS)((()=>({content:{alignItems:"baseline"},propertyName:{...c().RC,fontWeight:c().Wy.medium}})),[]),A=(0,i().K8)((()=>function(e){const{intl:t,propertySchema:o,styles:n,value:i}=e;if(!i)return;const a=(0,y.jsx)("span",{style:n.propertyName,children:o.name});if("formula"===i.type)return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:a,propertyValue:(0,y.jsx)(g().g,{returnType:{type:"text"}})})});const l=(0,r().fromSimpleFormulaArrayValue)(null==i?void 0:i.value)[0];if("string"!=typeof l)return;const c=(0,m().a)({intl:t,groupValues:[],optionValues:[l],propertySchema:o});if(0===c.length)return;return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:a,propertyValue:c})})}({intl:S,propertySchema:x,styles:C,value:b})),[S,x,C,b]),k=(0,i().K8)((()=>f({intl:S,propertySchema:x,value:b})),[S,x,b]),M=(0,n.useCallback)((e=>(0,y.jsx)(p().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:h,icon:l().T,onClick:v,children:(0,y.jsx)("div",{style:C.content,children:A})})),[t,o,h,v,C.content,A]);return A&&k?(0,y.jsx)(d().P,{renderOrigin:M,title:k}):null}function f(e){const{intl:t,propertySchema:o,value:n}=e;if(!n)return;const i=o.name;if("formula"===n.type)return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:i,propertyValue:(0,y.jsx)(g().L,{})})});const a=(0,r().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0];if("string"!=typeof a)return;const l=(0,m().a)({intl:t,isText:!0,groupValues:[],optionValues:[a],propertySchema:o});return 0!==l.length?(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:i,propertyValue:l})}):void 0}},354148:(e,t,o)=>{o.d(t,{Wx:()=>r,fM:()=>n,l9:()=>i,sM:()=>a});const n=new(o(129978).O2)("framer-motion",(async()=>await Promise.all([o.e(44711),o.e(53321),o.e(37043)]).then(o.bind(o,196959))));function i(e){return e.useAnimate()}function a(e){return e.useAnimation()}function r(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return e.useInView(...o)}},358780:(e,t,o)=>{o.d(t,{D:()=>Y,y9:()=>K});o(725707),o(500234);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(268163);const s=2e3;var c=()=>o(465546),u=()=>o(630714),d=()=>o(242103),p=()=>o(34662),m=()=>o(653998),g=()=>o(975392),y=()=>o(76394),h=()=>o(31448),f=()=>o(759625),v=()=>o(384221),x=()=>o(421338),b=()=>o(273520),S=()=>o(289051),C=()=>o(782422),A=()=>o(213517),k=()=>o(352723),M=()=>o(622286),j=()=>o(962373),T=()=>o(773082),I=()=>o(363043),w=()=>o(271142),_=()=>o(765618),P=()=>o(459845),B=()=>o(738355),R=()=>o(982008),V=()=>o(265405),E=()=>o(179701),D=()=>o(698548),F=()=>o(498248),O=()=>o(284573),N=()=>o(100096),L=()=>o(231556),W=o(163643);const z=(0,m().YK)({slackCustomMessageLabel:{defaultMessage:"Custom message",id:"automations.SlackNotificationAction.customMessageLabel"},invalidChannelLabel:{defaultMessage:"Invalid channel",id:"slackNotificationAction.slackTargetChannel.invalidChannel"},hiddenChannelLabel:{defaultMessage:"Hidden channel",id:"slackNotificationAction.slackTargetChannel.hiddenName"},noTargetChannelLabel:{id:"slackNotificationAction.targetPicker.noTarget",defaultMessage:"Select Slack channel"}});function K(e){const{actionStore:t}=e,o=oe(t),{automationStore:r}=(0,w().EC)(),{disabled:d,maybePersistedTransactionActions:g,suppressActionErrors:h}=(0,B().b)(),b=(0,l().getActionRegistryItem)("slack_notification"),S=Boolean(d),C=ee(r)?(0,W.jsx)(_().TooltipWithSubtitle,{content:(0,W.jsx)(m().sA,{..._().automationErrorMessages.slackNotificationAuthenticationError})}):null,k=(0,a().uB)(void 0,j().A),T=(0,n.useCallback)((()=>k.reset()),[k]),I=(0,n.useMemo)((()=>(0,W.jsx)(D().z,{actionStore:t,closeMenu:T})),[t,T]),E=(0,n.useMemo)((()=>!h.includes(t.id)),[h,t]),{errorMessage:F}=(0,_().useErrorComponentForAction)({actionId:t.id,errorKey:"external_bot_id",shouldShow:E}),{errorMessage:O}=(0,_().useErrorComponentForAction)({actionId:t.id,errorKey:"target",shouldShow:E}),K=(0,a().K8)((()=>t.getSpaceId()),[t]),U=(0,a().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.custom_message}),[t]),Y=(0,V().F)({actionId:t.id}),G=(0,a().K8)((()=>{if(K)return(0,u().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,c().zg)(t.getRecordModel),spaceId:K,valueTypes:Y.slice(0),featureGates:(0,A().i)()},value:U})}),[t.getRecordModel,U,Y,K]),q=(0,M().X)("automation_slack_fast_processor"),{onTextStoreSelect:X,onTextStoreUnselect:$}=(0,R().W)(t),J=(0,i().v3)(),Q=(0,n.useCallback)((()=>{v().clear({environment:J})}),[J]),Z=(0,n.useCallback)((e=>{const o=null==e?void 0:e.value;(!(0,y().O9)(o)||(0,p().AhH)(o)<=s)&&(g.createAndCommit({perform:o=>{f().zv({data:{custom_message:e},store:t.getConfigStore(),transaction:o})},userAction:"SlackNotificationAction.setCustomMessage"}),(0,P().UB)(J,{automationStore:r,automationActionStore:t}))}),[t,r,J,g]);return K&&G?(0,W.jsxs)(N().OT,{actionMenu:I,buttonPopupStore:k,disabled:S,actionId:t.id,canCollapse:!1,children:[(0,W.jsx)(N().h3,{actionId:t.id,actionRegistryItem:b,disabled:S,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,W.jsx)(H,{actionStore:t,automationStore:r,disabled:S,errorMessage:C??F??O})}),q&&(0,y().O9)(o)&&(0,W.jsx)(N().qt,{children:(0,W.jsx)(x().Y1,{direction:"vertical",gap:16,children:(0,W.jsx)(L().M,{analyzedFormulaOutput:G,labelMessageDescriptor:z.slackCustomMessageLabel,disabled:S,disableMobileActionBar:!0,disableStyleAnnotations:!1,disableFormulas:!1,disableMentions:!1,isOptional:!0,formulaTypecheckContextValues:Y,parentRecordStore:t,rows:5,spaceId:K,value:U,onChange:Z,onTextStoreSelect:X,onTextStoreUnselect:$,onTextEsc:Q})})})]}):null}function H(e){const{actionStore:t,automationStore:o,disabled:n,errorMessage:i}=e;return(0,W.jsx)(m().sA,{defaultMessage:"Notify{slackTargetPicker}",id:"automations.slackNotificationAction.action.title",values:{slackTargetPicker:(0,W.jsx)(U,{actionStore:t,automationStore:o,disabled:n,errorMessage:i})}})}function U(e){const{actionStore:t,automationStore:o,disabled:i,errorMessage:r}=e,l=(0,a().K8)((()=>{const e=t.getConfigStore(),o=e.getKeyStore("external_bot_id").getValue();if((0,g().Im)(o))return!1;const n=e.getKeyStore("target").getValue();return!(0,g().Im)(null==n?void 0:n.id)}),[t]),s=(0,a().uB)(void 0,j().A),c=(0,n.useCallback)((()=>s.reset()),[s]),u=function(e){const{actionStore:t,automationStore:o}=e,[n,i]=(0,a().K8)((()=>{const e=t.getConfigStore();return[e.getKeyStore("target").getValue(),e.getKeyStore("external_bot_id").getValue()]}),[t]),r=ee(o),{currentExternalAuthentication:l}=Z(t),s=(0,a().K8)((()=>T().A.completeSlackAuthentications.state.length??0),[]);if((0,y().O9)(n)&&(0,y().O9)(i))return r?{actionStore:t,externalBotId:i,notificationActionConfigStore:t,type:"connectToSlackReconnect"}:(0,y().O9)(l)?{actionStore:t,currentExternalAuthentication:l,currentNotificationChannel:n,type:"selectChannelUpdate"}:{actionStore:t,type:"connectToSlackDefault"};return 0===s?{actionStore:t,type:"connectToSlackDefault"}:s>1?{actionStore:t,type:"selectWorkspace"}:{actionStore:t,type:"selectChannelNew"}}({actionStore:t,automationStore:o}),d=(0,E().j)();return(0,W.jsx)(b().Ay,{alignmentToOrigin:b().yP.End,buttonPopupStore:s,disabled:i,originGap:0,placementToOrigin:b().sx.Bottom,popupType:d,renderOrigin:e=>(0,W.jsx)(O().x,{...e,disabled:i,isCompact:!0,isError:Boolean(r),hasActionRequired:!l,dropdownButtonType:"dropdown",children:l?(0,W.jsx)(Y,{actionStore:t}):(0,W.jsx)(m().sA,{...z.noTargetChannelLabel})}),render:()=>(0,W.jsx)(F().A,{initialState:u,onClose:c})})}function Y(e){const{actionStore:t}=e,o=(0,i().v3)(),n=(0,a().K8)((()=>{const e=(0,C().ZO)();return!(0,y().O9)(e)||Boolean((0,k().qb)(o,e))}),[o]),r=oe(t),{authenticationState:l}=Z(t);return"invalid_channel"===l?(0,W.jsx)(Q,{}):n||!(0,y().O9)(r)?(0,W.jsx)(J,{}):"me"===r.type?(0,W.jsx)(X,{channelName:r.name}):"private"===r.type?(0,W.jsx)(q,{channelName:r.name}):"public"===r.type?(0,W.jsx)(G,{channelName:r.name}):"im"===r.type?(0,W.jsx)($,{channelName:r.name}):void(0,y().HB)(r.type)}function G(e){return(0,W.jsx)("span",{style:h().RC,children:`#${e.channelName}`})}function q(e){const{channelName:t}=e,o=te();return(0,W.jsxs)("div",{style:o.container,children:[(0,d().S)(o.lockIcon),(0,W.jsx)("span",{style:h().RC,children:t})]})}function X(e){const{channelName:t}=e;return(0,W.jsx)("span",{style:h().RC,children:`@${t}`})}function $(e){const{channelName:t}=e;return(0,W.jsx)("span",{style:h().RC,children:`@${t}`})}function J(){const e=te();return(0,W.jsxs)("div",{style:e.container,children:[(0,d().S)(e.lockIcon),(0,W.jsx)("span",{style:h().RC,children:(0,W.jsx)(m().sA,{...z.hiddenChannelLabel})})]})}function Q(){const e=te();return(0,W.jsx)("div",{style:e.container,children:(0,W.jsx)("span",{style:h().RC,children:(0,W.jsx)(m().sA,{...z.invalidChannelLabel})})})}function Z(e){return(0,a().K8)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(!t)return{authenticationState:"invalid_channel",currentExternalAuthentication:void 0};const o=T().A.completeSlackAuthentications.state.find((e=>t===e.id));return(0,y().O9)(o)?{authenticationState:"selected_channel",currentExternalAuthentication:o}:{authenticationState:"hidden_channel",currentExternalAuthentication:void 0}}),[e])}function ee(e){return(0,a().K8)((()=>"disabled_auth"===e.getStatus()),[e])}function te(){const{isMobile:e}=(0,i().Y0)(),t=e?h().J.UISmall.mobile:h().J.UISmall.desktop;return(0,r().IS)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}function oe(e){const t=(0,i().v3)(),o=(0,a().K8)((()=>{var t;return null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.id}),[e]),{currentExternalAuthentication:r}=Z(e);return n.useEffect((()=>{r&&(0,S().Hn)({environment:t,spaceId:r.space_id,externalAuthConfig:{type:"external",botId:r.id}})}),[t,r]),(0,a().K8)((()=>{if(r&&o){const e=I().c.getStateForBot({type:"external",botId:r.id}).channels[o];if(e)return e}}),[o,r])}},366691:(e,t,o)=>{o.d(t,{F:()=>i});class n extends(()=>o(129044))().default{getInitialState(){return{isOpen:!1}}}const i=new n},367950:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{_:()=>n})},382640:(e,t,o)=>{o.d(t,{$E:()=>T,$L:()=>l,BZ:()=>u,EC:()=>g,EI:()=>b,E_:()=>j,Ed:()=>p,Fq:()=>f,Lu:()=>C,Mk:()=>m,O0:()=>M,UO:()=>I,V$:()=>k,VQ:()=>y,Xx:()=>S,Xy:()=>c,YS:()=>h,_g:()=>x,dd:()=>d,pW:()=>s,q3:()=>r,wH:()=>a});var n=()=>o(975392),i=()=>o(76394);const a=160,r=40,l=24,s=20,c=600,u=270,d=405,p=480,m=500,g=void 0,y=16,h=10,f=8,v=(o(333212).nh,{backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"}),x=4;function b(e){return{icon:e.mediumIconColor,text:e.text.secondary}}function S(e){return{width:48,height:48,fill:e.lightIconColor}}function C(e){let{theme:t,isPhone:o}=e;return o?t.personalHomeBackgroundPhone:t.surface.page}const A=1;function k(e){let{isPhone:t,theme:o}=e;return{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:12,background:o.home.tile.background,boxShadow:j({isPhone:t,theme:o}),...v}}function M(e){let{mode:t}=e;switch(t){case"dark":return 0;case"light":return A;default:return(0,i().ub)(t),0}}function j(e){let{isPhone:t,theme:o,borderOnly:i}=e;if("dark"===o.mode)return"unset";o.mode;const a=M({mode:o.mode});return(0,n().oE)([i||t?void 0:"0 12px 32px rgba(0, 0, 0, 0.02)",`0 0 0 ${a}px rgba(0, 0, 0, 0.05)`]).join(", ")}function T(e){return{display:"flex",flexDirection:"column",width:"100%",gap:24}}function I(e){const{isPhone:t,theme:o,borderOnly:n}=e;return{unhoveredBoxShadow:j({isPhone:t,theme:o,borderOnly:n}),hoveredBoxShadow:"light"===o.mode?["0 12px 32px rgba(0, 0, 0, 0.03)","0 0 0 1px rgba(0, 0, 0, 0.085)"].join(", "):o.homeShadow.card.hovered}}},386311:(e,t,o)=>{o.d(t,{I:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("loop",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M5.80371 3.12305C5.81006 3.50391 6.05762 3.74512 6.47656 3.74512H11.3643C11.9546 3.74512 12.2783 4.0498 12.2783 4.66553V11.2925L11.377 10.3149L10.8628 9.80078C10.5962 9.54688 10.2344 9.52783 9.96777 9.78809C9.71387 10.0483 9.72021 10.4229 9.98047 10.6831L12.145 12.8413C12.6211 13.311 13.167 13.311 13.6431 12.8413L15.8076 10.6831C16.0679 10.4229 16.0742 10.0483 15.8203 9.78809C15.5537 9.52783 15.1919 9.54688 14.9253 9.80078L14.4111 10.3149L13.5161 11.2861V4.56396C13.5161 3.20557 12.8052 2.50098 11.4341 2.50098H6.47656C6.05762 2.50098 5.79736 2.74219 5.80371 3.12305ZM0.186035 7.05859C0.446289 7.3252 0.808105 7.30615 1.07471 7.0459L1.59521 6.53809L2.48389 5.56689V12.2891C2.48389 13.6475 3.19482 14.3521 4.56592 14.3521H9.52344C9.94238 14.3521 10.2026 14.1108 10.1963 13.73C10.1899 13.3428 9.94238 13.1079 9.52344 13.1079H4.64209C4.05176 13.1079 3.72803 12.7969 3.72803 12.1812V5.5542L4.62305 6.53809L5.14355 7.0459C5.40381 7.30615 5.77197 7.3252 6.03223 7.05859C6.29248 6.79834 6.28613 6.43018 6.01953 6.16992L3.85498 4.01172C3.37891 3.53564 2.83936 3.53564 2.36328 4.01172L0.19873 6.16992C-0.0678711 6.43018 -0.0742188 6.79834 0.186035 7.05859Z"})})},388732:(e,t,o)=>{o.d(t,{l:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,n.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},395705:(e,t,o)=>{o.d(t,{G:()=>l,e:()=>r});var n=o(242343),i=()=>o(174114),a=o(163643);let r=function(e){return e[e.Name=0]="Name",e[e.Type=1]="Type",e}({});const l=n.forwardRef((function(e,t){const{propertySchema:n,format:l}=e,{name:s,type:c,icon:u}=n,d=(0,o(622286).X)("nds_default_property_noticon"),{isMobile:p}=(0,o(237385).Y0)(),m=(0,i().IS)((e=>({propertyIcon:{fill:e.regularIconColor,marginLeft:6,marginRight:2}})),[]),g=(0,i().DP)(),y=l===r.Name?s:o(206183).dC[c];return(0,a.jsx)(o(535906).A,{title:y,icon:(0,a.jsx)(o(916963).zB,{icon:u,type:c,size:p?18:16,theme:g,style:m.propertyIcon,isDefaultNoticonEnabled:d}),...e})}))},399631:(e,t,o)=>{o.d(t,{Y:()=>r});var n=o(242343),i=()=>o(709237),a=o(163643);function r(e){const{blockStore:t,shouldWrap:o,titleStyle:r,recordTitleRef:l,noUnderline:s,disableTooltip:c}=e,u=(0,n.useRef)({getNode:()=>l.current});return(0,a.jsx)(i().A,{store:t,underline:!s,shouldWrap:o,style:r,ref:u,enableHover:!0,showTooltipWhenTruncated:!0,disableTooltip:c})}},404042:(e,t,o)=>{o.d(t,{A:()=>d});o(242343);var n=()=>o(803290),i=()=>o(455831),a=()=>o(653998),r=()=>o(220413),l=()=>o(31448),s=()=>o(678523),c=()=>o(943066),u=o(163643);const d=function(e){let{subscriptionTier:t,mobileStyle:d,desktopStyle:p,analyticsName:m,onClick:g,disableTooltip:y,tooltipContent:h}=e;const f=(0,o(174114).DP)(),v=(0,o(237385).v3)(),{device:x}=v,b=(0,n().K8)((()=>{const{currentSpaceStore:e}=o(485966).default.state;return null==e?void 0:e.canAdmin()}),[]),S=(0,n().K8)((()=>function(e,t){switch(e){case"plus":case"business":case"enterprise":return{color:t.blueColor,background:"light"===t.mode?r().Ay.diffBackground:"rgba(35, 131, 226, 0.2)",fontWeight:l().Wy.medium};default:return{}}}(t,f)),[t,f]);if(x.isMobileNative)return null;let C;return"personal"===t?C=(0,u.jsx)(a().sA,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"}):(0,i().$P)(t)?C=(0,u.jsx)(a().sA,{defaultMessage:"Plus ↗",id:"upgradeButton.plus.textWithArrow"}):(0,i().tL)(t)?C=(0,u.jsx)(a().sA,{defaultMessage:"Business ↗",id:"upgradeButton.business.textWithArrow"}):(0,i().OX)(t)?C=(0,u.jsx)(a().sA,{defaultMessage:"Enterprise ↗",id:"upgradeButton.enterprise.textWithArrow"}):(0,o(76394).HB)(t),x.isMobile||!b?(0,u.jsx)(s().A,{mobileStyle:d,children:C}):(0,u.jsx)(o(103151).A,{delayThreshold:120,disableTooltip:y,placement:o(907721).W.Bottom,renderTooltip:()=>(0,u.jsx)("div",{style:{maxWidth:500},children:h?(0,u.jsx)(a().sA,{defaultMessage:"{tooltipText}",id:"upgradeButton.upgrade.custom.tooltip",values:{tooltipText:h}}):(0,u.jsx)(a().sA,{defaultMessage:"Upgrade to use this feature.",id:"upgradeButton.upgrade.tooltip"})}),originGap:6,render:e=>(0,u.jsx)(s().A,{desktopStyle:p,innerStyle:S,onClick:e=>function(e,t,o,n,i){c().K(n,{from:t,upsell:{type:"product",product:o,limit:{type:"none"},trialability:"none"}}),i&&i(e)}(e,m,t,v,g),...e,children:C})})}},415806:(e,t,o)=>{o.d(t,{Ay:()=>f,t_:()=>v,v7:()=>x});o(242343);var n=()=>o(237385),i=()=>o(803290),a=()=>o(950635),r=()=>o(752903),l=()=>o(76394),s=()=>o(413871),c=()=>o(888575),u=()=>o(951156),d=()=>o(151258),p=()=>o(732165),m=()=>o(482570),g=o(163643);function y(e){const t=(0,n().v3)(),{actor:o,format:a,hasTooltip:y,tooltipHeader:f}=e,v=(0,i().K8)((()=>{const e=o.asActor;return e&&s().sk.createUniqueRootStore(t,e.pointer)}),[o,t]);return(0,g.jsx)(d().Ay,{...e,renderAvatar:e=>{if(v)return v instanceof s().vK?a===r().NY.Inline?(0,g.jsx)(u().A,{botStore:v,size:e,style:h}):(0,g.jsx)(c().A,{botStore:v,avatarSize:e,inline:!0,style:h}):v instanceof s().LU?a===r().NY.Inline?(0,g.jsx)(m().A,{userStore:v,size:e,avatarShouldShowShadow:!0,hasTooltip:y??!0,style:h,tooltipHeader:f}):(0,g.jsx)(p().A,{userStore:v,avatarSize:e,inline:!0,hasTooltip:y,style:h,tooltipHeader:f}):void(v instanceof s().pH||(0,l().HB)(v))}})}const h={minWidth:0};y.Format=r().NY;const f=y;function v(e){const{userValue:t,...o}=e;return(0,g.jsx)(y,{actor:(0,a().MR)(t),...o})}function x(e){const{botValue:t,...o}=e;return(0,g.jsx)(y,{actor:(0,a().oC)(t),...o})}v.Format=d().mI,x.Format=d().mI},434626:(e,t,o)=>{o.r(t),o.d(t,{eyeIcon:()=>a,iconDefinition:()=>i});o(242343);var n=o(163643);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_9098_13290)",children:[(0,n.jsx)("path",{d:"M10 13.504a3.5 3.5 0 1 0-.001-7.002A3.5 3.5 0 0 0 10 13.504m1.167-3.502a1.168 1.168 0 1 1-2.335.002 1.168 1.168 0 0 1 2.335-.002"}),(0,n.jsx)("path",{d:"M10 3.895c-4.093 0-7.662 2.189-9.351 5.408-.231.44-.231.964 0 1.404 1.689 3.22 5.258 5.408 9.351 5.408s7.662-2.189 9.351-5.408c.231-.44.231-.964 0-1.404-1.689-3.22-5.258-5.408-9.351-5.408m-8.245 5.99C3.218 7.096 6.347 5.144 10 5.144s6.782 1.952 8.245 4.74a.26.26 0 0 1 0 .24c-1.463 2.788-4.592 4.74-8.245 4.74s-6.782-1.952-8.245-4.74a.26.26 0 0 1 0-.24"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_9098_13290",children:(0,n.jsx)("path",{d:"M0 0h20v20H0z"})})})]})},a=(0,o(680369).wt)("eye",i)},448865:(e,t,o)=>{o.d(t,{AL:()=>a,Q6:()=>l,vt:()=>r});o(725707),o(500234);var n=()=>o(65866),i=()=>o(964456);const a={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function r(e){const{eventTracker:t,properties:o}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:o})}function l(e,t){var o;return null===(o=t.groups)||void 0===o||null===(o=o.find((t=>t.id===n().nl||(null==t?void 0:t.name)===i().P0||(null==t?void 0:t.name)===e.formatMessage(i().oz.statusGroupNameComplete))))||void 0===o?void 0:o.name}},449148:(e,t,o)=>{o.d(t,{D:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"m3.625 11.151 1.187-1.187a.625.625 0 1 1 .884.884l-2.254 2.254a.625.625 0 0 1-.884 0L.304 10.848a.625.625 0 0 1 .884-.884l1.187 1.187V10a7.625 7.625 0 0 1 12.814-5.587.625.625 0 1 1-.851.915A6.375 6.375 0 0 0 3.625 10zm14-2.302 1.187 1.187a.625.625 0 1 0 .884-.884l-2.254-2.254a.625.625 0 0 0-.884 0l-2.254 2.254a.625.625 0 1 0 .884.884l1.187-1.187V10a6.375 6.375 0 0 1-10.713 4.672.625.625 0 0 0-.85.915A7.625 7.625 0 0 0 17.625 10z"})},i=(0,o(680369).wt)("arrowCircleLoop",n)},462156:(e,t,o)=>{o.d(t,{p:()=>v,t:()=>x});o(403517),o(242343);var n=()=>o(237385),i=()=>o(803290),a=()=>o(712437),r=()=>o(653998),l=()=>o(191756),s=()=>o(686985),c=()=>o(858023),u=()=>o(701513),d=()=>o(88271),p=()=>o(842492),m=()=>o(302376),g=()=>o(216143),y=()=>o(366691),h=()=>o(248584),f=o(163643);function v(e){let{store:t}=e;return(0,f.jsx)("div",{style:{width:"100%",maxWidth:"100%",margin:"0 auto 6px auto"},onMouseDown:h().NV,onClick:h().sx,children:(0,f.jsx)(s().A,{type:"page",store:t,headerText:(0,f.jsx)(r().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"}),disableCurrentPageToken:!0,disableInaccessiblePages:!0})})}function x(e){let{store:t}=e;const o=(0,n().v3)(),r=(0,i().K8)((()=>(0,p().c)(t,o)),[t,o]),s=(0,i().K8)((()=>r.backlinks.map((e=>e.backlinkStore))),[r]).map(((e,t)=>({key:e.id,render:t=>(0,f.jsx)(u().A,{...t,store:e,hidePath:!1}),action:t=>{let{event:n}=t;y().F.setState({isOpen:!1});const i=m().Vr(n);l().uK({environment:o,store:e,openInNew:i,visitType:g().ig.Link,pageVisitSource:a().y8.Backlinks})}})));return(0,f.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:[{key:"all",items:s,render:e=>(0,f.jsx)(d().A,{...e})}]})}},463013:(e,t,o)=>{o.d(t,{A:()=>a});o(242343);var n=()=>o(966789),i=o(163643);function a(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().A,{})})}},474894:(e,t,o)=>{o.d(t,{z:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("slackLogo",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,n.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,n.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,n.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,n.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,n.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,n.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,n.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},475923:(e,t,o)=>{o.d(t,{Bd:()=>l,DN:()=>g,II:()=>x,R8:()=>v,U9:()=>f,VM:()=>h,ZF:()=>p,ZI:()=>u,bf:()=>c,jx:()=>d,wW:()=>y,xO:()=>s});o(610931),o(242343);var n=()=>o(810111),i=()=>o(653998),a=()=>o(141122),r=o(163643);let l=function(e){return e[e.ViewSettings=0]="ViewSettings",e[e.FilterBar=1]="FilterBar",e[e.TopbarFilterPopup=2]="TopbarFilterPopup",e[e.TopbarSortPopup=3]="TopbarSortPopup",e[e.TopbarFollowPopup=4]="TopbarFollowPopup",e}({});const s=480,c=320;function u(e){const{timelineViewTab:t,collectionContextStore:o}=e,i=d({collectionContextStore:o}),a=p({collectionContextStore:o});return"timeline"===i?"timeline"===t?"timeline_properties":a?"timeline_table_properties":void 0:(0,n().u9)(d({collectionContextStore:o}))}function d(e){var t;const{collectionContextStore:o}=e,n=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getType();if(!n)throw new Error("View type was not defined.");return n}function p(e){const{collectionContextStore:t}=e,o=t.normalizedFormatStore.state;return Boolean(o.timeline_show_table)}const m=600;function g(e,t,o){const n=o||0,i=e.settingsStore.state;if(i.open&&!0!==i.hideSettingsPopup)return y(e,t,n)}function y(e,t,o){const n=o||0,i=e.settingsStore.state,r=d({collectionContextStore:e});return i.open&&"form_editor"===r||t||a().default.isSidePeekOpen()||e.isInHomeWidgetStore.state||e.isInlineViewStore.state||n<=m?"popup":"sidebar"}function h(e){let{sourceCollectionCount:t,linkedCollectionCount:o,isCollectionViewPageWithContent:n,locked:a}=e;return n?a?(0,r.jsx)(i().sA,{defaultMessage:"Unlock wiki",id:"action.unlockWikiName.name"}):(0,r.jsx)(i().sA,{defaultMessage:"Lock wiki",id:"action.lockWikiName.name"}):0===t?a?(0,r.jsx)(i().sA,{defaultMessage:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}):(0,r.jsx)(i().sA,{defaultMessage:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"}):1===t&&0===o?a?(0,r.jsx)(i().sA,{defaultMessage:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}):(0,r.jsx)(i().sA,{defaultMessage:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"}):a?(0,r.jsx)(i().sA,{defaultMessage:"Unlock databases",id:"database.viewSettings.mainTab.unlockDatabases.title"}):(0,r.jsx)(i().sA,{defaultMessage:"Lock databases",id:"database.viewSettings.mainTab.lockDatabases.title"})}let f=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({});const v=6;function x(e){let{currentViewType:t,isPlaceholderExternalCollection:o,collectionContextStore:n,allowedActions:i,settingsHeaderSizeObserver:a}=e;return"page"!==t&&"form_editor"!==t&&(!o&&(!!n.shouldAllowNewItemCreation()&&(!(i&&!i.includes("addItem"))&&!(a&&a.rect.state.width>c))))}},477267:(e,t,o)=>{o.r(t),o.d(t,{deleteViewsModuleDependencies:()=>r});var n=()=>o(496580),i=()=>o(795394),a=()=>o(413871);function r(e){const{layoutStore:t,viewsModule:o,transaction:r}=e,l=(0,n().o9)(a().Bv.createChildStore(t,o.collection_view_block_pointer));i().zz({childStore:l,parentStore:t,transaction:r})}},483019:(e,t,o)=>{o.d(t,{z:()=>l});o(242343);var n=()=>o(237385),i=()=>o(174114),a=()=>o(748267),r=o(163643);function l(e){const{children:t,icon:o}=e,l=function(){const{isMobile:e}=(0,n().Y0)();return(0,i().IS)((t=>({iconWrap:{flexGrow:0,flexShrink:0},messageWrap:{flexGrow:1},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},wrap:{alignItems:"center",display:"flex",flexDirection:"row",marginBottom:6,gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"}})),[e])}();return(0,r.jsx)("div",{style:l.wrapWrap,children:(0,r.jsxs)("div",{style:l.wrap,children:[(0,r.jsx)("div",{style:l.iconWrap,children:(0,r.jsx)("div",{style:l.lockedIconWrap,children:o||(0,a().g)(l.lockedIcon)})}),(0,r.jsx)("div",{style:l.messageWrap,children:(0,r.jsx)("p",{style:l.paragraph,children:t})})]})})}},493264:(e,t,o)=>{o.d(t,{A:()=>g});o(725707),o(491955),o(403517),o(113085);var n=o.n(o(567012)),i=o(242343),a=()=>o(564134),r=()=>o(716605),l=()=>o(653998),s=()=>o(975392),c=()=>o(640979),u=()=>o(858023),d=()=>o(88271),p=()=>o(395705),m=o(163643);const g=function(e){let{selectedProperty:t,onAccept:g,schema:y,onClose:h,allowProperty:f,isRelationProperty:v}=e;const x=(0,o(237385).v3)(),b=(0,l().tz)(),[S,C]=(0,i.useState)("");let A=Object.keys(y);const k=A.some(o(594876).u);A=s().Ul(A,(e=>{const t=(0,r()._g)({schema:y,property:e});return t?t.name:""}));const M=k?a().Ho:a().rn;if(A=s().FF(A,M),A.unshift(M),f&&(A=A.filter((e=>{const t=(0,r()._g)({schema:y,property:e});return t&&f(t)}))),S){let e=A.map((e=>{const t=(0,r()._g)({schema:y,property:e});return t&&t.name}));e=n().filter(S,e).map((e=>{let{original:t}=e;return t})),A=A.filter((t=>{const o=(0,r()._g)({schema:y,property:t});return o&&o.name&&e.includes(o.name)}))}const j=S||A.length>o(475923).R8,T=s().oE(A.map((e=>{const o=(0,r()._g)({schema:y,property:e});if(!o)return null;return{key:e,render:n=>(0,m.jsx)(p().G,{...n,propertySchema:o,format:p().e.Name,isChecked:e===t}),action:()=>g(e)}}))),I=[{key:0,render:e=>(0,m.jsx)(d().A,{...e}),items:T}],{device:w}=x,_=j?(0,m.jsx)(d().A,{isInput:!0,children:(0,m.jsx)(o(401382).Ay,{focus:!w.isMobile||void 0,focusAfterAnimation:!0,value:S,onChange:e=>C(e.target.value),placeholder:v?b.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):b.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})}):null;let P;return P=w.isMobile?{menuType:c().gu.Modal,title:v?b.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):b.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,m.jsx)(o(743668).CancelMenuText,{}),onClickRight:h,header:_}:{menuType:c().gu.Popup,width:280,maxHeight:480,header:_},(0,m.jsx)(o(935091).A,{...P,children:0===T.length?(0,m.jsx)(d().A,{children:(0,m.jsx)(o(975515).A,{title:(0,m.jsx)(l().sA,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,m.jsx)(u().Ay,{type:u().Oh.Vertical,sections:I,onAccept:h,initialFocus:S.length>0?0:void 0})})}},494082:(e,t,o)=>{o.d(t,{Z:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M7.154 3.625h1.23a.625.625 0 1 0 0-1.25h-1.23A2.625 2.625 0 0 0 4.529 5v2.069c0 .9-.508 1.722-1.313 2.124l-.317.159a.725.725 0 0 0 0 1.297l.317.158a2.38 2.38 0 0 1 1.313 2.124V15a2.625 2.625 0 0 0 2.625 2.625h1.23a.625.625 0 1 0 0-1.25h-1.23c-.76 0-1.375-.616-1.375-1.375v-2.069c0-1.17-.564-2.256-1.492-2.931a3.63 3.63 0 0 0 1.492-2.931V5c0-.76.615-1.375 1.375-1.375m5.692 12.75h-1.23a.625.625 0 1 0 0 1.25h1.23A2.625 2.625 0 0 0 15.471 15v-2.069c0-.9.508-1.722 1.313-2.124l.317-.159a.725.725 0 0 0 0-1.296l-.317-.159a2.38 2.38 0 0 1-1.313-2.124V5a2.625 2.625 0 0 0-2.625-2.625h-1.23a.625.625 0 1 0 0 1.25h1.23c.76 0 1.375.616 1.375 1.375v2.069c0 1.17.564 2.256 1.492 2.931a3.63 3.63 0 0 0-1.492 2.931V15c0 .76-.615 1.375-1.375 1.375"})},i=(0,o(680369).wt)("curlyBraces",n)},496794:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=function(e){const{title:t,href:i,analyticsFrom:a}=e,r=(0,o(237385).v3)();return(0,n.jsx)(o(579494).A,{href:i,onClick:()=>o(598995).FH(r,{from:a}),external:!0,children:(0,n.jsx)(o(44405).A,{icon:o(155342).questionMarkCircleIcon,title:t,isGray:!0})})}},498248:(e,t,o)=>{o.d(t,{S:()=>Ye,A:()=>Ge});var n=o(242343),i=()=>o(803290),a=()=>o(76394),r=()=>o(886087),l=(o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(403517),o(244387),o.n(o(567012))),s=()=>o(237385),c=()=>o(174114),u=()=>o(779698),d=()=>o(299924),p=()=>o(680369),m=()=>o(385649),g=()=>o(835029),y=()=>o(653998),h=()=>o(975392),f=()=>o(337658),v=()=>o(535906),x=()=>o(935091),b=()=>o(858023),S=()=>o(206799),C=()=>o(793613),A=()=>o(88271),k=()=>o(103151),M=()=>o(137476),j=()=>o(754697),T=()=>o(477784),I=()=>o(863969),w=()=>o(129978);function _(){const e=(0,s().v3)();return(0,n.useMemo)((()=>(0,M().ik)(e)),[e])}var P=()=>o(907721),B=()=>o(485966),R=()=>o(943066),V=()=>o(133926),E=()=>o(56432),D=()=>o(271142),F=()=>o(453214),O=()=>o(738355),N=()=>o(441911),L=()=>o(572293),W=(o(324989),()=>o(911575)),z=()=>o(401382),K=()=>o(206183),H=()=>o(836331),U=o(163643);function Y(e){const{automationStore:t,collectionStore:o,searchInput:n}=e,i=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),r=o.getFormat(),s=o.getSchema(),c=(0,W().m7)({collectionFormat:r,collectionSchema:s,filter:e=>{let[t]=e;return!i.has(t)},spaceId:o.getSpaceId(),restrictCrossSpace:H().default.checkGate({gateName:"collections_xws"})}),u=new Map,d=c.map((e=>{const t=s[e];if(t){const o=`${t.name} ${K().dC[t.type]}`;return u.set(e,o),o}})).filter(a().O9),p=new Set(l().filter(n,d).map((e=>{let{original:t}=e;return t})));return c.filter((e=>{const t=u.get(e);return t&&p.has(t)}))}function G(e){const{onChange:t,value:o,placeholder:n,isInput:i}=e;return{items:[{action:()=>{},key:"search-input",render:e=>(0,U.jsx)(q,{...e,onChange:t,value:o,placeholder:n})}],key:"search",render:e=>(0,U.jsx)(A().A,{...e,isInput:i})}}const q=(0,n.forwardRef)((function(e,t){const{onChange:o,value:n,placeholder:i,...a}=e,r=(0,y().tz)(),{isMobile:l}=(0,s().Y0)();return(0,U.jsx)(z().Ay,{...a,focus:!l,inputOuterStyle:{margin:0},onChange:o,placeholder:r.formatMessage(i),ref:t,value:n})}));var X=()=>o(180986);const $=(0,y().YK)({searchInputPlaceholder:{id:"UpdateThisPagePropertiesActionMenu.searchInputPlaceholder ",defaultMessage:"Search for a property…"},editProperty:{id:"automationEventActionMenu.pagePropertiesEditedSection.title",defaultMessage:"Edit property"}});function J(e){const{automationActionMenuStore:t,onClose:o}=e,{automationStore:a,contextType:r}=(0,D().EC)(),l=(0,F().y)(a,r),[s,c]=(0,n.useState)(""),u=(0,i().K8)((()=>l&&a?Y({automationStore:a,collectionStore:l,searchInput:s}):[]),[a,l,s]),d=(0,i().K8)((()=>null==l?void 0:l.getSchema()),[l]),p=(0,n.useMemo)((()=>{const e=[];e.push(G({onChange:e=>c(e.target.value),value:s,placeholder:$.searchInputPlaceholder}));const o=d&&Q({automationActionMenuStore:t,propertyIds:u,normalizedBlockSchema:d,includeTitle:!1});return o&&e.push(o),e}),[t,u,d,s]),m=(0,X().r)({automationTriggerActionMenuStore:t,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:o,title:(0,U.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:(0,U.jsx)(y().sA,{...$.editProperty})})});return(0,U.jsx)(x().A,{...m,children:(0,U.jsx)(b().Ay,{initialFocus:0,sections:p,type:b().Oh.Vertical})})}function Q(e){const{automationActionMenuStore:t,hasTopBorder:o,normalizedBlockSchema:n,propertyIds:i,includeTitle:r}=e,l=i.map((e=>{const o=n[e];if(o)return function(e){const{automationActionMenuStore:t,propertyId:o,propertySchema:n}=e;return{action:()=>{t.pushSettingsItem({actionId:void 0,propertyId:o,type:"eventActionProperty"})},key:`update_this_page_property_${o}_action`,render:e=>(0,U.jsx)(Z,{...e,propertySchema:n})}}({automationActionMenuStore:t,propertyId:e,propertySchema:o})})).filter(a().O9);if(0!==l.length)return{key:"automation_update_this_page_section",items:l,render:e=>(0,U.jsx)(A().A,{...e,title:r?(0,U.jsx)(y().sA,{...$.editProperty}):void 0,topBorder:o})}}const Z=(0,n.forwardRef)((function(e,t){const{propertySchema:o,...n}=e;return(0,U.jsx)(v().A,{...n,icon:(0,U.jsx)(ee,{propertySchema:o}),ref:t,showExtensionArrow:!0,title:o.name})}));function ee(e){const{propertySchema:t}=e,n=(0,c().DP)(),i=(0,c().IS)((e=>({icon:{fill:e.icon.secondary,width:p().Ev.sm},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[]);return(0,U.jsx)("div",{style:i.iconWrap,children:(0,U.jsx)(o(916963).zB,{icon:t.icon,size:16,style:i.icon,theme:n,type:t.type})})}const te=(0,y().YK)({searchInputPlaceholder:{id:"automationEventActionMenu.searchInputPlaceholder.label",defaultMessage:"Search actions…"},updateThisPagePropertiesMenuItemCaption:{defaultMessage:"Edit property…",id:"automationEventActionMenu.updateThisPagePropertiesMenuItem.caption"},upgrade:{defaultMessage:"Upgrade to Plus",id:"automationEventActionMenu.upsellFeatures.title"},disabledActionTooltipHeader:{defaultMessage:"Disabled in your workspace",id:"automationEventActionMenu.disabledActionTooltipHeader"},disabledActionTooltipBody:{defaultMessage:"Contact a workspace admin to modify this setting.",id:"automationEventActionMenu.disabledActionTooltipBody"}}),oe=["automation_actions","update_this_page_actions"],ne=["update_this_page_actions","automation_actions"];function ie(e){const{automationActionMenuStore:t,hasSearch:o,hasUpdateThisPagePropertyActions:r,onClose:p}=e,{isMobile:C}=(0,s().Y0)(),k=(0,s().v3)(),P=(0,y().tz)(),W=_(),{value:z}=(0,w().fJ)(f().QV.automationActionRegistry),{automationStore:K,contextType:H}=(0,D().EC)(),{maybePersistedTransactionActions:q,onActionAdded:X}=(0,O().b)(),$=(0,F().y)(K,H),J=(0,L().V)(),Z="event"===H,ee=(0,n.useMemo)((()=>Z?ne:oe),[Z]),ie=(0,i().K8)((()=>t.getInsertionPoint()),[t]),[re,le]=n.useState(""),se=(0,i().K8)((()=>o?function(e){const{automationActionRegistryModule:t,availableActions:o,searchInput:n}=e;if(!t||0===o.length)return[];const i=new Map,a=o.map((e=>{const t=T().A.formatMessage(e.display.name);return i.set(e.type,t),t})),r=new Set(l().filter(n,a).map((e=>{let{original:t}=e;return t})));return o.filter((e=>{const t=i.get(e.type);return t&&r.has(t)}))}({automationActionRegistryModule:z,availableActions:J,searchInput:re}):J),[J,o,re,z]),ce=(0,i().K8)((()=>K.getActionStores().map((e=>e.getType())).filter(a().O9)),[K]),de=(0,n.useCallback)((e=>{if(!K)return;const t=K.getSpaceId(),{performResult:o}=q.createAndCommit({userAction:"AutomationActionList.addAction",perform:o=>E().addAutomationAction({actionId:(0,j().Z1)({environment:k,table:m().SC,spaceId:t}),actionType:e,automationStore:K,environment:k,insertionPoint:ie,intl:P,transaction:o,builderType:"modal"})});o&&((0,u().c_)(W,{automation_id:K.id,automation_action_id:o.id,automation_action_type:e,builder_type:"modal"}),null==X||X(o)),p()}),[K,q,p,k,ie,P,W,X]),pe=(0,i().K8)((()=>r&&$&&K?Y({automationStore:K,collectionStore:$,searchInput:re}):[]),[K,$,r,re]),me=(0,i().K8)((()=>Boolean(r&&$&&K&&Y({automationStore:K,collectionStore:$,searchInput:""}).length>0)),[K,$,r]),ge=(0,i().K8)((()=>null==$?void 0:$.getSchema()),[$]),ye=(0,I().O)(),he=(0,i().K8)((()=>{var e;return null===(e=B().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),fe=(0,V()._X)({name:"premium_automations",spaceId:ye,userId:null==he?void 0:he.id}),ve=function(e){let{onClose:t,upsell:o}=e;const i=(0,s().v3)();return(0,n.useCallback)((()=>{t(),o&&R().K(i,{from:"database_automation_modal_action_item",upsell:o})}),[i,t,o])}({onClose:p,upsell:null==fe?void 0:fe.upsell}),xe=(0,g().e2)(fe),be=(0,V().P9)({name:"slack_automation_action",spaceId:ye,userId:null==he?void 0:he.id}),Se=(0,c().IS)((e=>({unavailableHeader:{display:"inline-flex",minWidth:0,whiteSpace:"pre",cursor:"pointer",color:e.text.secondary},unavailableLinkIcon:{fill:e.icon.secondary}})),[]),Ce=(0,i().K8)((()=>{const e=[],n="button_block"===H||"button_property"===H,i=!n&&!xe,r=n&&!xe;o&&!i&&e.push(G({onChange:e=>le(e.target.value),value:re,placeholder:te.searchInputPlaceholder,isInput:!0}));const l=ee.reduce(((e,o)=>{if("automation_actions"===o)if(i||r){const[o,n]=h().jB(se,(e=>i?"slack_notification"===e.type&&be:r?"send_gmail_notification"!==e.type&&"http_request"!==e.type:void 0)),l=ae({key:"automation_actions_available_section",actionRegistryItems:o,hasTopBorder:e.length>0,onMenuItemClick:de,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"button_property"===H}),s=ae({key:"automation_actions_unavailable_section",actionRegistryItems:n,hasTopBorder:(0,a().O9)(l),hideChevron:!0,onMenuItemClick:ve,onClick:ve,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"event"===H,title:(0,U.jsxs)("div",{style:Se.unavailableHeader,onClick:ve,children:[(0,U.jsx)(y().sA,{...te.upgrade}),(0,U.jsx)(S().Q,{iconGroup:d().j,variantName:"small",style:Se.unavailableLinkIcon})]})});l&&e.push(l),s&&e.push(s)}else{const o=ae({actionRegistryItems:se,hasTopBorder:e.length>0,onMenuItemClick:de,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:me&&"button_block"!==H&&(!re||ue(re))});o&&e.push(o)}else if("update_this_page_actions"===o){const o=ge&&(xe||!Z)&&re.length>0&&Q({automationActionMenuStore:t,hasTopBorder:e.length>0,normalizedBlockSchema:ge,propertyIds:pe,includeTitle:!0});o&&e.push(o)}else(0,a().HB)(o);return e}),[]);return 0===l.length?e.push({key:"no_results_section",items:[{key:"no_results_item",action:()=>{},render:e=>(0,U.jsx)(v().A,{...e,disabled:!0,disabledFeedback:!0,title:(0,U.jsx)(y().sA,{defaultMessage:"No results",id:"automations.automationEventActionMenu.noResultsItem"})})}],render:e=>(0,U.jsx)(A().A,{...e})}):e.push(...l),e}),[t,xe,be,pe,se,ge,H,o,me,Z,de,ve,re,ee,Se.unavailableHeader,Se.unavailableLinkIcon]);(0,n.useEffect)((()=>{(0,M().u4)({environment:k,event:{eventName:"automation_action_menu_opened",eventProperties:{automation_id:K.id,automation_context_type:H,existing_action_types:ce,available_action_types:J.map((e=>e.type))}}})}),[J,H,ce,K,k]);let Ae=(0,N().e)({width:266});return C||(Ae={...Ae,maxHeight:"50vh"}),(0,U.jsx)(x().A,{...Ae,children:(0,U.jsx)(b().Ay,{initialFocus:0,sections:Ce,type:b().Oh.Vertical})})}function ae(e){const{actionRegistryItems:t,hasTopBorder:o,onMenuItemClick:n,onClick:i,automationActionMenuStore:r,shouldShowUpdateThisPageProperties:l,key:s,title:c,hideChevron:u}=e,d=h().oE([l?se({hideChevron:u,onClick:()=>{(0,a().O9)(i)?i():r.pushSettingsItem({type:"updateThisPageProperties"})}}):void 0,...t.map((e=>function(e){const{actionRegistryItem:t,onClick:o}=e;return{action:()=>o(t.type),key:`${t.type}_action`,render:e=>(0,U.jsx)(re,{...e,actionRegistryItem:t})}}({actionRegistryItem:e,onClick:n})))]);if(0!==d.length)return{key:s||"automation_actions_section",items:d,render:e=>(0,U.jsx)(A().A,{...e,topBorder:o,title:c})}}const re=(0,n.forwardRef)((function(e,t){const{actionRegistryItem:r,...l}=e,s=r.display,{automationStore:u,contextType:d}=(0,D().EC)(),p=(0,i().K8)((()=>(0,o(373994).Z6)(u,d)),[u,d]),m=(0,I().O)(),g=(0,i().K8)((()=>{var e;return null===(e=B().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),h=(0,V().P9)({name:"premium_automations",spaceId:m,userId:null==g?void 0:g.id}),f=(0,V().P9)({name:"slack_automation_action",spaceId:m,userId:null==g?void 0:g.id}),x=(0,n.useMemo)((()=>{if(h)return!1;return"button_block"===d||"button_property"===d?"send_gmail_notification"===r.type||"http_request"===r.type||"slack_notification"===r.type&&!f:"slack_notification"!==r.type||!f}),[r.type,d,h,f]),b=(0,i().K8)((()=>!!((0,a().O9)(r)&&(0,a().O9)(p)&&(0,a().O9)(r.isDisabledForContext))&&r.isDisabledForContext(p)),[r,p]),S=(0,c().IS)((e=>({row:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"flex-start",...(x||b)&&{color:e.text.tertiary,cursor:"default"}},badge:{...(x||b)&&{color:e.text.tertiary,backgroundColor:e.accentColors.translucentGray[75]}},tooltipHeader:{width:200},tooltipBody:{color:e.text.secondary}})),[b,x]),A=(0,n.useMemo)((()=>{switch(r.type){case"send_gmail_notification":return(0,U.jsx)(o(402557).A,{style:S.badge});case"http_request":return(0,U.jsx)(C().E,{newBadgeKey:"http_request_automation_action",didUserEngage:!1,keyType:"date",style:S.badge});case"define_variables":return(0,U.jsx)(C().E,{newBadgeKey:"define_variables_automation_action",didUserEngage:!1,keyType:"date",style:S.badge});default:return}}),[r.type,S.badge]);return s?(0,U.jsx)(k().A,{textWrap:!0,placement:P().W.Right,alignment:P().C.End,disableTooltip:!b,renderTooltip:()=>(0,U.jsxs)("div",{style:S.tooltipHeader,children:[(0,U.jsx)("div",{children:(0,U.jsx)(y().sA,{...te.disabledActionTooltipHeader})}),(0,U.jsx)("div",{style:S.tooltipBody,children:(0,U.jsx)(y().sA,{...te.disabledActionTooltipBody})})]}),render:e=>(0,U.jsx)(v().A,{...l,...e,disabled:b,icon:(0,U.jsx)(le,{type:"actionRegistry",actionRegistryItem:r,disabled:b||x}),ref:t,right:A,title:(0,U.jsx)(y().sA,{...s.name}),style:S.row})}):null}));function le(e){const t="actionRegistry"===e.type&&"send_gmail_notification"===e.actionRegistryItem.type,o="actionRegistry"===e.type&&"slack_notification"===e.actionRegistryItem.type,n=(0,c().IS)((n=>({icon:{fill:e.disabled?n.text.tertiary:n.icon.secondary,height:"auto",width:p().Ev.default,opacity:(t||o)&&e.disabled?.4:1},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[t,o,e.disabled]);return(0,U.jsx)("div",{style:n.iconWrap,children:"actionRegistry"===e.type?e.actionRegistryItem.display.icon(n.icon):"icon"===e.type?e.icon(n.icon):(0,a().HB)(e)})}function se(e){const{onClick:t,hideChevron:o}=e;return{action:()=>t(),key:"update_this_page_properties",render:e=>(0,U.jsx)(ce,{...e,hideChevron:o})}}const ce=(0,n.forwardRef)((function(e,t){const{hideChevron:n}=e,{contextType:a}=(0,D().EC)(),r=(0,I().O)(),l=(0,i().K8)((()=>{var e;return null===(e=B().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),s=(0,V().P9)({name:"premium_automations",spaceId:r,userId:null==l?void 0:l.id}),u=(0,c().IS)((e=>({row:{...!s&&"event"===a&&{color:e.text.tertiary}}})),[a,s]);return(0,U.jsx)(v().A,{...e,icon:(0,U.jsx)(le,{type:"icon",icon:o(954397).slidersIcon}),ref:t,showExtensionArrow:!n,title:(0,U.jsx)(y().sA,{...te.updateThisPagePropertiesMenuItemCaption}),style:u.row})}));function ue(e){const t=T().A.formatMessage(te.updateThisPagePropertiesMenuItemCaption);return l().test(e,t)}o(500234);var de=()=>o(903012),pe=()=>o(81085),me=()=>o(352613),ge=()=>o(564134),ye=()=>o(630714),he=()=>o(34662),fe=()=>o(31448),ve=()=>o(759625),xe=()=>o(59177),be=()=>o(265405);const Se=(0,y().YK)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"},menuHeaderEditTitle:{defaultMessage:"Edit {propertyName}",id:"automations.eventActionProperty.menuHeaderEditTitle"}});function Ce(e){var t;const{actionId:o,automationActionMenuStore:r,onClose:l,propertyId:c}=e,{automationStore:d,contextType:p}=(0,D().EC)(),g=(0,F().y)(d,p),{maybePersistedTransactionActions:h,onActionAdded:f}=(0,O().b)(),v=(0,y().tz)(),x=(0,s().v3)(),b=_(),S=(0,i().K8)((()=>r.getInsertionPoint()),[r]),C=(0,n.useMemo)((()=>g?{collectionStore:g,property:c,type:"collection"}:void 0),[g,c]),A=(0,i().K8)((()=>d.getSpaceId()),[d]),M=o??(0,j().Z1)({environment:x,table:m().SC,spaceId:A}),T=(0,i().K8)((()=>{const e=((null==d?void 0:d.getActionStores())??[]).find((e=>e.id===M));if(e&&e.isType("update_pages"))return e}),[d,M]),I=(0,i().K8)((()=>null==g?void 0:g.getSchema()[c]),[g,c]),w=(0,n.useMemo)((()=>{if(I&&(0,W().I3)(I))return W().Yy[I.type]}),[I]),B=(0,n.useMemo)((()=>!!I&&("multi_select"===I.type||(0,ge().sO)(I)&&1!==I.limit)),[I]),R=Boolean(I&&"button"!==I.type&&"rollup"!==I.type&&"formula"!==I.type&&"text"===(0,me().IS)(I.type)),V=Boolean(I&&"button"!==I.type&&"rollup"!==I.type&&"formula"!==I.type&&"number"===(0,me().IS)(I.type)),N=Boolean(I&&"date"===I.type),L=Boolean(I&&"status"===I.type),z=(0,i().K8)((()=>{if(g&&I)return(0,ye().setPropertyValueToSimpleFormulaReturnType)(g.getSpaceShardedPointer(),c,I)}),[g,I,c]),K=(0,i().K8)((()=>{if(T)return T.getConfigStore().getKeyStore("values").getKeyStore(c).getValue()}),[T,c]),[H,Y]=(0,n.useState)(K),G=(0,n.useRef)({action:(null==K?void 0:K.action)||de().yP,value:null==K?void 0:K.value}),q=(0,n.useMemo)((()=>{var e;return(0,ye().fromSimpleFormulaArrayValue)(null==H||null===(e=H.value)||void 0===e?void 0:e.value)}),[null==H||null===(t=H.value)||void 0===t?void 0:t.value]),$=(0,be().F)({actionId:null==T?void 0:T.id}),J=(0,n.useCallback)((e=>{let{action:t,value:o}=e;if(!d)return;const{performResult:n}=h.createAndCommit({perform:e=>{if(!T)return E().addAutomationAction({actionId:M,actionType:"update_pages",automationStore:d,config:{properties:[c],target:{id:(0,pe().KI)(),type:"variable"},values:{[c]:{action:t,value:o}}},environment:x,intl:v,insertionPoint:S,transaction:e,builderType:"modal"});ve().zv({data:{[c]:{action:t,value:o}},store:T.getConfigStore().getKeyStore("values"),transaction:e})},userAction:"UpdateThisPagePropertyActionMenu.saveChanges"});n&&((0,u().c_)(b,{automation_id:d.id,automation_action_id:n.id,automation_action_type:"update_pages"}),null==f||f(n))}),[T,d,x,b,M,S,v,h,f,c]),Q=(0,n.useCallback)((()=>{J(G.current),l()}),[J,l]),Z=(0,n.useCallback)(((e,t)=>{const o=t||de().yP,n=G.current.value;G.current={value:e,action:o};if("formula"===(null==e?void 0:e.type))return void Y({action:o,value:e});if("formula"===(null==n?void 0:n.type))Y({action:o,value:e});else if(R||V||B||(0,a().O9)(t))Y({action:o,value:e});else if(N){const t=(0,ye().fromSimpleFormulaArrayValue)(null==e?void 0:e.value)[0];if((0,a().O9)(t)&&(0,ye().isAnnotationSimpleValueToken)(t)&&(0,he().qsB)(t))return void Y({action:o,value:e});Q()}}),[N,R,V,B,Q]),ee="person"===(null==I?void 0:I.type)||"relation"===(null==I?void 0:I.type)||"multi_select"===(null==I?void 0:I.type),te=ee?Se.menuHeaderEditTitle:Se.menuHeaderTitle,oe=(0,X().r)({automationTriggerActionMenuStore:r,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:Q,onDone:B||R||V||ee?Q:void 0,title:(0,U.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:v.formatMessage(te,{propertyName:(0,U.jsx)(k().A,{placement:P().W.Bottom,render:e=>(0,U.jsx)("div",{...e,style:{...fe().RC},children:(null==I?void 0:I.name)??""}),renderTooltip:()=>(null==I?void 0:I.name)??""})})})});return I&&z&&C?(0,U.jsx)(xe().L,{allowedFormulaReturnTypes:w,formulaValueContext:C,currentSimpleFormulaValueTokens:q,formulaTypecheckContextValues:$,menuProps:oe,onChange:Z,onClose:Q,parentRecordStore:d,showClearButton:!L,type:z,value:null==H?void 0:H.value,action:(0,de().tz)(H),showReplaceAddRemoveToggle:ee}):null}var Ae=()=>o(83544),ke=()=>o(706788),Me=()=>o(669747),je=()=>o(204132),Te=()=>o(423392),Ie=()=>o(209684),we=()=>o(951540),_e=()=>o(944560),Pe=()=>o(773082),Be=()=>o(413871);function Re(e){const{type:t,automationActionMenuStore:o,onClose:n}=e,a=Oe(),r=(0,I().O)(),l=(0,i().K8)((()=>B().default.state.currentUserStore),[]),s="connectToSlackReconnect"===t?e.externalBotId:void 0,c=(0,i().K8)((()=>{if(void 0!==s&&l)return(0,Be().Oo)(l,{table:Me().As,id:s,spaceId:r}).getValue()}),[s,l,r]);let u,d=Fe({viewType:"connectToSlackDefault"});if("connectToSlackReconnect"===t){if(!c)return null;const{accountName:e,organizationName:t}=(0,_e().qO)(c);u=(0,_e().Dy)(c),d=Fe({viewType:"connectToSlackReconnect",accountName:e,organizationName:t})}return(0,U.jsx)(X().A,{type:"custom",automationTriggerActionMenuStore:o,onClose:n,children:(0,U.jsx)(A().A,{children:(0,U.jsxs)("div",{style:a.container,children:[(0,U.jsx)(Ee,{}),(0,U.jsxs)("div",{style:a.connectToSlackBody,children:[(0,U.jsx)("div",{style:a.connectToSlackTitleText,children:De(t)}),(0,U.jsx)("div",{style:a.connectToSlackDescriptionText,children:d})]}),(0,U.jsx)(Ve,{...e,slackWorkspaceId:u})]})})})}function Ve(e){const{automationActionMenuStore:t,slackWorkspaceId:o}=e,n=(0,s().v3)(),r=Oe(),l=(0,I().O)(),c=(0,i().K8)((()=>Pe().A.integrations.state.find((e=>e.id===ke().zG))),[]);return c&&l?(0,U.jsxs)("div",{style:r.buttonGroup,children:[(0,U.jsx)(we().A,{style:r.connectToSlackButton,size:"lg",onClick:async()=>{const i=await Te().Jq({environment:n,integration:c,spaceId:l,from:"collection_view_settings",options:{slackWorkspaceId:o}});je().Q.isFail(i)?t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?i.value.externalAuthentication?t.replaceSettingsItem({type:"selectChannelNew",currentExternalAuthentication:i.value.externalAuthentication,actionStore:e.actionStore}):t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):(0,a().HB)(e))},children:(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,U.jsx)(Ie().p,{style:r.cancelButton,size:"lg",onClick:()=>{t.popSettingsItem()},children:(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function Ee(){const e=Oe();return(0,U.jsx)("div",{children:(0,U.jsx)("img",{src:Ae().A.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function De(e){return"connectToSlackDefault"===e?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"}):"connectToSlackReconnect"===e?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",defaultMessage:"Reconnect to Slack"}):void(0,a().HB)(e)}function Fe(e){const{viewType:t}=e;return"connectToSlackDefault"===t?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",defaultMessage:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?(0,U.jsx)(y().sA,{id:"AutomationSlackConnectToSlackView.reconnect.description",defaultMessage:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,a().O9)(e.organizationName),organizationName:e.organizationName}}):void(0,a().HB)(t)}function Oe(){return(0,c().IS)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:fe().Wy.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.text.secondary},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.text.secondary,width:"100%",justifyContent:"center",fontWeight:fe().Wy.medium,fontSize:13,marginTop:8}})),[])}var Ne=()=>o(289051);function Le(e){const{actionStore:t,automationActionMenuStore:o,onClose:i}=e,{maybePersistedTransactionActions:r}=(0,O().b)(),l=n.useCallback(((e,o)=>{t&&r.createAndCommit({perform:n=>{var i;ve().zv({data:{config:{external_bot_id:o,target:{id:e.id,name:"",type:e.type},custom_message:null===(i=t.getConfig())||void 0===i?void 0:i.custom_message}},store:t,transaction:n})},userAction:"SlackSelectChannelMenu.handleChannelSelect"}),i()}),[t,r,i]),s=(0,n.useCallback)((()=>{const e=o.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?o.popSettingsItem():o.replaceSettingsItem({actionStore:t,type:"selectWorkspace"}))}),[t,o]),c="selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,a().HB)(e),u=(0,n.useMemo)((()=>c?[c]:void 0),[c]);return(0,U.jsx)(Ne().pj,{currentExternalAuthentication:e.currentExternalAuthentication,currentNotificationChannels:u,onClose:i,onNotificationChannelSelect:l,onNewSlackAccountAdded:s,renderMenu:e=>(0,U.jsx)(X().A,{type:"default",automationTriggerActionMenuStore:o,headerTitle:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectChannelView.title",defaultMessage:"Select Slack channel"}),sections:e,onClose:i})})}var We=()=>o(855470),ze=()=>o(668657);const Ke=(0,y().YK)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Search…"}});function He(e){const{onWorkspaceSelect:t,renderMenu:o,workspaceFilter:a,onNewSlackAccountAdded:r}=e,l=(0,s().v3)(),{isMobile:u}=(0,s().Y0)(),d=(0,I().O)(),p=(0,i().K8)((()=>(0,_e().l$)(Pe().A.completeSlackAuthentications.state,a)),[a]),m=(0,i().K8)((()=>Pe().A.integrations.state.find((e=>e.id===ke().zG))),[]),[g,h]=n.useState(""),f=(0,c().IS)((e=>({chevronRight:{width:12,height:"auto",color:e.lightIconColor}})),[]);if(!m)return null;const x=Object.entries((0,_e().Os)(p,g)).map(((e,o)=>{let[n,i]=e;return{key:n,items:i.map((e=>{let{workspaceName:o,externalAuthentication:n}=e;return{key:n.id,action:()=>{t(n)},render:e=>(0,U.jsx)(v().A,{...e,title:o??(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,We().V)(f.chevronRight)})}})),render:e=>(0,U.jsx)(A().A,{...e,title:n,topBorder:0!==o})}}));return x.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,U.jsx)("div",{children:(0,U.jsx)(z().Ay,{...e,inputLeft:(0,U.jsx)(z().Zf,{icon:ze().q}),showClearButton:!0,placeholder:T().A.formatMessage(Ke.workspaceSearchPlaceholder),focus:!u||void 0,value:g,onChange:e=>{h(e.target.value)}})})}],render:e=>(0,U.jsx)(A().A,{...e})}),x.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!d)return;const e=await Te().Jq({environment:l,integration:m,spaceId:d,from:"collection_view_settings"});je().Q.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==r||r())},render:e=>(0,U.jsx)(v().A,{...e,icon:(0,U.jsx)("img",{src:Ae().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,U.jsx)(A().A,{...e,topBorder:!0})}),(0,U.jsx)(U.Fragment,{children:o(x)})}function Ue(e){const{automationActionMenuStore:t,onClose:o}=e,i=n.useCallback((o=>{t.pushSettingsItem({actionStore:e.actionStore,type:"selectChannelNew",currentExternalAuthentication:o})}),[t,e.actionStore]);return(0,U.jsx)(He,{onWorkspaceSelect:i,renderMenu:e=>(0,U.jsx)(X().A,{type:"default",automationTriggerActionMenuStore:t,headerTitle:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectSlackWorkspace.title",defaultMessage:"Select Slack workspace"}),sections:e,onClose:o})})}const Ye=(0,n.createContext)({menuStore:void 0});function Ge(e){const{initialState:t,insertionPoint:o,onClose:l}=e,s=(0,i().K8)((()=>{const e=new(r().ew);return e.setState({insertionPoint:o,stack:[t]}),e}),[t,o]),c=(0,i().K8)((()=>s.getCurrentTab()),[s]),u=(0,n.useCallback)((()=>null==l?void 0:l()),[l]);if(!c)return null;let d;if("connectToSlackDefault"===c.type)d=(0,U.jsx)(Re,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u,type:"connectToSlackDefault"});else if("connectToSlackReconnect"===c.type)d=(0,U.jsx)(Re,{actionStore:c.actionStore,automationActionMenuStore:s,externalBotId:c.externalBotId,notificationActionConfigStore:c.notificationActionConfigStore,onClose:u,type:"connectToSlackReconnect"});else if("selectWorkspace"===c.type)d=(0,U.jsx)(Ye.Provider,{value:{menuStore:s},children:(0,U.jsx)(Ue,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u})});else if("selectChannelNew"===c.type)d=(0,U.jsx)(Le,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,onClose:u,type:"selectChannelNew"});else if("selectChannelUpdate"===c.type)d=(0,U.jsx)(Le,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,currentNotificationChannel:c.currentNotificationChannel,onClose:u,type:"selectChannelUpdate"});else if("eventActions"===c.type)d=(0,U.jsx)(ie,{automationActionMenuStore:s,hasUpdateThisPagePropertyActions:c.hasUpdateThisPagePropertyActions,hasSearch:c.hasSearch,onClose:u});else if("eventActionProperty"===c.type){const{propertyId:e,actionId:t}=c;d=(0,U.jsx)(Ce,{actionId:t,automationActionMenuStore:s,onClose:u,propertyId:e})}else"updateThisPageProperties"===c.type?d=(0,U.jsx)(J,{automationActionMenuStore:s,onClose:u}):(0,a().HB)(c);return(0,U.jsx)(Ye.Provider,{value:{menuStore:s},children:d})}Ye.displayName="AutomationActionMenuContext"},511952:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(242343),i=()=>o(803290),a=()=>o(917717),r=o(163643);function l(e,t){const{onClose:l,persistOnClose:s,render:d,stopClickPropagation:p,onClick:m,disablePopup:g,disabled:y,forceInitialInbound:h,renderOrigin:f,originGap:v,borderRadius:x,popupWrapStyle:b}=e,S=(0,i().uB)(e.buttonPopupStore,o(962373).A);(0,n.useEffect)((()=>()=>{S.setState({open:!1})}),[S]);const C=(0,n.useCallback)((()=>c(l,s,S)),[l,s,S]),A=(0,n.useCallback)((()=>(0,r.jsx)(u,{onClose:l,persistOnClose:s,render:d,buttonPopupStore:S})),[l,s,d,S]),k=(0,n.useCallback)((e=>function(e,t,o,n,i){t&&(null==e||e.stopPropagation());if(e&&a().Vt(e))return;o&&o(e);n||i.setState({...i.state,open:!0})}(e,p,m,g,S)),[p,m,g,S]),M=(0,i().K8)((()=>f({...e,onClick:y?o(975392).D_:k})),[y,k,e,f]),j=(0,i().K8)((()=>S.state.open),[S]);return(0,r.jsx)(o(443252).Ay,{ref:t,...e,forceInitialInbound:Boolean(h),render:A,open:j,onDismiss:C,origin:M,originGap:v,borderRadius:x,popupWrapStyle:b,trapFocus:!0})}const s=n.forwardRef(l);function c(e,t,o){e&&e(),t||o.reset()}function u(e){let{onClose:t,persistOnClose:o,render:a,buttonPopupStore:l}=e;const s=(0,n.useCallback)((()=>c(t,o,l)),[t,o,l]),u=(0,i().K8)((()=>a({close:s})),[a,s]);return(0,r.jsx)(r.Fragment,{children:u})}},512040:(e,t,o)=>{o.d(t,{A:()=>a});var n=()=>o(21045);class i extends(()=>o(129044))().default{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,n().A)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,n().A)(this.instanceState,e)||this.setState(e)}}const a=new i;(0,o(996094).exposeDebugValue)("AutomationFocusStore",i)},522313:(e,t,o)=>{o.d(t,{S:()=>m,j:()=>g});var n=o(242343),i=()=>o(803290),a=()=>o(174114),r=()=>o(651632),l=()=>o(653998),s=()=>o(31448),c=()=>o(993517),u=()=>o(100096),d=()=>o(576992),p=o(163643);const m=5;function g(e){const{action:t,actionMenu:o,buttonPopupStore:g,disabled:y,limit:h=m,onClick:f,propertySchema:v,value:x}=e,b=(0,l().tz)(),S=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium}})),[]),C=(0,i().K8)((()=>(0,d().mk)({intl:b,limit:h,propertySchema:v,styles:S,operator:t,value:x})),[b,h,v,S,t,x]),A=(0,i().K8)((()=>(0,d().cI)({intl:b,limit:h,propertySchema:v,operator:t,value:x})),[t,b,h,v,x]),k=(0,n.useCallback)((e=>(0,p.jsx)(u().aX,{...e,actionMenu:o,buttonPopupStore:g,disabled:y,icon:r().v,onClick:f,children:(0,p.jsx)("div",{style:S.content,children:C})})),[o,g,y,f,S.content,C]);return(0,p.jsx)(c().P,{renderOrigin:k,title:A})}},531568:(e,t,o)=>{o.d(t,{H2:()=>f,iB:()=>v,cG:()=>g,UY:()=>x,x3:()=>y});var n=o(242343),i=()=>o(803290),a=()=>o(174114),r=()=>o(403026),l=()=>o(840024),s=()=>o(85208),c=()=>o(476026),u=()=>o(63463);const d=o.p+"c9223887dcb57b7d.gif",p=o.p+"7e9cbd56b1eca7b9.gif";var m=o(163643);function g(e){const{variant:t,style:o={},forceSparkles:n}=e,a=(0,i().O$)(l().ts);let r;return r=!n&&a?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,m.jsx)(c().o,{variant:t,shadowVariant:"light"})}):(0,m.jsx)(s().g,{variant:n?"small":t}),(0,m.jsx)("div",{style:o,children:r})}function y(e){const{variant:t}=e,o=(0,i().O$)(l().ts),n=(0,a().IS)((()=>({sparklesWrapper:{borderRadius:"100%",border:"2px solid RGB(182,208,240)",marginRight:8,marginLeft:8,padding:4},badge:{position:"absolute",left:"27px",top:"-5px"},faceWrapper:{marginRight:8}})),[]);return o?(0,m.jsx)("div",{style:n.faceWrapper,children:(0,m.jsx)(h,{variant:t})}):(0,m.jsxs)("div",{style:n.sparklesWrapper,children:[(0,m.jsx)(s().g,{variant:t}),(0,m.jsx)("div",{style:n.badge,children:(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"11",viewBox:"0 0 10 11",fill:"none",children:(0,m.jsx)("circle",{cx:"5",cy:"5.5",r:"4",fill:"#2383E2",stroke:"white",strokeWidth:"2"})})})]})}function h(e){const{variant:t}=e,o="dark"===(0,a().DP)().mode,[i,r]=(0,n.useState)(!0);(0,n.useEffect)((()=>{setTimeout((()=>{r(!1)}),6e3)}),[]);const l=(0,n.useMemo)((()=>{if(i)return o?d:p}),[o,i]);return(0,m.jsx)("div",{style:{marginLeft:8},children:(0,m.jsx)(c().o,{variant:t,shadowVariant:"light",wrapWithPadding:!0,imgSource:l})})}function f(){const e=(0,i().O$)(l().ts),t=(0,a().IS)((e=>({faceImgStyles:{width:20,height:20,background:e.assistantCornerButtonBackground,borderRadius:"50%",border:`1px solid ${e.tableDividerColor}`},sparklesIconStyle:{width:16,height:16,fill:e.icon.secondary}})),[]);return e?(0,m.jsx)("img",{style:t.faceImgStyles,src:u(),role:"presentation",alt:"Notion AI Face"}):(0,r().X)(t.sparklesIconStyle)}function v(){const e=(0,i().O$)(l().ts),t=(0,a().IS)((e=>({faceImgStyles:{width:20,height:20,background:e.assistantCornerButtonBackground,borderRadius:"50%",border:`1px solid ${e.tableDividerColor}`},sparklesIconStyle:{width:16,height:16,fill:e.icon.secondary}})),[]);return e?(0,m.jsx)("img",{style:t.faceImgStyles,src:u(),role:"presentation",alt:"Notion AI Face"}):(0,r().X)(t.sparklesIconStyle)}function x(){const e=(0,i().O$)(l().ts),t=(0,a().IS)((e=>({faceImgStyles:{width:20,height:20,background:e.assistantCornerButtonBackground,borderRadius:"50%",border:`1px solid ${e.tableDividerColor}`,marginLeft:-2,marginRight:2},sparklesIconStyle:{width:16,height:16,marginRight:2},sparklesIconWrapper:{borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center"}})),[]);return e?(0,m.jsx)("img",{style:t.faceImgStyles,src:u(),role:"presentation",alt:"Notion AI Face"}):(0,m.jsx)("div",{style:t.sparklesIconWrapper,children:(0,r().X)(t.sparklesIconStyle)})}},533639:(e,t,o)=>{o.d(t,{p:()=>n});class n extends(()=>o(998969))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}},533666:(e,t,o)=>{o.d(t,{Y:()=>i});o(242343);const n={viewBox:"0 0 16 16",svg:(0,o(163643).jsx)("path",{d:"M3.2 6.725a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55m4.8 0a1.275 1.275 0 1 0 0 2.55 1.275 1.275 0 0 0 0-2.55"})},i=(0,o(680369).wt)("ellipsisSmall",n)},555296:(e,t,o)=>{o.d(t,{h:()=>a});o(242343);var n=o(163643);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.55 12.808a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"}),(0,n.jsx)("path",{d:"M10 1.95a4 4 0 0 0-4 4v1.433a2.426 2.426 0 0 0-2.025 2.392v5.4A2.425 2.425 0 0 0 6.4 17.6h7.2a2.425 2.425 0 0 0 2.425-2.425v-5.4A2.426 2.426 0 0 0 14 7.383V5.95a4 4 0 0 0-4-4m2.75 5.4h-5.5v-1.4a2.75 2.75 0 0 1 5.5 0zM5.225 9.775c0-.649.526-1.175 1.175-1.175h7.2c.649 0 1.175.526 1.175 1.175v5.4c0 .649-.526 1.175-1.175 1.175H6.4a1.175 1.175 0 0 1-1.175-1.175z"})]})},a=(0,o(680369).wt)("lock",i)},559181:(e,t,o)=>{o.d(t,{A:()=>a});o(242343);var n=()=>o(653998),i=o(163643);const a=function(e){let{collectionViewName:t,collectionViewType:a}=e;return t?(0,i.jsx)(o(826033).A,{children:t}):"page"===a?(0,i.jsx)(n().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(n().sA,{...o(91338).X[a]})}},569379:(e,t,o)=>{o.d(t,{h:()=>r});o(725707),o(113085);var n=()=>o(204132),i=()=>o(76394),a=()=>o(794772);function r(e){const{environment:t,typecheckResult:o,automationStore:r}=e,l=null==r?void 0:r.getTriggerType();if((0,i().O9)(l)){if(!(0,a().V)({triggerType:l,environment:t,automationStore:r}))return!0}return!n().Q.isFail(o)&&Object.values(o.value.actionValidationFailures).some((e=>null==e?void 0:e.some((e=>"requires_subscription_upgrade"===e.type))))}},572293:(e,t,o)=>{o.d(t,{V:()=>s});o(725707),o(491955);var n=()=>o(803290),i=()=>o(268163),a=()=>o(903012),r=()=>o(373994),l=()=>o(271142);function s(){const{automationStore:e,contextType:t}=(0,l().EC)(),o=(0,n().K8)((()=>(0,r().Z6)(e,t)),[e,t]);return(0,n().K8)((()=>{if(!o)return[];const{automation:e,automationActions:t}=o,n=e.getTriggerType(),r=(0,a().ad)({isGenericRecurrenceAllowed:!0})[n],l="default_bound"===r.max?a().x3:r.max;if(t.length>=l)return[];return function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.hasSideEffects)-t(e.hasSideEffects)))}((0,i().getActionRegistryItemsWithConcern)("display").filter((e=>e.isAvailableForContext({...o,isSubscribed:!0}))))}),[o])}},573951:(e,t,o)=>{o.d(t,{A:()=>h});o(362833),o(725707),o(491955),o(403517);var n=o.n(o(567012)),i=o(242343),a=()=>o(653998),r=()=>o(975392),l=()=>o(535906),s=()=>o(858023),c=()=>o(397791),u=()=>o(88271),d=()=>o(395705),p=()=>o(477784),m=o(163643);const g=(0,a().YK)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"},none:{defaultMessage:"None",id:"database.viewSettings.propertySelect.noneMessage"},remove:{defaultMessage:"Remove",id:"database.viewSettings.propertySelect.removeMessage"}});function y(e){let{currentProperty:t,showNoneOption:y,showRemoveOption:h,getProperties:f,onAccept:v,inputPlaceholder:x,defaultShowPropertyCount:b,disableSortByPageFormat:S,schema:C,format:A,renderProperty:k}=e;const M=(0,o(237385).Y0)(),[j,T]=(0,i.useState)(""),[I,w]=(0,i.useState)(!1),_=(0,o(803290).uB)(void 0,o(210466).A),P=(0,o(622286).X)("db_ux_mobile_filter_sheet"),B=(0,o(174114).IS)((e=>({menuItem:{color:e.text.secondary}})),[]),[R,V]=(0,o(875878).$)(),E=(0,o(875089).L)(A,C,void 0,o(810111).jf.Page).collection_page_properties||[],D=!b||I,F=p().A.formatMessage(g.none),O=y?{key:"none",render:e=>(0,m.jsx)(l().A,{...e,isChecked:!t,title:F}),action:()=>{v(void 0)}}:void 0,N=h?{key:"remove",render:e=>(0,m.jsx)(l().A,{...e,icon:(0,m.jsx)(c().I,{icon:o(836693).trashIcon}),title:p().A.formatMessage(g.remove)}),action:()=>{v(void 0)}}:void 0,L=f();let W=L;if(S||(W=r().Ul(L,(e=>E.findIndex((t=>t.property===e))))),j){const e=new Map;let t=W.map((t=>{const n=C[t],i=n?`${n.name} ${o(206183).dC[n.type]}`:"";return e.set(t,i),i}));t=n().filter(j,t).map((e=>{let{original:t}=e;return t})),W=W.filter((o=>t.includes(e.get(o)||"")))}else!D&&b&&(W=W.slice(0,b));const z=r().oE([!j||n().test(j,F)?O:void 0,...W.map((e=>function(e,t,o,n,i){const a=t[e];if(!a)return;const r={key:e,render:t=>{const o=e===n;return i?i(t,e,o,a):(0,m.jsx)(d().G,{...t,propertySchema:a,format:d().e.Name,isChecked:o})},action:()=>{o(e)}};return r}(e,C,v,t,k)))]);if(!D&&L.length>W.length&&!j){const e={key:"show_more",render:e=>(0,m.jsx)(l().A,{...e,icon:(0,m.jsx)(c().I,{icon:o(794484).L}),style:B.menuItem,title:(0,m.jsx)(a().sA,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:L.length-W.length}})}),action:()=>{w(!0)}};z.push(e)}const K=z.length>0,H=Boolean(j),U=!N||K||H;U&&!K&&z.push({action:r().lQ,key:"noResults",render:e=>(0,m.jsx)(o(725460).A,{...e,caption:(0,m.jsx)(a().sA,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});const Y=[];if(U){const e=(0,m.jsx)(o(401382).Ay,{focusInitial:!M.isMobile||void 0,focus:!M.isMobile||void 0,value:j,onChange:e=>{T(e.target.value),_.setState({..._.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),w(!1)},placeholder:x||p().A.formatMessage(g.inputPlaceholder),...R});M.isMobile&&P?z.unshift({key:"input",render:()=>e,action:r().lQ}):Y.push({key:"input",comp:(0,m.jsx)(u().A,{isInput:!0,children:e})})}return(z.length>0||N)&&Y.push({key:"properties",comp:(0,m.jsx)(s().Ay,{type:s().Oh.Vertical,initialFocus:0,comboboxProps:U?V:void 0,sections:[...z.length>0?[{key:"results",render:e=>(0,m.jsx)(u().A,{...e}),items:z}]:[],...N?[{key:"remove",render:e=>(0,m.jsx)(u().A,{topBorder:z.length>0,...e}),items:[N]}]:[]],store:_})}),(0,m.jsx)(m.Fragment,{children:Y.map((e=>{let{key:t,comp:o}=e;return(0,m.jsx)(i.Fragment,{children:o},t)}))})}const h=i.memo(y,o(21045).A)},575460:(e,t,o)=>{o.d(t,{A:()=>v});o(403517);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(198654),s=()=>o(640979);class c extends(()=>o(129044))().default{getInitialState(){return{}}}const u=c;var d=()=>o(209684),p=()=>o(273520),m=()=>o(918625),g=()=>o(935091),y=()=>o(858023),h=o(163643);function f(e,t){let{isMenuItem:i,style:l,labelStyle:s,alignmentToOrigin:c,renderMenuSections:d,label:p,selectedTitle:m,focused:g,disabled:y,innerButtonStyle:f,buttonPopupStore:v,downIconStyle:b}=e;const A=(0,r().DP)(),k=(0,a().uB)(void 0,u),M=(0,a().uB)(v,o(962373).A);return(0,n.useImperativeHandle)(t,(()=>({closeMenu:()=>{M.setState({...M.state,open:!1})}})),[M]),i?(0,h.jsx)(C,{alignmentToOrigin:c,isMenuItem:i,renderMenuSections:d,buttonPopupStore:M,SelectButtonStore:k,renderOrigin:e=>(0,h.jsx)(x,{events:e,style:l,isMenuItem:i,label:p,selectedTitle:m,focused:g,disabled:y})}):(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",height:32,...l},children:[p&&(0,h.jsx)("div",{style:{marginRight:"auto",color:A.text.tertiary,fontSize:14,...s},children:p}),(0,h.jsx)(C,{alignmentToOrigin:c,isMenuItem:i,renderMenuSections:d,buttonPopupStore:M,SelectButtonStore:k,renderOrigin:e=>(0,h.jsx)(S,{events:e,innerButtonStyle:f,disabled:y,selectedTitle:m,downIconStyle:b})})]})}const v=n.forwardRef(f);function x(e){let{events:t,style:o,isMenuItem:n,label:i,selectedTitle:a,focused:r,disabled:l}=e;if(n){const e=i?{title:i,right:a}:{title:a};return(0,h.jsx)(m()._,{...t,focused:Boolean(r),disabled:l,style:o,...e})}return null}function b(e){let{downIconStyle:t}=e;const{device:o}=(0,i().v3)(),n=(0,r().DP)();return(0,h.jsx)(h.Fragment,{children:(0,l().b)({width:o.isMobile?14:10,marginLeft:4,fill:n.lightIconColor,...t})})}function S(e){let{events:t,innerButtonStyle:o,downIconStyle:n,disabled:i,selectedTitle:a}=e;return(0,h.jsxs)(d().p,{disabled:i,disabledFeedback:!0,style:{marginRight:-6,...o},...t,children:[a,(0,h.jsx)(b,{downIconStyle:n})]})}function C(e){let{renderOrigin:t,alignmentToOrigin:o,isMenuItem:n,renderMenuSections:a,buttonPopupStore:r,SelectButtonStore:l}=e;const c=(0,i().v3)(),{device:u}=c;return(0,h.jsx)(p().Ay,{popupType:u.isMobile?p().z7.SlideUp:p().z7.Popup,buttonPopupStore:r,alignmentToOrigin:void 0!==o?o:p().yP.End,renderOrigin:t,placementToOrigin:n?p().sx.Right:p().sx.Bottom,render:e=>{let t;t=u.isMobile?{menuType:s().gu.ActionSheet}:{menuType:s().gu.Popup};const{focusedIndex:o,menuSections:n}=function(e,t,o){let n,i=0;const a=t(e).map((e=>({...e,items:e.items.map((e=>(e.key===o.state.selectedKey&&(n=i),i++,{...e,action:t=>{e.action(t),function(e,t){t.setState({selectedKey:e})}(e.key,o)}})))})));return{menuSections:a,focusedIndex:n}}(e,a,l);return(0,h.jsx)(g().A,{...t,children:(0,h.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:o,sections:n})})}})}},576992:(e,t,o)=>{o.d(t,{cI:()=>M,mk:()=>k,w$:()=>C});o(725707),o(491955),o(403517);var n=o(242343),i=()=>o(803290),a=()=>o(174114),r=()=>o(630714),l=()=>o(244812),s=()=>o(653998),c=()=>o(975392),u=()=>o(76394),d=()=>o(31448),p=()=>o(250786),m=()=>o(837809),g=()=>o(809785),y=()=>o(898266),h=()=>o(275334),f=()=>o(993517),v=()=>o(100096),x=()=>o(387652),b=()=>o(604104),S=o(163643);function C(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:c,propertySchema:u,value:p}=e,m=(0,s().tz)(),g=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...d().RC,fontWeight:d().Wy.medium}})),[]),y=(0,i().K8)((()=>k({intl:m,propertySchema:u,styles:g,value:p})),[m,u,g,p]),h=(0,i().K8)((()=>M({intl:m,propertySchema:u,value:p})),[m,u,p]),x=(0,n.useCallback)((e=>(0,S.jsx)(v().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:l().n,onClick:c,children:(0,S.jsx)("div",{style:g.content,children:y})})),[t,o,r,c,g.content,y]);return(0,S.jsx)(f().P,{renderOrigin:x,title:h})}function A(e,t){if(!e)return[];let o=(0,r().fromSimpleFormulaArrayValue)(e).filter((e=>(0,c().Kg)(e)));return"select"===t.type&&(o=o.slice(0,1)),o}function k(e){const{intl:t,limit:o,operator:n,propertySchema:i,styles:a,tokenFormat:r,value:l}=e,c=(0,p().Ug)(r),d=(0,S.jsx)("span",{style:a.propertyName,children:i.name});if("formula"===(null==l?void 0:l.type))return(0,S.jsx)(s().sA,{...h()._M({propertyName:d,propertyValue:(0,S.jsx)(b().g,{returnType:{type:"text"}})})});const y=h().kN({limit:o,propertySchema:i,optionValues:A(null==l?void 0:l.value,i)}).map((e=>"deleted"===e.type?(0,S.jsx)(x().A,{tokenFormat:c},`missing_option_value_${e.value}`):"option"===e.type?(0,S.jsx)(m().O,{color:e.value.color,format:c,isSingle:!0,showRemoveButton:!1,value:e.value.value},e.value.id):"truncation"===e.type?(0,S.jsx)(g().A,{format:c,isRound:!0,isSingle:!0,showRemoveButton:!1,value:e.value},"More tokens"):void(0,u().HB)(e)));return"replace"===n||"append"===n||"remove"===n||"toggle"===n?(0,S.jsx)(s().sA,{...h().f4({...h().f_({elements:y,intl:t}),operator:n,propertyName:d})}):0===y.length?(0,S.jsx)(s().sA,{...h().NW({propertyName:d})}):(0,S.jsx)(s().sA,{...h()._M({propertyName:d,propertyValue:y[0]})})}function M(e){const{intl:t,limit:o,propertySchema:n,value:i,operator:a}=e,r=n.name;if("formula"===(null==i?void 0:i.type))return(0,S.jsx)(s().sA,{...h()._M({propertyName:r,propertyValue:(0,S.jsx)(b().L,{})})});const l=h().kN({limit:o,propertySchema:n,optionValues:A(null==i?void 0:i.value,n)}).map((e=>"deleted"===e.type?h().iy(t):"option"===e.type?e.value.value:"truncation"===e.type?e.value:void(0,u().HB)(e)));return"replace"===a||"append"===a||"remove"===a||"toggle"===a?(0,S.jsx)(s().sA,{...h().f4({propertyName:r,propertyValue:(0,y().d)(t.formatList(l,{style:"long",type:"conjunction"})),operator:a})}):0===l.length?(0,S.jsx)(s().sA,{...h().NW({propertyName:r})}):(0,S.jsx)(s().sA,{...h()._M({propertyName:r,propertyValue:l[0]})})}},611506:(e,t,o)=>{o.d(t,{p:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},637558:(e,t,o)=>{o.d(t,{A:()=>p});o(725707),o(500234),o(403517);var n=o(242343),i=()=>o(803290),a=()=>o(975392),r=()=>o(273520),l=()=>o(858023),s=()=>o(443252),c=()=>o(88271),u=()=>o(640979),d=o(163643);const p=function(e){let{icon:t,iconStyle:p,title:m,selectedKey:g,onChange:y,onClick:h,popupStyle:f,menuItemOptionsStyle:v,menuStyle:x,disabled:b,collectionContextStore:S,openButtonPopup:C,hideCheck:A,children:k,disableParentClose:M,inputPlaceholder:j,...T}=e;const I=(0,o(237385).Y0)(),w="options"in T?T.options:a().Bq(T.sections),_=w.find((e=>a().n4(e.key,g))),P=(0,i().uB)(void 0,o(962373).A),B=(0,i().O$)(P);return(0,n.useEffect)((()=>{S&&C&&(P.setState({...P.state,open:C}),S.settingsStore.setState({...S.settingsStore.state,openButtonPopup:void 0})),_||o(502140).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,o(450475).convertErrorToLog)("Selected key is invalid.")})})),(0,d.jsx)(r().Ay,{popupType:I.isMobile?s().nl.SlideUp:s().nl.Popup,alignmentToOrigin:r().yP.End,placementToOrigin:r().sx.Bottom,style:f,originGap:0,buttonPopupStore:P,disabled:b,onClick:h,renderOrigin:e=>(0,d.jsx)(o(44405).A,{title:m,showChevron:!0,right:(0,d.jsx)("span",{style:o(31448).RC,children:"input"===(null==_?void 0:_.type)?_.inputValue:null==_?void 0:_.title}),rotateChevron:B.open,disabled:b,icon:t,iconStyle:p,...(0,o(906230).A)(e,T)}),render:e=>{let t;t=I.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:250,...x};const n=(t,n)=>{if(t.hideOption)return null;let i;return i="input"===t.type?{key:n,render:n=>(0,d.jsx)(o(401382).Ay,{...n,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var o;null===(o=t.onChange)||void 0===o||o.call(t,e.target.value)},onSubmit:o=>{var n;null===(n=t.onSubmit)||void 0===n||n.call(t,t.key,e,t.inputValue),e.close()},placeholder:j,isChecked:!A&&a().n4(t.key,g)}),action:()=>{}}:{key:n,render:e=>(0,d.jsx)(o(535906).A,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:v,isChecked:!A&&a().n4(t.key,g)}),action:()=>{y(t.key,e),M||e.close()}},i},i="sections"in T?T.sections.map(((e,t)=>({key:t,render:e=>(0,d.jsx)(c().A,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:a().oE(e.map(n))}))):[{key:0,render:e=>(0,d.jsx)(c().A,{enableActionSheetTitle:!0,...e}),items:a().oE(w.map(n))}];return(0,d.jsxs)(o(935091).A,{...t,children:[(0,d.jsx)(l().Ay,{type:l().Oh.Vertical,sections:i,initialFocus:0,resetFocusOnMouseOut:!0}),k||null]})}})}},639659:(e,t,o)=>{o.d(t,{a:()=>a});var n=()=>o(803290);const i=new(o(496985).default)((()=>o(521972).g.state.isOpen),{debugName:"IsInPageViewModeStore"});function a(){return(0,n().O$)(i)}},641383:(e,t,o)=>{o.d(t,{rD:()=>v,zH:()=>f});var n=o(242343),i=()=>o(174114),a=()=>o(630714),r=()=>o(303707),l=()=>o(660354),s=()=>o(277993),c=()=>o(653998),u=()=>o(31448),d=()=>o(301148),p=()=>o(275334),m=()=>o(993517),g=()=>o(100096),y=()=>o(604104),h=o(163643);function f(e){const{actionMenu:t,buttonPopupStore:o,disabled:f,onClick:x,propertySchema:b,value:S}=e,C=(0,i().IS)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),A=function(e){const{propertySchema:t,styles:o,value:n}=e,i=(0,h.jsx)("span",{style:o.propertyName,children:t.name});let s;const u="formula"===(null==n?void 0:n.type);if(u)s=(0,h.jsx)(y().g,{returnType:{type:"checkbox"}});else{const e=(0,a().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0],t=!0===e?(0,l().v)({width:12}):(0,r().K)({width:10});s=(0,h.jsx)(d().G,{icon:t,shouldTruncateChildren:!0,children:!0===e?(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyChecked}):(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyUnchecked})})}return(0,h.jsx)(c().sA,{...p().Xr({propertyName:i,propertyValue:s})})}({propertySchema:b,styles:C,value:S}),k=v({propertySchema:b,value:S}),M=(0,n.useCallback)((e=>(0,h.jsx)(g().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:f,icon:s().S,onClick:x,children:(0,h.jsx)("div",{style:C.content,children:A})})),[t,o,f,x,C.content,A]);return(0,h.jsx)(m().P,{renderOrigin:M,title:k})}function v(e){const{propertySchema:t,value:o}=e;let n;if("formula"===(null==o?void 0:o.type))n=(0,h.jsx)(y().L,{});else{n=!0===(0,a().fromSimpleFormulaArrayValue)(null==o?void 0:o.value)[0]?(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyChecked}):(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyUnchecked})}return(0,h.jsx)(c().sA,{...p().Xr({propertyName:t.name,propertyValue:n})})}},643919:(e,t,o)=>{o.d(t,{l:()=>f});var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(916963),s=()=>o(653998),c=()=>o(31448),u=()=>o(573951),d=()=>o(273520),p=()=>o(935091),m=()=>o(441911),g=()=>o(179701),y=()=>o(284573),h=o(163643);function f(e){const{alreadyHaveProperties:t,availablePropertyIds:o,collectionStore:f,currentValue:v,disabled:x,onChange:b,onRemove:S,placeholderMessage:C,errorMessage:A,hideErrorMessageTooltip:k}=e,M=(0,i().v3)(),j=(0,r().DP)(),{device:T}=M,I=(0,a().K8)((()=>f.getSchema()??{}),[f]),w=(0,a().K8)((()=>f.getFormat()??{}),[f]),_=(0,a().K8)((()=>v?f.getSchema()[v]:void 0),[v,f]),P=(0,a().K8)((()=>v?f.getDeletedSchema()[v]:void 0),[v,f]),B=(0,r().IS)((e=>{const t={fill:e.text.tertiary,height:"auto",marginRight:4,width:16};return{propertyIcon:t,deletedPropertyIcon:{...t,fill:e.text.uiRedPrimary},propertyTitle:{fontWeight:c().Wy.regular,...c().RC},deletedPropertyTitle:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,...c().RC}}}),[]),R=(0,n.useCallback)((()=>o),[o]),V=(0,g().j)(),E=(0,a().K8)((()=>_?function(e){return(0,h.jsx)(l().zB,{icon:void 0,size:16,style:{...e,...B.propertyIcon},theme:j,type:_.type})}:P?function(e){return(0,h.jsx)(l().zB,{icon:void 0,type:P.type,size:16,theme:j,style:{...e,...B.deletedPropertyIcon}})}:void 0),[P,_,B.deletedPropertyIcon,B.propertyIcon,j]),D=Boolean(A),F=!Boolean(_)&&!Boolean(t),O=!Boolean(t);return(0,h.jsx)(d().Ay,{popupType:V,alignmentToOrigin:d().yP.Center,placementToOrigin:d().sx.Bottom,originGap:0,disabled:x,renderOrigin:e=>(0,h.jsx)(y().x,{...e,disabled:x,icon:E,isError:D,hasActionRequired:F,isSecondary:O,tooltipMessage:!k&&A,dropdownButtonType:"button",children:_?(0,h.jsx)("div",{style:B.propertyTitle,children:_.name}):P?(0,h.jsx)("div",{style:B.deletedPropertyTitle,children:P.name}):C?(0,h.jsx)(s().sA,{...C}):t?(0,h.jsx)(s().sA,{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit property"}):(0,h.jsx)(s().sA,{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})}),render:e=>{const t=(0,m().v)({device:T,width:280,paddingTop:4});return(0,h.jsx)(p().A,{...t,children:(0,h.jsx)(u().A,{schema:I,format:w,showRemoveOption:Boolean(S),currentProperty:v,getProperties:R,onAccept:t=>{t&&t!==v?b(t):void 0===t&&(null==S||S(v)),e.close()}})})}})}},658294:(e,t,o)=>{o.d(t,{G:()=>a});var n=()=>o(137476),i=()=>o(836331);function a(e,t){n().vd(e,"delete_property",t),i().default.logEvent("delete_property")}},668657:(e,t,o)=>{o.d(t,{q:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("search",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M.281 6.438c0-.875.164-1.696.492-2.461a6.484 6.484 0 011.375-2.032A6.237 6.237 0 016.64.078 6.2 6.2 0 019.11.57c.77.328 1.447.787 2.03 1.375a6.374 6.374 0 011.368 2.032c.333.765.5 1.586.5 2.46 0 .688-.107 1.342-.32 1.961a6.28 6.28 0 01-.868 1.696l3.563 3.578c.11.104.19.226.242.367.057.14.086.29.086.445 0 .22-.05.417-.149.594a1.122 1.122 0 01-1 .57c-.156 0-.307-.028-.453-.086a1.058 1.058 0 01-.382-.25l-3.586-3.585c-.5.333-1.047.596-1.641.789a6.089 6.089 0 01-1.86.28 6.237 6.237 0 01-2.468-.491 6.4 6.4 0 01-2.024-1.367A6.509 6.509 0 01.773 8.913a6.256 6.256 0 01-.492-2.476zm1.664 0c0 .65.12 1.26.36 1.828a4.775 4.775 0 001.015 1.5c.433.427.933.763 1.5 1.007a4.548 4.548 0 001.82.368c.652 0 1.261-.123 1.829-.368a4.747 4.747 0 002.508-2.507 4.567 4.567 0 00.367-1.829c0-.645-.123-1.252-.367-1.82a4.776 4.776 0 00-1.016-1.5A4.578 4.578 0 008.469 2.11a4.567 4.567 0 00-1.828-.367c-.646 0-1.253.123-1.82.367a4.667 4.667 0 00-1.5 1.008c-.433.432-.772.932-1.016 1.5a4.633 4.633 0 00-.36 1.82z"})})},686752:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,pencilLineIcon:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"m13.987 5.682-.684.684-1.288-1.288.692-.691a.91.91 0 0 1 1.28 0c.35.35.35.93 0 1.28zm-9.433 9.433 7.914-7.914-1.289-1.289-7.92 7.908c-.122.122-.214.29-.274.457l-.336 1.082c-.06.229.153.442.366.366l1.082-.335q.252-.07.457-.275m12.446.76H5.61l1.25-1.25H17a.625.625 0 1 1 0 1.25"})},i=(0,o(680369).wt)("pencilLine",n)},698548:(e,t,o)=>{o.d(t,{z:()=>F});o(725707),o(491955),o(113085);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(715768),s=()=>o(236089),c=()=>o(296315),u=()=>o(247160),d=()=>o(507190),p=()=>o(686752),m=()=>o(155342),g=()=>o(836693),y=()=>o(680369),h=()=>o(653998),f=()=>o(76394),v=()=>o(337658),x=()=>o(535906),b=()=>o(579494),S=()=>o(345022),C=()=>o(935091),A=()=>o(858023),k=()=>o(88271),M=()=>o(73631),j=()=>o(129978),T=()=>o(56432),I=()=>o(271142),w=()=>o(738355),_=()=>o(830925),P=()=>o(441911),B=()=>o(572293),R=()=>o(270946),V=()=>o(498248),E=o(163643);const D=(0,h().YK)({learnAboutVariablesMenuItemLabel:{defaultMessage:"Learn about variables",id:"automations.actionContextMenu.learnAboutVariablesMenuItemLabel"},learnAboutWebhooksMenuItemLabel:{defaultMessage:"Learn about webhooks",id:"automations.actionContextMenu.learnAboutWebhooksMenuItemLabel"},addStepAboveMenuItemLabel:{defaultMessage:"Add action above",id:"automations.actionContextMenu.addStepAboveMenuItemLabel"},addStepBelowMenuItemLabel:{defaultMessage:"Add action below",id:"automations.actionContextMenu.addStepBelowMenuItemLabel"},deleteMenuItemLabel:{defaultMessage:"Delete",id:"automations.actionContextMenu.deleteMenuItemLabel"},duplicateMenuItemLabel:{defaultMessage:"Duplicate",id:"automations.actionContextMenu.duplicateMenuItemLabel"},duplicatingMenuItemLabel:{defaultMessage:"Duplicating…",id:"automations.actionContextMenu.duplicatingMenuItemLabel"},editMenuItemLabel:{defaultMessage:"Edit",id:"automations.actionContextMenu.editMenuItemLabel"},moveDownMenuItemLabel:{defaultMessage:"Move down",id:"automations.actionContextMenu.moveDownMenuItemLabel"},moveUpMenuItemLabel:{defaultMessage:"Move up",id:"automations.actionContextMenu.moveUpMenuItemLabel"}});function F(e){const{actionStore:t,closeMenu:o}=e,{maybePersistedTransactionActions:r}=(0,w().b)(),{automationStore:l,contextType:s}=(0,I().EC)(),c=(0,h().tz)(),u=(0,i().v3)(),{value:d}=(0,j().fJ)(M().T.formulas),{value:p}=(0,j().fJ)(v().QV.automationTypecheck),[m,g]=(0,n.useState)(),y=(0,a().K8)((()=>l.getActionIds()),[l]),f=(0,a().K8)((()=>y.indexOf(t.id)),[t.id,y]),x=(0,a().K8)((()=>(0,R().J)(s,t)),[t,s]),b=(0,a().K8)((()=>{if(!x||!t.isType("update_pages"))return;const e=t.getConfigStore().getKeyStore("properties").getValue();return null==e?void 0:e[0]}),[t,x]),S=0===f,C=f===y.length-1,A=(0,n.useCallback)((()=>{g(void 0),null==o||o()}),[o]),k=(0,B().V)(),P=(0,a().K8)((()=>k.some((e=>e.type===t.getType()))),[t,k]),F=(0,_().n)(l),N=(0,n.useMemo)((()=>{if(l&&P)return async()=>{const e=r.createAndCommit({perform:e=>T().duplicateAutomationAction({sourceActionStore:t,environment:u,includeParenting:!0,insertionPoint:{afterActionId:t.id},transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,A()}}),[t,l,u,A,r,P]),W=(0,n.useCallback)((()=>{if(d&&p)return r.createAndCommit({perform:e=>{T().removeAutomationAction({actionStore:t,automationStore:l,automationTypecheckModule:p,contextType:s,environment:u,formulasModule:d,intl:c,isSubscribed:F,transaction:e})},userAction:"ActionContextMenu.removeAction"}),A(),Promise.resolve()}),[t,l,p,s,u,d,A,c,r,F]),z=(0,n.useMemo)((()=>{if(!S&&d&&p)return()=>{r.createAndCommit({perform:e=>{const o=L(y,f-1,f);T().reorderAutomationActions({environment:u,automationStore:l,automationTypecheckModule:p,contextType:s,formulasModule:d,intl:c,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id,isSubscribed:F})},userAction:"ActionContextMenu.moveAction"}),A()}}),[S,r,A,y,d,f,l,s,c,u,t,p,F]),K=(0,n.useMemo)((()=>{if(!C&&d&&p)return()=>{r.createAndCommit({perform:e=>{const o=L(y,f+1,f);T().reorderAutomationActions({environment:u,automationStore:l,automationTypecheckModule:p,contextType:s,formulasModule:d,intl:c,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id,isSubscribed:F})},userAction:"ActionContextMenu.moveAction"}),A()}}),[C,r,A,y,f,l,s,c,d,u,t,p,F]),H=(0,n.useMemo)((()=>{if(x&&b)return function(){g({initialState:{actionId:t.id,propertyId:b,type:"eventActionProperty"},insertionPoint:void 0})}}),[t.id,x,b]),U=(0,n.useMemo)((()=>{if(0!==k.length)return()=>{g({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{beforeActionId:t.id}})}}),[k.length,t.id]),Y=(0,n.useMemo)((()=>{if(0!==k.length)return()=>{g({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{afterActionId:t.id}})}}),[k.length,t.id]),G=(0,a().K8)((()=>"define_variables"===t.getType()?{link:"https://www.notion.so/help/database-automations#database-automation-actions",label:D.learnAboutVariablesMenuItemLabel}:"http_request"===t.getType()?{link:"https://www.notion.so/help/webhook-actions",label:D.learnAboutWebhooksMenuItemLabel}:void 0),[t]);return(0,E.jsxs)(E.Fragment,{children:[!m&&(0,E.jsx)(O,{onAddStepAbove:U,onAddStepBelow:Y,onDelete:W,onDuplicate:N,onEdit:H,onMoveDown:K,onMoveUp:z,learnAbout:G}),m&&(0,E.jsx)(V().A,{initialState:m.initialState,insertionPoint:m.insertionPoint,onClose:A})]})}function O(e){const{onAddStepAbove:t,onAddStepBelow:o,onDelete:i,onDuplicate:a,onEdit:v,onMoveDown:x,onMoveUp:S,learnAbout:M}=e,j=(0,P().e)();let T=!1;const I=function(e){const{hasSeparator:t,onEdit:o}=e,i=(0,n.useMemo)((()=>{if(o)return{action:o,key:"edit",render:e=>(0,E.jsx)(N,{...e,icon:(0,p().pencilLineIcon)({width:y().Ev.default}),children:(0,E.jsx)(h().sA,{...D.editMenuItemLabel})})}}),[o]),a=[i].filter(f().O9);if(0===a.length)return;return{items:a,key:"editActions",render:e=>(0,E.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onEdit:v});T||=Boolean(I);const w=function(e){const{hasSeparator:t,onMoveDown:o,onMoveUp:i}=e,a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"moveUp",render:e=>(0,E.jsx)(N,{...e,icon:(0,s().s)({width:y().Ev.default}),children:(0,E.jsx)(h().sA,{...D.moveUpMenuItemLabel})})}}),[i]),r=(0,n.useMemo)((()=>{if(o)return{action:o,key:"moveDown",render:e=>(0,E.jsx)(N,{...e,icon:(0,l().v)({width:y().Ev.default}),children:(0,E.jsx)(h().sA,{...D.moveDownMenuItemLabel})})}}),[o]),c=[a,r].filter(f().O9);if(0===c.length)return;return{items:c,key:"moveSteps",render:e=>(0,E.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onMoveDown:x,onMoveUp:S});T||=Boolean(w);const _=function(e){const{hasSeparator:t,onAddStepAbove:o,onAddStepBelow:i}=e,a=(0,n.useMemo)((()=>{if(o)return{action:o,key:"addStepAbove",render:e=>(0,E.jsx)(N,{...e,icon:(0,u().F)({width:y().Ev.default}),children:(0,E.jsx)(h().sA,{...D.addStepAboveMenuItemLabel})})}}),[o]),r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"addStepBelow",render:e=>(0,E.jsx)(N,{...e,icon:(0,c().o)({width:y().Ev.default}),children:(0,E.jsx)(h().sA,{...D.addStepBelowMenuItemLabel})})}}),[i]),l=[a,r].filter(f().O9);if(0===l.length)return;return{items:l,key:"addSteps",render:e=>(0,E.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onAddStepAbove:t,onAddStepBelow:o});T||=Boolean(_);const B=function(e){const{hasSeparator:t,onDuplicate:o,onDelete:i}=e,[a,r]=(0,n.useState)(!1),l=(0,n.useMemo)((()=>{if(o)return{action:async()=>{r(!0);try{await o()}finally{r(!1)}},key:"duplicate",render:e=>(0,E.jsx)(N,{...e,icon:(0,d().V)({width:y().Ev.default}),isLoading:a,children:a?(0,E.jsx)(h().sA,{...D.duplicatingMenuItemLabel}):(0,E.jsx)(h().sA,{...D.duplicateMenuItemLabel})})}}),[a,o]),s=(0,n.useMemo)((()=>{if(i)return{action:i,key:"delete",render:e=>(0,E.jsx)(N,{...e,icon:(0,g().trashIcon)({width:y().Ev.default}),isRedOnHover:!0,children:(0,E.jsx)(h().sA,{...D.deleteMenuItemLabel})})}}),[i]),c=[l,s].filter(f().O9);if(0===c.length)return;return{items:c,key:"otherActions",render:e=>(0,E.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onDuplicate:a,onDelete:i});T||=Boolean(B);const R=function(e){const{hasSeparator:t,learnAbout:o}=e,n=(0,r().IS)((e=>({icon:{height:16,width:16,fill:e.text.secondary},textWrapper:{color:e.text.secondary}})),[]);if(!o)return;return{items:[{action:()=>{},key:"learnAbout",render:e=>(0,E.jsx)(N,{...e,icon:(0,m().questionMarkCircleIcon)(n.icon),textWrapperStyle:n.textWrapper,children:(0,E.jsx)(b().A,{href:o.link,external:!0,children:(0,E.jsx)(h().sA,{...o.label})})})}],key:"learnSteps",render:e=>(0,E.jsx)(k().A,{topBorder:t,...e})}}({hasSeparator:T,learnAbout:M});return T||=Boolean(R),(0,E.jsx)(C().A,{...j,children:(0,E.jsx)(A().Ay,{type:A().Oh.Vertical,sections:[I,w,_,B,R].filter(f().O9),initialFocus:0})})}function N(e){const{children:t,icon:o,isLoading:n,...i}=e,a=n?(0,E.jsx)(S().A,{}):o;return(0,E.jsx)(x().A,{...i,disabled:n,disabledFeedback:n,icon:a,title:t})}function L(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}},699773:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(242343),i=()=>o(846581),a=()=>o(16456),r=()=>o(427091),l=o(163643);const s=function(e){const t=(0,o(653998).tz)(),s=(0,o(174114).DP)(),d=(0,o(221573).I)(),p=(0,n.useRef)(),m=(0,n.useCallback)((()=>{const t=e.value;if(!t)return;const n=a().q8(t,(0,r().P)());if(!n)return;const i=n.valueOf(),l=i-Date.now();l<0||l>o(141666).nD||p.current&&p.current.timestamp===i||(p.current&&clearTimeout(p.current.timer),p.current={timestamp:i,timer:setTimeout((()=>d("DateBox","DateBox/createReminderTimer")),l)})}),[d,e.value]),g=(0,n.useCallback)((()=>{p.current&&(clearTimeout(p.current.timer),p.current=void 0)}),[]);(0,n.useEffect)((()=>{m()}),[m]),(0,n.useEffect)((()=>()=>{g()}),[g]);const{value:y,withComma:h}=e,f=(0,o(803290).K8)((()=>y?(0,i().ZF)({value:y,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,r().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:o(533975).x1}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,y]);if(!y)return null;const v=a().AA(y,(0,r().P)(),o(16791).locale);let x;if(y.reminder){const e=a().Zs(y,(0,r().P)());x=e?{color:s.errorText}:{color:o(220413).Ay.blue}}const b=(0,l.jsxs)(l.Fragment,{children:[f,y.reminder&&(0,o(508024).P)({display:"inline-block",width:"1em",marginLeft:6,marginRight:2,paddingBottom:4,verticalAlign:"middle"}),h?", ":null]});return e.disableTooltip?(0,l.jsx)("div",{className:e.className,style:{...e.style,...x},children:b}):(0,l.jsx)(o(103151).A,{renderTooltip:()=>(0,l.jsxs)(l.Fragment,{children:[e.tooltipHeader,(0,l.jsxs)("div",{style:u(s,e.tooltipHeader),children:[c(v.start),v.end?` → ${c(v.end)}`:""]})]}),render:t=>(0,l.jsx)("div",{className:e.className,style:{...e.style,...x},...t,children:b}),placement:e.tooltipPlacement})};function c(e){return(0,i().eV)({value:e,preset:"medium"})}function u(e,t){return t?{color:e.text.contrastSecondary}:{}}},708029:(e,t,o)=>{o.d(t,{U:()=>A});o(242343);var n=()=>o(237385),i=()=>o(803290),a=()=>o(174114),r=()=>o(630714),l=()=>o(31448),s=()=>o(284573),c=()=>o(622286),u=()=>o(962373),d=()=>o(273520),p=()=>o(443252),m=()=>o(475077),g=()=>o(59177),y=(o(403517),()=>o(653998)),h=()=>o(76394),f=()=>o(553538),v=()=>o(523365),x=()=>o(128192),b=o(163643);function S(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:n,formulaTypecheckContextValues:i,parentRecordStore:r,placeholder:l,spaceId:s,type:c,value:u}=e,d=(0,a().IS)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),p=(0,v().pg)(t);if("formula"===(null==u?void 0:u.type)&&u.value)return(0,b.jsx)(f().$,{formulaTypecheckContextValues:i??[],parentRecordStore:r,spaceId:s,value:u});if("text"===c.type||"number"===c.type)return null;if("date"===c.type||"select"===c.type||"checkbox"===c.type){const e=o[0];return void 0===e?(0,b.jsx)(C,{placeholder:l}):(0,b.jsx)("div",{style:d.tokenWrap,children:(0,b.jsx)(g().g,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t})})}return"person_array"===c.type||"block_array"===c.type||"select_array"===c.type?0===o.length?(0,b.jsx)(C,{placeholder:l}):(0,b.jsx)("div",{style:d.tokenWrap,children:p(o,"first").map(((e,i)=>(0,b.jsx)(g().g,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t},i)))}):void(0,h().HB)(c)}function C(e){const{placeholder:t}=e,o=(0,a().IS)((e=>({placeholderText:{color:e.text.tertiary}})),[]);return(0,b.jsx)("div",{style:o.placeholderText,children:t?(0,b.jsx)(y().sA,{defaultMessage:"{placeholder}",values:{placeholder:t},id:"formulas.SimpleFormulaValuePicker.people.customPlaceholder"}):(0,b.jsx)(y().sA,{...x().D.personSelect})})}function A(e){const{allowedReturnTypes:t,disabled:o,disableEmojiCommands:y,disableFormattingAndMentions:h,disableMobileActionBar:f,disableTemplateVariableMentions:v,errorMessage:x,formulaTypecheckContextValues:C,limit:A,menuProps:k,onChange:M,parentRecordStore:j,placeholder:T,showClearButton:I,showInputMenuItem:w,simpleFormulaContext:_,spaceId:P,style:B,type:R,value:V}=e,E=(0,n().Y0)(),D=!V||"simple"===V.type,F=(0,i().K8)((()=>(0,r().fromSimpleFormulaArrayValue)(null==V?void 0:V.value)),[V]),O=(0,c().X)("collections_xws"),N=(0,a().IS)((e=>({button:{boxShadow:e.inputBoxShadow,flexGrow:1,flexShrink:1,fontSize:"inherit",fontWeight:l().Wy.regular,...B}})),[B]),L=(0,i().uB)(void 0,u().A),W=O?"cross_space_and_read_permissions":"read_permissions_only";return(0,b.jsx)(d().Ay,{alignmentToOrigin:d().yP.End,buttonPopupStore:L,disabled:o,originGap:0,placementToOrigin:d().sx.Bottom,popupType:E.isMobile?p().nl.SlideUp:p().nl.Popup,renderOrigin:e=>(0,b.jsx)(s().x,{...e,disabled:o,hasActionRequired:!Boolean(F.length>0),isError:Boolean(x),style:N.button,tooltipMessage:x,dropdownButtonType:"button",children:(0,b.jsx)(S,{currentSimpleFormulaValueTokens:F,context:_,disabled:!0,formulaTypecheckContextValues:C,parentRecordStore:j,placeholder:T,spaceId:P,type:R,value:V})}),render:e=>D?(0,b.jsx)(g().L,{currentSimpleFormulaValueTokens:F,disableEmojiCommands:y,disableFormattingAndMentions:h,disableMobileActionBar:f,disableTemplateVariableMentions:v,formulaTypecheckContextValues:C,formulaValueContext:_,limit:A,menuProps:k,onChange:M,onClose:e.close,parentRecordStore:j,showClearButton:I,showInputMenuItem:w,type:R,value:V}):(0,b.jsx)(m().A,{allowedReturnTypes:t,disabled:o,formulaTypecheckContextValues:C,onChange:M,onClose:e.close,parentRecordStore:j,restrictUnaccessibleProperties:W,spaceId:P,value:V})})}},715768:(e,t,o)=>{o.d(t,{v:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10.625 3a.625.625 0 1 0-1.25 0v12.491l-4.333-4.333a.625.625 0 1 0-.884.884l5.4 5.4a.62.62 0 0 0 .884 0l5.4-5.4a.625.625 0 0 0-.884-.884l-4.333 4.333z"})},i=(0,o(680369).wt)("arrowStraightDown",n)},725460:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(242343),i=o(163643);function a(e,t){return(0,i.jsx)(o(932322).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const r=(0,n.forwardRef)(a)},731991:(e,t,o)=>{o.d(t,{W:()=>a,X:()=>i});var n=()=>o(803290);function i(e){return e.isReady()&&!e.isDefined()&&"none"!==e.getRole()}function a(e){return(0,n().K8)((()=>i(e)),[e])}},738677:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("addPage",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},749975:(e,t,o)=>{o.d(t,{ET:()=>s,Ks:()=>c,RI:()=>l,p2:()=>r});o(610931);var n=o(242343);const i="collectionContextStore",a=(0,o(372660).C)({displayName:i,legacyContextKey:i,modernContextDefaultValue:void 0}),r=a.context,l=a.Provider;function s(){const e=n.useContext(r);if(void 0===e)throw new Error(`No context provided: ${i}`);return e}function c(){return n.useContext(r)}},755989:(e,t,o)=>{o.d(t,{Ld:()=>u,kg:()=>d,uF:()=>p});var n=()=>o(803290),i=()=>o(564134),a=()=>o(706788),r=()=>o(405317),l=()=>o(96718),s=()=>o(485966),c=()=>o(133926);function u(e){let{spaceId:t,userId:o}=e;const n=(0,c()._X)({name:"collection_connected_property_figma",spaceId:t,userId:o}),i=(0,c()._X)({name:"collection_connected_property_github",spaceId:t,userId:o}),r=(0,c()._X)({name:"collection_connected_property_google_drive",spaceId:t,userId:o}),l=(0,c()._X)({name:"collection_connected_property_zendesk",spaceId:t,userId:o});return{[a().e1]:n,[a().ob]:i,[a().Hd]:r,[a().k0]:l}}function d(e){if(!e)return;const t=e&&(0,i().UU)(e)?e.connectedRelation.integration_id:void 0;return(0,l().l)(t)}function p(e){let{featureName:t}=e;const o=function(e){const t=e.featureName,o=(0,n().K8)((()=>{var t;return e.spaceId??(null===(t=s().default.state.currentSpaceStore)||void 0===t?void 0:t.id)}),[e.spaceId]),i=(0,n().K8)((()=>{var t;return e.userId??(null===(t=s().default.state.currentUserStore)||void 0===t?void 0:t.id)}),[e.userId]);return(0,c()._X)({name:t,spaceId:o,userId:i})}({featureName:t});if(!o)return;const i=(0,r().e2)(o),a=(0,r().Xq)(o);let l,u;return!a||"product"!==a.type||"plus"!==a.product&&"business"!==a.product&&"enterprise"!==a.product||(l=a.product),i&&(u=i&&o.expiry&&"sunset"===o.expiry.type?o.expiry.endDate:void 0),{isAvailable:i,expirationDate:u,upsell:a,upsellTier:l}}},761495:(e,t,o)=>{o.r(t),o.d(t,{AutomationBuilderModal:()=>ct,ButtonBuilderModal:()=>St});o(362833),o(725707),o(491955),o(113085);var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(911575),s=()=>o(839999),c=()=>o(81322),u=()=>o(711659),d=()=>o(653998),p=()=>o(975392),m=()=>o(204132),g=()=>o(76394),y=()=>o(31448),h=()=>o(521325),f=()=>o(575015),v=()=>o(337658),x=()=>o(3364),b=()=>o(126451),S=()=>o(858023),C=()=>o(286404),A=()=>o(951540),k=()=>o(88271),M=()=>o(264022),j=()=>o(712437),T=()=>o(242978),I=()=>o(52531),w=()=>o(723361),_=()=>o(769884),P=()=>o(673447),B=()=>o(145017),R=()=>o(518797),V=()=>o(21164),E=()=>o(528762),D=()=>o(264330),F=()=>o(165601),O=()=>o(483019),N=()=>o(807069),L=()=>o(890315),W=()=>o(271142),z=()=>o(157699),K=()=>o(830925),H=()=>o(209684),U=()=>o(611824),Y=()=>o(73631),G=()=>o(137476),q=()=>o(373994),X=()=>o(352723),$=()=>o(129978),J=()=>o(485966),Q=()=>o(413871),Z=()=>o(943066),ee=()=>o(133926),te=o(163643);const oe=(0,d().YK)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationExternalBotNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationExternalBotNoPermissions"},automationExternalBotWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationExternalBotWithPermissions"},automationMissingPermissionsNoPermissionsForDatabase:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissionsForDatabase"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"},automationMissingActionFeature:{defaultMessage:"The {actionName} action is not available in your workspace",id:"AutomationHeaderView.automationMissingActionFeature"},mustBeWorkspaceMember:{defaultMessage:"You must be a workspace member to edit automations",id:"AutomationHeaderView.mustBeWorkspaceMember"}});function ne(e,t){return(0,n.useCallback)((()=>{e&&Z().K(t,{from:"database_automation_settings_header_message",upsell:e})}),[e,t])}function ie(e){var t;const{automationPermissionScope:o,collectionStore:n,collectionSettingsStore:r,onDelete:l,referencesIncompatibleCollectionViewFilter:s,requiresSubscriptionUpgrade:c}=e,u=(0,i().v3)(),{automationStore:p,contextType:m}=(0,W().EC)(),y=(0,d().tz)(),{value:h}=(0,$().fJ)(Y().T.formulas),{value:f}=(0,$().fJ)(v().QV.automationActionRegistry),{value:x}=(0,$().fJ)(v().QV.automationTypecheck),b=(0,a().K8)((()=>Boolean((0,X().qb)(u,p))),[p,u]),S=(0,a().K8)((()=>p.getSpaceId()),[p]),C=(0,a().K8)((()=>{var e;return null===(e=J().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),A=(0,K().n)(p),k=(0,ee()._X)({name:"slack_automation_action",spaceId:S,userId:null==C?void 0:C.id}),M=(0,z().c)({automationStores:[p],slackActionFeatureAvailability:k}),_=(0,a().K8)((()=>(0,q().sl)({environment:u,automationStore:p,automationActionRegistryModule:f,automationTypecheckModule:x,contextType:m,formulasModule:h,intl:y,isSubscribed:A})),[u,p,f,x,m,h,y,A]),Z=(0,a().K8)((()=>{const e=(0,P().O)({recordPointer:n.pointer,getRecordModel:n.getRecordModel});if(!e||e.table!==B().ev)return;const t=e.pointer;return Q().Bv.createChildStore(n,t)}),[n]),ie=se(),ce=ne(null==k?void 0:k.upsell,u),ue=ne(k&&"expiry"in k&&null!==(t=k.expiry)&&void 0!==t&&t.upsell?k.expiry.upsell:void 0,u);if(c)return(0,te.jsx)(L().j,{onUpsellClick:ce});if(Z)return(0,te.jsx)(le,{icon:(0,te.jsx)("div",{style:ie.lockedIconWrap,children:(0,I().I)(ie.lockedIcon)}),children:(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{style:ie.paragraph,children:(0,te.jsx)(d().sA,{...oe.automationCollectionInTrashedPage})}),(0,te.jsx)(H().p,{onClick:()=>{!function(e,t){(function(e){(0,G().vd)(e,"view_deleted_page_from_automation_edit_menu")})(t),D().Y({environment:t,store:e,pageVisitSource:j().y8.LinkInPage})}(Z,u),F().V({environment:u,collectionSettingsStore:r})},style:ie.restoreButton,isLightGray:!0,children:(0,te.jsx)(d().sA,{...oe.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(b)return(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationPublicAccess})});if("insufficient"===_.editPermissionStatus){if("free_workspace"===_.reason)return(0,q().ip)({contextType:m,environment:u})?(0,te.jsx)(re,{icon:(0,te.jsx)("div",{style:ie.boltIconWrap,children:(0,T().v)(ie.boltIcon)}),children:(0,te.jsx)("p",{style:ie.paragraph,children:(0,te.jsx)(d().sA,{...oe.automationUpgrade,values:{"anchor-upsell":e=>(0,te.jsx)(U().A,{onClick:ce,style:ie.link,children:e})}})})}):(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationEditOnSite})});if("feature_not_enabled"===_.reason)return(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationMissingActionFeature,values:{actionName:_.actionName.toLocaleLowerCase()}})});var de,pe,me;if("missing_permissions"===_.reason)return(null===(de=_.relatedPointer)||void 0===de?void 0:de.table)===R().GP?(0,te.jsx)(ae,{botId:_.relatedPointer.id,automationPermissionScope:o,onDelete:l,automationStore:p}):(null===(pe=_.relatedPointer)||void 0===pe?void 0:pe.table)===V().Vl&&_.relatedPointer.id!==n.id?(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationMissingPermissionsNoPermissionsForDatabase})}):(null===(me=_.relatedPointer)||void 0===me?void 0:me.table)===E().NX?(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.mustBeWorkspaceMember})}):(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationGenericFullAccess})});(0,g().HB)(_)}else{if("unknown"===_.editPermissionStatus)return(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...oe.automationGenericFullAccess})});if("sufficient"===_.editPermissionStatus)return s?(0,te.jsx)(O().z,{icon:(0,w().Q)(ie.warningIcon),children:(0,te.jsx)(d().sA,{...oe.automationIncompatibleViewFilterAndOwner})}):M?(0,te.jsx)(N().v,{onUpsellClick:ue}):null;(0,g().HB)(_)}}function ae(e){const{botId:t,automationPermissionScope:o,onDelete:n,automationStore:i}=e,r=(0,d().tz)(),l=se(),s=(0,a().K8)((()=>{const e=Q().vK.createChildStore(i,{id:t,spaceId:i.getSpaceId(),table:R().GP}).getCreatedByStore();return e?e.getDisplayName(r):r.formatMessage(_().Fvx.messages.anonymousPlaceholder)}),[i,t,r]);return(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{..."readonly"===o?oe.automationExternalBotNoPermissions:oe.automationExternalBotWithPermissions,values:{"anchor-delete":e=>(0,te.jsx)(U().A,{onClick:n,style:l.link,children:e}),user:s}})})}function re(e){const{children:t,icon:o}=e,n=se();return(0,te.jsx)("div",{style:n.wrapWrap,children:(0,te.jsxs)("div",{style:n.upsellWrap,children:[o&&(0,te.jsx)("div",{style:n.iconWrap,children:o}),(0,te.jsx)("div",{style:n.messageWrap,children:t})]})})}function le(e){const{children:t,icon:o}=e,n=se();return(0,te.jsx)("div",{style:n.wrapWrap,children:(0,te.jsxs)("div",{style:n.trashPageWrap,children:[o&&(0,te.jsx)("div",{style:n.iconWrap,children:o}),(0,te.jsx)("div",{style:n.messageWrap,children:t})]})})}function se(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({boltIcon:{fill:t.icon.yellowPrimary,height:"100%",width:"100%"},boltIconWrap:{height:20,padding:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},link:{color:t.text.uiBluePrimary},messageWrap:{flexGrow:1},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},restoreButton:{fontSize:e?14:12,fontWeight:y().Wy.medium,marginLeft:-8},warningIcon:{color:t.accentColors.orange[400],height:"100%",width:"100%"},warningIconWrap:{height:20,padding:2,width:20},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"},upsellWrap:{alignItems:"center",background:t.accentColors.yellow[50],border:`1px solid ${t.accentColors.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:t.accentColors.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:t.mediumIconColor,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[e])}var ce=()=>o(738355),ue=()=>o(431551),de=()=>o(103151),pe=()=>o(622163);const me=(0,d().YK)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"},automationErrorsDisabledTooltip:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"collectionSettings.editAutomationView.automationErrorsDisabledTooltip"}});function ge(e){const{automationId:t,automationOwner:o,disabled:a,isAutomationPaused:l,onPause:s,onResume:c}=e,{cantSaveDueToError:u}=(0,ce().b)(),{isMobile:p}=(0,i().Y0)(),m=`toggle-${t}`,g=(0,n.useCallback)((()=>{l?null==c||c():null==s||s()}),[l,c,s]),h=(0,r().IS)((e=>({labelWrap:{color:a?e.text.tertiary:e.text.secondary,flex:"1 1 auto",fontSize:p?y().J.UIRegular.mobile:y().J.UIRegular.desktop},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:0},toggleWrap:{flex:"0 0 auto",paddingBlockStart:p?5:2}})),[a,p]),f=me.automationEnabledLabel,v=l?me.automationPausedHiddenAriaLabel:me.automationEnabledHiddenAriaLabel;return(0,te.jsxs)("section",{style:h.sectionWrap,children:[(0,te.jsx)("div",{style:h.toggleWrap,children:(0,te.jsx)(de().A,{disableTooltip:!a||!l,renderTooltip:()=>u?(0,te.jsx)(d().sA,{...me.automationErrorsDisabledTooltip}):(0,te.jsx)(d().sA,{...me.automationDisabledTooltip,values:{user:o}}),render:e=>(0,te.jsx)("div",{...e,children:(0,te.jsx)(ue().A,{disabled:a,inputId:m,on:!l,onClick:g})})})}),(0,te.jsx)("div",{style:h.labelWrap,children:(0,te.jsxs)("label",{htmlFor:m,children:[(0,te.jsx)("span",{"aria-hidden":!0,children:(0,te.jsx)(d().sA,{...f})}),(0,te.jsx)("span",{style:pe().Qg,children:(0,te.jsx)(d().sA,{...v})})]})})]})}var ye=()=>o(836331);var he=()=>o(495312);function fe(e){const{shouldInvokeHandler:t,isMobile:o,onClick:i}=e;(0,n.useEffect)((()=>{async function e(e){const o=e.target instanceof Element&&((0,he().pM)(e.target)||(0,he().m5)(e.target));e.eventPhase===Event.CAPTURING_PHASE&&t&&o&&(e.stopPropagation(),e.preventDefault(),await i())}if(!o)return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o,i])}var ve=()=>o(950808),xe=()=>o(137696),be=()=>o(754697),Se=()=>o(303862),Ce=()=>o(155352),Ae=()=>o(836471),ke=()=>o(569379),Me=()=>o(748039),je=()=>o(113800),Te=()=>o(239296);var Ie=()=>o(713995);function we(){const{automationStore:e}=(0,ce().k)();return(0,a().K8)((()=>function(e){var t;const o=(null===(t=e.getTrigger())||void 0===t?void 0:t.type)??"event";return"event"===o||"recurrence"!==o&&void(0,g().HB)(o)}(e)),[e])}var _e=()=>o(84543),Pe=()=>o(59175),Be=()=>o(401382);const Re=(0,d().YK)({loadingPlaceholder:{defaultMessage:"Loading...",id:"AutomationNameInput.loadingPlaceholder"},placeholder:{defaultMessage:"Automation name",id:"AutomationNameInput.placeholder"}});const Ve=(0,n.forwardRef)((function(e,t){const{disabled:l,focusInitial:s,placeholder:c,...u}=e,{automationStore:p}=(0,W().EC)(),{maybePersistedTransactionActions:m}=(0,ce().b)(),g=function(e){const{isMobile:t}=(0,i().Y0)(),{disabled:o}=e;return(0,r().IS)((e=>({automationNameInput:{marginBlockEnd:0,paddingInline:0},automationNameText:{color:o?e.text.tertiary:e.text.primary,marginInlineStart:t?12:0,marginInlineEnd:t?12:18,fontWeight:y().Wy.medium,padding:0},input:{background:"transparent",boxShadow:"unset",fontWeight:y().Wy.medium,padding:0}})),[t,o])}({disabled:l}),{isMobile:h}=(0,i().Y0)(),f=(0,d().tz)(),v=(0,a().K8)((()=>(null==p?void 0:p.getName())??""),[p]),x=c||f.formatMessage(Re.placeholder),b=(0,n.useCallback)((e=>{m.createAndCommit({userAction:"Automation.updateName",perform:t=>{_e().applyOperation({store:p,operation:{path:["properties"],pointer:p.pointer,command:"update",args:{name:e}},transaction:t})}})}),[p,m]),S=(0,n.useCallback)((e=>{const t=e.currentTarget.value;b(t)}),[b]),C=(0,n.useCallback)((e=>{e.currentTarget.value||b(x)}),[b,x]);return(0,o(269280).w)((()=>{h&&!v&&b(x)})),(0,te.jsx)(Be().Ay,{...u,disabled:l,focusInitial:s,format:Pe().C.ExtraLarge,inputOuterStyle:g.input,inputStyle:{paddingInline:0},onBlur:C,onChange:S,placeholder:x,ref:t,style:g.automationNameInput,textWrapperStyle:g.automationNameText,value:v??f.formatMessage(Re.loadingPlaceholder)})}));var Ee=()=>o(713921),De=()=>o(198654),Fe=()=>o(289765),Oe=()=>o(273520),Ne=()=>o(179701),Le=(o(403517),o(244387),()=>o(15552)),We=()=>o(611506),ze=()=>o(511441),Ke=()=>o(559181),He=()=>o(314164),Ue=()=>o(725460),Ye=()=>o(535906),Ge=()=>o(935091),qe=()=>o(743668),Xe=()=>o(28210),$e=()=>o(206183),Je=()=>o(640979),Qe=()=>o(92451),Ze=()=>o(907721);const et=(0,d().YK)({forPagesIn:{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}});function tt(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:r,onClose:l}=e,{isMobile:s}=(0,i().Y0)(),c=(0,d().tz)(),u=(0,i().v3)(),[m,y]=n.useState(""),h=(0,a().K8)((()=>o.collectionStore()),[o]),f=(0,a().K8)((()=>o.collectionViewBlockStore()),[o]),v=(0,a().K8)((()=>f&&h?f.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===h.id})):[]),[f,h]),x=(0,a().K8)((()=>{if(!h)return[];let e;t&&"collection_view"===t.table&&(e=Q().pS.createChildStore(h,t));return p().hS([...v,e].filter(g().O9),(e=>{let{id:t}=e;return t})).filter((e=>(0,He().As)(e,m)))}),[h,v,m,t]),b=(0,a().K8)((()=>{if(h&&(0,$e().zY)({collectionStore:h,environment:u,intl:c,queryForFilter:m}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:a,intl:r}=e,l=t.getIcon(),s=(0,Qe().tS)({environment:o,intl:r,store:t}),c=n&&"collection"===n.table&&n.id===t.id,u=t.getSpaceShardedPointer(),p={key:t.id,action:()=>{u&&i(u)},render:e=>(0,te.jsx)(Ye().A,{...e,icon:l&&(0,te.jsx)(Xe().B,{isEmptyPage:!1,size:a?18:16,disabled:!0,icon:l}),title:s,caption:(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collection.caption",defaultMessage:"Entire database",values:{collectionName:s}}),right:c&&(0,We().p)({width:16,height:"auto"})})};return{key:"collection",items:[p],render:e=>(0,te.jsx)(k().A,{...e})}}({collectionStore:h,environment:u,selectedSourcePointer:t,onSelect:r,isMobile:s,intl:c})}),[h,u,c,s,r,m,t]),C=(0,a().K8)((()=>h&&f&&v?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:a,intl:r}=e,l=n.getSchema(),s=o.map((e=>{if("form_editor"===e.getType()||"chart"===e.getType())return;const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const s=i&&"collection_view"===i.table&&i.id===o.id,c=(0,ve().RN)({collectionViewStore:e,collectionSchema:l}),u=(0,ve().EN)({collectionViewStore:e,collectionSchema:l}),p=(0,g().O9)(c)||(0,g().O9)(u),m=e.getType(),y=e.getFormat().collection_view_icon,h=e.getName(),f=(o,n)=>(0,te.jsx)(Ye().A,{...o,...n,icon:(0,te.jsx)(ze().h,{color:"lightGray",viewType:m,viewIcon:y}),title:(0,te.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,te.jsx)(Ke().A,{collectionViewType:m,collectionViewName:h}),p&&s&&(0,w().Q)({width:16,height:"auto"})]}),caption:(0,te.jsx)(ot,{blockStore:t,collectionViewStore:e,intl:r,collectionSchema:l,referencesIncompatibleProperties:p}),right:s&&(0,We().p)({width:16,height:"auto"}),disabled:p,disabledFeedback:p});let v;if(p&&c){var n;const e=null===(n=l[c])||void 0===n?void 0:n.type,t=e?$e().dC[e]:void 0,o=t?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});v=e=>(0,te.jsx)(de().A,{placement:Ze().W.Right,renderTooltip:()=>o,render:t=>f(e,t)})}else if((0,g().O9)(u)){const e=(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.crossSpace",defaultMessage:"Cross work-space properties are not supported"});v=t=>(0,te.jsx)(de().A,{placement:Ze().W.Right,renderTooltip:()=>e,render:e=>f(t,e)})}else v=f;return{key:e.id,action:()=>{a(o)},render:v}}}));return[...s].filter(g().O9)}({blockStore:f,collectionStore:h,filteredCollectionViewStores:x,selectedSourcePointer:t,onSelect:r,intl:c}):[]),[f,h,v,x,c,r,t]),A=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,te.jsx)(k().A,{...e,topBorder:!0})}}({menuListItems:C}),M={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,te.jsx)(Be().Ay,{value:m,focus:!0,onChange:e=>y(e.target.value),placeholder:c.formatMessage({defaultMessage:"Search views...",id:"collectionViewSelect.viewSearch.placeholder"})})}],render:e=>(0,te.jsx)(k().A,{isInput:!0,...e})};let j;(0,g().O9)(b)||(0,g().O9)(A)||(j={key:"no-results-section",items:[{key:"no-results-item",action:p().lQ,render:()=>(0,te.jsx)(Ue().A,{caption:(0,te.jsx)(d().sA,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,te.jsx)(k().A,{...e,topBorder:!0})});const T=[M,b,A,j].filter(g().O9);if(!h)return null;let I;return I=s?{menuType:Je().gu.Modal,title:(0,te.jsx)("div",{style:{display:"flex"},children:(0,te.jsx)(d().sA,{...et.forPagesIn})}),right:(0,te.jsx)(qe().DoneMenuText,{}),onClickRight:()=>{l()}}:{menuType:Je().gu.Popup,width:230,maxHeight:"50vh"},(0,te.jsx)(Ge().A,{...I,children:(0,te.jsx)(S().Ay,{type:S().Oh.Vertical,sections:T,initialFocus:0,onAccept:()=>{l()}})})}function ot(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:r,referencesIncompatibleProperties:l}=e,s=(0,i().v3)(),c=(0,a().K8)((()=>!o.getAlive()),[o]),u=(0,a().K8)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,Qe().tS)({environment:s,intl:n,store:e}):void 0}),[t.id,o,n,s]),p=(0,a().K8)((()=>{const e=o.getQuery(r);return(0,Le().rg)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:r}).reduce(((e,t)=>{if((0,Le().yX)(t))return e+1;return e+(t.filters??[]).length}),0)}),[r,o]);return l?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,te.jsx)("em",{children:e})}}):u?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,te.jsx)("em",{children:e}),externalParentBlockName:u}}):0===p?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:p}})}function nt(e){const{pointer:t,collectionStore:o,intl:n}=e,l=(0,i().v3)(),s=(0,r().IS)((e=>({warningIcon:{width:16,height:"auto",color:e.accentColors.orange[400]},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...y().RC},errorText:{color:e.errorText,fontWeight:y().Wy.medium}})),[]),c=(0,a().K8)((()=>t?Q().sk.createChildStore(o,t):void 0),[o,t]),u=(0,a().K8)((()=>c?(0,Qe().tS)({environment:l,intl:n,store:c}):(0,te.jsx)("span",{style:s.errorText,children:(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.source.missing",defaultMessage:"Select database"})})),[l,n,s.errorText,c]),p=(0,a().K8)((()=>{if(!c||c.table===V().Vl)return!1;const e=o.getSchema();return(0,g().O9)((0,ve().RN)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,te.jsxs)("div",{style:s.titleContainer,children:[p&&(0,w().Q)(s.warningIcon),(0,te.jsx)("span",{style:s.title,children:u})]})}function it(e){const{collectionContextStore:t,disabled:o}=e,{isMobile:l}=(0,i().Y0)(),s=(0,d().tz)(),c=(0,r().IS)((e=>{const t=o?e.text.tertiary:e.text.secondary,n=l?y().J.UIRegular.mobile:y().J.UIRegular.desktop;return{wrap:{alignItems:"center",color:t,cursor:"default",display:"grid",fontSize:n,gridTemplateColumns:"auto auto"},button:{color:t,fontWeight:y().Wy.medium,fontSize:n,width:"100%",height:24,paddingLeft:6,paddingRight:6,marginLeft:1},icon:{width:10,marginLeft:4,fill:t}}}),[l,o]),{automationStore:u}=(0,W().EC)(),{maybePersistedTransactionActions:p}=(0,ce().b)(),m=(0,a().K8)((()=>t.collectionStore()),[t]),g=(0,a().K8)((()=>{const e=null==u?void 0:u.getTrigger();if("event"===(null==e?void 0:e.type)){const t=e.event.source;if(t&&"filter"!==t.type)return t.pointer}}),[u]),h=(0,n.useCallback)((e=>{const t=e.table===V().Vl?{pointer:e,type:V().Vl}:{pointer:e,type:Fe().Gy};p.createAndCommit({userAction:"Automation.updateSource",perform:e=>{_e().applyOperation({store:u,operation:{path:["trigger","event"],pointer:u.pointer,command:"update",args:{source:t}},transaction:e})}})}),[u,p]),f=(0,Ne().j)(),v=m?(0,te.jsx)(nt,{pointer:g,collectionStore:m,intl:s}):(0,te.jsx)(n.Fragment,{}),x=(0,te.jsx)(Oe().Ay,{alignmentToOrigin:Oe().yP.Start,placementToOrigin:Oe().sx.Bottom,popupType:f,render:e=>(0,te.jsx)(tt,{selectedSourcePointer:g,onSelect:h,onClose:()=>{e.close()},collectionContextStore:t}),renderOrigin:e=>(0,te.jsxs)(H().p,{...e,style:c.button,disabled:o,children:[v,(0,De().b)(c.icon)]})});return(0,te.jsx)("div",{style:c.wrap,children:(0,te.jsx)(d().sA,{id:"automationBuilderModal.SourceInput.appliesTo",defaultMessage:"For all pages in {button}",values:{button:x}})})}function at(){const e=(0,i().v3)(),t=(0,d().tz)(),{isMobile:o}=(0,i().Y0)(),n=(0,r().IS)((e=>{const t=o?y().J.UIRegular.mobile:y().J.UIRegular.desktop;return{wrap:{color:e.text.secondary,fontSize:t},title:{color:e.text.secondary,fontWeight:y().Wy.medium,fontSize:t}}}),[o]),{collectionStore:l}=(0,ce().k)(),s=(0,a().K8)((()=>(0,Qe().tS)({environment:e,intl:t,store:l})),[l,e,t]),c=(0,te.jsx)("span",{style:n.title,children:s});return(0,te.jsx)("div",{style:n.wrap,children:(0,te.jsx)(d().sA,{id:"automationBuilderModal.SourceLabel.appliesTo",defaultMessage:"For {source}",values:{source:c}})})}let rt;(0,o(996094).exposeDebugGetter)("currentAutomation",(()=>rt));const lt=(0,d().YK)({deleteButton:{id:"automationBuilderModal.editAutomationView.deleteButton",defaultMessage:"Delete"},createButton:{id:"automationBuilderModal.editAutomationView.createButton.label",defaultMessage:"Create"},saveButton:{id:"automationBuilderModal.editAutomationView.saveButton.label",defaultMessage:"Save"},cancelButton:{id:"automationBuilderModal.editAutomationView.cancelButton.label",defaultMessage:"Cancel"},doneButton:{id:"automationBuilderModal.editAutomationView.doneButton.label",defaultMessage:"Done"},enableButton:{id:"automationBuilderModal.editAutomationView.enableButton.label",defaultMessage:"Enable"},errorsFooterCaption:{id:"automationBuilderModal.editAutomationView.errorCaption",defaultMessage:"Fix errors to enable"}});function st(){}function ct(e){const{collectionSettingsStore:t,collectionContextStore:o,source:j,...T}=e,[I]=(0,n.useState)((()=>T)),{mode:w}=I,_=(0,d().tz)(),P=(0,i().v3)(),{isMobile:B}=(0,i().Y0)(),{value:R}=(0,$().fJ)(Y().T.formulas),{value:V}=(0,$().fJ)(v().QV.automationTypecheck),[E,D]=(0,n.useState)([]),O="create"===w,N=(0,Se().l)("BuilderModal",{cacheFallback:P.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),L=(0,a().K8)((()=>J().default.state.currentUserStore),[]),z=(0,a().K8)((()=>null==L?void 0:L.userId),[L]),H=(0,a().K8)((()=>null==L?void 0:L.getDisplayName(_)),[L,_]),U=(0,a().K8)((()=>o.collectionStore()),[o]),q=(0,a().K8)((()=>null==U?void 0:U.getSpaceId()),[U]),X=(0,a().K8)((()=>null==U?void 0:U.id),[U]),Z=(0,n.useMemo)((()=>"update"===I.mode?I.automationId:(0,be().Z1)({environment:P,table:u().yB,spaceId:q})),[I,P,q]),ee=(0,a().O$)(o.aliveAutomationCountStore),oe=(0,a().K8)((()=>{if(q&&U&&z)return new(Q().dn)(P,{id:Z,table:u().yB,spaceId:q})}),[Z,U,z,P,q]);!function(e){(0,n.useEffect)((()=>(rt=e,()=>{rt=void 0})),[e])}(oe);const ne=(0,a().K8)((()=>(0,s().PK)(_,H)),[H,_]),ae=(0,a().K8)((()=>{if(!q||!U||!z)return;const e={id:Z,table:u().yB,spaceId:q},t=N.getEntry({pointer:e,userId:z});return t?t.value.value:ve().EZ({automationId:Z,automationName:"",collectionStore:U,userId:z})}),[Z,U,z,q,N]),{maybePersistedAutomationStore:re,maybePersistedTransactionActions:le,hasUnpersistedChanges:se}=(0,Ie().t)({automationId:Z,spaceId:q,defaultValue:O?ae:void 0,persist:!1}),ce=(0,a().K8)((()=>{if(re&&(0,xe().$X)(re))return re}),[re]),ue=(0,a().K8)((()=>((null==ce?void 0:ce.getActionStores())??[]).filter((e=>e.isDefined()))),[ce]),de=(0,a().K8)((()=>(0,xe().H8)((null==ce?void 0:ce.getTriggerType())??"event")),[ce]),pe=(0,a().K8)((()=>{const e=null==U?void 0:U.getParentBlockStore();return!!e&&e.pathIsDead()}),[U]),me=function(e){const{actionStores:t,automationStore:o,collectionStore:n,loadingStatus:i,mode:r}=e;return(0,a().K8)((()=>"create"===r?"edit":"resolved"===i&&o&&t&&n?(0,ve().TT)({automationStore:o,actionStores:t,collectionStore:n})?"edit":(0,ve().Gz)({automationStore:o,collectionStore:n})?"readonly_with_delete":"readonly":"readonly"),[r,i,o,t,n])}({automationStore:ce,actionStores:ue,collectionStore:U,loadingStatus:"resolved",mode:I.mode}),ge=("readonly_with_delete"===me||"edit"===me&&!O)&&!pe,he=(0,K().n)(ce),Me=(0,a().K8)((()=>!(!ce||!U)&&ve().l({automationStore:ce,collectionStore:U})),[ce,U]),we=(0,a().K8)((()=>ce&&R&&V?(0,je().Z)({environment:P,automationStore:ce,automationTypecheckModule:V,contextType:de,formulasModule:R,intl:_,isSubscribed:he}):void 0),[ce,R,V,P,de,_,he]),_e=(0,a().K8)((()=>!!(U&&ce&&we)&&ve().Qn({automationStore:ce,collectionStore:U,typecheckResult:we})),[ce,U,we]),Pe=(0,a().K8)((()=>!!we&&(0,ke().h)({environment:P,typecheckResult:we,automationStore:ce})),[ce,P,we]),Be=(0,a().K8)((()=>oe&&R&&V?(0,je().Z)({environment:P,automationStore:oe,automationTypecheckModule:V,contextType:de,formulasModule:R,intl:_,isSubscribed:he}):void 0),[P,oe,de,R,V,_,he]),Re=(0,a().K8)((()=>!!(U&&oe&&Be)&&ve().Qn({automationStore:oe,collectionStore:U,typecheckResult:Be})),[U,oe,Be]),De=(0,a().K8)((()=>{if(!ce)return!0;let e;var t;ce.isTriggerType("event")&&(e=null===(t=ce.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited.type);const o=(0,g().O9)(e)&&"none"!==e,n=ce.getActionStores().length>0;if(!n&&!o)return!1;const i=!(0,l().aE)({automationTrigger:ce.getTrigger(),collectionSchema:null==U?void 0:U.getSchema()});if(o&&i)return!0;if(n&&(0,g().O9)(we)&&m().Q.isSuccess(we)){if(Object.keys(we.value.actionValidationFailures).some((e=>!E.includes(e))))return!0}return!1}),[ce,U,E,we]);!function(e){const{automationStore:t,collectionStoreId:o,source:r}=e,l=(0,i().v3)(),[s,c]=(0,n.useState)(!1),u=(0,a().K8)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),d=(0,a().K8)((()=>{if(!t||!t.isTriggerType("event"))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();if("any"===(null==n?void 0:n.type))o++;else if("some"===(null==n?void 0:n.type)){var i;o+=(null===(i=n.some)||void 0===i?void 0:i.length)??0}else if("all"===(null==n?void 0:n.type)){var a;o+=(null===(a=n.all)||void 0===a?void 0:a.length)??0}return o}),[t]);(0,n.useEffect)((()=>{o&&!s&&t&&((0,G().u4)({environment:l,event:{eventName:"automation_configure_view",eventProperties:{automation_id:t.id,automation_total_actions:u,automation_total_triggers:d,collection_id:o,source:r}}}),ye().default.logEvent("automation_configure_view","true"),c(!0))}),[l,o,s,u,d,null==t?void 0:t.id,t,r])}({automationStore:ce,collectionStoreId:X,source:e.source});const Fe="edit"===me&&!pe&&!Pe,Oe=(0,n.useCallback)((()=>{D([])}),[]),Ne=(0,n.useCallback)((()=>{U&&ce&&se&&("create"===w?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:a,from:r}=e;M().nO({automationStore:t,collectionStore:n,environment:i,intl:a,from:r,builderType:"modal"}),f().D6({label:(0,te.jsx)(d().sA,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),F().V({environment:i,collectionSettingsStore:o});const l=(0,Ce().S)(o);l&&"automationSettings"!==l.type&&h().a2({collectionSettingsStore:o,item:{type:"automationSettings",source:"first_automation_created"}})}({automationStore:ce,collectionSettingsStore:t,collectionStore:U,environment:P,intl:_,from:I.from}):"update"===w?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,source:a}=e;M().kU({automationStore:t,collectionStore:n,environment:i,builderType:"modal",source:a}),f().D6({label:(0,te.jsx)(d().sA,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),F().V({environment:i,collectionSettingsStore:o})}({automationStore:ce,collectionSettingsStore:t,collectionStore:U,environment:P,source:j}):(0,g().HB)(w))}),[ce,t,U,P,se,_,w,I,j]),Le=(0,n.useCallback)((async()=>{ce&&U&&!O&&await M().lg({intl:_,environment:P,existingAutomationStore:ce,collectionStore:U,onDelete:()=>{var e;F().V({environment:P,collectionSettingsStore:t}),1===ee&&"automationSettings"===(null===(e=(0,Ce().S)(t))||void 0===e?void 0:e.type)&&h().R8({collectionSettingsStore:t,item:{type:"main"}})}})}),[ee,ce,t,U,P,_,O]),We=(0,n.useCallback)((async()=>{if(se){await M().lT({hasPendingChanges:se})&&F().V({environment:P,collectionSettingsStore:t})}else F().V({environment:P,collectionSettingsStore:t})}),[t,P,se]);fe({shouldInvokeHandler:!0,onClick:We,isMobile:B});const ze=(0,n.useCallback)((e=>{D([e.id])}),[]),Ke=(0,Te().c)(),He=function(){const{isMobile:e}=(0,i().Y0)(),t=mt();return(0,r().IS)((o=>({header:{backgroundColor:o.surface.elevated,zIndex:100,width:"100%",...e?{paddingBottom:0,paddingTop:0}:{paddingBottom:8,borderBottom:`1px solid ${o.stroke.secondary}`}},nameInput:{...e&&{paddingTop:8}},buttons:{backgroundColor:o.surface.elevated,display:"flex",flexDirection:"row",paddingBottom:e?16:4,paddingTop:12,justifyContent:"space-between",gap:e?"10px":0,width:"100%",zIndex:100,...e&&{paddingLeft:ut,paddingRight:ut,flexDirection:"column-reverse"}},footerButton:{height:32,width:e?"100%":"auto",pointerEvents:"auto"},footerErrorCaption:{color:o.text.tertiary,fontSize:y().J.UISmall.desktop},footerRight:{alignItems:"center",display:"flex",gap:14,justifyContent:"space-between"},automationOptionIconDesktop:{marginInlineStart:12},wrap:{marginTop:e?16:17,marginBottom:e?20:0,paddingBottom:16,width:"100%",flexGrow:1,overflowY:"auto"},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:o.tint.regular,width:24,height:24},closeButtonHover:{background:o.buttonPressedBackground},closeButtonIcon:{width:14,fill:o.icon.secondary},...t})),[e,t])}(),Ue=[],Ye=se&&_e;Fe&&!B&&Ue.push((0,te.jsxs)(k().A,{style:He.buttons,mobileStyle:He.buttons,children:[(0,te.jsx)(C().A,{size:"lg",onClick:We,style:He.footerButton,children:(0,te.jsx)(d().sA,{...lt.cancelButton})}),(0,te.jsxs)("div",{style:He.footerRight,children:[!Ye&&De&&(0,te.jsx)("div",{style:He.footerErrorCaption,children:(0,te.jsx)(d().sA,{...lt.errorsFooterCaption})}),(0,te.jsx)(A().A,{onClick:Ne,onMouseEnter:Oe,disabled:!Ye,style:He.footerButton,children:O?(0,te.jsx)(d().sA,{...lt.enableButton}):(0,te.jsx)(d().sA,{...lt.doneButton})})]})]},"save"));const Ge=(0,a().K8)((()=>{if(!U||!ce)return null;const e=!B&&Fe&&"create"===w;return(0,te.jsx)(W().or,{automationStore:ce,children:(0,te.jsxs)(Ae().v,{value:{collectionStore:U,disabled:!Fe,editorPlacement:{type:"inline"},editorWidth:x().vE,maybePersistedTransactionActions:le,onActionAdded:ze,suppressActionErrors:E,hideDragHandle:Pe,cantSaveDueToError:De,...Ke},defaultCollapseActions:Pe,children:[!B&&(0,te.jsx)("div",{style:He.closeButtonContainer,children:(0,te.jsx)(b().A,{onClick:We,style:He.closeButton,hoveredStyle:He.closeButtonHover,children:(0,c().V)(He.closeButtonIcon)})}),(0,te.jsx)("div",{style:He.header,children:(0,te.jsx)(S().Ay,{type:S().Oh.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:(0,p().oE)([{key:"automation_name",action:()=>{},render:t=>(0,te.jsx)("div",{...t,style:He.nameInput,children:(0,te.jsx)(Ve,{...t,disabled:!Fe,focusInitial:e,placeholder:ne})})},dt({showActiveAutomationToggle:ge,isPersistedStateComplete:Re,collectionContextStore:o,canEdit:Fe,automationStore:ce})]),render:e=>(0,te.jsx)(k().A,{...e,disableMobilePadding:!0,desktopStyle:{paddingTop:0,paddingBottom:0}})}]})}),(0,te.jsxs)("div",{style:He.wrap,children:[(0,te.jsx)(ie,{collectionStore:U,collectionSettingsStore:t,automationPermissionScope:me,referencesIncompatibleCollectionViewFilter:Me,requiresSubscriptionUpgrade:Pe,onDelete:Le}),(0,te.jsx)(v().U3,{areActionsEditable:Fe,areTriggersEditable:Fe})]})]})})}),[U,ce,Fe,le,ze,E,Pe,Ke,B,He,We,ge,Re,o,De,t,me,Me,Le,w,ne]);return(0,te.jsxs)(Ee().i,{handleOnDismiss:We,handleOnSave:Ne,canSave:Ye,mode:w,children:[Ge,Ue]})}const ut=16;function dt(e){const{showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i}=e;return{key:"automation_toggle_and_source",action:st,render:e=>(0,te.jsx)(pt,{menuListItemProps:e,showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i})}}function pt(e){const{menuListItemProps:t,showActiveAutomationToggle:o,isPersistedStateComplete:l,collectionContextStore:s,canEdit:c}=e,u=(0,d().tz)(),{isMobile:p}=(0,i().Y0)(),m=(0,i().v3)(),g=mt(),y=(0,r().IS)((e=>({wrap:{display:"flex",...p?{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",paddingInline:12,borderBottom:`1px solid ${e.stroke.primary}`,paddingBlock:12,gap:12}:{gap:8,minHeight:24,alignItems:"center"}},toggle:{display:"flex",alignItems:"center",marginLeft:1},...g})),[p,g]),{automationStore:h}=(0,W().EC)(),f=(0,a().K8)((()=>{var e;return(null==h||null===(e=h.getOwnerStore())||void 0===e?void 0:e.getDisplayName(u))??""}),[u,h]),v="active"===(0,a().K8)((()=>(null==h?void 0:h.getStatus())??"disabled"),[h]),x=we(),b=(0,n.useCallback)((()=>{h&&M().WA({automationStore:h,environment:m})}),[m,h]),S=(0,n.useCallback)((()=>{h&&M().HJ({automationStore:h,environment:m})}),[m,h]),C=(0,a().K8)((()=>!l||(0,Me().NH)(h)),[h,l]);return(0,te.jsxs)("div",{...t,style:y.wrap,children:[(l||!v)&&o&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{style:y.toggle,children:(0,te.jsx)(ge,{automationId:h.id,automationOwner:f,isAutomationPaused:!v,onPause:b,onResume:S,disabled:C})}),(0,te.jsx)("div",{style:y.verticalDivider})]}),x?(0,te.jsx)(it,{disabled:!c,collectionContextStore:s}):(0,te.jsx)(at,{})]})}function mt(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({verticalDivider:{background:t.stroke.secondary,height:16,width:1,borderRadius:1,display:e?"none":"block"}})),[e])}var gt=()=>o(759625),yt=()=>o(90957),ht=()=>o(750616);const ft=(0,d().YK)({placeholder:{id:"automations.builderModal.buttonBuilderLabelInput.placeholder",defaultMessage:"Enter a name"},loading:{id:"automations.builderModal.buttonBuilderLabelInput.loading",defaultMessage:"Loading..."}}),vt=(0,n.forwardRef)((function(e,t){let{disabled:o,buttonName:a,handleNameChange:l,handleBlur:s,handleSubmit:c,...u}=e;const p=(0,d().tz)(),{isMobile:m}=(0,i().Y0)(),g=(0,r().IS)((e=>({buttonNamePropertyInput:{marginBlockEnd:0,boxShadow:"none"},buttonNameText:{marginInlineStart:m?12:0,marginInlineEnd:m?12:18},inputOuterStyle:{background:"transparent",boxShadow:"unset"}})),[m]),y=(0,n.useCallback)((e=>{l(e)}),[l]),h=(0,n.useCallback)((e=>{s(e.target.value)}),[s]),f=(0,n.useCallback)((()=>{c(a)}),[c,a]);return(0,te.jsx)(Be().Ay,{style:g.buttonNamePropertyInput,...u,value:a??p.formatMessage(ft.loading),onChange:y,disabled:o,ref:t,inputOuterStyle:g.inputOuterStyle,format:Pe().C.ExtraLarge,textWrapperStyle:g.buttonNameText,placeholder:p.formatMessage(ft.placeholder),onBlur:h,onSubmit:f,autoFocus:!a})}));var xt=()=>o(463013);const bt=(0,d().YK)({saveButton:{defaultMessage:"Save",id:"database.buttonProperty.saveButtonLabel"},noEditError:{defaultMessage:"You don't have full access to edit this button",id:"database.buttonProperty.noEditError"}});function St(e){const{collectionContextStore:t,propertySchema:o}=e,i=(0,a().K8)((()=>t.collectionStore()),[t]),r=(0,a().K8)((()=>null==i?void 0:i.getSpaceId()),[i]),l=(0,n.useMemo)((()=>{const e=o.automation_id;if(e&&r)return{id:e,spaceId:r,table:u().yB}}),[o.automation_id,r]);return(0,ht().K)(i,l)?(0,te.jsx)(Ct,{...e}):(0,te.jsx)(xt().A,{})}function Ct(e){const{collectionContextStore:t,collectionSettingsStore:o,propertyId:l,propertySchema:s}=e,{isMobile:u}=(0,i().Y0)(),p=(0,i().v3)(),[m,g]=(0,n.useState)([]),y=(0,a().K8)((()=>t.collectionStore()),[t]),h=(0,a().K8)((()=>null==y?void 0:y.getSpaceId()),[y]),{maybePersistedAutomationStore:f,maybePersistedTransactionActions:C}=(0,Ie().t)({automationId:s.automation_id,spaceId:h,defaultValue:void 0,persist:!0}),M=(0,a().K8)((()=>null==f?void 0:f.getTrigger()),[f]),j=(0,yt().Qj)({automationStore:f,propertyId:l,propertySchema:s,collectionContextStore:t}),T=(0,a().K8)((()=>{var e;return"sufficient"===(null==j||null===(e=j.state)||void 0===e?void 0:e.editPermissionStatus)}),[j]),I=(0,a().K8)((()=>{var e;return!(null==j||null===(e=j.state)||void 0===e||!e.typecheckResult)&&(0,ke().h)({environment:p,typecheckResult:j.state.typecheckResult,automationStore:f})}),[j,p,f]),w=(0,a().K8)((()=>(null==f?void 0:f.getNameStore().getValue())??s.name),[f,s.name]),_=(0,a().K8)((()=>"collectionTypedView"===t.contextType),[t]),P=(0,n.useCallback)((e=>{if(!f)return;const t=e.currentTarget.value;C.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:e=>{gt().KY({store:f.getNameStore(),transaction:e,value:t})}})}),[f,C]),B=(0,n.useCallback)((e=>{g((t=>[...t,e.id]))}),[]),R=(0,Te().c)(),V=function(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({header:{backgroundColor:"transparent",borderBottom:`1px solid ${t.stroke.secondary}`,paddingBottom:8,paddingTop:It,position:"absolute",top:0,width:`calc(100% - ${2*Tt}px)`,zIndex:100,...e&&{paddingBottom:0,paddingTop:0,width:"100%"}},buttons:{backgroundColor:"dark"===t.mode?t.accentColors.gray[100]:t.white,display:"flex",gap:4,paddingBlock:`${It}px ${Tt}px`,position:"absolute",bottom:0,width:`calc(100% - ${2*Tt}px)`,zIndex:100,...e&&{paddingLeft:Tt,paddingRight:Tt,flexDirection:"column-reverse",width:"100%"}},label:{paddingTop:e?"10px":0},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:t.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:t.buttonPressedBackground},closeButtonIcon:{width:16,fill:t.text.secondary},wrap:{overflowY:"auto",overflowX:"hidden",marginTop:e?Mt:At,marginBottom:e?jt:kt,paddingInline:e?0:2,width:"100%"},desktopButtonLabelNameContainer:{paddingLeft:0,paddingRight:0,color:t.text.tertiary},mobileButtonLabelNameContainer:{paddingTop:It,paddingBottom:4,paddingLeft:Tt,paddingRight:Tt,color:t.text.tertiary},buttonLabelNameTextWrapperStyle:{marginLeft:e?Tt:0,marginRight:e?Tt:0},footerButton:{height:32,width:"100%"},inputStyle:{background:"transparent"},inputOuterStyle:{background:"transparent"}})),[e])}(),E=(0,n.useCallback)((()=>{F().V({environment:p,collectionSettingsStore:o})}),[p,o]),D=(0,n.useCallback)((()=>{Z().K(p,{from:"button_property_automation_header_message",upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}})}),[p]);fe({shouldInvokeHandler:!0,onClick:E,isMobile:u});const N=(0,n.useCallback)((e=>{f&&C.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:t=>{gt().KY({store:f.getNameStore(),transaction:t,value:e})}})}),[f,C]),z=(0,n.useMemo)((()=>y&&f&&M&&"button"===M.type?(0,te.jsx)(W().u,{automationStore:f,contextType:"button_property",children:(0,te.jsxs)(Ae().v,{value:{collectionStore:y,disabled:!T,editorPlacement:{type:"inline"},editorWidth:x().vE,maybePersistedTransactionActions:C,onActionAdded:B,suppressActionErrors:m,hideDragHandle:I,...R},defaultCollapseActions:I,children:[!u&&(0,te.jsx)("div",{style:V.closeButtonContainer,children:(0,te.jsx)(b().A,{onClick:E,style:V.closeButton,hoveredStyle:V.closeButtonHover,children:(0,c().V)(V.closeButtonIcon)})}),(0,te.jsx)("div",{style:V.header,children:(0,te.jsx)(S().Ay,{type:S().Oh.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,te.jsx)(vt,{...e,disabled:_,buttonName:w,handleNameChange:P,handleBlur:N,handleSubmit:N})}],render:e=>(0,te.jsx)(k().A,{...e,disableMobilePadding:!0,shouldShowBottomDivider:!0,desktopStyle:{paddingTop:0}})}]})}),(0,te.jsxs)("div",{style:V.wrap,children:[I&&(0,te.jsx)(L().j,{onUpsellClick:D}),!T&&(0,te.jsx)(O().z,{children:(0,te.jsx)(d().sA,{...bt.noEditError})}),(0,te.jsx)(v().U3,{areActionsEditable:!I,areTriggersEditable:!1})]})]})}):null),[f,w,y,_,P,E,N,T,u,C,B,V,m,M,R,I,D]),K=u?(0,te.jsx)(n.Fragment,{}):(0,te.jsx)(k().A,{mobileStyle:V.buttons,style:V.buttons,children:(0,te.jsx)(A().A,{onClick:E,disabled:!T,style:V.footerButton,children:(0,te.jsx)(d().sA,{...bt.saveButton})})});return y&&f&&M&&"button"===M.type?(0,te.jsxs)(Ee().i,{handleOnDismiss:E,canSave:!0,mode:"button_property",handleOnSave:E,children:[z,K]}):null}const At=60,kt=60,Mt=60,jt=60,Tt=16,It=12},779698:(e,t,o)=>{o.d(t,{Ah:()=>h,Dk:()=>m,Iv:()=>y,SF:()=>g,YO:()=>x,_f:()=>S,c_:()=>d,dW:()=>v,gW:()=>p,sp:()=>C,vN:()=>f});o(610931),o(362833),o(725707),o(491955),o(771702),o(403517),o(113085);var n=()=>o(975392),i=()=>o(204132),a=()=>o(76394),r=()=>o(599932),l=()=>o(465546),s=()=>o(409211),c=()=>o(34662),u=()=>o(876988);function d(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function h(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function x(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function b(e){const{formulaAnalyticsModule:t,formulasModule:o,formulaTypecheckContextValues:n,getRecordModel:r,spaceId:s,value:c,featureGates:u}=e;if("formula"===c.type){if(!(0,a().O9)(c.value))return;const e=i().Q.unwrapOr(o.parseFormulaInputToAst(c.value),void 0);if(e){const i=o.addTypesToFormulaAST(e,{handleDataRequest:(0,l().zg)(r),spaceId:s,valueTypes:n,featureGates:u});return{...t.getFormulaAnalytics(e,{getRecordModel:r,typecheckContextValues:n}),formula_return_type:i.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:r,typecheckContextValues:n})}}}else{if("simple"===c.type){if(!(0,a().O9)(c.value))return;return t.getSimpleFormulaAnalytics(c.value,{getRecordModel:r,typecheckContextValues:n})}(0,a().HB)(c.type)}}function S(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g,simpleFormulasModule:y}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig();let c,u=[];const d=null==s?void 0:s.collection,p=null==s?void 0:s.properties;if((0,a().O9)(d)&&(0,a().O9)(p)&&p.length>0){const e=r(d),g=null==e?void 0:e.getNormalizedSchema();(0,a().O9)(g)&&(u=p.map((e=>{var t;return(null===(t=g[e])||void 0===t?void 0:t.type)??"unknown"})));const y=null==s?void 0:s.values;if(n&&(0,a().O9)(y)){c=[];for(const e of p){var m;const a=null===(m=y[e])||void 0===m?void 0:m.value;if(!a)continue;const s=b({formulaAnalyticsModule:o,formulasModule:n,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:a,featureGates:l});s&&c.push(s)}}}return{automation_action_id:t.pointer.id,property_formula_stats:c,property_types:u,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig(),c=[];if(n&&(0,a().O9)(s)&&s.text){const e=b({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:s.text,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:o,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:u}=e,d={automation_action_id:o.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},p=o.getConfig();if(!(0,a().O9)(p))return d;if((0,a().O9)(p.target))if("formula"===p.target.type&&(0,a().O9)(p.target.value)){if(d.targetData={type:"formula",numUserFormulaTargets:(0,c().Fbh)(p.target.value.value).length,numFormulaContextTargets:u.getReferencedContextValueIds(p.target.value).length},i){const e=b({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:r,spaceId:o.spaceId,value:p.target.value,featureGates:s});e&&(d.formula_stats??=[],d.formula_stats.push(e))}}else if("property"===p.target.type&&(0,a().O9)(p.target.propertyId)&&(0,a().O9)(p.target.collectionPointer)){const e=l(p.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,a().O9)(t)&&(d.targetData={type:"property",propertyType:null===(m=t[p.target.propertyId])||void 0===m?void 0:m.type})}if((0,a().O9)(null===(t=p.notification_message)||void 0===t?void 0:t.value)&&(d.messageCharacterCount=(0,c().FAw)(p.notification_message.value),i)){const e=b({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:r,spaceId:o.spaceId,value:p.notification_message,featureGates:s});e&&(d.formula_stats??=[],d.formula_stats.push(e))}return d}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g,simpleFormulasModule:y}):t.isType("send_gmail_notification")?function(e){var t,o,i,l,u,d,p;const{automationActionModel:m,formulaAnalyticsModule:g,formulasModule:y,formulaTypecheckContextValues:h,getRecordModel:f,featureGates:v}=e,x=m.getConfig();if(!(0,a().O9)(x))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const S=Object.fromEntries(Object.entries(x||{}).map((e=>{let[t,o]=e;var n;return"formula"===(null==o?void 0:o.type)?[t,Boolean(null==o||null===(n=o.value)||void 0===n?void 0:n.value)]:"simple"===(null==o?void 0:o.type)?[t,Boolean(null==o?void 0:o.value)]:[t,Boolean(o)]}))),{to:C,cc:A,bcc:k}=x,M=[...(null==C||null===(t=C.value)||void 0===t?void 0:t.value)||[],...(null==A||null===(o=A.value)||void 0===o?void 0:o.value)||[],...(null==k||null===(i=k.value)||void 0===i?void 0:i.value)||[]],j=[...(0,c().Fbh)(M).map((e=>f({table:s().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(a().O9),...(0,r().C3)((0,c().k4p)(M))],T=n().Tr(j.map((e=>e.split("@")[1]))),I=[null===(l=x.to)||void 0===l?void 0:l.value,null===(u=x.cc)||void 0===u?void 0:u.value,null===(d=x.bcc)||void 0===d?void 0:d.value,null===(p=x.reply_to)||void 0===p?void 0:p.value,x.from_name,x.email_subject,x.email_body].map((e=>{if(y&&(0,a().O9)(e))return b({formulaAnalyticsModule:g,formulasModule:y,getRecordModel:f,formulaTypecheckContextValues:h,spaceId:m.spaceId,value:e,featureGates:v})})).filter(a().O9);return{automation_action_id:m.pointer.id,fields:S,formula_stats:I,recipient_domains:T,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:s,featureGates:c}=e,d=t.getConfig(),p=[],m=[],g=[];if((0,a().O9)(d)&&(0,a().O9)(d.target)&&(0,a().O9)(d.properties)&&d.properties.length>0){let e;if("variable"===d.target.type){const t=(0,l().y5)(d.target.id);if("action"===t.source){const t=(0,u().y)({actionModels:o,id:d.target.id}).collectionPointer;if((0,a().O9)(t)){const o=s(t);e=null==o?void 0:o.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,l().IV)(r,d.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,a().O9)(t.type.collection)){const o=s(t.type.collection);e=null==o?void 0:o.getNormalizedSchema()}}}}else if("collection"===d.target.type){const t=s(d.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,a().O9)(e)&&d.properties.forEach((o=>{const l=e[o];if((0,a().O9)(l)&&(p.push(l.type),i&&(0,a().O9)(d.values))){const e=d.values[o];if((0,a().O9)(e)&&(m.push({type:l.type,operator:e.action}),e.value)){const o=b({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:s,formulaTypecheckContextValues:r,spaceId:t.spaceId,value:e.value,featureGates:c});o&&g.push(o)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:g,property_types:p,type:"update_pages"}}({automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig(),c=[];if(n&&(0,a().O9)(s)&&s.values)for(const a of Object.values(s.values))if(a.value){const e=b({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:a.value,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:void(0,a().HB)(t)}function C(e){const{automationModel:t,builderType:o="sidebar",formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:c,source:u}=e,d=[],p=t.getActionPointers().map((e=>l(e))).filter(a().O9);for(const x of t.getActionPointers()){const e=l(x);(0,a().O9)(e)&&d.push(S({automationActionModel:e,automationActionModels:p,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:c}))}const m=[];let g,y,h;if(t.isEventType()){var f;const e=t.getEventConfiguration(),o=l(t.getParentPointer());g=t.getParentId();const n=t.getEventConfiguration();if("collection_view"===(null===(f=n.source)||void 0===f?void 0:f.type)){const e=l(n.source.pointer);h=null==e?void 0:e.parent_id,y=null==n?void 0:n.source.pointer.id}const i=null==o?void 0:o.getNormalizedSchema();if((0,a().O9)(i)){const{pagesAdded:t,pagePropertiesEdited:o}=e;if(t&&m.push({type:"page"}),"any"===o.type)m.push({condition:"any",type:"property"});else if("none"===o.type)m.push({condition:"none",type:"property"});else{let e=[];"some"===o.type?e=o.some??[]:"all"===o.type&&(e=o.all??[]);const t=[],n=[];e.forEach((e=>{var o;const r=null===(o=i[e.property])||void 0===o?void 0:o.type;(0,a().O9)(r)&&(t.push({type:r,operator:e.filter.operator}),n.push(r))})),m.push({condition:o.type,property_configs:t,property_types:n,type:"property"})}}}else if(t.isButtonType())m.push({type:"button"});else if(t.isRecurrenceType()){var v;m.push({type:"recurrence",frequency:null===(v=t.getTrigger().recurrence)||void 0===v?void 0:v.frequency})}else(0,a().HB)(t);return{automation_actions:d,automation_id:t.id,automation_triggers:m,collection_id:g,collection_view_id:y,collection_view_block_id:h,builder_type:o,source:u}}},781045:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,lightningIcon:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M11.633 1.812c.263.096.43.354.41.632l-.392 5.51h3.099a.625.625 0 0 1 .506.992l-6.18 8.54a.625.625 0 0 1-1.13-.412l.402-5.5H5.25a.625.625 0 0 1-.507-.99l6.17-8.55a.625.625 0 0 1 .72-.222m-5.161 8.513H9.02a.625.625 0 0 1 .623.67l-.29 3.976 4.173-5.766H10.98a.625.625 0 0 1-.623-.67l.284-3.987z"})},i=(0,o(680369).wt)("lightning",n)},791503:(e,t,o)=>{function n(e){const{dateRangeStart:t,dateRangeEnd:o,collectionContextStore:n}=e;n.dateRangeStartStore.setState(t),n.dateRangeEndStore.setState(o)}o.d(t,{r:()=>n})},792104:(e,t,o)=>{o.d(t,{f:()=>i});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M10 2.4c.345 0 .625.28.625.625v9.966l3.333-3.333a.625.625 0 1 1 .884.884l-4.4 4.4a.625.625 0 0 1-.884 0l-4.4-4.4a.625.625 0 0 1 .884-.884l3.333 3.333V3.025c0-.345.28-.625.625-.625M4.15 16.35a.625.625 0 1 0 0 1.25h11.7a.625.625 0 0 0 0-1.25z"})},i=(0,o(680369).wt)("arrowLineDown",n)},793613:(e,t,o)=>{o.d(t,{E:()=>g});o(242343);var n=()=>o(803290),i=()=>o(174114),a=()=>o(653998),r=()=>o(622286),l=()=>o(485966),s=()=>o(695951),c=o(163643);const u={define_variables_automation_action:{launchDateMs:17277408e5,expiryDateMs:1738368e6},passkey_setting:{launchDateMs:1729101727e3,expiryDateMs:1738432882e3},http_request_automation_action:{launchDateMs:173324302e4,expiryDateMs:1738368e6},publish_site_settings_embed_page:{launchDateMs:1736208e6,expiryDateMs:1743984e6},generalized_recurrence_automations:{launchDateMs:17365536e5,expiryDateMs:17460576e5},ai_page_translation_topbar_more_action:{launchDateMs:1740451280830,expiryDateMs:17434656e5},verification:{launchDateMs:1740096e6,expiryDateMs:174375e7},notion_ai_workspace_settings:{launchDateMs:17424288e5,expiryDateMs:17550432e5},notion_mail_launch_modal:{launchDateMs:17446752e5,expiryDateMs:17525376e5},notion_mail_launch_modal_2:{launchDateMs:17446752e5,expiryDateMs:17578944e5},ui_doc_example:{launchDateMs:19249056e5,expiryDateMs:19249056e5},show_integration_webhooks_callout:{launchDateMs:17428608e5,expiryDateMs:17506368e5},collection_property_permissions:{launchDateMs:17433792e5,expiryDateMs:17671392e5},salesforce_sync_unfurling_option:{launchDateMs:17443296e5,expiryDateMs:17538336e5}};function d(e){let{style:t}=e;const o=(0,i().IS)((e=>({badge:{letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",...t}})),[t]);return(0,c.jsx)(s().A,{color:"blue",style:o.badge,content:(0,c.jsx)(a().sA,{id:"newBadgeComponent.label",defaultMessage:"New"})})}function p(e){let{style:t,newBadgeKey:o}=e;const{launchDateMs:i,expiryDateMs:a}=u[o];return(0,n().K8)((()=>{const{currentUserSettingsStore:e}=l().default.state;if(e&&e.isReady()){var t;const o=null===(t=e.getSettings())||void 0===t?void 0:t.signup_time;if(o&&o>i)return!1}return Date.now()<=a}),[a,i])?(0,c.jsx)(d,{style:t}):null}function m(e){let{style:t,newBadgeKey:o}=e;return(0,r().X)(o)?(0,c.jsx)(d,{style:t}):null}function g(e){return e.didUserEngage?null:"feature_gate"===e.keyType?(0,c.jsx)(m,{...e}):(0,c.jsx)(p,{...e})}},807069:(e,t,o)=>{o.d(t,{v:()=>u});o(242343);var n=()=>o(174114),i=()=>o(653998),a=()=>o(31448),r=()=>o(421338),l=()=>o(209684),s=o(163643);const c=(0,i().YK)({slackAutomationPricingChangeWarning:{defaultMessage:"Slack automations will require a paid plan starting August 13, 2025. To keep your access, please upgrade your plan.",id:"AutomationHeaderView.slackAutomationPricingChangeWarning"},upgrade:{defaultMessage:"Upgrade",id:"AutomationHeaderView.slackAutomationPricingChangeUpgrade"}});function u(e){const{onUpsellClick:t}=e,o=c.slackAutomationPricingChangeWarning,u=(0,n().IS)((e=>({wrap:{fontSize:14,background:e.surface.wash,border:`1px solid ${e.surface.wash}`,borderRadius:6,padding:12,marginBottom:12},button:{fontWeight:a().Wy.medium,borderRadius:6,border:`1px solid ${e.stroke.primary}`,alignSelf:"flex-start"},text:{color:e.text.secondary,margin:0}})),[]);return(0,s.jsxs)(r().Y1,{direction:"vertical",gap:4,style:u.wrap,children:[(0,s.jsx)("p",{style:u.text,children:(0,s.jsx)(i().sA,{...o})}),(0,s.jsx)(l().p,{onClick:t,style:u.button,children:(0,s.jsx)(i().sA,{...c.upgrade})})]})}},827744:(e,t,o)=>{o.d(t,{r:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("pencil",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},855470:(e,t,o)=>{o.d(t,{V:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("chevronRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},859669:(e,t,o)=>{o.d(t,{R:()=>_});var n=o(242343),i=()=>o(752597),a=()=>o(237385),r=()=>o(174114),l=()=>o(908568),s=()=>o(711361),c=()=>o(319989),u=()=>o(827744),d=()=>o(653998),p=()=>o(220413),m=()=>o(31448),g=()=>o(91472),y=()=>o(85706),h=()=>o(622163),f=()=>o(907721),v=()=>o(286555),x=()=>o(413871),b=()=>o(126451),S=()=>o(273520),C=()=>o(516267),A=()=>o(356813),k=()=>o(392968),M=()=>o(517198),j=()=>o(610271),T=()=>o(40357),I=()=>o(410090),w=o(163643);function _(e){const t=(0,a().v3)(),{hoverData:o,href:_,handleEditClick:P,showEditButton:B,loading:R,store:V,token:E,onDismiss:D}=e,F=(0,r().IS)((e=>({newWrapper:{width:280,flexDirection:"column",alignItems:"flex-start"},coverContainer:{width:280,height:120},contentNew:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"12px 16px",gap:12,width:280},titleAndDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,gap:2,width:248},linkTitle:{...(0,h().pA)(2),fontStyle:"normal",fontWeight:m().Wy.semibold,fontSize:14,letterSpacing:-.154,lineHeight:"143%",fontFeatureSettings:"'case' on",textOverflow:"ellipsis",color:e.text.primary},newDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,...(0,h().pA)(3),textOverflow:"ellipsis",width:248},newText:{fontSize:12,fontWeight:400,whiteSpace:"normal",wordBreak:"break-word",color:e.text.primary},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.lightIconColor,background:o?(0,I().FF)(t):"dark"===e.mode?e.accentColors.gray[100]:e.buttonBackground,border:o?void 0:"1px solid var(--Stroke-Deemphasized, rgba(227, 226, 224, 0.50))"},iconBoxImageStyle:{margin:1}})),[t,o]),O=(0,d().tz)(),N=(0,n.useRef)(null),L=(0,d().YK)({copyLink:{defaultMessage:"Copy link",id:"hoverPreviewOverlay.copyLink"},editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),W=(0,n.useCallback)((async()=>{await i().default.afterNextFlush();const e=await g().R.clipboardActions.load(),o=e.clipboardMessages.copiedLinkToClipboard,n=_;e.copyString({environment:t,stringValue:n,copiedMessage:o})}),[t,_]),z=V&&V.recordStoreUIParentStore&&V.recordStoreUIParentStore instanceof x().Bv?V.recordStoreUIParentStore:V instanceof x().Bv?V:void 0,K=(null==o?void 0:o.thumbnail_url)??((null==o?void 0:o.images)&&o.images.length>0&&o.images[0].url);return(0,w.jsxs)(j().wt,{style:F.newWrapper,children:[B&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(A().A,{onClick:W,icon:l().n,isDarkIconColor:!0,ariaLabel:O.formatMessage(L.copyLink),hasBackground:!0,style:{position:"absolute",top:8,right:8}}),(0,w.jsx)(A().A,{onClick:P,icon:u().r,isDarkIconColor:!0,ariaLabel:O.formatMessage(L.editLink),hasBackground:!0,style:{position:"absolute",top:8,right:35}})]}),E&&z&&!B&&(0,w.jsx)("div",{style:{position:"absolute",top:8,right:8},children:(0,w.jsx)(S().Ay,{popupType:S().z7.Popup,placementToOrigin:f().W.Right,alignmentToOrigin:f().C.Start,originGap:4,onClose:()=>{let e=!1;const t=N.current;t&&(e=(0,v().ux)(t.getBoundingClientRect(),y().$C.x,y().$C.y)),e||null==D||D()},renderOrigin:e=>(0,w.jsx)(b().A,{style:F.buttonStyle,...e,children:(0,s()._)({width:14,fill:o?p().Ay.white:p().Ay.uiGray})}),render:e=>(0,w.jsx)(T().A,{parentBlockStore:z,store:V,token:E,href:_,hoverData:o,onAccept:()=>e.close()})})}),K&&(0,w.jsx)(j().Ye,{style:F.coverContainer,children:(0,w.jsx)(k().Ay,{src:K,style:{width:"100%",height:"100%",left:0,top:"calc(50% - 280px/2)"}})}),(0,w.jsxs)(j().wt,{style:F.contentNew,children:[((null==o?void 0:o.title)||(null==o?void 0:o.description))&&(0,w.jsxs)(j().wt,{style:F.titleAndDescription,children:[(null==o?void 0:o.title)&&(0,w.jsx)(j().Ye,{gap:2,children:(0,w.jsx)("div",{style:F.linkTitle,children:null==o?void 0:o.title})}),(null==o?void 0:o.description)&&(0,w.jsx)(j().Ye,{gap:2,children:(0,w.jsx)("div",{style:F.newDescription,children:(0,w.jsx)("div",{spellCheck:!1,style:F.newText,children:(0,w.jsx)("div",{children:null==o?void 0:o.description})})})})]}),R?(0,w.jsx)(M().A,{style:{width:200,height:16}}):(0,w.jsxs)(j().Ye,{alignItems:"left",style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,width:205,height:16},children:[null!=o&&o.favicon_url?(0,w.jsx)(C().A,{type:"image_url",imageURL:null==o?void 0:o.favicon_url,size:16,style:F.iconBoxImageStyle}):null!=o&&o.icon_url?(0,w.jsx)(C().A,{type:"image_url",imageURL:null==o?void 0:o.icon_url,size:16,style:F.iconBoxImageStyle}):(0,w.jsx)(A().A,{icon:c().w,isDarkIconColor:!0,disabled:!0}),(0,w.jsx)("div",{style:{flexGrow:0,fontWeight:m().Wy.medium,color:"#787774",fontSize:12,...m().RC},children:(null==o?void 0:o.provider_name)||(null==o?void 0:o.link_provider)||_})]})]})]})}},867739:(e,t,o)=>{o.d(t,{A:()=>B});o(362833),o(403517);var n=o(242343),i=()=>o(16791),a=()=>o(237385),r=()=>o(803290),l=()=>o(174114),s=()=>o(846581),c=()=>o(446588),u=()=>o(653998),d=()=>o(141666),p=()=>o(535906),m=()=>o(273520),g=()=>o(935091),y=()=>o(858023),h=()=>o(397791),f=()=>o(88271),v=()=>o(35462),x=()=>o(297340),b=()=>o(350208),S=()=>o(782422),C=()=>o(640979),A=()=>o(755769),k=()=>o(943066),M=()=>o(404042),j=()=>o(111826),T=o(163643);function I(e,t){const{permissionItem:n,hideIcon:i,onChange:r,buttonStyle:l}=e,s=(0,a().Y0)();return(0,T.jsx)(o(511952).A,{...e,popupType:s.isMobile?m().z7.SlideUp:m().z7.Popup,renderOrigin:a=>(0,T.jsx)(o(48150).a,{...(0,o(906230).A)(e,a),ref:t,title:(0,T.jsx)(u().sA,{defaultMessage:"Link expires",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!i&&(0,T.jsx)(h().I,{icon:o(934889).clockIcon,color:"secondary"}),right:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(w,{permissionItem:n}),(0,T.jsx)(h().I,{icon:o(663821).arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]}),buttonStyle:l}),alignmentToOrigin:A().MY.End,placementToOrigin:A().UV.Bottom,render:e=>(0,T.jsx)(_,{value:n.expiration_timestamp,onChange:r,onClose:()=>{e.close()}})})}function w(e){const{permissionItem:t}=e,o=(0,u().tz)(),n=(0,l().IS)((e=>({container:{color:e.text.secondary}})),[]);if(!t.expiration_timestamp||(0,c().OA)(t))return(0,T.jsx)(v().A,{style:n.container,children:(0,T.jsx)(u().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})});const a=s().jE(t.expiration_timestamp,i().locale,o);return(0,T.jsx)(v().A,{style:n.container,children:a})}function _(e){const{value:t,onChange:o,onClose:s}=e,c=(0,a().v3)(),m=c.device,h=(0,r().K8)((()=>!j().qC()),[]),v=(0,r().K8)((()=>j().Si(c)),[c]),x=(0,n.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(o(e),s())}),[o,s]),b=(0,l().IS)((e=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:e.text.tertiary}})),[]),S=function(){const e=Date.now(),t=e+d().pT,o=e+d().nD,n=e+7*d().nD;return[{key:"none",time:void 0,title:(0,T.jsx)(u().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:t,title:(0,T.jsx)(u().sA,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(i().locale,{hour:"numeric",minute:"numeric"}).format(t)},{key:"day",time:o,title:(0,T.jsx)(u().sA,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(o)},{key:"week",time:n,title:(0,T.jsx)(u().sA,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(n)}]}().map((e=>({key:e.key,action:()=>{x(e.time)},render:t=>(0,T.jsx)(p().A,{...t,title:e.title,titleStyle:h?b.disabledText:{},caption:e.caption,captionStyle:h?b.disabledText:{},disabled:h})}))),A=[{key:"predefined-expiration",render:e=>(0,T.jsx)(f().A,{...e}),items:S},{key:"custom-expiration",render:e=>(0,T.jsx)(f().A,{...e,topBorder:!0}),items:[P(x,t,h,b.disabledText)]}];return v&&h&&A.push({key:"upgrade-for-expiration",render:e=>(0,T.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>{k().K(c,{from:"public_permission_item_expiration",upsell:{type:"product",product:v,limit:{type:"none"},trialability:"none"}})},render:e=>(0,T.jsx)(p().A,{...e,focused:e.focused,title:(0,T.jsxs)("div",{style:b.disabledContainer,children:[(0,T.jsx)(u().sA,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,T.jsx)(M().A,{subscriptionTier:v,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,T.jsx)(g().A,{menuType:m.isMobile?C().gu.ActionSheet:C().gu.Popup,width:271,children:(0,T.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:void 0,sections:A})})}function P(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{key:"custom",action:()=>{window.parent.close()},render:(i,a)=>(0,T.jsx)(b().A,{...i,renderOrigin:e=>(0,T.jsx)(p().A,{...e,disabled:o,title:(0,T.jsx)(u().sA,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:o?n:{}}),onFocus:a.onFocus,disableDefaultClick:!0,renderExtension:(n,i)=>(0,T.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,T.jsx)(x().A,{...n,firstDayOfWeek:S().XX.state,value:t||Date.now(),onChange:t=>{e(t),i.close()},disabledDays:o||{before:new Date}})})})}}const B=n.forwardRef(I)},870122:(e,t,o)=>{o.r(t),o.d(t,{globeIcon:()=>i,iconDefinition:()=>n});o(242343);const n={viewBox:"0 0 20 20",svg:(0,o(163643).jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0m3.123-4.514c.55.252 1.21.463 1.953.612q.135-.585.308-1.086a6.6 6.6 0 0 1 .512-1.15 6.4 6.4 0 0 0-2.773 1.624m-.814.994a6.34 6.34 0 0 0-1.029 2.895h3.396c.022-.715.081-1.403.173-2.048-.962-.191-1.827-.48-2.54-.847m-1.029 4.145a6.34 6.34 0 0 0 1.03 2.895c.712-.367 1.577-.656 2.54-.848a19 19 0 0 1-.174-2.047zm4.647 0c.021.657.076 1.283.158 1.862a15 15 0 0 1 3.08 0c.082-.58.137-1.205.158-1.862zm4.647 0a19 19 0 0 1-.173 2.048c.845.169 1.615.412 2.274.717a.6.6 0 0 1 .23.182 6.34 6.34 0 0 0 1.065-2.947zm3.396-1.25a6.34 6.34 0 0 0-1.03-2.895c-.712.367-1.577.656-2.54.847.093.645.152 1.333.174 2.048zm-4.647 0a17 17 0 0 0-.158-1.862 15 15 0 0 1-3.08 0c-.082.58-.137 1.205-.158 1.862zm-6.2 5.139a6.4 6.4 0 0 0 2.773 1.624 6.6 6.6 0 0 1-.512-1.15 11 11 0 0 1-.308-1.086 9 9 0 0 0-1.953.612m9.004 0a9 9 0 0 0-1.953-.611q-.135.584-.308 1.085a6.6 6.6 0 0 1-.512 1.15 6.4 6.4 0 0 0 2.773-1.624m-3.443.067q.136-.395.249-.86a13.7 13.7 0 0 0-2.615-.001q.111.466.248.861c.198.575.42.995.635 1.259.22.269.366.302.424.302s.205-.033.424-.302c.215-.264.437-.684.635-1.259m3.443-9.095a6.4 6.4 0 0 0-2.773-1.624c.196.337.366.726.512 1.15q.173.501.308 1.086a9 9 0 0 0 1.953-.612M10 6.342q.676-.001 1.308-.062a9 9 0 0 0-.249-.861c-.198-.575-.42-.995-.635-1.259-.22-.269-.366-.302-.424-.302s-.204.033-.424.302c-.215.264-.437.684-.635 1.259q-.136.395-.248.861.631.061 1.307.062"})},i=(0,o(680369).wt)("globe",n)},870896:(e,t,o)=>{o.d(t,{d:()=>i});o(725707),o(491955);class n extends(()=>o(129044))().default{getInitialState(){return{flowId:void 0,type:"connected_properties_setup",collectionsProperties:{}}}createNewFlowId(){const e=(0,o(214144).JW)();return this.setState({...this.state,flowId:e}),e}getFlowId(){return this.state.flowId?this.state.flowId:this.createNewFlowId()}addCollectionProperties(e,t){const o=this.state.collectionsProperties[e],n=o?{...o,...t}:t;this.setState({...this.state,collectionsProperties:{...this.state.collectionsProperties,[e]:n}})}removeCollectionProperties(e,t){const o=this.state.collectionsProperties[e];if(!o)return;const n=Object.fromEntries(Object.entries(o).filter((e=>{let[o]=e;return!t.has(o)})));if(0===Object.keys(n).length){const{[e]:t,...o}=this.state.collectionsProperties;this.setState({...this.state,collectionsProperties:o})}else this.setState({...this.state,collectionsProperties:{...this.state.collectionsProperties,[e]:n}})}}const i=new n;(0,o(996094).exposeDebugValue)("ConnectedPropertiesSyncStore",i)},876988:(e,t,o)=>{o.d(t,{y:()=>a});o(725707),o(500234);var n=()=>o(76394),i=()=>o(465546);function a(e){var t;const{actionModels:o,id:a}=e,r=(0,i().y5)(a),l="action"===r.source?o.find((e=>e.id===r.action_id)):void 0,s=(0,n().O9)(l)&&l.isType("create_page")?null===(t=l.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:r,collectionPointer:s,actionModel:l}}},887508:(e,t,o)=>{o.d(t,{v:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("arrowLeftThick",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.54004 8.05762C1.54004 8.2627 1.62891 8.46094 1.78613 8.61133L6.29102 13.1162C6.45508 13.2734 6.63965 13.3486 6.82422 13.3486C7.25488 13.3486 7.5625 13.041 7.5625 12.6309C7.5625 12.4189 7.48047 12.2344 7.34375 12.1045L5.8125 10.5527L3.78906 8.70703L5.38867 8.80273H13.7012C14.1455 8.80273 14.46 8.49512 14.46 8.05762C14.46 7.61328 14.1455 7.3125 13.7012 7.3125H5.38867L3.7959 7.4082L5.8125 5.5625L7.34375 4.01074C7.48047 3.87402 7.5625 3.68945 7.5625 3.47754C7.5625 3.06738 7.25488 2.7666 6.82422 2.7666C6.63965 2.7666 6.45508 2.83496 6.27734 3.00586L1.78613 7.50391C1.62891 7.64746 1.54004 7.85254 1.54004 8.05762Z"})})},888100:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>qt});o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(491955),o(500234),o(771702),o(403517),o(113085);var n=o.n(o(567012)),i=o(242343),a=()=>o(237385),r=()=>o(803290),l=()=>o(174114),s=()=>o(950635),c=()=>o(911575),u=()=>o(268163),d=()=>o(903012),p=()=>o(15552),m=()=>o(564134),g=()=>o(716605),y=()=>o(630714),h=()=>o(311308),f=()=>o(242978),v=()=>o(214263),x=()=>o(904850),b=()=>o(903823),S=()=>o(284594),C=()=>o(827744),A=()=>o(339189),k=()=>o(474894),M=()=>o(945067),j=()=>o(623843),T=()=>o(680369),I=o(163643);const w=(0,T().wt)("typesLocation",{viewBox:"0 0 25 25",svg:(0,I.jsxs)("g",{children:[(0,I.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,I.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})});var _=()=>o(651632),P=()=>o(960194),B=()=>o(696443),R=()=>o(484136),V=()=>o(293665),E=()=>o(653998),D=()=>o(76394),F=()=>o(31448),O=()=>o(521325),N=()=>o(575015),L=()=>o(165601),W=()=>o(993517),z=()=>o(271142),K=()=>o(748039),H=()=>o(157699),U=()=>o(3364),Y=()=>o(209684),G=()=>o(401382),q=()=>o(579494),X=()=>o(951540),$=()=>o(88271),J=()=>o(103151),Q=()=>o(137476),Z=()=>o(206183),ee=()=>o(950808),te=()=>o(352723),oe=()=>o(622286),ne=()=>o(907721),ie=()=>o(485966),ae=()=>o(802955),re=()=>o(836331),le=()=>o(133926),se=()=>o(264022),ce=()=>o(152058),ue=()=>o(873895),de=()=>o(268974),pe=()=>o(43029);const me=(0,T().wt)("pause",{viewBox:"0 0 6 8",svg:(0,I.jsx)("path",{d:"M1.008 7.473q-.294 0-.442-.149t-.144-.441V1.477q0-.29.148-.438.15-.148.438-.148h.937q.29.003.438.148.148.144.148.438v5.406q0 .292-.148.441-.15.15-.438.149zm3.047 0q-.297 0-.446-.149-.144-.149-.144-.441V1.477q0-.29.148-.438.149-.148.442-.148h.933q.293 0 .438.148.148.144.148.438v5.406q0 .292-.148.441-.145.15-.438.149z"})});var ge=()=>o(723361),ye=()=>o(199001),he=()=>o(449148),fe=()=>o(507190),ve=()=>o(533666),xe=()=>o(781045),be=()=>o(686752),Se=()=>o(836693),Ce=()=>o(535906),Ae=()=>o(273520),ke=()=>o(356813),Me=()=>o(935091),je=()=>o(858023),Te=()=>o(397791),Ie=()=>o(725599),we=()=>o(962373),_e=()=>o(441911),Pe=()=>o(179701);const Be=(0,E().YK)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"},automationSummaryCardMoreMenuActiveTitle:{defaultMessage:"Active",id:"automations.AutomationSummaryCard.MoreActionsMenu.Active.title"},automationSummaryCardMoreMenuRestartTitle:{defaultMessage:"Restart",id:"automations.AutomationSummaryCard.MoreActionsMenu.Restart.title"}});function Re(e){const{focused:t,style:o,onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u,onRestart:d}=e,p=(0,E().tz)(),m=(0,r().uB)(void 0,we().A),g=(0,Pe().j)();(0,i.useEffect)((()=>{t||m.setState({open:!1})}),[t,m]);const y=(0,l().IS)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:T().Ev.sm,height:T().Ev.sm}})),[o]);return(0,I.jsx)(Ae().Ay,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:Ae().yP.Center,placementToOrigin:Ae().sx.Bottom,originGap:0,renderOrigin:e=>(0,I.jsx)(ke().A,{ariaLabel:p.formatMessage(Be.automationSummaryCardMoreButtonAriaLabel),icon:ve().Y,iconStyle:y.iconButtonIcon,style:y.iconButton,hasBackground:!0,...e}),render:e=>(0,I.jsx)(Ve,{onClose:()=>e.close(),onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u,onRestart:d}),buttonPopupStore:m})}function Ve(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:a,onEnable:r,onRestart:l}=e,s=(0,E().tz)(),c=(0,_e().e)(),u=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,I.jsx)(Ce().A,{...e,icon:(0,I.jsx)(Te().I,{icon:be().pencilLineIcon}),title:s.formatMessage(Be.automationSummaryCardMoreMenuEditTitle)})}:void 0,d=l?{action:()=>{t(),l()},key:"restart",render:e=>(0,I.jsx)(Ce().A,{...e,icon:(0,I.jsx)(Te().I,{icon:he().D}),title:s.formatMessage(Be.automationSummaryCardMoreMenuRestartTitle)})}:void 0,p=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,I.jsx)(Ce().A,{...e,icon:(0,I.jsx)(Te().I,{icon:fe().V}),title:s.formatMessage(Be.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,m=r||a?{action:()=>{t(),r?r():a&&a()},key:"active",render:e=>(0,I.jsx)(Ie().A,{...e,icon:(0,I.jsx)(Te().I,{icon:xe().lightningIcon}),title:s.formatMessage(Be.automationSummaryCardMoreMenuActiveTitle),on:(0,D().O9)(a)})}:void 0,g=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,I.jsx)(Ce().A,{...e,icon:(0,I.jsx)(Te().I,{icon:Se().trashIcon}),title:s.formatMessage(Be.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0,y=[];return(0,D().O9)(m)&&y.push({items:[m],key:"active-inactive",render:e=>(0,I.jsx)($().A,{enableActionSheetTitle:!0,...e})}),y.push({items:[d,u,p,g].filter(D().O9),key:"items",render:e=>(0,I.jsx)($().A,{enableActionSheetTitle:!0,topBorder:(0,D().O9)(m),...e})}),(0,I.jsx)(Me().A,{...c,children:(0,I.jsx)(je().Ay,{type:je().Oh.Vertical,sections:y,initialFocus:0})})}var Ee=()=>o(695951),De=()=>o(126451),Fe=()=>o(415806),Oe=()=>o(622163);const Ne=6;function Le(e){const{actions:t,caption:o,focused:n,status:s,maxIcons:c,onBlur:u,onClick:d,onDelete:p,onDisable:m,onDuplicate:g,onEdit:y,onRestart:h,onEnable:f,onFocus:v,onMouseDown:x,onMouseEnter:b,onMouseLeave:S,title:C,triggers:A,shouldShowSlackPricingChangeBanner:k}=e,{isMobile:M}=(0,a().Y0)(),j=(0,i.useRef)(null),[T,w]=(0,ce().A)(),[_,P]=(0,ue().A)(),[B,R]=(0,i.useState)(!1),V=M||B||w||P,O=(0,l().IS)((e=>({wrap:{background:e.surface.elevated,border:`1px solid ${e.regularDividerColor}`,borderRadius:10,display:"flex",flexDirection:"column",gap:11,paddingTop:16,paddingLeft:16,paddingRight:16,paddingBottom:13,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:6,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:M?4:0},titleWrap:{..."success"!==s?{alignItems:"center",display:"inline-flex",gap:4}:(0,Oe().pA)(2),fontSize:M?16:14,fontWeight:F().Wy.medium,lineHeight:"20px"},title:{..."success"!==s?F().RC:{}},caption:{...(0,Oe().pA)(2),color:e.text.secondary,fontSize:M?14:12,fontWeight:F().Wy.regular,lineHeight:"16px",margin:0}})),[s,V,M]),N=(0,i.useCallback)((e=>{R(!0),b&&b(e)}),[b]),L=(0,i.useCallback)((e=>{R(!1),S&&S(e)}),[S]);(0,i.useEffect)((()=>{n&&null!==j.current&&j.current.focus()}),[n]);const W=(0,ye().Px)(j,T,_),z=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,a=t.length,r=i>0&&a>0,l=Math.max(o,3),s=r?l-1:l;let c=Math.max(Math.floor(s/2),1),u=Math.max(Math.ceil(s/2),1);if(i<c&&a>u){u+=c-i,c=i}else if(a<u&&i>c){c+=u-a,u=a}const d=[];if(i>0)if(i>c)if(1===c)d.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);d.push(...n.slice(0,c-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...n);r&&d.push({type:"arrow"});if(a>0)if(a>u)if(1===u)d.push({color:"gray",type:"truncate",value:a});else{const e=a-(u-1);d.push(...t.slice(0,u-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...t);return d}({actionIcons:t,maxIcons:Ge(c),triggerIcons:A}),K=(0,r().O$)(ae().e),H=K&&Boolean(p||m||f||g||y||h),U=function(e){let{status:t,titleSize:o}=e;const n=Xe({status:t,titleSize:o});return(0,i.useMemo)((()=>"invalid"===t?(0,I.jsx)(Ee().A,{style:n.invalidBadge,content:(0,I.jsxs)("div",{style:n.badgeContainer,children:[(0,ge().Q)(n.icon),(0,I.jsx)(E().sA,{defaultMessage:"Invalid",id:"automationSummaryCard.invalidToken"})]})}):"paused"===t?(0,I.jsx)(Ee().A,{style:n.pausedBadge,content:(0,I.jsxs)("div",{style:n.badgeContainer,children:[me(n.icon),(0,I.jsx)(E().sA,{defaultMessage:"Paused",id:"automationSummaryCard.pausedToken"})]})}):"failing"===t?(0,I.jsx)(Ee().A,{style:n.failingBadge,content:(0,I.jsx)("div",{style:n.badgeContainer,children:(0,I.jsx)(E().sA,{defaultMessage:"Failing",id:"automationSummaryCard.failingToken"})})}):"expired"===t?(0,I.jsx)(Ee().A,{style:n.pausedBadge,content:(0,I.jsx)("div",{style:n.badgeContainer,children:(0,I.jsx)(E().sA,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})}):void("error"!==t&&"warning"!==t&&"success"!==t&&(0,D().HB)(t))),[t,n])}({status:s,titleSize:M?16:14});return(0,I.jsxs)(De().A,{onBlur:u,onClick:d,onFocus:v,onMouseDown:x,onMouseEnter:N,onMouseLeave:L,ref:W,style:O.wrap,disabled:!K,children:[(0,I.jsxs)("header",{children:[H&&(0,I.jsx)("div",{style:O.moreButtonWrap,children:(0,I.jsx)(Re,{focused:V,onDelete:p,onDisable:m,onEnable:f,onDuplicate:g,onEdit:y,onRestart:h})}),(0,I.jsx)("ul",{"aria-hidden":"true",style:O.iconList,children:z.map(((e,t)=>(0,I.jsx)("li",{children:(0,I.jsx)(We,{icon:e})},t)))})]}),(0,I.jsxs)("div",{style:O.body,children:[(0,I.jsxs)("div",{style:O.titleWrap,children:[(0,I.jsx)("span",{style:O.title,children:C}),U,(0,I.jsx)($e,{isMobile:M,shouldShowSlackPricingChangeBanner:k})]}),o&&(0,I.jsx)("p",{style:O.caption,children:o})]})]})}function We(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,I.jsx)(ze,{color:t.color,icon:t.icon}):"person"===t.type?(0,I.jsx)(Ye,{actor:t.actor}):"app"===t.type?(0,I.jsx)(He,{color:"default",icon:t.icon}):"arrow"===t.type?(0,I.jsx)(Ke,{}):"truncate"===t.type?(0,I.jsx)(Ue,{color:t.color,value:t.value}):void(0,D().HB)(t.type)}function ze(e){const{color:t,icon:o}=e,n=qe(t);return(0,I.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function Ke(){const e=qe("default");return(0,I.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,de().B)({...e.icon,...e.iconArrow})})}function He(e){const{icon:t}=e,o=qe("default");return(0,I.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function Ue(e){const{color:t,value:o}=e,n=qe(t);return(0,I.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function Ye(e){const{actor:t}=e,o=qe("default");return(0,I.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,I.jsx)(Fe().Ay,{actor:t,avatarSize:26,format:Fe().Ay.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function Ge(e){return void 0===e||e<0?Ne:e}function qe(e){const t="default"===e?"gray":e;return(0,l().IS)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14,height:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.icon.secondary,width:14,height:14},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:F().Wy.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}function Xe(e){let{status:t,titleSize:o}=e;const n=o??14;return(0,l().IS)((e=>({warning:{color:"error"===t?e.errorText:e.accentColors.orange[400],height:"auto",width:n},invalidBadge:{backgroundColor:e.tint.uiRed,color:e.icon.uiRedPrimary},failingBadge:{backgroundColor:e.accentColors.yellow[50],color:e.accentColors.yellow[400]},pausedBadge:{backgroundColor:e.tint.regular,color:e.text.secondary},badgeContainer:{alignItems:"center",display:"flex",fontSize:10},icon:{width:10,height:10,marginRight:"4px"},slackPricingChangeBadgeStyle:{backgroundColor:e.tint.uiBlue,color:e.icon.uiBluePrimary},slackPricingChangeIcon:{width:10,height:10,marginRight:"4px",fill:e.blueColor}})),[t,n])}function $e(e){let{isMobile:t,shouldShowSlackPricingChangeBanner:o}=e;const n=Xe({});return o?(0,I.jsx)(Ee().A,{style:n.slackPricingChangeBadgeStyle,content:(0,I.jsxs)("div",{style:n.badgeContainer,children:[(0,pe().exclamationMarkCircleFillIcon)(n.slackPricingChangeIcon),!t&&(0,I.jsx)(E().sA,{defaultMessage:"Upgrade",id:"automationSummaryCard.slackPricingChangeBadge"})]})}):null}var Je=()=>o(644518),Qe=()=>o(752903),Ze=()=>o(599932),et=()=>o(465546),tt=()=>o(21164),ot=()=>o(409211),nt=()=>o(34662),it=()=>o(358780),at=()=>o(641383),rt=()=>o(916396),lt=()=>o(522313),st=()=>o(576992),ct=()=>o(350826),ut=()=>o(950065),dt=()=>o(724175),pt=()=>o(649571),mt=()=>o(533219),gt=()=>o(756567),yt=()=>o(123098),ht=()=>o(834508),ft=()=>o(275334),vt=()=>o(590467),xt=()=>o(265405),bt=()=>o(824678),St=()=>o(658722),Ct=()=>o(403321),At=()=>o(403172),kt=()=>o(92451),Mt=()=>o(413871);const jt=(0,E().YK)({automationSingleTargetDefault:{defaultMessage:"1 person",id:"database.viewSettings.automationTab.automationSingleTargetDefault"},recurrenceAutomationSummary:{defaultMessage:"Every {frequency}, {actions}",id:"automation.summaryCard.recurrenceCaption"}});function Tt(e){const{intl:t,triggerConfig:o}=e;if(o){if("event"===o.type){const n=function(e){const{collectionStore:t,environment:o,getRecordModel:n,intl:i,schema:a,typecheckResult:r,triggerConfig:l}=e,{event:s}=l,u=t.getSpaceId(),d=[];s.pagesAdded&&d.push(ft().CH(i));if("none"===s.pagePropertiesEdited.type);else if("any"===s.pagePropertiesEdited.type)d.push(ft().HG(i));else if("some"===s.pagePropertiesEdited.type||"all"===s.pagePropertiesEdited.type){let e=[];"all"===s.pagePropertiesEdited.type?e=s.pagePropertiesEdited.all??[]:"some"===s.pagePropertiesEdited.type&&(e=s.pagePropertiesEdited.some??[]);for(const l of e){const e=a[l.property];if(!e){d.push(ft().Pg(i));continue}if(!c().tj[e.type]){d.push((0,dt().cn)());continue}const{filter:s}=l;if("changes_to_any"===s.operator)d.push(ft().Od(i,{propertyName:e.name}));else if(p().fZ(s))d.push(ft().yR(i,{propertyName:e.name}));else if(c().nq(e))if("status"===e.type){if(!p().H$(s)||!p().gc(s)){d.push((0,vt().zQ)(e));continue}const t=p().V6(s),o=(0,ht().a)({intl:i,groupValues:t.map((e=>"is_group"===e.type?e.value:void 0)).filter(D().O9),isText:!0,optionValues:t.map((e=>"is_option"===e.type?e.value:void 0)).filter(D().O9),propertySchema:e,tokenFormat:Qe().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"});d.push(ft().Yx(i,{propertyName:e.name,propertyValues:n}))}else if("select"===e.type||"multi_select"===e.type){if(p().fZ(s)||!p().v0(s)&&!p().as(s)||"select"===e.type&&p().as(s)||"multi_select"===e.type&&p().v0(s)){d.push((0,vt().zQ)(e));continue}const t=Array.isArray(s.value)?s.value:[s.value],o=(0,yt().$5)({intl:i,isText:!0,optionValues:t.map((e=>e.value)).filter(D().O9),propertySchema:e,tokenFormat:Qe().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"}),a=(0,yt().l5)({filter:s,propertySchema:e});if(a){const t=(0,yt().JI)(a);d.push(t(i,{propertyName:e.name,propertyValues:n}))}}else if("checkbox"===e.type){if(!p().Ui(s)){d.push((0,vt().zQ)(e));continue}d.push((0,pt().Hk)({filter:s,propertySchema:e,intl:i}))}else if("person"===e.type){if(!p().I_(s)){d.push((0,vt().zQ)(e));continue}d.push((0,St().H)({actorModels:(0,gt().Y)(s,n),operator:s.operator,propertySchema:e,intl:i}))}else if("number"===e.type){if(!p().My(s)){d.push((0,vt().zQ)(e));continue}d.push((0,bt().VW)({messageType:"trigger",numberValue:s.value.value,operator:s.operator,propertySchema:e,intl:i}))}else if("email"===e.type||"url"===e.type||"text"===e.type||"phone_number"===e.type||"title"===e.type){if(!p().YH(s)){d.push((0,vt().zQ)(e));continue}"string_is"!==s.operator&&"string_is_not"!==s.operator&&"string_contains"!==s.operator&&"string_does_not_contain"!==s.operator&&"string_starts_with"!==s.operator&&"string_ends_with"!==s.operator||d.push((0,At().zl)({messageType:"trigger",textValue:s.value.value,operator:s.operator,propertySchema:e,intl:i}))}else if("relation"===e.type){if(!p().Pq(s)){d.push((0,vt().zQ)(e));continue}if(m().o2(u,e)){d.push((0,mt().Mh)({propertySchema:e}));continue}const n=(0,Ct().WE)({collectionStore:t,filter:s}),a=(0,Je().getAllContextValues)(r),l=(0,Ct().eg)({collectionStore:t,filter:s,propertySchema:e});d.push((0,Ct().oE)({availableTokens:l,collectionStore:t,environment:o,operator:s.operator,propertySchema:e,intl:i,relationPages:(0,Ct().Iq)({value:n.value,automationContextValues:a})}))}else(0,D().HB)(e)}}return i.formatList(d,{style:"long",type:"all"===s.pagePropertiesEdited.type?"conjunction":"disjunction"})}({...e,triggerConfig:o}),i=It(e);return t.formatMessage({defaultMessage:"When {triggers}, {actions}",id:"automation.summaryCard.caption"},{actions:i,triggers:n})}if("recurrence"===o.type){if(!o.recurrence)return;const n=(0,K().LS)({intl:t,recurrence:o.recurrence}),i=It(e);return t.formatMessage(jt.recurrenceAutomationSummary,{frequency:n,actions:i})}"button"!==o.type&&(0,D().HB)(o)}}function It(e){var t,o;const{actionStores:n,collectionStore:i,environment:a,intl:r,schema:l,typecheckResult:u}=e,d=[];for(const k of n)if(k.isType("slack_notification"))d.push((0,I.jsx)(E().sA,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,I.jsx)(it().D,{actionStore:k})}}));else if(k.isType("update_pages")){const e=k.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,n=null==e?void 0:e.target;if(!t||0===t.length||!n)continue;if("collection"===n.type)if((0,V().Z2)(n.collection,i.pointer))d.push((0,I.jsx)(E().sA,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=Mt().md.createChildStore(i,n.collection),t=(0,kt().tS)({environment:a,intl:r,store:e});d.push((0,I.jsx)(E().sA,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===n.type){const e=t[0],a=null==o?void 0:o[e],s=Dt({collectionSchema:l,propertyId:e,variableId:n.id,typecheckResult:u,actionStore:k});if(!s){d.push(ft().cC(r));continue}if(!a)continue;if(c().I3(s))if("person"===s.type)d.push((0,I.jsx)(Et,{collectionStore:i,contextValues:(0,Je().getAllContextValues)(u),propertyActionValue:a,propertySchema:s}));else if("status"===s.type){const e=(0,I.jsx)(wt,{propertyActionValue:a,propertySchema:s});e&&d.push(e)}else if("select"===s.type||"multi_select"===s.type)d.push((0,I.jsx)(_t,{propertyActionValue:a,propertySchema:s}));else if("checkbox"===s.type)d.push((0,I.jsx)(Pt,{propertyActionValue:a,propertySchema:s}));else if("relation"===s.type)d.push((0,I.jsx)(Bt,{collectionStore:i,propertyActionValue:a,propertySchema:s}));else if("date"===s.type){const t=(0,I.jsx)(Rt,{automationActionId:k.id,collectionStore:i,propertyActionValue:a,propertyId:e,propertySchema:s});t&&d.push(t)}else"number"===s.type||"phone_number"===s.type||"text"===s.type||"title"===s.type||"email"===s.type||"url"===s.type?d.push((0,I.jsx)(Vt,{automationActionId:k.id,propertyActionValue:a,propertySchema:s})):(0,D().HB)(s);else d.push((0,dt().cn)())}}else if(k.isType("create_page")){var p;const e=null===(p=k.getConfig())||void 0===p?void 0:p.collection;if(!e)continue;e.id===i.pointer.id?d.push((0,I.jsx)(E().sA,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):d.push((0,I.jsx)(E().sA,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(k.isType("define_variables")){var m;d.push((0,I.jsx)(E().sA,{defaultMessage:"define {numVariables} custom {numVariables, plural, one {variable} other {variables}}",values:{numVariables:(null===(m=k.getConfig())||void 0===m||null===(m=m.variableIds)||void 0===m?void 0:m.length)??0},id:"automation.summaryCard.defineVariables"}))}else if(k.isType("send_in_app_notification")){var g;const e=null===(g=k.getConfig())||void 0===g?void 0:g.target;if(!e)continue;const n=e.type;switch(n){case"formula":const a=(0,nt().Fbh)(null===(t=e.value)||void 0===t?void 0:t.value),l=(0,nt().kNd)(null===(o=e.value)||void 0===o?void 0:o.value),c=e=>{const t=k.getSpaceId()??"";return{table:ot().oo,id:e,spaceId:t}},u=a.map((e=>c(e))),p=u.map((e=>(0,s().xC)({getRecordModel:i.getRecordModel,pointer:e}))).filter(D().O9).map((e=>(0,s().lR)(r,e)));d.push((0,I.jsx)(E().sA,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:u.length+l.length,singleTarget:u.length>0?p[0]:Z().dC.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let m;const g=i.getSchema()[e.propertyId];m=g?g.name??Z().dC[g.type]:ft().CV.unknownPropertyTitle.defaultMessage,d.push((0,I.jsx)(E().sA,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:m},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,D().HB)(n)}}else if(k.isType("send_gmail_notification")){var y,h,f,v;const e=k.getConfig()??{},{to:t,cc:o,bcc:n}=e;if(null==t||null===(y=t.value)||void 0===y||!y.value)continue;if("formula"===(null==t||null===(h=t.value)||void 0===h?void 0:h.type)||"formula"===(null==o||null===(f=o.value)||void 0===f?void 0:f.type)||"formula"===(null==n||null===(v=n.value)||void 0===v?void 0:v.type))d.push((0,I.jsx)(E().sA,{defaultMessage:"send an email to recipients based on a formula",id:"automation.summaryCard.sendGmailNotificationUserFormulaTarget"}));else{var x,b,S,C,A;const e=[...null===(x=t.value)||void 0===x?void 0:x.value,...(null==o||null===(b=o.value)||void 0===b?void 0:b.value)||[],...(null==n||null===(S=n.value)||void 0===S?void 0:S.value)||[]],a=(0,nt().Fbh)(e),l=(0,nt().kNd)(null===(C=t.value)||void 0===C?void 0:C.value),c=(0,nt().IQD)(e),u=e=>{const t=k.getSpaceId()??"";return{table:ot().oo,id:e,spaceId:t}},p=a.map((e=>(0,s().xC)({getRecordModel:i.getRecordModel,pointer:u(e)}))).filter(D().O9).map((e=>(0,s().lR)(r,e))),m=(0,Ze().C3)((0,nt().k4p)(e));p.push(...m);const g=p[0]||(null===(A=c[0])||void 0===A?void 0:A.name)||r.formatMessage(jt.automationSingleTargetDefault);d.push((0,I.jsx)(E().sA,{defaultMessage:"{numTargets, plural, one {send an email to {singleTarget}} other {send an email to {numTargets} people}}",values:{numTargets:new Set(p).size+l.length+c.length,singleTarget:g},id:"automation.summaryCard.sendGmailNotificationUserTarget"}))}}else k.isType("http_request")&&d.push((0,I.jsx)(E().sA,{defaultMessage:"send a webhook",id:"automation.summaryCard.sendWebRequest"}));return r.formatList(d,{style:"long",type:"conjunction"})}function wt(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,E().tz)(),i=(0,ct().qC)({intl:n,propertySchema:o,value:t.value});return i||null}function _t(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,E().tz)();return(0,r().K8)((()=>(0,st().cI)({intl:n,limit:lt().S,propertySchema:o,operator:null==t?void 0:t.action,value:t.value})),[n,null==t?void 0:t.action,t.value,o])}function Pt(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,at().rD)({propertySchema:o,value:t.value})}function Bt(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,E().tz)(),l=(0,a().v3)(),{typecheckResult:s}=(0,z().EC)(),c=o.value,u=(0,Je().getAllContextValues)(s),d=(0,Ct().Iq)({automationContextValues:u,limit:n.limit,value:c});return(0,r().K8)((()=>(0,Ct().UW)({collectionStore:t,environment:l,intl:i,operator:null==o?void 0:o.action,propertySchema:n,relationPages:d,value:c})),[t,l,i,null==o?void 0:o.action,n,d,c])}function Rt(e){const{automationActionId:t,collectionStore:o,propertyActionValue:n,propertyId:a,propertySchema:l}=e,s=(0,E().tz)(),c=n.value,u=(0,xt().F)({actionId:t}),d=(0,i.useMemo)((()=>({type:"collection",collectionStore:o,property:a})),[o,a]),p=(0,r().K8)((()=>(0,rt().A)({intl:s,propertySchema:l,typecheckContextValues:u,value:c,valueContext:d})),[s,l,u,c,d]);return p||null}function Vt(e){const{automationActionId:t,propertyActionValue:o,propertySchema:n}=e,i=(0,a().v3)(),s=(0,l().DP)(),{automationStore:c}=(0,z().EC)(),u=(0,xt().F)({actionId:t}),d=(0,r().K8)((()=>(0,ut().hF)({automationStore:c,environment:i,propertySchema:n,theme:s,typecheckContextValues:u,value:o.value})),[c,i,o.value,n,s,u]);return d||null}function Et(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n,contextValues:i}=e,a=(0,E().tz)(),l=(0,r().K8)((()=>(0,St().hs)({getRecordModel:t.getRecordModel,contextValues:i,intl:a,operator:o.action,propertySchema:n,value:o.value})),[t.getRecordModel,a,o.action,o.value,n,i]);return l||null}function Dt(e){let{collectionSchema:t,propertyId:o,variableId:n,typecheckResult:i,actionStore:a}=e;const r=(0,et()._H)((0,Je().getAllContextValues)(i),n),l=r?(0,et().XZ)(r.type):void 0;let s=t;if(l&&l.table===tt().Vl){s=Mt().md.createChildStore(a,l).getSchema()}return s[o]}var Ft=()=>o(486826),Ot=()=>o(299924),Nt=()=>o(81322),Lt=()=>o(84543),Wt=()=>o(658388),zt=()=>o(206799),Kt=()=>o(951920);const Ht=(0,E().YK)({tryRepeatingTriggersTitle:{defaultMessage:"Try repeating triggers",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersTitle"},tryRepeatingTriggersBody:{defaultMessage:"Automatically create and edit items on a schedule",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersBody"},dismissButtonAriaLabel:{defaultMessage:"Close",id:"database.viewSettings.automationTab.automationWhatsNew.dismissButtonAriaLabel"},slackPricingChangeTitle:{defaultMessage:"Notice",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeTitle"},slackPricingChangeBody:{defaultMessage:"After August 13, 2025, Slack automations will only be available on the Plus tier and above.",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeBody"}}),Ut={try_repeating_triggers:{title:Ht.tryRepeatingTriggersTitle,body:Ht.tryRepeatingTriggersBody,url:"https://www.notion.com/help/database-automations#database-automation-triggers"},slack_pricing_change:{title:Ht.slackPricingChangeTitle,body:Ht.slackPricingChangeBody,url:"https://www.notion.com/help/database-automations"}};function Yt(e){let{collectionStoreId:t,surface:o,type:n}=e;const[s,c]=(0,i.useState)(!0),[u,d]=(0,Kt().B)(),p=(0,a().v3)(),m=(0,E().tz)(),g=(0,r().K8)((()=>{const{currentUserSettingsStore:e}=ie().default.state;if(!e||!e.isReady())return!1;const t=e.getSettingsStore().getKeyStore(`has_clicked_${n}_prompt`).getValue(),o=e.getSettingsStore().getKeyStore(`has_clicked_close_${n}_prompt`).getValue();if(t||o)return!1;const i=e.getSettingsStore().getKeyStore(`seen_${n}_prompt_at`).getValue();if((0,D().O9)(i)){const e=Ft().c9.fromMillis(i),t=Ft().c9.fromMillis(Ft().c9.now().toMillis()).diff(e,["weeks"]),o=t.toObject().weeks??0;return(0,D().O9)(t.toObject().weeks)&&o<=5}return Lt().createAndCommit({userAction:"AutomationsView.markPromptFirstSeen",environment:p,canUndo:!0,perform:t=>{Wt().mJ({userSettingsStore:e,transaction:t,data:{[`seen_${n}_prompt_at`]:Ft().c9.now().toMillis()}})}}),!0}),[p,n]),y=(0,l().IS)((e=>({button:{borderRadius:10,display:"flex",flexDirection:"column",position:"relative",background:e.tint.regular,padding:"9px 12px"},hoveredButton:{background:e.tint.primaryHover},pressedButton:{backgroundColor:e.tint.primaryPressed},title:{fontWeight:F().Wy.medium,fontSize:F().J.UIRegular.desktop,alignItems:"center",display:"flex",color:e.text.primary,lineHeight:"20px",flexDirection:"row",gap:"2px",marginBottom:6},description:{fontWeight:F().Wy.regular,color:e.text.secondary,fontSize:"14px",lineHeight:"20px"},dismissButton:{position:"absolute",right:6,top:6,borderRadius:4,display:"flex",height:20,justifyContent:"center",alignItems:"center",width:20,visibility:d?"visible":"hidden"},dismissIcon:{width:14,height:14,color:e.icon.secondary}})),[d]),h=(0,i.useCallback)((()=>{if(!t)return;(0,Q().u4)({environment:p,event:{eventName:"automation_learn_click",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:e}=ie().default.state;e&&e.isReady()&&Lt().createAndCommit({userAction:"AutomationsView.markPromptLinkClicked",environment:p,canUndo:!0,perform:t=>{Wt().mJ({userSettingsStore:e,transaction:t,data:{[`has_clicked_${n}_prompt`]:!0}})}})}),[t,n,o,p]),f=(0,i.useCallback)((e=>{if(e.preventDefault(),e.stopPropagation(),c(!1),!t)return;(0,Q().u4)({environment:p,event:{eventName:"automation_close_learn_prompt",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:i}=ie().default.state;i&&i.isReady()&&Lt().createAndCommit({userAction:"AutomationsView.markPromptDismissed",environment:p,canUndo:!0,perform:e=>{Wt().mJ({userSettingsStore:i,transaction:e,data:{[`has_clicked_close_${n}_prompt`]:!0}})}})}),[t,p,o,n]);return s&&g?(0,I.jsxs)(De().A,{style:y.button,hoveredStyle:y.hoveredButton,pressedStyle:y.pressedButton,ref:u,href:Ut[n].url,external:!0,onClick:h,children:[(0,I.jsxs)("div",{style:y.title,children:[(0,I.jsx)(E().sA,{...Ut[n].title}),(0,I.jsx)(zt().Q,{iconGroup:Ot().j,variantName:"mini",colorName:"secondary"})]}),(0,I.jsx)("div",{style:y.description,children:(0,I.jsx)(E().sA,{...Ut[n].body})}),(0,I.jsx)(Y().p,{size:"sm",style:y.dismissButton,onClick:f,"aria-label":m.formatMessage(Ht.dismissButtonAriaLabel),children:(0,Nt().V)(y.dismissIcon)})]}):null}const Gt=(0,E().YK)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically edit properties, create pages, send updates, and more",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentEditor:{defaultMessage:"You're a content editor. Content editors can edit pages, but you need full access to create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentEditor"},automationSearchPlaceholder:{defaultMessage:"Search automations…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"},automationInvalidPausedCaption:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"database.viewSettings.automationTab.automationInvalidPausedCaption"},automationInvalidActiveCaption:{defaultMessage:"Fix any errors or remove failing steps to prevent this automation from pausing on failure",id:"database.viewSettings.automationTab.automationInvalidActiveCaption"},automationRestartSuccessMessage:{defaultMessage:"Restarted automation successfully",id:"automations.buttonTrigger.restartSuccessMessage"}});function qt(e){const{collectionContextStore:t,collectionSettingsStore:o,fullHeight:s,tabSettings:c}=e,u=(0,a().v3)(),d=(0,E().tz)(),{isMobile:p}=(0,a().Y0)(),[m,g]=(0,i.useState)(""),y=(0,r().K8)((()=>t.collectionStore()),[t]),h=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),f=(0,r().K8)((()=>y&&y.id),[y]),v=(0,r().K8)((()=>null==y?void 0:y.getSchema()),[y]),x=(0,r().K8)((()=>null==y?void 0:y.getFormat()),[y]),b=(0,r().K8)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){const e=a.getModel();null!=e&&e.getAlive()&&(a.isDisplayableInCollectionSettings()&&i.push(a))}return i}({collectionStore:y,collectionViewBlockStore:h})),[y,h]),C=(0,r().K8)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:i}=e,a=new Map,r=[];for(const n of t){var l;if(!n.isDefined())continue;const e=[],t=n.getName();void 0!==t&&e.push(t);const s=null===(l=n.getOwnerStore())||void 0===l?void 0:l.getDisplayName(i);if(void 0!==s&&e.push(s),n.isTriggerType("event")){const t=n.getEventConfiguration(),a=null==t?void 0:t.pagePropertiesEdited;let r;if("some"===(null==a?void 0:a.type)?r=a.some:"all"===(null==a?void 0:a.type)&&(r=a.all),r)for(const n of r){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${Z().dC[t.type]}`)}const l=Zt(n.getActionStores(),o,i);e.push(...l)}else if(n.isTriggerType("recurrence")){const t=n.getRecurrence();t&&e.push((0,K().LS)({recurrence:t,intl:i,leadingPhrase:"every"}));const a=Zt(n.getActionStores(),o,i);e.push(...a)}const c=e.join(" ");a.set(n.id,c),r.push(c)}return function(e){const o=new Set(n().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((0,D().u0)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("recurrence"))return{false:e};const t=a.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:b,collectionSchema:v,intl:d})),[b,v,d]),k=(0,r().K8)((()=>C(m)),[C,m]),M=(0,r().K8)((()=>ee().rc({collectionStore:y})),[y]),j=(0,i.useCallback)((()=>{O().js({environment:u,collectionSettingsStore:o,collectionContextStore:t})}),[u,o,t]),T=(0,i.useCallback)((e=>g(e.target.value)),[]),w=(0,i.useCallback)((()=>{f&&(0,Q().u4)({environment:u,event:{eventName:"automation_learn_click",eventProperties:{collection_id:f}}})}),[u,f]);(0,i.useEffect)((()=>{f&&((0,Q().u4)({environment:u,event:{eventName:"automation_list_view",eventProperties:{source:c.source,collection_id:f}}}),re().default.logEvent("automation_list_view","true"))}),[u,f,c]);const[_,P]=i.useState(!1),B=(0,r().K8)((()=>function(e){var t;const o=null===(t=ie().default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&V().L3.isEqual(o,e)?n.push(a):i.push(a)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(k)),[k]),R=(0,i.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=B;return _?[...e,...t]:e.length>0?e:t}),[B,_]),F=k.length-R.length,N=!_&&F>0,L=R.length>0,W=!L&&!(""!==m),{currentSpaceStoreId:te,currentUserStoreId:se}=(0,r().K8)((()=>{var e,t;return{currentSpaceStoreId:null===(e=ie().default.state.currentSpaceStore)||void 0===e?void 0:e.id,currentUserStoreId:null===(t=ie().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),ce=(0,le().P9)({name:"premium_automations",spaceId:te,userId:se}),ue=(0,oe().X)("packaging_changes_05_13_2025"),de=(0,le()._X)({name:"slack_automation_action",spaceId:te,userId:se}),pe=(0,H().c)({automationStores:b,slackActionFeatureAvailability:de}),me=(0,r().K8)((()=>ee().rc({collectionStore:y})),[y]),ge=(0,r().O$)(ae().e),ye=ce&&me&&ge,he=(0,l().IS)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:p?0:12,paddingBlockStart:p?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:12,paddingInline:12},menuScrollerStyle:{marginBlockStart:p?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0},createSection:{paddingBlock:20},createButtonWrapper:{paddingInline:12},createButton:{width:"100%",display:"flex",gap:6},headerContainer:{alignItems:"center",display:"flex",gap:4},headerInfoIcon:{fill:e.mediumIconColor,height:14,width:14},whatsNewPrompt:{marginTop:8}})),[p]);return y&&v&&x&&h?(0,I.jsx)(U().Ay,{...e,fullHeight:s,header:!W&&(0,I.jsx)($().A,{children:(0,I.jsx)(G().Ay,{focusInitial:!p,onChange:T,placeholder:d.formatMessage(Gt.automationSearchPlaceholder),showClearButton:!0,value:m})}),footer:(0,I.jsx)($().A,{style:he.createSection,topBorder:!1,children:M&&(0,I.jsx)("div",{style:he.createButtonWrapper,children:(0,I.jsxs)(X().A,{style:he.createButton,onClick:j,disabled:!ge,children:[(0,A().W)({width:14,height:14}),(0,I.jsx)(E().sA,{...Gt.automationNewAutomationTitle})]})})}),menuScrollerStyle:he.menuScrollerStyle,title:L||m?(0,I.jsxs)("div",{style:he.headerContainer,children:[(0,I.jsx)(E().sA,{...Gt.automationTabTitle}),(0,I.jsx)(J().A,{placement:ne().W.Right,renderTooltip:()=>(0,I.jsx)(E().sA,{...Gt.automationLearnAutomationTitle}),render:e=>(0,I.jsx)(q().A,{...e,href:"https://www.notion.so/help/database-automations",external:!0,onClick:w,children:(0,S().$)(he.headerInfoIcon)})})]}):null,children:(0,I.jsx)("div",{style:he.wrap,children:W?(0,I.jsxs)("div",{style:he.emptyViewWrap,children:[(0,I.jsx)(Xt,{collectionStore:y}),ye&&(0,I.jsx)("div",{style:he.whatsNewPrompt,children:(0,I.jsx)(Yt,{surface:"empty_automations_view",type:"try_repeating_triggers",collectionStoreId:f})}),ue&&(0,I.jsx)("div",{style:he.whatsNewPrompt,children:(0,I.jsx)(Yt,{surface:"list_automations_view",type:"slack_pricing_change",collectionStoreId:f})})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{style:he.buttonList,children:[ye&&(0,I.jsx)("div",{style:he.whatsNewPrompt,children:(0,I.jsx)(Yt,{surface:"list_automations_view",type:"try_repeating_triggers",collectionStoreId:f})}),R.length>0?R.map(((e,n)=>(0,I.jsx)(z().or,{automationStore:e,children:(0,I.jsx)(Jt,{collectionContextStore:t,collectionStore:y,collectionSettingsStore:o,focused:!1,schema:v,shouldShowSlackPricingChangeBanner:pe})},e.id))):(0,I.jsx)("p",{style:he.noResultsTitle,children:(0,I.jsx)(E().sA,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})]}),N&&(0,I.jsx)(Y().p,{isGray:!0,size:"xs",style:he.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),P(!0)},children:(0,I.jsx)("div",{style:he.showMoreButtonContent,children:(0,I.jsx)(E().sA,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:F}})})})]})})}):null}function Xt(e){const{collectionStore:t}=e,o=(0,a().v3)(),n=(0,l().IS)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellowPrimary,height:24,width:24},title:{fontSize:17,fontWeight:F().Wy.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,r().K8)((()=>t.getRole()),[t]);let s;return s=(0,r().K8)((()=>Boolean((0,te().qb)(o,t))),[t,o])||!i||"editor"===i?Gt.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?Gt.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?Gt.automationEmptyViewContentEditor:Gt.automationEmptyViewEditorPublic,(0,I.jsxs)("div",{style:n.wrap,children:[(0,I.jsx)("div",{"aria-hidden":!0,children:(0,f().v)(n.icon)}),(0,I.jsx)("p",{style:n.title,children:(0,I.jsx)(E().sA,{...Gt.automationTabTitle})}),(0,I.jsx)("p",{style:n.copy,children:(0,I.jsx)(E().sA,{...s})})]})}const $t={text:B().U,number:o(611121).E,url:o(768219).I,file:o(250254).J,date:o(935248).Z,person:o(167089).M,email:o(237434).J,phone_number:o(137259).C,checkbox:o(277993).S,select:o(244812).n,multi_select:_().v,status:P().T,relation:o(403768).H,rollup:o(816062).h,formula:o(418908).n,created_time:M().w,created_by:j().E,title:o(836352).D,last_edited_time:M().w,last_edited_by:j().E,last_visited_time:M().w,button:P().T,auto_increment_id:o(799281).A,location:w,verification:o(822619).E,geo_point:w,ai_summary:o(735737).G,ai_custom_prompt:o(991888).x,ai_extract:_().v,ai_translate:o(817545).K,ai_keywords:o(748529).u};function Jt(e){const{collectionContextStore:t,collectionStore:o,collectionSettingsStore:n,focused:l,schema:u,shouldShowSlackPricingChangeBanner:d}=e,f=(0,E().tz)(),S=(0,a().v3)(),{automationStore:M}=(0,z().EC)(),{actionIcons:j,actionStores:T,canUserManageAutomation:w,canUserRemoveAutomation:_,isAutomationEnabled:P,isPersistedStateComplete:R,title:V,triggerConfig:F,triggerIcons:H}=function(e){let{collectionStore:t,schema:o}=e;const n=(0,E().tz)(),{automationStore:i,typecheckResult:a}=(0,z().EC)(),l=(0,r().K8)((()=>ee().Qn({automationStore:i,collectionStore:t,typecheckResult:a})),[i,t,a]),u=(0,r().K8)((()=>i.getActionStores()),[i]),d=(0,r().K8)((()=>i.getTriggerStore().getValue()),[i]),f=(0,r().K8)((()=>d?function(e){const{schema:t,triggerConfig:o,collectionStore:n}=e,i=[];if("event"===o.type){o.event.pagesAdded&&i.push({color:"blue",icon:A().W,type:"page"});const e=o.event.pagePropertiesEdited;if("any"===e.type)i.push({color:"blue",icon:C().r,type:"misc"});else if("some"===e.type||"all"===e.type){let o=[];"some"===e.type?o=e.some??[]:"all"===e.type&&(o=e.all??[]);for(const e of o){const o=t[e.property],a=e.filter;if(!o)continue;if(!c().tj[o.type]){i.push({color:"gray",icon:Qt(o.type),type:"property"});continue}const r=m().DD(o),l=m().lx(o),u=m().E(o),d=m().AM(o),y=(0,g().DY)(o.type),h=m().nC(o);if("changes_to_any"===a.operator)i.push({color:r||l?"gray":"blue",icon:Qt(o.type),type:"property"});else if(r&&!p().fZ(a)&&p().H$(a)){const e=p().V6(a);if(e.length>1)i.push({color:"gray",icon:Qt(o.type),type:"property"});else if(1===e.length){const t=e[0];if("is_group"===t.type){const e=(o.groups??[]).find((e=>e.name===t.value));e&&i.push({color:e.color??"gray",icon:Qt(o.type),type:"property"})}else{const e=(o.options??[]).find((e=>e.value===t.value));e&&i.push({color:e.color??"gray",icon:Qt(o.type),type:"property"})}}}else if(l&&(p().v0(a)||p().as(a))){const e=p().fZ(a)?[]:p().v0(a)?p().Zl(a):p().SM(a);if(1===e.length){const t=e[0],n=(o.options??[]).find((e=>e.value===t.value));n&&i.push({color:n.color??"gray",icon:Qt(o.type),type:"property"})}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:Qt(o.type),type:"property"})}else if(u&&p().I_(a)){const e=p().fZ(a)?[]:p().Wf(a);if(1===e.length){if(!p().fZ(a)){const e=p().Wf(a)[0];if("exact"===e.type&&e.value){const t=(0,s().xC)({pointer:e.value,getRecordValue:n.getRecordValue});i.push({actor:t,type:"person"})}}}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:Qt(o.type),type:"property"})}else(d&&p().My(a)||y&&p().YH(a)||h&&p().Pq(a))&&i.push({color:"is_empty"===a.operator?"gray":"blue",icon:Qt(o.type),type:"property"})}}}else"recurrence"===o.type?i.push({color:"blue",icon:v().k,type:"misc"}):"button"===o.type||(0,D().HB)(o);return i}({schema:o,triggerConfig:d,collectionStore:t}):[]),[o,d,t]),S=(0,r().K8)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const d of t)if(d.isType("slack_notification"))i.push({icon:k().z,type:"app"});else if(d.isType("update_pages")){const e=d.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var a,r;const u=t[0],d=n[u],p=null==e||null===(a=e.values)||void 0===a?void 0:a[u];if(!d||!p)continue;if(!c().I3(d)){i.push({color:"gray",icon:Qt(d.type),type:"property"});continue}const h=(0,y().fromSimpleFormulaArrayValue)(null===(r=p.value)||void 0===r?void 0:r.value);if(m().DD(d)){const e=(d.options||[]).find((e=>e.value===h[0]));e&&i.push({color:e.color??"gray",icon:Qt(d.type),type:"property"})}else if(m().lx(d))if(1===h.length){const e=(d.options||[]).find((e=>e.value===h[0]));e&&i.push({color:e.color??"gray",icon:Qt(d.type),type:"property"})}else h.length>1&&i.push({color:"gray",icon:Qt(d.type),type:"property"});else if(m().E(d)){var l;const e=(0,g().e5)({textValue:null===(l=p.value)||void 0===l?void 0:l.value,propertySchema:d,blockCreatorPointer:void 0}).map((e=>(0,s().xC)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:Qt(d.type),type:"property"})}else i.push({color:"gray",icon:Qt(d.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:C().r,type:"misc"})}else if(d.isType("create_page")){var u;(null===(u=d.getConfig())||void 0===u?void 0:u.collection)&&i.push({color:"blue",icon:A().W,type:"page"})}else d.isType("send_in_app_notification")?i.push({color:"blue",icon:h().r,type:"misc"}):d.isType("define_variables")?i.push({color:"gray",icon:B().U,type:"misc"}):d.isType("send_gmail_notification")?i.push({icon:b().Y,type:"app"}):d.isType("http_request")&&i.push({color:"gray",icon:e=>(0,x().B)({transform:"scale(1.35)",...e}),type:"misc"});return i}({actionStores:u,collectionStore:t,schema:o})),[o,t,u]),M=(0,r().K8)((()=>i.getNameWithDefault(n)),[n,i]),j=(0,r().K8)((()=>i.isActive()),[i]),T=(0,r().K8)((()=>ee().Gz({automationStore:i,collectionStore:t})),[i,t]),I=(0,r().K8)((()=>ee().TT({actionStores:u,automationStore:i,collectionStore:t})),[u,i,t]);return{isPersistedStateComplete:l,actionStores:u,triggerConfig:d,title:M,isAutomationEnabled:j,canUserManageAutomation:I,canUserRemoveAutomation:T,triggerIcons:f,actionIcons:S}}({collectionStore:o,schema:u}),U=function(e){let{isPersistedStateComplete:t,isAutomationEnabled:o,collectionStore:n}=e;const{automationStore:a,typecheckResult:l}=(0,z().EC)(),s=(0,r().K8)((()=>{if(a.isTriggerType("event")){return!a.getTrigger()||ee().l({automationStore:a,collectionStore:n})}return!1}),[a,n]),c=(0,i.useMemo)((()=>{if(l.error)return!0;const e=l.value.actionValidationFailures;return Object.values(e).flat().length>0}),[l]);return(0,r().K8)((()=>{var e,n;const i=null===(e=a.getModel())||void 0===e?void 0:e.getLastFailedTime(),r=null===(n=a.getModel())||void 0===n?void 0:n.getLastExecutedTime();return c||s||!t?"invalid":i&&r&&i>=r&&!o?"failing":o?"success":(0,K().NH)(a)?"expired":"paused"}),[a,c,s,t,o])}({collectionStore:o,isAutomationEnabled:P,isPersistedStateComplete:R}),{caption:Y,tooltipCaption:G}=function(e){let{actionStores:t,automationStatus:o,collectionStore:n,isAutomationEnabled:i,schema:l,triggerConfig:s}=e;const c=(0,a().v3)(),u=(0,E().tz)(),{automationStore:d,typecheckResult:p}=(0,z().EC)();return(0,r().K8)((()=>{const e=Tt({actionStores:t,collectionStore:n,environment:c,getRecordModel:d.getRecordModel,intl:u,schema:l,triggerConfig:s,typecheckResult:p});return{caption:e,tooltipCaption:"invalid"===o?(0,I.jsx)(E().sA,{...i?Gt.automationInvalidActiveCaption:Gt.automationInvalidPausedCaption}):e}}),[i,u,t,n,c,d.getRecordModel,l,s,p,o])}({actionStores:T,automationStatus:U,collectionStore:o,isAutomationEnabled:P,schema:u,triggerConfig:F}),q=(0,r().O$)(t.aliveAutomationCountStore),X=(0,i.useCallback)((async()=>{await se().lg({collectionStore:o,environment:S,existingAutomationStore:M,intl:f,onDelete:()=>{1===q&&O().R8({collectionSettingsStore:n,item:{type:"main"}})}})}),[f,S,o,n,M,q]),$=(0,i.useCallback)((()=>{se().WA({automationStore:M,environment:S})}),[S,M]),J=(0,i.useCallback)((()=>{L().h({environment:S,mode:"edit_automation",collectionSettingsStore:n,collectionContextStore:t,automationId:M.id,source:"collection_settings_automation_view"})}),[S,n,t,M]),Q=(0,i.useCallback)((()=>{se().HJ({automationStore:M,environment:S})}),[S,M]),Z=(0,i.useCallback)((()=>{se().vH({automationStore:M,collectionStore:o,environment:S})}),[M,o,S]),te=(0,i.useCallback)((()=>{if(!M.isTriggerType("recurrence"))return;se().be({automationStore:M,collectionStore:o,environment:S});const e=f.formatMessage(Gt.automationRestartSuccessMessage);N().D6({label:e})}),[M,o,S,f]),oe=(0,i.useCallback)((e=>(0,i.createElement)(Le,{...e,key:M.id,actions:j,caption:Y,focused:l,status:U,onClick:J,onDelete:_?X:void 0,onDisable:P&&_&&R?$:void 0,onRestart:"expired"===U?te:void 0,onDuplicate:w?Z:void 0,onEdit:w?J:void 0,onEnable:!P&&_&&R?Q:void 0,title:V,triggers:H,shouldShowSlackPricingChangeBanner:d})),[j,M.id,w,_,Y,l,U,P,R,X,$,Z,J,Q,te,V,H,d]);return(0,I.jsx)(W().P,{caption:G,renderOrigin:oe,title:V,tooltipAlignment:ne().C.Start,tooltipPlacement:ne().W.Left})}function Qt(e){return(0,D().O9)(e)?$t[e]??R().x:R().x}function Zt(e,t,o){const n=[];for(const a of e){const e=a.getType();if(e){const t=(0,u().getActionRegistryItem)(e);(0,d().qe)(t)&&n.push(o.formatMessage(t.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var i;const e=a.getConfig();null==e||null===(i=e.properties)||void 0===i||i.forEach((e=>{const o=null==t?void 0:t[e];o&&n.push(`${o.name} ${Z().dC[o.type]}`)}))}}return n}},888575:(e,t,o)=>{o.d(t,{A:()=>i});o(242343);var n=o(163643);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:a,style:r,inline:l}=e,s=(0,o(653998).tz)(),c=(0,o(237385).Y0)(),u=(0,o(803290).K8)((()=>null==t?void 0:t.getDisplayName(s)),[t,s]),{outerStyle:d,avatarWrapStyle:p,badgeStyle:m}=(0,o(174114).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...r},avatarWrapStyle:l?{width:"none",minHeight:"none",marginRight:6}:{marginRight:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:c.isMobile?11:9,lineHeight:c.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginLeft:8,marginTop:1}})),[r,l,c]);return(0,n.jsxs)("div",{style:d,children:[(0,n.jsx)("div",{style:p,children:(0,n.jsx)(o(951156).A,{botStore:t,size:i})}),(0,n.jsx)("div",{style:{...o(31448).RC},children:u}),a&&(0,n.jsx)("div",{style:m,children:"Bot"})]})}},890315:(e,t,o)=>{o.d(t,{j:()=>d});o(242343);var n=()=>o(174114),i=()=>o(653998),a=()=>o(31448),r=()=>o(421338),l=()=>o(209684),s=()=>o(271142),c=o(163643);const u=(0,i().YK)({automationRequiresSubscription:{defaultMessage:"To edit or run this automation, upgrade your plan.",id:"AutomationHeaderView.automationRequiresSubscription"},automationRequiresSubscriptionButton:{defaultMessage:"To edit or run this automation, upgrade your plan or remove any connected action steps.",id:"AutomationHeaderView.automationRequiresSubscriptionButton"},automationRequiresSubscriptionTitle:{defaultMessage:"Upgrade to use connected actions",id:"AutomationHeaderView.automationRequiresSubscriptionTitle"},automationRequiresSubscriptionUpgradeButton:{defaultMessage:"Upgrade",id:"AutomationHeaderView.automationRequiresSubscriptionUpgradeButton"}});function d(e){const{onUpsellClick:t}=e,{contextType:o}=(0,s().EC)(),d="button_block"===o||"button_property"===o,p=d?u.automationRequiresSubscriptionButton:u.automationRequiresSubscription,m=(0,n().IS)((e=>({wrap:{fontSize:14,background:e.surface.wash,border:`1px solid ${e.surface.wash}`,borderRadius:6,padding:12,marginBottom:12},button:{fontWeight:a().Wy.medium,borderRadius:6,border:`1px solid ${e.stroke.primary}`,alignSelf:"flex-start"},title:{color:e.text.primary,fontWeight:a().Wy.medium,margin:0},text:{color:e.text.secondary,margin:0}})),[]);return(0,c.jsxs)(r().Y1,{direction:"vertical",gap:4,style:m.wrap,children:[d&&(0,c.jsx)("p",{style:m.title,children:(0,c.jsx)(i().sA,{...u.automationRequiresSubscriptionTitle})}),(0,c.jsx)("p",{style:m.text,children:(0,c.jsx)(i().sA,{...p})}),(0,c.jsx)(l().p,{onClick:t,style:m.button,children:(0,c.jsx)(i().sA,{...u.automationRequiresSubscriptionUpgradeButton})})]})}},891467:(e,t,o)=>{o.d(t,{p:()=>S});var n=o(242343),i=()=>o(237385),a=()=>o(174114),r=()=>o(711361),l=()=>o(827744),s=()=>o(653998),c=()=>o(220413),u=()=>o(85706),d=()=>o(907721),p=()=>o(286555),m=()=>o(413871),g=()=>o(126451),y=()=>o(273520),h=()=>o(356813),f=()=>o(288577),v=()=>o(40357),x=()=>o(410090),b=o(163643);function S(e){const{height:t,padding:o,padding_top:S,iframe_url:C,hoverData:A,store:k,token:M,href:j,onDismiss:T}=e,I=(0,s().YK)({editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),w=(0,i().v3)(),_=(0,s().tz)(),P=(0,n.useRef)(null),B=(0,a().IS)((e=>({content:{width:340,height:"100%",aspectRatio:"auto",position:"relative"},container:{width:340,maxHeight:420,flexDirection:"column",alignItems:"flex-start"},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.lightIconColor,background:(0,x().FF)(w)}})),[w]),R=k&&k.recordStoreUIParentStore&&k.recordStoreUIParentStore instanceof m().Bv?k.recordStoreUIParentStore:k instanceof m().Bv?k:void 0;return(0,b.jsxs)("div",{style:B.container,children:[e.showEditButton&&(0,b.jsx)(h().A,{onClick:e.handleEditClick,icon:l().r,isDarkIconColor:!0,ariaLabel:_.formatMessage(I.editLink),hasBackground:!0,style:{position:"absolute",top:8,right:8,zIndex:1}}),M&&R&&A&&(0,b.jsx)("div",{style:{position:"absolute",top:8,right:8,zIndex:2},children:(0,b.jsx)(y().Ay,{popupType:y().z7.Popup,placementToOrigin:d().W.Right,alignmentToOrigin:d().C.Start,originGap:4,onClose:()=>{let e=!1;const t=P.current;t&&(e=(0,p().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==T||T()},renderOrigin:e=>(0,b.jsx)(g().A,{style:B.buttonStyle,...e,children:(0,r()._)({width:14,fill:c().Ay.white})}),render:e=>(0,b.jsx)(v().A,{parentBlockStore:R,store:k,token:M,href:j,hoverData:A,onAccept:()=>e.close()})})}),(0,b.jsx)(f().A,{source:C,style:B.content,preserveScale:!!(t&&t<1||o),background:!1,height:t&&t>0?t:void 0,aspectRatio:o?o/100:.75,paddingTop:S||void 0})]})}},903823:(e,t,o)=>{o.d(t,{Y:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("gmailLogo",{viewBox:"52 42 88 66",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fill:"#4285f4",d:"M58 108h14V74L52 59v43c0 3.32 2.69 6 6 6"}),(0,n.jsx)("path",{fill:"#34a853",d:"M120 108h14c3.32 0 6-2.69 6-6V59l-20 15"}),(0,n.jsx)("path",{fill:"#fbbc04",d:"M120 48v26l20-15v-8c0-7.42-8.47-11.65-14.4-7.2"}),(0,n.jsx)("path",{fill:"#ea4335",d:"M72 74V48l24 18 24-18v26L96 92"}),(0,n.jsx)("path",{fill:"#c5221f",d:"M52 51v8l20 15V48l-5.6-4.2c-5.94-4.45-14.4-.22-14.4 7.2"})]})})},904850:(e,t,o)=>{o.d(t,{B:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("codeFile",{viewBox:"0 0 23 24",svg:(0,n.jsx)("path",{d:"M4.195 11.86c0-.266.078-.488.235-.665.156-.182.38-.3.672-.351.494-.089.849-.271 1.062-.547.214-.281.32-.73.32-1.344V6.961c0-1.115.263-1.938.79-2.469.525-.536 1.333-.804 2.421-.804.203 0 .375.023.516.07.177.057.31.146.398.265a.646.646 0 01.141.422c0 .339-.148.558-.445.657a1.14 1.14 0 01-.157.039l-.171.015c-.625.047-1.066.222-1.32.524-.256.302-.384.8-.384 1.492v2.414c0 .672-.182 1.198-.546 1.578-.36.38-.86.604-1.5.672-.032 0-.047.013-.047.039.005.02.02.034.047.04.64.062 1.14.283 1.5.663.364.38.546.906.546 1.578v2.414c0 .693.128 1.19.383 1.492.255.303.696.48 1.32.532.053 0 .1.002.141.008l.133.03c.333.09.5.308.5.657a.68.68 0 01-.14.43.816.816 0 01-.407.273 1.48 1.48 0 01-.437.063c-1.12 0-1.948-.266-2.485-.797-.531-.526-.797-1.352-.797-2.477V14.79c0-.614-.106-1.062-.32-1.344-.213-.28-.568-.463-1.062-.547-.292-.062-.516-.182-.672-.359-.157-.177-.235-.404-.235-.68zm15.602 0c0 .275-.078.502-.235.68-.156.176-.382.296-.68.358-.5.084-.856.266-1.07.547-.208.282-.312.73-.312 1.344v1.992c0 1.125-.266 1.95-.797 2.477-.531.531-1.36.797-2.484.797-.151 0-.297-.021-.438-.063a.757.757 0 01-.414-.265.715.715 0 01-.133-.438c0-.182.042-.328.125-.437a.674.674 0 01.383-.22l.117-.03c.047-.006.097-.008.149-.008.625-.052 1.065-.23 1.32-.532.255-.302.383-.799.383-1.492v-2.414c0-.672.182-1.208.547-1.61.364-.405.864-.616 1.5-.632.026-.005.039-.018.039-.039 0-.026-.013-.04-.04-.04-.635-.015-1.135-.226-1.5-.632-.364-.406-.546-.945-.546-1.617V7.172c0-.693-.128-1.193-.383-1.5-.255-.307-.695-.48-1.32-.516l-.18-.015a1.233 1.233 0 01-.148-.04c-.297-.109-.446-.328-.446-.656 0-.166.045-.307.133-.422a.777.777 0 01.414-.265c.14-.047.31-.07.508-.07 1.089 0 1.896.268 2.422.804.526.531.789 1.354.789 2.469v1.992c0 .615.107 1.06.32 1.336.214.276.568.461 1.063.555.297.052.523.169.68.351a.967.967 0 01.234.664z"})})},906384:(e,t,o)=>{o.d(t,{Me:()=>l,Vv:()=>i,Z3:()=>a,wI:()=>r});var n=()=>o(486826);function i(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function a(e){const{currentSprintEndDate:t,sprintSchedule:o}=e;return s({startDate:u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!0}),duration:o.duration})}function r(e){const{userTimeZone:t,sprintSchedule:o}=e;return s({startDate:n().c9.local({zone:t}),duration:o.duration})}function l(e){const{currentSprintStartDate:t,sprintSchedule:o}=e,i=u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!1}),{end_date:a}=s({startDate:i,duration:o.duration});let r=n().c9.fromISO(a);const l=n().c9.now().startOf("day");for(;r.diff(l,"days").days<0;)r=r.plus({weeks:1});return{type:"daterange",start_date:r.plus({days:1}).minus({weeks:o.duration}).toISODate(),end_date:r.toISODate()}}function s(e){const{startDate:t,duration:o}=e,n=t.plus({weeks:o}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:n.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function u(e){const{dateToAdjust:t,weekday:o,wrapForEqualDays:n}=e,i=d({currentWeekday:t.weekday%7,nextWeekday:c[o],wrapForEqualDays:n});return t.plus({days:i})}function d(e){const{currentWeekday:t,nextWeekday:o,wrapForEqualDays:n}=e,i="number"==typeof t?t:c[t],a="number"==typeof o?o:c[o];if(i===a)return n?7:0;let r=i,l=0;for(;r!==a;)r===c.SA?r=0:r+=1,l+=1;return l}},910341:(e,t,o)=>{o.r(t),o.d(t,{AutomationWorkflowEditor:()=>aa,AutomationWorkflowEditorActionSection:()=>Zi,ButtonBlockUrlPreviewPopup:()=>ya,PlacedButtonBlockEditor:()=>la,automationActions:()=>i(),automationErrorHelpers:()=>ie(),automationExecutionActions:()=>n});var n={};o.r(n),o.d(n,{executeClientAutomation:()=>ne});var i=()=>o(56432),a=(o(362833),o(333225),o(494367),o(516262),o(573119),o(240480),o(950443),o(619601),o(725707),o(107652),o(491955),o(403517),()=>o(268163)),r=()=>o(975392),l=()=>o(204132),s=()=>o(76394),c=()=>o(232312),u=()=>o(150992),d=()=>o(355149);const p=(0,c().kB)((async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n,automationModel:i,contextType:a,runtimeStats:p}=t;let g=t.values;const y=performance.now();let h,f={value:{success:!0}};if("button_block"===a||"button_property"===a){if(!i.isButtonType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else if("event"===a){if(!i.isEventType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else if("recurrence"===a){if(!i.isRecurrenceType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else(0,s().HB)(t);if(l().Q.isFail(h))return h;g=g.concat((0,r().o8)(h.value.values));const v=o??m;for(const r of n){var x;const e=await v({action:r,values:g,executionContext:t}),o=null==p||null===(x=p.actionStats)||void 0===x||null===(x=x[r.id])||void 0===x?void 0:x.executionDurationMs;if((0,s().O9)(o)&&o>7e3&&t.executeEffectMap.logMessage({from:"executeAutomation",level:"warning",type:"longRunningAutomationAction",data:{durationMs:o,automationId:i.id,actionId:r.id,actionType:r.getType()}}),l().Q.isFail(e)){f=e;break}if(g=g.concat(e.value.values),e.value.stopExecution)break}const b=await t.executeEffectMap.updateLastRunTimesForObservability({automationModel:t.automationModel,executeResult:f});l().Q.isFail(b)&&(f=b);const S=Math.trunc(performance.now()-y);p&&(p.executionStartTime=y,p.executionDurationMs=S,p.executionSuccess=l().Q.isSuccess(f),u().hs.aggregate(p));return f}),(e=>e.context.automationModel.id));async function m(e){const{action:t,values:o,executionContext:n}=e,i=(0,a().getActionRegistryItem)(t.getType());return i.requiresPriorTransactionsCommitted&&await n.executeEffectMap.waitForTransactionsCommitted(),await i.execute({...n,values:o},t)}var g=()=>o(807912),y=()=>o(34662),h=()=>o(903012);var f=()=>o(753123),v=()=>o(502140),x=()=>o(427091),b=()=>o(947307),S=()=>o(409211),C=()=>o(3311),A=()=>o(399309),k=()=>o(575015),M=()=>o(236907),j=()=>o(73631),T=()=>o(137476),I=()=>o(213517),w=()=>o(477784),_=()=>o(836331),P=()=>o(764227),B=()=>o(196387);const R={...u().hs,logNotionPerformance(e){const{automationStats:t,environment:o}=e;if((0,u().oh)(t)){var n;const e={metricName:"automation.client.execution_duration_ms",startTime:t.executionStartTime,endTime:t.executionStartTime+t.executionDurationMs};B().default.DO_NOT_USE_measureLegacy(e,{environment:o,data:{success:t.executionSuccess,has_formulas:((null===(n=t.formulaStats)||void 0===n?void 0:n.totalFormulas)??0)>0}})}for(const a of Object.values(t.actionStats))if((0,u().WV)(a)){var i;const e={metricName:"automation.client.action_execution_duration_ms",startTime:a.executionStartTime,endTime:a.executionStartTime+a.executionDurationMs};B().default.DO_NOT_USE_measureLegacy(e,{data:{automation_action_type:a.actionType,success:a.executionSuccess,has_formulas:((null===(i=a.formulaStats)||void 0===i?void 0:i.totalFormulas)??0)>0},environment:o})}}};var V=()=>o(65866),E=()=>o(653998);const D=(0,E().YK)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),F=["sprint","task","project","page"],O={[V().Tw]:"project",[V().dC]:"task",[V().yH]:"page",[V().TC]:"page",[V().av]:"sprint",[V().pW]:"page",[V().BF]:"page",[V().wZ]:"page",[V().CO]:"page",[V().SC]:"page",[V().Qk]:"page"};function N(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const a of F){const e=t[a];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:a,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:a,modificationType:"updated",numPagesModified:o})}}const i=n.slice(0,L).map(((e,t)=>{let{pageType:n,modificationType:i,numPagesModified:a}=e;const r=W[n][i],l=0===t?r.start:r.append;return o.formatMessage(l,{numPagesModified:a})}));if(i.length>0)return o.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return i||(o>0?n.formatMessage(D.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(D.genericSuccessMessage))}const L=3;const W={sprint:{created:{start:D.createdSprintsUppercase,append:D.createdSprintsLowercase},updated:{start:D.updatedSprintsUppercase,append:D.updatedSprintsLowercase}},task:{created:{start:D.createdTasksUppercase,append:D.createdTasksLowercase},updated:{start:D.updatedTasksUppercase,append:D.updatedTasksLowercase}},project:{created:{start:D.createdProjectsUppercase,append:D.createdProjectsLowercase},updated:{start:D.updatedProjectsUppercase,append:D.updatedProjectsLowercase}},page:{created:{start:D.createdPagesUppercase,append:D.createdPagesLowercase},updated:{start:D.updatedPagesUppercase,append:D.updatedPagesLowercase}}};var z=()=>o(145017),K=()=>o(413871);o(358848),o(91270);var H=()=>o(752597),U=()=>o(712437),Y=()=>o(582226),G=()=>o(23371),q=()=>o(818369),X=()=>o(759625),$=()=>o(865226),J=()=>o(360378),Q=()=>o(84543),Z=()=>o(29869),ee=()=>o(485966),te=()=>o(975579);class oe{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.transactionServerCommitResults=[],this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.waitForTransactionsCommitted=async()=>{await Promise.all(this.transactionServerCommitResults),this.transactionServerCommitResults=[]},this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new(c().WY)({actionId:e.actionId,pointer:e.pointer})}},this.logMessage=e=>{v().log(e)},this.incrementMetric=()=>{},this.queryCollection=async e=>{const t=await o(284208).mA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return l().Q.isFail(t)?{error:new(c().rl)({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const{info:t,operations:n}=e,i=[];if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of n)if((0,o(73751).ph)(t)){const o=K().Bv.createChildStore(this.clientContext.parentRecordStore,t.pointer);Q().applyCrdtTextOperation({store:o,operation:t,invertedOperation:void 0,transaction:e})}else if((0,Y().$Y)(t)||(0,Y().mP)(t)){const o=(0,K().Oo)(this.clientContext.parentRecordStore,t.pointer);Q().applyOperation({store:o,operation:t,transaction:e})}else(0,s().HB)(t);i.push(e.id)}}),this.saveTransactionInfos.push(t),"create_page"===t.type)o(197881).v(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:t.pageId,creating_block_id:t.pageId});else if("update_pages"===t.type){const{editedProperties:e,pageIds:n}=t;for(const t of n)for(const{id:n,type:i}of e)(0,o(160620).u)(this.environment,{block_id:t,property:n,property_type:i,from:"button_automation",automation_id:this.automationModel.id},!1)}else"publish_site"===t.type||(0,s().HB)(t);return Promise.resolve({value:{stats:{totalOperations:n.length,transactionIds:i}}})},this.navigateToPage=e=>{const t=ee().default.state.mainEditorCurrentBlockStore;if(!t)return;const n=K().Bv.createChildStore(t,e.page),i="full_page"===e.openIn?(0,Z().Ay)({store:n,fullyQualified:!1,pageVisitSource:U().y8.ButtonAutomation}):(0,Z().Ay)({store:t,peekViewBlockId:n.id,peekMode:(0,o(141122).getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:U().y8.ButtonAutomation});$().oo({environment:this.environment,url:i})},this.openUrl=e=>{$().oo({environment:this.environment,url:e.url,openInNew:"tab"})},this.sendSlackNotification=async e=>{const{action:t,customMessage:o}=e;return(0,T().u4)({environment:this.environment,event:{eventName:"button_automation_slack_action",eventProperties:{type:this.clientContext.type}}}),this.executeServerSideEffect({effect:"send_slack_notification",actionPointer:t.pointer,contextType:this.clientContext.type,args:{custom_message:o}})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new(c().g7)({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};const i={};let a,r=t;if("before"===e.insertionPoint)a=!0;else if("after"===e.insertionPoint)a=!1;else if("topOfPage"===e.insertionPoint){let e;if(a=!0,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(z().ev)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c()._r)("invalid_record","Missing page store in client context for top of page insertion")};r=e.getContentStores().at(0)||t}else if("bottomOfPage"===e.insertionPoint){let e;if(a=!1,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(z().ev)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c()._r)("invalid_record","Missing page store in client context for bottom of page insertion")};r=e.getContentStores().at(-1)||t}else(0,s().HB)(e.insertionPoint);const l=K().Bv.createChildStore(n,e.blockPointer);await l.load();const u=l.getContentStores();a||u.reverse();const d=o(37394).T.findSelectableFromStore(r),p=[],m=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>{const t=u.map((t=>{const{blockStores:n,onComplete:i}=o(425447).duplicateBlock({environment:this.environment,stores:[t],transaction:e,targetSpaceId:(0,o(66460).e)(t.pointer.spaceId),preferDuplicateLocation:"local",analyticsFrom:"button_automation",options:{addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0}}),r=n[0];return d&&(a?d.props.onInsertAbove&&p.push(d.props.onInsertAbove({insertStores:[r],transaction:e})[0]):d.props.onInsertBelow&&p.push(d.props.onInsertBelow({insertStores:[r],transaction:e})[0])),{copy:r,onComplete:i}}));return R.aggregateActionStats(i,{transactionIds:[e.id]}),t}}).performResult;return a||p.reverse(),J().td({environment:this.environment,stores:p}),await G().lX(m,10,(e=>e.onComplete)),H().default.afterNextFlush((()=>{for(const e of p){if(o(878171).Il({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=p.length,R.aggregateActionStats(i,{blocksCreated:this.getNumBlocksDuplicated()}),{value:{stats:i}}},this.displayModal=async e=>{te().A.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await te().A.waitUntil((()=>!te().A.state.open));const t=te().A.state;let o;return t.open||(o=t.result),o=o??"continue",{value:{result:o}}},this.initializeTemplateInDatabase=async e=>{const t=this.clientContext.parentRecordStore,n={},i=K().Bv.createChildStore(t,{table:z().ev,id:e.templateId});await i.load();const a=K().md.createChildStore(t,e.collection),r=(0,o(754697).Z1)({environment:this.environment,table:z().ev,spaceId:a.pointer.spaceId}),{performResult:l}=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:l=>{const s=X().Wv({environment:this.environment,transaction:l,inMemoryRecordCache:t.inMemoryRecordCache,type:o(762847).xd.page,id:r});return o(795394).X$({parentStore:a,childStore:s,transaction:l}),o(373122).n5({environment:this.environment,store:s,transaction:l,templateStore:i,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),o(960442).L({environment:this.environment,store:s,properties:e.propertyUpdates,transaction:l}),R.aggregateActionStats(n,{transactionIds:[l.id]}),s}});return this.saveTransactionInfos.push({type:"create_page",pageId:r,collection:e.collection}),await l.load(),l.isDefined()?{value:{pageId:r,pageModel:l.getModel(),stats:n}}:{error:new(c().WY)({actionId:e.actionId,pointer:l.pointer})}},this.sendInAppNotification=async e=>{const{actionPointer:t,targets:o,message:n,pagePointer:i}=e;return this.executeServerSideEffect({effect:"send_in_app_notification",actionPointer:t,contextType:this.clientContext.type,args:{targets:o,message:n,pagePointer:i}})},this.sendGmailNotification=async e=>{var t;const{action:o,to:n,cc:i,bcc:a,replyTo:r,fromName:l,subject:s,body:c}=e,u="button_block"===this.clientContext.type||"button_property"===this.clientContext.type?null===(t=this.clientContext.pageStore)||void 0===t?void 0:t.pointer:void 0;return this.executeServerSideEffect({effect:"send_gmail_notification",actionPointer:o.pointer,contextType:this.clientContext.type,args:{bcc:a,body:c,cc:i,fromName:l,pagePointer:u,replyTo:r,subject:s,to:n}})},this.updateLastRunTimesForObservability=async e=>{const{automationModel:t,executeResult:o}=e,n=this.clientContext.parentRecordStore,i=K().dn.createChildStore(n,t.pointer);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.updateLastRunTimesForObservability",environment:this.environment,skipUpdatingEditedMetadata:!0,perform:e=>{const t=Date.now();X().zv({data:{last_executed_time:t},store:i,transaction:e}),l().Q.isFail(o)&&X().zv({data:{last_failed_time:t},store:i,transaction:e})}}),Promise.resolve({value:void 0})},this.sendHttpRequest=async e=>{const{action:t,pagePointer:o,eventId:n}=e;return this.executeServerSideEffect({effect:"send_http_request",actionPointer:t.pointer,contextType:this.clientContext.type,args:{pagePointer:o,eventId:n}})},this.executeServerSideEffect=async e=>{const t=await q().callApi({eventName:"executeAutomationActionEffect",environment:this.environment,headers:{},data:e});return"failed"===t.type?{error:new(c().PD)({actionId:e.actionPointer.id,message:"Failure in execution of the executeAutomationActionEffect endpoint",cause:t.error})}:t.data},this.sleepForJitter=async e=>{await(0,G().wR)(e)},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${o(214144).JW()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){const t=Q().createAndCommit({...e,undoCheckpoint:this.undoCheckpointName,canUndo:!0});return this.transactionServerCommitResults.push(t.serverCommitResult),t}}async function ne(e){var t,o;const{clientContext:n,environment:r,onUndo:c}=e,u=await j().T.formulas.load(),d=await j().T.simpleFormulas.load();await n.automationStore.load();const m=n.automationStore.getModel();if(!m||!m.isButtonType()&&!m.isRecurrenceType())return;const B=m.spaceId,V=n.automationStore.getActionStores().map((e=>e.getModel())).filter(s().O9),E=m.getTriggerType(),D="button_block"===n.type?n.blockStore.id:"button_property"===n.type?null===(t=n.pageStore)||void 0===t?void 0:t.id:"recurrence"===n.type?void 0:(0,s().HB)(n),F=(0,P().AI)();(0,T().u4)({environment:r,event:{eventName:"automation_triggered",eventProperties:{actions:V.map((e=>e.getType())),automation_id:m.id,block_id:D,context_type:n.type,space_id:B,subscription_tier:F,trigger:E}}});const L=new oe({automationModel:m,clientContext:n,environment:r}),W=(0,f().MC)({collectionFeatureGates:(0,I().i)(),experimentService:_().default,getRecordModel:n.parentRecordStore.getRecordModel,loadRecordModel:n.parentRecordStore.loadRecordModel}),H=_().default.getConfigKey("automation_settings","client_formula_timeout_ms"),U=r.currentUser.id?{id:r.currentUser.id,table:S().oo}:void 0,Y="recurrence"!==n.type?null===(o=n.pageStore)||void 0===o?void 0:o.getModel():void 0,G=[];if("recurrence"===n.type&&"completeSprint"===n.recurrence.type){const{values:e}=function(e){const{nextSprintDateRange:t,completeSprintActionType:o}=e;return{values:[{kind:g().FormulaContextValueKind.ContextValue,id:h().GF,value:{type:"date",value:t}},{kind:g().FormulaContextValueKind.ContextValue,id:h().uM,value:{type:"text",value:(0,y().x9d)(o)}}]}}({completeSprintActionType:n.recurrence.completeSprintActionType,nextSprintDateRange:n.recurrence.nextSprintDateRange});G.push(...e)}const q=R.create(m.pointer,"client"),X={author:U,automationModel:m,actionModels:V,contextType:n.type,formulaVariableResolution:{executingUserPointer:U,executingUserTimeZone:(0,x().P)(),thisPageBlockModel:Y},values:G,executeEffectMap:L,executeContextualFormula:async(e,t)=>{if(!t)return{value:{type:"undefined"}};const o=Date.now()+H;return await u.executeFormulaAsync(t,{...e,depth:0,throwOnDownstreamParseFailures:!0,handleDataRequest:W,intl:n.intl,resultCache:new Map,regExpCache:new Map,userTimeZone:(0,x().P)(),visitedProperties:new Set,formulaTimeoutTimestampMs:o,experimentService:_().default,spaceId:B})},formulasModule:u,handleDataRequest:W,loadRecordModel:n.parentRecordStore.loadRecordModel,makeGetRecordModelFn:async e=>Promise.resolve(n.parentRecordStore.getRecordModel),userTimeZone:(0,x().P)(),intl:n.intl,depth:0,throwOnDownstreamParseFailures:!0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,eventTracker:(0,T().ik)(r),runtimeRecordPointerSet:new(b().d),runtimeStats:q,spaceIdCreator:await r.idCreator.getSpaceIdCreator(B),simpleFormulasModule:d,useCrdtDefault:(0,M().D8)(n.automationStore.getSpaceStore()),experimentService:_().default,collectionFeatureGates:(0,I().i)(),spaceId:B,eventId:(0,C().Ay)()},$=await p({context:X});R.logNotionPerformance({automationStats:q,environment:r});const J={automationContextType:n.type,automationId:m.id,automationRuntime:q,spaceId:B,userId:null==U?void 0:U.id};if(l().Q.isFail($)){const{error:e}=$;0,v().log({actor:U,data:J,error:e,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,T().u4)({environment:r,event:{eventName:"automation_execution_fail",eventProperties:{automation_id:m.id,block_id:D,context_type:n.type,error_type:e.type,execution_duration_ms:q.executionDurationMs,subscription_tier:F,trigger:E}}});const t=function(e){if("query_collection_too_many_items"===e.type)return i().messages.errorQueryCollectionTooManyPages;if("record_pointer_in_trash"===e.type)return i().messages.errorRecordInTrash;return i().messages.genericErrorMessage}(e),o=w().A.formatMessage(t);k().D6({label:o})}else(0,T().u4)({environment:r,event:{eventName:"automation_execution_success",eventProperties:{automation_id:m.id,block_id:D,context_type:n.type,execution_duration_ms:q.executionDurationMs,subscription_tier:F,trigger:E}}}),v().log({actor:U,data:J,from:"automationActions",level:"info",type:"AutomationExecutionSuccess"}),function(e){return!e.every((e=>!(0,a().getActionRegistryItem)(e.type).hasSideEffects))}(V)&&await async function(e){const{actionModels:t,environment:o,saveTransactionInfos:n,clientContext:i,undoCheckpointName:r,numBlocksDuplicated:l,onUndo:c}=e,u=function(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={},i=new Set;for(const u of t)if("create_page"===u.type){var a,r;if(i.has(u.pageId))continue;const e=K().md.createChildStore(o,u.collection).getDatabaseType(),t=(e&&O[e])??"page",l=(null===(a=n[t])||void 0===a?void 0:a.numPagesEdited)??0,s=(null===(r=n[t])||void 0===r?void 0:r.numPagesCreated)??0;n[t]={numPagesCreated:s+1,numPagesEdited:l},i.add(u.pageId)}else if("update_pages"===u.type){var l,c;const e=K().md.createChildStore(o,u.collection).getDatabaseType(),t=(e&&O[e])??"page",i=(null===(l=n[t])||void 0===l?void 0:l.numPagesEdited)??0,a=(null===(c=n[t])||void 0===c?void 0:c.numPagesCreated)??0;n[t]={numPagesCreated:a,numPagesEdited:i+u.pageIds.length}}else"publish_site"===u.type?n.page={numPagesCreated:0,numPagesEdited:1}:(0,s().HB)(u);return n}({saveTransactionInfos:n,parentRecordStore:i.parentRecordStore}),d=N({typedAutomationExecutionSummary:u,numBlocksDuplicated:l,intl:i.intl}),p=await async function(e){const{saveTransactionInfos:t,clientContext:o}=e;let n;for(const r of t.slice().reverse()){if("create_page"===r.type){var i;n=K().Bv.createChildStore(o.parentRecordStore,{table:z().ev,id:r.pageId,spaceId:null===(i=r.collection)||void 0===i?void 0:i.spaceId});break}if("update_pages"===r.type){if(1===r.pageIds.length){var a;n=K().Bv.createChildStore(o.parentRecordStore,{table:z().ev,id:r.pageIds[0],spaceId:null===(a=r.collection)||void 0===a?void 0:a.spaceId})}else{const e=K().md.createChildStore(o.parentRecordStore,r.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;n=t}break}if("publish_site"===r.type)break;(0,s().HB)(r)}return n}({saveTransactionInfos:n,clientContext:i}),m=function(e){let t;for(const o of e){const e=(0,a().getActionRegistryItem)(o.type);if(!1===e.invertible)return!1;!0===e.invertible&&(t=!0)}return t}(t),g=!0===m&&A().xy(r)?()=>{A().JM({environment:o,namedRevisionId:r}),k().N2(),c&&c(r)}:void 0;k().AC({blockToOpenStore:p,item:{label:d},performUndo:g})}({actionModels:V,clientContext:n,environment:r,numBlocksDuplicated:L.getNumBlocksDuplicated(),onUndo:c,saveTransactionInfos:L.saveTransactionInfos,undoCheckpointName:L.undoCheckpointName})}var ie=()=>o(765618),ae=o(242343),re=()=>o(237385),le=()=>o(803290),se=()=>o(174114),ce=()=>o(31448),ue=()=>o(384221),de=()=>o(388615),pe=()=>o(59175),me=()=>o(443252),ge=()=>o(951540),ye=()=>o(142708),he=()=>o(502852),fe=()=>o(830820),ve=()=>o(98508),xe=()=>o(943066),be=()=>o(133926),Se=()=>o(271142),Ce=()=>o(836471),Ae=()=>o(569379),ke=()=>o(157699),Me=()=>o(239296),je=()=>o(179701),Te=()=>o(90957),Ie=()=>o(713995),we=()=>o(483019),_e=()=>o(738677),Pe=()=>o(791497),Be=()=>o(356813),Re=()=>o(28210),Ve=()=>o(103151),Ee=()=>o(906230),De=()=>o(723817),Fe=o(163643);const Oe=(0,E().YK)({icon:{defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"},addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"}});function Ne(e){const{disabled:t,currentIcon:o,handleIconChange:n,store:i}=e,a=(0,re().v3)(),r=(0,E().tz)(),l=(0,ae.useCallback)((e=>{Pe().W(a,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:De().jv,popupHeight:De().GF,isSmallWidth:!1,title:r.formatMessage(Oe.icon),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{n(e),Pe().I()}},{type:"emoji",onChange:(e,t)=>{n(e),Pe().I()}}],onDelete:o?()=>{n(void 0),Pe().I()}:void 0})}),[a,n,r,o]),s=(0,se().IS)((e=>({iconButton:{background:"transparent",boxShadow:e.shadowXS,width:28,height:28},icon:{width:16,height:16}})),[]),c=e=>(0,Fe.jsx)(Be().A,{ariaLabel:r.formatMessage(Oe.addIconButtonAriaLabel),style:s.iconButton,iconStyle:s.icon,hasBackground:!0,disabled:t,showShadow:!0,icon:e=>o?(0,Fe.jsx)(Re().B,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:o,pointer:i.pointer},style:e}):(0,_e().A)(e),...(0,Ee().A)(e??{},{onClick:l})});return o?c():(0,Fe.jsx)(Ve().A,{renderTooltip:()=>(0,Fe.jsx)(E().sA,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:c})}var Le=()=>o(441292),We=()=>o(589704),ze=()=>o(205670),Ke=()=>o(738355);function He(e){const{value:t,onChange:o,wrapStyle:n,onBlur:i,...a}=e,[r,l]=(0,ae.useState)(!1),s=(0,re().v3)(),c=(0,We().A)(!0),u=(0,ae.useCallback)((()=>{l(!1),null==i||i()}),[i]),d=(0,ae.useCallback)((e=>o(e.currentTarget.value)),[o]),p=(0,ae.useCallback)((()=>{"empty"!==ze().default.state.mode&&J().IU({environment:s,preventDismissMobileKeyboard:!0}),l(!0)}),[s]);return(0,Fe.jsx)(Le().A,{debugName:"AutomationPlainTextInput",capture:r,children:(0,Fe.jsx)("div",{...c,style:n,children:(0,Fe.jsx)(pe().A,{...a,onBlur:u,onChange:d,onFocus:p,value:t})})})}function Ue(e){const{onChange:t,store:o,...n}=e,{maybePersistedTransactionActions:i}=(0,Ke().b)(),a=(0,le().K8)((()=>o.getValue()??""),[o]),r=(0,ae.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{X().KY({store:o,transaction:t,value:e})}}),null==t||t(e)}),[i,t,o]);return(0,Fe.jsx)(He,{value:a,onChange:r,...n})}var Ye=()=>o(807069),Ge=()=>o(890315),qe=()=>o(929841),Xe=(o(771702),()=>o(178063)),$e=()=>o(263873),Je=()=>o(680369),Qe=()=>o(337658),Ze=()=>o(535906),et=()=>o(273520),tt=()=>o(97787),ot=()=>o(397791),nt=()=>o(129978),it=()=>o(962373),at=()=>o(121686),rt=()=>o(830925),lt=()=>o(572293),st=()=>o(498248),ct=()=>o(982415),ut=()=>o(459845);function dt(e){return!e.pathIsDead()&&e.isDefined()}function pt(e){if(!(0,s().O9)(e))return[];return e.getTemplatePageStores().filter((e=>dt(e)))}var mt=()=>o(698548),gt=()=>o(644518),yt=()=>o(752903),ht=()=>o(709237),ft=()=>o(434406),vt=()=>o(265405),xt=()=>o(284573),bt=()=>o(688142);function St(e){const{actionStore:t,currentValue:o,onChange:n,disabled:i,errorMessage:a,errorIcon:r,skipVariables:l}=e,c=(0,re().v3)(),{typecheckResult:u}=(0,Se().YC)(),d=(0,le().uB)(void 0,it().A),p=t.id,m=(0,vt().F)({actionId:p}),g=(0,le().K8)((()=>o&&"collection"===o.type?K().md.createChildStore(t,o.collection):void 0),[o,t]),y=(0,le().K8)((()=>{if(p&&u&&o&&"variable"===o.type)return(0,gt().getContextValueForActionById)(u,p,o.id)}),[o,u,p]),h=(0,ae.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(n(e),d.reset(),(0,ut().CM)(((o,n,i)=>{const a=(0,ut().zc)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().O9)(a)&&(0,T().u4)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[n,d,t,c]),f=(0,ae.useCallback)((()=>d.reset()),[d]),v=(0,je().j)(),x=Boolean(g||y);return(0,Fe.jsx)(et().Ay,{buttonPopupStore:d,popupType:v,alignmentToOrigin:et().yP.Center,placementToOrigin:et().sx.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:i,isCompact:!0,isError:Boolean(a),hasActionRequired:!x,errorIcon:r,dropdownButtonType:"dropdown",children:g?(0,Fe.jsx)(ht().A,{store:g}):y?(0,Fe.jsx)(ft().F,{format:yt().NY.Medium,isSingle:!0,value:y,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,Fe.jsx)(E().sA,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})}),render:e=>(0,Fe.jsx)(bt()._,{formulaTypecheckContextValues:m,onChange:h,onClose:f,parentRecordStore:t,selectedTarget:o,skipPages:!0,skipVariables:l})})}var Ct=()=>o(955751),At=()=>o(935091),kt=()=>o(858023),Mt=()=>o(88271),jt=()=>o(441911);function Tt(e){const{collectionStore:t,currentTemplateId:o,onChange:n,disabled:i,errorMessage:a}=e,r=(0,re().v3)(),{device:l}=r,s=(0,le().K8)((()=>{if(!t)return;if(o){const e=K().Bv.createChildStore(t,{id:o,spaceId:t.getSpaceId(),table:z().ev});if(!e.pathIsDead())return e}const e=t.getDefaultTemplatePageStore();return e&&!e.pathIsDead()?e:void 0}),[t,o]),c=(0,je().j)(),u=(0,le().K8)((()=>pt(t)),[t]),d=Boolean(o);return(0,Fe.jsx)(et().Ay,{popupType:c,alignmentToOrigin:et().yP.Center,placementToOrigin:et().sx.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:i,isCompact:!0,isError:Boolean(a),style:{minWidth:50},dropdownButtonType:"dropdown",children:s&&(d||dt(s))?(0,Fe.jsx)(ht().A,{store:s}):(0,Fe.jsx)(E().sA,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})}),render:e=>{const o=(0,jt().v)({device:l,width:280});return(0,Fe.jsx)(At().A,{...o,children:t&&(0,Fe.jsx)(It,{collectionStore:t,templatePageStores:u,parent:e,onChange:n})})}})}function It(e){const{collectionStore:t,templatePageStores:o,parent:n,onChange:i}=e,a=(0,re().v3)(),{device:l}=a,s=(0,le().K8)((()=>t.getDefaultTemplatePageStore()),[t]),c=o.map((e=>{const o={key:e.id,render:o=>(0,ae.createElement)(Ct().K,{...o,key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:l.isMobile,locked:!0,isDefault:s===e,onCancelClick:r().lQ,draggable:!1}),action:t=>{i(e.id),n.close()}};return o})),u={key:"empty",render:e=>(0,ae.createElement)(Ct().K,{...e,key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:l.isMobile,locked:!0,onCancelClick:r().lQ,draggable:!1}),action:e=>{i(void 0),n.close()}};return(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,Fe.jsx)(Mt().A,{...e,title:(0,Fe.jsx)(E().sA,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select template"})}),items:r().oE([...c,s?void 0:u])}]})}var wt=()=>o(100096);function _t(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,errorIcon:r}=e,l=(0,le().K8)((()=>{let e;if("collection"===(null==a?void 0:a.type)){const o=t.getRecordModel(a.collection);e=null==o?void 0:o.getDatabaseType()}return(0,ct().$O)(e)}),[t,a]);return(0,Fe.jsx)(E().sA,{defaultMessage:"Add {itemType} to{collectionPicker}",id:"automations.CreatePageActionV2.header.title",values:{collectionPicker:(0,Fe.jsx)(St,{actionStore:t,currentValue:a,disabled:o,errorMessage:n,errorIcon:r,onChange:i,skipVariables:!0}),itemType:l}})}function Pt(e){const{collectionStore:t,disabled:o,errorMessage:n,onChange:i,value:a}=e;return(0,Fe.jsx)(E().sA,{defaultMessage:"as{collectionTemplatePicker}",id:"automations.CreatePageActionV2.header.template",values:{collectionTemplatePicker:(0,Fe.jsx)(Tt,{collectionStore:t,currentTemplateId:a,disabled:o,errorMessage:n,onChange:i})}})}var Bt=()=>o(421338),Rt=()=>o(385649),Vt=()=>o(728373),Et=()=>o(909177);function Dt(e,t){const o=e.getConfigStore().getKeyStore("values"),n=o.getValue(),i=null==n?void 0:n[t];return(0,s().O9)(i)?{valueConfig:i,valueStore:o}:{valueConfig:void 0,valueStore:void 0}}var Ft=()=>o(209684);function Ot(e){const{disabled:t,onClick:o}=e,n=(0,se().IS)((e=>({button:{color:e.text.secondary},children:{...ce().RC,flex:"1 1 auto"}})),[]);return(0,Fe.jsx)(Ft().p,{disabled:t,disabledFeedback:t,onClick:o,shouldShrink:!0,style:n.button,children:(0,Fe.jsx)("div",{style:n.children,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Define another variable…",id:"automations.DefineVariablesAction.addVariableButton.label"})})})}var Nt=()=>o(630714),Lt=()=>o(146447),Wt=()=>o(523365),zt=()=>o(982008),Kt=()=>o(981793),Ht=()=>o(938341),Ut=()=>o(907721),Yt=()=>o(269280),Gt=()=>o(61014),qt=()=>o(86335),Xt=()=>o(507190),$t=()=>o(642053),Jt=()=>o(686752),Qt=()=>o(836693),Zt=()=>o(725460),eo=()=>o(401382),to=()=>o(723361);function oo(){const e=(0,se().IS)((e=>({warningIcon:{fill:e.icon.uiRedPrimary,height:14,width:15}})),[]);return(0,to().Q)(e.warningIcon)}function no(){}function io(e){const{analyzedFormulaOutput:t,onClearClick:o,onDeleteClick:n,onDuplicateClick:i,onEditFormulaClick:a,onEditTextClick:r,onVariableNameChange:l,onVariableNameSubmit:c,variableName:u}=e,{parseErrors:d,type:p,typeErrors:m}=t??{},g=(0,E().tz)(),y=(0,ae.useMemo)((()=>(0,Kt().L)(g,d??[],m??[])),[g,d,m]),h=(0,s().O9)(y),f=(0,jt().e)({width:265}),v=(0,se().IS)((e=>({formulaErrorCaptionMenuItem:{marginBlockStart:0,paddingBlockStart:0,paddingInline:4},formulaReturnTypeDesktopIcon:{marginBlockStart:4,marginInlineStart:12},formulaReturnTypeCaptionMenuItem:{marginBlock:0,paddingInline:4},formulaErrorCaption:{...h&&{color:e.text.uiRedPrimary}},nameInputMenuItem:{marginBlock:6}})),[h]),x=(0,ae.useMemo)((()=>p?(0,Gt().getHumanReadableType)(p):qt().qY.unknown),[p]),b=(0,re().v3)();(0,Yt().l)((()=>{ue().clear({environment:b})}));const S=[];if((0,s().O9)(u)){const e=(0,s().O9)(l);S.push({items:[{action:()=>null,key:"variable-name-input-item",render:t=>(0,Fe.jsx)(eo().Ay,{...t,disabled:!e,focus:!0,onChange:l??no,onSubmit:c,placeholder:g.formatMessage(Rt().xC),style:v.nameInputMenuItem,value:u})}],key:"variable-name-input-section",render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0})})}if((0,s().O9)(r)||(0,s().O9)(a)||(0,s().O9)(i)){const e=[];(0,s().O9)(r)&&e.push({action:r,key:"variable-name-manage-edit-text",render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)(ot().I,{icon:Jt().pencilLineIcon}),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Edit as text",id:"EditVariableMenu.editSimpleFormulaButtonMenuItem.label"})})}),(0,s().O9)(a)&&e.push({action:a,key:"variable-name-manage-edit-formula",render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)(ot().I,{icon:$t().K}),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Edit as formula",id:"EditVariableMenu.editFormulaButtonMenuItem.label"})})}),(0,s().O9)(i)&&e.push({action:i,key:"variable-name-manage-duplicate",render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)(ot().I,{icon:Xt().V}),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Duplicate",id:"EditVariableMenu.duplicateFormulaButtonMenuItem.label"})})});const t=S.length>0;S.push({items:e,key:"variable-name-manage-actions",render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0,topBorder:t})})}if((0,s().O9)(n)||(0,s().O9)(o)){const e=[];(0,s().O9)(n)&&e.push({action:n,key:"variable-name-destructive-delete",render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)(ot().I,{icon:Qt().trashIcon}),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Delete",id:"EditVariableMenu.deleteFormulaButtonMenuItem.label"})})}),(0,s().O9)(o)&&e.push({action:o,key:"variable-name-destructive-clear",render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)(ot().I,{icon:Qt().trashIcon}),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Clear variable",id:"EditVariableMenu.clearFormulaButtonMenuItem.label"})})});const t=S.length>0;S.push({items:e,key:"variable-name-destructive-actions",render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0,topBorder:t})})}const C=S.length>0,A=[{action:()=>{},key:"variable-name-typecheck-return-type",render:e=>(0,Fe.jsx)(Zt().A,{...e,caption:(0,Fe.jsx)("span",{style:v.formulaErrorCaption,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Type: {formulaType}",id:"EditVariableMenu.formulaReturnType.label",values:{formulaType:(0,Fe.jsx)(E().sA,{...x})}})}),desktopIconStyle:v.formulaReturnTypeDesktopIcon,dontShrinkIcon:!0,icon:h?(0,Fe.jsx)(oo,{}):null,shouldWrapCaption:!0,style:v.formulaReturnTypeCaptionMenuItem})}];return h&&A.push({action:()=>{},key:"variable-name-typecheck-error",render:e=>(0,Fe.jsx)(Zt().A,{...e,caption:(0,Fe.jsx)(E().sA,{...y}),shouldWrapCaption:!0,style:v.formulaErrorCaptionMenuItem})}),S.push({items:A,key:"variable-name-typecheck",render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0,topBorder:C})}),0===S.length?null:(0,Fe.jsx)(At().A,{...f,children:(0,Fe.jsx)(kt().Ay,{initialFocus:0,sections:S,type:kt().Oh.Vertical})})}var ao=()=>o(465546);const ro={type:"unknown"};function lo(e){const{type:t}=e,o=(0,se().IS)((e=>({icon:{fill:e.icon.secondary,width:16,height:16}})),[]);return(0,ao().Ix)(t??ro)(o.icon)}function so(e){const{analyzedFormulaOutput:t,buttonPopupStore:o,children:n,disabled:i,errorMessage:a,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,variableName:p}=e,{parseErrors:m,typeErrors:g}=t,y=Boolean(a),h=Boolean(m&&m.length>0),f=Boolean(g&&g.length>0),v=y||h||f,x=(0,se().IS)((e=>({button:{color:e.text.secondary,padding:"0 6px",gap:2},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:14,width:14},children:{...ce().RC,color:v?e.errorText:e.text.secondary,flex:"1 1 auto",...v&&{fontWeight:ce().Wy.medium}},iconWrap:{marginInlineEnd:2}})),[v]),b=(0,je().j)(),S=(0,le().uB)(o,it().A),C=(0,ae.useCallback)((()=>a??null),[a]),A=(0,ae.useCallback)((()=>{S.reset()}),[S]);return(0,Fe.jsx)(et().Ay,{alignmentToOrigin:et().yP.Start,buttonPopupStore:S,disabled:i,originGap:0,placementToOrigin:et().sx.Bottom,popupType:b,renderOrigin:e=>(0,Fe.jsx)(Ve().A,{delayThreshold:0,disableTooltip:!y,placement:Ut().W.Bottom,render:o=>(0,Fe.jsxs)(Ft().p,{...e,...o,disabled:i,disabledFeedback:i,shouldShrink:!0,style:x.button,children:[(0,Fe.jsx)("div",{style:x.iconWrap,children:v?(0,Fe.jsx)(oo,{}):(0,Fe.jsx)(lo,{type:t.type})}),(0,Fe.jsx)("div",{style:x.children,children:n}),(0,Ht().e)(x.chevronIcon)]}),renderTooltip:C}),render:e=>(0,Fe.jsx)(io,{analyzedFormulaOutput:t,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,onVariableNameSubmit:A,variableName:p})})}function co(e){var t,o;const{actionStore:n,variableId:a}=e,r=(0,re().v3)(),{automationStore:l,contextType:c}=(0,Se().EC)(),{disabled:u,maybePersistedTransactionActions:d,suppressActionErrors:p}=(0,Ke().b)(),m=(0,E().tz)(),{value:g}=(0,nt().fJ)(j().T.formulas),{value:y}=(0,nt().fJ)(Qe().QV.automationTypecheck),h=(0,le().uB)(void 0,it().A),f=ae.useRef(null),v=(0,le().uB)(void 0,it().A),x=(0,rt().n)(l),b=(0,le().K8)((()=>l.getActionStores()),[l]),[S,C]=(0,le().K8)((()=>[n.id,n.getSpaceId()]),[n]),A=(0,vt().F)({actionId:S}),{onTextStoreSelect:k,onTextStoreUnselect:M}=(0,zt().W)(n),T=(0,le().K8)((()=>n.getConfig()),[n]),w=(0,le().K8)((()=>{var e;return null==T||null===(e=T.values)||void 0===e?void 0:e[a]}),[T,a]),_="formula"===(null==w||null===(t=w.value)||void 0===t?void 0:t.type),P=(0,le().K8)((()=>{if(g&&C)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:g.createFormulaDataRequestSyncHandler(n.getRecordModel),spaceId:C,valueTypes:A.slice(0),featureGates:(0,I().i)()},value:null==w?void 0:w.value})}),[C,n.getRecordModel,A,g,null==w?void 0:w.value]),B=(0,ae.useMemo)((()=>!p.includes(n.id)),[p,n]),{errorMessage:R}=(0,ie().useErrorComponentForAction)({actionId:n.id,errorKey:a,shouldShow:B}),V=(0,ae.useCallback)((e=>{const t=e.target.value;d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableName:i}=e,{valueConfig:a,valueStore:r}=Dt(t,n);(0,s().O9)(a)&&(0,s().O9)(r)&&X().zv({data:{[n]:{...a,name:i}},store:r,transaction:o})}({automationActionStore:n,transaction:e,variableId:a,variableName:t})},userAction:"DefineVariablesAction.editVariableName"}),(0,ut().UB)(r,{automationStore:l,automationActionStore:n})}),[n,l,r,d,a]),D=(0,ae.useCallback)((()=>{d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,transaction:n,variableId:i}=e,{valueConfig:a,valueStore:r}=Dt(t,i);if(!(0,s().O9)(a)||!(0,s().O9)(r))return;const l=(0,Vt().Ay)(),c=(0,Et().v)(o,a.name);X().zv({data:{[l]:{...a,name:c}},store:r,transaction:n}),Q().applyOperation({operation:{args:{id:l},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:n})}({automationActionStore:n,automationActionStores:b,transaction:e,variableId:a})},userAction:"DefineVariables.duplicateVariable"}),h.reset(),(0,ut().UB)(r,{automationStore:l,automationActionStore:n})}),[n,b,l,h,r,d,a]),F=(0,ae.useCallback)((e=>{g&&y&&(d.createAndCommit({perform:t=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableValue:i}=e,{valueConfig:a,valueStore:r}=Dt(t,n);(0,s().O9)(a)&&(0,s().O9)(r)&&X().zv({data:{[n]:{...a,value:i}},store:r,transaction:o})}({automationActionStore:n,transaction:t,variableValue:e,variableId:a}),(0,i().clearInvalidVariables)({environment:r,automationStore:l,automationTypecheckModule:y,contextType:c,formulasModule:g,intl:m,isSubscribed:x,transaction:t})},userAction:"DefineVariables.editVariableValue"}),(0,ut().UB)(r,{automationStore:l,automationActionStore:n}))}),[n,l,y,c,r,g,m,x,d,a]),O=(0,ae.useMemo)((()=>{if(null==T||!T.variableIds||1===T.variableIds.length)return function(){h.setState({open:!1}),F({type:"simple",value:void 0})}}),[null==T?void 0:T.variableIds,h,F]),N=(0,ae.useMemo)((()=>{if(!(0,s().O9)(O))return function(){d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n}=e,{valueStore:i}=Dt(t,n);(0,s().O9)(i)&&(X().zv({data:{[n]:null},store:i,transaction:o}),Q().applyOperation({operation:{args:{id:n},command:"listRemove",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:o}))}({automationActionStore:n,transaction:e,variableId:a})},userAction:"DefineVariables.deleteVariable"}),h.reset(),(0,ut().UB)(r,{automationStore:l,automationActionStore:n})}}),[n,l,h,r,d,O,a]),L=(0,ae.useCallback)((async()=>{var e,t;if(_){if(!(await(0,Wt().Cp)()))return}null===(e=f.current)||void 0===e||e.focus(),h.setState({open:!1}),F({type:"simple",value:null==w||null===(t=w.value)||void 0===t?void 0:t.value})}),[h,_,F,null==w||null===(o=w.value)||void 0===o?void 0:o.value]),W=(0,ae.useCallback)((()=>{var e;null===(e=f.current)||void 0===e||e.blur(),h.setState({open:!1}),v.setState({open:!0})}),[h,v]),z=(0,se().IS)((()=>({textInput:{width:"100%"}})),[]),K=(0,ae.useCallback)((()=>{ue().clear({environment:r})}),[r]);if(!C||!w||!P)return null;const H=w.name||m.formatMessage(Rt().xC),{parseErrors:U=[],typeErrors:Y=[]}=P,G=U.length>0||Y.length>0;return(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:7,children:[(0,Fe.jsx)(Bt().Y1,{direction:"horizontal",width:"hug",children:(0,Fe.jsx)(so,{analyzedFormulaOutput:P,buttonPopupStore:h,errorMessage:R,onClearClick:O,onDeleteClick:N,onDuplicateClick:D,onEditFormulaClick:W,onEditTextClick:L,onVariableNameChange:V,variableName:w.name,children:(0,Fe.jsx)("span",{style:ce().RC,children:H})})}),(0,Fe.jsx)(Lt().Y,{disabled:u,formulaInputButtonPopupStore:v,formulaTypecheckContextValues:A,onChange:F,onTextStoreSelect:k,onTextStoreUnselect:M,onTextEsc:K,parentRecordStore:n,ref:f,spaceId:C,style:z.textInput,value:w.value,shouldShowErrorStyles:G}),(0,Fe.jsx)(Kt().J,{analyzedFormulaOutput:P})]},a)}o(500234);var uo=()=>o(880195),po=()=>o(393342),mo=()=>o(966638),go=()=>o(367859),yo=()=>o(983050);const ho=(0,E().YK)({aboveMenuItemLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},aboveTitle:{id:"automations.DuplicateBlocksAction.aboveTitle",defaultMessage:"above button"},belowMenuItemLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"},belowTitle:{id:"automations.DuplicateBlocksAction.belowTitle",defaultMessage:"below button"},title:{defaultMessage:"Insert blocks {insertionPicker}",id:"automations.DuplicateBlocksAction.title"},topOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.topOfPageButtonLabel",defaultMessage:"At top of page"},topOfPageTitle:{id:"automations.DuplicateBlocksAction.topOfPageTitle",defaultMessage:"at top of page"},bottomOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.bottomOfPageButtonLabel",defaultMessage:"At bottom of page"},bottomOfPageTitle:{id:"automations.DuplicateBlocksAction.bottomOfPageTitle",defaultMessage:"at bottom of page"}}),fo={before:{icon:(0,o(247160).F)({width:Je().Ev.default}),key:"before",menuItemLabel:ho.aboveMenuItemLabel,title:ho.aboveTitle},after:{icon:(0,o(296315).o)({width:Je().Ev.default}),key:"after",menuItemLabel:ho.belowMenuItemLabel,title:ho.belowTitle},topOfPage:{icon:(0,o(598793).Q)({width:Je().Ev.default}),key:"topOfPage",menuItemLabel:ho.topOfPageMenuItemLabel,title:ho.topOfPageTitle},bottomOfPage:{icon:(0,o(792104).f)({width:Je().Ev.default}),key:"bottomOfPage",menuItemLabel:ho.bottomOfPageMenuItemLabel,title:ho.bottomOfPageTitle}},vo=fo.after;function xo(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,E().tz)(),a=(0,je().j)(),r=(0,le().uB)(void 0,it().A),l=(0,ae.useCallback)((e=>{n&&t.key!==e&&n(e),r.setState({open:!1})}),[r,t,n]);return(0,Fe.jsx)(et().Ay,{alignmentToOrigin:et().yP.Center,buttonPopupStore:r,disabled:o,originGap:0,placementToOrigin:et().sx.Bottom,popupType:a,render:()=>(0,Fe.jsx)(bo,{currentOption:t,onChange:l}),renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:o,isCompact:!0,dropdownButtonType:"dropdown",children:i.formatMessage(t.title)})})}function bo(e){const{currentOption:t,onChange:o}=e,n=(0,E().tz)(),i=(0,jt().e)({maxWidth:360}),a=Object.values(fo).map((e=>({key:e.key,render:o=>(0,Fe.jsx)(Ze().A,{...o,isChecked:t.key===e.key,icon:e.icon,title:n.formatMessage(e.menuItemLabel)}),action:()=>o(e.key)})));return(0,Fe.jsx)(At().A,{...i,children:(0,Fe.jsx)(kt().Ay,{initialFocus:0,sections:[{key:0,render:e=>(0,Fe.jsx)(Mt().A,{enableActionSheetTitle:!0,...e}),items:a}],type:kt().Oh.Vertical})})}function So(e){const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:a}=e,r=(0,re().v3)(),l=(0,se().IS)((e=>({listWrap:{background:e.contentBackground,borderRadius:5,boxShadow:e.inputBoxShadow,fontSize:14,minHeight:64,paddingBlock:3,paddingInline:10,cursor:"text",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.text.secondary,color:e.text.tertiary,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),s=(0,le().K8)((()=>K().Bv.createChildStore(t,n)),[t,n]),c=(0,le().K8)((()=>s.getContentStore()),[s]),u=(0,ae.useCallback)((()=>{(c.getValue()??[]).length>0||Q().createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:r,canUndo:!0,perform:e=>{const t=i().insertEmptyTextInDuplicateBlockAction({environment:r,contentStore:c,transaction:e});J().hc({environment:r,store:t}),ue().setSelectionAtStart({store:t.getBlockTitleStore()})}})}),[r,c]);if(!c)return null;const d="inline"===(null==a?void 0:a.type);return(0,Fe.jsx)(uo().A,{name:"DuplicateBlocksActionEditor",children:(0,Fe.jsx)(go().A,{store:s,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,Fe.jsx)(de().s,{allowSelectionWithin:!0,children:(0,Fe.jsx)("div",{style:l.listWrap,onClick:u,className:yo().CCX,children:(0,Fe.jsx)(po().c,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,Fe.jsx)(mo().A,{disabled:o,store:c,emptyPlaceholder:(0,Fe.jsx)("div",{style:l.emptyPlaceholder,children:d?(0,Fe.jsx)(E().sA,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}):(0,Fe.jsx)(E().sA,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})})}var Co=()=>o(539032),Ao=()=>o(711659),ko=()=>o(231556);const Mo=(0,E().YK)({confirmationMessageLabel:{defaultMessage:"Confirmation message",id:"automations.BaseModalAction.confirmationMessageLabel"},continueButtonTextLabel:{defaultMessage:"Continue button text",id:"automations.BaseModalAction.continueButtonTextLabel"},cancelButtonTextLabel:{defaultMessage:"Cancel button text",id:"automations.BaseModalAction.cancelButtonTextLabel"}});var jo=()=>o(911575),To=()=>o(28923);function Io(e){const{actionStore:t,disabled:o,errorMessage:n,includeThisPage:i,onChange:a,target:r,urlBehavior:l}=e,c=(0,re().v3)(),{typecheckResult:u}=(0,Se().YC)(),d=(0,le().uB)(void 0,it().A),[p,m]=(0,le().K8)((()=>[t.id,t.getSpaceId()]),[t]),g=(0,vt().F)({actionId:p}),y=(0,le().K8)((()=>{if(r)if("variable"===r.type){if(!u)return;const e=(0,gt().getContextValueForActionById)(u,p,r.id);if(e)return{type:"variable",contextValue:e}}else{if("page"===r.type||"url"===r.type)return r;(0,s().HB)(r)}}),[r,u,p]),h=(0,je().j)(),f=(0,ae.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type&&"url"!==e.type||(a(e),d.reset(),(0,ut().CM)(((o,n,i)=>{const a=(0,ut().zc)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().O9)(a)&&(0,T().u4)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[a,d,t,c]),v=(0,ae.useCallback)((()=>d.reset()),[d]);let x;return y?"page"===y.type?x=(0,Fe.jsx)(ht().A,{store:K().Bv.createChildStore(t,y.page),style:{paddingBlock:1}}):"variable"===y.type?x=(0,Fe.jsx)(ft().F,{value:y.contextValue,format:yt().NY.Medium,isSingle:!0,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):"url"===y.type?x=(0,Fe.jsx)("div",{children:y.url}):(0,s().HB)(y):x="allow"===l?(0,Fe.jsx)(E().sA,{id:"automations.AutomationPagePicker.pagesDropdown.labelWithUrl",defaultMessage:"Select page, form, or URL"}):(0,Fe.jsx)(E().sA,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"}),(0,Fe.jsx)(et().Ay,{buttonPopupStore:d,popupType:h,alignmentToOrigin:et().yP.Center,placementToOrigin:et().sx.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:o,isCompact:!0,isError:Boolean(n),hasActionRequired:!Boolean(r),tooltipMessage:n,dropdownButtonType:"dropdown",children:x}),render:e=>(0,Fe.jsx)(bt()._,{formulaTypecheckContextValues:g,includeThisPage:i,onChange:f,onClose:v,parentRecordStore:t,selectedTarget:r,skipCollections:!0,spaceId:m,urlBehavior:l})})}function wo(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,urlBehavior:r}=e,l=(0,se().IS)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,Fe.jsxs)("div",{style:l.title,children:[(0,Fe.jsx)(E().sA,{defaultMessage:"<span>Open </span>{pagePicker}",id:"automations.OpenPageAction.action.title",values:{pagePicker:(0,Fe.jsx)("div",{style:l.picker,children:(0,Fe.jsx)(Io,{urlBehavior:r,actionStore:t,disabled:o,errorMessage:n,onChange:i,target:a})}),span:e=>(0,Fe.jsx)("span",{style:l.span,children:e})}})," "]})}function _o(e){const{actionStore:t,disabled:o,onChange:n}=e,i=(0,se().IS)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]),a=(0,le().K8)((()=>t.getOpenPageIn()),[t]);return(0,Fe.jsx)("div",{style:i.title,children:(0,Fe.jsx)(E().sA,{defaultMessage:"<span>in </span>{peekModePicker}",id:"automations.OpenPageAction.peekMode.title",values:{peekModePicker:(0,Fe.jsx)("div",{style:i.picker,children:(0,Fe.jsx)(Po,{disabled:o,onChange:n,value:a})}),span:e=>(0,Fe.jsx)("span",{style:i.span,children:e})}})})}function Po(e){const{disabled:t,onChange:o,value:n}=e,i=(0,se().DP)(),a=(0,le().uB)(void 0,it().A),r=(0,le().K8)((()=>(0,To().c)({currentViewType:void 0,theme:i}).find((e=>e.key===n))),[n,i]),l=(0,ae.useCallback)((()=>a.reset()),[a]),s=(0,ae.useCallback)((e=>{e!==(null==r?void 0:r.key)&&o(e),l()}),[l,null==r?void 0:r.key,o]),c=(0,je().j)();return r?(0,Fe.jsx)(et().Ay,{alignmentToOrigin:et().yP.Center,buttonPopupStore:a,disabled:t,originGap:0,placementToOrigin:et().sx.Bottom,popupType:c,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:t,isCompact:!0,dropdownButtonType:"dropdown",children:r.title}),render:e=>(0,Fe.jsx)(Bo,{onChange:s,value:n})}):null}function Bo(e){const{onChange:t,value:o}=e,n=(0,se().DP)(),i=(0,se().IS)((()=>({menuItem:{paddingBlock:8}})),[]),a=(0,jt().e)({maxWidth:360,width:280}),r=(0,le().K8)((()=>(0,To().c)({currentViewType:void 0,theme:n}).map(((e,n)=>({action:()=>t(e.key),key:n,render:t=>(0,Fe.jsx)(Ze().A,{...t,body:e.body,caption:e.caption,isChecked:o===e.key,disabled:!1,icon:e.icon,style:i.menuItem,title:e.title})})))),[t,i.menuItem,n,o]),l=[{key:0,render:e=>(0,Fe.jsx)(Mt().A,{enableActionSheetTitle:!0,...e}),items:r}];return(0,Fe.jsx)(At().A,{...a,children:(0,Fe.jsx)(kt().Ay,{initialFocus:0,sections:l,type:kt().Oh.Vertical})})}var Ro=()=>o(663821),Vo=()=>o(511952),Eo=()=>o(431551),Do=()=>o(725599),Fo=()=>o(35462),Oo=()=>o(640979),No=()=>o(867739),Lo=()=>o(48150),Wo=()=>o(755769);function zo(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a}=e;return(0,Fe.jsx)(E().sA,{defaultMessage:"Publish{pagePicker}",id:"automations.PublishSiteAction.header.title",values:{pagePicker:(0,Fe.jsx)(Io,{actionStore:t,disabled:o,errorMessage:n,includeThisPage:!0,onChange:i,target:a})}})}function Ko(){const e=(0,re().Y0)(),t=(0,se().IS)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"},button:{marginLeft:0,marginRight:0,width:"100%",paddingTop:2,paddingBottom:2,background:"transparent"},itemInnerContainer:{marginLeft:0,paddingLeft:8,minWidth:"auto",background:"transparent"}})),[]),o={type:"public_permission",role:"reader",expiration_timestamp:void 0},n=[{key:"linkExpiration",render:e=>(0,Fe.jsx)(No().A,{...e,disabled:!1,permissionItem:o,onChange:e=>{},hideIcon:!0}),action:()=>{}},{key:"enableQna",render:o=>(0,Fe.jsx)(Do().A,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Enable QnA",id:"automations.PublishSiteAction.action.siteSettingsEnableQna.title"}),on:!0,onClick:()=>{}}),action:()=>{}},{key:"enableSeo",render:o=>(0,Fe.jsx)(Do().A,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Search engine indexing",id:"automations.PublishSiteAction.action.siteSettingsEnableSEO.title"}),on:!1,onClick:()=>{}}),action:()=>{}}],i=(0,r().oE)([{key:0,render:e=>(0,Fe.jsx)(Mt().A,{style:t.sectionMenuItem,...e}),items:n}]);return(0,Fe.jsxs)("div",{style:t.outerContainer,children:[(0,Fe.jsx)("label",{children:(0,Fe.jsx)(E().sA,{defaultMessage:"Settings",id:"automations.PublishSiteAction.action.siteSettingsTitle"})}),(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,sections:i,initialFocus:void 0,resetFocusOnMouseOut:!0,style:t.siteSettingsContainer})]})}function Ho(){const e=(0,se().IS)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"}})),[]),t=[{key:"theme",render:t=>(0,Fe.jsx)(Uo,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"header",render:t=>(0,Fe.jsx)(qo,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"googleAnalytics",render:t=>(0,Fe.jsx)($o,{...t,style:e.sectionMenuItem}),action:()=>{}}],o=(0,r().oE)([{key:0,render:t=>(0,Fe.jsx)(Mt().A,{style:e.sectionMenuItem,...t}),items:t}]);return(0,Fe.jsxs)("div",{style:e.outerContainer,children:[(0,Fe.jsx)("label",{children:(0,Fe.jsx)(E().sA,{defaultMessage:"Site customization",id:"automations.PublishSiteAction.action.siteCustomizationTitle"})}),(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,sections:o,initialFocus:void 0,resetFocusOnMouseOut:!0,style:e.siteSettingsContainer})]})}const Uo=ae.forwardRef(((e,t)=>{const o=(0,re().Y0)(),n=(0,ae.useCallback)((e=>{}),[]),i="system";return(0,Fe.jsx)(Vo().A,{...e,popupType:o.isMobile?et().z7.SlideUp:et().z7.Popup,renderOrigin:t=>(0,Fe.jsx)(Lo().a,{...(0,Ee().A)(e,t),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Theme",id:"automations.PublishSiteAction.action.siteCustomization.themeTitle"}),right:(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(Yo,{value:i}),(0,Fe.jsx)(ot().I,{icon:Ro().arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]})}),alignmentToOrigin:Wo().MY.End,placementToOrigin:Wo().UV.Bottom,render:e=>(0,Fe.jsx)(Go,{value:i,onChange:n,onClose:()=>{e.close()}})})}));function Yo(e){const{value:t}=e,o=(0,se().IS)((e=>({container:{color:e.text.secondary}})),[]);return t?"system"===t?(0,Fe.jsx)(Fo().A,{style:o.container,children:(0,Fe.jsx)(E().sA,{defaultMessage:"System",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.system"})}):"light"===t?(0,Fe.jsx)(Fo().A,{style:o.container,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Light",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.light"})}):"dark"===t?(0,Fe.jsx)(Fo().A,{style:o.container,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Dark",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.dark"})}):void(0,s().HB)(t):null}function Go(e){const{value:t,onChange:o,onClose:n}=e,i=(0,re().Y0)(),a=(0,ae.useCallback)((e=>{void 0!==e&&e!==t&&o(e),n()}),[t,o,n]),r=["system","light","dark"].map((e=>({key:e,render:t=>(0,Fe.jsx)(Ze().A,{...t,title:(0,Fe.jsx)(Yo,{value:e})}),action:()=>{a(e)}}))),l=[{key:0,render:e=>(0,Fe.jsx)(Mt().A,{...e}),items:r}];return(0,Fe.jsx)(At().A,{menuType:i.isMobile?Oo().gu.ActionSheet:Oo().gu.Popup,width:240,children:(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,initialFocus:r.findIndex((e=>e.key===t)),sections:l})})}Uo.displayName="ThemeCustomizationItem";const qo=ae.forwardRef(((e,t)=>{const o=(0,re().Y0)(),n=(0,ae.useCallback)((e=>{}),[]),i={};return(0,Fe.jsx)(Vo().A,{...e,popupType:o.isMobile?et().z7.SlideUp:et().z7.Popup,renderOrigin:t=>(0,Fe.jsx)(Lo().a,{...(0,Ee().A)(e,t),title:(0,Fe.jsx)(E().sA,{defaultMessage:"Header",id:"automations.PublishSiteAction.action.siteCustomization.headerTitle"}),right:(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(E().sA,{defaultMessage:"Default",id:"automations.PublishSiteAction.action.siteCustomization.headerDefaultValue"}),(0,Fe.jsx)(ot().I,{icon:Ro().arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]})}),alignmentToOrigin:Wo().MY.End,placementToOrigin:Wo().UV.Bottom,render:e=>(0,Fe.jsx)(Xo,{value:i,onChange:n,onClose:()=>{e.close()}})})}));function Xo(e){const{value:t}=e,o=(0,re().Y0)(),n=[{key:"breadcrumbs",render:e=>(0,Fe.jsx)(Lo().a,{...e,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Breadcrumbs",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionBreadcrumb"}),right:(0,Fe.jsx)(Eo().A,{...e,on:!(null!=t&&t.hideBreadcrumbs)})}),action:()=>{}},{key:"search",render:e=>(0,Fe.jsx)(Lo().a,{...e,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Search",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionSearch"}),right:(0,Fe.jsx)(Eo().A,{...e,on:!(null!=t&&t.hideSearch)})}),action:()=>{}},{key:"watermark",render:e=>(0,Fe.jsx)(Lo().a,{...e,disabled:!0,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Watermark",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionWatermark"}),right:(0,Fe.jsx)(Eo().A,{...e,disabled:!0,on:!(null!=t&&t.hideWatermark)})}),action:()=>{}}],i=[{key:0,render:e=>(0,Fe.jsx)(Mt().A,{...e}),items:n}];return(0,Fe.jsx)(At().A,{menuType:o.isMobile?Oo().gu.ActionSheet:Oo().gu.Popup,width:240,children:(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,initialFocus:n.findIndex((e=>e.key===t)),sections:i})})}qo.displayName="HeaderCustomizationItem";const $o=ae.forwardRef(((e,t)=>{const o=(0,ae.useRef)(null);return(0,Fe.jsx)(Lo().a,{...e,title:(0,Fe.jsx)(E().sA,{defaultMessage:"Google Analytics",id:"automations.PublishSiteAction.action.siteCustomization.googleAnalyticsTitle"}),right:(0,Fe.jsx)(Jo,{ref:o,value:undefined}),onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()}})}));$o.displayName="GoogleAnalyticsCustomizationSetting";const Jo=ae.forwardRef(((e,t)=>{const{value:o}=e,[n,i]=(0,ae.useState)(!1),a=!1,r=(0,se().IS)((e=>({inputContainer:{background:e.surface.page,borderRadius:4,boxShadow:n?"0px 0px 0px 1px #2383E2 inset, 0px 0px 0px 2px rgba(35, 131, 226, 0.35)":`${e.regularDividerColor} 0px 0px 0px 1px inset`,height:28,padding:8,fontWeight:ce().Wy.regular,fontSize:14,lineHeight:1.3,color:e.text.secondary},input:{marginLeft:-6,paddingLeft:0,color:e.text.primary},wrapper:{paddingTop:4,paddingBottom:4}})),[a,n]);return(0,Fe.jsx)("div",{style:r.wrapper,children:(0,Fe.jsx)(pe().A,{ref:t,type:"text",style:r.inputContainer,inputStyle:r.input,value:o,onChange:e=>{},format:pe().C.Transparent,onFocus:()=>i(!0),onBlur:()=>i(!1),left:"G-",disabled:a})})}));Jo.displayName="GoogleAnalyticsInput";o(324989);var Qo=()=>o(81085),Zo=()=>o(706788),en=()=>o(555296),tn=()=>o(126451),on=()=>o(701270),nn=()=>o(264022),an=()=>o(773082),rn=()=>o(453214);function ln(e){const t=(0,re().v3)();(0,le().K8)((()=>{(0,y().Fbh)(e).forEach((e=>{new(K().LU)(t,{table:S().oo,id:e},{userId:e}).isDefined()}))}),[t,e])}var sn=()=>o(553538),cn=()=>o(60010),un=()=>o(475077),dn=(o(244387),()=>o(564134)),pn=()=>o(599932),mn=()=>o(162901),gn=()=>o(210106),yn=()=>o(188877),hn=()=>o(482570),fn=()=>o(128192),vn=()=>o(797715),xn=()=>o(622286),bn=()=>o(509484),Sn=()=>o(359441),Cn=()=>o(210466),An=()=>o(718522),kn=()=>o(373703),Mn=()=>o(49743),jn=()=>o(151258);function Tn(e){let{handleRemoveToken:t,token:o,format:n,style:i,addQuotes:a,renderAvatar:r,isDisabled:l}=e;const s=(0,se().DP)();if(!(0,pn().DT)(o))return null;const c=a?`“${o}”`:o;return(0,Fe.jsx)(jn().Ay,{title:c,format:n??yt().NY.Small,renderAvatar:r||(e=>(0,Mn().g)({width:e,height:e,padding:2,marginRight:6})),showRemoveButton:Boolean(t)&&!l,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},style:{background:s.accentColors.gray[75],...i},shouldShrink:!0,isSingle:!1})}var In=()=>o(100183);const wn=["gmail.com","yahoo.com","outlook.com"],_n=["com","net","org"];var Pn=()=>o(975515),Bn=()=>o(743668),Rn=()=>o(23082),Vn=()=>o(24e3),En=()=>o(360234),Dn=()=>o(320856);function Fn(e){let{email:t,disabled:o,menuArgs:n}=e;const i=(0,Dn().U)();return(0,Fe.jsx)(Ze().A,{...n,title:(0,Fe.jsx)(Tn,{token:t,format:yt().NY.Inline,addQuotes:!0,style:{background:void 0,padding:void 0}}),disabled:o,style:o?i.disabledMenuItem:void 0,isTokenTitle:!0})}function On(e){let{token:t,disabled:o,menuArgs:n,type:i}=e;const a=(0,Dn().U)(),r=(0,se().DP)();return(0,Fe.jsx)(Ze().A,{...n,title:(0,Fe.jsx)(In().A,{token:t,type:i,format:yt().NY.Inline,style:{color:r.darkTextColor,background:void 0,padding:void 0}}),disabled:o,style:{...o?a.disabledMenuItem:void 0},isTokenTitle:!0})}var Nn=()=>o(950635),Ln=()=>o(415806);function Wn(e){let{annotation:t,disabled:o,getRecordModel:n,menuArgs:i}=e;const a=(0,Dn().U)(),r=(0,le().K8)((()=>{if((0,Nt().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)){const e=(0,y().NcG)(t);return e?(0,Nn().xC)({pointer:{table:S().oo,id:e},getRecordModel:n,getRecordValue:void 0}):void 0}}),[t,n]);return null!=r&&r.asActor&&r.table===S().oo?(0,Fe.jsx)(Ze().A,{...i,title:(0,Fe.jsx)(zn,{actor:r}),disabled:o,style:o?a.disabledMenuItem:void 0,isTokenTitle:!0}):null}function zn(e){let{actor:t}=e;const o=(0,se().IS)((e=>({root:{margin:"4px 0"},actor:{margin:"0 10px 0 0"},email:{color:e.actionMenuButtonTextColor,margin:"0 0 0 26px"}})),[]),n=(0,le().K8)((()=>t.getName()),[t]),i=(0,le().K8)((()=>t.getEmail()),[t]);return(0,Fe.jsxs)("div",{style:o.root,children:[(0,Fe.jsx)(Ln().Ay,{actor:t,format:yt().NY.Medium,shouldShrink:!0,isSingle:!1,style:o.actor},t.id),n&&(0,Fe.jsx)(jn().Ay,{title:i,format:yt().NY.ExtraSmall,isSingle:!1,style:o.email})]})}function Kn(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,getRecordModel:a,isDisabled:l,limit:s,menuProps:c,onChange:u,onClose:d,onFormulaButtonClick:p,showFormulaValueItems:m=!1,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,b=(0,re().Y0)(),S=(0,se().DP)(),{errorMessage:C,isLoading:A,menuListStore:k,noResultsMessage:M,searchInput:j,userItems:T,valueItems:I,pagePropertyItems:w,emailItems:P}=function(e){var t,o,n;const{action:i,formulaTypecheckContextValues:a,formulaValueContext:l,isDisabled:s=!1,limit:c,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:m,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,b=(0,re().v3)(),S=(0,E().tz)(),{collectionStore:C,property:A}="collection"===l.type?l:{collectionStore:void 0,property:void 0},k=v.getRecordModel,M=(0,Wt().pg)(l),j=M(m,"first"),T=(0,ae.useMemo)((()=>a.filter((e=>(0,ao().o5)(e.type,{type:"person"})))),[a]),I=(0,se().IS)((e=>({personToken:{background:e.accentColors.gray[75],borderRadius:"6px"},formulaValueToken:{background:e.buttonBackground},searchInput:{maxHeight:6*parseInt(vn().sA,10),width:"100%",margin:0,...x&&{border:`1px solid ${e.text.uiRedPrimary}`,boxShadow:"none"}},clearButton:{height:20},clearButtonIcon:{height:15,width:15,fill:e.lightIconColor},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[x]),[w,P]=(0,ae.useState)(""),B=(0,ae.useRef)(null),R=(0,ae.useRef)(""),V=(0,le().uB)(void 0,Cn().A),D=(0,le().K8)((()=>(null==C?void 0:C.getSchema())??{}),[C]),F=(0,le().K8)((()=>{if(D&&A){const e=D[A];if(e&&(0,dn().sO)(e))return 1===e.limit}return!1}),[D,A]),[O]=(0,mn().Yb)((async()=>{const e=w?(0,yn().Ay)(w,T,(e=>e.kind===g().FormulaContextValueKind.ContextValue?e.name:"")):T,t=w?(0,yn().Ay)(w,f,(e=>(0,y().GCe)(e).name??"")):f,o=(0,Nt().fromSimpleFormulaArrayValue)(null==h?void 0:h.value).reduce(((e,t)=>(t&&(0,Nt().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)&&e.push(t[1]),e)),[]),n=await bn().T.searchActions.load(),i=await n.searchSpaceUsers({environment:b,query:w,membersOnly:!1,limit:20+o.length,shouldUseEdgeCacheRollout:_().default.checkGate({gateName:"edge_cache_helpers"})});let a=0,r=i[a];const l=[];for(;r&&l.length<20;)o.includes(r.id)||l.push(r.id),a+=1,r=i[a];return{valueResults:e,userResults:l,pagePropertyResults:t}}),[b,w,T,null==h?void 0:h.value,f],{debounce:Sn().tu}),N=(0,ae.useCallback)((()=>{var e;P(""),null===(e=B.current)||void 0===e||e.focus(),V.setState({...V.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[V]),L=(0,ae.useCallback)(((e,t)=>{u(e||h,t||i)}),[i,u,h]),W=(0,ae.useCallback)((e=>{const t=M(e,"last");L({type:"simple",value:(0,Nt().toSimpleFormulaArrayValue)(t)}),N()}),[M,L,N]),z=(0,ae.useCallback)((()=>{W(j.slice(0,j.length-1))}),[j,W]),K=(0,ae.useCallback)((e=>{null==W||W((0,Nt().simpleFormulaValueWithoutToken)(j,e))}),[j,W]),U=Boolean(c&&j.length>=c),Y=r().oE(j.map(((e,t)=>{if("boolean"==typeof e)return null;if("string"==typeof e)return(0,Fe.jsx)(Tn,{handleRemoveToken:K,token:e,isDisabled:s,renderAvatar:t=>(0,hn().A)({avatar:{email:e},style:{marginRight:4}}),style:I.personToken},t);if((0,y().rie)(e))return(0,Fe.jsx)(An().A,{handleRemoveToken:K,token:e,isDisabled:s,style:I.personToken,preventOnClickPropagation:!0},t);if((0,y().s1Y)(e))return(0,Fe.jsx)(kn().A,{formulaTypecheckContextValues:a,handleRemoveToken:K,isDisabled:s,style:I.formulaValueToken,token:e,preventOnClickPropagation:!0},t);if((0,y().iz3)(e)){var o;const n=(0,y().GCe)(e);return(0,Fe.jsx)(In().A,{type:null===(o=D[n.property])||void 0===o?void 0:o.type,isDisabled:s,handleRemoveToken:K,token:e},t)}return null}))),G=new Set(r().oE(j.map((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().s1Y)(e)&&(0,y().iVq)(e).id)))),q=new Set(r().oE(j.map((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().rie)(e)&&(0,y().NcG)(e))))),X=r().oE(((null===(t=O.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===g().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!G.has(t))return{action:"append",currentSimpleFormulaValueTokens:j,isDisabled:s||U,id:t,getRecordModel:k,setCurrentTokens:W,value:e}}))),$=r().oE(((null===(o=O.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=q.has(e);if(t)return;const o=(0,y().P4h)(e);return{action:()=>{t?K(o):W([...j,o]),F&&H().default.afterNextFlush((()=>{d()}))},annotation:o,getRecordModel:k,id:e,isDisabled:s||U,userId:e,isSelected:t}}))),J=new Set(j.filter((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().iz3)(e))).map((e=>(0,y().GCe)(e).property))),Q=r().oE(null===(n=O.value)||void 0===n?void 0:n.pagePropertyResults.map((e=>{var t;const o=(0,y().GCe)(e);if(!J.has(o.property))return{id:o.property,type:null===(t=D[o.property])||void 0===t?void 0:t.type,isDisabled:s||U,action:()=>{W([...j,e])},propertyAnnotation:e}}))),Z=(0,ae.useCallback)((e=>{(0,pn().DT)(e)&&W([...j,e])}),[j,W]),ee=(0,ae.useCallback)((()=>{Z(R.current)}),[Z]);(0,ae.useEffect)((()=>{R.current=w}),[w]),(0,ae.useEffect)((()=>{const e=B.current;return e&&e.addEventListener("blur",ee),()=>{e&&e.removeEventListener("blur",ee)}}),[ee]);const te=(0,pn().DT)(w)?[w]:[];if(0===te.length){const[e,t]=w.split("@");if(t){const[o,n]=t.split(".");(!n||n.length<=1)&&te.push(..._n.map((t=>`${e}@${o}.${t}`)).filter(pn().DT))}else te.push(...wn.map((t=>`${e}@${t}`)).filter(pn().DT))}const oe=te.map((e=>({action:()=>Z(e),isDisabled:s||U,email:e}))),ne=[...X,...$,...Q,...oe],ie=(0,xn().X)("gmail_action_formula_recipients");return{errorMessage:O.error&&S.formatMessage(fn().D.somethingWentWrong),header:S.formatMessage(fn().D.genericMenuHeader),isLoading:!O.value&&!O.error,menuListStore:V,noResultsMessage:0===ne.length&&O.value&&S.formatMessage(fn().D.noResults),searchInput:e=>(0,Fe.jsx)(vn().Ay,{ref:B,style:I.searchInput,right:(0,Fe.jsxs)(Bt().Y1,{direction:"horizontal",style:I.actionButtonGroup,children:[ie&&p&&(0,Fe.jsx)(cn().F,{disabled:s,onClick:e=>{e.stopPropagation(),p(e)},value:h}),(0,Fe.jsx)(Be().A,{ariaLabel:S.formatMessage({id:"automations.emailRecipients.clear",defaultMessage:"Clear"}),disabled:s,disabledFeedback:s,onClick:e=>{e.stopPropagation(),W([])},style:I.clearButton,icon:gn().J,iconStyle:I.clearButtonIcon})]}),disabled:s||U,format:vn().le.FilterValue,onChange:e=>P(e.target.value),onRemoveLastToken:z,placeholder:"",onClick:e,tokens:Y,value:w}),userItems:$,valueItems:X,pagePropertyItems:Q,emailItems:oe}}({action:t,formulaTypecheckContextValues:n,formulaValueContext:i,isDisabled:l,limit:s,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:o,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x})||{},B=(0,ae.useMemo)((()=>I&&m?I.map((e=>{const{annotation:t,itemAction:o}=(0,En().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,Fe.jsx)(Vn().A,{annotation:t,disabled:e.isDisabled,formulaTypecheckContextValues:n,menuArgs:o,style:{background:void 0,color:S.darkTextColor,padding:void 0},parentRecordStore:v}),action:o}})):[]),[I,m,n,S,v]),R=(0,ae.useMemo)((()=>T?T.map((e=>({key:e.userId,render:t=>(0,Fe.jsx)(Wn,{annotation:e.annotation,disabled:e.isDisabled,menuArgs:t,getRecordModel:a||e.getRecordModel}),action:e.action}))):[]),[a,T]),V=[...B,...(0,ae.useMemo)((()=>w?w.map((e=>({key:e.id,render:t=>(0,Fe.jsx)(On,{disabled:e.isDisabled,menuArgs:t,type:e.type,token:e.propertyAnnotation}),action:e.action}))):[]),[w])],D=[];V.length>0&&D.push({key:"properties",render:e=>(0,Fe.jsx)(Mt().A,{...e,title:"Property",topBorder:!1}),items:V}),R.length>0&&D.push({key:"users",render:e=>(0,Fe.jsx)(Mt().A,{...e,title:"Person",topBorder:V.length>0}),items:R});const F=(0,ae.useMemo)((()=>P?P.map((e=>({key:e.email,action:e.action,render:t=>(0,Fe.jsx)(Fn,{email:e.email,disabled:e.isDisabled,menuArgs:t})}))):[]),[P]);let O;F.length>0&&D.push({key:"emails",render:e=>(0,Fe.jsx)(Mt().A,{...e,title:"Email",topBorder:V.length>0||R.length>0}),items:F}),O=b.isMobile?{menuType:Oo().gu.Modal,right:(0,Fe.jsx)(Bn().DoneMenuText,{}),minWidth:"100%"}:{menuType:Oo().gu.Popup,maxHeight:"50vh",minWidth:"100%",disableHeaderBorder:!0};const N={width:"260px"},L=(0,Fe.jsxs)(Fe.Fragment,{children:[C&&(0,Fe.jsx)(Mt().A,{style:N,children:(0,Fe.jsx)(Pn().A,{title:C})}),M&&(0,Fe.jsx)(Mt().A,{style:N,children:(0,Fe.jsx)(Pn().A,{title:M})}),A&&(0,Fe.jsx)(Mt().A,{style:N,children:(0,Fe.jsx)(Rn().A,{})}),D.length>0&&(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,initialFocus:0,sections:D,store:k,style:N})]});return{searchInput:j,innerComponents:L,emailRecipientsMenu:(0,Fe.jsx)(At().A,{...O,...c,children:L})}}function Hn(e){const{currentValue:t,onChange:o,parentRecordStore:n,spaceId:i,formulaTypecheckContextValues:a,disabled:r}=e;return"formula"===(null==t?void 0:t.type)?(0,Fe.jsx)(Gn,{parentRecordStore:n,spaceId:i,value:t,formulaTypecheckContextValues:a,isDisabled:r,onChange:o}):(0,Fe.jsx)(Un,{...e})}function Un(e){const{currentValue:t,collectionStore:o,onChange:n,formulaTypecheckContextValues:i,limit:a,pageProperties:r,disabled:l,parentRecordStore:c,errorMessage:u}=e,d=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},p={menuType:Oo().gu.Popup},m=(0,le().K8)((()=>(0,Nt().fromSimpleFormulaArrayValue)(null==t?void 0:t.value)),[t]),{searchInput:g,emailRecipientsMenu:y}=Kn({currentSimpleFormulaValueTokens:m,formulaTypecheckContextValues:i,formulaValueContext:d,limit:a,menuProps:p,onChange:n,onClose:window.parent.close,onFormulaButtonClick:e=>{e.stopPropagation(),n({type:"formula",value:null==t?void 0:t.value})},showFormulaValueItems:!0,showGenericHeader:!0,value:t,pageProperties:r,isDisabled:l,parentRecordStore:c,showInputErrorStyles:(0,s().O9)(u)});return(0,Fe.jsx)(et().Ay,{renderOrigin:e=>{let{onClick:t}=e;return null==g?void 0:g(t)},popupType:et().z7.Popup,render:()=>y})}const Yn=[{type:"person"},{type:"text"},{type:"array",of:{type:"person"}},{type:"array",of:{type:"text"}}];function Gn(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i,onChange:a,isDisabled:r}=e,l=(0,se().IS)((e=>({containerWrap:{width:"100%"},formulaText:{whiteSpace:"pre-wrap",cursor:"pointer"},scroller:{flexGrow:1,width:"100%"},textWrap:{cursor:"text",display:"flex",flexWrap:"wrap",justifyContent:"end",width:"100%"},wrap:{background:e.inputBackground,boxShadow:e.inputBoxShadow,boxSizing:"border-box",cursor:"text",padding:"4px 8px"},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[]),s=async e=>{e.stopPropagation();await(0,Wt().Cp)()&&(null==a||a({type:"simple",value:null==i?void 0:i.value}))},c=(0,le().uB)(void 0,it().A),u=(0,ae.useCallback)((()=>c.setState({open:!1})),[c]);return(0,Fe.jsx)(et().Ay,{buttonPopupStore:c,renderOrigin:e=>(0,Fe.jsx)("div",{...e,style:l.containerWrap,children:(0,Fe.jsx)(Bt().Y1,{align:"center",className:yo().CCX,direction:"vertical",gap:4,style:l.wrap,children:(0,Fe.jsxs)("div",{style:l.textWrap,children:[(0,Fe.jsx)(ye().H,{style:l.scroller,type:ve().A.Y,children:(0,Fe.jsx)("div",{style:l.formulaText,children:(0,Fe.jsx)(sn().$,{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i})})}),(0,Fe.jsx)("div",{children:(0,Fe.jsx)(Bt().Y1,{direction:"horizontal",gap:2,style:l.actionButtonGroup,children:(0,Fe.jsx)(cn().F,{disabled:r,onClick:s,value:i})})})]})})}),popupType:et().z7.Popup,render:()=>(0,Fe.jsx)(un().A,{allowedReturnTypes:Yn,disabled:r,formulaTypecheckContextValues:t??[],onChange:a,onClose:u,parentRecordStore:o,value:i,spaceId:n})})}var qn=()=>o(83544),Xn=()=>o(17384),$n=()=>o(369678),Jn=()=>o(423392),Qn=()=>o(271674),Zn=()=>o(932322),ei=()=>o(307542),ti=()=>o(863969);const oi=(0,E().YK)({gmailAccountMenuPickerHeader:{defaultMessage:"Select Account",id:"automations.gmailAccountPicker.menuHeader"},gmailAccountMenuPickerHeaderInvalidAccount:{defaultMessage:"Invalid Account",id:"automations.gmailAccountPicker.menuHeaderInvalidAccount"},gmailAccountMenuPickerHeaderInvalidAccountTooltip:{defaultMessage:"Connect a valid account or delete this step",id:"automations.gmailAccountPicker.menuHeaderInvalidAccountTooltip"},addGmailAccountLabel:{id:"automations.gmailAccountPicker.setupAnotherGmailAccount.label",defaultMessage:"Add Gmail Account"},manageAccountInfoCaption:{id:"automations.gmailAccountPicker.manageAccountInfo.caption",defaultMessage:"Manage connected accounts in the “My Connections” tab of Settings"},connectGmailAccountMobileLabel:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountMobileCaption:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.caption",defaultMessage:"Open desktop or web app to connect"},connectGmailAccountLabel:{id:"automations.gmailAccountPicker.connectGmailAccount.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountCaption:{id:"automations.gmailAccountPicker.connectGmailAccount.caption",defaultMessage:"Allow Notion to send email on your behalf"}});function ni(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,errorMessage:i,onAccountChange:a}=e,r=(0,re().v3)(),l=(0,re().Y0)(),s=(0,ti().O)(),c="collection_view_settings",u=(0,le().K8)((()=>an().A.integrations.state.find((e=>e.id===Zo().eg))),[]),d=Boolean(i),p=(0,le().uB)(void 0,it().A),m=(0,ae.useCallback)((e=>{a(e),(0,T().u4)({environment:r,event:{eventName:"gmail_action_account_click",eventProperties:{}}}),p.reset()}),[a,p,r]),g=(0,je().j)(),y=(0,jt().e)(),h=(0,se().IS)((e=>({infoItem:{color:e.text.secondary,cursor:"default"},connectAccount:{paddingRight:"32px"},manageAccountCaption:{color:e.text.tertiary},errorText:{color:e.errorText}})),[]);if(!u)return null;const f=[{items:o.map(((e,o)=>({action:()=>null,key:e.id,render:()=>{const o=(null==t?void 0:t.id)===e.id;return(0,Fe.jsx)(Ze().A,{focused:(null==t?void 0:t.id)===e.id,onClick:async()=>{if(s)if(o&&d){const e=await ii(r,u,s,c);if("success"!==e.status)return void p.reset();m(e.externalAuthentication.id)}else m(e.id)},title:e.account_name,left:(0,Fe.jsx)(hn().A,{avatar:{email:e.account_name}}),isChecked:!d&&o,right:d&&o?(0,Fe.jsx)(ot().I,{icon:$n().exclamationMarkTriangleFillSmallIcon,size:"sm"}):void 0,style:{...o&&d&&h.errorText},bodyStyle:{minWidth:"280px"}},e.id)}}))),key:"gmailAccounts",render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0})}];f.push({key:"add-another-gmail-account-section",items:[{key:"add-another-gmail-account-item",action:async()=>{if(!s)return;const e=await ii(r,u,s,c);"success"===e.status&&(a(e.externalAuthentication.id),p.reset())},render:e=>(0,Fe.jsx)(Ze().A,{...e,left:(0,Fe.jsx)(ot().I,{icon:Xe().plusIcon}),right:(0,Fe.jsx)(ot().I,{icon:Xn().arrowUpRightSquareSmallIcon,size:"sm",color:"tertiary"}),title:(0,Fe.jsx)(E().sA,{...oi.addGmailAccountLabel})})}],render:e=>(0,Fe.jsx)(Mt().A,{...e,topBorder:!0})}),f.push({key:"manage-account-info-section",items:[{key:"manage-account-info-item",action:()=>null,render:e=>(0,Fe.jsx)(Ze().A,{...e,style:h.infoItem,focused:!1,caption:(0,Fe.jsx)(Zn().CU,{caption:(0,Fe.jsx)(E().sA,{...oi.manageAccountInfoCaption}),shouldWrapCaption:!0,captionStyle:h.manageAccountCaption})})}],render:e=>(0,Fe.jsx)(Mt().A,{...e,topBorder:!0})});const v={key:"connect-gmail-account-mobile-item",action:()=>null,render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)("img",{src:qn().A.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,disabled:!0,buttonStyle:h.connectAccount,title:(0,Fe.jsx)(E().sA,{...oi.connectGmailAccountMobileLabel}),caption:(0,Fe.jsx)(Zn().CU,{caption:(0,Fe.jsx)(E().sA,{...oi.connectGmailAccountMobileCaption}),shouldWrapCaption:!0})})},x={key:"connect-gmail-account-item",action:async()=>{if(p.reset(),!s)return;const e=await ii(r,u,s,c);"success"===e.status&&a(e.externalAuthentication.id)},render:e=>(0,Fe.jsx)(Ze().A,{...e,icon:(0,Fe.jsx)("img",{src:qn().A.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,buttonStyle:h.connectAccount,title:(0,Fe.jsx)(E().sA,{...oi.connectGmailAccountLabel}),caption:(0,Fe.jsx)(Zn().CU,{caption:(0,Fe.jsx)(E().sA,{...oi.connectGmailAccountCaption}),shouldWrapCaption:!0})})},b=[{key:"connectGmailAccount",items:[l.isMobile?v:x],render:e=>(0,Fe.jsx)(Mt().A,{...e,enableActionSheetTitle:!0})}];return(0,Fe.jsx)(et().Ay,{buttonPopupStore:p,popupType:g,alignmentToOrigin:et().yP.End,placementToOrigin:et().sx.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:n,isCompact:!0,isError:d,hasActionRequired:!Boolean(t),dropdownButtonType:"dropdown",children:t?(0,Fe.jsx)(Ve().A,{renderTooltip:()=>i,disableTooltip:!d,render:e=>(0,Fe.jsx)("span",{...e,children:null==t?void 0:t.account_name})}):(0,Fe.jsx)(Ve().A,{renderTooltip:()=>(0,Fe.jsx)(E().sA,{...oi.gmailAccountMenuPickerHeaderInvalidAccountTooltip}),disableTooltip:!d,render:e=>(0,Fe.jsx)("span",{...e,children:(0,Fe.jsx)(E().sA,{...d?oi.gmailAccountMenuPickerHeaderInvalidAccount:oi.gmailAccountMenuPickerHeader})})})}),render:e=>(0,Fe.jsx)(At().A,{...y,children:(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,sections:0===o.length?b:f,initialFocus:0})})})}async function ii(e,t,o,n){const i=await Jn().Jq({environment:e,integration:t,spaceId:o,from:n,preventRedirectToLastVisitedPage:(0,ei().dC)()});return l().Q.isFail(i)?{status:"failure"}:i.value.externalAuthentication?{externalAuthentication:i.value.externalAuthentication,status:"success"}:(await Qn().oX({environment:e}),{status:"re-auth"})}const ai=(0,E().YK)({toLabel:{defaultMessage:"To",id:"automations.SendGmailNotificationAction.toLabel"},ccLabel:{defaultMessage:"CC",id:"automations.SendGmailNotificationAction.ccLabel"},bccLabel:{defaultMessage:"BCC",id:"automations.SendGmailNotificationAction.bccLabel"},replyToLabel:{defaultMessage:"Send replies to",id:"automations.SendGmailNotificationAction.replyToLabel"},fromNameLabel:{defaultMessage:"Send with display name",id:"automations.SendGmailNotificationAction.fromNameLabel"},subjectLabel:{defaultMessage:"Subject",id:"automations.SendGmailNotificationAction.subjectLabel"},bodyLabel:{defaultMessage:"Message",id:"automations.SendGmailNotificationAction.bodyLabel"},gmailAccountPickerHidden:{defaultMessage:"Hidden",id:"automations.SendGmailNotificationAction.gmailAccountPickerHidden"}}),ri=["subject","body","fromName"],li={cc:!1,bcc:!1,replyTo:!1,displayName:!1},si={displayName:!1,replyTo:!1},ci={cc:ai.ccLabel.defaultMessage,bcc:ai.bccLabel.defaultMessage,replyTo:ai.replyToLabel.defaultMessage,displayName:ai.fromNameLabel.defaultMessage};function ui(e){var t,o,n,i,l,c,u,d,p,m,h,f,v,x,b;const C=(0,E().tz)(),{actionStore:A,currentGmailAuthentication:k,gmailAuthentications:M}=e,{automationStore:T,contextType:w}=(0,Se().EC)(),{disabled:_,maybePersistedTransactionActions:P,suppressActionErrors:B}=(0,Ke().b)(),R=(0,rn().y)(T,w),V=(0,le().K8)((()=>Boolean(_)),[_]),D=(0,a().getActionRegistryItem)("send_gmail_notification"),F=(0,le().K8)((()=>A.getSpaceId()),[A]),O=(0,le().K8)((()=>{var e,t,o,n;return{to:null==A||null===(e=A.getConfig())||void 0===e?void 0:e.to,cc:null==A||null===(t=A.getConfig())||void 0===t?void 0:t.cc,bcc:null==A||null===(o=A.getConfig())||void 0===o?void 0:o.bcc,reply_to:null==A||null===(n=A.getConfig())||void 0===n?void 0:n.reply_to}}),[A]),[N,L]=(0,ae.useState)(li),[W,z]=(0,ae.useState)(si),H=(0,re().v3)();ln(Object.values(O).flatMap((e=>{var t;return(null==e||null===(t=e.value)||void 0===t?void 0:t.value)||[]})));const{actionId:U,currentFromName:Y,currentSubject:G,currentBody:q,externalBotId:$}=(0,le().K8)((()=>{var e,t,o;return{currentFromName:null===(e=A.getConfig())||void 0===e?void 0:e.from_name,currentSubject:null===(t=A.getConfig())||void 0===t?void 0:t.email_subject,currentBody:null===(o=A.getConfig())||void 0===o?void 0:o.email_body,actionId:A.id,externalBotId:A.getConfigStore().getKeyStore("external_bot_id").getValue()}}),[A]);(0,Yt().l)((()=>{L((e=>{var t,o,n;return{...e,cc:Boolean(null==O||null===(t=O.cc)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.value),bcc:Boolean(null==O||null===(o=O.bcc)||void 0===o||null===(o=o.value)||void 0===o?void 0:o.value),replyTo:Boolean(null==O||null===(n=O.reply_to)||void 0===n||null===(n=n.value)||void 0===n?void 0:n.value),displayName:Boolean(null==Y?void 0:Y.value)}}))}));const J=(0,vt().F)({actionId:U}),{value:Q}=(0,nt().fJ)(j().T.formulas),Z=function(e,t){return(0,le().K8)((()=>t&&e?r().oE(Object.entries(e.getSchema()).map((e=>{let[t,o]=e;const n=new Set(["person","email"]),i=null==o?void 0:o.type;if(!i)return;return n.has(i)||"rollup"===i&&o.target_property_type&&n.has(o.target_property_type)?(0,y().ESw)({contextValueId:(0,Qo().KI)(),name:o.name,property:t,valueSnapshot:"current"}):void 0}))):[]),[e,t])}(R,(0,ae.useMemo)((()=>{if(Q)return J.filter((e=>(null==e?void 0:e.kind)===g().FormulaContextValueKind.ContextValue)).find((e=>(null==e?void 0:e.id)===(0,Qo().KI)()))}),[J,Q])),ee=(0,le().uB)(void 0,it().A),te=(0,ae.useCallback)((()=>ee.reset()),[ee]),oe=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:A,closeMenu:te})),[A,te]),ne=(0,ae.useMemo)((()=>!B.includes(A.id)),[B,A]),de=function(e){const{actionId:t,shouldShowError:o}=e,n={};return n.external_bot_id=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"external_bot_id"}),n.to=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"to"}),n.cc=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"cc"}),n.bcc=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"bcc"}),n.reply_to=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"reply_to"}),n.email_body=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"email_body"}),n.email_subject=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"email_subject"}),n}({actionId:A.id,shouldShowError:ne}),pe=(0,ie().useRequiresSubscriptionUpgradeError)({actionId:A.id,shouldShow:ne}),me=Boolean(pe),ge=(0,ae.useMemo)((()=>Object.values(de).filter((e=>(0,s().O9)(e.errorMessage)))[0]),[de]),ye=(0,ae.useCallback)((e=>{const t=an().A.externalAuthentications.state.find((t=>t.integration_id===Zo().eg&&t.id===e)),o=$!==(null==t?void 0:t.id);t&&o&&P.createAndCommit({perform:e=>{X().zv({data:{external_bot_id:t.id},store:A.getConfigStore(),transaction:e})},userAction:"SendGmailNotificationAction.setExternalBotId"})}),[A,$,P]);(0,le().K8)((()=>{$||1===M.length&&ye(M[0].id)}),[M,ye,$]);const he=(0,ae.useCallback)((e=>t=>{if(!t)return;if("formula"===t.type)return void P.createAndCommit({perform:o=>{X().zv({data:{[e]:{type:"formula",value:t}},store:A.getConfigStore(),transaction:o})},userAction:"SendGmailNotificationAction.setRecipient.formula"});const o=(0,y().RQ)(t.value).filter((e=>{const t=(0,y().Fbh)([e]);if(0===t.length)return!0;return!new(K().LU)(H,{table:S().oo,id:t[0]},{userId:t[0]}).getIsDeleted()}));P.createAndCommit({perform:t=>{X().zv({data:{[e]:{type:"formula",value:{type:"simple",value:o}}},store:A.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setRecipient.simple"}),(0,ut().UB)(H,{automationStore:T,automationActionStore:A})}),[A,P,H,T]),fe=(0,ae.useCallback)((e=>{P.createAndCommit({perform:t=>{X().zv({data:{from_name:e},store:A.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setFromName"}),(0,ut().UB)(H,{automationStore:T,automationActionStore:A})}),[A,P,H,T]),ve=(0,ae.useCallback)((e=>{P.createAndCommit({perform:t=>{X().zv({data:{email_subject:e},store:A.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setSubject"}),(0,ut().UB)(H,{automationStore:T,automationActionStore:A})}),[A,P,H,T]),xe=(0,ae.useCallback)((e=>{P.createAndCommit({perform:t=>{X().zv({data:{email_body:e},store:A.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setBody"}),(0,ut().UB)(H,{automationStore:T,automationActionStore:A})}),[A,P,H,T]),{onTextStoreSelect:be,onTextStoreUnselect:Ce}=(0,zt().W)(A),Ae=(0,le().K8)((()=>{if(!Q||!F)return{};const{createFormulaDataRequestSyncHandler:e}=Q,t={subject:G,body:q,fromName:Y};return Object.fromEntries(ri.map((o=>{const n=t[o];return n?[o,(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:e(A.getRecordModel),spaceId:F,valueTypes:J.slice(0),featureGates:(0,I().i)()},value:n})]:[o,""]})))}),[A.getRecordModel,G,q,Y,J,Q,F]),ke=(0,ae.useCallback)(((e,t)=>{e.stopPropagation(),e.preventDefault(),L((e=>({...e,[t]:!0}))),"displayName"===t&&z((e=>({...e,displayName:!1})))}),[]),Me=(0,ae.useCallback)((e=>{z((t=>({...t,[e]:!t[e]})))}),[]),je=(0,ae.useCallback)((e=>{var t,o,n;return!("displayName"!==e||null==Y||!Y.value)||(!("cc"!==e||null==O||null===(t=O.cc)||void 0===t||null===(t=t.value)||void 0===t||!t.value)||(!("bcc"!==e||null==O||null===(o=O.bcc)||void 0===o||null===(o=o.value)||void 0===o||!o.value)||!("replyTo"!==e||null==O||null===(n=O.reply_to)||void 0===n||null===(n=n.value)||void 0===n||!n.value)))}),[Y,O]),Te=(0,ae.useCallback)((async(e,t)=>{e.stopPropagation(),e.preventDefault();if(je(t)){if(!(await(0,nn().bx)({fieldName:`"${ci[t]}"`})))return}"displayName"===t&&fe(void 0),"cc"!==t&&"bcc"!==t||he(t)({type:"simple",value:void 0}),"replyTo"===t&&he("reply_to")({type:"simple",value:void 0}),L((e=>({...e,[t]:!1})))}),[fe,je,he]),Ie=(0,ae.useCallback)((()=>{ue().clear({environment:H})}),[H]),{isMobile:we}=(0,re().Y0)(),_e=(0,se().IS)((e=>{var t;const o={color:e.text.secondary,fontSize:we?ce().J.UIRegular.mobile:ce().J.UIRegular.desktop,lineHeight:we?ce().K_.UIRegular.mobile:ce().K_.UIRegular.desktop,fontWeight:ce().Wy.regular};return{inputLabel:{...o},toInputLabel:{...o,...(0,s().O9)(null===(t=de.to)||void 0===t?void 0:t.errorMessage)&&{color:e.text.uiRedPrimary,fontWeight:ce().Wy.medium}},toErrorLabel:{color:e.text.uiRedPrimary},toggleableInputLabel:{...o,cursor:"pointer",padding:2,transform:"translateX(-2px)",display:"flex",width:"fit-content"},toggleableInputLabelHovered:{...o,cursor:"pointer",backgroundColor:e.buttonHoveredBackground,transform:"translateX(-2px)",display:"flex",width:"fit-content",borderRadius:"4px",padding:2},messageInput:{width:"100%"},replyToInputContainer:{display:"flex",justifyContent:"space-between"},replyToInputField:{width:"100%",fontSize:we?ce().J.UIRegular.mobile:ce().J.UIRegular.desktop},ccBccToggle:{padding:"6px 12px",color:e.text.tertiary,borderRadius:"6px",marginLeft:8,alignSelf:"flex-start"},toggleFieldGridContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr auto",alignItems:"center",columnGap:8,rowGap:6},toggleFieldGridLabel:{gridRow:"1",gridColumn:"1"},toggleFieldGridInput:{gridRow:"2",gridColumn:"1"},toggleFieldGridTrashIconButton:{gridRow:"2",gridColumn:"2",alignSelf:"flex-start",height:32,width:32},toggleFieldTrashIconButtonForTextInput:{gridRow:"1",gridColumn:"2",alignSelf:"flex-start",marginTop:26,height:32,width:32},trashIcon:{width:Je().Ev.default,height:Je().Ev.default}}}),[de,we]);function Pe(e,t){return e||t?!e&&t?_e.toggleableInputLabelHovered:_e.inputLabel:_e.toggleableInputLabel}if(!F)return null;const Re={collectionStore:R,limit:mi,disabled:V,formulaTypecheckContextValues:J,spaceId:F,pageProperties:Z};return(0,Fe.jsxs)(wt().OT,{actionMenu:oe,buttonPopupStore:ee,disabled:V,actionId:A.id,canCollapse:!me,hideDragHandle:me,children:[(0,Fe.jsx)(wt().h3,{actionId:A.id,actionRegistryItem:D,disabled:V,errorMessage:pe||(null==ge?void 0:ge.errorMessage),styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Fe.jsx)(di,{currentGmailAuthentication:k,gmailAuthentications:M,disabled:V,isError:me,onGmailAccountChange:ye,accountPickerErrorMessage:null===(t=de.external_bot_id)||void 0===t?void 0:t.errorMessage})}),k&&(0,Fe.jsx)(wt().qt,{children:(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:16,children:[(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:6,children:[(0,Fe.jsx)("label",{style:_e.toInputLabel,children:(0,Fe.jsx)(E().sA,{...ai.toLabel})}),(0,Fe.jsxs)("div",{className:"to-input-and-ccBcc-container",style:_e.replyToInputContainer,children:[(0,Fe.jsx)(pi,{...Re,recipients:null==O||null===(o=O.to)||void 0===o?void 0:o.value,onChange:he("to"),errorMessage:null===(n=de.to)||void 0===n?void 0:n.errorMessage,style:_e.replyToInputField}),(!N.cc||!N.bcc)&&(0,Fe.jsx)(tn().A,{onClick:e=>{N.cc||ke(e,"cc"),N.bcc||ke(e,"bcc")},style:_e.ccBccToggle,children:N.cc||N.bcc?(0,Fe.jsx)(E().sA,{id:"automations.SendGmailNotificationAction.ccOrBccToggleLabel",defaultMessage:"{showCCLabel, select, true {CC} other {BCC}}",values:{showCCLabel:!N.cc&&N.bcc}}):(0,Fe.jsx)(E().sA,{id:"automations.SendGmailNotificationAction.ccAndBccToggleLabel",defaultMessage:"CC/BCC"})})]}),(0,s().O9)(null===(i=de.to)||void 0===i?void 0:i.errorMessage)&&(0,Fe.jsx)(on().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:_e.toErrorLabel,children:(0,Fe.jsx)(E().sA,{...null===(l=de.to)||void 0===l?void 0:l.errorMessageDescriptor})})]}),N.cc&&(0,Fe.jsx)(Bt().Y1,{direction:"vertical",gap:16,children:(0,Fe.jsxs)("div",{style:_e.toggleFieldGridContainer,children:[(0,Fe.jsxs)("label",{style:_e.inputLabel,children:[(0,Fe.jsx)(E().sA,{...ai.ccLabel}),(0,Fe.jsx)(ko().z,{})]}),(0,Fe.jsx)(pi,{...Re,recipients:null==O||null===(c=O.cc)||void 0===c?void 0:c.value,onChange:he("cc"),errorMessage:null===(u=de.cc)||void 0===u?void 0:u.errorMessage,style:_e.toggleFieldGridInput}),(0,Fe.jsx)(Be().A,{icon:Qt().trashIcon,ariaLabel:C.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"cc"),style:_e.toggleFieldGridTrashIconButton,iconStyle:_e.trashIcon})]})}),N.bcc&&(0,Fe.jsx)(Bt().Y1,{direction:"vertical",gap:16,children:(0,Fe.jsxs)("div",{style:_e.toggleFieldGridContainer,children:[(0,Fe.jsxs)("label",{style:{..._e.inputLabel},children:[(0,Fe.jsx)(E().sA,{...ai.bccLabel}),(0,Fe.jsx)(ko().z,{})]}),(0,Fe.jsx)(pi,{...Re,recipients:null==O||null===(d=O.bcc)||void 0===d?void 0:d.value,onChange:he("bcc"),errorMessage:null===(p=de.bcc)||void 0===p?void 0:p.errorMessage,style:_e.toggleFieldGridInput}),(0,Fe.jsx)(Be().A,{icon:Qt().trashIcon,ariaLabel:C.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"bcc"),style:_e.toggleFieldGridTrashIconButton,iconStyle:_e.trashIcon})]})}),(0,Fe.jsx)(ko().M,{disabled:V,disableMobileActionBar:!1,disableNewLines:!0,disableStyleAnnotations:!0,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:J,onChange:ve,onTextStoreSelect:be,onTextStoreUnselect:Ce,onTextEsc:Ie,parentRecordStore:A,spaceId:F,style:_e.messageInput,value:G,analyzedFormulaOutput:Ae.subject,labelMessageDescriptor:ai.subjectLabel,errorMessageDescriptor:null===(m=de.email_subject)||void 0===m?void 0:m.errorMessageDescriptor,shouldShowErrorStyles:(0,s().O9)(null===(h=de.email_subject)||void 0===h?void 0:h.errorMessage)}),(0,Fe.jsx)(ko().M,{disabled:V,disableMobileActionBar:!1,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:J,onChange:xe,onTextStoreSelect:be,onTextStoreUnselect:Ce,onTextEsc:Ie,parentRecordStore:A,rows:4,spaceId:F,style:_e.messageInput,value:q,analyzedFormulaOutput:Ae.body,labelMessageDescriptor:ai.bodyLabel,errorMessageDescriptor:null===(f=de.email_body)||void 0===f?void 0:f.errorMessageDescriptor,shouldShowErrorStyles:(0,s().O9)(null===(v=de.email_body)||void 0===v?void 0:v.errorMessage)}),!N.displayName&&(0,Fe.jsx)("label",{children:(0,Fe.jsxs)("span",{onClick:e=>ke(e,"displayName"),onMouseEnter:()=>Me("displayName"),onMouseLeave:()=>Me("displayName"),style:Pe(N.displayName,W.displayName),children:[(0,Fe.jsx)(E().sA,{...ai.fromNameLabel}),"..."]})}),N.displayName&&(0,Fe.jsxs)("div",{style:{..._e.toggleFieldGridContainer,rowGap:0},children:[(0,Fe.jsx)("div",{style:_e.toggleFieldGridLabel,children:(0,Fe.jsx)(ko().M,{disabled:V,disableMobileActionBar:!1,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:J,disableNewLines:!0,disableStyleAnnotations:!0,onChange:fe,onTextStoreSelect:be,onTextStoreUnselect:Ce,onTextEsc:Ie,parentRecordStore:A,rows:1,spaceId:F,value:Y,analyzedFormulaOutput:Ae.fromName,labelMessageDescriptor:ai.fromNameLabel,isOptional:!0})}),(0,Fe.jsx)(Be().A,{icon:Qt().trashIcon,ariaLabel:C.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"displayName"),style:_e.toggleFieldTrashIconButtonForTextInput,iconStyle:_e.trashIcon})]}),(0,Fe.jsxs)("div",{style:_e.toggleFieldGridContainer,children:[(0,Fe.jsx)("label",{style:_e.toggleFieldGridLabel,children:(0,Fe.jsxs)("span",{onClick:e=>ke(e,"replyTo"),onMouseEnter:()=>Me("replyTo"),onMouseLeave:()=>Me("replyTo"),style:Pe(N.replyTo,W.replyTo),children:[(0,Fe.jsx)(E().sA,{...ai.replyToLabel}),!N.replyTo&&"...",N.replyTo&&(0,Fe.jsx)(ko().z,{})]})}),N.replyTo&&(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(pi,{...Re,recipients:null==O||null===(x=O.reply_to)||void 0===x?void 0:x.value,onChange:he("reply_to"),errorMessage:null===(b=de.reply_to)||void 0===b?void 0:b.errorMessage,limit:1,style:_e.toggleFieldGridInput}),(0,Fe.jsx)(Be().A,{icon:Qt().trashIcon,ariaLabel:C.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"replyTo"),style:_e.toggleFieldGridTrashIconButton,iconStyle:_e.trashIcon})]})]})]})})]})}function di(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,isError:i,onGmailAccountChange:a,accountPickerErrorMessage:r}=e,l=(0,se().IS)((()=>({title:{display:"inline-flex",minWidth:50,flexWrap:"wrap",gap:6}})),[]),s=function(){const{isMobile:e}=(0,re().Y0)(),t=e?ce().J.UISmall.mobile:ce().J.UISmall.desktop;return(0,se().IS)((()=>({container:{alignItems:"center",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}();return i?(0,Fe.jsx)("div",{style:l.title,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Send mail",id:"automations.SendGmailNotificationAction.header.titleError"})}):(0,Fe.jsx)("div",{style:l.title,children:(0,Fe.jsx)(E().sA,{defaultMessage:"Send mail from{gmailAccountPicker}",id:"automations.SendGmailNotificationAction.header.title",values:{gmailAccountPicker:n?(0,Fe.jsxs)("div",{style:s.container,children:[(0,Fe.jsx)(ot().I,{icon:en().h}),(0,Fe.jsx)("span",{style:ce().RC,children:(0,Fe.jsx)(E().sA,{...ai.gmailAccountPickerHidden})})]}):(0,Fe.jsx)(ni,{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,onAccountChange:a,errorMessage:r})}})})}function pi(e){const{recipients:t,style:o,collectionStore:n,...i}=e,{automationStore:a}=(0,Se().EC)();return(0,Fe.jsx)("div",{style:o,children:(0,Fe.jsx)(Hn,{currentValue:t,collectionStore:n,parentRecordStore:a,...i})})}const mi=20;var gi=()=>o(708029);const yi=(0,E().YK)({defaultMenuHeader:{defaultMessage:"Select people",id:"automationPersonPicker.defaultMenuHeaderMessage"},personValuePickerPlaceholder:{defaultMessage:"Select up to {maxSelected} people...",id:"automations.personPicker.buttonPlaceholder"}});function hi(e){const{currentValue:t,collectionStore:o,disabled:n,onChange:i,formulaTypecheckContextValues:a,menuHeader:r,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d}=e,p={type:"person_array"},m=(0,E().tz)(),g=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},y={menuType:Oo().gu.Popup,header:(0,Fe.jsx)(Mt().A,{title:r?m.formatMessage(r):m.formatMessage(yi.defaultMenuHeader)})};return(0,Fe.jsx)(gi().U,{allowedReturnTypes:jo().Yy.person,formulaTypecheckContextValues:a,disabled:n,simpleFormulaContext:g,onChange:i,type:p,value:t,menuProps:y,placeholder:l?m.formatMessage(yi.personValuePickerPlaceholder,{maxSelected:l}):void 0,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d})}var fi=()=>o(643919);const vi=(0,E().YK)({property:{id:"automationAction.sendInAppNotification.targetType.property",defaultMessage:"Person property"},formula:{id:"automationAction.sendInAppNotification.targetType.formula",defaultMessage:"Specific people"},default:{id:"automations.targetPicker.targetTypePlaceholder",defaultMessage:"Select recipients"}});function xi(e){const{disabled:t,errorMessage:o,selectedTargetType:n,onSelectedTargetTypeChange:i}=e,a=(0,le().uB)(void 0,it().A),r=(0,je().j)(),l=(0,ae.useCallback)((e=>{e!==n&&(i(e),a.reset())}),[i,a,n]);return(0,Fe.jsx)(et().Ay,{buttonPopupStore:a,popupType:r,alignmentToOrigin:et().yP.End,placementToOrigin:et().sx.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,Fe.jsx)(xt().x,{...e,disabled:t,isCompact:!0,isError:Boolean(o),hasActionRequired:!Boolean(n),dropdownButtonType:"dropdown",children:n?(0,Fe.jsx)(E().sA,{...vi[n]}):(0,Fe.jsx)(E().sA,{...vi.default})}),render:e=>(0,Fe.jsx)(bi,{handleChange:l,selectedTargetType:n})})}function bi(e){const{handleChange:t}=e,o=(0,jt().e)(),n=[(0,ae.useMemo)((()=>({action:()=>null,key:"selectUsers",render:e=>(0,Fe.jsx)(Ze().A,{...e,onClick:()=>t("formula"),title:(0,Fe.jsx)(E().sA,{...vi.formula})})})),[t]),(0,ae.useMemo)((()=>({action:()=>null,key:"selectPersonProperty",render:e=>(0,Fe.jsx)(Ze().A,{...e,onClick:()=>t("property"),title:(0,Fe.jsx)(E().sA,{...vi.property})})})),[t])].filter(s().O9);if(0===n.length)return null;const i={items:n,key:"targetType",render:e=>(0,Fe.jsx)(Mt().A,{topBorder:!0,...e,enableActionSheetTitle:!0})};return(0,Fe.jsx)(At().A,{...o,children:(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,sections:[i],initialFocus:0})})}const Si=(0,E().YK)({notificationMessageLabel:{defaultMessage:"Message",id:"automations.BaseModalAction.notificationMessageLabel"},personPropertyTargetTypeLabel:{defaultMessage:"Property",id:"automations.SendInAppNotificationAction.personPropertyTargetTypeLabel"},usersTargetTypeLabel:{defaultMessage:"People",id:"automations.SendInAppNotificationAction.usersTargetTypeLabel"},propertyPickerPlaceholder:{defaultMessage:"Select a property",id:"automations.SendInAppNotificationAction.propertyPickerPlaceholder"},personValuePickerMenuHeader:{defaultMessage:"Send notification to",id:"automations.personPicker.menuHeader"}});function Ci(e){const{noCollection:t,targetsErrorMessage:o,selectedTargetType:n,disabled:i,onTargetTypeChange:a}=e;return t?(0,Fe.jsx)(E().sA,{defaultMessage:"Send notification to specific people",id:"automations.SendInAppNotificationAction.header.titleButtonBlock",values:{placeholder:"specific people"}}):(0,Fe.jsx)(E().sA,{defaultMessage:"Send notification to{targetTypePicker}",id:"automations.SendInAppNotificationAction.header.title",values:{targetTypePicker:(0,Fe.jsx)(xi,{onSelectedTargetTypeChange:a,disabled:i,errorMessage:o,selectedTargetType:n})}})}function Ai(e){const{isError:t,isMobile:o,selectedTargetType:n}=e,i=(0,se().IS)((e=>({inputLabel:{color:t?e.text.uiRedPrimary:e.text.secondary,fontSize:o?ce().J.UIRegular.mobile:ce().J.UIRegular.desktop,lineHeight:o?ce().K_.UIRegular.mobile:ce().K_.UIRegular.desktop,fontWeight:ce().Wy.regular}})),[t,o]),a=(0,le().K8)((()=>{switch(n){case"property":return Si.personPropertyTargetTypeLabel;case"formula":return Si.usersTargetTypeLabel;default:(0,s().HB)(n)}}),[n]);return(0,Fe.jsx)("label",{style:i.inputLabel,children:(0,Fe.jsx)(E().sA,{...a})})}const ki=20;function Mi(e){const{collectionStore:t,currentProperties:o,currentTargetValue:n,disabled:i,errorMessage:a,formulaTypecheckContextValues:r,onTargetValueChange:l,parentRecordStore:c,spaceId:u}=e,d=n.type;switch(d){case"formula":return(0,Fe.jsx)(hi,{collectionStore:t,currentValue:n.value,disabled:Boolean(i),onChange:e=>l({type:"formula",value:e}),parentRecordStore:c,formulaTypecheckContextValues:r,menuHeader:Si.personValuePickerMenuHeader,limit:ki,errorMessage:a,spaceId:u,style:{width:"100%"}});case"property":return t?(0,Fe.jsx)(fi().l,{availablePropertyIds:o,currentValue:n.propertyId,collectionStore:t,onChange:e=>l({type:"property",propertyId:e}),disabled:Boolean(i),alreadyHaveProperties:Boolean(n.propertyId),placeholderMessage:Si.propertyPickerPlaceholder,errorMessage:a}):null;default:(0,s().HB)(d)}}function ji(e,t){if("formula"===t.type||!(0,s().O9)(t.value))return{type:"simple",value:void 0};const o=t.value.filter((t=>{if(!(0,y().qXl)(t))return!1;const o=(0,y().uPN)(t),n=(0,y().snh)(o);if(n){const t=(0,y().NcG)(n);return!new(K().LU)(e,{id:t,table:S().oo},{userId:t}).getIsDeleted()}return(0,y().tVx)(o)}));return{type:"simple",value:(0,Nt().toSimpleFormulaArrayValue)((0,Nt().filterTextValueToSimpleFormulaValueTokens)(o))}}o(113085);var Ti=()=>o(904226),Ii=()=>o(610271),wi=()=>o(366436);const _i=(0,E().YK)({addCustomHeader:{defaultMessage:"Add custom header",id:"automations.BaseModalAction.addCustomHeader"},customHeaderKeyLabel:{defaultMessage:"Key",id:"automations.BaseModalAction.customHeaderKeyLabel"},customHeaderValueLabel:{defaultMessage:"Value",id:"automations.BaseModalAction.customHeaderValueLabel"},removeCustomHeaderAriaLabel:{defaultMessage:"Remove custom header",id:"automations.BaseModalAction.removeCustomHeaderAriaLabel"}});function Pi(e){const{actionStore:t}=e,o=(0,E().tz)(),n=qi(),{suppressActionErrors:i}=(0,Ke().b)(),{typecheckResult:a}=(0,Se().EC)(),[r,s]=(0,ae.useState)(new Set),[c,u]=(0,ae.useState)((()=>new(wi().A))),d=(0,le().K8)((()=>{if(!l().Q.isSuccess(a))return new(wi().A);const e=i.includes(t.id),o=a.value.actionValidationFailures[t.id]||[],n=new(wi().A);return o.forEach((t=>{if("empty_custom_header_field"===t.type){const[o,i,a]=t.key;n.set({id:i,field:a},!e&&!r.has(i)||(c.get({id:i,field:a})||!1))}})),n}),[a,i,t.id,c,r]),{maybePersistedTransactionActions:p}=(0,Ke().b)(),m=(0,se().IS)((()=>({customHeadersContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:12},customHeaderInputsContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr 1fr auto",alignItems:"center",columnGap:8,rowGap:4},customHeaderKeyLabel:{...n.inputLabel,gridRow:1,gridColumn:1},customHeaderValueLabel:{...n.inputLabel,gridRow:1,gridColumn:2},customHeaderKeyInput:{...n.input,gridRow:2,gridColumn:1},customHeaderValueInput:{...n.input,gridRow:2,gridColumn:2},customHeaderRemoveButton:{gridRow:2,gridColumn:3,width:32,height:32},customHeaderRemoveButtonIcon:{width:Je().Ev.default,height:Je().Ev.default},addCustomHeaderButton:{marginLeft:-8,marginTop:8}})),[n]),g=(0,le().K8)((()=>t.getConfigStore().getKeyStore("customHeaders")),[t]),y=(0,le().K8)((()=>(g.getValue()||[]).map((e=>({...e,id:e.id||(0,Vt().Ay)()})))),[g]),h=(0,ae.useCallback)(((e,t)=>()=>{const o=new(wi().A)({from:c.entries()});o.set({id:e,field:t},!0),u(o)}),[c]),f=(0,ae.useCallback)(((e,t)=>o=>{const n=(g.getValue()||[]).map((n=>n.id===e?{...n,[t]:o}:n));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{X().KY({store:g,transaction:e,value:n})}})}),[g,p]),v=(0,ae.useCallback)((()=>{p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{const t={id:(0,Vt().Ay)(),key:"",value:""};X().KY({store:g,transaction:e,value:[...y,t]}),s((e=>{const o=new Set(e);return o.add(t.id),o}))}})}),[y,g,p]),x=(0,ae.useCallback)((e=>()=>{const t=y.filter((t=>t.id!==e));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{X().KY({store:g,transaction:e,value:t})}})}),[y,g,p]),b=y.length>0&&(0,Fe.jsx)("div",{style:m.customHeadersContainer,children:y.map((e=>(0,Fe.jsxs)("div",{style:m.customHeaderInputsContainer,children:[(0,Fe.jsx)("label",{style:m.customHeaderKeyLabel,children:(0,Fe.jsx)(E().sA,{..._i.customHeaderKeyLabel})}),(0,Fe.jsx)("label",{style:m.customHeaderValueLabel,children:(0,Fe.jsx)(E().sA,{..._i.customHeaderValueLabel})}),(0,Fe.jsx)("div",{}),(0,Fe.jsx)(He,{style:m.customHeaderKeyInput,value:e.key,onChange:f(e.id,"key"),errorOutline:d.get({id:e.id,field:"key"}),onBlur:h(e.id,"key"),autoFocus:!e.key,maxlength:Ti().Sx}),(0,Fe.jsx)(He,{style:m.customHeaderValueInput,value:e.value,onChange:f(e.id,"value"),errorOutline:d.get({id:e.id,field:"value"}),onBlur:h(e.id,"value"),maxlength:Ti().Sx}),(0,Fe.jsx)(Be().A,{icon:Qt().trashIcon,ariaLabel:o.formatMessage(_i.removeCustomHeaderAriaLabel),style:m.customHeaderRemoveButton,iconStyle:m.customHeaderRemoveButtonIcon,onClick:x(e.id)})]},e.id)))});return(0,Fe.jsxs)(Fe.Fragment,{children:[b,y.length<Ti().qu&&(0,Fe.jsx)(Ii().Ye,{children:(0,Fe.jsx)(Ft().p,{isGray:!0,onClick:v,style:m.addCustomHeaderButton,children:(0,Fe.jsx)(E().sA,{..._i.addCustomHeader})})})]})}var Bi=()=>o(350492),Ri=()=>o(598995),Vi=()=>o(579494),Ei=()=>o(392608);function Di(e){const t=(0,re().v3)(),o=(0,E().tz)();return(0,Fe.jsx)(Ve().A,{renderTooltip:()=>(0,Fe.jsx)(E().sA,{defaultMessage:"Learn more",id:"webhookAction.helpButton.tooltip"}),render:e=>(0,Fe.jsx)(Vi().A,{...e,href:(0,Ei().xS)("guides.webhookAction"),onClick:()=>Ri().FH(t,{from:"webhookAction"}),external:!0,children:(0,Fe.jsx)(Be().A,{...e,ariaLabel:o.formatMessage({id:"webhookAction.helpButton.ariaLabel",defaultMessage:"Learn about webhook actions"}),icon:Bi().questionMarkCircleSmallIcon,iconStyle:{width:Je().Ev.sm,height:Je().Ev.sm}})})})}Di.displayName="SendWebhookActionHelpLink";var Fi=()=>o(716605),Oi=()=>o(916963),Ni=()=>o(200524);const Li=new Set(["title","text","relation","checkbox","number","person","file","url","email","phone_number","created_time","created_by","last_edited_time","last_edited_by","last_visited_time","formula","rollup","select","multi_select","date","status","auto_increment_id","location","verification","geo_point"]);const Wi=(0,E().YK)({selectAllPropertiesDescription:{defaultMessage:"New properties will not be included automatically",id:"automations.BaseModalAction.selectAllPropertiesDescription"},selectAllProperties:{defaultMessage:"Select all existing properties",id:"automations.BaseModalAction.selectAllProperties"},propertyPickerLabel:{defaultMessage:"Content",id:"automations.BaseModalAction.propertyPickerLabel"},propertyDisabledMissingPermissionTooltip:{defaultMessage:"This property references a database you don't have access to",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledMissingPermissionTooltip"},propertyDisabledUnsupportedTypeTooltip:{defaultMessage:"This property type is not supported",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledUnsupportedTypeTooltip"}});function zi(){return(0,se().IS)((e=>({buttonMenuItemContent:{height:34,gap:6},buttonMenuItem:{borderRadius:4}})),[])}function Ki(e){let{collectionStore:t,value:o,onChange:n}=e;const i=zi(),a=qi(),l=(0,le().K8)((()=>t.getSchema()),[t]),s=(0,ae.useMemo)((()=>new Set("some"===o.type?o.some||[]:Object.keys(l))),[l,o]),c=function(e){const{value:t}=(0,nt().fJ)(j().T.formulas),{value:o}=(0,nt().fJ)(j().T.formulaPermissions),n=(0,xn().X)("collections_xws"),i=(0,le().K8)((()=>{if(!t)return;const o=(0,I().i)();return{allowedReturnTypes:[{type:"unknown"}],handleDataRequest:(0,f().MC)({collectionFeatureGates:o,experimentService:_().default,getRecordModel:e.getRecordModel,loadRecordModel:e.loadRecordModel}),restrictUnaccessibleProperties:n?"cross_space_and_read_permissions":"read_permissions_only",spaceId:e.getSpaceId(),valueTypes:[],featureGates:o}}),[t,e,n]),[a]=(0,mn().Yb)((async()=>{if(!t||!i||!o)return;const n=e.getSchema(),a=Object.keys(n),r=await(0,G().lX)(a,3,(async t=>{const a=(0,Fi()._g)({schema:n,property:t});if(a)return Li.has(a.type)?await o.hasAccessToProperty({collectionPointer:e.pointer,collectionSchema:n,context:i,propertyId:t,hasAccessFn:o.hasAccessDefaultFn})?void 0:"missing_permission":"unsupported_property_type"})),l=new Map;return r.forEach(((e,t)=>{l.set(a[t],e)})),l.size>0?l:void 0}),[e,i,t,o]);return a}(t),u=(0,ae.useMemo)((()=>c.value||new Map),[c]),d=(0,ae.useMemo)((()=>new Set(Array.from(u.entries()).filter((e=>{let[t,o]=e;return void 0===o})).map((e=>{let[t]=e;return t})))),[u]),p=(0,ae.useMemo)((()=>"some"===o.type&&(0,Ni()._)(s,d)),[o.type,s,d]),m=(0,ae.useRef)(null),g=(0,ae.useCallback)((e=>{s.has(e)?s.delete(e):s.add(e),n({type:"some",some:Array.from(s)})}),[s,n]),y=(0,se().IS)((e=>({sectionMenuItem:{padding:8},propertyPickerContainer:{display:"flex",flexDirection:"column",border:`1px solid ${e.regularDividerColor}`,borderRadius:8,maxHeight:212,overflowY:"auto",marginBottom:2},selectAllPropertiesButtonTitle:{display:"flex",alignItems:"center",gap:4},selectAllPropertiesCheckboxContainer:{height:34,width:30,display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4},selectAllPropertiesCheckbox:{cursor:"pointer"}})),[]),h=(0,ae.useCallback)((()=>{n(p?{type:"some",some:[]}:{type:"some",some:Array.from(d.values())})}),[p,n,d]);(0,ae.useEffect)((()=>{m.current&&(m.current.indeterminate=s.size>0&&!p)}),[p,s,o.type]);const v=Object.keys(l),x=(0,ae.useMemo)((()=>v.sort(((e,t)=>{const o=(0,Fi()._g)({schema:l,property:e}),n=(0,Fi()._g)({schema:l,property:t});if("title"===(null==o?void 0:o.type))return-1;if("title"===(null==n?void 0:n.type))return 1;const i=(null==o?void 0:o.name)||"",a=(null==n?void 0:n.name)||"";return i.localeCompare(a)}))),[v,l]);if(!u)return null;const b=(0,r().oE)(x.map((e=>{const t=(0,Fi()._g)({schema:l,property:e});if(!t)return null;return{key:e,render:o=>(0,Fe.jsx)(Hi,{...o,propertySchema:t,selected:s.has(e),noAccessReason:u.get(e),buttonStyle:i.buttonMenuItem,style:i.buttonMenuItemContent}),action:()=>{g(e)}}}))),S=(0,r().oE)([{key:0,render:e=>(0,Fe.jsx)(Mt().A,{...e,style:y.sectionMenuItem}),items:[{key:0,render:e=>(0,Fe.jsx)(Ze().A,{...e,style:i.buttonMenuItemContent,buttonStyle:i.buttonMenuItem,title:(0,Fe.jsxs)("div",{style:y.selectAllPropertiesButtonTitle,children:[(0,Fe.jsx)(E().sA,{...Wi.selectAllProperties}),(0,Fe.jsx)(Ui,{})]}),leftStyle:y.selectAllPropertiesCheckboxContainer,left:(0,Fe.jsx)("input",{type:"checkbox",readOnly:!0,checked:p,ref:m,style:y.selectAllPropertiesCheckbox})}),action:h}]},{key:1,render:e=>(0,Fe.jsx)(Mt().A,{topBorder:!0,style:y.sectionMenuItem,...e}),items:b}]);return(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)("label",{style:a.inputLabel,children:(0,Fe.jsx)(E().sA,{...Wi.propertyPickerLabel})}),(0,Fe.jsx)("div",{style:y.propertyPickerContainer,children:(0,Fe.jsx)(kt().Ay,{type:kt().Oh.Vertical,sections:S,initialFocus:void 0,resetFocusOnMouseOut:!0})})]})}function Hi(e){const{propertySchema:t,noAccessReason:o}=e,n=(0,se().DP)(),i=(0,re().v3)(),{name:a,type:r,icon:l}=t,s=zi(),c=(0,se().IS)((e=>({buttonMenuItemTitle:{color:o?e.text.tertiary:e.text.secondary},propertyIcon:{fill:o?e.icon.tertiary:e.icon.secondary,height:Je().Ev.sm,width:Je().Ev.sm,display:"flex",alignItems:"center",justifyContent:"center"},checkBoxInput:{cursor:o?void 0:"pointer"},checkboxContainer:{height:34,width:30,display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4}})),[o]),u=(0,Fe.jsx)(Ze().A,{title:a,disabled:Boolean(o),style:s.buttonMenuItemContent,titleStyle:c.buttonMenuItemTitle,icon:(0,Fe.jsx)(Oi().zB,{icon:l,type:r,size:i.device.isMobile?18:16,theme:n,style:c.propertyIcon}),left:(0,Fe.jsx)("div",{style:c.checkboxContainer,children:(0,Fe.jsx)("input",{type:"checkbox",readOnly:!0,checked:e.selected,disabled:Boolean(o),style:c.checkBoxInput})}),...e});return o?(0,Fe.jsx)(Yi,{noAccessReason:o,children:u}):u}function Ui(){return(0,Fe.jsx)(Ve().A,{renderTooltip:()=>(0,Fe.jsx)(E().sA,{...Wi.selectAllPropertiesDescription}),render:e=>(0,Fe.jsx)("div",{...e,children:(0,Fe.jsx)(ot().I,{icon:Bi().questionMarkCircleSmallIcon,size:"sm",color:"secondary"})}),placement:Ut().W.Top})}function Yi(e){const{children:t,noAccessReason:o}=e;return(0,Fe.jsx)(Ve().A,{renderTooltip:()=>"missing_permission"===o?(0,Fe.jsx)(E().sA,{...Wi.propertyDisabledMissingPermissionTooltip}):"unsupported_property_type"===o?(0,Fe.jsx)(E().sA,{...Wi.propertyDisabledUnsupportedTypeTooltip}):void(0,s().HB)(o),originGap:0,render:e=>(0,Fe.jsx)("div",{...e,children:t}),placement:Ut().W.Left})}const Gi=(0,E().YK)({urlInputLabel:{defaultMessage:"URL",id:"automations.BaseModalAction.urlInputLabel"}});function qi(){const{isMobile:e}=(0,re().Y0)();return(0,se().IS)((t=>({inputLabel:{color:t.text.secondary,fontSize:e?ce().J.UIRegular.mobile:ce().J.UIRegular.desktop},input:{backgroundColor:t.contentBackground,paddingTop:6,paddingBottom:6},helpText:{color:t.text.secondary,fontSize:e?ce().J.UISmall.mobile:ce().J.UISmall.desktop}})),[e])}const Xi={create_page:function(e){const{actionStore:t}=e,n=(0,re().v3)(),{automationStore:i}=(0,Se().EC)(),{disabled:r,maybePersistedTransactionActions:l,suppressActionErrors:c}=(0,Ke().b)(),u=(0,a().getActionRegistryItem)("create_page"),[d,p]=(0,le().K8)((()=>{const e=t.getConfig();return[null==e?void 0:e.properties,null==e?void 0:e.values]}),[t]),[m,g]=(0,le().K8)((()=>{const e=t.getCollectionStore();return null!=e&&e.isDefined()?[e,{collection:e.getSpaceShardedPointer(),type:"collection"}]:[void 0,void 0]}),[t]),y=(0,le().K8)((()=>pt(m).length>0),[m]),h=(0,le().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.template_page_id}),[t]),f=(0,ae.useMemo)((()=>({values:p??{},properties:d??[]})),[p,d]),v=(0,le().uB)(void 0,it().A),x=(0,ae.useCallback)((()=>v.reset()),[v]),b=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:x})),[t,x]),S=(0,le().K8)((()=>(0,s().O9)(t.getConfigStore().getKeyStore("collection").getValue())),[t]),C=(0,ae.useCallback)((e=>{"collection"===e.type&&(l.createAndCommit({perform:o=>{X().zv({data:{collection:e.collection,properties:["title"],template_page_id:null,values:null},store:t.getConfigStore(),transaction:o})},userAction:"CreatePageAction.setCollection"}),(0,ut().UB)(n,{automationStore:i,automationActionStore:t}))}),[l,n,i,t]),A=(0,ae.useCallback)((e=>{const{properties:o,values:a}=f;let r=!1;if(e&&o&&1===o.length&&o.includes("title")){var s;const e=null==a?void 0:a.title;e&&null!==(s=e.value)&&void 0!==s&&s.value||(r=!0)}l.createAndCommit({perform:o=>{X().zv({store:t.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:o})},userAction:"CreatePageAction.onTemplateChange"}),(0,ut().UB)(n,{automationStore:i,automationActionStore:t})}),[f,l,n,i,t]),k=(0,ae.useMemo)((()=>!c.includes(t.id)),[c,t]),{errorMessage:M,errorIcon:j}=(0,ie().useErrorComponentForAction)({actionId:t.id,errorKeys:["collection","config",t.id],shouldShow:k}),{errorMessage:T}=(0,ie().useErrorComponentForAction)({actionId:t.id,errorKey:"template",shouldShow:k}),I=Boolean(r);return(0,Fe.jsxs)(wt().OT,{actionId:t.id,actionMenu:b,buttonPopupStore:v,canCollapse:S,disabled:I,children:[(0,Fe.jsxs)(wt().h3,{actionId:t.id,actionRegistryItem:u,disabled:I,errorMessage:M||T,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:[(0,Fe.jsx)(_t,{actionStore:t,disabled:I,errorMessage:M,errorIcon:j,onChange:C,value:g}),(0,s().O9)(m)&&y&&(0,Fe.jsx)(Pt,{collectionStore:m,disabled:I,errorMessage:T,onChange:A,value:h})]}),m&&(0,Fe.jsx)(wt().qt,{disabled:I,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,Fe.jsx)(o(151028).Ud,{actionStore:t,collectionStore:m,disabled:I,showSetPropertyActions:!1})})]})},update_pages:o(270946).w,query_collection:function(){return null},open_page:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,Ke().b)(),r=(0,le().uB)(void 0,it().A),l=(0,a().getActionRegistryItem)("open_page"),s=(0,le().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),{contextType:c}=(0,Se().EC)(),u=(0,le().K8)((()=>{if(!(0,jo().Fx)(c))return;const e=t.getIndex();return(0,jo().cQ)(e)?"allow":"disallow_with_message"}),[t,c]),d=(0,le().K8)((()=>s&&"url"!==s.type),[s]),p=(0,ae.useMemo)((()=>({headerWrap:{paddingInlineEnd:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}})),[]),m=(0,ae.useCallback)((e=>{n.createAndCommit({perform:o=>{X().zv({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"OpenPageAction.setTarget"})}),[n,t]),g=(0,ae.useCallback)((e=>{n.createAndCommit({perform:o=>{X().zv({store:t.getConfigStore(),data:{open_in:e},transaction:o})},userAction:"OpenPageAction.setPeekMode"})}),[n,t]),y=(0,ae.useCallback)((()=>r.reset()),[r]),h=(0,ae.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:f}=(0,ie().useErrorComponentForAction)({actionId:t.id,shouldShow:h}),v=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:y})),[t,y]),x=Boolean(o);return(0,Fe.jsx)(wt().OT,{actionMenu:v,buttonPopupStore:r,actionId:t.id,canCollapse:!1,children:(0,Fe.jsxs)(wt().h3,{actionId:t.id,actionRegistryItem:l,disabled:x,styles:p,children:[(0,Fe.jsx)(wo,{actionStore:t,disabled:x,errorMessage:f,onChange:m,value:s,urlBehavior:u}),d?(0,Fe.jsx)(_o,{actionStore:t,disabled:x,onChange:g}):null]})})},duplicate_blocks:function(e){const{actionStore:t}=e,{disabled:o,editorPlacement:n}=(0,Ke().b)(),i=(0,re().v3)(),l=(0,se().IS)((()=>({title:{display:"inline-flex",flexWrap:"wrap",gap:6,whiteSpace:"pre-wrap"}})),[]),s=(0,le().K8)((()=>(0,r().$1)(t.getBlockPointers())),[t],{useDeepEqual:!0}),c=(0,le().K8)((()=>function(e){const t=Object.values(fo).find((t=>t.key===e));return t??vo}(t.getInsertionPoint())),[t]),u=(0,ae.useCallback)((e=>function(e,t,o){Q().createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:e,canUndo:!0,perform:e=>{X().zv({store:t.getConfigStore(),data:{insertion_point:o},transaction:e})}})}(i,t,e)),[t,i]),d=(0,le().uB)(void 0,it().A),p=(0,ae.useCallback)((()=>d.reset()),[d]),m=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:p})),[t,p]),g=(0,a().getActionRegistryItem)("duplicate_blocks"),y=Boolean(o);return(0,Fe.jsxs)(wt().OT,{actionMenu:m,buttonPopupStore:d,disabled:y,actionId:t.id,canCollapse:!0,children:[(0,Fe.jsx)(wt().h3,{actionId:t.id,actionRegistryItem:g,disabled:y,children:(0,Fe.jsx)("div",{style:l.title,children:(0,Fe.jsx)(E().sA,{...ho.title,values:{insertionPicker:(0,Fe.jsx)(xo,{currentOption:c,disabled:y,onChange:u})}})})}),(0,Fe.jsx)(wt().qt,{disabled:y,children:s?(0,Fe.jsx)(So,{actionStore:t,buttonPlacement:n,contentParentPointer:s,disabled:y}):null})]})},modal_confirmation:function(e){const{actionStore:t}=e,o=(0,re().v3)(),{isMobile:n}=(0,re().Y0)(),{automationStore:i}=(0,Se().EC)(),r=(0,E().tz)(),{disabled:l,maybePersistedTransactionActions:s}=(0,Ke().b)(),c=Boolean(l),u=(0,a().getActionRegistryItem)("modal_confirmation"),[d,p]=(0,le().K8)((()=>[t.id,t.getSpaceId()]),[t]),m=(0,vt().F)({actionId:d}),g=(0,se().IS)((e=>({input:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6},inputLabel:{color:e.text.tertiary,fontSize:n?14:12,lineHeight:1.3,fontWeight:ce().Wy.medium,display:"flex",alignItems:"center"}})),[n]),y=(0,le().uB)(void 0,it().A),h=(0,ae.useCallback)((()=>y.reset()),[y]),f=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:h})),[t,h]),v=(0,le().K8)((()=>t.getConfigStore().getKeyStore("text")),[t]),x=(0,le().K8)((()=>v.getValue()),[v]),b=(0,le().K8)((()=>{if(p)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,Co().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:p,valueTypes:m.slice(0),featureGates:(0,I().i)()},value:x})}),[p,t.getRecordModel,m,x]),S=(0,le().K8)((()=>t.getConfigStore().getKeyStore("continue_button").getKeyStore("text")),[t]),C=(0,le().K8)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]),A=(0,ae.useCallback)((e=>{s.createAndCommit({userAction:"BaseModalAction.handleTextChange",perform:t=>{X().KY({store:v,value:e,transaction:t})}}),(0,ut().UB)(o,{automationStore:i,automationActionStore:t})}),[t,i,o,s,v]),k=(0,ae.useCallback)((()=>{(0,ut().UB)(o,{automationStore:i,automationActionStore:t})}),[t,i,o]),{onTextStoreSelect:M,onTextStoreUnselect:j}=(0,zt().W)(t);return p&&b?(0,Fe.jsxs)(wt().OT,{actionMenu:f,buttonPopupStore:y,disabled:c,actionId:t.id,canCollapse:!0,children:[(0,Fe.jsx)(wt().h3,{actionId:t.id,actionRegistryItem:u,disabled:c,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Fe.jsx)(E().sA,{...u.display.name})}),(0,Fe.jsx)(wt().qt,{disabled:c,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:16,children:[(0,Fe.jsx)(ko().M,{disabled:c,disableMobileActionBar:!0,formulaTypecheckContextValues:m,onChange:A,onTextStoreSelect:M,onTextStoreUnselect:j,parentRecordStore:t,placeholder:r.formatMessage(Mo.confirmationMessageLabel),rows:4,spaceId:p,value:x,analyzedFormulaOutput:b,labelMessageDescriptor:Mo.confirmationMessageLabel}),(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:6,children:[(0,Fe.jsx)("label",{style:g.inputLabel,children:(0,Fe.jsx)(E().sA,{...Mo.continueButtonTextLabel})}),(0,Fe.jsx)(Ue,{disabled:c,maxlength:Ao().Vx,onChange:k,style:g.input,store:S})]}),(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:6,children:[(0,Fe.jsx)("label",{style:g.inputLabel,children:(0,Fe.jsx)(E().sA,{...Mo.cancelButtonTextLabel})}),(0,Fe.jsx)(Ue,{disabled:c,maxlength:Ao().Vx,onChange:k,style:g.input,store:C})]})]})})]}):null},slack_notification:o(358780).y9,send_in_app_notification:function(e){var t;const{actionStore:o}=e,{isMobile:n}=(0,re().Y0)(),{automationStore:i,contextType:r}=(0,Se().EC)(),{disabled:l,maybePersistedTransactionActions:c,suppressActionErrors:u}=(0,Ke().b)(),d=(0,rn().y)(i,r),p=!(0,s().O9)(d),m=Boolean(l),g=(0,a().getActionRegistryItem)("send_in_app_notification"),y=(0,le().K8)((()=>o.getSpaceId()),[o]),h=(0,le().K8)((()=>null==d?void 0:d.getSpaceShardedPointer()),[d]),f=(0,le().K8)((()=>{if(!d)return[];return(0,jo().Ge)({collectionFormat:d.getFormat(),collectionSchema:d.getSchema(),spaceId:d.getSpaceId(),restrictCrossSpace:_().default.checkGate({gateName:"collections_xws"})})}),[d]),v=(0,le().K8)((()=>{var e;return null==o||null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),x=(0,vt().F)({actionId:o.id}),b=(0,re().v3)();ln("formula"===(null==v?void 0:v.type)?null==v||null===(t=v.value)||void 0===t?void 0:t.value:void 0);const S=(0,le().K8)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.notification_message}),[o]),C=(0,le().K8)((()=>{if(y)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,Co().createFormulaDataRequestSyncHandler)(o.getRecordModel),spaceId:y,valueTypes:x.slice(0),featureGates:(0,I().i)()},value:S})}),[o.getRecordModel,S,x,y]),A=(0,le().uB)(void 0,it().A),k=(0,ae.useCallback)((()=>A.reset()),[A]),M=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:o,closeMenu:k})),[o,k]),j=(0,ae.useMemo)((()=>!u.includes(o.id)),[u,o]),{errorMessages:T,errorMessageDescriptors:w}=function(e){const{actionId:t,shouldShowError:o}=e,n={},i={};n.target=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"target"}).errorMessage;const a=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"notification_message"});return n.notification_message=a.errorMessage,i.notification_message=a.errorMessageDescriptor,n.collectionPointer=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"collectionPointer"}).errorMessage,n.propertyId=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"propertyId"}).errorMessage,n.formulaValue=(0,ie().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"formulaValue"}).errorMessage,{errorMessages:n,errorMessageDescriptors:i}}({actionId:o.id,shouldShowError:j}),P=(0,le().K8)((()=>(0,s().O9)(o.getConfigStore().getKeyStore("target").getValue())),[o]),B=(0,ae.useCallback)((e=>{c.createAndCommit({perform:t=>{X().zv({data:{target:{type:e}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTargetType"})}),[o,c]);(0,ae.useEffect)((()=>{!v&&p&&B("formula")}),[v,p,B]);const R=(0,ae.useCallback)((e=>{const t=e.value;if(!t)return;let n;"formula"===t.type?n={type:"formula",value:t}:"simple"===t.type?n={type:"formula",value:ji(b,t)}:(0,s().HB)(t.type),c.createAndCommit({perform:e=>{X().zv({data:{target:{type:"formula",value:n.value}},store:o.getConfigStore(),transaction:e})},userAction:"SendInAppNotificationAction.setTarget"}),(0,ut().UB)(b,{automationStore:i,automationActionStore:o})}),[i,o,b,c]),V=(0,ae.useCallback)((e=>{c.createAndCommit({perform:t=>{X().zv({data:{target:{...e,collectionPointer:h}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTarget"}),(0,ut().UB)(b,{automationStore:i,automationActionStore:o})}),[o,i,h,b,c]),E=(0,ae.useCallback)((e=>{switch(e.type){case"formula":return R(e);case"property":return V(e);default:(0,s().HB)(e)}}),[R,V]),D=(0,ae.useCallback)((e=>{c.createAndCommit({perform:t=>{X().zv({data:{notification_message:e},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setNotificationMessage"}),(0,ut().UB)(b,{automationStore:i,automationActionStore:o})}),[o,i,b,c]),{onTextStoreSelect:F,onTextStoreUnselect:O}=(0,zt().W)(o),N=(0,ae.useCallback)((()=>{ue().clear({environment:b})}),[b]);return y&&C?(0,Fe.jsxs)(wt().OT,{actionMenu:M,buttonPopupStore:A,disabled:m,actionId:o.id,canCollapse:P,children:[(0,Fe.jsx)(wt().h3,{actionId:o.id,actionRegistryItem:g,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Fe.jsx)(Ci,{noCollection:p,targetsErrorMessage:T.target,selectedTargetType:null==v?void 0:v.type,onTargetTypeChange:B,disabled:Boolean(l)})}),v&&(0,Fe.jsx)(wt().qt,{children:(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:16,children:[(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:6,children:[(0,Fe.jsx)(Ai,{isMobile:n,selectedTargetType:v.type,isError:Boolean("property"===v.type?T.propertyId:T.formulaValue)}),(0,Fe.jsx)("div",{children:(0,Fe.jsx)(Mi,{collectionStore:d,disabled:Boolean(l),formulaTypecheckContextValues:x,currentTargetValue:v,currentProperties:f,onTargetValueChange:E,errorMessage:"property"===v.type?T.propertyId:T.formulaValue,parentRecordStore:o,spaceId:y})})]}),(0,Fe.jsx)(ko().M,{analyzedFormulaOutput:C,labelMessageDescriptor:Si.notificationMessageLabel,disabled:m,disableMobileActionBar:!0,disableTemplateVariableMentions:!0,errorMessageDescriptor:w.notification_message,formulaTypecheckContextValues:x,onChange:D,onTextStoreSelect:F,onTextStoreUnselect:O,onTextEsc:N,parentRecordStore:o,rows:3,spaceId:y,value:S})]})})]}):null},send_gmail_notification:function(e){const{actionStore:t}=e,o=function(e){return(0,le().K8)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(!t)return;return an().A.externalAuthentications.state.find((e=>e.integration_id===Zo().eg&&t===e.id))}),[e])}(t),n=(0,le().K8)((()=>an().A.externalAuthentications.state.filter((e=>e.integration_id===Zo().eg))),[]);return(0,Fe.jsx)(ui,{actionStore:t,gmailAuthentications:n,currentGmailAuthentication:o,allGmailAuthentications:n})},define_variables:function(e){const{actionStore:t}=e,o=(0,re().v3)(),n=(0,E().tz)(),{automationStore:i}=(0,Se().EC)(),{disabled:r,maybePersistedTransactionActions:l}=(0,Ke().b)(),s=Boolean(r),c=(0,a().getActionRegistryItem)("define_variables"),u=(0,le().K8)((()=>i.getActionStores()),[i]),d=(0,le().K8)((()=>{const e=t.getConfigStore().getValue();return{values:(null==e?void 0:e.values)??{},variableIds:(null==e?void 0:e.variableIds)??[]}}),[t]),p=(0,le().uB)(void 0,it().A),m=(0,ae.useCallback)((()=>p.reset()),[p]),g=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:m})),[t,m]),y=(0,ae.useCallback)((()=>{l.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,intl:n,transaction:i}=e,a=(0,Vt().Ay)(),r={name:(0,Et().v)(o,n.formatMessage(Rt().xC)),value:{type:"simple",value:[[""]]}};X().zv({data:{[a]:r},store:t.getConfigStore().getKeyStore("values"),transaction:i}),Q().applyOperation({operation:{args:{id:a},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:i})}({automationActionStore:t,automationActionStores:u,intl:n,transaction:e})},userAction:"DefineVariablesAction.addVariable"}),(0,ut().UB)(o,{automationStore:i,automationActionStore:t})}),[t,u,i,o,n,l]),h=(0,se().IS)((()=>({headerWrap:{paddingRight:32},titleWrap:{whiteSpace:"pre-wrap"},footer:{display:"flex",overflow:"hidden"}})),[]);return(0,Fe.jsxs)(wt().OT,{actionMenu:g,buttonPopupStore:p,disabled:s,actionId:t.id,canCollapse:!0,children:[(0,Fe.jsx)(wt().h3,{actionId:t.id,actionRegistryItem:c,disabled:s,styles:{headerWrap:h.headerWrap,titleWrap:h.titleWrap},children:(0,Fe.jsx)(E().sA,{...c.display.name})}),(0,Fe.jsx)(wt().qt,{disabled:s,children:(0,Fe.jsxs)(Bt().Y1,{direction:"vertical",gap:16,children:[d.variableIds.length>0&&(0,Fe.jsx)(Bt().Y1,{direction:"vertical",gap:14,children:d.variableIds.map((e=>d.values[e]?(0,Fe.jsx)(co,{actionStore:t,variableId:e},e):null))}),(0,Fe.jsx)("footer",{style:h.footer,children:(0,Fe.jsx)(Ot,{disabled:s,onClick:y})})]})})]})},http_request:function(e){const{actionStore:t}=e,{disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,Ke().b)(),{automationStore:s,contextType:c,typecheckResult:u}=(0,Se().EC)(),d=(0,rn().y)(s,c),p=Boolean(n),m=(0,a().getActionRegistryItem)("http_request"),g=qi(),y=(0,le().uB)(void 0,it().A),h=(0,ae.useCallback)((()=>y.reset()),[y]),f=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:h})),[t,h]),v=(0,le().K8)((()=>t.getConfigStore().getKeyStore("url")),[t]),x=(0,le().K8)((()=>t.getConfigStore().getKeyStore("selectedProperties")),[t]),b=(0,le().K8)((()=>x.getValue()||{type:"some",some:[]}),[x]),S=(0,ae.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{X().KY({store:x,transaction:t,value:e})}})}),[x,i]),C=(0,se().IS)((e=>({divider:{marginBottom:8,marginTop:8},dividerColor:{color:e.stroke.secondary},errorMessage:{color:e.text.redTertiary}})),[]),[A,k]=(0,ae.useState)(!1),M=(0,ae.useMemo)((()=>!r.includes(t.id)||A),[r,t.id,A]),j=(0,le().K8)((()=>{if(!l().Q.isSuccess(u)||!M)return!1;return(u.value.actionValidationFailures[t.id]||[]).some((e=>"invalid_url"===e.type))}),[u,t,M]),T=(0,ie().useRequiresSubscriptionUpgradeError)({actionId:t.id,shouldShow:M}),I=Boolean(T),w=(0,ae.useCallback)((()=>{k(!0)}),[]);return(0,Fe.jsxs)(wt().OT,{actionMenu:f,buttonPopupStore:y,disabled:p,actionId:t.id,canCollapse:!I,hideDragHandle:I,children:[(0,Fe.jsx)(wt().h3,{actionId:t.id,actionRegistryItem:m,disabled:p,errorMessage:T,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Fe.jsx)(E().sA,{...m.display.name})}),(0,Fe.jsxs)(wt().qt,{disabled:p,styles:{bodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,Fe.jsx)("label",{style:g.inputLabel,children:(0,Fe.jsxs)(Ii().Ye,{alignItems:"center",gap:4,children:[(0,Fe.jsx)(E().sA,{...Gi.urlInputLabel}),(0,Fe.jsx)(Di,{})]})}),(0,Fe.jsx)(Ue,{disabled:p,style:g.input,store:v,errorOutline:j,onBlur:w,maxlength:Ti().i8}),j&&(0,Fe.jsx)("div",{style:C.errorMessage,children:(0,Fe.jsx)(E().sA,{id:"SendWebhookAction.invalidUrl",defaultMessage:"Invalid URL"})}),(0,Fe.jsx)(Pi,{actionStore:t}),d&&(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(o(884373).A,{size:1,style:C.divider,dividerColor:C.dividerColor.color}),(0,Fe.jsx)(Ki,{collectionStore:d,value:b,onChange:S})]})]})]})},publish_site:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,Ke().b)(),r=(0,le().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),l=Boolean(o),s=(0,a().getActionRegistryItem)("publish_site"),c=(0,le().uB)(void 0,it().A),u=(0,ae.useCallback)((e=>{"url"!==e.type&&n.createAndCommit({perform:o=>{X().zv({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"PublishSiteAction.setTarget"})}),[n,t]),d=(0,ae.useCallback)((()=>c.reset()),[c]),p=(0,ae.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:m}=(0,ie().useErrorComponentForAction)({actionId:t.id,shouldShow:p}),g=(0,ae.useMemo)((()=>(0,Fe.jsx)(mt().z,{actionStore:t,closeMenu:d})),[t,d]);return(0,Fe.jsxs)(wt().OT,{actionMenu:g,buttonPopupStore:c,disabled:l,actionId:t.id,canCollapse:!0,children:[(0,Fe.jsx)(wt().h3,{actionId:t.id,actionRegistryItem:s,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Fe.jsx)(zo,{actionStore:t,disabled:l,errorMessage:m,onTargetChange:u,value:r})}),(0,Fe.jsxs)(wt().qt,{disabled:l,styles:{sectionBodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,Fe.jsx)(Ko,{}),(0,Fe.jsx)(Ho,{})]})]})}};var $i=()=>o(700779);function Ji(e){const{children:t}=e,{isMobile:o}=(0,re().Y0)(),n=(0,se().IS)((e=>({wrap:{color:e.text.tertiary,fontSize:o?14:12,lineHeight:1.3,fontWeight:ce().Wy.medium}})),[o]);return(0,Fe.jsx)("div",{style:n.wrap,children:t})}const Qi=(0,E().YK)({newActionLabel:{defaultMessage:"New action",id:"AutomationActionSelectButton.actionSection.newAction"},addActionLabel:{defaultMessage:"Add action",id:"AutomationActionSelectButton.actionSection.addAction"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",defaultMessage:"Add action"},builderModalActionTitle:{defaultMessage:"Do",id:"builderModal.editAutomationView.actionSection.title"}});function Zi(e){let{isEditable:t}=e;const{automationStore:o}=(0,Se().EC)(),{disabled:n}=(0,Ke().b)(),i=(0,lt().V)(),{contextType:a}=(0,Se().EC)(),r="button_block"===a||"button_property"===a,l=(0,le().K8)((()=>o.getActionStores().map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(s().Pe)),[o]),c=l.length>0,u=(0,se().IS)((e=>({section:{display:"flex",flexDirection:"column",gap:4,width:"100%",...r&&{marginTop:20}},header:{alignItems:"center",display:"flex",flexDirection:"row",height:24},list:{display:"flex",flexDirection:"column"}})),[r]),d=!n&&t&&i.length>0;return(0,Fe.jsxs)("section",{style:u.section,children:[(0,Fe.jsx)("header",{style:u.header,children:(0,Fe.jsx)(Ji,{children:(0,Fe.jsx)(E().sA,{...Qi.builderModalActionTitle})})}),(0,Fe.jsxs)("div",{style:u.list,children:[t?(0,Fe.jsx)(ta,{actionStores:l}):(0,Fe.jsx)(ea,{actionStores:l}),d&&(0,Fe.jsx)("footer",{children:(0,Fe.jsx)(ia,{disabled:n,hasAnyActions:c,variant:"button"})})]})]})}function ea(e){let{actionStores:t}=e;const o=(0,qe().vV)();return(0,Fe.jsx)("div",{style:o.wrap,children:(0,Fe.jsx)("div",{style:o.list,children:t.map((e=>(0,Fe.jsx)("div",{className:qe().xB,children:(0,Fe.jsx)(oa,{actionStore:e})},e.id)))})})}function ta(e){let{actionStores:t}=e;const o=(0,re().v3)(),{automationStore:n,contextType:a}=(0,Se().EC)(),{disabled:r,onActionDragStart:l,onActionDragEnd:c,maybePersistedTransactionActions:u}=(0,Ke().b)(),d=(0,E().tz)(),{value:p}=(0,nt().fJ)(j().T.formulas),{value:m}=(0,nt().fJ)(Qe().QV.automationTypecheck),g=(0,rt().n)(n),{automationActionMap:y,actionStoreIds:h}=(0,le().K8)((()=>{const e=[],t=new Map;return n.getActionStores().forEach((o=>{o.isDefined()&&o.hasConcern("display")&&(e.push(o.id),t.set(o.id,o))})),{automationActionMap:t,actionStoreIds:e}}),[n]),f=(0,le().uB)(void 0,at().A),v=(0,ae.useCallback)((e=>{const t=e.state;if(t.willDrag){const e=y.get(t.draggingKey);(0,s().O9)(e)&&(0,s().O9)(l)&&l(e)}else t.willDrag||t.isDragging||null==c||c()}),[y,c,l]);(0,ae.useEffect)((()=>(f.addListener(v),()=>f.removeListener(v))),[y,f,v]);const x=(0,ae.useCallback)(((e,t)=>{p&&m&&u.createAndCommit({userAction:"AutomationButtonAction.moveAction",perform:r=>{i().reorderAutomationActions({environment:o,automationStore:n,automationTypecheckModule:m,contextType:a,formulasModule:p,intl:d,newActionIds:e,transaction:r,from:"drag_and_drop",movedActionId:t.key,isSubscribed:g})}})}),[n,a,m,p,d,u,o,g]),b=(0,ae.useMemo)((()=>!r&&t.length>1),[r,t]),S=(0,ae.useCallback)(((e,t)=>{const o=y.get(e);return(0,s().O9)(o)?(0,Fe.jsx)(oa,{actionStore:o},o.id):null}),[y]);return t.length>0?(0,Fe.jsx)(na,{draggableListStore:f,hasDragging:b,keys:h,onDrop:x,renderKey:S}):null}function oa(e){const{actionStore:t}=e,o=(0,le().K8)((()=>t.getType()),[t]);if(!o)return null;const n=Xi[o];return(0,Fe.jsx)(n,{actionStore:t})}function na(e){const{draggableListStore:t,hasDragging:o,keys:n,onDrop:i,renderKey:a}=e,{isMobile:r}=(0,re().Y0)(),l=(0,qe().vV)();return(0,Fe.jsx)("div",{style:l.wrap,children:(0,Fe.jsx)(tt().Ay,{childClassName:qe().xB,direction:"vertical",disabled:!o||r,keys:n,onDrop:i,renderKey:a,store:t,style:l.list})})}function ia(e){const{disabled:t,hasAnyActions:o,variant:n}=e,i=(0,je().j)(),a=(0,E().tz)(),r=(0,ae.useMemo)((()=>({availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"})),[]),l=(0,le().uB)(void 0,it().A),s=(0,ae.useCallback)((()=>l.reset()),[l]),c=(0,se().IS)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.text.secondary,fill:e.mediumIconColor,margin:0,width:"100%"}})),[]),u=Boolean(t);return(0,Fe.jsx)(et().Ay,{alignmentToOrigin:et().yP.Start,buttonPopupStore:l,disabled:u,placementToOrigin:et().sx.Bottom,popupType:i,render:()=>(0,Fe.jsx)(st().A,{initialState:r,onClose:s}),renderOrigin:e=>"icon"===n?(0,Fe.jsx)(Be().A,{...e,ariaLabel:a.formatMessage(Qi.addActionAriaLabel),disabled:u,disabledFeedback:u,icon:$e().plusSmallIcon,iconStyle:{width:Je().Ev.sm,height:Je().Ev.sm}}):"button"===n?(0,Fe.jsx)($i().F,{...e,ariaLabel:a.formatMessage(Qi.addActionAriaLabel),disabled:u,icon:(0,Fe.jsx)(ot().I,{icon:$e().plusSmallIcon,size:"sm"}),title:(0,Fe.jsx)(E().sA,{...o?Qi.addActionLabel:Qi.newActionLabel})}):(0,Fe.jsx)(Ze().A,{...e,buttonStyle:c.button,disabled:u,disabledFeedback:u,focused:!1,icon:(0,Fe.jsx)(ot().I,{icon:Xe().plusIcon}),style:c.buttonWrap,title:o?(0,Fe.jsx)(E().sA,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,Fe.jsx)(E().sA,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})})})}function aa(e){const{areActionsEditable:t,areTriggersEditable:o,footer:n}=e,{isMobile:i}=(0,re().Y0)(),a=(0,se().IS)((e=>({verticalRule:{background:e.stroke.primary,borderRadius:2,height:56,marginBottom:5,marginLeft:0,marginTop:16,width:2},container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",padding:i?"0 16px":void 0}})),[i]);return(0,Fe.jsxs)("div",{style:a.container,children:[(0,Fe.jsx)(qe().Kn,{isEditable:o}),(0,Fe.jsx)("div",{style:a.verticalRule}),(0,Fe.jsx)(Zi,{isEditable:t}),n]})}const ra=(0,E().YK)({editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"},done:{defaultMessage:"Done",id:"buttonBlock.button.done"},noEditError:{defaultMessage:"You don't have full access to edit this button",id:"buttonBlock.button.noEditError"}});function la(e){var t,o,n;const{buttonBlockStore:i}=e,a=(0,le().K8)((()=>i.state.editing?i.state:void 0),[i]),r=(0,se().IS)((e=>{var t;return{popup:{width:400},editor:{background:e.contentBackground,..."inline"===(null==a||null===(t=a.placement)||void 0===t?void 0:t.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}}}),[null==a||null===(t=a.placement)||void 0===t?void 0:t.type]),l=(0,je().j)({tabletBehavior:"slideUp"});return a&&a.placement?"popup"===(null===(o=a.placement)||void 0===o?void 0:o.type)?(0,Fe.jsx)(me().Ay,{open:!0,popupType:l,render:()=>(0,Fe.jsx)(sa,{...e,style:r.editor}),originRect:a.placement.originRect,style:r.popup,originGap:4,onDismiss:()=>{i.stopEditing()}}):"inline"===(null===(n=a.placement)||void 0===n?void 0:n.type)?(0,Fe.jsx)(sa,{...e,style:r.editor}):void(0,s().HB)(a.placement):null}function sa(e){const{disabled:t,store:o,buttonBlockStore:n}=e,i=(0,re().v3)(),[a,r]=(0,fe().z)(),l=(0,se().IS)((e=>({scroller:{maxHeight:"75vh"},container:{fontFamily:ce().Tf.sans},footerButton:{height:32,width:"100%"},upgradeMessageWrap:{margin:8},footerButtonWrap:{width:"100%",display:"flex",flexDirection:"column",paddingTop:24}})),[]),s=(0,le().K8)((()=>o.getAutomationStore()),[o]),c=(0,le().K8)((()=>null==s?void 0:s.getSpaceId()),[s]),{maybePersistedAutomationStore:u,maybePersistedTransactionActions:d}=(0,Ie().t)({automationId:null==s?void 0:s.id,spaceId:c,defaultValue:void 0,persist:!0}),p=(0,Te().OW)({store:o,automationStore:u}),m=(0,le().K8)((()=>{var e;return o.canEdit()&&"sufficient"===(null==p||null===(e=p.state)||void 0===e?void 0:e.editPermissionStatus)}),[o,p]),g=(0,le().K8)((()=>n.state.editing?n.state.placement:void 0),[n]),y=(0,le().K8)((()=>{var e;return null===(e=ee().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),h=(0,be()._X)({name:"slack_automation_action",spaceId:c,userId:null==y?void 0:y.id}),f=(0,ke().c)({automationStores:[u],slackActionFeatureAvailability:h}),v=(0,ae.useCallback)((e=>{(0,he().SQ)({event:e,context:he().y$.EditorClick,callback:()=>{ue().clear({environment:i}),J().IU({environment:i})}})}),[i]),x=(0,ae.useCallback)((()=>{n.stopEditing(),(0,T().u4)({environment:i,event:{eventName:"click_configure_button_done",eventProperties:{block_id:o.id,automation_id:null==u?void 0:u.id}}}),_().default.logEvent("click_configure_button_done")}),[n,i,o,u]),b=(0,le().K8)((()=>n.state.suppressErrorsForActionIds),[n]),S=(0,ae.useCallback)((e=>n.suppressErrorsForAction(e.id)),[n]),C=(0,ae.useCallback)((()=>{var e;const t=h&&"expiry"in h&&null!==(e=h.expiry)&&void 0!==e&&e.upsell?h.expiry.upsell:void 0;t&&xe().K(i,{from:"button_block_automation_header_message",upsell:t})}),[i,h]),A=(0,Me().c)(),k=t||!m||!(0,be().e2)(h),M=(0,le().K8)((()=>{var e;return!(null==p||null===(e=p.state)||void 0===e||!e.typecheckResult)&&(0,Ae().h)({environment:i,typecheckResult:p.state.typecheckResult,automationStore:u})}),[p,i,u]);return u?(0,Fe.jsx)("div",{ref:a,style:{...l.container,...e.style},onClick:v,children:(0,Fe.jsx)(Se().u,{automationStore:u,contextType:"button_block",children:(0,Fe.jsxs)(Ce().v,{value:{disabled:k,editorPlacement:g,editorWidth:r,maybePersistedTransactionActions:d,onActionAdded:S,suppressActionErrors:b,hideDragHandle:M,...A},defaultCollapseActions:M,children:[(0,Fe.jsx)(ca,{blockStore:o,disabled:k}),(0,Fe.jsxs)(ye().H,{style:l.scroller,type:ve().A.Y,children:[M&&(0,Fe.jsx)("div",{style:l.upgradeMessageWrap,children:(0,Fe.jsx)(Ge().j,{onUpsellClick:C})}),f&&(0,Fe.jsx)("div",{style:l.upgradeMessageWrap,children:(0,Fe.jsx)(Ye().v,{onUpsellClick:C})}),!m&&(0,Fe.jsx)("div",{style:l.upgradeMessageWrap,children:(0,Fe.jsx)(we().z,{children:(0,Fe.jsx)(E().sA,{...ra.noEditError})})}),(0,Fe.jsx)("section",{style:{paddingBlock:8,paddingInline:8},children:(0,Fe.jsx)(aa,{areActionsEditable:!M,areTriggersEditable:!1,footer:(0,Fe.jsx)("div",{style:l.footerButtonWrap,children:(0,Fe.jsx)(ge().A,{onClick:x,style:l.footerButton,children:(0,Fe.jsx)(E().sA,{...ra.done})})})})})]})]})})}):null}function ca(e){const{blockStore:t,disabled:o}=e,{automationStore:n}=(0,Se().EC)(),i=(0,re().v3)(),a=(0,se().IS)((e=>({wrap:{display:"flex",flexDirection:"column",padding:12,gap:6},inputs:{display:"flex",alignItems:"center",gap:6,borderBottom:`1px solid ${e.stroke.secondary}`,paddingBottom:12},nameInputWrap:{flexGrow:"1"},nameInput:{background:"transparent",boxShadow:"none",padding:4}})),[]),r=(0,le().K8)((()=>n.getNameStore()),[n]),l=(0,le().K8)((()=>n.getIconStore()),[n]),s=(0,le().K8)((()=>(null==r?void 0:r.getValue())??""),[r]),c=(0,le().K8)((()=>null==l?void 0:l.getValue()),[l]),u=(0,ae.useCallback)(((e,t)=>{Q().createAndCommit({userAction:"ButtonBlock.updateProperty",environment:i,canUndo:!0,perform:o=>{X().zv({store:n.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[n,i]),d=(0,ae.useCallback)((e=>u("icon",e)),[u]),p=(0,ae.useCallback)((e=>u("name",e)),[u]);return(0,Fe.jsx)(de().s,{allowSelectionWithin:!0,style:a.wrap,children:(0,Fe.jsxs)("div",{style:a.inputs,children:[(0,Fe.jsx)(Ne,{disabled:o,currentIcon:c,handleIconChange:d,store:t}),(0,Fe.jsx)(He,{onChange:p,value:s,disabled:o,placeholder:w().A.formatMessage(ra.buttonPlaceholder),wrapStyle:a.nameInputWrap,style:a.nameInput,format:pe().C.ExtraLarge,autoFocus:!s})]})})}var ua=()=>o(951592),da=()=>o(302376),pa=(o(610931),()=>o(891467)),ma=()=>o(859669);function ga(e){var t;const{url:o,parentStore:n,onMouseEnter:i,onMouseLeave:a}=e,r=(0,re().v3)(),[l]=(0,mn().Yb)((async()=>{var e,t;const n=await q().callApi({eventName:"getDataForLinkMention",environment:r,data:{url:o,spaceId:(null===(e=ee().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??(null===(t=ee().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"button_hover"}});if("success"===n.type){if("error"in n.data)throw new Error(`Error in iframely response: ${n.data.status} ${n.data.error}`);return n.data}throw n.error}),[r,o]);let s;return s=null!==(t=l.value)&&void 0!==t&&t.iframe?(0,Fe.jsx)(pa().p,{hoverData:l.value,iframe_url:l.value.iframe,height:l.value.height,padding:l.value.padding,padding_top:l.value.padding_top,store:n,href:o,showEditButton:!1}):(0,Fe.jsx)(ma().R,{hoverData:l.value,href:o,showEditButton:!1,store:n,loading:"pending"===l.status}),(0,Fe.jsx)("div",{onMouseEnter:i,onMouseLeave:a,children:s})}function ya(e){const{renderOrigin:t}=e;return(0,re().Y0)().isMobile?(0,Fe.jsx)(Fe.Fragment,{children:t()}):(0,Fe.jsx)(ha,{...e})}function ha(e){const{renderOrigin:t,urlToPreview:o,parentStore:n}=e,[i,a]=(0,ae.useState)(!1),l=(0,ae.useMemo)((()=>({onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)}})),[]),s=function(e){const{targetHovered:t}=e,[o,n]=(0,ae.useState)(!1),i=(0,ua().lW)(t,400,Object.is),[a,l]=(0,ae.useState)(!1),s=a||!o&&i,c=(0,ae.useCallback)((()=>l(s)),[s]),u=(0,ae.useCallback)((()=>{l(!1)}),[]),d=(0,ae.useCallback)((()=>{u(),n(!0)}),[u]);return(0,ae.useEffect)((()=>{n(!1)}),[i]),(0,ae.useEffect)((()=>{const e=r().nF((()=>{d()}),200,{leading:!0});return da().P4(window,"scroll",e,!0),()=>da().Ol(window,"scroll",e,!0)}),[d]),{state:s,pinPopup:c,unpinPopup:u}}({targetHovered:i});return(0,Fe.jsx)(me().Ay,{disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,originGap:6,preventOpacityTransition:!0,open:s.state,popupType:me().nl.Popup,alignmentToOrigin:Ut().C.Start,placementToOrigin:Ut().W.Bottom,render:()=>(0,Fe.jsx)(ga,{url:o,parentStore:n,onMouseEnter:s.pinPopup,onMouseLeave:s.unpinPopup}),origin:t(l)})}},911575:(e,t,o)=>{o.d(t,{$0:()=>h,Fx:()=>A,Ge:()=>m,I3:()=>d,Kj:()=>S,PP:()=>k,TK:()=>M,Yy:()=>u,aE:()=>j,cQ:()=>C,kH:()=>g,m7:()=>p,nq:()=>x,nv:()=>f,tj:()=>y});o(725707),o(491955),o(113085);var n=()=>o(975392),i=()=>o(76394),a=()=>o(564134),r=()=>o(810111),l=()=>o(479056),s=()=>o(875089);(0,i().u0)((e=>(0,i().O9)(e)&&(0,i().O9)(e.target)&&(0,i().O9)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target,custom_message:e.custom_message}}:{false:e}));const c={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1},u={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function d(e){return Boolean(c[e.type]&&!(0,a().UU)(e)&&(!(0,a().$M)(e)||void 0===(0,a().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c,sourcePropertyIds:u}=e,p=(u??(0,i().uv)(o)).filter(((t,n,i)=>{const r=o[t];return!(!r||!d(r))&&(("relation"!==r.type||!e.restrictCrossSpace||!(0,a().o2)(e.spaceId,r))&&(!l||l([t,r],n,o)))}));if(0===p.length)return[];if(!t||!1===c)return p;const m=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:o,sort:l}=e,c=(0,i().uv)(o).filter(((e,t,n)=>{const i=o[e];return!(!i||!(0,a().JY)(i))}));if(0===c.length)return[];if(!t||!1===l)return c;const u=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(c,(e=>u.findIndex((t=>t.property===e))))}function g(e){return e.type===l().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===l().M9.TokenExpected?{type:e.type,token:e.token}:e.type===l().uW.MissingSchemaPropertyOnThisRow||e.type===l().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===l().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===l().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===l().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===l().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===l().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===l().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===l().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===l().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===l().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===l().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,geo_point:!1};function h(e){return Boolean(y[e.type])}function f(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c}=e,u=(0,i().uv)(o).filter(((e,t,n)=>{var i;const r=o[e];return!(!r||!y[r.type])&&((!(0,a().$M)(r)||null===(i=(0,a().om)(r))||void 0===i||!i.auto_update_on_edit)&&(!l||l([e,r],t,o)))}));if(0===u.length)return[];if(!t||!1===c)return u;const d=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(u,(e=>d.findIndex((t=>t.property===e))))}const v={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function x(e){return v[e.type]}const b={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function S(e){return b[e.type]}function C(e){return 0===e}function A(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function k(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function M(e){const{collectionSchema:t,property:o,type:n}=e,i=null==t?void 0:t[o];return!i||("action"===n?!d(i):!y[i.type])}function j(e){let{automationTrigger:t,collectionSchema:o}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:n,source:a,relativeDate:r}=t.event;if(void 0===a)return!1;const l="some"===n.type&&n.some,s="all"===n.type&&n.all;if((l||s||[]).some((e=>k({collectionSchema:o,property:e.property})||M({collectionSchema:o,property:e.property,type:"trigger"}))))return!1;const c="some"===n.type&&(!(0,i().O9)(n.some)||0===n.some.length),u="all"===n.type&&(!(0,i().O9)(n.all)||0===n.all.length);if(!e&&("none"===n.type||c||u)&&!r)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},916396:(e,t,o)=>{o.d(t,{A:()=>T,m:()=>j});var n=o(242343),i=()=>o(803290),a=()=>o(174114),r=()=>o(752903),l=()=>o(846581),s=()=>o(465546),c=()=>o(630714),u=()=>o(427091),d=()=>o(935248),p=()=>o(34662),m=()=>o(653998),g=()=>o(76394),y=()=>o(31448),h=()=>o(434406),f=()=>o(523365),v=()=>o(809785),x=()=>o(275334),b=()=>o(265405),S=()=>o(993517),C=()=>o(100096),A=()=>o(100183),k=()=>o(604104),M=o(163643);function j(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:j,disabled:w,onClick:_,propertySchema:P,value:B,valueContext:R}=e,V=(0,m().tz)(),E=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...y().RC,fontWeight:y().Wy.medium}})),[]),D=(0,b().F)({actionId:o.id}),F=(0,i().K8)((()=>function(e){const{intl:t,propertySchema:o,styles:n,typecheckContextValues:i,value:a,valueContext:d}=e,b=(0,M.jsx)("span",{style:n.propertyName,children:o.name});if(void 0===(null==a?void 0:a.value))return(0,M.jsx)(m().sA,{...x().NW({propertyName:b})});let S;const C="formula"===a.type,j=(0,c().fromSimpleFormulaArrayValue)(null==a?void 0:a.value)[0];if(C)S=(0,M.jsx)(k().g,{returnType:{type:"date"}});else if(!(0,g().O9)(j)||"string"==typeof j||"boolean"==typeof j||(0,p().rie)(j)||(0,p().jIt)(j))S=(0,M.jsx)(v().A,{format:r().NY.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:y().RC,children:(0,M.jsx)(m().sA,{...x().CV.unknownValue})})});else if((0,p().s1Y)(j)){const e=(0,p().iVq)(j).id,t=(0,s().IV)(i,e);S=t?(0,M.jsx)(h().F,{value:t,format:r().NY.Medium,isSingle:!1,shouldShrink:!0}):(0,M.jsx)(v().A,{format:r().NY.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:y().RC,children:(0,M.jsx)(m().sA,{...x().CV.unknownValue})})})}else if((0,p().qsB)(j)){const e=(0,f().aS)(d),o=(0,p().K7D)(j);S=o?(0,l().zV)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:n}=e;return(0,g().O9)(o)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I,{value:n})," → ",(0,M.jsx)(I,{value:o})]}):(0,g().O9)(t)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I,{value:n})," → ",(0,M.jsx)(I,{value:t})]}):(0,M.jsx)(I,{value:n})}}):null}else{if((0,p().iz3)(j))return(0,M.jsx)(A().A,{token:j});(0,g().HB)(j)}return void 0===S?void 0:(0,M.jsx)(m().sA,{...x().Oo({propertyName:b,propertyValue:S})})}({intl:V,propertySchema:P,styles:E,typecheckContextValues:D,value:B,valueContext:R})),[V,P,E,D,B,R]),O=(0,i().K8)((()=>T({intl:V,propertySchema:P,typecheckContextValues:D,value:B,valueContext:R})),[V,P,D,B,R]),N=(0,n.useCallback)((e=>(0,M.jsx)(C().aX,{...e,actionMenu:t,buttonPopupStore:j,disabled:w,icon:d().Z,onClick:_,children:(0,M.jsx)("div",{style:E.content,children:F})})),[t,j,w,_,E.content,F]);return F&&O?(0,M.jsx)(S().P,{disable:w,renderOrigin:N,title:O}):null}function T(e){const{intl:t,propertySchema:o,typecheckContextValues:n,value:i,valueContext:a}=e,r=o.name;if(void 0===(null==i?void 0:i.value))return(0,M.jsx)(m().sA,{...x().NW({propertyName:r})});let d;const y="formula"===i.type,h=(0,c().fromSimpleFormulaArrayValue)(i.value)[0];if(y)d=(0,M.jsx)(k().L,{});else if(!(0,g().O9)(h)||"string"==typeof h||"boolean"==typeof h||(0,p().rie)(h)||(0,p().jIt)(h)||(0,p().iz3)(h))d=(0,M.jsx)(m().sA,{...x().CV.unknownValue});else if((0,p().s1Y)(h)){const e=(0,p().iVq)(h).id,t=(0,s().IV)(n,e);d=t?(0,s().sM)(t):(0,M.jsx)(m().sA,{...x().CV.unknownValue})}else if((0,p().qsB)(h)){const e=(0,f().aS)(a),o=(0,p().K7D)(h);d=o?(0,l().ZF)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0}):null}else(0,g().HB)(h);return void 0===d?void 0:(0,M.jsx)(m().sA,{...x().Oo({propertyName:r,propertyValue:d})})}function I(e){const{value:t}=e,o=(0,a().IS)((e=>({token:{marginBlockEnd:4},tokenBackgroundColor:{backgroundColor:e.accentColors.gray[75]}})),[]);return(0,M.jsx)(v().A,{backgroundColor:o.tokenBackgroundColor.backgroundColor,format:r().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:o.token,value:t})}},916480:(e,t,o)=>{o.d(t,{b:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("at",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M.911 8.034c0 4.505 3.049 7.24 7.246 7.24 1.135 0 2.215-.158 2.885-.376.472-.15.622-.397.622-.65a.44.44 0 00-.451-.444 1.3 1.3 0 00-.321.048c-.834.205-1.552.341-2.516.341-3.74 0-6.29-2.255-6.29-6.118 0-3.698 2.407-6.275 6.03-6.275 3.206 0 5.886 1.975 5.886 5.523 0 2.072-.697 3.466-1.825 3.466-.752 0-1.176-.437-1.176-1.183V4.972c0-.37-.205-.595-.554-.595-.341 0-.553.226-.553.595v.779h-.062c-.349-.84-1.203-1.374-2.222-1.374-1.77 0-3.014 1.51-3.014 3.678 0 2.187 1.237 3.712 3.042 3.712 1.06 0 1.88-.575 2.276-1.545h.062c.13.963.943 1.551 2.023 1.551 1.907 0 3.09-1.873 3.09-4.498 0-3.971-2.92-6.548-6.96-6.548C3.886.727.912 3.632.912 8.034zm6.911 2.652c-1.223 0-2.003-1.018-2.003-2.638 0-1.593.786-2.611 2.01-2.611 1.258 0 2.05.998 2.05 2.584 0 1.62-.813 2.665-2.057 2.665z"})})},917008:(e,t,o)=>{o.d(t,{D:()=>u});o(725707),o(771702);var n=o(242343),i=()=>o(803290),a=()=>o(58815),r=()=>o(220574),l=()=>o(84543),s=()=>o(90875),c=()=>o(485966);function u(e){let{unpersistedInMemoryRecordCache:t}=e;const o=(0,i().K8)((()=>{var e;return null===(e=c().default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]);return{createAndCommit:(0,n.useCallback)((e=>{let{perform:n}=e;const i=new(s().Z)({deadlockTimeoutMs:l().DEADLOCK_WARNING_TIMEOUT_MS}),c=n(i),u=r().RecordMap.create();i.stores.forEach((e=>{const t=e.getRecordModel(e.pointer);t&&u.addModel(t)})),(0,a().applyOperationsToRecordMap)({operations:i.operations,recordMap:u,updateOnly:!1});for(const a of u){const{model:e,pointer:n}=a;t.setModelAndRole({pointer:n,userId:o},e,"editor")}return t.emitAll(),{performResult:c,serverCommitResult:Promise.resolve(void 0)}}),[t,o])}}},918625:(e,t,o)=>{o.d(t,{_:()=>u});o(242343);var n=()=>o(237385),i=()=>o(174114),a=()=>o(198654),r=()=>o(126451),l=()=>o(932322),s=()=>o(35462),c=o(163643);function u(e){const t=(0,i().DP)(),o=(0,n().v3)(),{device:u}=o;return(0,c.jsx)(r().A,{mobileFeedback:u.isMobile,onClick:e.onClick,hovered:e.focused,disabled:e.disabled,style:{width:"100%",...!u.isMobile&&{borderRadius:6},...e.buttonStyle},hoveredStyle:e.hoveredButtonStyle,pressedStyle:e.pressedButtonStyle,children:(0,c.jsx)(l().Ay,{...e,dontShrinkTitle:!0,right:(0,c.jsxs)("div",{style:{display:"flex",whiteSpace:"nowrap"},children:[e.right&&(0,c.jsx)(s().A,{isSecondaryColor:!0,isMobile:u.isMobile,children:e.right}),!u.isMobile&&(0,c.jsx)("div",{style:{flexShrink:0},children:(0,a().b)({width:10,marginLeft:4,fill:t.lightIconColor,transform:"right"===e.chevronType?"rotate(-90deg)":void 0,transition:"transform 0.2s ease"})})]})})})}},933871:(e,t,o)=>{o.d(t,{U:()=>p});o(610931);var n=()=>o(543396),i=()=>o(827875),a=()=>o(33715),r=()=>o(846287),l=()=>o(201147),s=()=>o(946854),c=()=>o(84543),u=()=>o(272690),d=()=>o(477267);function p(e){let{environment:t,transaction:o,layoutStore:p,position:m,sessionId:g,beforePerformDeleteModule:y}=e;const h=p.getModules();if(!h)throw new Error("[deleteModuleAtPosition] modules by area not found for layout store");const f=(0,r().EX)(h,(e=>e.id===m.moduleId)),v=(0,n().Cg)({moduleId:null==f?void 0:f.module.id,modulesByArea:p.getModules()}).length;if(!f)return;const{module:x,position:b}=f;if(!(0,l().Fe)(x))throw new Error("[deleteModuleAtPosition] module to delete is not removeable");var S;(c().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){!function(e){const{transaction:t,layoutStore:o,moduleLocation:n,moduleToDelete:r,beforePerformDeleteModule:l}=e;l&&l(t);(0,s().V6)(r)&&(0,d().deleteViewsModuleDependencies)({layoutStore:o,viewsModule:r,transaction:t});if("form_conditional_modules"===n.area){const e=i().N4.removeChildModule({pointer:o.pointer,modulesByArea:o.getModules(),module:r});for(const n of e)c().applyOperation({transaction:t,store:o,operation:n})}else{const e="views_main_tab_modules"===n.area?{area:n.area,viewId:n.viewId}:{area:a().Zm[n.area]};c().applyOperation({transaction:t,store:o,operation:i().N4.deleteModuleInArea({...e,pointer:o.pointer,moduleId:r.id})})}}({environment:t,transaction:e,layoutStore:p,moduleLocation:b,moduleToDelete:x,beforePerformDeleteModule:y})},userAction:"pageLayout.deleteActions.deleteModuleAtPosition"}),g)&&u().PS({environment:t,module:x,sessionId:g,collectionId:null===(S=p.getCollectionModel())||void 0===S?void 0:S.id,layoutId:p.id,context:(0,a().We)(m.area),area:m.area,depth:v})}},934889:(e,t,o)=>{o.r(t),o.d(t,{clockIcon:()=>a,iconDefinition:()=>i});o(242343);var n=o(163643);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.625 5.725a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},a=(0,o(680369).wt)("clock",i)},938341:(e,t,o)=>{o.d(t,{e:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("chevronDownThin",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 11.4795C7.77214 11.4795 7.56478 11.3883 7.37793 11.2061L2.17578 5.88086C2.09831 5.80794 2.03906 5.72591 1.99805 5.63477C1.96159 5.53906 1.94336 5.43652 1.94336 5.32715C1.94336 5.17676 1.97754 5.04004 2.0459 4.91699C2.11882 4.79395 2.21452 4.69824 2.33301 4.62988C2.4515 4.55697 2.58594 4.52051 2.73633 4.52051C2.95508 4.52051 3.14648 4.60254 3.31055 4.7666L8.33496 9.91406H7.67188L12.6895 4.7666C12.8535 4.60254 13.0449 4.52051 13.2637 4.52051C13.4141 4.52051 13.5485 4.55697 13.667 4.62988C13.7855 4.69824 13.8789 4.79395 13.9473 4.91699C14.0202 5.04004 14.0566 5.17676 14.0566 5.32715C14.0566 5.54134 13.9792 5.72591 13.8242 5.88086L8.62207 11.2061C8.53548 11.2972 8.43978 11.3656 8.33496 11.4111C8.23014 11.4567 8.11849 11.4795 8 11.4795Z"})})},944560:(e,t,o)=>{o.d(t,{Dy:()=>l,Os:()=>c,l$:()=>s,qO:()=>r});o(362833),o(725707),o(491955);var n=()=>o(706788),i=()=>o(769884),a=()=>o(669747);function r(e){if(e.integration_id!==n().zG)throw"Cannot render account for integration.";const t=/(.+) - (.+)/.exec(e.account_name);if(!t)return{accountName:e.account_name};const[,o,i]=t;return{organizationName:o,accountName:i}}function l(e){return i().Bj6.fromValue(a().As,e).getSlackWorkspaceId()}function s(e,t){return t?e.filter((e=>{const o=l(e);return!!o&&t(o)})):e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const o={};for(const n of e){const{accountName:e,organizationName:i}=r(n);u({query:t,accountName:e,organizationName:i})&&(o[e]||(o[e]=[]),o[e].push({externalAuthentication:n,workspaceName:i}))}return o}function u(e){const{accountName:t,organizationName:o,query:n}=e;if(0===n.length)return!0;const i=t.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0,a=!!o&&o.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0;return i||a}},950065:(e,t,o)=>{o.d(t,{EJ:()=>T,Jx:()=>B,T7:()=>P,Vj:()=>_,Zd:()=>I,ef:()=>w,hF:()=>j});var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(237434),s=()=>o(611121),c=()=>o(137259),u=()=>o(696443),d=()=>o(836352),p=()=>o(768219),m=()=>o(66460),g=()=>o(653998),y=()=>o(31448),h=()=>o(441165),f=()=>o(654548),v=()=>o(271142),x=()=>o(275334),b=()=>o(265405),S=()=>o(993517),C=()=>o(100096),A=()=>o(604104),k=o(163643);function M(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:l,disabled:s,icon:c,onClick:u,propertySchema:d,value:p}=e,{automationStore:M}=(0,v().EC)(),T=(0,i().v3)(),I=(0,r().DP)(),w=(0,r().IS)((()=>({propertyName:{...y().RC,fontWeight:y().Wy.medium,flexShrink:0}})),[]),_=(0,b().F)({actionId:o.id}),P=(0,a().K8)((()=>function(e){const{automationStore:t,environment:o,propertySchema:n,styles:i,theme:a,typecheckContextValues:r,value:l}=e,s=(0,k.jsx)("span",{style:i.propertyName,children:n.name}),c=void 0===(null==l?void 0:l.value);if(c)return(0,k.jsx)(g().sA,{...x().NW({propertyName:s})});let u;const d="formula"===l.type;if(d)u=(0,k.jsx)(A().g,{returnType:{type:"text"}});else{const e=(0,f().S5)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,h().FN)(o),environment:o,formulaValueTypes:r,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:l.value??[],spaceId:(0,m().e)(t.pointer.spaceId)},theme:a});u=(0,k.jsxs)(k.Fragment,{children:['"',(0,k.jsx)("span",{style:y().RC,children:e}),'"']})}return(0,k.jsx)(g().sA,{...x().LK({propertyName:s,propertyValue:u})})}({automationStore:M,environment:T,propertySchema:d,styles:w,theme:I,typecheckContextValues:_,value:p})),[M,T,d,w,I,_,p]),B=(0,a().K8)((()=>j({automationStore:M,environment:T,propertySchema:d,theme:I,typecheckContextValues:_,value:p})),[M,T,d,I,_,p]),R=(0,n.useCallback)((e=>(0,k.jsx)(C().aX,{...e,actionMenu:t,buttonPopupStore:l,disabled:s,icon:c,onClick:u,children:P})),[t,l,s,c,u,P]);return P&&B?(0,k.jsx)(S().P,{renderOrigin:R,title:B}):null}function j(e){const{automationStore:t,environment:o,propertySchema:n,theme:i,typecheckContextValues:a,value:r}=e,l=n.name;if(void 0===(null==r?void 0:r.value))return(0,k.jsx)(g().sA,{...x().NW({propertyName:l})});let s;return s="formula"===r.type?(0,k.jsx)(A().L,{}):(0,f().S5)({disabled:!0,disableDateStyleAnnotations:!0,disableFormulaVariableStyles:!0,disableHover:!0,disableInsertedDeletedAnnotations:!0,disableLinks:!0,disableStyleAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,h().FN)(o),environment:o,formulaValueTypes:a,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:r.value??[],spaceId:(0,m().e)(t.pointer.spaceId)},theme:i}),(0,k.jsx)(g().sA,{...x().LK({propertyName:l,propertyValue:s})})}function T(e){return(0,k.jsx)(M,{...e,icon:d().D})}function I(e){return(0,k.jsx)(M,{...e,icon:u().U})}function w(e){return(0,k.jsx)(M,{...e,icon:l().J})}function _(e){return(0,k.jsx)(M,{...e,icon:p().I})}function P(e){return(0,k.jsx)(M,{...e,icon:s().E})}function B(e){return(0,k.jsx)(M,{...e,icon:c().C})}},951156:(e,t,o)=>{o.d(t,{A:()=>r});o(242343);var n=()=>o(803290),i=()=>o(518797),a=o(163643);const r=function(e){const{botValue:t,botStore:r,showActiveDot:l,style:s,size:c}=e,u=(0,o(653998).tz)(),d=(0,n().K8)((()=>{if(r){const e=r.getIcon();if(e)return{pointer:{table:i().GP,id:r.id,spaceId:r.getSpaceId()},icon:e}}else if(null!=t&&t.icon)return{pointer:{table:i().GP,id:t.id,spaceId:t.space_id},icon:t.icon}}),[r,t]),p=(0,n().K8)((()=>(null==r?void 0:r.getDisplayName(u))??(0,o(466003).Hg)(t)),[r,t,u]),{activeDotStyle:m}=(0,o(174114).IS)((e=>({activeDotStyle:{height:10,width:10,backgroundColor:e.accentColors.green[400],border:"2px solid white",borderRadius:"50%",position:"absolute",left:11,top:11}})),[]);return(0,a.jsxs)("div",{style:s,children:[(0,a.jsx)(o(28210).B,{icon:d,title:p,size:c||18,disabled:!0,isEmptyPage:!1,useInvertedColors:!0}),l?(0,a.jsx)("div",{style:m}):void 0]})}},954397:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,slidersIcon:()=>a});o(242343);var n=o(163643);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},a=(0,o(680369).wt)("sliders",i)},957881:(e,t,o)=>{o.d(t,{w:()=>m});var n=o(242343),i=()=>o(237385),a=()=>o(803290),r=()=>o(174114),l=()=>o(791976),s=()=>o(759625),c=()=>o(84543),u=()=>o(28210),d=()=>o(219322),p=o(163643);function m(e){const{clickTitleBehavior:t,blockStore:o,format:l,shouldWrap:m}=e,y="edit"===t,h=(0,i().v3)(),[f,v,x]=(0,a().K8)((()=>[o.getIcon(),o.isEmptyPage(),o.isReady()&&"none"===o.getRole()]),[o]),{style:b}=(0,r().IS)((()=>({style:{flexShrink:0,marginRight:y?0:d().U[l].recordIconMarginRight,justifyContent:"flex-start",...m&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[y,l,m]),S=(0,n.useCallback)((e=>{const t=o.getIconStore();t&&c().createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:h,canUndo:!0,perform:o=>{s().KY({store:t,value:e,transaction:o})}})}),[o,h]),C={icon:f,size:d().U[l].pageIconSize,isEmptyPage:v,style:b};return x?(0,p.jsx)(g,{...C}):y?(0,p.jsx)(u().B,{...C,disabled:!1,onChange:S,bucket:"public"}):(0,p.jsx)(u().B,{...C,disabled:!0})}function g(e){const t=(0,r().DP)();return(0,l().T)({...e.style,width:e.size,height:e.size,fill:t.icon.secondary,verticalAlign:"top",marginTop:1})}},963644:(e,t,o)=>{o.d(t,{i:()=>a});var n=()=>o(876695),i=()=>o(658294);function a(e){const{environment:t,collectionContextStore:o,property_type:a,from:r,property:l,...s}=e,c=(0,n().sl)(o)||{};(0,i().G)(t,{property:l,property_type:a,from:r,...s,...c})}},969338:(e,t,o)=>{o.d(t,{L:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("historyBack",{viewBox:"0 0 14 14",svg:(0,n.jsx)("polygon",{points:"2.85893 7.74676 8.05608 12.9439 7 14 0.528042 7.52804 0 7 0.528042 6.47196 7 0 8.05608 1.05608 2.85893 6.25324 14 6.25324 14 7.74676"})})},975579:(e,t,o)=>{o.d(t,{A:()=>a});class n extends(()=>o(129044))().default{getInitialState(){return{open:!1}}}const i=new n;(0,o(996094).exposeDebugValue)("AutomationModalStore",i);const a=i},978669:(e,t,o)=>{o.d(t,{A:()=>r});o(242343);var n=()=>o(653998),i=()=>o(395705),a=o(163643);const r=function(e){const t=(0,o(237385).v3)(),{device:r}=t;if(r.isMobile)return e.propertySchema?(0,a.jsx)(i().G,{propertySchema:e.propertySchema,onClick:e.onClick,focused:!1,format:i().e.Name,showExtensionArrow:!e.disabled}):(0,a.jsx)(o(535906).A,{focused:!1,title:(0,a.jsx)(n().sA,{defaultMessage:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const t=e.propertySchema&&(0,a.jsx)(o(224281).mA,{propertySchema:e.propertySchema,showIcon:!0,style:{lineHeight:1.4}}),i=(0,a.jsx)(n().sA,{defaultMessage:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return(0,a.jsx)(o(294821).A,{title:t,placeholder:i,onClick:e.onClick,disabled:e.disabled,disableMargins:e.disableMargins,desktopStyle:e.textWrapperStyle})}}},981793:(e,t,o)=>{o.d(t,{J:()=>c,L:()=>u});o(358848),o(91270);var n=o(242343),i=()=>o(305948),a=()=>o(653998),r=()=>o(76394),l=()=>o(701270),s=o(163643);function c(e){const{analyzedFormulaOutput:t}=e,{parseErrors:o,typeErrors:i}=t,c=(0,a().tz)(),d=(0,n.useMemo)((()=>u(c,o??[],i??[])),[c,o,i]);return(0,r().O9)(d)?(0,s.jsx)(l().D,{colorName:"uiRedPrimary",styleName:"UISmall-12px/Regular",children:(0,s.jsx)(a().sA,{...d})}):null}function u(e,t,o){const n=null==t?void 0:t.at(0);if((0,r().O9)(n))return(0,i().ml)(n);const a=null==o?void 0:o.at(0);return(0,r().O9)(a)?(0,i().rA)(e,a):void 0}},982008:(e,t,o)=>{o.d(t,{W:()=>l});var n=o(242343),i=()=>o(204132),a=()=>o(512040),r=()=>o(271142);function l(e){const t=(0,r().YC)();return{onTextStoreSelect:(0,n.useMemo)((()=>{if(t.defined&&i().Q.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().A.focus({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t]),onTextStoreUnselect:(0,n.useMemo)((()=>{if(t.defined&&i().Q.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().A.blur({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t])}}},984826:(e,t,o)=>{o.d(t,{I:()=>r,_:()=>a});const n={normalizedTitleWithIcon:!0,properties:!0,property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,property_geo_point:!0,views:!0,viewsMain:!0,relationsGroup:!0,formQuestion:!0,placeholder:!0,deleted_property:!1,cover:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,transcript:!1,formTitle:!1,formSubmit:!1,recentActivity:!1,collaborators:!1,teamspaces:!1},i={properties:!0,property:!0,relationsGroup:!0,formQuestion:!0,placeholder:!0,titleWithIcon:!0,cover:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,transcript:!1,formTitle:!1,formSubmit:!1,views:!0,viewsMain:!0,collectionView:!0,collectionViewV2:!0,recentActivity:!1,collaborators:!1,teamspaces:!1};function a(e){return n[e.type]}function r(e){return i[e.type]}},994488:(e,t,o)=>{o.d(t,{o:()=>n});o(362833),o(403517);function n(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];if(0===o.length)return e.map((e=>[e]));const a=[];for(const r of e)a.push(...n(o[0],...o.slice(1)).map((e=>[r,...e])));return a}},996151:(e,t,o)=>{o.d(t,{K5:()=>p,Vp:()=>u,_u:()=>c,oP:()=>m,wC:()=>s,xN:()=>d});o(725707),o(491955),o(403517);var n=()=>o(728373),i=()=>o(984826),a=()=>o(946854),r=()=>o(220865);const l={page_main:[{id:"cover",type:"cover"},{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyIds:[]},{id:"properties",type:"properties"},{id:"discussions",type:"discussions"},{id:"editor",type:"editor"}],page_details:[],form_layout_schema:[],person_profile_page_main:[],person_profile_page_details:[]},s={page_main:[{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyIds:[]},{id:"editor",type:"editor"}],page_details:[],form_layout_schema:[],person_profile_page_main:[],person_profile_page_details:[]},c={page_main:[{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyLabels:"hide",propertyIds:[]},{id:"editor",type:"editor"},{id:"discussions",type:"discussions"}],page_details:[],form_layout_schema:[],person_profile_page_main:[],person_profile_page_details:[]},u={page_main:[],page_details:[],form_layout_schema:[],person_profile_page_main:[{id:"cover",type:"cover"},{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyIds:[]},{id:"recent_activity",type:"recentActivity"}],person_profile_page_details:[{id:"collaborators",type:"collaborators"},{id:"teamspaces",type:"teamspaces"}]};function d(e){return(0,r().jr)({modulesByArea:l,collectionSchema:null==e?void 0:e.collectionSchema,collectionFormat:null==e?void 0:e.collectionFormat})}function p(){return{page_layout_schema:(0,r().ke)(l.page_main).map((e=>{if(!(0,a().cn)(e))return(0,i().I)(e)?{...e,id:(0,n().Ay)()}:e})).filter((e=>void 0!==e)),page_info_layout_schema:(0,r().ke)(l.page_details).map((e=>{if(!(0,a().cn)(e))return(0,i().I)(e)?{...e,id:(0,n().Ay)()}:e})).filter((e=>void 0!==e)),form_layout_schema:void 0,person_profile_page_main:void 0,person_profile_page_details:void 0}}function m(e,t){const o=void 0===t?[{id:(0,n().Ay)(),type:"formQuestion",formQuestionId:e}]:[{id:(0,n().Ay)(),type:"formQuestion",formQuestionId:e},{id:(0,n().Ay)(),type:"formQuestion",formQuestionId:t}];return{page_layout_schema:void 0,page_info_layout_schema:void 0,person_profile_page_main:void 0,person_profile_page_details:void 0,form_layout_schema:[{id:(0,n().Ay)(),type:"cover"},{id:(0,n().Ay)(),type:"formTitle"},...o,{id:(0,n().Ay)(),type:"formSubmit"}]}}}}]);