"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[45986],{98809:(e,t,n)=>{n.d(t,{A:()=>r});n(242343);var o=()=>n(174114),i=()=>n(711361),a=()=>n(126451),l=n(163643);function r(e){let{onClick:t,className:n,isMobile:r,style:s,onFocus:c,onBlur:u,onMouseDown:d,onMouseEnter:p,onMouseLeave:m}=e;const{buttonStyle:g,iconStyle:f}=(0,o().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:6,width:r?45:24,height:r?45:24,marginRight:r?-8:-6,...s},iconStyle:{width:r?18:14,height:r?18:14,fill:e.mediumIconColor}})),[r,s]);return(0,l.jsx)(a().A,{onClick:t,style:g,className:n,mobileFeedback:r,onFocus:c,onBlur:u,onMouseDown:d,onMouseEnter:p,onMouseLeave:m,children:(0,i()._)(f)})}},134917:(e,t,n)=>{n.d(t,{M:()=>i});n(242343);const o={viewBox:"0 0 20 20",svg:(0,n(163643).jsx)("path",{d:"M10.282 3.66a5.39 5.39 0 0 0-5.217-.54l-.711.305a.63.63 0 0 0-.38.575v12.425a.625.625 0 1 0 1.25 0v-3.913l.333-.142a4.14 4.14 0 0 1 4.008.414 5.39 5.39 0 0 0 5.504.405l1.06-.53a.63.63 0 0 0 .346-.56V4a.625.625 0 0 0-.905-.558l-1.06.53c-1.36.68-2.983.56-4.228-.312m-5.057 7.495V4.412l.332-.142a4.14 4.14 0 0 1 4.008.413 5.39 5.39 0 0 0 5.504.406l.156-.078v6.703l-.715.357c-1.36.68-2.983.56-4.228-.312a5.4 5.4 0 0 0-5.057-.604"})},i=(0,n(680369).wt)("flag",o)},196113:(e,t,n)=>{n.d(t,{A:()=>i});n(725707),n(500234);class o extends(()=>n(151255))().A{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const i=new o},401845:(e,t,n)=>{n.d(t,{k:()=>i,q:()=>a});var o=()=>n(129978);const i=new(o().O2)("recurrence",(async()=>{const[e,t,{TemplateRecurrenceConfigMenu:o}]=await Promise.all([Promise.all([n.e(36209),n.e(92845),n.e(71718),n.e(83324),n.e(4422),n.e(82850),n.e(29021)]).then(n.bind(n,464567)),Promise.all([n.e(36209),n.e(92845),n.e(71718),n.e(83324),n.e(4422),n.e(82850),n.e(29021)]).then(n.bind(n,114103)),Promise.all([n.e(36209),n.e(92845),n.e(71718),n.e(83324),n.e(4422),n.e(82850),n.e(29021)]).then(n.bind(n,88224))]);return{recurrenceActions:e,recurrenceHelpers:t,TemplateRecurrenceConfigMenu:o}})),a=(0,o().jQ)(i,(e=>e.TemplateRecurrenceConfigMenu))},568344:(e,t,n)=>{n.d(t,{J:()=>C});var o=n(242343),i=()=>n(237385),a=()=>n(803290),l=()=>n(174114),r=n(163643);const s=(0,n(680369).wt)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,r.jsxs)("svg",{children:[(0,r.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,r.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var c=()=>n(653998),u=()=>n(31448),d=()=>n(658388),p=()=>n(485966);function m(){const[e,t]=(0,o.useState)(!1),l=(0,i().v3)(),r=(0,a().K8)((()=>p().default.state.currentUserSettingsStore),[]);return[(0,a().K8)((()=>{const t=n(836331).default.checkGate({gateName:"dictation_new_page_nux"}),o=null==r?void 0:r.getSettings(),i=Boolean(null==o?void 0:o.dismissed_dictation_new_page_nux);return t&&!i&&!e}),[r,e]),(0,o.useCallback)((()=>{r&&(t(!0),d().wG({environment:l,userSettingsStore:r,dismissed:!0}))}),[l,r,t])]}(0,n(996094).exposeDebugValue)("resetDictationTooltip",(e=>{const t=p().default.state.currentUserSettingsStore;t&&d().wG({environment:e,userSettingsStore:t,dismissed:!1})}));var g=()=>n(907721),f=()=>n(226567),v=()=>n(535906),x=()=>n(204435);const h=(0,c().YK)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),C=(0,o.forwardRef)((function(e,t){const{format:n,className:o,icon:i,title:a,isDefault:l,recurrence:s,recurrenceDisabled:c,right:u,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,locked:v,type:x}=e;return"collection-overlay"===n?(0,r.jsx)(M,{ref:t,className:o,icon:i,format:n,title:a,isDefault:l,recurrence:s,recurrenceDisabled:c,right:u,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,locked:v,type:x}):"phone-modal"===n?(0,r.jsx)(k,{ref:t,icon:i,format:n,title:a,isDefault:l,recurrence:s,focused:d,onClick:p}):"horizontal-new-page"===n?"dictation"===x?(0,r.jsx)(j,{ref:t,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:x}):(0,r.jsx)(A,{ref:t,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:x}):"horizontal-new-page-submenu"===n?(0,r.jsx)(S,{ref:t,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,title:a}):(0,r.jsx)(b,{ref:t,focused:d,onClick:p,onMouseMove:m,onMouseEnter:g,onMouseLeave:f,icon:i,format:n,title:a,isDefault:l,recurrence:s,recurrenceDisabled:c,right:u})}));function y(e){const{format:t,title:o,isDefault:i,recurrenceDisabled:a}=e,d=(0,l().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center"},text:{display:"flex",alignItems:"center",marginLeft:8},default:{fontSize:12,fontWeight:u().Wy.medium,color:e.text.tertiary,borderRadius:4,background:e.surface.wash,padding:"1px 6px"},icon:{width:14,height:12.25,color:n(220413).Ay.lightIconColor,marginLeft:8}})),[]);return"collection-overlay"!==t?(0,r.jsx)(r.Fragment,{children:o}):(0,r.jsxs)("div",{style:d.container,children:[o,(0,r.jsxs)("span",{style:d.text,children:[i&&(0,r.jsx)("span",{style:d.default,children:(0,r.jsx)(c().sA,{defaultMessage:"Default",id:"database.templatePickerMenuItem.default"})}),a?s(d.icon):null]})]})}const M=(0,o.forwardRef)((function(e,t){const{className:n,icon:o,format:a,title:l,isDefault:s,recurrence:c,recurrenceDisabled:u,right:d,focused:p,onClick:m,onMouseMove:g,onMouseEnter:f,onMouseLeave:x,locked:h,type:C}=e,{isMobile:M}=(0,i().Y0)();return(0,r.jsx)(v().A,{ref:t,className:n,icon:o,title:(0,r.jsx)(y,{format:a,title:l,isDefault:s,recurrence:c,recurrenceDisabled:u}),right:d,focused:p,onClick:m,onMouseMove:g,onMouseEnter:f,onMouseLeave:x,showDragHandle:!M&&!h,dragHandleDisabled:"empty_page"===C})})),k=(0,o.forwardRef)((function(e,t){const{icon:n,format:o,title:i,isDefault:a,recurrence:s,focused:c,onClick:u}=e,d=(0,l().IS)((()=>({icon:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24}})),[]);return(0,r.jsx)(v().A,{ref:t,icon:n?(0,r.jsx)("div",{style:d.icon,children:n}):null,title:(0,r.jsx)(y,{format:o,title:i,isDefault:a,recurrence:s}),focused:c,onClick:u,showDragHandle:!1})})),b=(0,o.forwardRef)((function(e,t){let{focused:o,onClick:s,onMouseMove:c,onMouseEnter:u,onMouseLeave:d,icon:p,format:m,title:g,isDefault:f,recurrence:v,recurrenceDisabled:x,right:h}=e;const{isMobile:C}=(0,i().Y0)(),M=(0,n(556078).S)(),k=(0,a().K8)((()=>{const e=null==M?void 0:M.publicEditModeStore.state;return(0,n(88442).ZE)(e)}),[M]),b=(0,l().IS)((e=>({container:{...n(778417).nE,display:"flex",alignItems:"center",flexGrow:1,height:C?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:k?e.text.secondary:e.text.tertiary},icon:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},hovered:{background:e.buttonHoveredBackground,color:e.text.primary},pressed:{background:e.buttonPressedBackground},right:{marginLeft:"auto",marginRight:4}})),[k,C]);return(0,r.jsxs)(n(126451).A,{style:b.container,hovered:o,onClick:s,onMouseMove:c,onMouseEnter:u,onMouseLeave:d,hoveredStyle:b.hovered,pressedStyle:b.pressed,children:[(0,r.jsx)("div",{style:b.icon,children:p}),(0,r.jsx)(y,{format:m,title:g,isDefault:f,recurrence:v,recurrenceDisabled:x}),h?(0,r.jsx)("div",{style:b.right,children:h}):null]})})),A=(0,o.forwardRef)((function(e,t){const{focused:n,onClick:o,onMouseMove:s,onMouseEnter:c,onMouseLeave:d,icon:p,title:m,type:g,tooltipEvents:f}=e,{isMobile:v}=(0,i().Y0)(),h=(0,a().K8)((()=>!v&&("ai"===g||"dictation"===g)),[v,g]),C=(0,l().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",background:e.assistantTintedActionButtonBackground,borderRadius:100,fontSize:13,fontWeight:u().Wy.medium,..."more"===g?{width:32,height:32,padding:0,justifyContent:"center"}:{},...h?{background:e.tint.regular}:{},...n?{background:e.tint.regular}:{},...h&&n?{background:e.tint.regular}:{}}})),[n,h,g]);return(0,r.jsx)("div",{ref:t,onClick:o,onMouseMove:s,onMouseEnter:c,onMouseLeave:d,...f||{},style:C.container,children:(0,r.jsxs)(x().fI,{gap:4,alignItems:"center",children:[p,m]})})})),S=(0,o.forwardRef)((function(e,t){const{focused:n,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:s,icon:c,title:u}=e,d=(0,l().IS)((e=>{const t={background:e.tint.regular,borderRadius:6};return{container:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px",...n?t:{}}}}),[n]);return(0,r.jsx)("div",{ref:t,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:s,style:d.container,children:(0,r.jsxs)(x().fI,{gap:8,alignItems:"center",children:[c,u]})})})),j=(0,o.forwardRef)((function(e,t){const i=(0,o.useRef)(null),[a,s]=m(),u=(0,l().IS)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginLeft:"-4px"},tooltip:{width:200},badge:{background:e.accentColors.translucentGray[300],color:e.text.contrastSecondary,marginLeft:0,width:"fit-content"}})),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n(762436).B,{shouldShow:a,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,r.jsx)(n(822493).k,{style:u.tooltip,pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"top",alignmentToOrigin:g().C.Center,header:(0,r.jsx)(f().A,{style:u.badge}),content:(0,r.jsx)(c().sA,{...h.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:s})}),(0,r.jsx)(n(103151).A,{disableTooltip:a,renderTooltip:()=>(0,r.jsxs)("div",{style:u.tooltipContainer,children:[(0,r.jsx)(f().A,{style:u.badge}),(0,r.jsx)(c().sA,{...h.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:g().W.Top,render:n=>(0,r.jsx)("div",{ref:i,children:(0,r.jsx)(A,{...e,ref:t,tooltipEvents:n})})})]})}))},842940:(e,t,n)=>{n.d(t,{J:()=>i});n(242343);const o={viewBox:"0 0 20 20",svg:(0,n(163643).jsx)("path",{d:"M8.875 2.625a6.25 6.25 0 1 0 3.955 11.09l3.983 3.982a.625.625 0 1 0 .884-.884l-3.983-3.982a6.25 6.25 0 0 0-4.84-10.205m-5 6.25a5 5 0 1 1 10 0 5 5 0 0 1-10 0"})},i=(0,n(680369).wt)("magnifyingGlass",o)},955751:(e,t,n)=>{n.d(t,{K:()=>Q});var o=n.n(n(309102)),i=n(242343),a=()=>n(237385),l=()=>n(803290),r=()=>n(174114),s=()=>n(712437),c=()=>n(625491),u=()=>n(507190),d=()=>n(434626),p=()=>n(134917),m=()=>n(836693),g=()=>n(653998),f=()=>n(220413),v=()=>n(975392),x=()=>n(31448),h=()=>n(352211),C=()=>n(373122),y=()=>n(145046),M=()=>n(927999),k=()=>n(865226),b=()=>n(84543),A=()=>n(337658),S=()=>n(748039),j=()=>n(559181),w=()=>n(749975),I=()=>n(282131),T=()=>n(401845),D=()=>n(944498),E=()=>n(137476),P=()=>n(983050),R=()=>n(29869),_=()=>n(477784),L=()=>n(640979),N=()=>n(466321),V=()=>n(485966),K=()=>n(962373),B=()=>n(331516),O=()=>n(273520),H=()=>n(884373),z=()=>n(935091),U=()=>n(932322),W=()=>n(858023),F=()=>n(709237),G=()=>n(88271),Y=()=>n(611824),J=n(163643);const q=(0,g().YK)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}}),Q=i.memo(i.forwardRef((function(e,t){const{templateStore:o,isMobile:s,isOverlay:c,isDefault:u,locked:d,canConfigureCollection:p,draggable:m,recurrence:g,recurrenceDisabled:f,recurrenceButtonDisabled:x,collectionStore:h,focused:C}=e,y=(0,a().Y0)(),M=(0,a().v3)(),[k,b]=(0,i.useState)(!1),A=(0,l().uB)(void 0,K().A),S=!o&&!c;(0,l().K8)((()=>{if(!o)return!1;const e=o.getAutomationPointer();return!!e&&(0,n(616888).z)(o,e)}),[o]);const j=(0,l().K8)((()=>{var e;return Boolean(null===(e=h.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())}),[h]),w=(0,l().K8)((()=>(!d||d&&!m)&&(p||j)&&(k||A.state.open||s||c)&&!S),[d,m,p,j,k,A,s,c,S]),I=(0,l().K8)((()=>!o||o.isEmptyPage()),[o]),D=(0,l().K8)((()=>{var e;return null==o||null===(e=o.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:h.getRecordModel})}),[o,h]),E=(0,i.useRef)(null);(0,n(158247).b)(n(196113).A,(()=>({templateStore:o,getNode:()=>E.current})),[o]);const R=(0,r().IS)((e=>({contents:{display:"contents"},recordIcon:{...!c&&{pointerEvents:"none",marginRight:10}},pageIcon:{...!c&&{fill:e.lightIconColor}}})),[c]),L=(0,i.useCallback)((()=>{b(!0)}),[]),N=(0,i.useCallback)((()=>{b(!1)}),[]),V=o?(0,J.jsx)(F().A,{enableHover:!0,showTooltipWhenTruncated:!0,store:o}):_().A.formatMessage(q.emptyPageTitle),B=(0,l().uB)(void 0,K().A),O=(0,l().K8)((()=>B.state.open),[B]),H=(g||O)&&o;return(0,J.jsx)("div",{ref:E,style:R.contents,children:(0,J.jsx)(n(568344).J,{ref:t,className:P().SDd,type:o?"custom_template":"empty_page",format:c?"collection-overlay":"page-menu-item",locked:d||!p||!m,icon:(0,J.jsx)(n(28210).B,{disabled:!0,icon:D,isEmptyPage:I,size:y.isMobile&&c?24:20,isLarge:!c,style:R.recordIcon,pageIconStyle:R.pageIcon}),title:V,onClick:e.onClick,onMouseEnter:e.onMouseEnter,right:w?(0,J.jsxs)(n(204435).fI,{alignItems:"center",gap:2,children:[H?(0,J.jsx)(T().q,{...v().cJ(e,["onClick"]),focused:C,disabled:x,recurrence:g,showTooltip:!0,variant:"icon",buttonPopupStore:B,onChange:async e=>{const{recurrenceActions:t}=await T().k.load();e?t.addRecurrence({environment:M,blockStore:o,recurrence:e}):t.deleteRecurrence({environment:M,blockStore:o})}}):null,(0,J.jsx)(Z,{templateStore:o,buttonPopupStore:A,isOverlay:c,canEditContentOnly:j,onCancelClick:e.onCancelClick})]}):null,onMouseMove:L,onMouseLeave:N,focused:C,isDefault:u,recurrence:g,recurrenceDisabled:f})})})));function Z(e){const{templateStore:t,buttonPopupStore:i,isOverlay:r,canEditContentOnly:s,onCancelClick:c}=e,u=(0,a().v3)(),{isMobile:d}=(0,a().Y0)(),p=(0,l().K8)((()=>!!t&&(0,D().p2L)({environment:u,blocks:[t],publicEditMode:void 0})),[t,u]);return(0,J.jsx)(n(103151).A,{renderTooltip:()=>p?(0,J.jsx)(g().sA,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,J.jsx)(g().sA,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:e=>(0,J.jsx)(O().Ay,{popupType:d?N().n.SlideUp:N().n.Popup,placementToOrigin:O().sx.Right,originGap:12,buttonPopupStore:i,renderOrigin:t=>(0,J.jsx)(n(98809).A,{className:o()(P().dn9,{[P().qGl]:d||r}),isMobile:d&&r,style:{...r?{marginRight:-4}:{marginRight:0}},...(0,n(906230).A)(e,t)}),render:e=>(0,J.jsx)(X,{templateStore:t,buttonPopupStore:i,canEditContentOnly:s,isOverlay:r,parent:e,onCancelClick:c}),onClick:()=>{h()._o(u,{template_action:"open_menu"})}})})}function X(e){const{templateStore:t,buttonPopupStore:n,canEditContentOnly:o,isOverlay:s,parent:k,onCancelClick:P}=e,R=(0,a().v3)(),N=(0,a().Y0)(),V=(0,w().ET)(),K=(0,i.useContext)(I().n),{collectionStore:O,collectionViewStore:Q}=(0,l().K8)((()=>({collectionStore:null==V?void 0:V.collectionStore(),collectionViewStore:null==V?void 0:V.collectionViewStore()})),[V]),Z=(0,l().K8)((()=>!!t&&(0,D().p2L)({environment:R,blocks:[t],publicEditMode:void 0})),[t,R]),X=(0,l().K8)((()=>null==t?void 0:t.getAutomationStore()),[t]),te=(0,l().K8)((()=>null!=X&&X.isActive()?null==X?void 0:X.getRecurrence():void 0),[X]),ne=(0,l().K8)((()=>{if(!t)return!1;const e=(0,S().Is)(t);return!e.automationStoresReady||e.violatesConstraint}),[t]),oe=(0,l().K8)((()=>{if(t){const e=(0,S().Is)(t);if(e.automationStoresReady)return e}}),[t]),ie=(0,l().K8)((()=>Boolean(null==oe?void 0:oe.templateNestingExceedsMaxDepth)),[oe]),ae=(0,l().K8)((()=>null==oe?void 0:oe.immediateAncestorRecurrenceType),[oe]),le=(0,l().K8)((()=>Boolean(null==oe?void 0:oe.ancestorHasDailyTemplate)),[oe]),re=(se={templateNestingExceedsMaxDepth:ie,immediateAncestorRecurrenceType:ae,ancestorHasDailyTemplate:le,automationStore:X,environment:R},(0,l().K8)((()=>function(e){const{templateNestingExceedsMaxDepth:t,immediateAncestorRecurrenceType:n,ancestorHasDailyTemplate:o,automationStore:i,environment:a}=e,l="disabled_duplication"===(null==i?void 0:i.getStatus())||"disabled_inactive_space"===(null==i?void 0:i.getStatus());return l&&null!=i&&i.getAlive()?(0,J.jsx)(g().sA,{defaultMessage:"This repeating template was turned off. <inlinelink>Turn on</inlinelink> with the same settings.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionDisabledDuringDuplication",values:{inlinelink:e=>(0,J.jsx)(Y().A,{external:!1,color:"notion-link-blue",hoverColor:"blue",onClick:()=>{!async function(e,t){if(!t)return;const{automationActions:n}=await A().QV.automations.load();b().createAndCommit({userAction:"CollectionTemplatePickerItem.setAutomationStatusToActive",environment:e,canUndo:!0,perform:o=>n.enableAutomation({automationStore:t,environment:e,transaction:o})})}(a,i)},children:e})}}):o?(0,J.jsx)(g().sA,{defaultMessage:"It already gets created daily from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInDaily"}):t?(0,J.jsx)(g().sA,{defaultMessage:"It already gets created automatically from other repeating templates.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionTooDeeplyNested"}):n?(0,J.jsx)(g().sA,{defaultMessage:"This template is within another template that repeats every {immediateAncestorRecurrenceType}.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInTemplate",values:{immediateAncestorRecurrenceType:n}}):void 0}(se)),[se]));var se;const ce=(0,l().K8)((()=>null==X?void 0:X.isReady()),[X]),ue=(0,r().IS)((()=>({nestingExplanationMenuItemTitle:{whiteSpace:"normal",fontWeight:x().Wy.medium,fontSize:x().J.UISmall.desktop},nestingExplanationMenuItemCaption:{whiteSpace:"normal",color:f().Ay.lightTextColor,fontWeight:x().Wy.regular,fontSize:x().J.UISmall.desktop}})),[]),de=(0,i.useCallback)((e=>{if(!O||null==Q||!Q.isDefined())return;const n=null!=t&&t.id?{template_page_id:null==t?void 0:t.id}:"empty";y().ui({showCancel:!0,keepFocus:!1,message:(0,J.jsx)(g().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,J.jsx)("span",{children:e}),pageName:t?(0,J.jsx)(F().A,{store:t,style:{display:"inline"}}):_().A.formatMessage(q.emptyPageTitle)}}),items:[{label:(0,J.jsx)(g().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,J.jsx)(F().A,{store:O,style:{display:"inline"}})}}),onAccept:()=>{e.close(),b().createAndCommit({environment:R,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",canUndo:!0,perform:e=>{M().zA({stores:[O],update:{collection_default_template:n},transaction:e}),M().zA({stores:[Q],update:{collection_view_default_template:n},transaction:e})}})}},{label:(0,J.jsx)(g().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,J.jsx)(j().A,{collectionViewName:Q.getName(),collectionViewType:Q.getType()})}}),onAccept:()=>{e.close(),b().createAndCommit({environment:R,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",canUndo:!0,perform:e=>{M().zA({stores:[Q],update:{collection_view_default_template:n},transaction:e})}})}}]})}),[R,O,Q,t]);if(!O)return null;const pe={key:"section",render:e=>(0,J.jsx)(G().A,{...e}),items:v().oE([t&&!o&&Z&&(!X||ce)&&!ne&&{key:"repeatControl",render:e=>t&&(0,J.jsx)(T().q,{...e,recurrence:te,onChange:async e=>{const{recurrenceActions:n}=await T().k.load();e?n.addRecurrence({environment:R,blockStore:t,recurrence:e}):n.deleteRecurrence({environment:R,blockStore:t})}}),action:()=>function(e,t){E().vd(e,"recurrence_menu_open",{isConfigured:void 0!==t})}(R,te)},s&&!o&&{key:"Set default",render:e=>(0,J.jsx)(B().A,{...e,title:(0,J.jsx)(g().sA,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:p().M}),action:()=>de(k)},t&&{key:"Edit",render:e=>(0,J.jsx)(B().A,{...e,title:Z?(0,J.jsx)(g().sA,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,J.jsx)(g().sA,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:Z?c().M:d().eyeIcon}),action:()=>function(e,t,n,o,i){if(!n)return;null==o||o(),ee(n,e,i),t.reset(),h()._o(e,{template_action:"edit"})}(R,n,t,P,K)},t&&!o&&Z&&{key:"Duplicate",render:e=>(0,J.jsx)(B().A,{...e,title:(0,J.jsx)(g().sA,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:u().V}),action:e=>async function(e,t,n,o,i,a,l){if(!i)return;null==a||a();const{recurrenceActions:r}=await T().k.load(),{performResult:s}=b().createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:t,canUndo:!0,perform:o=>{const a=C().oZ({environment:t,event:e.event,collectionStore:n,templateStore:i,transaction:o});if(i.getAutomationId()){const e=i.getAutomationStore(),n=null==e?void 0:e.getRecurrence();e&&null!=e&&e.isActive()&&n&&r.createRecurrenceInner(o,t,a,n)}return a}});s&&ee(s,t,l);o.reset(),h()._o(t,{template_action:"duplicate"})}(e,R,O,n,t,P,K)},t&&!o&&Z&&{key:"Delete",render:e=>(0,J.jsx)(B().A,{...e,title:(0,J.jsx)(g().sA,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:m().trashIcon}),action:Z?()=>async function(e,t,n){if(!n)return;const{accept:o}=await y().Gh({message:(0,J.jsx)(g().sA,{defaultMessage:"Delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,J.jsx)(g().sA,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})});if(!o)return;b().createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:e,canUndo:!0,perform:e=>C().m0({collectionStore:t,templateStore:n,transaction:e})}),h()._o(e,{template_action:"delete"})}(R,O,t):()=>{}},(ne||re)&&{key:"nestedTemplateExplanation",render:e=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(H().A,{size:12}),(0,J.jsx)(U().Ay,{...e,style:{padding:2},titleStyle:ue.nestingExplanationMenuItemTitle,title:$({cannotAddRecurrenceToTemplate:ne}),captionStyle:ue.nestingExplanationMenuItemCaption,caption:re})]}),action:()=>{}}])};let me;return me=N.isMobile?{menuType:L().gu.ActionSheet}:{menuType:L().gu.Popup,width:230},(0,J.jsx)(z().A,{...me,children:(0,J.jsx)(W().Ay,{type:W().Oh.Vertical,initialFocus:void 0,sections:[pe]})})}function $(e){const{cannotAddRecurrenceToTemplate:t}=e;return t&&(0,J.jsx)(g().sA,{defaultMessage:"This template can't be repeated.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationTitle"})}function ee(e,t,n){const{mainEditorCurrentBlockStore:o}=V().default.state;!function(e,t,n){n?n(e):k().oo({environment:t,url:e})}(o?(0,R().Ay)({store:o,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:s().y8.PeekOpen}):(0,R().Ay)({store:e,fullyQualified:!1,pageVisitSource:s().y8.LinkInPage}),t,n)}}}]);