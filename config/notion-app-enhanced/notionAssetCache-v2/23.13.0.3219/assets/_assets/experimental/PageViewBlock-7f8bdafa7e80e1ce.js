"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9304],{518471:(e,t,o)=>{o.d(t,{AP:()=>$,Ay:()=>le,By:()=>ne,DX:()=>Z,JK:()=>Y,Mi:()=>Ce,NS:()=>be,Qs:()=>de,T1:()=>ee,Wj:()=>ce,Y4:()=>J,dp:()=>oe,g1:()=>he,nu:()=>ye,rK:()=>ke,uD:()=>ie,y_:()=>re,zs:()=>G});o(362833),o(725707),o(500234);var n=o(242343),r=()=>o(16791),i=()=>o(237385),a=()=>o(803290),s=()=>o(973055),l=()=>o(129044),d=()=>o(21164),c=()=>o(653998),u=()=>o(975392),g=()=>o(76394),p=()=>o(31448),m=()=>o(216268),S=()=>o(336400),f=()=>o(601661),v=()=>o(360378),b=()=>o(384221),y=()=>o(594878),h=()=>o(438858),k=()=>o(749975),C=()=>o(210562),P=()=>o(653147),A=()=>o(361837),_=()=>o(400885),B=()=>o(378219),K=()=>o(724903),M=()=>o(471979),x=()=>o(838517),w=()=>o(520969),R=()=>o(509484),I=()=>o(695412),E=()=>o(485966),T=()=>o(962373),D=()=>o(330608),O=()=>o(615661),F=()=>o(836331),V=()=>o(990394),j=()=>o(13889),L=()=>o(261804),H=()=>o(779921),z=()=>o(797470),U=()=>o(960304),N=()=>o(790245),q=()=>o(141122),W=()=>o(150649),Q=()=>o(182613),X=o(163643);const G=p().vc(r().locale).sans,$={serif:p().vc(r().locale).serif,mono:p().vc(r().locale).mono,comic:p().vc(r().locale).comic},Y={serif:1.6,mono:1.6},Z={serif:0,mono:.055},J={serif:15,mono:14},ee={serif:17,mono:15},te={width:"100%",display:"flex",flexDirection:"column",position:"relative",alignItems:"center",flexGrow:1},oe=14,ne=17,re=16,ie=16,ae=30;function se(e,t){var r,p;const w=(0,n.useRef)();w.current=performance.now();const{store:V,context:H,disabled:U,onTitleEsc:N,styleOverrides:Q,disableTopControls:G}=e,$=(0,a().K8)((()=>{var e;return null===(e=V.getSpaceStore())||void 0===e?void 0:e.getFreezeSettings()}),[V]),Y=(0,o(681981).p)($),Z=U||"active"===Y,J=(0,i().v3)(),ee=(0,i().Y0)(),oe=(0,o(556078).S)(),ne=(0,x().bx)(V,Z),re=(0,x().HX)(V,Z),ie=(0,a().K8)((()=>V.isReady()&&re&&!V.isNonEditableState()&&!(0,_().sV)(V)&&!(0,_().fc)(V)),[re,V]),ae=(0,a().O$)(o(802955).e),se=(0,a().K8)((()=>V.isCollectionView()),[V]),le=(0,a().K8)((()=>Boolean((0,o(96814).X2)(V.id))?"v8":"v4"),[V]),ce=(0,a().K8)((()=>V.isCollectionViewPageWithContent()),[V]),Ce=(0,a().K8)((()=>"workflow"===V.getType()),[V]),Pe=(0,a().K8)((()=>{const e=V.getAssociatedCollectionStore(),t=null==e?void 0:e.getLayoutStore();return Boolean(t)}),[V]),Ae=(0,o(248584).no)(V),_e=(0,a().K8)((()=>({layout:{translateX:-1*Ae},layoutFull:{translateX:Ae}})),[Ae]),Be=(0,a().K8)((()=>l().default.createValue(!1,{name:"headerFocusStore"})),[]),Ke=(0,a().O$)(Be),{isInPeek:Me,isInsideSidePeek:xe}=(0,a().K8)((()=>({isInPeek:(0,K().cq)(V),isInsideSidePeek:(0,_().mb)(V)})),[V]),we=(0,n.useMemo)((()=>new(z().Ay)),[]),Re=(0,n.useMemo)((()=>new(T().A)),[]),Ie=(0,n.useMemo)((()=>new(T().A)),[]),Ee=(0,n.useMemo)((()=>new(o(210466).A)),[]),Te=(0,a().K8)((()=>l().default.createValue(!1,{name:"forceControlHoverVisibleStore"})),[]),De=(0,a().O$)(Te),Oe=(0,n.useMemo)((()=>({headerFocusStore:Be,pageViewBlockStore:we,resolvedDiscussionButtonPopupStore:Re,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Ee,forceControlHoverVisibleStore:Te})),[Be,we,Re,Ie,Ee,Te]),[Fe,Ve]=(0,n.useState)(!1),[je,Le]=(0,n.useState)(!1),[He,ze]=(0,n.useState)(""),Ue=(0,n.useCallback)((()=>{Re.setState({open:!0}),we.setState({...we.state,forceDiscussionOpen:!0})}),[we,Re]),Ne=(0,n.useCallback)((()=>{const e=We.current;if(e){if(function(e){if(!e.isIOS)return!1;return!0}(ee))return{paddingLeft:0,paddingRight:0};const t=getComputedStyle(e),o=parseFloat(t.getPropertyValue("padding-left")),n=parseFloat(t.getPropertyValue("padding-right"));return{paddingLeft:u().yr(o)?0:o,paddingRight:u().yr(n)?0:n}}}),[ee]),qe=(0,n.useCallback)((()=>{const e=We.current;if(e){const t=e.getBoundingClientRect().width,o=Ne()??{paddingLeft:0,paddingRight:0};return t-o.paddingLeft-o.paddingRight}}),[Ne]),We=(0,n.useRef)(null),Qe=(0,n.useRef)(null),Xe=(0,n.useRef)(null),Ge=(0,n.useCallback)((()=>We.current),[]),$e=(0,n.useCallback)((()=>Qe.current),[]),Ye=(0,n.useMemo)((()=>new(o(595922).A)(J)),[]);(0,o(158247).b)(o(191759).A,(()=>({store:V,blockContext:H,openResolvedDiscussionPopup:Ue,getContentInnerWidth:qe,getContentWrapEl:Ge,getLayoutEl:$e,collectionContextStore:Ye,headerFocusStore:Be,pageViewBlockStore:we,resolvedDiscussionButtonPopupStore:Re,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Ee,forceControlHoverVisibleStore:Te,headerMouseStore:void 0,detailsFocusStore:void 0,detailsMouseStore:void 0,renderedType:"page",getBlockStore:()=>V,getNode:()=>Xe.current})),[V,H,Ue,qe,Ne,Ge,$e,Ye,Oe]);const Ze=(0,n.useRef)(!1),Je=(0,a().K8)((()=>V.getTitleStore()),[V]),et=(0,a().K8)((()=>V.isInsideFactoryOrDuplicateBlocksAction()),[V]),tt=(0,a().K8)((()=>{const e=I().A.state.publicPageData;return Boolean(null==e?void 0:e.isDLSViewer)}),[]),ot=(0,a().K8)((()=>(0,o(481148).LX)({device:ee})),[ee]),nt=(0,n.useCallback)((()=>!!Je&&(!!e.forceSelectTitleOnMount||!se&&(!(ee.isMobile&&ee.isPhone&&o(422650).A.hasOpenMobileSlideUps())&&(!o(34662).q4_(Je.getValue())||(0,_().In)(V)&&!ee.isMobile)))),[ee.isMobile,ee.isPhone,se,e.forceSelectTitleOnMount,V,Je]),rt=(0,a().K8)((()=>V.isFormBlock()),[V]),[it,at]=(0,a().K8)((()=>[Boolean(V.getIcon()),Boolean(V.getCover())]),[V]),st=(0,a().K8)((()=>{const e=o(985532).A.state.shouldUseEdgeCache,t=F().default.checkGate({gateName:"edge_cache_mentions"});return e&&t}),[]);(0,o(371854).v)(),(0,n.useEffect)((()=>{if(F().default.checkGate({gateName:"dont_load_users"})||async function(e){const{environment:t,shouldUseEdgeCache:o}=e;o||L().A.state.emptyQueryUserRequestStore.setState({...L().A.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0});await E().default.waitUntil((()=>Boolean(E().default.state.currentSpaceStore&&E().default.state.mainEditorCurrentBlockStore)));const n=await R().T.searchActions.load(),r=await n.searchVisibleSpaceUsers({environment:t,query:"",membersOnly:!1,minFuzzyScore:25,placeSelfFirst:!1});o||L().A.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:r})}({environment:J,shouldUseEdgeCache:st}),(0,o(143920).y)(),ee.isPhone&&!ot){const{PageScroller:e}=o(73876).A;if(e){const t=e.getNode();if(t&&ne&&!at){const e=ye(H,J);t.scrollTo({top:e})}}}if(Je&&nt()&&(v().hc({environment:J,store:V}),b().setSelectionAtEnd({store:Je})),f().updateMetricDataWithIsPushTag(J),H!==z().Rr.Frame||se||rt||(w.current&&o(551455).A.markPageViewBlockRender(w.current),f().measurePageRenderMetrics({environment:J,isEditable:ie,isHomePage:!1,isWikiHome:!1,isPageWithCustomLayout:Pe,idSchema:le}),function(e,t){var o;ve(e,t)&&(null===(o=t.mobileNative)||void 0===o||o.markTransitionReady({environment:t,type:"new_page",id:e.id,sendImmediately:!0}))}(V,J)),Ye){const e=(0,o(876695).kz)(Ye);o(196387).default.DO_NOT_USE_measureLegacy("collections.open_item_page_lag",{environment:J,data:{...e,peek_mode:q().default.getPeekMode()}})}!async function(e,t){const{aiOnboardingActions:o}=await y().aiDependency.load(),{getAiOnboardingPhase:n,AiOnboardingQueuedSelectedStore:r}=o;if("space_for_ai"!==n())return;const i=e.getContentStores()[0],a=r.state;if(!i||i.id!==a)return;v().hc({environment:t,store:i}),b().setSelectionAtEnd({store:i.getBlockTitleStore()})}(V,J)}),[]);const lt=(0,a().K8)((()=>V.getFormat()),[V]),dt=(0,a().K8)((()=>{var e;return null===(e=O().Uv.getStateForBlock(V.id))||void 0===e?void 0:e.mode}),[V.id]),ct=(0,a().K8)((()=>{var e;const t=C().ei.state,n=(0,g().O9)(t)&&(null===(e=B().Nq(t))||void 0===e?void 0:e.id)===V.id;return C().gZ.state&&n&&"disconnected"===o(710602).A.state}),[V.id]),ut=(0,a().K8)((()=>{var e;return B().ze(V)||Boolean(null===(e=I().A.state.publicPageData)||void 0===e?void 0:e.isDeleted)&&pe(H)}),[V,H]),gt=(0,a().K8)((()=>oe&&oe.publicEditModeStore.state),[oe]),pt=(0,a().K8)((()=>V.isTemplate()),[V]),mt=(0,a().K8)((()=>V.isDraft()),[V]),St=(0,a().K8)((()=>ke(J)),[J]);(0,n.useEffect)((()=>{if(H===z().Rr.Frame){const e=Se(H);null==gt||!gt.hasPublicPermission||"edit"!==gt.permission||pt||(0,o(186438).g)()?m().zA({bannerStore:e,id:"EditingPageBanner"}):m().HQ({bannerStore:e,id:"EditingPageBanner",contentKey:"editing_page",styleKey:P().q.White});o(664463).A.state.pageMap[V.id]?m().HQ({bannerStore:e,id:"ImportingEvernotePage",contentKey:"importing_evernote",styleKey:P().q.Blue,blockStore:V}):m().zA({bannerStore:e,id:"ImportingEvernotePage"})}if(fe(H)){const e=Se(H),t=B().Gg(V),n=B().Cf(V);if((0,o(514138).vW)(t))m().HQ({bannerStore:e,id:"SpaceContentDuplicationPage",contentKey:"space_content_duplication",styleKey:P().q.Red,blockStore:V});else if(!ut||rt||ve(V,J))if(n)m().HQ({bannerStore:e,id:"ArchivedTeamPage",contentKey:"page_in_archived_team",styleKey:P().q.Red});else for(const o of["SpaceContentDuplicationPage","DeletedPage","ArchivedTeamPage"])m().zA({bannerStore:e,id:o});else m().HQ({bannerStore:e,id:"DeletedPage",contentKey:"deleted_or_moved_page",blockStore:V,styleKey:P().q.Red});mt&&St?m().HQ({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner",contentKey:"draft_post_in_expanded_feed_composer",styleKey:P().q.Blue,blockStore:V}):m().zA({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner"}),ct?m().HQ({bannerStore:e,id:"DictationConnectionBanner",styleKey:P().q.Yellow,contentKey:"dictation_connection",blockStore:V}):m().zA({bannerStore:e,id:"DictationConnectionBanner"}),dt&&(0,O().Or)(dt)?m().HQ({bannerStore:e,id:"TranslateBanner",styleKey:P().q.Blue,contentKey:"translate",blockStore:V}):m().zA({bannerStore:e,id:"TranslateBanner"}),tt&&!(0,K().cq)(V)?m().HQ({bannerStore:e,id:"TrustedDomainPageBanner",styleKey:P().q.LightGray,contentKey:"trusted_domain_page",blockStore:V}):m().zA({bannerStore:e,id:"TrustedDomainPageBanner"}),pt?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_page",styleKey:P().q.Beige,blockStore:V,context:H,disabled:Z}):et?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_button",styleKey:P().q.Beige,blockStore:V,context:H,disabled:Z}):m().zA({bannerStore:e,id:"CollectionTemplatePage"}),(null!=lt&&lt.is_asana_imported_project||null!=lt&&lt.is_asana_imported_task)&&(null!=lt&&lt.dismissed_asana_import_banner?m().zA({bannerStore:e,id:"AsanaImporterBanner"}):m().HQ({bannerStore:e,id:"AsanaImporterBanner",contentKey:"asana_importer_banner",blockStore:V,styleKey:P().q.ImportNotification}))}return()=>{fe(H)&&(m().zA({bannerStore:Se(H),id:"DeletedPage"}),m().zA({bannerStore:Se(H),id:"CollectionTemplatePage"}),m().zA({bannerStore:Se(H),id:"Site"}),m().zA({bannerStore:Se(H),id:"CrdtPage"}),m().zA({bannerStore:Se(H),id:"TrustedDomainPageBanner"}),m().zA({bannerStore:Se(H),id:"TranslateBanner"}),m().zA({bannerStore:Se(H),id:"AsanaImporterBanner"}),m().zA({bannerStore:Se(H),id:"DraftPostInExpandedFeedComposerBanner"}))}}),[J,gt,H,Z,V,ut,rt,et,null==lt?void 0:lt.is_asana_imported_project,null==lt?void 0:lt.is_asana_imported_task,null==lt?void 0:lt.dismissed_asana_import_banner,dt,ct,tt,pt,mt,St]),(0,o(269280).l)((()=>{"suggest"===O().Uv.getMode(V,!0)?S().Nz({environment:J,location:"page_navigation",navigableBlockStore:V}):ee.isMobile||V.canEdit()||!V.canComment()||V.isLocked()||se&&!ce||O().Uv.hasModeSet(V)||V.useCrdt()||V.isFormBlock()||H===z().Rr.PostInFullPageOrPeek||(0,o(673447).ot)(B().E(V))||S().PD({environment:J,navigableBlockStore:V,mode:"suggest",location:"default_on_for_comment_only_user"})})),(0,o(86979).Bs)({pageId:V.id,isFrameContext:pe(H)}),(0,n.useEffect)((()=>()=>{"suggest"===O().Uv.getMode(V,!0)&&S().eB({environment:J,location:"page_navigation",navigableBlockStore:V})}),[J,V]);const ft=(0,a().K8)((()=>ge(V)),[V]),vt=(0,a().K8)((()=>null==ft?void 0:ft.getParentBlockStore()),[ft]),bt=(0,a().K8)((()=>null==Ye?void 0:Ye.collectionStore()),[Ye]);ft&&ft!==bt&&Ye.setContext({type:"collectionPage",collectionViewBlockStore:vt,collectionStore:ft});const yt=(0,a().K8)((()=>{const e=(0,o(81421).Xz)(J.TabbedRouterStore.state);if("web"===e.type){var t,n;if("page"===(null===(t=e.redirectedTo)||void 0===t?void 0:t.route.name))return null===(n=e.redirectedTo)||void 0===n?void 0:n.route.blockId;if("page"===e.route.name)return e.route.blockId}}),[J]),ht=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{if(J.mobileNative&&He===yt){var e;const t=yt!==ht.current;null===(e=J.mobileNative)||void 0===e||e.markTransitionReady({environment:J,type:"page",id:V.id,sendImmediately:!0,isNavigationEvent:t}),ht.current=yt}}),[J,yt,He,V.id]),(0,n.useEffect)((()=>{ze(V.id)}),[V]);const kt=(0,n.useCallback)((()=>{Me||D().A.state.isDragging||W().default.state.isActive||Ve(!0)}),[Me]),Ct=(0,n.useCallback)((()=>{Me||D().A.state.isDragging||W().default.state.isActive||Ve(!1)}),[Me]),Pt=(0,n.useCallback)((()=>{D().A.state.isDragging||W().default.state.isActive||Le(!0)}),[]),At=(0,n.useCallback)((()=>{D().A.state.isDragging||W().default.state.isActive||Le(!1)}),[]),_t=(0,s().d)(Pt,100),Bt=(0,s().d)(At,100),Kt=(0,n.useCallback)((e=>{Je&&(v().hc({environment:J,store:V}),e.isAtStartOfLine?b().setSelectionAtStart({store:Je}):b().setSelectionAtEnd({store:Je}))}),[J,V,Je]),Mt=(0,n.useCallback)((e=>{b().clear({environment:J}),v().IU({environment:J}),N&&N(e)}),[J,N]),xt=(0,n.useCallback)((e=>{if(se)return!0;if(e.preventDefault(),function(e){return Boolean(ge(e))}(V)){const e=(0,_().gV)(V);if(e&&e.collection_page_properties){const t=e.collection_page_properties.find(((e,t)=>function(e,t){const o=ge(t);if(!o)return!1;const n=function(e){return e.getSchema()}(t);return(0,A().B2)(n[e])}(e.property,V)));t&&o(752597).default.afterNextFlush((()=>{o(665865).ho({environment:J,blockPropertyValueOverlayStore:me(H),collectionContextStore:Ye,store:V,property:t.property,format:"page"})}))}}}),[Ye,H,J,se,V]),wt=(0,n.useCallback)((e=>{if(se)return!0;Mt(e)}),[Mt,se]),Rt=(0,n.useCallback)((()=>{Ee.reset()}),[Ee]),It=(0,n.useCallback)((e=>{e.target===Xe.current&&null===e.relatedTarget&&document.hasFocus()&&v().IU({environment:J})}),[J]),Et=(0,a().K8)((()=>be((0,o(377561).dC)(J,V),V,H,J)),[J,H,V]),Tt=(0,a().K8)((()=>{const e=V.isDraft(),t=V.isPublishedDraft();return H===z().Rr.DraftPostInInlineComposer?z().Rr.DraftPostInInlineComposer:t?z().Rr.PostInFullPageOrPeek:e?z().Rr.DraftPostInFullPageComposer:void 0}),[V,H]),Dt=(0,o(710548).sS)({pageStore:V,postContext:Tt,collectionStore:ft,pageViewBlockStore:Oe.pageViewBlockStore}),Ot=(0,a().K8)((()=>q().default.state.topHoverAreaEntered),[]),Ft=(0,n.useCallback)((e=>{const{isBottomControl:t,forceVisible:o}=e??{},n=Me?Ot:Fe;let r;return r=!!ee.isMobile||(!!o||(!!De||(t?je&&!j().A.state.isKeyboardMode:n&&!j().A.state.isKeyboardMode||Ke))),he(r)}),[je,ee.isMobile,Ke,Fe,Me,Ot,De]),Vt=(0,a().K8)((()=>Ft({isBottomControl:!1})),[Ft]),jt=(0,a().K8)((()=>"suggest"===O().Uv.getMode(V)),[V]),Lt=(0,a().K8)((()=>(0,M().$3)({environment:J,collectionStore:V.getAssociatedCollectionStore()})),[J,V]),Ht=(0,a().K8)((()=>(0,M().xE)(J)),[J]),zt=(0,a().K8)((()=>(0,M().Wk)({environment:J,blockStore:V,showUpsell:Lt})),[J,V,Lt]),Ut=(0,o(598808).X)({environment:J,blockStore:V,from:"topControls",blockContext:H}),Nt=(0,n.useCallback)((e=>{let{from:t}=e;const n=se?V.getCollectionStore():ge(V);n&&(0,o(760813).nh)({environment:J,blockStore:V,collectionStore:n,from:t})}),[J,se,V]),qt=(0,n.useMemo)((()=>{if(G||ot)return[];const e=[];return!ie||it||jt||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(56255).A,{store:V,afterOnClick:()=>{Ze.current=!0},style:Vt,label:ee.isSmallPhone?(0,X.jsx)(c().sA,{id:"PageViewBlock.icon.pageIconMobile",defaultMessage:"Icon"}):(0,X.jsx)(c().sA,{id:"PageViewBlock.icon.pageIcon",defaultMessage:"Add icon"})})},"add-icon")),!ae||!ie||at||jt||Tt||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(169280).A,{store:V,style:Vt,label:ee.isSmallPhone?(0,X.jsx)(c().sA,{id:"PageViewBlock.cover.pageCoverMobile",defaultMessage:"Cover"}):(0,X.jsx)(c().sA,{id:"PageViewBlock.cover.pageCover",defaultMessage:"Add cover"})})},"add-cover")),zt&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(144615).ui,{store:V,style:Vt,showUpsell:Lt,showNewBadge:Ht})},"verify-page")),Ut&&!Tt&&e.push((0,X.jsx)(o(538515).E,{blockStore:V,onClick:()=>Nt({from:"customize_page_button_above_title"}),style:Vt},"customize-layout")),ie&&!ee.isMobile&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(279923).l,{store:V})},"generate-preview-image")),e}),[G,ot,ie,it,jt,ae,at,Tt,zt,Ut,ee.isMobile,ee.isSmallPhone,V,Vt,Lt,Ht,Nt]),Wt=(0,a().K8)((()=>{const{WindowSizeStore:e}=J,t=se?"20vh":(null==Q?void 0:Q.pageCoverHeight)??de(J),n=(null==Q?void 0:Q.paddingX)??(0,_().OU)(H,J);return(0,X.jsx)(o(388615).s,{allowSelectionWithin:!1,style:(0,o(581101).E)(V,J),children:(0,X.jsx)(o(180365).A,{height:t,store:V,disabled:!ie,paddingLeft:e.getSafePaddingLeftCSS(n),paddingRight:e.getSafePaddingRightCSS(n),proxyWidth:e.state.width})})}),[J,se,ie,Q,V,H]),Qt=(0,a().K8)((()=>{const e=J.currentUser.isLoggedIn(),t=oe&&oe.publicEditModeStore.state;let n;return H===z().Rr.Frame?n=E().default.state.currentLoadingContainerStore:H===z().Rr.PeekView&&q().default.state.open&&(n=q().default.state.loadingContainerStore),Boolean(V&&n&&V.isDefined()&&!V.isNonEditableState()&&V.canEdit()&&!V.hasContent()&&e&&(!(null!=t&&t.hasPublicPermission)||"edit"===(null==t?void 0:t.permission))&&!(Boolean(o(366069).A.state.pageMap[V.id])||o(346267).A.state.pages.has(V.id))&&n.state.ready&&!(0,_().sV)(V)&&!(0,_().fc)(V)&&(!(0,o(88442).ZE)(t)||"completionPopup"!==o(471370).default.state.type))}),[J.currentUser,oe,V,H]),Xt=(0,n.useMemo)((()=>({store:V,isEditable:ie,hasCover:at,isInSidePeek:xe,openMenuOnMountCallback:()=>{Ze.current=!1}})),[at,ie,xe,V]),Gt=(0,a().K8)((()=>function(e){return Boolean(e.getAssociatedCollectionStore())}(V)),[V]),$t=(0,a().K8)((()=>ee.isMobile&&!ee.isTablet&&ee.isIOS&&!Gt&&"on"===F().default.getEligibleGroup({experimentId:"mobile_lightweight_editor_prompt",defaultGroup:"control"})),[ee.isMobile,ee.isTablet,ee.isIOS,Gt]),Yt=(0,a().K8)((()=>{var t;const o=(null===(t=e.styleOverrides)||void 0===t?void 0:t.paddingX)??(0,_().OU)(H,J);let n=e.titlePlaceholder;return $t&&(n=""),{store:V,disabled:!ne,isInSidePeek:xe,paddingLeft:o,paddingRight:o,extraStyles:e.titleStyle,titlePlaceholder:n,collectionContextStore:Ye,shouldShowTemplatePicker:Qt,onTitleChange:Rt,onTitleEditText:Kt,onTitleEsc:Mt,onTitleUntab:wt,onTitleTab:xt}}),[null===(r=e.styleOverrides)||void 0===r?void 0:r.paddingX,e.titleStyle,e.titlePlaceholder,H,J,V,ne,Ye,Qt,Rt,Kt,Mt,wt,xt,xe,$t]),Zt=(0,n.useCallback)((e=>{"page"===e&&f().measurePageRenderMetrics({environment:J,isEditable:ie,isHomePage:!1,isWikiHome:!0,isPageWithCustomLayout:!1,idSchema:le})}),[J,ie,le]),Jt=(0,a().K8)((()=>{var t,n;const r=(0,X.jsx)(o(18434).X.Provider,{value:Ae,children:(0,X.jsx)(o(615917).A,{tag:o(116485).Mx,animate:_e.layout,type:Et,withBottomPadding:H!==z().Rr.DraftPostInInlineComposer&&H!==z().Rr.Presentation,ref:Qe,children:(0,X.jsx)(o(38095).A,{context:H,postContext:Tt,onHeaderMouseEnter:kt,onHeaderMouseLeave:Ct,onDetailMouseEnter:_t,onDetailMouseLeave:Bt,pageCoverHeight:(null===(t=e.styleOverrides)||void 0===t?void 0:t.pageCoverHeight)??de(J),modules:(null===(n=e.layoutModulesByArea)||void 0===n?void 0:n.page_main)??Dt.page_main,styleOverrides:e.styleOverrides,templatePickerMenuListStore:Oe.templatePickerMenuListStore,topControls:qt,getControlHoverStyle:Ft,pageViewBlockStores:Oe,...Xt,openMenuOnMount:Ze.current,...Yt,disabled:Z,pageViewBlockAccessor:$e,editorContentContainerRef:We,layoutRef:Qe})})});return Ye&&Ye.contextType?(0,X.jsx)(k().RI,{value:Ye,children:r}):r}),[Ae,_e.layout,Et,H,kt,Ct,_t,Bt,e.styleOverrides,null===(p=e.layoutModulesByArea)||void 0===p?void 0:p.page_main,J,Dt.page_main,Oe,qt,Ft,Xt,Yt,Z,$e,Ye,Tt]),eo=(0,a().K8)((()=>V.getType()===o(762847).xd.copyIndicator&&(V.getParentTable()!==d().Vl||V.getParentTable()===d().Vl&&0===Object.keys(V.getProperties()).length)?(0,X.jsx)(o(133872).F,{}):o(671895).A.state.isDuplicating?(0,X.jsx)(h().R,{store:V,peekMode:void 0,forceShowIcon:!0}):se?(0,X.jsx)(k().RI,{value:Ye,children:(0,X.jsx)(o(223279).O,{canEdit:ne,context:z().Rr.CollectionViewBlockFullScreen,controlHoverStyle:Vt,handleHeaderMouseEnter:kt,handleHeaderMouseLeave:Ct,headerFocusStore:Oe.headerFocusStore,pageCover:Wt,topControls:qt,...Xt,openMenuOnMount:Ze.current,...Yt,store:V,productUseCase:"full_page",onCollectionViewBlockMount:Zt,editorContentContainerRef:We,pageViewBlockStore:we})}):rt?(0,X.jsx)(o(915634).e,{renderLoading:()=>(0,X.jsx)(h().R,{store:V,peekMode:void 0}),innerRenderLoading:()=>(0,X.jsx)(h().R,{store:V,peekMode:void 0}),store:V}):Ce?(0,X.jsx)(o(547124).eN,{store:V}):(0,X.jsx)(o(393342).c,{displayName:"PageContent",style:{...te,...e.style},disabled:!ne||V.isNonEditableState(),onBlur:It,shouldSelectOnEnter:ue,ref:Xe,children:(0,X.jsx)(o(880195).A,{name:"PageContent",children:Jt})})),[V,se,rt,Ce,e.style,ne,It,Jt,Ye,Vt,kt,Ct,Oe.headerFocusStore,Wt,qt,Xt,Yt,Zt,we]);return(0,x().NW)(V,t,(0,n.useMemo)((()=>({store:V,blockContext:H,openResolvedDiscussionPopup:Ue,getContentInnerWidth:qe,getContentWrapEl:Ge,getLayoutEl:$e,collectionContextStore:Ye,...Oe,renderedType:"page",getBlockStore:()=>V,getNode:()=>Xe.current})),[V,H,Ye,qe,Ge,$e,Ue,Oe]),eo)}const le=n.memo(n.forwardRef(se),o(21045).A);function de(e){return e.device.isMobile?200:`${ae}vh`}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{device:o}=e;return o.isTablet?380:o.isIOS?Math.max(350,t):o.isMobile?400:"30vh"}function ue(){return 0===Q().default.state.stores.length}function ge(e){return e.getAssociatedCollectionStore()}function pe(e){return e===z().Rr.Frame}function me(e){return(0,_().L5)(e)?N().A:H().A}function Se(e){return(0,_().L5)(e)?U().A:pe(e)?V().A:(0,g().HB)(e)}function fe(e){return pe(e)||(0,_().L5)(e)}function ve(e,t){const{device:o,RouterStore:n}=t,{route:r}=n.state,i=e;return o.isMobileNative&&"page"===r.name&&r.showMoveTo&&i.isEmptyTitle()&&i.isEmptyPage()}function be(e,t,o,n){return o===z().Rr.DraftPostInInlineComposer?"create-post":o===z().Rr.Presentation?"presentation-mode":n.device.isPhone?"phone":n.device.isTablet?(0,_().Ck)(t,o,n)?"wide":"tablet":(0,_().L5)(o)?(0,_().mb)(t)?"side-peek":"center-peek":function(e){return e===z().Rr.InAppTemplatePreview}(o)||function(e){return e===z().Rr.InPageSnapShot}(o)?"template-preview":(0,_().Ck)(t,o,n)?e?"wide-right-margin-expanded":"wide":"default"}function ye(e,t){return 28+(0,_().XD)(e,t)}function he(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}function ke(e){if(!q().default.isSidePeekOpen()&&!q().default.isCenterPeekOpen())return!1;const t=E().default.state.mainEditorCurrentBlockStore;return(0,w().lU)(t)}function Ce(e){return!!e&&(e===z().Rr.PostInFullPageOrPeek||e===z().Rr.DraftPostInFullPageComposer)}}}]);