"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18766],{82954:(e,t,o)=>{o.d(t,{A:()=>E});var n=o(242343),i=()=>o(803290),r=()=>o(502852),l=()=>o(752597),a=()=>o(384221),s=()=>o(755786),d=()=>o(126451),c=()=>o(709237),u=o(163643);function p(e){const{blockStore:t,titleStyle:o,shouldWrap:i,recordTitleRef:r,disableTooltip:p}=e,g=(0,n.useRef)({getNode:()=>r.current}),S=(0,n.useCallback)((e=>{l().default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const o=e.getValue(),n=o?o[0][0].length:0,i={start:{index:n,store:e},end:{index:n,store:e}};a().setMultiSelection({multiSelection:i})}))}),[t]);return(0,u.jsx)(d().A,{style:{height:s().d0+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:S,children:(0,u.jsx)(c().A,{store:t,underline:!0,shouldWrap:i,style:o,ref:g,disableTooltip:p})})}var g=()=>o(653998),S=()=>o(975392),f=()=>o(868199),h=()=>o(477784),y=()=>o(636045);const b=(0,g().YK)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function k(e){const{blockStore:t,clickTitleBehavior:o,onTitleEnter:n,onTitleEsc:r}=e,l="edit"===o,a=(0,i().K8)((()=>t.getBlockTitleStore()),[t]);return(0,u.jsx)(y().A,{store:a,disabled:!l,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:n,onEsc:r,onTab:S().D_,placeholder:h().A.formatMessage(b.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:f().Os.none})}var m=()=>o(237385),x=()=>o(34662),v=()=>o(448316);const w=function(e){const{store:t,style:l,disableLinks:a,disableHover:s,isAndroid:d,externalIntegrations:c,canEdit:p,shouldWrap:S,tokenFormat:f}=e,h=(0,n.useRef)(null),y=(0,g().tz)(),b=(0,m().v3)(),k=(0,o(174114).DP)(),{isExternalIntegrationPageType:w,blockType:I,blockId:T,blockModel:M}=(0,i().K8)((()=>{const e=t.getModel();return{isExternalIntegrationPageType:Boolean(null==e?void 0:e.isType(o(762847).xd.externalObjectInstancePage)),blockType:t.getType(),blockId:t.id,blockModel:e}}),[t]),R=(0,i().K8)((()=>o(284320).A.getState()),[]),C=(0,n.useCallback)((()=>{if(!h||!h.current)return;const e=(0,x().bMp)(t.id),o=(0,x().wmz)(e);return{textValue:[o],tokenIndex:0,textToken:o,node:h.current}}),[h,t.id]),B=(0,n.useCallback)((e=>{if(s)return;const o=C(),n=t.getTitleStore();n&&o&&v().xE({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[s,C,t,b,p]),j=(0,n.useCallback)((e=>{const o=C(),n=t.getTitleStore();n&&o&&!s&&v().HH({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[C,t,s,b,p]),A=t.getRecordModel,P=T,L=(0,o(441165).FN)(b),E=o(927685).A.domainBaseUrl,O=b.currentUser.id,W=!a,z=(0,i().K8)((()=>{if(M)return(0,o(123047).gA)({blockModel:M,shouldWrap:S,index:0,style:l,disableHover:s,disableLinks:a,isAndroid:d,theme:k,getRecordModel:A,currentUserId:O,baseUrl:E,emojiType:L,externalIntegrations:c,classNames:[],intl:y,emojiData:R,stopLinkPropagation:W,tokenFormat:(0,o(250786).Ug)(f)})}),[M,S,l,s,a,d,k,A,O,E,L,c,y,R,W,f]);return P?"external_object_instance_page"!==I?null:w?(0,u.jsx)("span",{ref:h,onMouseOver:B,onMouseOut:j,onClick:W?r().kV:void 0,style:{width:"100%"},children:z}):null:null};function I(e){const{blockStore:t,shouldWrap:n,style:r,disableLinks:l,format:a}=e,s=(0,i().K8)((()=>(0,o(809811).q7)(t.getSyncedUri())),[t]),d=(0,i().O$)(o(773082).A.integrations),c=(0,m().v3)();return(0,u.jsx)(w,{shouldWrap:n,store:t,style:r,disableHover:l||!s,disableLinks:l||!s,isAndroid:c.device.isAndroid,externalIntegrations:d,canEdit:!0,tokenFormat:a})}var T=()=>o(219322);function M(e){const{format:t,showRemoveButton:n,onClickRemove:i}=e,{height:r,closeIconSize:l}=T().U[t];return n?(0,u.jsx)(d().A,{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"center",width:r,height:r,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,o(388732).l)({width:l,height:l,opacity:.5})}):null}var R=()=>o(712437),C=()=>o(314164),B=()=>o(749975),j=()=>o(29869),A=()=>o(485966);var P=()=>o(621641),L=()=>o(205670);const E=(0,n.forwardRef)((function(e,t){const{parentStore:r,blockId:l,shouldWrap:a,format:s,showRemoveButton:d,clickTitleBehavior:c,onClickRemove:p,titleStyle:g,onTitleEnter:S,onTitleEsc:f,index:h,noUnderline:y,disableTooltip:b,disableLinks:k}=e,m=o(413871).Bv.createChildStore(r,{table:o(145017).ev,id:l}),{style:x}=(0,T().t)(e),v=(0,n.useRef)(null),w=(0,n.useRef)(null),R="peek"===c;(0,n.useImperativeHandle)(t,(()=>m),[m]);const C=(0,i().K8)((()=>"external_object_instance_page"===m.getType()),[m]);if((0,o(731991).W)(m))return null;if(C)return(0,u.jsx)(I,{shouldWrap:a,blockStore:m,style:x,disableLinks:k,format:s});const B=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o(957881).w,{format:s,blockStore:m,clickTitleBehavior:c,shouldWrap:a}),(0,u.jsx)(W,{blockStore:m,recordTitleRef:v,clickTitleBehavior:c,shouldWrap:a,titleStyle:g,noUnderline:y,onTitleEnter:S,onTitleEsc:f,index:h,disableTooltip:b})]});return(0,u.jsxs)("div",{style:x,ref:w,children:[R?(0,u.jsx)(O,{blockStore:m,relationTokenStyle:x,children:B}):B,(0,u.jsx)(M,{showRemoveButton:d,onClickRemove:p,format:s})]})}));function O(e){let{blockStore:t,relationTokenStyle:l,children:a}=e;const{blockUrlPage:s,blockUrlPeek:d}=function(e){const t=(0,m().v3)(),o=(0,B().Ks)(),n=(0,i().K8)((()=>(0,j().Ay)({store:e,fullyQualified:!1,pageVisitSource:R().y8.LinkInPage})),[e]);return{blockUrlPeek:(0,i().K8)((()=>{const{mainEditorCurrentBlockStore:n}=A().default.state;return C().wy({environment:t,store:e,mainEditorCurrentBlockStore:n,collectionContextStore:o,fullyQualified:!1})}),[t,e,o]),blockUrlPage:n}}(t),c=(0,n.useMemo)((()=>({display:l.display,height:l.height,alignItems:l.alignItems})),[l]);return(0,u.jsx)(o(579494).A,{href:s,metaHref:d,onClick:r().kV,style:c,children:a})}function W(e){const{blockStore:t,clickTitleBehavior:n,onTitleEnter:r,onTitleEsc:l,index:a,recordTitleRef:s,titleStyle:d,shouldWrap:c,noUnderline:g,disableTooltip:S}=e,f=(0,o(248584).Sm)(t),h="edit"===n&&!f,y=function(e){return(0,i().K8)((()=>{var t;const o=L().default.state;return"editing"===o.mode&&(null===(t=(0,P().H7)(o.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}(t);return h?y&&r&&a?(0,u.jsx)(k,{blockStore:t,clickTitleBehavior:n,onTitleEnter:r,onTitleEsc:l}):(0,u.jsx)(p,{blockStore:t,recordTitleRef:s,titleStyle:d,shouldWrap:c,disableTooltip:S}):(0,u.jsx)(o(399631).Y,{blockStore:t,recordTitleRef:s,titleStyle:d,shouldWrap:c,noUnderline:g,disableTooltip:S})}},150936:(e,t,o)=>{o.d(t,{b:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},219322:(e,t,o)=>{o.d(t,{U:()=>a,t:()=>s});var n=()=>o(174114),i=()=>o(752903),r=()=>o(31448),l=()=>o(755786);const a={[i().NY.ExtremeSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function s(e){let{format:t,shouldShrink:o,shouldWrap:s,isSingle:c,style:u,clickTitleBehavior:p}=e;const g="edit"===p;return(0,n().IS)((()=>{const{fontSize:e,margin:n}=a[t],p=g?l().d0:a[t].height;return{style:{...s?{display:"inline",lineHeight:1.5,borderRadius:4}:d({height:p}),fontSize:e,fontWeight:r().Wy.medium,minWidth:o?0:"auto",margin:c?0:n,...t===i().NY.Inline&&{overflow:"hidden"},...u}}}),[t,o,s,c,g,u])}function d(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}},379481:(e,t,o)=>{o.d(t,{A:()=>i});o(725707),o(500234);class n extends(()=>o(151255))().A{findRow(e,t,o){return this.find((n=>n.relatedPageStoreId===e&&n.rowType===t&&n.property===o))}}const i=new n},388732:(e,t,o)=>{o.d(t,{l:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,n.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},399631:(e,t,o)=>{o.d(t,{Y:()=>l});var n=o(242343),i=()=>o(709237),r=o(163643);function l(e){const{blockStore:t,shouldWrap:o,titleStyle:l,recordTitleRef:a,noUnderline:s,disableTooltip:d}=e,c=(0,n.useRef)({getNode:()=>a.current});return(0,r.jsx)(i().A,{store:t,underline:!s,shouldWrap:o,style:l,ref:c,enableHover:!0,showTooltipWhenTruncated:!0,disableTooltip:d})}},689421:(e,t,o)=>{o.d(t,{Q:()=>i});o(242343);var n=o(163643);const i=(0,o(680369).wt)("settingsMembersFilled",{viewBox:"0 0 20 13",svg:(0,n.jsx)("path",{d:"M13.582 6.00293C15.0723 6.00293 16.3369 4.67676 16.3369 2.96094C16.3369 1.28613 15.0654 0.0078125 13.582 0.0078125C12.0986 0.0078125 10.8203 1.30664 10.8271 2.97461C10.8271 4.67676 12.0918 6.00293 13.582 6.00293ZM5.67969 6.16016C6.97852 6.16016 8.0791 4.99805 8.0791 3.50781C8.0791 2.04492 6.97168 0.9375 5.67969 0.9375C4.3877 0.9375 3.27344 2.06543 3.28027 3.52148C3.28027 4.99805 4.38086 6.16016 5.67969 6.16016ZM1.91309 12.3604H7.0332C6.30859 11.3145 7.1084 9.25 8.64648 8.04688C7.89453 7.55469 6.91016 7.19922 5.67969 7.19922C2.62402 7.19922 0.648438 9.44824 0.648438 11.3076C0.648438 11.9775 0.990234 12.3604 1.91309 12.3604ZM9.31641 12.3604H17.8408C18.9619 12.3604 19.3516 12.0186 19.3516 11.3965C19.3516 9.63281 17.123 7.21289 13.5752 7.21289C10.0342 7.21289 7.80566 9.63281 7.80566 11.3965C7.80566 12.0186 8.19531 12.3604 9.31641 12.3604Z"})})},692645:(e,t,o)=>{o.d(t,{RelationMenuRow:()=>Z,d:()=>ne});o(725707),o(491955),o(403517);var n=o(242343),i=()=>o(237385),r=()=>o(158247),l=()=>o(803290),a=()=>o(174114),s=()=>o(712437),d=()=>o(65866),c=()=>o(752903),u=()=>o(832388),p=()=>o(169201),g=()=>o(916809),S=()=>o(339189),f=()=>o(689421),h=()=>o(150936),y=()=>o(653998),b=()=>o(975392),k=()=>o(76394),m=()=>o(31448),x=()=>o(357608),v=()=>o(981927),w=()=>o(361837),I=()=>o(137490),T=()=>o(302376),M=()=>o(502852),R=()=>o(477784),C=()=>o(917717),B=()=>o(755786),j=()=>o(731991),A=()=>o(260682),P=()=>o(379481),L=()=>o(779921),E=()=>o(141122),O=()=>o(943540),W=()=>o(423719),z=()=>o(342943),U=()=>o(126451),N=()=>o(369515),H=()=>o(514799),V=()=>o(356813),K=()=>o(932322),D=()=>o(701513),Y=()=>o(103151),_=()=>o(82954),F=o(163643);const G=(0,y().YK)({dragRowHandleAriaLabel:{defaultMessage:"Drag to move a related page",id:"database.relationMenuRow.dragRowHandle.ariaLabel"},floatingInsertButtonAriaLabel:{defaultMessage:"Create a new related page",id:"database.relationMenuRow.floatingInsertButton.ariaLabel"},defaultIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Unlink page",id:"database.relationMenuRow.button.primary.default.isSelected.ariaLabel"},defaultIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Link page",id:"database.relationMenuRow.button.primary.default.isNotSelected.ariaLabel"},sprintIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Remove this sprint",id:"database.relationMenuRow.button.primary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Add this sprint",id:"database.relationMenuRow.button.primary.sprint.isNotSelected.ariaLabel"},defaultIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.default.isSelected.ariaLabel"},defaultIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Link another page",id:"database.relationMenuRow.button.secondary.default.isNotSelected.ariaLabel"},sprintIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Move to a different sprint",id:"database.relationMenuRow.button.secondary.sprint.isNotSelected.ariaLabel"}}),Q=48;function Z(e){const{collectionStore:t,collectionId:o,schema:a,propertySchema:c,targetCollectionStore:u,relatedPageStore:p,isSelected:g,disabled:S,locked:f,canDrag:h,pageStore:y,property:b,propertyLimit:k,limitReached:m,rowType:w,onActionButtonClick:M,onSecondaryButtonClick:R,onOpenPageButtonClick:C,onMouseEnter:B,onMouseLeave:O,blockPropertyValueOverlayStore:W,onInsertInline:z,onTitleEsc:U,index:N,focused:H,disableClickToNavigateToPage:V}=e,[K,D]=n.useState(!1),Y=(0,i().v3)(),_=(0,i().Y0)(),G=n.useRef(null),Q=n.useRef(null);(0,r().b)(P().A,(()=>({relatedPageStoreId:p.id,rowType:w,property:b,relationTokenBlockStoreRef:G,getNode:()=>Q.current})),[p,w,b]);const Z=(0,l().K8)((()=>{if(E().default.state.open)return E().default.state.mode;const e=null==W?void 0:W.state;if(null==e||!e.isOpen||null==e||!e.collectionContextStore)return E().default.state.mode;const t=e.collectionContextStore,o=null==t?void 0:t.collectionViewStore(),n=null==o?void 0:o.getType();return o&&n?o.getFormat().collection_peek_mode??I().C9[n]:E().default.state.mode}),[W]),ee=(0,l().K8)((()=>u.getDatabaseType()),[u]),te=(0,A().D)(c);if((0,j().W)(p))return null;if(_.isPhone&&"popup"===w)return te?(0,F.jsx)(re,{...e}):(0,F.jsx)(le,{...e});if(te){const e=(0,F.jsx)(q,{canDrag:h,rowType:w,focused:H,disabled:S,locked:f,relatedPageStore:p,pageStore:y,onInsertInline:z,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G});return(0,F.jsx)(oe,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,M,S,g),canDrag:h,rowType:w,focused:H,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>pe(e,Y,o,u,g,p,M,S,Z),outerRef:Q,onSecondaryButtonClick:R,onMouseEnter:B,onMouseLeave:O})}if(ee===d().av){const e=(0,F.jsx)(J,{canDrag:h,rowType:w,focused:H,disabled:S,locked:f,isSelected:g,onSecondaryButtonClick:R,onOpenPageButtonClick:C,onActionButtonClick:M,propertyLimit:k,relatedPageStore:p,pageStore:y,onInsertInline:z,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G,outerRef:Q,peekMode:Z});return(0,F.jsx)(oe,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,M,S,g),canDrag:h,rowType:w,focused:H,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>pe(e,Y,o,u,g,p,M,S,Z),outerRef:Q,onSecondaryButtonClick:R,onMouseEnter:B,onMouseLeave:O})}{const e=(0,F.jsx)($,{canDrag:h,rowType:w,focused:H,disabled:S,locked:f,propertyLimit:k,limitReached:m,isSelected:g,onSecondaryButtonClick:R,onOpenPageButtonClick:C,onActionButtonClick:M,relatedPageStore:p,pageStore:y,onInsertInline:z,onTitleEsc:U,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,schema:a,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G,outerRef:Q,peekMode:Z}),n=(0,F.jsx)(oe,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n,i,r,l,a,d,c,u,p){if(l||d){if(p)return;const r=T().Vr(e),l=o===n.id?E().default.state.resultsStore:void 0,d=o===n.id?E().default.state.collectionContextStore:void 0,g=E().default.isSidePeekOpen();if(v().VU({environment:t,store:i,peekMode:c,openInNew:r,resultsStore:l,collectionContextStore:d,pageVisitSource:s().y8.PeekOpen}),(0,x()._)(t,{from:"inline"===a||"section"===a?"property_value":"configure_relation_modal",meta_click:Boolean(r)}),"popup"===a&&!g){(u??L().A).setState({isOpen:!1})}}else r(e)}(e,Y,o,u,p,M,S,w,g,Z,W,V),canDrag:h,rowType:w,focused:H,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>pe(e,Y,o,u,g,p,M,S,Z),outerRef:Q,onMouseEnter:B,onMouseLeave:O});return(0,F.jsx)(X,{rowContainer:n,disabled:S,locked:f,canDrag:h,rowType:w,targetCollectionStore:u,propertyLimit:k,hasMouseEntered:K,outerRef:Q,handleMouseEnter:()=>D(!0),handleMouseLeave:()=>D(!1),onInsertInline:z})}}function $(e){const{canDrag:t,rowType:o,focused:n,disabled:r,locked:s,propertyLimit:d,limitReached:c,isSelected:p,onSecondaryButtonClick:g,onOpenPageButtonClick:f,onActionButtonClick:h,relatedPageStore:k,pageStore:m,onInsertInline:x,onTitleEsc:v,index:I,blockPropertyValueOverlayStore:T,collectionStore:M,targetCollectionStore:C,schema:j,property:A,relationTokenBlockStoreRef:P,outerRef:L,peekMode:E}=e,O=(0,i().Y0)(),W=(0,a().IS)((e=>({dragHandle:{marginLeft:2,height:20}})),[]),z=(0,l().K8)((()=>"section"===o&&!r&&k.canEdit()&&!O.isMobile),[o,r,k,O.isMobile]),U=O.isPhone?(0,F.jsx)(te,{relatedPageStore:k,rowType:o,pageStore:m,canEditTitle:z,shouldShowOverflow:!1,noUnderline:!1,relationTokenBlockStoreRef:P,onInsertInline:x,onTitleEsc:v,index:I}):(0,F.jsx)(ee,{collectionStore:M,property:A,relatedPageStore:k,targetCollectionStore:C,blockPropertyValueOverlayStore:T,rowType:o,pageStore:m,index:I,onInsertInline:x,onTitleEsc:v,canEditTitle:z,shouldShowOverflow:!1,noUnderline:!1,disabled:r,relationTokenBlockStoreRef:P}),H=(0,l().K8)((()=>B().s2(j,A)),[j,A]),V=(0,l().K8)((()=>{const e=null==T?void 0:T.state;if(e&&e.isOpen)return e.format}),[T]),K=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,propertyLimit:l,limitReached:a,onSecondaryButtonClick:s,onOpenPageButtonClick:d,onActionButtonClick:c,isSelected:p,isGithubRelationProperty:g,peekMode:f,onClick:h,format:k}=e,m=!t.isMobile&&n&&!i&&"section"===o&&!b().b0(d),x=(t.isMobile||n)&&!r&&!i&&!a&&(void 0===l||l>1),v=!t.isMobile&&!r&&n&&!i&&"inline"===o&&!b().b0(s),I=x?function(e){const{isSelected:t,isGithubRelationProperty:o,onActionButtonClick:n,format:i}=e,r=t?G.defaultIsSelectedPrimaryButtonAriaLabel:G.defaultIsNotSelectedPrimaryButtonAriaLabel;let l;const a=t?u().t:S().W;l=i&&(0,w().NN)(i)?void 0:t?o?(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.removePR.message",defaultMessage:"Unlink PR"}):(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.removePage.message",defaultMessage:"Unlink page"}):o?(0,F.jsx)(y().sA,{defaultMessage:"Link PR",id:"database.relationMenuRow.tooltip.addPR.message"}):(0,F.jsx)(y().sA,{defaultMessage:"Link page",id:"database.relationMenuRow.tooltip.addPage.message"});return(0,F.jsx)(ne,{ariaLabel:R().A.formatMessage(r),onClick:n,style:{borderRadius:3},icon:a,tooltipMessage:l})}({isSelected:p,isGithubRelationProperty:g,onActionButtonClick:c,format:k}):void 0,T=v?function(e){const{rowType:t,isSelected:o,isGithubRelationProperty:n,onClick:i}=e;let r;r="section"===t&&o?n?(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPRInline.message",defaultMessage:"Insert new PR"}):(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):n?(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPR.message",defaultMessage:"Link another PR"}):(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPage.message",defaultMessage:"Link another page"});const l="section"===t&&o?G.defaultIsSelectedSecondaryButtonAriaLabel:G.defaultIsNotSelectedSecondaryButtonAriaLabel;return(0,F.jsx)(ne,{ariaLabel:R().A.formatMessage(l),onClick:i,style:{borderRadius:0},icon:S().W,tooltipMessage:r})}({rowType:o,isSelected:p,isGithubRelationProperty:g,onClick:h}):void 0,M=m&&void 0!==d?(0,F.jsx)(ue,{peekMode:f,showPrimaryButton:void 0!==I,showSecondaryButton:void 0!==T,onOpenPageButtonClick:d}):void 0;return(0,F.jsx)(ce,{primaryButton:I,secondaryButton:T,openPageButton:M})}({device:O,rowType:o,focused:n,disabled:r,locked:s,propertyLimit:d,limitReached:c,isSelected:p,onSecondaryButtonClick:g,onOpenPageButtonClick:f,onActionButtonClick:h,isGithubRelationProperty:H,peekMode:E,onClick:()=>null==g?void 0:g(L.current),format:V});return(0,F.jsxs)(F.Fragment,{children:[t&&"popup"===o&&(0,F.jsx)(N().A,{iconSize:12,style:W.dragHandle}),U,K]})}function q(e){const{canDrag:t,rowType:o,disabled:n,relatedPageStore:r,pageStore:s,onInsertInline:d,onTitleEsc:c,index:u,blockPropertyValueOverlayStore:p,collectionStore:g,targetCollectionStore:S,property:h,relationTokenBlockStoreRef:y}=e,b=(0,i().Y0)(),k=(0,a().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0,paddingRight:4},membersIcon:{width:16,height:16,fill:e.mediumIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),m=(0,l().K8)((()=>"section"===o&&!n&&r.canEdit()&&!b.isMobile),[o,n,r,b.isMobile]),x=(0,F.jsxs)(F.Fragment,{children:[t&&"popup"===o&&(0,F.jsx)(N().A,{iconSize:12,style:k.dragHandle}),(0,F.jsx)(te,{relatedPageStore:r,rowType:o,pageStore:s,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:y,onInsertInline:d,onTitleEsc:c,index:u})]}),v=(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(ee,{collectionStore:g,property:h,relatedPageStore:r,targetCollectionStore:S,blockPropertyValueOverlayStore:p,rowType:o,pageStore:s,index:u,onInsertInline:d,onTitleEsc:c,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,disabled:n,relationTokenBlockStoreRef:y}),(0,F.jsx)("div",{style:k.iconWrapper,children:(0,f().Q)(k.membersIcon)})]}),w=(0,F.jsxs)(F.Fragment,{children:[t&&(0,F.jsx)(N().A,{iconSize:12,style:k.dragHandle}),v]}),I="popup"===o?w:v;return b.isPhone?x:I}function J(e){const{canDrag:t,rowType:o,focused:n,disabled:r,locked:s,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:p,onActionButtonClick:g,propertyLimit:f,relatedPageStore:k,pageStore:m,onInsertInline:x,onTitleEsc:v,index:w,blockPropertyValueOverlayStore:I,collectionStore:T,targetCollectionStore:M,property:C,relationTokenBlockStoreRef:B,outerRef:j,peekMode:A}=e,P=(0,i().Y0)(),L=(0,a().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",marginLeft:"auto",alignItems:"center",justifyContent:"center",padding:0,height:24},icon:{width:16,height:16,fill:e.regularIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),E=(0,l().K8)((()=>"section"===o&&!r&&k.canEdit()&&!P.isMobile),[o,r,k,P.isMobile]),O=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,onSecondaryButtonClick:l,onOpenPageButtonClick:a,onActionButtonClick:s,isSelected:d,propertyLimit:c,peekMode:p,onClick:g}=e,f=!t.isMobile&&n&&!i&&("section"===o||"inline"===o)&&!b().b0(a),h=(t.isMobile||n)&&!r&&!i,k="section"!==o?(t.isMobile||n)&&!r&&!i&&1!==c&&"popup"===o&&d:h,m=!t.isMobile&&!r&&n&&!i&&!f&&"section"!==o&&!b().b0(l),x=k?function(e){const{isSelected:t,onActionButtonClick:o}=e,n=t?G.sprintIsSelectedPrimaryButtonAriaLabel:G.sprintIsNotSelectedPrimaryButtonAriaLabel,i=t?(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.removePage.messageSprints",defaultMessage:"Remove this sprint"}):(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.addPage.messageSprints",defaultMessage:"Add this sprint"});return(0,F.jsx)(ne,{ariaLabel:R().A.formatMessage(n),onClick:o,style:{borderRadius:3},icon:t?u().t:S().W,tooltipMessage:i})}({isSelected:d,onActionButtonClick:s}):void 0,v=m?function(e){const{rowType:t,isSelected:o,onClick:n}=e,i="section"===t&&o?G.sprintIsSelectedSecondaryButtonAriaLabel:G.sprintIsNotSelectedSecondaryButtonAriaLabel,r="section"===t&&o?(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):(0,F.jsx)(y().sA,{id:"database.relationMenuRow.tooltip.insertPage.messageSprints",defaultMessage:"Move to a different sprint"});return(0,F.jsx)(ne,{ariaLabel:R().A.formatMessage(i),onClick:n,style:{borderRadius:0},icon:S().W,tooltipMessage:r})}({rowType:o,isSelected:d,onClick:g}):void 0,w=f&&void 0!==a?(0,F.jsx)(ue,{peekMode:p,showPrimaryButton:void 0!==x,showSecondaryButton:void 0!==v,onOpenPageButtonClick:a}):void 0;return(0,F.jsx)(ce,{primaryButton:x,secondaryButton:v,openPageButton:w})}({device:P,rowType:o,focused:n,disabled:r,locked:s,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:p,onActionButtonClick:g,propertyLimit:f,peekMode:A,onClick:()=>null==c?void 0:c(j.current)});return(0,F.jsxs)(F.Fragment,{children:[t&&"popup"===o&&(0,F.jsx)(N().A,{iconSize:12,style:L.dragHandle}),P.isPhone?(0,F.jsx)(te,{relatedPageStore:k,rowType:o,pageStore:m,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:B,onInsertInline:x,onTitleEsc:v,index:w}):(0,F.jsx)(ee,{collectionStore:T,property:C,relatedPageStore:k,targetCollectionStore:M,blockPropertyValueOverlayStore:I,rowType:o,pageStore:m,index:w,onInsertInline:x,onTitleEsc:v,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,disabled:r,relationTokenBlockStoreRef:B}),d&&"popup"===o&&(0,F.jsx)("div",{style:L.iconWrapper,children:(0,h().b)(L.icon)}),O]})}function X(e){const{rowContainer:t,disabled:o,locked:n,canDrag:r,rowType:s,targetCollectionStore:d,propertyLimit:c,hasMouseEntered:u,outerRef:p,handleMouseEnter:g,handleMouseLeave:f,onInsertInline:h}=e,b=(0,i().Y0)(),k=(0,a().IS)((e=>({menuItem:{display:"flex",alignItems:"center",width:`calc(100% + ${Q}px)`,paddingLeft:Q,position:"relative",left:-Q},tooltip:{color:e.text.contrastSecondary},icon:{width:16,height:16,fill:e.lightIconColor},iconHover:{borderRadius:4},iconButton:{marginLeft:r?-44:-22,position:"absolute",marginRight:4}})),[r]),m=(0,l().K8)((()=>d.canEdit()),[d]),x=!n&&!o&&"section"===s&&!b.isMobile&&!(1===c)&&m;return(0,F.jsxs)("div",{style:k.menuItem,onMouseEnter:g,onMouseLeave:f,ref:p,children:[u&&x&&(0,F.jsx)(Y().A,{renderTooltip:()=>(0,F.jsx)(y().sA,{defaultMessage:"Click <medium>to insert a page below</medium>",id:"database.relationMenuRow.tooltip.floatingAddPageButton.message",values:{medium:e=>(0,F.jsx)("span",{style:k.tooltip,children:e})}}),render:e=>(0,F.jsx)(V().A,{hasBackground:!1,ariaLabel:R().A.formatMessage(G.floatingInsertButtonAriaLabel),icon:S().W,iconStyle:k.icon,onClick:h,hoveredStyle:k.iconHover,style:k.iconButton,...e})}),t]})}function ee(e){const{relatedPageStore:t,targetCollectionStore:o,blockPropertyValueOverlayStore:r,rowType:s,pageStore:d,index:c,onInsertInline:u,onTitleEsc:p,canEditTitle:g,shouldShowOverflow:S,noUnderline:f,collectionStore:h,property:y,disabled:k,relationTokenBlockStoreRef:x}=e,v=(0,i().Y0)(),w=(0,l().K8)((()=>t.isReady()&&!t.canRead()),[t]),I=(0,l().K8)((()=>{const e=o.getSchema();return e?!h||w?[{property:"title",visible:!0}]:B().B7({collectionStore:h,property:y}).filter((t=>t.visible&&("title"===t.property||e[t.property]))):[]}),[o,h,w,y]),T=(0,l().K8)((()=>"section"!==s||(k||!t.canEdit()||v.isMobile)),[s,k,t,v.isMobile]),M=(0,a().IS)((e=>({wrapper:{display:"flex",marginRight:8,maxHeight:22,alignItems:"center",...m().RC}})),[]);if(b().Im(I))return null;const R=I.map((e=>"title"===e.property?(0,F.jsx)(n.Fragment,{children:(0,F.jsx)(te,{relatedPageStore:t,rowType:s,pageStore:d,canEditTitle:g,shouldShowOverflow:S,noUnderline:f,relationTokenBlockStoreRef:x,onInsertInline:u,onTitleEsc:p,index:c})},"title"):(0,F.jsx)(O().qm,{store:t,property:e.property,disabled:T,locked:!1,format:"section"===s?"relation_section":"relation",tableWrap:!1,blockPropertyValueOverlayStore:r??L().A,collectionStore:o},e.property)));return(0,F.jsx)("div",{style:M.wrapper,children:R})}function te(e){const{relatedPageStore:t,rowType:o,pageStore:n,canEditTitle:r,shouldShowOverflow:l,noUnderline:s,relationTokenBlockStoreRef:d,onInsertInline:u,onTitleEsc:p,index:g}=e,S=(0,i().Y0)(),f=(0,a().IS)((e=>({wrapper:{display:"flex",alignItems:"center",flex:"0 1 auto",minHeight:0,...!l&&{minWidth:40},paddingLeft:"section"===o?4:6},relationToken:{display:"flex",alignItems:"center",margin:0,whiteSpace:"nowrap",marginRight:"section"===o?0:S.isTablet?8:0,minWidth:0},title:{...m().RC,maxWidth:"100%"}})),[o,l,S.isTablet]);return(0,F.jsx)("div",{style:f.wrapper,children:(0,F.jsx)(_().A,{ref:d,format:c().NY.Inline,blockId:t.id,isSingle:!0,parentStore:n,noUnderline:s,style:f.relationToken,titleStyle:f.title,clickTitleBehavior:r?"edit":void 0,onTitleEnter:u,onTitleEsc:p,index:g},t.id)})}function oe(e){const{innerRelationMenuRow:t,handleButtonClick:o,canDrag:n,rowType:r,focused:l,disabled:s,limitReached:d,propertyLimit:c,hasMouseEntered:u,sectionOnClick:p,outerRef:S,onSecondaryButtonClick:f,onMouseEnter:h,onMouseLeave:b}=e,k=(0,i().v3)(),m=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",width:"100%"},tooltip:{color:e.text.contrastSecondary},icon:{width:14,height:14,fill:e.lightIconColor},iconHover:{borderRadius:4},iconButton:{cursor:"grab",width:H().Z+4,marginLeft:-(H().Z+4),height:24,borderRadius:4},row:ae(r,e,l,d,c)})),[r,l,d,c]);return(0,F.jsxs)("div",{style:m.container,ref:S,children:["section"===r&&u&&n&&(0,F.jsx)(Y().A,{renderTooltip:()=>(0,F.jsx)(y().sA,{defaultMessage:"Drag <medium>to move</medium>",id:"database.relationMenuRow..dragPrompt.text",values:{medium:e=>(0,F.jsx)("span",{style:m.tooltip,children:e})}}),render:e=>(0,F.jsx)(V().A,{hasBackground:!1,ariaLabel:R().A.formatMessage(G.dragRowHandleAriaLabel),icon:g().i,iconStyle:m.icon,hoveredStyle:m.iconHover,style:m.iconButton,...e})}),"section"===r?(0,F.jsx)("div",{style:m.row,onContextMenu:e=>se(e,k),onMouseEnter:h,onMouseLeave:b,onClick:p,role:"button","aria-label":"Editable title","aria-disabled":s,tabIndex:s?-1:0,children:t}):(0,F.jsx)(Y().A,{disableTooltip:!(d&&c&&c>1),renderTooltip:()=>(0,F.jsx)(y().sA,{defaultMessage:"To select more, remove selection above",id:"database.relationMenuRow.limitReached"}),render:e=>(0,F.jsx)("div",{style:m.row,onContextMenu:e=>se(e,k),onMouseEnter:h,onMouseLeave:b,role:"button",tabIndex:s?-1:0,"aria-disabled":s,onClick:e=>{(0,M().SQ)({event:e,context:M().y$.EditorClick,callback:()=>{(0,C().Vt)(e)||(f?f(S.current):o(e))}})},...e,children:t})})]})}function ne(e){const{caption:t,onClick:o,style:n,icon:i,tooltipMessage:r,ariaLabel:l}=e;return(0,F.jsx)(Y().A,{renderTooltip:()=>r,disableTooltip:(0,k().uy)(r),render:e=>(0,F.jsx)(V().A,{hasBackground:!1,ariaLabel:l,icon:i,onClick:o,caption:t,hoveredStyle:{borderRadius:4},style:{height:20,width:20,flex:"0 0 auto",...n},...e})})}function ie(e){let{onActionButtonClick:t}=e;return(0,F.jsx)(U().A,{mobileFeedback:!0,onClick:t,style:{padding:12,marginRight:-12},children:(0,p().u)({width:20,height:20})})}function re(e){const{rowType:t,relatedPageStore:o,pageStore:i,onInsertInline:r,onTitleEsc:l,index:s,disabled:d,isSelected:c,...u}=e,p=n.useRef(null),g=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center"},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0},titleWrapper:{flex:1,overflow:"hidden",paddingRight:16},membersIcon:{width:16,height:16,fill:e.mediumIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),S=!d&&c,h=!d&&!c;return(0,F.jsx)(K().Ay,{...u,title:(0,F.jsxs)("div",{style:g.container,children:[(0,F.jsx)("div",{style:g.titleWrapper,children:(0,F.jsx)(te,{relatedPageStore:o,rowType:t,pageStore:i,canEditTitle:!1,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:p,onInsertInline:r,onTitleEsc:l,index:s})}),S&&(0,F.jsx)(ie,{onActionButtonClick:t=>{e.onActionButtonClick(t),t.stopPropagation()}}),h&&(0,F.jsx)("div",{style:g.iconWrapper,children:(0,f().Q)(g.membersIcon)})]})})}function le(e){const t=!e.disabled&&e.isSelected;return(0,F.jsx)(D().A,{...e,store:e.relatedPageStore,hidePath:!0,right:t?(0,F.jsx)(ie,{onActionButtonClick:e.onActionButtonClick}):void 0})}function ae(e,t,o,n,i){const r=n&&i&&i>1;return{...m().RC,display:"flex",alignItems:"center",position:"relative",borderRadius:4,width:"100%",height:B().d0,paddingTop:2,paddingRight:4,paddingBottom:2,paddingLeft:"popup"!==e?2:0,fontSize:z().Mi,margin:"popup"===e?"0px 4px":0,cursor:r?"default":"pointer",background:o&&!r?t.buttonHoveredBackground:void 0,userSelect:"none",opacity:r?.4:1}}function se(e,t){const{device:o}=t;o.isAndroid&&o.isPhone&&e.preventDefault()}const de={position:"absolute",top:4,display:"inline-flex",flexShrink:0,borderRadius:4,overflow:"hidden",padding:2,gap:1};function ce(e){const{primaryButton:t,secondaryButton:o,openPageButton:n}=e,i=(0,a().IS)((e=>({relationButtonWrapperStyle:{right:6,background:e.popoverBackground,boxShadow:e.shadowSM,...de}})),[]);return(0,F.jsxs)(F.Fragment,{children:[(t||o)&&(0,F.jsxs)("div",{style:i.relationButtonWrapperStyle,children:[t,o]}),n]})}function ue(e){const t=(0,a().IS)((t=>({relationButtonWrapperStyle:{position:"absolute",right:e.showPrimaryButton||e.showSecondaryButton?36:6,background:t.popoverBackground,boxShadow:t.shadowSM,...de}})),[e.showPrimaryButton,e.showSecondaryButton]);return(0,F.jsx)("div",{style:t.relationButtonWrapperStyle,children:(0,F.jsx)(W().A,{...e})})}function pe(e,t,o,n,i,r,l,a,d){(0,M().SQ)({event:e,context:M().y$.EditorClick,callback:()=>{if(!(0,C().Vt)(e))if(i||a){if(!r.canRead())return;const i=T().Vr(e),l=o===n.id?E().default.state.resultsStore:void 0,a=o===n.id?E().default.state.collectionContextStore:void 0;v().VU({environment:t,store:r,peekMode:d,openInNew:i,resultsStore:l,collectionContextStore:a,pageVisitSource:s().y8.PeekOpen}),(0,x()._)(t,{from:"relation_section",meta_click:Boolean(i)})}else l(e)}})}},957881:(e,t,o)=>{o.d(t,{w:()=>g});var n=o(242343),i=()=>o(237385),r=()=>o(803290),l=()=>o(174114),a=()=>o(791976),s=()=>o(759625),d=()=>o(84543),c=()=>o(28210),u=()=>o(219322),p=o(163643);function g(e){const{clickTitleBehavior:t,blockStore:o,format:a,shouldWrap:g}=e,f="edit"===t,h=(0,i().v3)(),[y,b,k]=(0,r().K8)((()=>[o.getIcon(),o.isEmptyPage(),o.isReady()&&"none"===o.getRole()]),[o]),{style:m}=(0,l().IS)((()=>({style:{flexShrink:0,marginRight:f?0:u().U[a].recordIconMarginRight,justifyContent:"flex-start",...g&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[f,a,g]),x=(0,n.useCallback)((e=>{const t=o.getIconStore();t&&d().createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:h,canUndo:!0,perform:o=>{s().KY({store:t,value:e,transaction:o})}})}),[o,h]),v={icon:y,size:u().U[a].pageIconSize,isEmptyPage:b,style:m};return k?(0,p.jsx)(S,{...v}):f?(0,p.jsx)(c().B,{...v,disabled:!1,onChange:x,bucket:"public"}):(0,p.jsx)(c().B,{...v,disabled:!0})}function S(e){const t=(0,l().DP)();return(0,a().T)({...e.style,width:e.size,height:e.size,fill:t.icon.secondary,verticalAlign:"top",marginTop:1})}}}]);