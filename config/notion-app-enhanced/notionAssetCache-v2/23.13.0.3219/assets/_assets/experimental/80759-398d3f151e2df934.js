"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80759],{86607:(e,t,a)=>{a.d(t,{SE:()=>f,Y9:()=>A,cx:()=>M,fp:()=>h,jA:()=>y,o_:()=>v,rv:()=>w,zI:()=>b,zY:()=>p});var o=()=>a(83544),r=()=>a(120082),n=()=>a(871002),s=()=>a(846581),i=()=>a(361308),d=()=>a(653998),u=()=>a(975392),g=()=>a(76394),c=()=>a(477784);const l=(0,d().YK)({show_unique:{defaultMessage:"Show unique values",id:"database.aggregationFullName.unique_values"},count:{defaultMessage:"Count all",id:"database.aggregationFullName.count"},count_values:{defaultMessage:"Count values",id:"database.aggregationFullName.count_values"},unique:{defaultMessage:"Count unique values",id:"database.aggregationFullName.unique"},empty:{defaultMessage:"Count empty",id:"database.aggregationFullName.empty"},not_empty:{defaultMessage:"Count not empty",id:"database.aggregationFullName.not_empty"},percent_empty:{defaultMessage:"Percent empty",id:"database.aggregationFullName.percent_empty"},percent_not_empty:{defaultMessage:"Percent not empty",id:"database.aggregationFullName.percent_not_empty"},sum:{defaultMessage:"Sum",id:"database.aggregationFullName.sum"},average:{defaultMessage:"Average",id:"database.aggregationFullName.average"},median:{defaultMessage:"Median",id:"database.aggregationFullName.median"},min:{defaultMessage:"Min",id:"database.aggregationFullName.min"},max:{defaultMessage:"Max",id:"database.aggregationFullName.max"},range:{defaultMessage:"Range",id:"database.aggregationFullName.range"},earliest_date:{defaultMessage:"Earliest date",id:"database.aggregationFullName.earliest_date"},latest_date:{defaultMessage:"Latest date",id:"database.aggregationFullName.latest_date"},date_range:{defaultMessage:"Date range",id:"database.aggregationFullName.date_range"},checked:{defaultMessage:"Checked",id:"database.aggregationFullName.checked"},unchecked:{defaultMessage:"Unchecked",id:"database.aggregationFullName.unchecked"},percent_checked:{defaultMessage:"Percent checked",id:"database.aggregationFullName.percent_checked"},percent_unchecked:{defaultMessage:"Percent unchecked",id:"database.aggregationFullName.percent_unchecked"},count_per_group:{defaultMessage:"Count per group",id:"database.aggregationFullName.count_per_group"},percent_per_group:{defaultMessage:"Percent per group",id:"database.aggregationFullName.percent_per_group"},count_aggregations:{defaultMessage:"Count",id:"database.aggregationBucket.count"},percent_aggregations:{defaultMessage:"Percent",id:"database.aggregationBucket.percent"},statistics_aggregations:{defaultMessage:"More options",id:"database.aggregationBucket.more_options"},date_aggregations:{defaultMessage:"Date",id:"database.aggregationBucket.dateGroupingLabel"}}),p={count:c().A.formatMessage(l.count),count_values:c().A.formatMessage(l.count_values),unique:c().A.formatMessage(l.unique),show_unique:c().A.formatMessage(l.show_unique),empty:c().A.formatMessage(l.empty),not_empty:c().A.formatMessage(l.not_empty),percent_empty:c().A.formatMessage(l.percent_empty),percent_not_empty:c().A.formatMessage(l.percent_not_empty),sum:c().A.formatMessage(l.sum),average:c().A.formatMessage(l.average),median:c().A.formatMessage(l.median),min:c().A.formatMessage(l.min),max:c().A.formatMessage(l.max),range:c().A.formatMessage(l.range),earliest_date:c().A.formatMessage(l.earliest_date),latest_date:c().A.formatMessage(l.latest_date),date_range:c().A.formatMessage(l.date_range),checked:c().A.formatMessage(l.checked),unchecked:c().A.formatMessage(l.unchecked),percent_checked:c().A.formatMessage(l.percent_checked),percent_unchecked:c().A.formatMessage(l.percent_unchecked),count_per_group:c().A.formatMessage(l.count_per_group),percent_per_group:c().A.formatMessage(l.percent_per_group)},m=(0,d().YK)({count:{defaultMessage:"Count",id:"database.aggregationShortName.count"},count_values:{defaultMessage:"Values",id:"database.aggregationShortName.count_values"},unique:{defaultMessage:"Unique",id:"database.aggregationShortName.unique"},show_unique:{defaultMessage:"Show unique",id:"database.aggregationShortName.showUnique"},empty:{defaultMessage:"Empty",id:"database.aggregationShortName.empty"},not_empty:{defaultMessage:"Not Empty",id:"database.aggregationShortName.not_empty"},percent_empty:{defaultMessage:"Empty",id:"database.aggregationShortName.percent_empty"},percent_not_empty:{defaultMessage:"Not Empty",id:"database.aggregationShortName.percent_not_empty"},sum:{defaultMessage:"Sum",id:"database.aggregationShortName.sum"},average:{defaultMessage:"Average",id:"database.aggregationShortName.average"},median:{defaultMessage:"Median",id:"database.aggregationShortName.median"},min:{defaultMessage:"Min",id:"database.aggregationShortName.min"},max:{defaultMessage:"Max",id:"database.aggregationShortName.max"},range:{defaultMessage:"Range",id:"database.aggregationShortName.range"},earliest_date:{defaultMessage:"Earliest",id:"database.aggregationShortName.earliest_date"},latest_date:{defaultMessage:"Latest",id:"database.aggregationShortName.latest_date"},date_range:{defaultMessage:"Range",id:"database.aggregationShortName.date_range"},checked:{defaultMessage:"Checked",id:"database.aggregationShortName.checked"},unchecked:{defaultMessage:"Unchecked",id:"database.aggregationShortName.unchecked"},percent_checked:{defaultMessage:"Checked",id:"database.aggregationShortName.percent_checked"},percent_unchecked:{defaultMessage:"Unchecked",id:"database.aggregationShortName.percent_unchecked"},count_per_group:{defaultMessage:"Count",id:"database.aggregationShortName.count_per_group"},percent_per_group:{defaultMessage:"Percent",id:"database.aggregationShortName.percent_per_group"}}),f={count:c().A.formatMessage(m.count),count_values:c().A.formatMessage(m.count_values),unique:c().A.formatMessage(m.unique),show_unique:c().A.formatMessage(m.show_unique),empty:c().A.formatMessage(m.empty),not_empty:c().A.formatMessage(m.not_empty),percent_empty:c().A.formatMessage(m.percent_empty),percent_not_empty:c().A.formatMessage(m.percent_not_empty),sum:c().A.formatMessage(m.sum),average:c().A.formatMessage(m.average),median:c().A.formatMessage(m.median),min:c().A.formatMessage(m.min),max:c().A.formatMessage(m.max),range:c().A.formatMessage(m.range),earliest_date:c().A.formatMessage(m.earliest_date),latest_date:c().A.formatMessage(m.latest_date),date_range:c().A.formatMessage(m.date_range),checked:c().A.formatMessage(m.checked),unchecked:c().A.formatMessage(m.unchecked),percent_checked:c().A.formatMessage(m.percent_checked),percent_unchecked:c().A.formatMessage(m.percent_unchecked),count_per_group:c().A.formatMessage(m.count_per_group),percent_per_group:c().A.formatMessage(m.percent_per_group)},_=(0,d().YK)({count:{defaultMessage:"Counts the total number of pages, including blank pages.",id:"database.aggregationDescription.count"},count_values:{defaultMessage:"Counts the number of non-empty values for this property. For a type that can contain multiple values like multi-select or person, this will count the number of selected values for each page.",id:"database.aggregationDescription.count_values"},unique:{defaultMessage:"Counts the number of unique values for this property. For a type that can contain multiple values like multi-select or person, this will count the unique values across all pages.",id:"database.aggregationDescription.unique"},show_unique:{defaultMessage:"Shows the unique values for this property. For a type that can contain multiple values like multi-select or person, this will count the unique values across all pages.",id:"database.aggregationDescription.show_unique"},empty:{defaultMessage:"Counts the number of pages with an empty value for this property.",id:"database.aggregationDescription.empty"},not_empty:{defaultMessage:"Counts the number of pages with a non-empty value for this property.",id:"database.aggregationDescription.not_empty"},percent_empty:{defaultMessage:"Displays the percentage of pages that have an empty value for this property.",id:"database.aggregationDescription.percent_empty"},percent_not_empty:{defaultMessage:"Displays the percentage of pages that have a non-empty value for this property.",id:"database.aggregationDescription.percent_not_empty"},sum:{defaultMessage:"Computes the sum of a numeric property.",id:"database.aggregationDescription.sum"},average:{defaultMessage:"Computes the average of a numeric property.",id:"database.aggregationDescription.average"},median:{defaultMessage:"Finds the median of a numeric property.",id:"database.aggregationDescription.median"},min:{defaultMessage:"Finds the minimum of a numeric property.",id:"database.aggregationDescription.min"},max:{defaultMessage:"Finds the maximum of a numeric property.",id:"database.aggregationDescription.max"},range:{defaultMessage:"Computes the range (maximum - minimum) of a numeric property.",id:"database.aggregationDescription.range"},earliest_date:{defaultMessage:"Finds the earliest date in time of a date property.",id:"database.aggregationDescription.earliest_date"},latest_date:{defaultMessage:"Finds the latest date in time of a date property.",id:"database.aggregationDescription.latest_date"},date_range:{defaultMessage:"Computes the date range (latest date - earliest date) of a date property.",id:"database.aggregationDescription.date_range"},checked:{defaultMessage:"Counts the number of pages with a checked checkbox for this property.",id:"database.aggregationDescription.checked"},unchecked:{defaultMessage:"Counts the number of pages with an unchecked checkbox for this property.",id:"database.aggregationDescription.unchecked"},percent_checked:{defaultMessage:"Displays the percentage of pages that have a checked checkbox for this property.",id:"database.aggregationDescription.percent_checked"},percent_unchecked:{defaultMessage:"Displays the percentage of pages that have an unchecked checkbox for this property.",id:"database.aggregationDescription.percent_unchecked"},count_per_group:{defaultMessage:"Counts the total number of pages that have this Status Group.",id:"database.aggregationDescription.count_per_group"},percent_per_group:{defaultMessage:"Displays the percentage of pages that have this Status Group",id:"database.aggregationDescription.percent_per_group"}}),h={count:c().A.formatMessage(_.count),count_values:c().A.formatMessage(_.count_values),unique:c().A.formatMessage(_.unique),show_unique:c().A.formatMessage(_.show_unique),empty:c().A.formatMessage(_.empty),not_empty:c().A.formatMessage(_.not_empty),percent_empty:c().A.formatMessage(_.percent_empty),percent_not_empty:c().A.formatMessage(_.percent_not_empty),sum:c().A.formatMessage(_.sum),average:c().A.formatMessage(_.average),median:c().A.formatMessage(_.median),min:c().A.formatMessage(_.min),max:c().A.formatMessage(_.max),range:c().A.formatMessage(_.range),earliest_date:c().A.formatMessage(_.earliest_date),latest_date:c().A.formatMessage(_.latest_date),date_range:c().A.formatMessage(_.date_range),checked:c().A.formatMessage(_.checked),unchecked:c().A.formatMessage(_.unchecked),percent_checked:c().A.formatMessage(_.percent_checked),percent_unchecked:c().A.formatMessage(_.percent_unchecked),count_per_group:c().A.formatMessage(_.count_per_group),percent_per_group:c().A.formatMessage(_.percent_per_group)},y={count_aggregations:c().A.formatMessage(l.count_aggregations),percent_aggregations:c().A.formatMessage(l.percent_aggregations),statistics_aggregations:c().A.formatMessage(l.statistics_aggregations),date_aggregations:c().A.formatMessage(l.date_aggregations)},M={count:o().A.images.aggregations.countPng,count_values:o().A.images.aggregations.countValuesPng,unique:o().A.images.aggregations.uniquePng,show_unique:void 0,empty:o().A.images.aggregations.emptyPng,not_empty:o().A.images.aggregations.notEmptyPng,percent_empty:o().A.images.aggregations.percentEmptyPng,percent_not_empty:o().A.images.aggregations.percentNotEmptyPng,sum:o().A.images.aggregations.sumPng,average:o().A.images.aggregations.averagePng,median:o().A.images.aggregations.medianPng,min:o().A.images.aggregations.minPng,max:o().A.images.aggregations.maxPng,range:o().A.images.aggregations.rangePng,earliest_date:o().A.images.aggregations.earliestDatePng,latest_date:o().A.images.aggregations.latestDatePng,date_range:o().A.images.aggregations.dateRangePng,checked:o().A.images.aggregations.checkedPng,unchecked:o().A.images.aggregations.uncheckedPng,percent_checked:o().A.images.aggregations.percentCheckedPng,percent_unchecked:o().A.images.aggregations.percentUncheckedPng,count_per_group:o().A.images.aggregations.countPng,percent_per_group:o().A.images.aggregations.percentCheckedPng};function v(e,t){switch(e){case"earliest_date":case"show_unique":case"latest_date":case"date_range":return;case"percent_empty":case"percent_not_empty":case"percent_checked":case"percent_unchecked":return"percent";case"count":case"empty":case"not_empty":case"unique":case"count_values":case"checked":case"unchecked":return"number";case"sum":case"average":case"median":case"min":case"max":case"range":return t??"number";default:switch(e.operator){case"count_per_group":return;case"percent_per_group":return"percent";default:(0,g().HB)(e.operator)}}}function b(e,t){switch(e){case"earliest_date":case"show_unique":case"latest_date":case"date_range":case"count":case"empty":case"not_empty":case"unique":case"count_values":case"checked":case"unchecked":return;case"percent_empty":case"percent_not_empty":case"percent_checked":case"percent_unchecked":case"average":return t??"precision_2";case"sum":case"median":case"min":case"max":case"range":return t??void 0;default:switch(e.operator){case"count_per_group":return;case"percent_per_group":return t??"precision_2";default:(0,g().HB)(e.operator)}}}function A(e){const{aggregationType:t,value:a,userTimeZone:o,dateFormat:d,numberPrecision:g}=e;if("date"===a.type){if(!(0,r().Y)(t))return;if(!a.value)return;return"date_range"===t?(0,s().a3)(a.value,o,c().A.getIntl()):(0,s().ZF)({value:n().pp(a.value),date_format:d??n().vz,userTimeZone:o,allowRelativeDates:!0,intl:c().A.getIntl()})}if((0,r().Y)(t))return;if("show_unique"===t)return;if("object"==typeof a.value)return;if("string"==typeof a.value)return a.value;let l;l=void 0===g||"precision_uncapped"===g?void 0===a.value?void 0:u().LI(a.value,5):a.value;const p=v(t,e.numberFormat);return(0,i().ZV)(l,p,c().A.getIntl(),void 0,g)}function w(e){const{aggregation:t,value:a,numberFormat:o,dateFormat:n,numberPrecision:s}=e,i=A({numberFormat:o,dateFormat:n,aggregationType:t?t.aggregator:"count",userTimeZone:e.userTimeZone,value:a,numberPrecision:s});if(null!=t&&t.enforceMaxAggregationLimit){const e=Number(i);if(e&&e>=r().iY)return r().iY-1+"+"}return i}},113805:(e,t,a)=>{a.d(t,{E:()=>h,UQ:()=>y});a(610931),a(358848),a(362833),a(91270);var o=()=>a(543396),r=()=>a(769884),n=()=>a(33715),s=()=>a(314058),i=()=>a(220865),d=()=>a(846287),u=()=>a(611758),g=()=>a(444701),c=()=>a(946854),l=()=>a(975392),p=()=>a(76394),m=()=>a(84543),f=()=>a(760813),_=()=>a(272690);function h(e){const{moduleId:t,layoutStore:a,sessionId:r,environment:s,position:i}=e,d=a.getModuleById(t);if(!d)throw new Error(`Cannot move module with id ${t} because a module with that id is not in the layout`);const u=(0,_().TR)({modulesByArea:a.getModules(),moduleId:t,newPosition:i});M({...e,module:d,userAction:"BuilderLayoutModules.moveModuleToPosition",afterUpsertTransaction:()=>{var e;const t=(0,o().Cg)({moduleId:d.id,modulesByArea:a.getModules()}).length;(0,_().Ib)({environment:s,sessionId:r,collectionId:null===(e=a.getCollectionModel())||void 0===e?void 0:e.id,layoutId:a.id,context:(0,n().We)(i.area),action:u,moduleType:d.type,area:i.area,depth:t})}})}function y(e){const{position:t,module:a,layoutStore:r,sessionId:s,environment:i}=e;if(r.getModuleById(a.id))throw new Error(`Cannot add module with id ${a.id} because a module with that id is already in the layout`);M({...e,userAction:"BuilderLayoutModules.addModuleAtPosition",performBeforeApplyUpsertOperations:e=>{const{transaction:o}=e;"page_main"!==t.area&&"page_details"!==t.area||(0,c().gx)(a)&&(0,f().HD)({environment:i,transaction:o,layoutStore:r,property:a.propertyId})},afterUpsertTransaction:()=>{var d;const u=(0,o().Cg)({moduleId:a.id,modulesByArea:r.getModules()}).length;(0,_().zb)({environment:i,module:a,sessionId:s,collectionId:null===(d=r.getCollectionModel())||void 0===d?void 0:d.id,layoutId:r.id,context:(0,n().We)(t.area),isPropertyCreation:e.isPropertyCreation,area:t.area,depth:u})}})}function M(e){const{environment:t,position:a,layoutStore:o,module:g,transaction:c,userAction:l,performBeforeApplyUpsertOperations:f,afterUpsertTransaction:_}=e,h=o.pointer,y=o.getModules(),M=o.getRawModules(),w=M&&(0,d().c7)(M,(e=>e.id===g.id))||(0,i().Lv)(g),k="page_main"===a.area||"page_details"===a.area?function(e){const{layoutPointer:t,modulesByArea:a,rawModulesByArea:o}=e,s=(0,d().EX)(a,(e=>"relationsGroup"===e.type));if("form_conditional_modules"===(null==s?void 0:s.position.area))return;const u=o&&(0,d().LC)(o,(e=>"relationsGroup"===e.type));if(!s)return;if(s&&u)return;const g=s.module;if(!g||"relationsGroup"!==g.type)throw new Error("relations group module location in normalized was incorrect, cannot backfill relations group module");return function(e){var t;const{module:a,modulesByArea:o,layoutPointer:s}=e,u=(0,d().JO)(o,(e=>e.id===a.id));if(!u)throw new Error("cannot upsert module at current position because module does not have a current position");if("form_conditional_modules"===u.area)throw new Error("[Forms Conditional Logic Not Implemented] form_conditional_modules area is not supported for adding and moving modules");const g="views_main_tab_modules"===u.area?null===(t=o.views_main_tab_modules)||void 0===t?void 0:t[u.viewId]:o[u.area];if(!g||0===g.length)throw new Error("cannot upsert module at current position in area because that area is empty");const c={module:(0,i().Lv)(a),pointer:s,..."views_main_tab_modules"===u.area?{area:n().Zm[u.area],viewId:u.viewId}:{area:n().Zm[u.area]}};if(0===u.index)return r().N4X.putModuleAfter({...c,afterId:void 0});const l=g.at(u.index+1);if(!l)return r().N4X.putModuleAfter({...c,afterId:void 0});return r().N4X.putModuleBefore({...c,beforeId:l.id})}({module:g,layoutPointer:t,modulesByArea:a})}({layoutPointer:h,modulesByArea:y,rawModulesByArea:M}):null;k&&m().createAndCommitOrAppend({environment:t,perform:e=>{m().applyOperation({transaction:e,store:o,operation:k})},canUndo:!0,transaction:c,userAction:`${l||"BuilderLayoutModules.upsert"}.preOpBackfill`});const I=[],O=function(e){const{layoutStore:t,module:a,upsertPosition:o}=e,s=t.getModules(),i=(0,d().JO)(s,(e=>a.id===e.id));if(!i)return;if("form_conditional_modules"===i.area)return r().N4X.deleteModuleInArea({pointer:t.pointer,area:i.area,moduleId:a.id});if("views_main_tab_modules"===i.area){const e="absolute"===o.type&&"views_main_tab_modules"===o.area?o.viewId:void 0,n=i.viewId;if(e===n)return;return r().N4X.deleteModuleInArea({pointer:t.pointer,area:i.area,moduleId:a.id,viewId:n})}if("page_main"===i.area||"page_details"===i.area||"form_layout_schema"===i.area||"person_profile_page_main"===i.area||"person_profile_page_details"===i.area){if(i.area===o.area)return;return r().N4X.deleteModuleInArea({pointer:t.pointer,area:n().Zm[i.area],moduleId:a.id})}(0,p().HB)(i.area)}({upsertPosition:a,module:g,layoutStore:o});O&&I.push(O);const N=function(e){const{upsertPosition:t,layoutPointer:a,modulesByArea:o,rawModuleToUpsert:i}=e;if("absolute"===t.type)return function(e){const{upsertPosition:t,rawModuleToUpsert:a,layoutPointer:o,modulesByArea:i}=e,g=(0,d().JO)(i,(e=>a.id===e.id)),{area:c}=t;if("form_conditional_modules"===c){const{parentConditionalGroupId:e,parentModuleId:n}=t;if(!(0,u().V)(a,"form_conditional_modules"))throw new Error("Can only add form question or placeholder modules to form_conditional_modules area.");const g=(0,d().Ib)({modulesByArea:i,find:e=>e.id===a.parentModuleId}),c=(0,s().A)(n,i);return r().N4X.upsertChildModule({pointer:o,module:a,previousParentModuleAndArea:g,newParentModule:{area:c.area,module:c.module,conditionalGroupId:e,index:t.index},modulesByArea:i})}const l=t.index;if(l<0)throw new Error(`Cannot upsert module with id ${a.id} to a negative position`);if("views_main_tab_modules"===c){const e=t.viewId;if(!i[c]||!i[c][e])throw new Error("Cannot upsert module into views_main_tab_modules area that does not have views");const s="views_main_tab_modules"===(null==g?void 0:g.area)&&(null==g?void 0:g.viewId)===e?g.index:void 0,d=v({modulesInArea:i[c][e],indexOfModuleToUpsertInArea:s,indexToUpsertTo:l});if(!d)return;return[r().N4X.putModuleBeforeOrAfter({pointer:o,area:n().Zm[c],viewId:e,module:a,direction:d.insertDirection,beforeOrAfterId:d.beforeOrAfterId})]}const p=i[c],m=(null==g?void 0:g.area)===c?g.index:void 0,f=v({modulesInArea:p,indexOfModuleToUpsertInArea:m,indexToUpsertTo:l});if(!f)return;return[r().N4X.putModuleBeforeOrAfter({pointer:o,area:n().Zm[c],module:a,direction:f.insertDirection,beforeOrAfterId:f.beforeOrAfterId})]}({upsertPosition:t,rawModuleToUpsert:i,layoutPointer:a,modulesByArea:o});if("module_relative"===t.type)return[b({upsertPosition:t,rawModuleToUpsert:i,layoutPointer:a,modulesByArea:o})];if("area_relative"===t.type)return[A({upsertPosition:t,rawModuleToUpsert:i,layoutPointer:a,modulesByArea:o})];(0,p().HB)(t)}({module:g,upsertPosition:a,modulesByArea:y,layoutPointer:h,rawModuleToUpsert:w});N&&I.push(...N);const P="placeholder"===g.type&&"form_layout_schema"===a.area?`form_layout_new_question_${g.id}`:void 0;m().createAndCommitOrAppend({environment:t,undoCheckpoint:P,canUndo:!0,perform:e=>{f&&f({transaction:e});for(const t of I)m().applyOperation({transaction:e,store:o,operation:t})},transaction:c,userAction:l||"BuilderLayoutModules.upsert"}),_&&_()}function v(e){const{modulesInArea:t,indexOfModuleToUpsertInArea:a,indexToUpsertTo:o}=e;if(0===o||0===t.length)return{insertDirection:"before",beforeOrAfterId:void 0};const r=t.at(o);return r?void 0===a?{insertDirection:"before",beforeOrAfterId:r.id}:a!==o?a<o?{insertDirection:"after",beforeOrAfterId:r.id}:{insertDirection:"before",beforeOrAfterId:r.id}:void 0:{insertDirection:"after",beforeOrAfterId:void 0}}function b(e){const{upsertPosition:t,rawModuleToUpsert:a,layoutPointer:o,modulesByArea:s}=e,{area:i,direction:u,relativeToModuleId:g}=t,c=n().Zm[i],l=(0,d().JO)(s,(e=>e.id===g));if(!l||l.area!==i)throw new Error(`Cannot find module with id: ${g} to add upsert relative to in ${i}`);if("views_main_tab_modules"===c){const e="views_main_tab_modules"===l.area?l.viewId:void 0;if(!e)throw new Error("Cannot upsert module into views_main_tab_modules area that does not have views");return r().N4X.putModuleBeforeOrAfter({pointer:o,area:"views_main_tab_modules",viewId:e,module:a,direction:"above"===u?"before":"after",beforeOrAfterId:g})}return r().N4X.putModuleBeforeOrAfter({pointer:o,area:c,module:a,direction:"above"===u?"before":"after",beforeOrAfterId:g})}function A(e){const{upsertPosition:t,rawModuleToUpsert:a,layoutPointer:o,modulesByArea:s}=e,{location:i}=t;if("views_main_tab_modules"===t.area){const e=t.viewId,u={pointer:o,area:n().Zm[t.area],viewId:e,module:a};if("start"===i||"end"===i)return r().N4X.putModuleBeforeOrAfter({...u,direction:"start"===i?"before":"after",beforeOrAfterId:void 0});if("end_moveable"===i){var d;const e=w({area:t.area,modulesInArea:(null===(d=s.views_main_tab_modules)||void 0===d?void 0:d[t.viewId])??[]});return r().N4X.putModuleBeforeOrAfter({...u,direction:e.insertDirection,beforeOrAfterId:e.beforeOrAfterId})}(0,p().HB)(i)}const u={pointer:o,area:n().Zm[t.area],module:a};if("start"===i||"end"===i)return r().N4X.putModuleBeforeOrAfter({...u,direction:"start"===i?"before":"after",beforeOrAfterId:void 0});if("end_moveable"===i){const e=s[t.area],a=w({area:t.area,modulesInArea:e});return r().N4X.putModuleBeforeOrAfter({...u,direction:a.insertDirection,beforeOrAfterId:a.beforeOrAfterId})}(0,p().HB)(i)}function w(e){const{area:t,modulesInArea:a}=e,{nonMoveableHeaderModules:o,moveableModules:r,nonMoveableFooterModules:n}=(0,g().jS)(t,a);if(r.length){const e=(0,l().HV)(r);if(!e)throw new Error("cannot find last moveable module to add below for end moveable");return{insertDirection:"after",beforeOrAfterId:e.id}}if(o.length){const e=(0,l().HV)(o);if(!e)throw new Error("cannot find last header module to add below for end moveable");return{insertDirection:"after",beforeOrAfterId:e.id}}if(n.length){const e=n.at(0);if(!e)throw new Error("cannot find last header module to add below for end moveable");return{insertDirection:"before",beforeOrAfterId:e.id}}return{insertDirection:"after",beforeOrAfterId:void 0}}},219222:(e,t,a)=>{a.d(t,{T:()=>s});a(242343);var o=()=>a(573845),r=()=>a(283992),n=a(163643);function s(e){const{imageRef:t,url:a,blockStore:s,environment:i}=e;return e=>{if(e.stopPropagation(),e.preventDefault(),!t.current)return;const d=t.current.getBoundingClientRect(),u=d.width/d.height;o().o9({environment:i,renderFullScreenNode:()=>(0,n.jsx)(r().A,{url:a,isAuthenticated:!0,permissionRecord:s.pointer,width:window.innerWidth,render:(e,t)=>(0,n.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:d,contentAspectRatio:u,imageUrl:a,blockStore:s})}}},378524:(e,t,a)=>{a.d(t,{Uk:()=>c,gc:()=>l,r$:()=>m});a(362833),a(725707),a(491955),a(500234),a(324989),a(403517);var o=()=>a(564134),r=()=>a(728373),n=()=>a(810813),s=()=>a(314164),i=()=>a(477784),d=()=>a(413871),u=()=>a(145046),g=()=>a(84543);function c(e){const{modification:t,property:a,propertySchema:s,options:c,groupIndex:l,environment:m,collectionStore:f,isCollectionsStatusMissingOptionsFixEnabled:_}=e;let h,y;if("keyedObjectListRemove"===t.type)h={pointer:f.pointer,command:"keyedObjectListRemove",path:["schema",a,"options"],args:{remove:{id:t.id}}},void 0!==l&&"status"===s.type&&(y={pointer:f.pointer,command:"listRemove",path:["schema",a,"groups",l,"optionIds"],args:{id:t.id}});else{if(c){if(c.find((e=>e.value===t.newValue)))return void u().f1(i().A.formatMessage(p.optionAlreadyExists))}if("keyedObjectListUpdate"===t.type)h={pointer:f.pointer,command:"keyedObjectListUpdate",path:["schema",a,"options"],args:{value:{...t.option,value:t.newValue}}};else{const e=s.options||[];let n=(0,o().Zd)(e);if("status"===s.type&&void 0!==l){var M;const e=null===(M=s.groups)||void 0===M||null===(M=M[l])||void 0===M?void 0:M.color;e&&(n=e)}const i={id:(0,r().Ay)(),value:t.newValue,color:n};if("autoSortInsert"===t.type){if(!(0,o().lx)(s))return;h=(0,o().og)({collectionId:f.id,property:a,propertySchema:s,newOption:i,isAscending:"alphabetical"===s.auto_sort_options})}else"keyedObjectListBefore"===t.type?(h={pointer:f.pointer,command:"keyedObjectListBefore",path:["schema",a,"options"],args:{value:i,before:t.beforeOption}},void 0!==l&&"status"===s.type&&(y={pointer:f.pointer,command:"listBefore",path:["schema",a,"groups",l,"optionIds"],args:{id:i.id}})):"keyedObjectListAfter"===t.type&&(h={pointer:f.pointer,command:"keyedObjectListAfter",path:["schema",a,"options"],args:{value:i,after:t.afterOption}},void 0!==l&&"status"===s.type&&(y={pointer:f.pointer,command:"listBefore",path:["schema",a,"groups",l,"optionIds"],args:{id:i.id}}))}}(0,n().p)({environment:m,collectionStore:f,performTransaction:e=>{if(g().applyOperation({store:f,operation:h,transaction:e}),y&&g().applyOperation({store:(0,d().Oo)(f,y.pointer),operation:y,transaction:e}),"status"===s.type&&_){const t=s.options??[],o=(s.groups??[]).flatMap((e=>e.optionIds)),r=t.filter((e=>!o.includes(e.id)));for(const n of r)g().applyOperation({store:(0,d().Oo)(f,f.pointer),operation:{pointer:f.pointer,command:"listBefore",path:["schema",a,"groups",0,"optionIds"],args:{id:n.id}},transaction:e})}}})}function l(e){const{newValues:t,property:a,schema:r,collectionStore:i,environment:u,isCollectionsStatusMissingOptionsFixEnabled:c}=e,l=r[a];let p;if("status"===(null==l?void 0:l.type)){p=[[]];for(const e of t)e.startsWith("group-header-")?p.push([]):p[p.length-1].push(e);if(c){const e=((null==l?void 0:l.options)??[]).filter((e=>!t.includes(e.value)));p[0].push(...e.map((e=>e.value)))}}else p=t;const m=(0,s().os)({newOptions:p,collectionId:i.id,property:a,schema:r});if(m){if(l&&(0,o().lx)(l)){"manual"!==(l.auto_sort_options||"manual")&&m.push({pointer:i.pointer,command:"update",path:["schema",a],args:{auto_sort_options:"manual"}})}(0,n().p)({environment:u,collectionStore:i,performTransaction:e=>{for(const t of m)g().applyOperation({store:(0,d().Oo)(i,t.pointer),operation:t,transaction:e})}})}}const p=(0,a(653998).YK)({deleteModalPrompt:{id:"database.selectPropertyOptionEditMenu.deleteModal.prompt",defaultMessage:"Are you sure you want to delete this option?"},acceptButtonLabel:{id:"database.selectPropertyOptionEditMenu.deleteModal.confirmButton",defaultMessage:"Delete"},preventDefaultStatusOptionDelete:{defaultMessage:"Cannot delete default option.",id:"database.editProperty.errorDialog.forbidDeleteDefaultOption.message"},optionAlreadyExists:{defaultMessage:"Option already exists.",id:"database.optionExistsAlreadyError.message"}});function m(e){const{option:t,propertySchema:a,property:r,collectionStore:n,statusGroup:s,environment:d,deleteMessage:g}=e;"status"!==a.type||t.value!==a.defaultOption?u().ui({showCancel:!0,keepFocus:!1,message:g??i().A.formatMessage(p.deleteModalPrompt),items:[{label:i().A.formatMessage(p.acceptButtonLabel),color:"red",onAccept:()=>{if((0,o().lx)(a)||"status"===a.type)if("status"===a.type&&s){const e=(a.groups??[]).findIndex((e=>e.id===s.id));c({modification:{type:"keyedObjectListRemove",id:t.id},property:r,propertySchema:a,environment:d,collectionStore:n,groupIndex:e})}else c({modification:{type:"keyedObjectListRemove",id:t.id},property:r,propertySchema:a,environment:d,collectionStore:n})}}]}):u().f1(i().A.formatMessage(p.preventDefaultStatusOptionDelete))}},411116:(e,t,a)=>{a.d(t,{v:()=>n});var o=()=>a(803290),r=()=>a(747459);function n(e){const{blockId:t,propertyId:a}=e;return(0,o().K8)((()=>r().A.isPropertyWithDraftDiscussion({blockId:t,propertyId:a})),[t,a])}},569065:(e,t,a)=>{a.d(t,{C:()=>s});var o=()=>a(803290);const r=Number(a(141666).Xb),n=new(a(496985).default)((()=>a(836331).default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs")??r),{debugName:"clientFormulaTimeoutMsStore"});function s(){return(0,o().O$)(n)}},894711:(e,t,a)=>{a.d(t,{K:()=>n});var o=()=>a(716605),r=()=>a(1476);function n(e){let{type:t,store:a,textValue:n}=e;if(!n||!t)return{linkHref:void 0,shouldShowMaliciousContentDialog:!1};const s=(null==a?void 0:a.getCreatedById())===r().xY.id&&"url"===t;return{linkHref:(0,o().UY)(t,n),shouldShowMaliciousContentDialog:s}}}}]);